/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2015 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void Clear_Weapon_Data(void);
void Clear_Item_Data(void);
int __cdecl Add_Weapon(int Weapon_ID, int Weapon_Max_Ammo); // idb
int __cdecl Lose_Weapon(int Weapon_To_Lose); // idb
signed int __cdecl Trade_Weapon(int Weapon_To_Lose, int Weapon_To_Get, int New_Max_Ammo); // idb
signed int __cdecl Add_Item_Data(int code); // idb
signed int __cdecl Sub_Item_Data(int code); // idb
int Move_Inventory_Cursor();
void Draw_Inventory_Window();
signed int Inventory_Loop();
signed int __cdecl Check_For_Item(int item); // idb
signed int __cdecl Check_For_Weapon(int Weapon); // idb
signed int __cdecl Use_Ammo(int Ammo_To_Remove); // idb
int __cdecl Add_Ammo(int Ammo_To_Add);
void __cdecl Fill_Weapon_Ammo();
int Switch_to_Next_Weap();
int Switch_to_Prev_Weap();
void Change_To_First_Weapon();
signed int __cdecl Init_Background(char *fName, int Mode); // idb
void __cdecl Update_Background();
void __cdecl Draw_Background(signed int Camera_X, signed int Camera_Y);
void __cdecl Draw_Foreground(signed int Camera_X, signed int Camera_Y);
signed int __cdecl Chk_Starblck_break(int a1, int a2, Bullet_vars *Bullet); // idb
int __cdecl Solid_Tile_Complicated(int a1, int a2, _BYTE *a3, int a4);
void __cdecl Sound_When_Bullet_Hits_Wall_Maybe(int a1);
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_1(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_2(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_3(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_4(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_1(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_2(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_3(int, int, int BulletID); // idb
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_4(int, int, int BulletID); // idb
void Bul_Til_Coll_Algo();
int Clear_All_Weapons_Object_Slots();
int __cdecl Count_Weapon_Bullets(int WeaponID); // idb
int __cdecl Count_All_Slots_Using_Shot(int ShotID); // idb
int __cdecl Delete_Bullet(int a1);
void __cdecl Clear_Bullets();
int __cdecl Render_Bullets(signed int a1, signed int a2);
void __cdecl Create_Bullet(Bullet_enum BulletID, int X_Position, int Y_Position, Directions Direction);
void __cdecl Bullet_01_Lvl_1_Snake(int a1);
void __cdecl Bullet_02_03_Snake(Bullet_vars *bullet, int a2); // idb
void __cdecl Bullet_04_05_06_Polar_Star(Bullet_vars *Bullet, int Level);
void __cdecl Bullet_07_08_09_Fireball(Bullet_vars *Bullet, int Level); // idb
void __cdecl Bullet_0A_0B_0C_Machine_Gun(Bullet_vars *Bullet, int Level); // idb
void __cdecl Bullet_0D_0E_0F_Missile_Launcher(int a1, int a2);
Bullet_vars *__cdecl Bullet_10_11_12_Missile_Explosion(Bullet_vars *bullet, int a2);
void __cdecl Bullet_13_Bubbler_Lvl1(int a1);
void __cdecl Bullet_14_Bubbler_Lvl2(int a1);
void __cdecl Bullet_15_Bubbler_Lvl3(int a1);
void __cdecl Bullet_16_Bubble_Spurs(int a1);
void __cdecl Bullet_19_Blade_Lvl_1(int a1);
void __cdecl Bullet_1A_Blade_Lvl_2(int a1);
void __cdecl Bullet_1B_Blade_Lvl_3(int a1);
int __cdecl Bullet_17_Blade_Slash(int a1);
int __cdecl Bullet_18__Unused_(int a1);
void __cdecl Bullet_1C_1D_1E_Sup_Mis_Launcher(int a1, int a2);
int __cdecl Bullet_1F_20_21(int a1, int a2);
void __cdecl Bullet_22_23_24_2B_Nemesis(Bullet_vars *Bullet, int level); // idb
void __cdecl Bullet_25_26_27_ChargelessSpur_AllLevels(int a1, int a2);
int __cdecl Bullet_28_to_2A_NonMovingSpur_AllLevels(int a1, int a2);
int __cdecl Bullet_2C_Spur_Lvl_2(int a1);
int __cdecl Bullet_2D_Spur_Lvl_3(int a1);
void __cdecl Run_Bullet_Code();
signed int Is_some_bullet_active();
void __cdecl Init_Effects();
void __cdecl Effect_1_Random_Fountain_Pulsing_Disc_Particles(Effect_vars *Effect);
int __cdecl Effect_2_Rising_Disc_And_Exploding_Diamond(BOOL Effect_Vars); // idb
int __cdecl Effect_3_Star(BOOL Effect_Vars); // idb
int __cdecl Effect_4_Fireball_Impact(BOOL Effect_Vars); // idb
int __cdecl Effect_5_ZzZ___(BOOL Effect_Vars); // idb
int __cdecl Effect_6_Booster_Smoke(BOOL Effect_Vars); // idb
signed int __cdecl Effect_7_Drowned_Quote(BOOL Effect_Vars); // idb
signed int __cdecl Effect_8_Exclamation_Mark(BOOL Effect_Vars); // idb
signed int __cdecl Effect_9_Level_Up_Or_Down(BOOL Effect_Vars); // idb
signed int __cdecl Effect_10_Red_Damage_Rings(BOOL Effect_Vars); // idb
signed int __cdecl Effect_11_Big_Explosion(BOOL Effect_Vars); // idb
signed int __cdecl Effect_12_Headbump_Sparks(BOOL Effect_Vars); // idb
int __cdecl Effect_13_Unknown_Unused(int Effect_Vars);
signed int __cdecl Effect_14_Small_White_Explosion_Disc(BOOL Effect_Vars); // idb
signed int __cdecl Effect_15_Nothing(BOOL Effect_Vars); // idb
signed int __cdecl Effect_16_Push_Jump_Key(BOOL Effect_Vars); // idb
void __cdecl Update_Effects();
void __cdecl Draw_Effects(signed int Camera_X, signed int Camera_Y);
void __cdecl Create_Effect(int X_Pos, int Y_Pos, int Effect_Num, int Effect_Dir);
int __cdecl Load_Config_Data(Config_Data_File *config); // idb
void __cdecl Set_Default_Config_Data(Config_Data_File *config);
signed int __stdcall About_Dialog(HWND Game_Window_Handle, UINT Msg, WPARAM wParam, LPARAM lParam); // idb
signed int __stdcall Mute_Button(HWND Game_Window_Handle, UINT Msg, WPARAM wParam, LPARAM lParam); // idb
signed int __stdcall Debug_Save_Button(HWND hDlg, UINT Msg, WPARAM wParam, LPARAM lParam); // idb
signed int __stdcall Yes_No_Dialog(HWND hDlg, int uMsg, WPARAM wParam, const CHAR *lpString);
int __cdecl Change_Screen_Offsets(int New_Screen_Offset_Y, int New_Screen_Offset_X); // idb
int __cdecl Draw_Window(HWND hWnd); // idb
signed int __cdecl InitDirectDraw(HWND hWnd, int mode, int Bits_Per_Pixel); // idb
void *__cdecl End_Direct_Draw(HWND hwnd); // idb
void *__cdecl Destroy_Bitmap_Obj_Maybe(int a1);
int __cdecl MakeSurface_From_Resource(char *Ptr_Graphic, int GraphicID); // idb
int __cdecl MakeSurface_From_File(char *name, int destination); // idb
int __cdecl Load_BMP_From_Resource_Onto_Existing_Surface(char *, int); // idb
int __cdecl ReloadBitmap_From_File(char *source, int destination); // idb
signed int __cdecl MakeSurface_Blank(int a1, int a2, signed int a3, int a4); // idb
int __cdecl Backup_Surface(int DstRect, RECT *rect); // idb
void __cdecl Draw_Bitmap_With_Transparency(RECT *rcView, int XPos, int YPos, RECT *rect, int GraphicsID);
int __cdecl Draw_Sprite_No_Tranparency(RECT *Dst_Rects, int X_Position, int Y_Position, RECT *Src_Rects, int);
int __cdecl Draw_Sprite_Onto_Surface(LONG a1, LONG a2, RECT *a3, int a4, int a5); // idb
LPVOID __cdecl Make_RGB(COLORREF color);
void __cdecl Draw_Color_Fill(RECT *rect, int Mask_Color);
void __cdecl Draw_Color_Fill_Onto_Surface(RECT *rect, int column, int surface);
signed int Return_1();
int Regenerate_Surfaces();
void __cdecl Init_Font_Object(LPCSTR a1);
int __cdecl Draw_String(int a1, int a2, const char *String, COLORREF String_Color);
int __cdecl Draw_String_Onto_Surface(int X_Position, int Y_Position, char *Ptr_String, COLORREF color, int DDraw_Thingy); // idb
// BOOL End_Font_Object();
int Scroll_Credits_Text();
int Draw_From_Slot_0x25_Credits_Text_Maybe();
int __cdecl Print_Text_Maybe(int, int, char *, int); // idb
int Draws_Some_Text();
int Slide_Credits_Picture();
void Draw_Credits_Image();
void __cdecl Load_Credits_Illustration(int Credit_Number);
void __cdecl InitCreditScript();
void Release_Credit_Script();
signed int Start_Credits_Script();
void Credits_Related_Maybe();
void Credits_Related_2_Maybe();
int __cdecl Credits_Related_3_Maybe(int a1);
void __cdecl Set_Credit_Illustration(int num);
void Cut_Credit_Illustration();
int __cdecl Scene_Island_Crash(HWND hWnd, int mode); // idb
int __cdecl Call_On_Escape(HWND hWnd); // idb
void __cdecl Init_Fade();
// void __cdecl Set_Fade_Mask_(); idb
void Reset_Fade_Vars();
void __cdecl Start_Fade_Out(char Direction);
void __cdecl Start_Fade_In(char Direction);
void __cdecl Process_Fade();
void Draw_Fade_Out_In();
bool Get_Fade_Mode();
void *Clear_Event_Flags();
void *__cdecl InitSkipFlags();
void __cdecl Set_NPC_Flag(signed int Flag_Num);
void __cdecl Unset_NPC_Flag(signed int Flag_To_Unset);
bool __cdecl Get_NPC_Flag(signed int Flag_hashtag);
void __cdecl Set_Skip_Flag(signed int Flag_To_Set);
int __cdecl Unset_Skip_Flag(signed int Flag_To_Unset);
bool __cdecl Get_SkipFlag(signed int a1);
// void __cdecl Init_Flash();
void __cdecl Start_Flash(int X_Pos, int Y_Pos, int mode);
int __cdecl Update_Boss_Explosion(int a1, int a2);
int TSC_FLA_Handler();
int __cdecl Main_WhiteScreen_Handler(int a1, int a2);
void Draw_Boss_Explosion();
// void Reset_Flash();
void __cdecl Update_Camera();
void __cdecl Get_Camera_Position(int *a1, int *a2);
int __cdecl Camera_Update(signed int a1, int arg4);
void __cdecl Set_Camera_Quote();
void __cdecl Set_Camera_Target_Quote(int Ticks);
void __cdecl Set_Camera_Move_Ticks(int event, int Move_Ticks);
int *__cdecl TSC_FOB(int a1, int a2);
void __cdecl Set_Quake(int Duration);
void __cdecl Set_Hard_Quake_Duration(int Duration);
void Reset_Quake();
int __cdecl Random(signed int Minimum, signed int Maximum); // idb
void __cdecl Draw_Numbers(int X_Position, int Y_Position, int Numbers_To_Display, int Number_Of_Digits);
int __cdecl Game_Loop_Selector(HWND hWnd); // idb
signed int Game_Mode_Opening_Cutscene();
signed int Game_Loop_Title_Screen();
signed int __cdecl Game_Loop_Main_Game(HWND hWnd);
int __cdecl Get_Build_Data(int a1, _DWORD *a2, int a3);
int __cdecl Get_Version_Number(int, int, int, int); // idb
bool __cdecl Check_For_SndVol32_exe(HWND hwnd);
BOOL Delete_Debug_txt();
signed int __cdecl Print_Debug(int a1, int a2, int a3, int a4);
int __cdecl Param_Time_Check(PSCOPETABLE_ENTRY *System_Time_1, int); // idb
signed int __cdecl Check_File_Exists(int a1);
int __cdecl getFileSize(char *path);
int __cdecl Log_Error(int Error_String, int Error_Number); // idb
bool __cdecl Is_Shift_JIS(unsigned __int8 a1);
BOOL __cdecl Center_Window(HWND Window_Handle);
int __cdecl Load_Window_Rects(HWND Window_Handle, int, int); // idb
int __cdecl Save_Window_Rect_File(HWND hWnd, int); // idb
BOOL __cdecl IsEnableBitmap(char *filename);
signed int Load_Initial_Resources();
int Activate_Direct_Input();
signed int __cdecl Release_Direct_Input(int a1);
bool __cdecl Init_Direct_Input(HINSTANCE hinst, int a2);
signed int __cdecl Direct_Input_Something(int a1);
signed int __stdcall Enum_Devices_Callback(int a1, int a2);
signed int __cdecl Read_Controller(int a1);
signed int ResetJoystickStatus();
void __cdecl Get_Keys();
BOOL __cdecl Set_Window_Title(HWND hWnd);
void Display_FPS_Counter();
int Count_FPS();
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd); // idb
void Windows_Focus_Lost();
void Windows_Focus_Gained();
signed int __cdecl Load_Dropped_Profile(int a1, HDROP a2);
LRESULT __stdcall Window_Procedure(HWND hWnd, UINT Message, WPARAM wParam, LPARAM lParam); // idb
signed int MessageQueue(void); // idb
signed int Joystick_Procedure();
signed int Init_Map_Data();
signed int __cdecl Load_Map_Data(char *path_map); // idb
signed int __cdecl Load_Attribute_Data(char *StageName); // idb
void Kill_Level_Layout();
void __cdecl Get_Map_Data(unsigned __int8 **data, __int16 *Map_Width, __int16 *Map_Height);
unsigned __int8 __cdecl Get_Tile_Attributes(signed int X_Pos, signed int Y_Pos); // idb
char *__cdecl Delete_Tile(int a1, int a2);
void __cdecl Shift_Map_Parts(int X_Pos, int Y_pos);
signed int __cdecl Change_Map_Parts(int X_Pos, int Y_Pos, unsigned __int8 New_NPC); // idb
void __cdecl Draw_Stage_Background(signed int Camera_X, signed int Camera_Y);
void __cdecl Draw_Stage_Foreground(signed int Camera_X, signed int Camera_Y);
void __cdecl Draw_Map_Data_Vector(signed int Camera_X, signed int Camera_Y);
void __cdecl Ready_Map_Name(char *_name);
void __cdecl Draw_Map_Name(int bMini); // idb
void Start_Map_Name();
int Redraw_Room_Text_To_Surface();
void __cdecl Render_Map_System_Green_Stuff(LONG a1);
signed int Game_Loop_Map();
bool Check_Map_Flag();
void *Memset_Map_Flags_0();
void __cdecl Set_Map_Flag(int Map_ID);
void *Set_Quote_Initial_Values();
void __cdecl Do_Player_Animation(int bKey);
void __cdecl Show_Hide_Player(int show);
void __cdecl Draw_Quote_And_Gun(signed int a1, signed int a2);
int __cdecl Physics(int a1);
int __cdecl Quote_Movement(int a1);
int __cdecl Player_Related_Maybe(int a1);
void Quote_Air();
void __cdecl Get_Quote_Pos(int *X_Pos, int *Y_Pos);
void __cdecl Set_Quote_Position(int X_Pos, int Y_Pos); // idb
int __cdecl Instantly_Set_X_Y_Pos(int New_X_Position, int New_Y_Position);
// void Make_Quote_X_Vel_0();
int Tsc_UNJ();
void __cdecl Set_Player_Direction(unsigned __int8 New_Direction); // idb
void __cdecl Change_Unit(unsigned __int8 New_Unit);
int Add_Quote_Y_Pos_4000h();
void __cdecl Equip_Item(int Item_To_Equip, bool Unequip);
int AND_Player_Flags_minus2();
void __cdecl Set_Noise(int Num, int Frequency);
void __cdecl Cut_Noise();
void Play_Environmental_Sounds();
void Play_Sound_40_41_58();
// void Reset_Quote_Collision_Flags();
signed int __cdecl Quote_Collision_Block(int X_Pos, int Y_Pos); // idb
void Put_Bump_Stars();
signed int __cdecl Quote_Collision_Roof_Slope_1(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Roof_Slope_2(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Roof_Slope_3(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Roof_Slope_4(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Floor_Slope_1(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Floor_Slope_2(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Floor_Slope_3(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Floor_Slope_4(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Water(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Spike(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Spike_Water(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Wind_Left(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Wind_Up(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Wind_Right(int X_Pos, int Y_Pos); // idb
signed int __cdecl Quote_Collision_Wind_Down(int X_Pos, int Y_Pos); // idb
void __cdecl Do_Collision_Check_Player_Map();
signed int __cdecl Entity_Collision_Solid(NPC_vars *npc); // idb
unsigned __int8 __cdecl Entity_Collision_NonSolid(NPC_vars *npc);
signed int __cdecl Entity_Collision_SpecialSolid(NPC_vars *npc);
void Do_Collision_Check_Player_NPCs();
void Do_Collision_Check_Player_Bosses();
void __cdecl Add_Weapon_EXP(int EXP_To_Add);
int Reset_Selected_Weapon_Level(void); // idb
bool Check_Weapon_MAX(void);
void __cdecl Damage_Player(int damage);
int Reset_All_Weapons_EXP();
void __cdecl Add_Rocket_Ammo(int Num, int Ammo_To_Refill);
void __cdecl Add_Life_Player(int Health_To_Restore);
void __cdecl Add_Max_Life_Player(int Life_To_Add);
void __cdecl Draw_XP_Bar_And_Misc(int a1);
int Draw_HUD_Weapon_Icons();
void __cdecl Draw_Health_Bar(int); // idb
void __cdecl Underwater_Timer(int X_Position, int Y_Position);
void __cdecl Draw_Nikamaru_Timer(int X_Pos, int Y_Pos); // idb
signed int Save_Hell_Counter();
int Get_Hell_Time();
signed int __cdecl MakeSoundObject8(char *wavep, char track, char pipi); // idb
void __cdecl Change_Organ_Frequency(unsigned __int8 key, char track, int a);
void __cdecl Change_Organ_Pan(unsigned __int8 key, unsigned __int8 pan, char track);
void __cdecl Change_Organ_Volume(int no, __int32 volume, char track);
void __cdecl Play_Organya_Object(unsigned __int8 key, int mode, char track, DWORD freq);
void __cdecl Release_Organya_Object(char track);
BOOL Init_Wave_Data_100(void);
BOOL __cdecl Make_Organya_Wave(char track, char wave_num, char pipi);
void __cdecl Change_Dram_Frequency(unsigned __int8 key, char track);
void __cdecl Change_Dram_Pan(unsigned __int8 pan, char track);
void __cdecl Change_Dram_Volume(__int32 volume, char track);
void __cdecl Play_Dram_Object(unsigned __int8 key, int mode, char track);
OrgData *__thiscall OrgData::OrgData(OrgData *this);
void __thiscall OrgData::InitOrgData(OrgData *this);
BOOL __thiscall OrgData::SetMusicInfo(OrgData *this, MUSICINFO *mi, unsigned __int32 flag);
BOOL __thiscall OrgData::NoteAlloc(OrgData *this, unsigned __int16 alloc);
void __thiscall OrgData::ReleaseNote(OrgData *this);
signed int __thiscall OrgData::InitMusicData(OrgData *this, char *lpName);
void __thiscall OrgData::GetMusicInfo(OrgData *this, MUSICINFO *mi);
bool InitMMTimer();
int __cdecl StartTimer(DWORD dwTimer); // idb
void __cdecl TimerProc(UINT uTID, UINT uMsg, DWORD dwUser, DWORD dwParam1, DWORD dwParam2);
signed int QuitMMTimer();
void __thiscall OrgData::PlayData(OrgData *this);
void __thiscall OrgData::SetPlayPointer(OrgData *this, __int32 x);
signed int Start_Organya();
int __cdecl Load_Organya(LPCSTR lpName); // idb
void __cdecl Set_Organya_Position(int a1);
__int32 Get_Organya_Position();
int Start_Organya_Playback();
signed int __cdecl Change_Organya_Volume(signed int Volume); // idb
void Stop_Organya_Music();
// void Fade_Music();
void End_Organya();
void MakeWaveTables();
signed int __cdecl MakePixelWaveData(int a1, int a2);
signed int Check_Profile_dat(void);
signed int __cdecl Save_Profile(const char *name); // idb
signed int __cdecl Load_Dropped_Profile_dat(int a1);
int __cdecl Initialise_Game(HWND hWnd); // idb
void *Clear_Unlocked_Stages();
signed int __cdecl Add_Permit_Stage(int index, int event); // idb
signed int __cdecl Remove_Unlocked_Stage(int a1);
void __cdecl Move_Stage_Select_Cursor();
void Draw_Teleporter_Menu();
signed int __cdecl Game_Loop_Stage_Select(_DWORD *p_event); // idb
void __cdecl Snake(int Level);
void __cdecl Polar_Star(int Level);
void __cdecl Fireball(int a1);
void __cdecl Machine_Gun(int Level);
void __cdecl Missile_Launcher(int Level, bool Super); // idb
void Bubbler_Lvl_1_();
void __cdecl Bubbler_Lvl_2_3(int Level);
void __cdecl Blade(int a1);
void __cdecl Nemesis(int Bullet_Level);
int Reset_Spur_Charge();
void __cdecl Spur(int level); // idb
void Shoot_Bullet();
BOOL __cdecl Init_Direct_Sound(HWND hwnd);
void __cdecl End_Direct_Sound();
signed int __cdecl Init_Sound_Object(LPCSTR Resource_Name, int num); // idb
BOOL __cdecl Load_Sound_Object(char *file_name, int num);
void __cdecl Play_Sound_Effect(Sound_Effects_enum Num, int Mode);
void __cdecl Change_Sound_Frequency(int Num, DWORD rate);
void __cdecl Change_Sound_Volume(int Num, int Volume);
void __cdecl Change_Sound_Pan(int Num, int Pan);
size_t __cdecl Make_PixTone_Object(int *Ptr_Sound, int Channels, int SoundID);
signed int __cdecl Transfer_Stage(int number, int Event, int X_Pos, int Y_Pos);
void __cdecl Change_Music(Music_enum num);
int ReCall_Music();
void __cdecl Init_Whimsical_Star();
int Do_Whimsical_Star();
void __cdecl Draw_Whimsical_Star(signed int a1, signed int a2);
_BOOL4 __cdecl Init_TSC();
void *End_TSC_Script();
void __cdecl decryptTSCScript(unsigned __int8 *TSCData, signed int size);
int __cdecl Load_Special_TSC(char *); // idb
signed int __cdecl loadTSCScript(char *name);
// void __cdecl GetTextScriptPath(char *destination); idb
int __cdecl Get_TSC_Number(int num); // idb
signed int __cdecl Start_TSC_Event(int Event); // idb
signed int __cdecl Script_Jump(int Event_To_Jump_To);
void __cdecl Stop_Text_Script();
void __cdecl CheckNewLine();
void __cdecl Print_NUM(int index);
void __cdecl Clear_Text_Line();
void Draw_Text_Box();
int TSC_Parser(void); // idb
int Draw_Text_To_Text_Box_Surfaces();
void Init_Triangle_Table();
int __cdecl GetSin(unsigned __int8 deg); // idb
int __cdecl GetCos(unsigned __int8 deg); // idb
unsigned __int8 __cdecl GetArcTan(int X, int Y);
void __cdecl call_call_cos(float a1);
void __cdecl call_cos(float a1);
void __cdecl call_call_sin(float a1);
void __cdecl call_sin(float a1);
void Clear_Value_View(void);
int __cdecl Set_Value_View(__int32, __int32, __int32); // idb
int Act_Value_View();
int __cdecl Put_Value_View(int Camera_X_Pos, int Camera_Y_Pos); // idb
void __cdecl NPC0_Nothing(NPC_vars *npc);
void __cdecl NPC1_Weapon_Energy(NPC_vars *npc);
void __cdecl NPC2_Enemy_Behemoth(NPC_vars *npc);
void __cdecl NPC3_Deletes_Itself(NPC_vars *npc);
void __cdecl NPC4_Smoke(NPC_vars *npc);
void __cdecl NPC5_Enemy_Critter_Hopping_Green(NPC_vars *npc);
void __cdecl NPC6_Enemy_Beetle_Horiz_Green(NPC_vars *npc);
void __cdecl NPC7_Enemy_Basil(NPC_vars *npc);
void __cdecl NPC8_Enemy_Beetle_Follow1(NPC_vars *npc);
void __cdecl NPC9_Balrog_DropIn(NPC_vars *npc);
void __cdecl NPC10_Boss_Balrog_Shooting(NPC_vars *npc);
void __cdecl NPC11_Projectile_Balrog_Energy_Bounce(NPC_vars *npc);
void __cdecl NPC12_Balrog_Cutscene(NPC_vars *npc);
void __cdecl NPC13_Forcefield(NPC_vars *npc);
void __cdecl NPC14_Santas_Key(NPC_vars *npc);
void __cdecl NPC15_Treasure_Chest_Closed(NPC_vars *npc);
void __cdecl NPC16(NPC_vars *npc);
void __cdecl NPC17(NPC_vars *npc);
void __cdecl NPC18(NPC_vars *npc);
void __cdecl NPC19(NPC_vars *npc);
void __cdecl NPC20(NPC_vars *npc);
void __cdecl NPC21(NPC_vars *npc);
void __cdecl NPC22(NPC_vars *npc);
void __cdecl NPC23(NPC_vars *npc);
void __cdecl NPC24(NPC_vars *npc);
void __cdecl NPC25(NPC_vars *npc);
void __cdecl NPC26(NPC_vars *npc);
void __cdecl NPC27(NPC_vars *npc);
void __cdecl NPC28(NPC_vars *npc);
void __cdecl NPC29(NPC_vars *npc);
void __cdecl NPC30(NPC_vars *npc);
void __cdecl NPC31(NPC_vars *npc);
void __cdecl NPC32(NPC_vars *npc);
void __cdecl NPC33(NPC_vars *npc);
void __cdecl NPC34(NPC_vars *npc);
void __cdecl NPC35(NPC_vars *npc);
void __cdecl NPC36(NPC_vars *npc);
void __cdecl NPC37(NPC_vars *npc);
void __cdecl NPC38(NPC_vars *npc);
void __cdecl NPC39(NPC_vars *npc);
void __cdecl NPC40(NPC_vars *npc);
void __cdecl NPC41(NPC_vars *npc);
void __cdecl NPC42(NPC_vars *npc);
void __cdecl NPC43(NPC_vars *npc);
void __cdecl NPC44(NPC_vars *npc);
void __cdecl NPC45(NPC_vars *npc);
void __cdecl NPC46(NPC_vars *npc);
void __cdecl NPC47(NPC_vars *npc);
void __cdecl NPC48(NPC_vars *npc);
void __cdecl NPC49(NPC_vars *npc);
void __cdecl NPC50(NPC_vars *npc);
void __cdecl NPC51(NPC_vars *npc);
void __cdecl NPC52_Sitting_Blue_Bot(NPC_vars *npc);
void __cdecl NPC53(NPC_vars *npc);
void __cdecl NPC54(NPC_vars *npc);
void __cdecl NPC55(NPC_vars *npc);
void __cdecl NPC56(NPC_vars *npc);
void __cdecl NPC57(NPC_vars *npc);
void __cdecl NPC58(NPC_vars *npc);
void __cdecl NPC59(NPC_vars *npc);
void __cdecl NPC60(NPC_vars *npc);
void __cdecl NPC61(NPC_vars *npc);
void __cdecl NPC62(NPC_vars *npc);
void __cdecl NPC63(NPC_vars *npc);
void __cdecl NPC64(NPC_vars *npc);
void __cdecl NPC65(NPC_vars *npc);
void __cdecl NPC66(NPC_vars *npc);
void __cdecl NPC67(NPC_vars *npc);
void __cdecl NPC68(NPC_vars *npc);
void __cdecl NPC69(NPC_vars *npc);
void __cdecl NPC70(NPC_vars *npc);
void __cdecl NPC71(NPC_vars *NPC);
void __cdecl NPC72(NPC_vars *NPC);
void __cdecl NPC73(NPC_vars *NPC);
void __cdecl NPC74(NPC_vars *NPC);
void __cdecl NPC75(NPC_vars *NPC);
void __cdecl NPC76(NPC_vars *NPC);
void __cdecl NPC77_Sandaim_the_Farmer(NPC_vars *NPC);
void __cdecl NPC78_Pot(NPC_vars *NPC);
void __cdecl NPC79(NPC_vars *NPC);
void __cdecl NPC80(NPC_vars *NPC);
void __cdecl NPC81(NPC_vars *NPC);
void __cdecl NPC82(NPC_vars *NPC);
void __cdecl NPC83(NPC_vars *NPC);
void __cdecl NPC84(NPC_vars *NPC);
void __cdecl NPC85(NPC_vars *NPC);
void __cdecl NPC86(NPC_vars *NPC);
void __cdecl NPC87(NPC_vars *NPC);
void __cdecl NPC88(NPC_vars *NPC);
void __cdecl NPC89(NPC_vars *NPC);
void __cdecl NPC90(NPC_vars *NPC);
signed int __cdecl NPC91(int a1);
int __cdecl NPC92(int a1);
int __cdecl NPC93(int a1);
int __cdecl NPC94_Giant_Jelly(int a1);
int __cdecl NPC95(int a1);
int __cdecl NPC96(int a1);
int __cdecl NPC97(int a1);
int __cdecl NPC98(int a1);
int __cdecl NPC99(int a1);
signed int __cdecl NPC100(int a1);
int __cdecl NPC101(int a1);
int __cdecl NPC102(int a1);
void __cdecl NPC103(int a1);
int __cdecl NPC104(int a1);
int __cdecl NPC105(int a1);
int __cdecl NPC106(int a1);
int __cdecl NPC107(int a1);
int __cdecl NPC108(int a1);
int __cdecl NPC109(int a1);
int __cdecl NPC110(int a1);
int __cdecl NPC111(int a1);
int __cdecl NPC112(int a1);
int __cdecl NPC113(int a1);
int __cdecl NPC114(int a1);
int __cdecl NPC115(int a1);
int __cdecl NPC116(int a1);
int __cdecl NPC117(int a1);
int __cdecl NPC118(int a1);
int __cdecl NPC119(int a1);
signed int __cdecl NPC120(int a1);
void __cdecl NPC121(int a1);
int __cdecl NPC122(int a1);
int __cdecl NPC123(int a1);
int __cdecl NPC124(int a1);
int __cdecl NPC125(int a1);
int __cdecl NPC126(int a1);
int __cdecl NPC127(int a1);
int __cdecl NPC128(int a1);
int __cdecl NPC129(int a1);
int __cdecl NPC130(int a1);
int __cdecl NPC131(int a1);
int __cdecl NPC132(int a1);
int __cdecl NPC133(int a1);
int __cdecl NPC134(int a1);
int __cdecl NPC135(int a1);
int __cdecl NPC136(int a1);
int __cdecl NPC137(int a1);
int __cdecl NPC138(int a1);
int __cdecl NPC139(int a1);
LONG *__cdecl NPC140(NPC_vars *a1);
int __cdecl NPC141(int a1);
int __cdecl NPC142(int a1);
int __cdecl NPC143(int a1);
int __cdecl NPC144(int a1);
int __cdecl NPC145(int NPC_Vars);
int __cdecl NPC146(int a1);
int __cdecl NPC147(int a1);
void __cdecl NPC148(int a1);
signed int __cdecl NPC149(int a1);
int __cdecl NPC150(int a1);
int __cdecl NPC151(int a1);
int __cdecl NPC152(int a1);
int __cdecl NPC153(int a1);
int __cdecl NPC154(int NPC_Vars_Pointer);
int __cdecl NPC155(int a1);
void __cdecl NPC156(int a1);
signed int __cdecl NPC157(int a1);
int __cdecl NPC158(int a1);
void __cdecl NPC159(int a1);
int __cdecl NPC160(int a1);
int __cdecl NPC161(int a1);
int __cdecl NPC162(int a1);
int __cdecl NPC163(int a1);
int __cdecl NPC164(int a1);
int __cdecl NPC165(int a1);
int __cdecl NPC166(int a1);
int __cdecl NPC167(int a1);
signed int __cdecl NPC168(int a1);
int __cdecl NPC169(int a1);
void __cdecl NPC170(void *Frame_1_A_4);
int __cdecl NPC171(int a1);
void __cdecl NPC172(void *npc);
void __cdecl NPC173(int a1);
int __cdecl NPC174(int a1);
int __cdecl NPC175(void *); // idb
int __cdecl NPC176(void *); // idb
void __cdecl NPC177(int a1);
void __cdecl NPC178(void *a1);
void __cdecl NPC179(void *a1);
LONG *__cdecl NPC180(NPC_vars *a1);
int __cdecl NPC181(int a1);
int __cdecl NPC182(int a1);
int __cdecl NPC183(int a1);
int __cdecl NPC184(int a1);
int __cdecl NPC185(int a1);
int __cdecl NPC186(int a1);
LONG *__cdecl NPC187(NPC_vars *a1);
int __cdecl NPC188(int a1);
int __cdecl NPC189(int a1);
int __cdecl NPC190(int a1);
int __cdecl NPC191(int a1, int a2, int a3, int a4);
int __cdecl NPC192(int a1);
int __cdecl NPC193(int a1);
signed int __cdecl NPC194(int a1);
int __cdecl NPC195(int a1);
signed int __cdecl NPC196(int a1);
int __cdecl NPC197(void *); // idb
void __cdecl NPC198(int a1);
int __cdecl NPC199(int a1);
int __cdecl NPC200(int a1);
int __cdecl NPC201(int a1);
void __cdecl NPC202(int a1);
int __cdecl NPC203(int a1);
int __cdecl NPC204(int a1);
void __cdecl NPC205(int a1);
int __cdecl NPC206(int a1);
int __cdecl NPC207(int a1);
int __cdecl NPC208(int a1);
void __cdecl NPC209(int a1);
int __cdecl NPC210(int a1);
int __cdecl NPC211(int a1);
NPC_vars *__cdecl NPC212(NPC_vars *a1);
int __cdecl NPC213(int a1);
int __cdecl NPC214(int Entity_Vars);
int __cdecl NPC215(int a1);
void __cdecl NPC216_Debug_Cat(NPC_vars *npc);
int __cdecl NPC217(int a1);
int __cdecl NPC218(int a1);
int __cdecl NPC219(int a1);
void __cdecl NPC220(NPC_vars *npc);
int __cdecl NPC221(int a1);
signed int __cdecl NPC222(int a1);
int __cdecl NPC223(int a1);
int __cdecl NPC224(int a1);
int __cdecl NPC225(int a1);
int __cdecl NPC226(int a1);
void __cdecl NPC227_Bucket(NPC_vars *npc);
int __cdecl NPC228(int a1);
signed int __cdecl NPC229(int a1);
signed int __cdecl NPC230(int a1);
int __cdecl NPC231(int a1);
int __cdecl NPC232(NPC_vars *a1);
void __cdecl NPC233(NPC_vars *npc);
signed int __cdecl NPC234(int a1);
int __cdecl NPC235(int a1);
int __cdecl NPC236(int a1);
void __cdecl NPC237(int a1);
int __cdecl NPC238(int a1);
int __cdecl NPC239(int a1);
int __cdecl NPC240(int a1);
int __cdecl NPC241(int a1);
void __cdecl NPC242(void *npc);
void __cdecl NPC243(int a1);
signed int __cdecl NPC244(signed int a1);
int __cdecl NPC245(int a1);
int __cdecl NPC246(int a1);
LONG *__cdecl NPC247(NPC_vars *a1);
void __cdecl NPC248(int a1);
int __cdecl NPC249(int a1);
void __cdecl NPC250(int a1);
int __cdecl NPC251(int a1);
int __cdecl NPC252(int a1);
int __cdecl NPC253(int a1);
signed int __cdecl NPC254(NPC_vars *a1);
int __cdecl NPC255(int a1);
int __cdecl NPC256(int a1);
int __cdecl NPC257(int a1);
int __cdecl NPC258(int a1);
void __cdecl NPC259(void *a1);
int __cdecl NPC260(int a1);
int __cdecl NPC261(int a1);
int __cdecl NPC262(int a1);
void __cdecl NPC263(NPC_vars *NPC);
void __cdecl NPC264(void *a1);
int __cdecl NPC265(int a1);
void __cdecl NPC266(void *a1);
void __cdecl NPC267(NPC_vars *NPC);
int __cdecl NPC268(int a1);
int __cdecl NPC269(int a1);
int __cdecl NPC270(int a1);
void __cdecl NPC271(void *a1);
void __cdecl NPC272(int a1);
void __cdecl NPC273(void *npc);
int __cdecl NPC274(int a1);
int __cdecl NPC275(int a1);
int __cdecl NPC276(int a1);
void __cdecl NPC277(void *npc);
int __cdecl NPC278(int a1);
int __cdecl NPC279(int a1);
int __cdecl NPC280(int a1);
LONG *__cdecl NPC281(NPC_vars *a1);
int __cdecl NPC282(int a1);
int __cdecl NPC283(int a1);
int __cdecl NPC284(int a1);
void __cdecl NPC285(void *npc);
int __cdecl NPC286(int a1);
int __cdecl NPC287(int a1);
int __cdecl NPC288(int a1);
void __cdecl NPC289(void *npc);
void __cdecl NPC290(void *npc);
int __cdecl NPC291(int a1);
void NPC292();
int __cdecl NPC293(int a1);
int __cdecl NPC294(int a1);
int __cdecl NPC295(int a1);
void __cdecl NPC296(int a1);
signed int __cdecl NPC297(int a1);
int __cdecl NPC298(int a1);
int __cdecl NPC299(int a1);
signed int __cdecl NPC300(int a1);
int __cdecl NPC301(int a1);
int __cdecl NPC302(int a1);
int __cdecl NPC303(int a1);
int __cdecl NPC304(int a1);
int __cdecl NPC305(int a1);
int __cdecl NPC306(int a1);
int __cdecl NPC307(int a1);
int __cdecl NPC308(int a1);
int __cdecl NPC309(int a1);
int __cdecl NPC310(int a1);
int __cdecl NPC311(int a1);
int __cdecl NPC312(int a1);
int __cdecl NPC313(int a1);
int __cdecl NPC314(int a1);
void __cdecl NPC315(void *npc);
int __cdecl NPC316(int a1);
NPC_vars *__cdecl NPC317(NPC_vars *a1);
int __cdecl NPC318(int a1);
void __cdecl NPC319(int a1);
LONG *__cdecl NPC320(NPC_vars *a1);
int __cdecl NPC321(int a1);
int __cdecl NPC322(int a1);
int __cdecl NPC323(int a1);
void __cdecl NPC324(int a1);
int __cdecl NPC325(int a1);
LONG *__cdecl NPC326(NPC_vars *a1);
int __cdecl NPC327(int a1);
int __cdecl NPC328(int a1);
signed int __cdecl NPC329(int a1);
int __cdecl NPC330(int a1);
int __cdecl NPC331(int a1);
int __cdecl NPC332(int a1);
int __cdecl NPC333(int a1);
int __cdecl NPC334(int a1);
int __cdecl NPC335(int a1);
void __cdecl NPC336(int a1);
int __cdecl NPC337(int a1);
void __cdecl NPC338(void *a1);
void __cdecl NPC339(int a1);
int __cdecl NPC340(NPC_vars *a1);
void __cdecl NPC341(NPC_vars *npc);
void __cdecl NPC342(void *a1);
int __cdecl NPC343(int a1);
int __cdecl NPC344(int a1);
int __cdecl NPC345(int a1);
int __cdecl NPC346(int a1);
int __cdecl NPC347(int a1);
int __cdecl NPC348(int a1);
signed int __cdecl NPC349(int a1);
void __cdecl NPC350(void *npc);
int __cdecl NPC351(int a1);
int __cdecl NPC352(NPC_vars *a1);
int __cdecl NPC353(int a1);
int __cdecl NPC354(int a1);
int __cdecl NPC355(int a1);
LONG *__cdecl NPC356(NPC_vars *a1);
void __cdecl NPC357(int a1);
int __cdecl NPC358(int a1);
void __cdecl NPC359(int a1);
signed int __cdecl NPC360_Thank_You(int a1);
void __cdecl Init_NPCs();
signed int __cdecl Load_Event(char *path_event); // idb
void __cdecl Set_Unique_Parameter(NPC_vars *npc);
void __cdecl NPC_Create(NPC_Names NPC_Num, int X_Pos, int Y_Pos, int X_Vel, int Y_Vel, Directions Direction, NPC_vars *Parent_NPC, int Start_Index);
void __cdecl Create_Dust_Clouds(int X_Pos, int Y_Pos, signed int Range, int Num); // idb
void __cdecl Create_Dust_Clouds_Up(int X_Pos, int Y_Pos, signed int Range, int Num); // idb
void __cdecl Spawn_Exp(int X_Position, int Y_Position, signed int EXP_Amount); // idb
signed int __cdecl Spawn_Missiles(int a1, int a2, int a3);
signed int __cdecl Spawn_HP(int a1, int a2, int a3);
void __cdecl Vanish_NPC(NPC_vars *npc);
void __cdecl Draw_NPCs(signed int Camera_X, signed int Camera_Y); // idb
void __cdecl Update_NPCs();
void __cdecl Spawn_NPC(int Entity_Eve_Num, int Entity_Type, int Direction);
void __cdecl Change_Checkable_NPC_By_Event(int Entity_Eve_Num, int Entity_Type, char Direction);
void __cdecl Set_NPC_State(int Entity_Eve_Num, int NPC_State, int Direction);
void __cdecl Move_NPC(int Entity_Eve_Num, int X_Pos, int Y_Pos, char Direction);
void __cdecl Back_Step_Player(int Entity_Eve_Num);
void __cdecl Delete_NPC_Event(int Entity_Eve_Num);
void __cdecl Kill_NPC(int Number, int bSmoke);
void __cdecl Get_NPC_Position(int *X_Pos_Dest, int *Y_Pos_Dest, int NPC_object_num);
signed int __cdecl Is_NPC_code(int code); // idb
bool __cdecl Check_NPC_alive(int code_event); // idb
int Count_Live_NPCs();
void __cdecl NPC_Collision_Block(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_A(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_B(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_C(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_D(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_E(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_F(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_G(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Triangle_H(NPC_vars *npc, int X_Pos, int Y_Pos);
void __cdecl NPC_Collision_Water(NPC_vars *npc, int X_Pos, int Y_Pos);
void Do_Collision_Check_NPCs_Map();
void __cdecl NPC_Death_Maybe(void *Is_NPC_Alive, int a2);
int Entity_Bullet_Collision();
int __cdecl LoadNPCTable(char *path); // idb
void Free_NPC_Table();
void __cdecl Init_Room_Boss(int Boss_Num);
void __cdecl Draw_Boss(signed int Camera_X, signed int Camera_Y); // idb
int __cdecl Set_Boss_Script_State(int); // idb
void __cdecl Do_Collision_Check_Bosses_Bullets();
// int __cdecl Boss0_NoSpecialBoss(_DWORD); weak
void __cdecl Update_Boss();
void __cdecl Do_Collision_Check_Bosses_Map();
int __cdecl Core_Sub_NPC_Face(int a1);
int __cdecl Core_Sub_NPC_Tail(int a1);
int __cdecl Core_Sub_NPC_Mini(int a1);
int __cdecl Core_Sub_NPC_Hit(int a1);
int Boss_4_Core();
int Boss_7_Undead_Core();
int __cdecl Undead_Sub_NPC_Head(int a1);
int __cdecl Undead_Sub_NPC_Tail(int a1);
int __cdecl Undead_Sub_NPC_Face(int a1);
int __cdecl Undead_Sub_NPC_Mini(int a1);
int __cdecl Undead_Sub_NPC_Hit(int a1);
int Boss_9_Ballos_Ball();
int __cdecl Ballos_Sub_NPC_Eye(int a1);
int __cdecl Ballos_Sub_NPC_Body(int a1);
int __cdecl Ballos_Sub_NPC_HITAI(int a1);
int __cdecl Ballos_Sub_NPC_HARA(int a1);
void Boss_2_Balfrog();
void __cdecl Balfrog_Sub_NPC_1();
void __cdecl Balfrog_Sub_NPC_2();
RECT *Boss_5_Ironhead();
// void Init_Boss_Life();
signed int __cdecl Start_Boss_Life(int Entity_Eve_Num); // idb
signed int Start_Boss_Life_2();
void Draw_Boss_Health();
void Boss_1_Omega();
void __cdecl Omega_Sub_NPC_2();
void __cdecl Omega_Sub_NPC_1();
void __cdecl Omega_Sub_NPC_3();
RECT *Boss_8_Heavy_Press();
int Boss_6_Dragon_Sisters();
int __cdecl Sisters_Sub_NPC_Dragon_Body(int a1);
int __cdecl Sisters_Sub_NPC_Dragon_Head(int a1);
NPC_vars *Boss_3_Monster_X();
int __cdecl Monster_X_Sub_NPC_1(int a1);
int __cdecl Monster_X_Sub_NPC_Fish_Missiles(int a1);
int __cdecl Monster_X_Sub_NPC_3(int a1);
int __cdecl Monster_X_Sub_NPC_4(int a1);
int __cdecl Monster_X_Sub_NPC_Head(int a1);
// HRESULT __stdcall DirectDrawCreate(GUID *lpGUID, LPDIRECTDRAW *lplpDD, IUnknown *pUnkOuter); idb
// HRESULT __stdcall DirectInputCreateA(HINSTANCE hinst, DWORD dwVersion, LPDIRECTINPUTA *ppDI, LPUNKNOWN punkOuter); idb
// HRESULT __stdcall DirectSoundCreate(LPGUID, LPDIRECTSOUND *, LPUNKNOWN); idb
// void *__cdecl memset(void *dest, int value, size_t count); idb
signed int report_failure_Return_1();
void report_failure_sub_480DB1();
// void __thiscall report_failure(void *this);
// int __cdecl fclose_nolock(FILE *stream);
// int __cdecl fclose(FILE *stream);
// size_t __cdecl fread_nolock(void *buffer, size_t elementSize, size_t count, FILE *stream);
size_t __cdecl fread(void *buffer, size_t elementSize, size_t count, FILE *stream);
// FILE *__cdecl _fsopen(const _TSCHAR *file, const _TSCHAR *mode, int shflag);
// int __usercall fsopen_sub_480FF3@<eax>(int a1@<ebp>);
// FILE *__cdecl fopen(const _TSCHAR *file, const _TSCHAR *mode);
// int sprintf(char *string, const char *format, ...);
// int __cdecl strcmp(const char *src, const char *dest); idb
// void __cdecl strcpy(char *dst, const char *src); idb
// char *__cdecl strcat(char *dst, const char *src); idb
// size_t __cdecl strlen(const char *string); idb
// void __cdecl free(void *pBlock);
// void unlock_4();
// void *__cdecl heap_alloc(size_t size);
// void __usercall _heap_alloc_sub_48136B(int a1@<ebp>);
// void _heap_alloc_call__unlock();
// void *__cdecl malloc_base(size_t size, int newmode);
// void *__cdecl malloc(size_t size); idb
// void *__cdecl memcpy(void *dst, void *src, size_t count);
// void __cdecl srand(unsigned int seed);
// int __cdecl rand();
// int __cdecl memcmp(const void *buf1, const void *buf2, size_t count);
// int sscanf(char *string, const char *format, ...);
// int fprintf(FILE *str, FILE *_stream, ...);
// int __usercall fprintf_unlock_str@<eax>(int a1@<ebp>);
// size_t __cdecl fwrite_nolock(const void *buffer, size_t size, size_t num, FILE *stream);
size_t __cdecl fwrite(const void *buffer, size_t size, size_t count, FILE *stream);
// int __cdecl fseek_nolock(FILE *stream, __int32 offset, int whence);
// int __cdecl fseek(int whence, FILE *stream, __int32 offset);
// int __usercall fseek_unlock_str@<eax>(int a1@<ebp>);
void Just_Return();
// int (__cdecl *_cfltcvt_init())(int, int, int, int, int);
// void __cdecl _fpmath(int initPrecision);
// void __usercall _CIsin(double x@<st0>);
// double __cdecl sin(double angle_rad); idb
// unsigned int __usercall _ftol2@<eax>(long double a1@<st0>);
// double __cdecl cos(double angle_rad); idb
// void __cdecl __noreturn _amsg_exit(int rterrnum);
// void __cdecl __noreturn static fast_error_exit(int rterrnum);
// int WinMainCRTStartup();
// void __cdecl __security_init_cookie();
// void __cdecl __noreturn _security_error_handler(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21);
signed int __security_error_handler_return_1();
int __cdecl __security_error_handler(int, int); // idb
// void __cdecl VALIDATE_RETURN(int a1, int a2);
// int __stdcall _SEH_epilog(_DWORD, _DWORD); weak
// int __usercall _except_handler3@<eax>(int a1@<ebp>, int a2, PVOID TargetFrame, int a4);
// signed int __cdecl close_nolock(signed int fh); idb
// int __cdecl _close(int fh);
// int close_call___unlock_fhandle(void); weak
// void __cdecl _freebuf(FILE *stream);
// int __cdecl _flush(FILE *stream);
// int __cdecl fflush_nolock(FILE *str);
// int __cdecl static flsall(int flushflag);
// int __usercall flsall_sub_482475@<eax>(int a1@<esi>);
void flsall_sub_4824A1();
int __cdecl flushall();
// int __initstdio(void);
// void __cdecl __endstdio();
// void __cdecl lock_str(FILE *file);
// _DWORD __cdecl _lock_file2(_DWORD, _DWORD); weak
// void __cdecl _unlock_file(FILE *a1); idb
// _DWORD __cdecl _unlock_file2(_DWORD, _DWORD); weak
// int __cdecl _filbuf(FILE *stream); idb
// int __cdecl read_nolock(int fh, void *inputbuf, unsigned int cnt);
// int __cdecl _read(int fh, void *buf, unsigned int cnt);
// void call_unlock_fh();
// FILE *__cdecl _openfile(const char *filename, const int *mode, int shflag, FILE *str); idb
// int _errno(void); weak
// int __doserrno(void); weak
// int __cdecl _dosmaperr(_DWORD); weak
// int _getstream(void); weak
// int __cdecl _flsbuf(int, _SYSTEMTIME *); idb
// int __cdecl output_l(_SYSTEMTIME *, int, int); idb
// _DWORD __cdecl _heap_init(_DWORD); weak
// void __cdecl _unlock(int locknum); idb
// signed int __cdecl _mtinitlocknum(int a1, int a2);
// int mtinitlocknum_sub_4837E0(void); weak
// void __cdecl mlock(int a1);
// char *__cdecl __sbh_find_block(int a1);
// _DWORD __cdecl __sbh_free_block(_DWORD, _DWORD); weak
// _DWORD __cdecl __sbh_alloc_block(_DWORD); weak
// int __cdecl _callnewh(size_t size); idb
// _tiddata *__cdecl _getptd();
// int __usercall freefls@<eax>(int a1@<ebp>);
// int freefls(void); weak
// int _mtinit(void); weak
// int __cdecl _input(_SYSTEMTIME *, int, int); idb
// int __cdecl _stbuf(int); idb
// int __cdecl _ftbuf(int, int); idb
// int __cdecl _write_lk(int, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite); idb
// int __cdecl _write(int file, const void *data, unsigned int NumberOfBytesToWrite); idb
// int __cdecl _lseek_lk(int, LONG lDistanceToMove, DWORD dwMoveMethod); idb
// __int32 __cdecl _lseek(int file_ptr, __int32 distanceToMove, int initial_pos); idb
// _DWORD __cdecl _ftell_lk(_DWORD); weak
// int __cdecl _forcdecpt(int); weak
// int __cdecl _cropzeros(int); weak
// int __cdecl _positive(int); weak
// int __cdecl _fassign(int, int, int); idb
// int __cdecl _cfltcvt(int, int, int, int, int); weak
// int _setdefaultprecision(void); weak
// int _ms_p5_mp_test_fdiv(void); weak
// double _convertTOStoQNaN(void); weak
// double __fastcall _fload_withFB(_DWORD, _DWORD); weak
// int __cdecl _checkTOS_withFB(int, int); idb
// long double __usercall _startOneArgErrorHandling@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, long double a4@<st0>, int a5, int a6, int a7, int a8);
// void __cdecl __noreturn __crtExitProcess(UINT uExitCode);
// _DWORD __cdecl _initterm(_DWORD); weak
// int __cdecl _cinit(int a1);
// void __cdecl doexit(UINT uExitCode, int a2, int a3);
// void __cdecl __noreturn exit(int status);
// void _cexit(void); idb
// int __cdecl _NMSG_WRITE(DWORD NumberOfBytesWritten); idb
// int _FF_MSGBANNER(void); weak
// int twincmdln(void); weak
// int _setenvp(void); weak
// int _setargv(void); weak
// _DWORD __thiscall GetEnvironmentStringsT(LPSTR MultiByte); weak
// int _ioinit(void); weak
void CrtSetCheckCount();
void On_Exit_Function(void); // idb
// int __cdecl __crtMessageBoxA(const char *lpText, const char *lpCaption, unsigned int uType); idb
// int __cdecl _global_unwind2(PVOID TargetFrame); idb
// void __cdecl _local_unwind2(int xr, int stop); idb
// _DWORD __stdcall _NLG_Notify(_DWORD); weak
// _DWORD __cdecl _ValidateEH3RN(_DWORD); weak
// _DWORD __cdecl _free_osfhnd(_DWORD); weak
// __int32 __cdecl _get_osfhandle(int file_descriptor); idb
// _DWORD __cdecl lock_fh(_DWORD); weak
// void __cdecl unlock_fh(signed int a1);
// int __usercall Very_Strange_Shit@<eax>(int a1@<ebp>);
// int _alloc_osfhnd_sub_4875A2(void); weak
void _alloc_osfhnd_sub_48763C();
// int __cdecl _commit(int a1, int file_descriptor);
void commit_call___unlock_fhandle();
// int __cdecl calloc(int a1, size_t num, size_t size);
// int __thiscall calloc_sub_4877AB(_DWORD); weak
// int _fcloseall(void); idb
void _fcloseall_sub_48784E();
// _DWORD __cdecl _getbuf(_DWORD); weak
// int __cdecl _sopen(const char *filename, int oflag, int shflag, int pmode); idb
// int __cdecl __crtInitCritSecAndSpinCount(LPCRITICAL_SECTION lpCriticalSection, int); idb
// _DWORD __cdecl _ld12cvt(_DWORD, _DWORD, _DWORD); weak
int __cdecl _ld12cvt_wrapper(int ld12cut_arg_1, int ld12cut_arg_2); // idb
int __cdecl _fassign_sub_sub_488F5F(int a1, int a2);
int __cdecl _fassign_sub_488F75(int ld12cut_arg_2, int a2);
int __cdecl _fassign_sub_488FB2(int a1, int a2);
// _DWORD __cdecl _87except(_DWORD, _DWORD, _DWORD); weak
// int __cdecl atexit(void (*func)(void)); idb
// signed int __cdecl x_ismbbtype(unsigned __int8 a1, int a2, unsigned __int8 a3);
// int __cdecl _chsize_lk(int, LONG lDistanceToMove); idb
// _DWORD __cdecl __addl(_DWORD, _DWORD, _DWORD); weak
// int __cdecl __shl_12(int a1);
// _DWORD __cdecl __shr_12(_DWORD); weak
// _DWORD __cdecl __strgtold12(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
int Return_0();
// int __usercall realloc_sub_48AF52@<eax>(int a1@<ebp>);
// int realloc_sub_48AF5A(void); weak
// _DWORD __cdecl _setmode_lk(_DWORD, _DWORD); weak
// int __cdecl __ascii_stricmp(_BYTE *a1, _BYTE *a2);
// __int32 __cdecl atol(const char *str); idb
// char __usercall xtoa@<al>(unsigned int a1@<eax>, char *a2@<ecx>, unsigned int a3, int a4);
// char *__cdecl _itoa(int value, char *str, int base); idb
// __int32 __cdecl __ansicp(LCID Locale);
// int __cdecl __convertcp(UINT CodePage, int a2, LPCSTR lpMultiByteStr, int a4, int MultiByte, int MultiByteCount, int MultiByteCounta);
// int __cdecl __ld12mul(int a1, int a2);
// double __cdecl _set_exp(double, _DWORD); weak
// long double __cdecl _decomp(double a1, int *a2);
// int __cdecl __ascii_strnicmp(char *first, char *last, unsigned int count);
// char *__cdecl strchr(const char *string, int chr); idb
// BOOL __stdcall VerQueryValueA(const LPVOID pBlock, LPSTR lpSubBlock, LPVOID *lplpBuffer, PUINT puLen); idb
// bool __stdcall GetFileVersionInfoA(LPSTR lptstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData);
// DWORD __stdcall GetFileVersionInfoSizeA(LPSTR lptstrFilename, LPDWORD lpdwHandle); idb
// BOOL __stdcall ImmReleaseContext(HWND, HIMC); idb
// BOOL __stdcall ImmSetOpenStatus(HIMC, BOOL); idb
// HIMC __stdcall ImmGetContext(HWND); idb
OrgData *Init_OrgData();
// HRESULT __stdcall DirectDrawCreate(GUID *lpGUID, LPDIRECTDRAW *lplpDD, IUnknown *pUnkOuter); idb
// HRESULT __stdcall DirectInputCreateA(HINSTANCE hinst, DWORD dwVersion, LPDIRECTINPUTA *ppDI, LPUNKNOWN punkOuter); idb
// HRESULT __stdcall DirectSoundCreate(LPGUID, LPDIRECTSOUND *, LPUNKNOWN); idb
// BOOL __stdcall StretchBlt(HDC, int, int, int, int, HDC, int, int, int, int, DWORD); idb
// int __stdcall SetBkMode(HDC, int); idb
// HGDIOBJ __stdcall SelectObject(HDC, HGDIOBJ); idb
// HGDIOBJ __stdcall GetStockObject(int); idb
// BOOL __stdcall DeleteDC(HDC); idb
// COLORREF __stdcall SetTextColor(HDC, COLORREF); idb
// BOOL __stdcall TextOutA(HDC, int, int, LPCSTR, int); idb
// HFONT __stdcall CreateFontA(int, int, int, int, int, DWORD, DWORD, DWORD, DWORD, DWORD, DWORD, DWORD, DWORD, LPCSTR); idb
// COLORREF __stdcall GetPixel(HDC, int, int); idb
// COLORREF __stdcall SetPixel(HDC, int, int, COLORREF); idb
// BOOL __stdcall DeleteObject(HGDIOBJ); idb
// int __stdcall GetObjectA(HGDIOBJ, int, LPVOID); idb
// HDC __stdcall CreateCompatibleDC(HDC); idb
// int __stdcall GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR PointerData, int DataCount); idb
// BOOL __stdcall SetEndOfFile(HANDLE hFile); idb
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cchMultiByte, LPWSTR lpWideCharStr, int cchWideChar); idb
// BOOL __stdcall GetCPInfo(UINT CodePage, LPCPINFO lpCPInfo); idb
// BOOL __stdcall FlushFileBuffers(HANDLE hFile); idb
// HRSRC __stdcall FindResourceA(HMODULE hModule, LPCSTR lpName, LPCSTR lpType); idb
// HGLOBAL __stdcall LoadResource(HMODULE hModule, HRSRC hResInfo); idb
// LPVOID __stdcall LockResource(HGLOBAL hResData); idb
// HANDLE __stdcall OpenMutexA(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCSTR lpName); idb
// HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName); idb
// BOOL __stdcall ReleaseMutex(HANDLE hMutex); idb
// void __stdcall OutputDebugStringA(LPCSTR lpOutputString); idb
// HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile); idb
// DWORD __stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh); idb
// BOOL __stdcall CloseHandle(HANDLE hObject); idb
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD Flags, LPCWSTR WideChar, int WideCharCount, LPSTR MultiByte, int MultiByteCount, LPCSTR DefaultChar, LPBOOL UsedDefaultChar); idb
// void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime); idb
// BOOL __stdcall SystemTimeToFileTime(PSCOPETABLE_ENTRY *lpSystemTime, LPFILETIME lpFileTime); idb
// LONG __stdcall CompareFileTime(EH3_EXCEPTION_REGISTRATION *lpFileTime1, EH3_EXCEPTION_REGISTRATION *lpFileTime2); idb
// BOOL __stdcall DeleteFileA(LPCSTR lpFileName); idb
// UINT __stdcall GetSystemDirectoryA(LPSTR lpBuffer, UINT uSize); idb
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize); idb
// HANDLE GetCurrentProcess(void); idb
// BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT uExitCode); idb
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName); idb
// void __stdcall Sleep(DWORD dwMilliseconds); idb
// DWORD GetTickCount(void); idb
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName); idb
// void __stdcall ExitProcess(UINT uExitCode); idb
// BOOL __stdcall HeapFree(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem); idb
// LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, DWORD dwBytes); idb
// void __stdcall GetStartupInfoA(LPSTARTUPINFOA lpStartupInfo); idb
// LPSTR GetCommandLineA(void); idb
// BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation); idb
// BOOL __stdcall QueryPerformanceCounter(FILE *lpPerformanceCount); idb
// DWORD GetCurrentThreadId(void); idb
// DWORD GetCurrentProcessId(void); idb
// void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime); idb
// DWORD GetLastError(void); idb
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection); idb
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection); idb
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped); idb
// void __stdcall SetLastError(DWORD dwErrCode); idb
// void __stdcall DragFinish(HDROP); idb
// UINT __stdcall DragQueryFileA(HDROP, UINT, LPSTR, UINT); idb
// HINSTANCE __stdcall ShellExecuteA(HWND hwnd, LPCSTR lpOperation, LPCSTR lpFile, LPCSTR lpParameters, LPCSTR lpDirectory, INT nShowCmd); idb
// BOOL __stdcall PathRemoveFileSpecA(LPSTR pszPath); idb
// BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect); idb
// BOOL __stdcall CheckDlgButton(HWND hDlg, int nIDButton, UINT uCheck); idb
// HANDLE __stdcall LoadImageA(HINSTANCE, LPCSTR, UINT, int, int, UINT); idb
// int __stdcall MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType); idb
// BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags); idb
// HWND __stdcall GetParent(HWND hWnd); idb
// UINT __stdcall IsDlgButtonChecked(HWND hDlg, int nIDButton); idb
// BOOL __stdcall SetDlgItemTextA(HWND hDlg, int nIDDlgItem, LPCSTR lpString); idb
// BOOL __stdcall EndDialog(HWND hDlg, int nResult); idb
// UINT __stdcall GetDlgItemTextA(HWND hDlg, int nIDDlgItem, LPSTR lpString, int nMaxCount); idb
// BOOL __stdcall PeekMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax, UINT wRemoveMsg); idb
// BOOL __stdcall GetMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax); idb
// BOOL __stdcall TranslateMessage(_STARTUPINFOA *lpMsg); idb
// LONG __stdcall DispatchMessageA(_STARTUPINFOA *lpMsg); idb
// BOOL __stdcall DeleteMenu(HMENU hMenu, UINT uPosition, UINT uFlags); idb
// BOOL __stdcall DrawMenuBar(HWND hWnd); idb
// LRESULT __stdcall DefWindowProcA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam); idb
// int __stdcall DialogBoxParamA(HINSTANCE hInstance, LPCSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam); idb
// BOOL __stdcall PostMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam); idb
// void __stdcall PostQuitMessage(int nExitCode); idb
// HCURSOR __stdcall LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName); idb
// HICON __stdcall LoadIconA(HINSTANCE hInstance, LPCSTR lpIconName); idb
// ATOM __stdcall RegisterClassExA(WNDCLASSEXA *);
// HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y, int nWidth, int nHeight, HWND hWndParent, HMENU hMenu, HINSTANCE hInstance, LPVOID lpParam); idb
// HMENU __stdcall GetMenu(HWND hWnd); idb
// int __stdcall ShowCursor(BOOL bShow); idb
// BOOL __stdcall SetWindowTextA(HWND hWnd, LPCSTR lpString); idb
// BOOL __stdcall GetWindowPlacement(HWND hWnd, RECT *lpwndpl); idb
// int __stdcall GetSystemMetrics(int nIndex); idb
// BOOL __stdcall MoveWindow(HWND hWnd, int X, int Y, int nWidth, int nHeight, BOOL bRepaint); idb
// BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow); idb
// BOOL __stdcall SystemParametersInfoA(UINT uiAction, UINT uiParam, PVOID pvParam, UINT fWinIni); idb
// BOOL __stdcall GetFileVersionInfoA(LPSTR lptstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData); idb
// MMRESULT __stdcall timeBeginPeriod(UINT uPeriod); idb
// MMRESULT __stdcall timeGetDevCaps(LPTIMECAPS ptc, UINT cbtc); idb
// MMRESULT __stdcall timeSetEvent(UINT uDelay, UINT uResolution, LPTIMECALLBACK fptc, DWORD dwUser, UINT fuEvent); idb
// DWORD timeGetTime(void); idb
// MMRESULT __stdcall timeEndPeriod(UINT uPeriod); idb
// MMRESULT __stdcall timeKillEvent(UINT uTimerID); idb

//-------------------------------------------------------------------------
// Data declarations

char byte_480D10 = '\x18'; // weak
char byte_48C42C[] = { '\\' }; // idb
FILE stream =
{
  (char *)0x252C7325,
  2660,
  (char *)0x255C7325,
  115,
  25202,
  626815781,
  115,
  (char *)0x6277
}; // idb
char Icon_Name[] = { '0' }; // idb
_SCOPETABLE_ENTRY stru_48CA78 = { 4294967295, NULL, &loc_480F97 }; // weak
_SCOPETABLE_ENTRY stru_48CAC8 = { 4294967295, NULL, &loc_4819C3 }; // weak
int Weapon_Icon_X_Offset = 16; // idb
char Weapon_Data_Damage[] = { '\0' }; // weak
char Weapon_Data_Num_Impacts[] = { '\0' }; // weak
int Weapon_Data_Max_Distance[] = { 0 }; // weak
int Weapon_Data_Behaviour_Flags[] = { 0 }; // weak
int Weapon_Data_Bullet_Size_Width[] = { 0 }; // weak
int Weapon_Data_Bullet_Size_Height[] = { 0 }; // weak
int Weapon_Data_Wall_Collision_X[] = { 0 }; // weak
int Weapon_Data_Wall_Collision_Y[] = { 0 }; // weak
int Weapon_Data_Pos_Offset_Left[] = { 0 }; // weak
int Weapon_Data_Pos_Offset_Up[] = { 0 }; // weak
int Weapon_Data_Pos_Offset_Right[] = { 0 }; // weak
int Weapon_Data_Pos_Offset_Down[] = { 0 }; // weak
int Effect_Table_View_Left[] = { 0 }; // weak
int Effect_Table_View_Top[] = { 0 }; // weak
Effect_function Effect_Function_Table[18] =
{
  &No_Effect,
  &Effect_1_Random_Fountain_Pulsing_Disc_Particles,
  &Effect_2_Rising_Disc_And_Exploding_Diamond,
  &Effect_3_Star,
  &Effect_4_Fireball_Impact,
  &Effect_5_ZzZ___,
  &Effect_4_Fireball_Impact,
  &Effect_6_Booster_Smoke,
  &Effect_7_Drowned_Quote,
  &Effect_8_Exclamation_Mark,
  &Effect_9_Level_Up_Or_Down,
  &Effect_10_Red_Damage_Rings,
  &Effect_11_Big_Explosion,
  &Effect_12_Headbump_Sparks,
  &Effect_13_Unknown_Unused,
  &Effect_14_Small_White_Explosion_Disc,
  &Effect_15_Nothing,
  &Effect_16_Push_Jump_Key
};
char *DOUKUTSU20041206 = "DOUKUTSU20041206"; // idb
char *Config_dat[2] =
{
  "Config.dat",
  "version.%d.%d.%d.%d\r\n2004/12/20 - %04d/%02d/%02d\r\nStudio Pixel"
}; // weak
char *oVersion_Thingy = "version.%d.%d.%d.%d\r\n2004/12/20 - %04d/%02d/%02d\r\nStudio Pixel"; // idb
int GraphicScale = 1; // weak
char *off_48F918 = "credit.tsc"; // weak
RECT Rect_Game = { 0, 0, 320, 240 }; // idb
RECT rect = { 0, 0, 320, 240 }; // idb
char *Image_Tag = "(C)Pixel"; // idb
int Snd_Data_Table = 1; // idb
int Ptr_Sound = 1; // idb
int dword_48FB00 = 1; // idb
int dword_48FBE0 = 1; // idb
int dword_48FC50 = 1; // idb
int dword_48FCC0 = 1; // idb
int dword_48FD30 = 1; // idb
int dword_48FE10 = 1; // idb
int dword_48FEF0 = 1; // idb
int dword_48FFD0 = 1; // idb
int dword_4900B0 = 1; // idb
int dword_490190 = 1; // idb
int dword_490350 = 1; // idb
int dword_490430 = 1; // idb
int dword_490580 = 1; // idb
int dword_490660 = 1; // idb
int dword_4906D0 = 1; // idb
int dword_490740 = 1; // idb
int dword_4907B0 = 1; // idb
int dword_490820 = 1; // idb
int dword_490890 = 1; // idb
int dword_490900 = 1; // idb
int dword_4909E0 = 1; // idb
int dword_490A50 = 1; // idb
int dword_490B30 = 1; // idb
int dword_490C10 = 1; // idb
int dword_490C80 = 1; // idb
int dword_490D60 = 1; // idb
int dword_490E40 = 1; // idb
int dword_490EB0 = 1; // idb
int dword_491000 = 1; // idb
int dword_4910E0 = 1; // idb
int dword_4911C0 = 1; // idb
int dword_491230 = 1; // idb
int dword_491310 = 1; // idb
int dword_491380 = 1; // idb
int dword_4913F0 = 1; // idb
int dword_491460 = 1; // idb
int dword_4915B0 = 1; // idb
int dword_491620 = 1; // idb
int dword_491700 = 1; // idb
int dword_491770 = 1; // idb
int unk_4917E0 = 1; // idb
int dword_4918C0 = 1; // idb
int dword_491930 = 1; // idb
int dword_491A80 = 1; // idb
int dword_491B60 = 1; // idb
int dword_491C40 = 1; // idb
int dword_491CB0 = 1; // idb
int dword_491D20 = 1; // idb
int dword_491D90 = 1; // idb
int dword_491E70 = 1; // idb
int dword_491EE0 = 1; // idb
int dword_491F50 = 1; // idb
int dword_491FC0 = 1; // idb
int dword_492030 = 1; // idb
int dword_4920A0 = 1; // idb
int dword_492110 = 1; // idb
int dword_492180 = 1; // idb
int dword_4921F0 = 1; // idb
int dword_4922D0 = 1; // idb
int dword_4923B0 = 1; // idb
int dword_492490 = 1; // idb
int dword_492500 = 1; // idb
int dword_492570 = 1; // idb
int dword_492650 = 1; // idb
int dword_492730 = 1; // idb
int dword_492810 = 1; // idb
int unk_4928F0 = 1; // idb
int dword_4929D0 = 1; // idb
int dword_492AB0 = 1; // idb
int dword_492C00 = 1; // idb
int dword_492C70 = 1; // idb
int dword_492DC0 = 1; // idb
int dword_492EA0 = 1; // idb
int dword_492F80 = 1; // idb
int dword_493060 = 1; // idb
int dword_4930D0 = 1; // idb
int dword_493140 = 1; // idb
int dword_4931B0 = 1; // idb
int dword_493290 = 1; // idb
int dword_493370 = 1; // idb
int dword_493450 = 1; // idb
int dword_4934C0 = 1; // idb
int dword_493530 = 1; // idb
int dword_4935A0 = 1; // idb
int Key_Jump = 64; // weak
int Key_Shoot = 32; // weak
int Key_For_Next_Weapon = 128; // weak
int Key_For_Prev_Weapon = 256; // weak
int Key_For_Menu = 4096; // weak
int Key_For_Minimap = 16; // weak
int Key_Ok = 64; // weak
int Key_Cancel = 32; // weak
int Key_Left = 1; // weak
int Key_Up = 4; // weak
int Key_Right = 2; // weak
int Key_Down = 8; // weak
LPCSTR Window_Name = "Cave Story ~ Doukutsu Monogatari"; // idb
int dword_493644 = 1; // weak
LPCSTR oDoukutsu = "Doukutsu"; // idb
void *PXM = &aPxm; // idb
RECT stru_493650 = { 0, 0, 160, 12 }; // idb
Weapon_EXP_values Weapon_Level_Table[14] =
{
  { { 0, 0, 100 } },
  { { 30, 40, 16 } },
  { { 10, 20, 10 } },
  { { 10, 20, 20 } },
  { { 30, 40, 10 } },
  { { 10, 20, 10 } },
  { { 10, 20, 30 } },
  { { 10, 20, 5 } },
  { { 10, 20, 100 } },
  { { 30, 60, 0 } },
  { { 30, 60, 10 } },
  { { 10, 20, 100 } },
  { { 1, 1, 1 } },
  { { 40, 60, 200 } }
};
OCTWAVE oct_wave[8] =
{
  { 256, 1, 4 },
  { 256, 2, 8 },
  { 128, 4, 12 },
  { 128, 8, 16 },
  { 64, 16, 20 },
  { 32, 32, 24 },
  { 16, 64, 28 },
  { 8, 128, 32 }
};
BYTE format_tbl2[] =
{
  1u,
  0u,
  1u,
  0u,
  34u,
  86u,
  0u,
  0u,
  34u,
  86u,
  0u,
  0u,
  1u,
  0u,
  8u,
  0u,
  0u,
  0u,
  0u,
  0u
};
__int16 freq_tbl[12] = { 262, 277, 294, 311, 330, 349, 370, 392, 415, 440, 466, 494 };
__int16 pan_tbl[13] = { 0, 43, 86, 129, 172, 215, 256, 297, 340, 383, 426, 469, 512 };
unsigned __int8 old_key[16] =
{
  255u,
  255u,
  255u,
  255u,
  255u,
  255u,
  255u,
  255u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
};
UINT ExactTime = 13u; // idb
int Volume = 100;
char *Default_Name = "Profile.dat";
void *offset_Profile_dat_check = &Profile_dat_Check; // idb
Map_Header_Struct Map_Headers[] =
{
  {
    {
      '0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0',
      '\0'
    },
    "0",
    4,
    "bk0",
    "Guest",
    "0",
    '\0',
    "Null"
  }
};
char *off_4981E8[42] =
{
  "XXXX",
  "WANPAKU",
  "ANZEN",
  "GAMEOVER",
  "GRAVITY",
  "WEED",
  "MDOWN2",
  "FIREEYE",
  "VIVI",
  "MURA",
  "FANFALE1",
  "GINSUKE",
  "CEMETERY",
  "PLANT",
  "KODOU",
  "FANFALE3",
  "FANFALE2",
  "DR",
  "ESCAPE",
  "JENKA",
  "MAZE",
  "ACCESS",
  "IRONH",
  "GRAND",
  "Curly",
  "OSIDE",
  "REQUIEM",
  "WANPAK2",
  "QUIET",
  "LASTCAVE",
  "BALCONY",
  "LASTBTL",
  "LASTBT3",
  "ENDING",
  "ZONBIE",
  "BDOWN",
  "HELL",
  "JENKA2",
  "MARINE",
  "BALLOS",
  "TOROKO",
  "WHITE"
};
RECT unk_498290 = { 0, 0, 216, 16 }; // idb
int unk_498298 = 216; // idb
int unk_49829C = 16; // idb
_UNKNOWN unk_4982A0; // weak
_UNKNOWN unk_4983F0; // weak
void *PassPixEve = &aPxe; // idb
void (__cdecl *NPC_Function_Table[361])(NPC_vars *a1) =
{
  &NPC0_Nothing,
  &NPC1_Weapon_Energy,
  &NPC2_Enemy_Behemoth,
  &NPC3_Deletes_Itself,
  &NPC4_Smoke,
  &NPC5_Enemy_Critter_Hopping_Green,
  &NPC6_Enemy_Beetle_Horiz_Green,
  &NPC7_Enemy_Basil,
  &NPC8_Enemy_Beetle_Follow1,
  &NPC9_Balrog_DropIn,
  &NPC10_Boss_Balrog_Shooting,
  &NPC11_Projectile_Balrog_Energy_Bounce,
  &NPC12_Balrog_Cutscene,
  &NPC13_Forcefield,
  &NPC14_Santas_Key,
  &NPC15_Treasure_Chest_Closed,
  &NPC16,
  &NPC17,
  &NPC18,
  &NPC19,
  &NPC20,
  &NPC21,
  &NPC22,
  &NPC23,
  &NPC24,
  &NPC25,
  &NPC26,
  &NPC27,
  &NPC28,
  &NPC29,
  &NPC30,
  &NPC31,
  &NPC32,
  &NPC33,
  &NPC34,
  &NPC35,
  &NPC36,
  &NPC37,
  &NPC38,
  &NPC39,
  &NPC40,
  &NPC41,
  &NPC42,
  &NPC43,
  &NPC44,
  &NPC45,
  &NPC46,
  &NPC47,
  &NPC48,
  &NPC49,
  &NPC50,
  &NPC51,
  &NPC52_Sitting_Blue_Bot,
  &NPC53,
  &NPC54,
  &NPC55,
  &NPC56,
  &NPC57,
  &NPC58,
  &NPC59,
  &NPC60,
  &NPC61,
  &NPC62,
  &NPC63,
  &NPC64,
  &NPC65,
  &NPC66,
  &NPC67,
  &NPC68,
  &NPC69,
  &NPC70,
  &NPC71,
  &NPC72,
  &NPC73,
  &NPC74,
  &NPC75,
  &NPC76,
  &NPC77_Sandaim_the_Farmer,
  &NPC78_Pot,
  &NPC79,
  &NPC80,
  &NPC81,
  &NPC82,
  &NPC83,
  &NPC84,
  &NPC85,
  &NPC86,
  &NPC87,
  &NPC88,
  &NPC89,
  &NPC90,
  &NPC91,
  &NPC92,
  &NPC93,
  &NPC94_Giant_Jelly,
  &NPC95,
  &NPC96,
  &NPC97,
  &NPC98,
  &NPC99,
  &NPC100,
  &NPC101,
  &NPC102,
  &NPC103,
  &NPC104,
  &NPC105,
  &NPC106,
  &NPC107,
  &NPC108,
  &NPC109,
  &NPC110,
  &NPC111,
  &NPC112,
  &NPC113,
  &NPC114,
  &NPC115,
  &NPC116,
  &NPC117,
  &NPC118,
  &NPC119,
  &NPC120,
  &NPC121,
  &NPC122,
  &NPC123,
  &NPC124,
  &NPC125,
  &NPC126,
  &NPC127,
  &NPC128,
  &NPC129,
  &NPC130,
  &NPC131,
  &NPC132,
  &NPC133,
  &NPC134,
  &NPC135,
  &NPC136,
  &NPC137,
  &NPC138,
  &NPC139,
  &NPC140,
  &NPC141,
  &NPC142,
  &NPC143,
  &NPC144,
  &NPC145,
  &NPC146,
  &NPC147,
  &NPC148,
  &NPC149,
  &NPC150,
  &NPC151,
  &NPC152,
  &NPC153,
  &NPC154,
  &NPC155,
  &NPC156,
  &NPC157,
  &NPC158,
  &NPC159,
  &NPC160,
  &NPC161,
  &NPC162,
  &NPC163,
  &NPC164,
  &NPC165,
  &NPC166,
  &NPC167,
  &NPC168,
  &NPC169,
  &NPC170,
  &NPC171,
  &NPC172,
  &NPC173,
  &NPC174,
  &NPC175,
  &NPC176,
  &NPC177,
  &NPC178,
  &NPC179,
  &NPC180,
  &NPC181,
  &NPC182,
  &NPC183,
  &NPC184,
  &NPC185,
  &NPC186,
  &NPC187,
  &NPC188,
  &NPC189,
  &NPC190,
  &NPC191,
  &NPC192,
  &NPC193,
  &NPC194,
  &NPC195,
  &NPC196,
  &NPC197,
  &NPC198,
  &NPC199,
  &NPC200,
  &NPC201,
  &NPC202,
  &NPC203,
  &NPC204,
  &NPC205,
  &NPC206,
  &NPC207,
  &NPC208,
  &NPC209,
  &NPC210,
  &NPC211,
  &NPC212,
  &NPC213,
  &NPC214,
  &NPC215,
  &NPC216_Debug_Cat,
  &NPC217,
  &NPC218,
  &NPC219,
  &NPC220,
  &NPC221,
  &NPC222,
  &NPC223,
  &NPC224,
  &NPC225,
  &NPC226,
  &NPC227_Bucket,
  &NPC228,
  &NPC229,
  &NPC230,
  &NPC231,
  &NPC232,
  &NPC233,
  &NPC234,
  &NPC235,
  &NPC236,
  &NPC237,
  &NPC238,
  &NPC239,
  &NPC240,
  &NPC241,
  &NPC242,
  &NPC243,
  &NPC244,
  &NPC245,
  &NPC246,
  &NPC247,
  &NPC248,
  &NPC249,
  &NPC250,
  &NPC251,
  &NPC252,
  &NPC253,
  &NPC254,
  &NPC255,
  &NPC256,
  &NPC257,
  &NPC258,
  &NPC259,
  &NPC260,
  &NPC261,
  &NPC262,
  &NPC263,
  &NPC264,
  &NPC265,
  &NPC266,
  &NPC267,
  &NPC268,
  &NPC269,
  &NPC270,
  &NPC271,
  &NPC272,
  &NPC273,
  &NPC274,
  &NPC275,
  &NPC276,
  &NPC277,
  &NPC278,
  &NPC279,
  &NPC280,
  &NPC281,
  &NPC282,
  &NPC283,
  &NPC284,
  &NPC285,
  &NPC286,
  &NPC287,
  &NPC288,
  &NPC289,
  &NPC290,
  &NPC291,
  &NPC292,
  &NPC293,
  &NPC294,
  &NPC295,
  &NPC296,
  &NPC297,
  &NPC298,
  &NPC299,
  &NPC300,
  &NPC301,
  &NPC302,
  &NPC303,
  &NPC304,
  &NPC305,
  &NPC306,
  &NPC307,
  &NPC308,
  &NPC309,
  &NPC310,
  &NPC311,
  &NPC312,
  &NPC313,
  &NPC314,
  &NPC315,
  &NPC316,
  &NPC317,
  &NPC318,
  &NPC319,
  &NPC320,
  &NPC321,
  &NPC322,
  &NPC323,
  &NPC324,
  &NPC325,
  &NPC326,
  &NPC327,
  &NPC328,
  &NPC329,
  &NPC330,
  &NPC331,
  &NPC332,
  &NPC333,
  &NPC334,
  &NPC335,
  &NPC336,
  &NPC337,
  &NPC338,
  &NPC339,
  &NPC340,
  &NPC341,
  &NPC342,
  &NPC343,
  &NPC344,
  &NPC345,
  &NPC346,
  &NPC347,
  &NPC348,
  &NPC349,
  &NPC350,
  &NPC351,
  &NPC352,
  &NPC353,
  &NPC354,
  &NPC355,
  &NPC356,
  &NPC357,
  &NPC358,
  &NPC359,
  &NPC360_Thank_You
};
int (__cdecl *Boss_Function_Table[13])(_DWORD) =
{
  &Boss0_NoSpecialBoss,
  &Boss_1_Omega,
  &Boss_2_Balfrog,
  &Boss_3_Monster_X,
  &Boss_4_Core,
  &Boss_5_Ironhead,
  &Boss_6_Dragon_Sisters,
  &Boss_7_Undead_Core,
  &Boss_8_Heavy_Press,
  &Boss_9_Ballos_Ball,
  NULL,
  NULL,
  NULL
}; // idb
int dword_4994F0 = 1024; // weak
_UNKNOWN unk_499508; // weak
int Quote_Inventory_minus_1[] = { 0 }; // weak
Item_Data Quote_Inventory[32] =
{
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 },
  { 0 }
};
int Inventory_Active = 0; // weak
int Inventory_Label_Position = 0; // idb
Weapon_vars Weapons[8] =
{
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0 }
};
int Selected_Weapon = 0; // weak
int Selected_Item = 0; // weak
unsigned int MenuRectFlash = 0u;
Background_vars Current_Background = { 0, 0, 0, 0, 0, 0, 0 };
int GlobalWaterDepth = 0; // weak
int color_black = 0; // weak
Bullet_vars Bullet_Objects[64] =
{
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    { 0, 0, 0, 0 }
  },
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    { 0, 0, 0, 0 }
  },
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    { 0, 0, 0, 0 }
  },
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    { 0, 0, 0, 0 }
  },
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    { 0, 0, 0, 0 }
  },
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    { 0, 0, 0, 0 }
  },
  {
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0u,
    { 0, 0, 0, 0 },
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    
  }
};
int dword_49BC98; // weak
int dword_49BC9C; // weak
int dword_49BCA0; // weak
Effect_vars Effect_Objects[40];
_UNKNOWN Screen_Offset_X; // weak
_DWORD Screen_Offset_Y;
RECT Window_Idk;
int IsFullScreen; // weak
LPDIRECTDRAWCLIPPER Clip_List_Maybe;
char Names_Thingy[];
int dword_49CDDC[]; // idb
int dword_49CDE0[]; // idb
int dword_49CDE4[]; // idb
int dword_49CDE8[]; // idb
HGDIOBJ Font_Handle[];
int Fullscreen_Surface_Height; // weak
int Window_Surface_Width; // weak
LPDIRECTDRAW Direct_Draw_Obj;
LPDIRECTDRAWSURFACE DD7_Final_Screen_Surface;
LPDIRECTDRAWSURFACE DD7_Screen_Surface;
LPDIRECTDRAWSURFACE Image_Res_Surface[];
RECT Final_Screen_Dist_Rects;
int Previous_Tick_Count; // weak
int Current_Tick_Count; // weak
RECT RECT_ScreenCopy;
void DDBLTFX_ScreenCopy; // idb
RECT Final_Dst_Rect_1;
RECT rcWork;
RECT Final_Dst_Rect_2;
RECT Final_Src_Rect_2;
RECT Final_Dst_Rect_3;
RECT Final_Src_Rect_3;
RECT Dest_Rect;
void Draw_Colour_Fill_DDBLTFX[]; // idb
char Draw_Colour_Fill_DDBLTFX_dxFillColor[20]; // weak
RECT Final_Dst_Rect_5;
void Draw_Colour_Fill_Onto_Surface_DDBLTFX[]; // idb
char Draw_Colour_Fill_Onto_Surface_DDBLTFX_dxFillColor[24]; // weak
Illustration_vars Credit_Pic;
TSC_vars Credit_Script;
Text_Obj_vars Text_Object_Array[16];
int Mask_Color; // idb
Fade_vars Fade_Obj;
_BYTE SkipFlags[8];
_BYTE Event_Flags[1000];
Flash_vars Flash;
int FlashColor; // idb
Camera_vars Camera;
int CursorPosition; // weak
int Game_Flags; // weak
int GameTime; // weak
LPDIRECTINPUTA DirectInputObj; // idb
int dword_49E1F4; // weak
int dword_49E1F8; // weak
int dword_49E1FC; // weak
int dword_49E200; // weak
int dword_49E204; // weak
int dword_49E208; // weak
int dword_49E20C; // weak
int Key_Held; // weak
int Key_Pressed; // weak
int LastKeyHeld; // weak
char dataPath[]; // idb
char ExePath[]; // idb
int Joystick_Button_Table[]; // weak
HINSTANCE AppInstance; // idb
int Window_Width; // weak
int Window_Height; // weak
HWND AppWinHandle; // idb
int Use_Joystick; // weak
int Is_Fullscreen; // weak
int FPS_Counter_Enabled; // weak
int CanAcceptInput; // weak
int Timer1000Time; // weak
int Timer1000Elapsed; // weak
int Timer1000Ticks; // weak
HANDLE hMutex; // idb
HANDLE hObject; // idb
Map_Data Current_Map;
char Draw_Map_Data_Vector::count; // weak
MapName Map_Name;
char Map_Flag_Array[128];
Player Quote;
int Noise_Num; // weak
DWORD Noise_Frequency; // idb
int Nikumaru_Counter; // weak
char byte_49E6F8; // weak
char wave_data[25600];
__int32 Play_Position;
NOTELIST *np[16];
LPDIRECTSOUNDBUFFER lpORGANBUFFER[8][8][2];
int mute[16];
unsigned __int8 key_on[16];
unsigned __int8 key_twin[16];
UINT TimerID; // idb
int IsTimerActive; // weak
__int32 Note_Lengths[8];
int Track_Volume[16];
int Music_Fade_Flag_Maybe; // weak
OrgData Music_Object; // idb
char byte_4A4F00[]; // weak
int dword_4A54F8[]; // weak
int dword_4A54FC[]; // weak
Permit_Stage_struct Unlocked_Stages[8];
int Y_Position_Teleporter; // idb
int Selected_Stage; // weak
int dword_4A5548; // weak
int Empty_Effect_Timer; // weak
int dword_4A5550; // weak
int Machine_Gun_Reload_Timer; // weak
int Bubbler_Lvl_1_Refill_Timer; // weak
int dword_4A555C; // weak
int dword_4A5560; // weak
int dword_4A5564; // weak
LPDIRECTSOUNDBUFFER lpSECONDARYBUFFER[150];
LPDIRECTSOUNDBUFFER lpDRAMBUFFER[8];
LPDIRECTSOUND lpDS; // idb
LPDIRECTSOUNDBUFFER lpPRIMARYBUFFER;
int Current_Stage_Num; // weak
int Current_Song_Number; // weak
int Old_Song_Pos; // weak
int Old_Song_Number; // weak
Effect_vars Whimsical_Star[3];
int CurrentStarID; // weak
Map_Data2 textBuffer;
size_t size; // idb
unsigned __int8 *scriptBuffer; // idb
char byte_4A5ADC; // weak
char byte_4A5ADD; // weak
int Script_Pos; // idb
int TextColumn; // weak
DWORD dword_4A5AE8[5];
int dword_4A5AEC[]; // weak
int dword_4A5AFC; // weak
int dword_4A5B00; // weak
int dword_4A5B04; // weak
char byte_4A5B08; // weak
int Face_Num; // weak
int dword_4A5B10; // weak
int dword_4A5B14; // weak
int YPos; // idb
RECT rcView;
int dword_4A5B2C; // weak
char byte_4A5B30; // weak
int NumberTextScript[4];
int Sin_Table[]; // weak
__int16 gTan[]; // weak
int Event_Index; // weak
void Event_InUse; // idb
int Event_Collision[]; // weak
int Event_X_Position[]; // weak
int Event_Y_Position[]; // weak
int Event_X_Velocity[]; // weak
int Event_Y_Velocity[]; // weak
int Event_AltVel_X[]; // weak
int Event_AltVel_Y[]; // weak
int Event_Unknown1[]; // weak
int Event_Unknown2[]; // weak
int dword_4A6218; // weak
NPC_vars NPC_Objects[512];
int Curly_Shoot_Wait; // weak
int Curly_Shoot_X; // weak
int Curly_Shoot_Y; // weak
int Super_X_Pos; // weak
int Super_Y_Pos; // weak
NPC_Info *NPC_Table;
_UNKNOWN NPCStruct_Tileset; // weak
_UNKNOWN NPCStruct_DeathSnd; // weak
_UNKNOWN NPCStruct_Exp; // weak
_UNKNOWN NPCStruct_Damage; // weak
unsigned __int8 byte_4BBA41[3]; // idb
Boss_Struct Boss_Thing;
NPC_vars Boss_Objects[20];
char byte_4BC7C8; // weak
char byte_4BC7C9; // weak
int dword_4BD034; // weak


//----- (00401000) --------------------------------------------------------
// Clear Weapons
void Clear_Weapon_Data(void)
{
  Weapon_Icon_X_Offset = 32;
  memset(Weapons, 0, 0xA0u);
}

//----- (00401030) --------------------------------------------------------
// Clear Inventory
void Clear_Item_Data(void)
{
  memset(Quote_Inventory, 0, 0x80u);
}

//----- (00401050) --------------------------------------------------------
// TSC Give Weapon [AM+]
int __cdecl Add_Weapon(int Weapon_ID, int Weapon_Max_Ammo)
{
  int result; // eax@7
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8 && Weapons[i].ID != Weapon_ID && Weapons[i].ID; ++i )
    ;
  if ( i == 8 )
  {
    result = 0;
  }
  else
  {
    if ( !Weapons[i].ID )
    {
      memset(&Weapons[i], 0, 0x14u);
      Weapons[i].Level = 1;
    }
    Weapons[i].ID = Weapon_ID;
    Weapons[i].Max_Ammo += Weapon_Max_Ammo;
    Weapons[i].Ammo += Weapon_Max_Ammo;
    if ( Weapons[i].Ammo > Weapons[i].Max_Ammo )
      Weapons[i].Ammo = Weapons[i].Max_Ammo;
    result = 1;
  }
  return result;
}

//----- (00401160) --------------------------------------------------------
// TSC Lose Weapon [AM-]
int __cdecl Lose_Weapon(int Weapon_To_Lose)
{
  int result; // eax@6
  Weapon_vars *v2; // edx@9
  Weapon_vars *v3; // eax@9
  signed int i; // [sp+0h] [bp-4h]@1
  int j; // [sp+0h] [bp-4h]@7

  for ( i = 0; i < 8 && Weapons[i].ID != Weapon_To_Lose; ++i )
    ;
  if ( i == 32 )
  {
    result = 0;
  }
  else
  {
    for ( j = i + 1; j < 8; ++j )
    {
      v2 = &Weapons[j];
      v3 = &Weapons[j - 1];
      v3->ID = v2->ID;
      v3->Level = v2->Level;
      v3->EXP = v2->EXP;
      v3->Max_Ammo = v2->Max_Ammo;
      v3->Ammo = v2->Ammo;
    }
    Weapons[j - 1].ID = 0;
    Selected_Weapon = 0;
    result = 1;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00401220) --------------------------------------------------------
// TSC Trade Weapon [TAM]
signed int __cdecl Trade_Weapon(int Weapon_To_Lose, int Weapon_To_Get, int New_Max_Ammo)
{
  signed int result; // eax@6
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8 && Weapons[i].ID != Weapon_To_Lose; ++i )
    ;
  if ( i == 8 )
  {
    result = 0;
  }
  else
  {
    Weapons[i].Level = 1;
    Weapons[i].ID = Weapon_To_Get;
    Weapons[i].Max_Ammo += New_Max_Ammo;
    Weapons[i].Ammo += New_Max_Ammo;
    Weapons[i].EXP = 0;
    result = 1;
  }
  return result;
}

//----- (004012D0) --------------------------------------------------------
signed int __cdecl Add_Item_Data(int code)
{
  signed int result; // eax@7
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 32 && Quote_Inventory[i].code != code && Quote_Inventory[i].code; ++i )
    ;
  if ( i == 32 )
  {
    result = 0;
  }
  else
  {
    Quote_Inventory[i].code = code;
    result = 1;
  }
  return result;
}

//----- (00401330) --------------------------------------------------------
signed int __cdecl Sub_Item_Data(int code)
{
  signed int result; // eax@6
  signed int i; // [sp+0h] [bp-4h]@1
  int j; // [sp+0h] [bp-4h]@7

  for ( i = 0; i < 32 && Quote_Inventory[i].code != code; ++i )
    ;
  if ( i == 32 )
  {
    result = 0;
  }
  else
  {
    for ( j = i + 1; j < 32; ++j )
      Quote_Inventory_minus_1[j] = Quote_Inventory[j].code;
    Quote_Inventory_minus_1[j] = 0;
    Selected_Item = 0;
    result = 1;
  }
  return result;
}
// 499B3C: using guessed type int Quote_Inventory_minus_1[];
// 499C6C: using guessed type int Selected_Item;

//----- (004013C0) --------------------------------------------------------
// Manage Inventory Cursor
int Move_Inventory_Cursor()
{
  int result; // eax@2
  signed int v1; // [sp+0h] [bp-Ch]@8
  int v2; // [sp+4h] [bp-8h]@1
  int v3; // [sp+8h] [bp-4h]@1

  v2 = 0;
  v3 = 0;
  while ( 1 )
  {
    result = 20 * v2;
    if ( !Weapons[v2].ID )
      break;
    ++v2;
  }
  while ( Quote_Inventory[v3].code )
    result = v3++ + 1;
  if ( v2 || v3 )
  {
    v1 = 0;
    if ( Inventory_Active )
    {
      if ( Key_Left & Key_Pressed )
      {
        if ( Selected_Item % 6 )
          --Selected_Item;
        else
          Selected_Item += 5;
        v1 = 1;
      }
      if ( Key_Right & Key_Pressed )
      {
        if ( Selected_Item == v3 - 1 )
        {
          Selected_Item = 6 * (Selected_Item / 6);
        }
        else if ( Selected_Item % 6 == 5 )
        {
          Selected_Item -= 5;
        }
        else
        {
          ++Selected_Item;
        }
        v1 = 1;
      }
      if ( Key_Up & Key_Pressed )
      {
        if ( Selected_Item / 6 )
          Selected_Item -= 6;
        else
          Inventory_Active = 0;
        v1 = 1;
      }
      if ( Key_Down & Key_Pressed )
      {
        if ( Selected_Item / 6 == (v3 - 1) / 6 )
          Inventory_Active = 0;
        else
          Selected_Item += 6;
        v1 = 1;
      }
      result = Selected_Item;
      if ( Selected_Item >= v3 )
        Selected_Item = v3 - 1;
      if ( Inventory_Active && Key_Ok & Key_Pressed )
        result = Start_TSC_Event(Quote_Inventory[Selected_Item].code + 6000);
    }
    else
    {
      if ( Key_Left & Key_Pressed )
      {
        --Selected_Weapon;
        v1 = 1;
      }
      result = Key_Right & Key_Pressed;
      if ( Key_Right & Key_Pressed )
      {
        ++Selected_Weapon;
        v1 = 1;
      }
      if ( Key_Pressed & (Key_Down | Key_Up) )
      {
        if ( v3 )
          Inventory_Active = 1;
        v1 = 1;
      }
      if ( Selected_Weapon < 0 )
      {
        result = v2 - 1;
        Selected_Weapon = v2 - 1;
      }
      if ( Selected_Weapon > v2 - 1 )
        Selected_Weapon = 0;
    }
    if ( v1 )
    {
      if ( Inventory_Active )
      {
        Play_Sound_Effect(Sfx_Y_N_Change_Choice, 1);
        if ( v3 )
          result = Start_TSC_Event(Quote_Inventory[Selected_Item].code + 5000);
        else
          result = Start_TSC_Event(5000);
      }
      else
      {
        Play_Sound_Effect(Sfx_Switch_Weapon, 1);
        if ( v2 )
          result = Start_TSC_Event(Weapons[Selected_Weapon].ID + 1000);
        else
          result = Start_TSC_Event(1000);
      }
    }
  }
  return result;
}
// 493628: using guessed type int Key_Ok;
// 493630: using guessed type int Key_Left;
// 493634: using guessed type int Key_Up;
// 493638: using guessed type int Key_Right;
// 49363C: using guessed type int Key_Down;
// 499BC0: using guessed type int Inventory_Active;
// 499C68: using guessed type int Selected_Weapon;
// 499C6C: using guessed type int Selected_Item;
// 49E214: using guessed type int Key_Pressed;

//----- (004016F0) --------------------------------------------------------
void Draw_Inventory_Window()
{
  RECT Rect_None; // [sp+0h] [bp-F4h]@1
  RECT Rect_View; // [sp+10h] [bp-E4h]@1
  RECT Rect_Box_Bottom; // [sp+20h] [bp-D4h]@1
  RECT Rect_Item; // [sp+30h] [bp-C4h]@22
  RECT Rect_Cursor_2[2]; // [sp+40h] [bp-B4h]@1
  RECT Rect_Per; // [sp+60h] [bp-94h]@1
  RECT Rect_Weapon; // [sp+70h] [bp-84h]@12
  RECT Rect_Level; // [sp+80h] [bp-74h]@1
  RECT Rect_Cursor_1[2]; // [sp+90h] [bp-64h]@1
  RECT Rect_Title_1; // [sp+B0h] [bp-44h]@1
  int i; // [sp+C0h] [bp-34h]@1
  RECT Rect_Box_Body; // [sp+C4h] [bp-30h]@1
  RECT Rect_Box_Top; // [sp+D4h] [bp-20h]@1
  RECT Rect_Title_2; // [sp+E4h] [bp-10h]@1

  Rect_Per.left = 72;
  Rect_Per.top = 48;
  Rect_Per.right = 80;
  Rect_Per.bottom = 56;
  Rect_None.left = 80;
  Rect_None.top = 48;
  Rect_None.right = 96;
  Rect_None.bottom = 56;
  Rect_Level.left = 80;
  Rect_Level.top = 80;
  Rect_Level.right = 96;
  Rect_Level.bottom = 88;
  Rect_View.left = 0;
  Rect_View.top = 0;
  Rect_View.right = 320;
  Rect_View.bottom = 240;
  Rect_Cursor_1[0].left = 0;
  Rect_Cursor_1[0].top = 88;
  Rect_Cursor_1[0].right = 40;
  Rect_Cursor_1[0].bottom = 128;
  Rect_Cursor_1[1].left = 40;
  Rect_Cursor_1[1].top = 88;
  Rect_Cursor_1[1].right = 80;
  Rect_Cursor_1[1].bottom = 128;
  Rect_Cursor_2[0].left = 80;
  Rect_Cursor_2[0].top = 88;
  Rect_Cursor_2[0].right = 112;
  Rect_Cursor_2[0].bottom = 104;
  Rect_Cursor_2[1].left = 80;
  Rect_Cursor_2[1].top = 104;
  Rect_Cursor_2[1].right = 112;
  Rect_Cursor_2[1].bottom = 120;
  Rect_Title_1.left = 80;
  Rect_Title_1.top = 48;
  Rect_Title_1.right = 144;
  Rect_Title_1.bottom = 56;
  Rect_Title_2.left = 80;
  Rect_Title_2.top = 56;
  Rect_Title_2.right = 144;
  Rect_Title_2.bottom = 64;
  Rect_Box_Top.left = 0;
  Rect_Box_Top.top = 0;
  Rect_Box_Top.right = 244;
  Rect_Box_Top.bottom = 8;
  Rect_Box_Body.left = 0;
  Rect_Box_Body.top = 8;
  Rect_Box_Body.right = 244;
  Rect_Box_Body.bottom = 16;
  Rect_Box_Bottom.left = 0;
  Rect_Box_Bottom.top = 16;
  Rect_Box_Bottom.right = 244;
  Rect_Box_Bottom.bottom = 24;
  Draw_Bitmap_With_Transparency(&Rect_View, 38, 8, &Rect_Box_Top, 26);
  for ( i = 1; i < 18; ++i )
    Draw_Bitmap_With_Transparency(&Rect_View, 38, 8 * i + 8, &Rect_Box_Body, 26);
  Draw_Bitmap_With_Transparency(&Rect_View, 38, 8 * i + 8, &Rect_Box_Bottom, 26);
  if ( Inventory_Label_Position > 16 )
    --Inventory_Label_Position;
  Draw_Bitmap_With_Transparency(&Rect_View, 48, Inventory_Label_Position, &Rect_Title_1, 26);
  Draw_Bitmap_With_Transparency(&Rect_View, 48, Inventory_Label_Position + 52, &Rect_Title_2, 26);
  ++MenuRectFlash;
  if ( Inventory_Active )
    Draw_Bitmap_With_Transparency(&Rect_View, 40 * Selected_Weapon + 48, 24, &Rect_Cursor_1[1], 26);
  else
    Draw_Bitmap_With_Transparency(
      &Rect_View,
      40 * Selected_Weapon + 48,
      24,
      &Rect_Cursor_1[(MenuRectFlash >> 1) % 2],
      26);
  for ( i = 0; i < 8 && Weapons[i].ID; ++i )
  {
    Rect_Weapon.left = 16 * (Weapons[i].ID % 16);
    Rect_Weapon.right = Rect_Weapon.left + 16;
    Rect_Weapon.top = 16 * (Weapons[i].ID / 16);
    Rect_Weapon.bottom = Rect_Weapon.top + 16;
    Draw_Bitmap_With_Transparency(&Rect_View, 40 * i + 48, 24, &Rect_Weapon, 12);
    Draw_Bitmap_With_Transparency(&Rect_View, 40 * i + 48, 56, &Rect_Per, 26);
    Draw_Bitmap_With_Transparency(&Rect_View, 40 * i + 48, 40, &Rect_Level, 26);
    Draw_Numbers(40 * i + 48, 40, Weapons[i].Level, 0);
    if ( Weapons[i].Max_Ammo )
    {
      Draw_Numbers(40 * i + 48, 48, Weapons[i].Ammo, 0);
      Draw_Numbers(40 * i + 48, 56, Weapons[i].Max_Ammo, 0);
    }
    else
    {
      Draw_Bitmap_With_Transparency(&Rect_View, 40 * i + 64, 48, &Rect_None, 26);
      Draw_Bitmap_With_Transparency(&Rect_View, 40 * i + 64, 56, &Rect_None, 26);
    }
  }
  if ( Inventory_Active == 1 )
    Draw_Bitmap_With_Transparency(
      &Rect_View,
      32 * (Selected_Item % 6) + 48,
      16 * (Selected_Item / 6) + 76,
      &Rect_Cursor_2[(MenuRectFlash >> 1) % 2],
      26);
  else
    Draw_Bitmap_With_Transparency(
      &Rect_View,
      32 * (Selected_Item % 6) + 48,
      16 * (Selected_Item / 6) + 76,
      &Rect_Cursor_2[1],
      26);
  for ( i = 0; i < 32 && Quote_Inventory[i].code; ++i )
  {
    Rect_Item.left = 32 * (Quote_Inventory[i].code % 8);
    Rect_Item.right = Rect_Item.left + 32;
    Rect_Item.top = 16 * (Quote_Inventory[i].code / 8);
    Rect_Item.bottom = Rect_Item.top + 16;
    Draw_Bitmap_With_Transparency(&Rect_View, 32 * (i % 6) + 48, 16 * (i / 6) + 76, &Rect_Item, 8);
  }
}
// 499BC0: using guessed type int Inventory_Active;
// 499C68: using guessed type int Selected_Weapon;
// 499C6C: using guessed type int Selected_Item;

//----- (00401D10) --------------------------------------------------------
signed int Inventory_Loop()
{
  int ret_TSC_Parser; // [sp+0h] [bp-128h]@15
  int ret_Call_On_Escape; // [sp+4h] [bp-124h]@8
  char old_script_path[260]; // [sp+8h] [bp-120h]@1
  RECT Rect_View; // [sp+114h] [bp-14h]@1
  int i; // [sp+124h] [bp-4h]@1

  Rect_View.left = 0;
  Rect_View.top = 0;
  Rect_View.right = 320;
  Rect_View.bottom = 240;
  GetTextScriptPath(old_script_path);
  Load_Special_TSC("ArmsItem.tsc");
  Inventory_Label_Position = 24;
  Inventory_Active = 0;
  Selected_Item = 0;
  for ( i = 0; Weapons[i].ID; ++i )
    ;
  if ( i )
    Start_TSC_Event(Weapons[Selected_Weapon].ID + 1000);
  else
    Start_TSC_Event(Quote_Inventory[Selected_Item].code + 5000);
  while ( 1 )
  {
    Get_Keys();
    if ( Key_Pressed & 0x8000 )
    {
      ret_Call_On_Escape = Call_On_Escape(AppWinHandle);
      if ( !ret_Call_On_Escape )
        return 0;
      if ( ret_Call_On_Escape == 2 )
        return 2;
    }
    if ( Game_Flags & 2 )
      Move_Inventory_Cursor();
    ret_TSC_Parser = TSC_Parser();
    if ( !ret_TSC_Parser )
      return 0;
    if ( ret_TSC_Parser == 2 )
      return 2;
    Draw_Sprite_No_Tranparency(&Rect_View, 0, 0, &Rect_View, 10);
    Draw_Inventory_Window();
    Draw_Text_Box();
    Display_FPS_Counter();
    if ( !Inventory_Active )
      break;
    if ( Game_Flags & 2 && Key_Pressed & (Key_For_Menu | Key_Cancel) )
    {
      Stop_Text_Script();
      goto LABEL_30;
    }
LABEL_27:
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  if ( !(Key_Pressed & (Key_For_Menu | Key_Cancel | Key_Ok)) )
    goto LABEL_27;
  Stop_Text_Script();
LABEL_30:
  loadTSCScript(old_script_path);
  Weapon_Icon_X_Offset = 32;
  return 1;
}
// 493620: using guessed type int Key_For_Menu;
// 493628: using guessed type int Key_Ok;
// 49362C: using guessed type int Key_Cancel;
// 499BC0: using guessed type int Inventory_Active;
// 499C68: using guessed type int Selected_Weapon;
// 499C6C: using guessed type int Selected_Item;
// 49E1E8: using guessed type int Game_Flags;
// 49E214: using guessed type int Key_Pressed;

//----- (00401F20) --------------------------------------------------------
// Check If Has Item
signed int __cdecl Check_For_Item(int item)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 32; ++i )
  {
    if ( Quote_Inventory[i].code == item )
      return 1;
  }
  return 0;
}

//----- (00401F60) --------------------------------------------------------
// Check If Has Weapon
signed int __cdecl Check_For_Weapon(int Weapon)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8; ++i )
  {
    if ( Weapons[i].ID == Weapon )
      return 1;
  }
  return 0;
}

//----- (00401FA0) --------------------------------------------------------
signed int __cdecl Use_Ammo(int Ammo_To_Remove)
{
  signed int result; // eax@2

  if ( Weapons[Selected_Weapon].Max_Ammo )
  {
    if ( Weapons[Selected_Weapon].Ammo )
    {
      Weapons[Selected_Weapon].Ammo -= Ammo_To_Remove;
      if ( Weapons[Selected_Weapon].Ammo < 0 )
        Weapons[Selected_Weapon].Ammo = 0;
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00402020) --------------------------------------------------------
// Add Ammo To Weapon
int __cdecl Add_Ammo(int Ammo_To_Add)
{
  Weapons[Selected_Weapon].Ammo += Ammo_To_Add;
  if ( Weapons[Selected_Weapon].Ammo > Weapons[Selected_Weapon].Max_Ammo )
    Weapons[Selected_Weapon].Ammo = Weapons[Selected_Weapon].Max_Ammo;
  return 1;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00402090) --------------------------------------------------------
// TSC Fill All Weapon Ammo [AE+]
void __cdecl Fill_Weapon_Ammo()
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8; ++i )
  {
    if ( Weapons[i].ID )
      Weapons[i].Ammo = Weapons[i].Max_Ammo;
  }
}

//----- (004020E0) --------------------------------------------------------
// Switch to Next Weapon
int Switch_to_Next_Weap()
{
  int result; // eax@5
  int Weapon_Num; // [sp+0h] [bp-4h]@1

  for ( Weapon_Num = 0; Weapons[Weapon_Num].ID; ++Weapon_Num )
    ;
  if ( Weapon_Num )
  {
    Reset_Spur_Charge();
    ++Selected_Weapon;
    while ( Selected_Weapon < Weapon_Num && !Weapons[Selected_Weapon].ID )
      ++Selected_Weapon;
    if ( Selected_Weapon == Weapon_Num )
      Selected_Weapon = 0;
    Weapon_Icon_X_Offset = 32;
    Play_Sound_Effect(Sfx_Switch_Weapon, 1);
    result = Weapons[Selected_Weapon].ID;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00402190) --------------------------------------------------------
// Switch to Previous Weapon
int Switch_to_Prev_Weap()
{
  int result; // eax@5
  int Weapon_Num; // [sp+0h] [bp-4h]@1

  for ( Weapon_Num = 0; Weapons[Weapon_Num].ID; ++Weapon_Num )
    ;
  if ( Weapon_Num )
  {
    Reset_Spur_Charge();
    if ( --Selected_Weapon < 0 )
      Selected_Weapon = Weapon_Num - 1;
    while ( Selected_Weapon < Weapon_Num && !Weapons[Selected_Weapon].ID )
      --Selected_Weapon;
    Weapon_Icon_X_Offset = 0;
    Play_Sound_Effect(Sfx_Switch_Weapon, 1);
    result = Weapons[Selected_Weapon].ID;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00402240) --------------------------------------------------------
// Change weapon to first weapon
void Change_To_First_Weapon()
{
  Selected_Weapon = 0;
  Weapon_Icon_X_Offset = 32;
  Play_Sound_Effect(Sfx_Switch_Weapon, 1);
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00402270) --------------------------------------------------------
signed int __cdecl Init_Background(char *fName, int Mode)
{
  signed int result; // eax@2
  char path; // [sp+0h] [bp-148h]@1
  int buffer; // [sp+10Ch] [bp-3Ch]@3
  FILE *stream; // [sp+11Ch] [bp-2Ch]@1
  int v6[3]; // [sp+120h] [bp-28h]@5

  color_black = (int)Make_RGB(0x100000u);
  sprintf(&path, "%s\\%s.pbm", dataPath, fName);
  stream = fopen(&path, "rb");
  if ( stream )
  {
    fread(&buffer, 0xEu, 1u, stream);
    if ( (unsigned __int16)buffer == 19778 )
    {
      fread(v6, 0x28u, 1u, stream);
      fclose(stream);
      Current_Background.Tile_Width = v6[1];
      Current_Background.Tile_Height = v6[2];
      Current_Background.flag = 1;
      if ( !ReloadBitmap_From_File(fName, 28) )
      {
        result = 0;
      }
      else
      {
        Current_Background.Mode = Mode;
        GlobalWaterDepth = 1966080;
        result = 1;
      }
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 499C90: using guessed type int GlobalWaterDepth;
// 499C94: using guessed type int color_black;

//----- (00402370) --------------------------------------------------------
// Background Modes?
void __cdecl Update_Background()
{
  if ( Current_Background.Mode == 5 )
  {
    Current_Background._fx += 3072;
  }
  else if ( Current_Background.Mode > 5 && Current_Background.Mode <= 7 )
  {
    ++Current_Background._fx;
    Current_Background._fx %= 640;
  }
}

//----- (004023D0) --------------------------------------------------------
// Background Code
void __cdecl Draw_Background(signed int Camera_X, signed int Camera_Y)
{
  signed int X_Position; // [sp+4h] [bp-18h]@4
  int X_Positiona; // [sp+4h] [bp-18h]@11
  int X_Positionb; // [sp+4h] [bp-18h]@18
  int X_Positionc; // [sp+4h] [bp-18h]@25
  signed int bitmaprender_Y; // [sp+8h] [bp-14h]@2
  int Y_Positiona; // [sp+8h] [bp-14h]@9
  int Y_Positionb; // [sp+8h] [bp-14h]@16
  int Y_Positionc; // [sp+8h] [bp-14h]@23
  RECT rect; // [sp+Ch] [bp-10h]@1

  rect.left = 0;
  rect.top = 0;
  rect.right = Current_Background.Tile_Width;
  rect.bottom = Current_Background.Tile_Height;
  switch ( Current_Background.Mode )
  {
    case 0:
      for ( bitmaprender_Y = 0; bitmaprender_Y < 240; bitmaprender_Y += Current_Background.Tile_Height )
      {
        for ( X_Position = 0; X_Position < 320; X_Position += Current_Background.Tile_Width )
          Draw_Sprite_No_Tranparency(&Rect_Game, X_Position, bitmaprender_Y, &rect, 28);
      }
      break;
    case 1:
      for ( Y_Positiona = -(Camera_Y / 2 / 512 % Current_Background.Tile_Height);
            Y_Positiona < 240;
            Y_Positiona += Current_Background.Tile_Height )
      {
        for ( X_Positiona = -(Camera_X / 2 / 512 % Current_Background.Tile_Width);
              X_Positiona < 320;
              X_Positiona += Current_Background.Tile_Width )
        {
          Draw_Sprite_No_Tranparency(&Rect_Game, X_Positiona, Y_Positiona, &rect, 28);
        }
      }
      break;
    case 2:
      for ( Y_Positionb = -(Camera_Y / 512 % Current_Background.Tile_Height);
            Y_Positionb < 240;
            Y_Positionb += Current_Background.Tile_Height )
      {
        for ( X_Positionb = -(Camera_X / 512 % Current_Background.Tile_Width);
              X_Positionb < 320;
              X_Positionb += Current_Background.Tile_Width )
        {
          Draw_Sprite_No_Tranparency(&Rect_Game, X_Positionb, Y_Positionb, &rect, 28);
        }
      }
      break;
    case 5:
      for ( Y_Positionc = -Current_Background.Tile_Height; Y_Positionc < 240; Y_Positionc += Current_Background.Tile_Height )
      {
        for ( X_Positionc = -(Current_Background._fx / 512 % Current_Background.Tile_Width);
              X_Positionc < 320;
              X_Positionc += Current_Background.Tile_Width )
        {
          Draw_Sprite_No_Tranparency(&Rect_Game, X_Positionc, Y_Positionc, &rect, 28);
        }
      }
      break;
    case 6:
    case 7:
      rect.top = 0;
      rect.bottom = 88;
      rect.left = 0;
      rect.right = 320;
      Draw_Sprite_No_Tranparency(&Rect_Game, 0, 0, &rect, 28);
      rect.top = 88;
      rect.bottom = 123;
      rect.left = Current_Background._fx / 2;
      rect.right = 320;
      Draw_Sprite_No_Tranparency(&Rect_Game, 0, 88, &rect, 28);
      rect.left = 0;
      Draw_Sprite_No_Tranparency(&Rect_Game, 320 - Current_Background._fx / 2 % 320, 88, &rect, 28);
      rect.top = 123;
      rect.bottom = 146;
      rect.left = Current_Background._fx % 320;
      rect.right = 320;
      Draw_Sprite_No_Tranparency(&Rect_Game, 0, 123, &rect, 28);
      rect.left = 0;
      Draw_Sprite_No_Tranparency(&Rect_Game, 320 - Current_Background._fx % 320, 123, &rect, 28);
      rect.top = 146;
      rect.bottom = 176;
      rect.left = 2 * Current_Background._fx % 320;
      rect.right = 320;
      Draw_Sprite_No_Tranparency(&Rect_Game, 0, 146, &rect, 28);
      rect.left = 0;
      Draw_Sprite_No_Tranparency(&Rect_Game, 320 - 2 * Current_Background._fx % 320, 146, &rect, 28);
      rect.top = 176;
      rect.bottom = 240;
      rect.left = 4 * Current_Background._fx % 320;
      rect.right = 320;
      Draw_Sprite_No_Tranparency(&Rect_Game, 0, 176, &rect, 28);
      rect.left = 0;
      Draw_Sprite_No_Tranparency(&Rect_Game, 320 - 4 * Current_Background._fx % 320, 176, &rect, 28);
      break;
    default:
      return;
  }
}

//----- (00402830) --------------------------------------------------------
// Render Map Background (BackgroundMode 3 only) (May be related to drawing water ?)
void __cdecl Draw_Foreground(signed int Camera_X, signed int Camera_Y)
{
  int XPos; // [sp+4h] [bp-40h]@9
  RECT Rects_Water[2]; // [sp+Ch] [bp-38h]@1
  int YPos; // [sp+2Ch] [bp-18h]@5
  int X_1; // [sp+30h] [bp-14h]@2
  int X_2; // [sp+34h] [bp-10h]@2
  int X; // [sp+38h] [bp-Ch]@7
  int Y; // [sp+3Ch] [bp-8h]@2
  int Y_1; // [sp+40h] [bp-4h]@2

  Rects_Water[0].left = 0;
  Rects_Water[0].top = 0;
  Rects_Water[0].right = 32;
  Rects_Water[0].bottom = 16;
  Rects_Water[1].left = 0;
  Rects_Water[1].top = 16;
  Rects_Water[1].right = 32;
  Rects_Water[1].bottom = 48;
  if ( Current_Background.Mode == 3 )
  {
    X_1 = Camera_X / 0x4000;
    X_2 = Camera_X / 0x4000 + 11;
    Y_1 = 0;
    for ( Y = 0; Y < 32; ++Y )
    {
      YPos = GlobalWaterDepth / 512 + (Y << 14) / 512 - Camera_Y / 512;
      if ( YPos >= -32 )
      {
        if ( YPos > 240 )
          return;
        for ( X = X_1; X < X_2; ++X )
        {
          XPos = (X << 14) / 512 - Camera_X / 512;
          Draw_Bitmap_With_Transparency(&Rect_Game, XPos, YPos, &Rects_Water[1], 28);
          if ( !Y )
            Draw_Bitmap_With_Transparency(&Rect_Game, XPos, YPos, Rects_Water, 28);
        }
      }
    }
  }
}
// 499C90: using guessed type int GlobalWaterDepth;

//----- (004029B0) --------------------------------------------------------
// Check for whether a bullet can break a starblock
signed int __cdecl Chk_Starblck_break(int a1, int a2, Bullet_vars *Bullet)
{
  int v3; // ST10_4@13
  int v4; // eax@13
  signed int v6; // [sp+0h] [bp-8h]@1
  signed int i; // [sp+4h] [bp-4h]@11

  v6 = 0;
  if ( Bullet->XPos - Bullet->blockXL < (16 * a1 + 8) << 9
    && Bullet->blockXL + Bullet->XPos > (16 * a1 - 8) << 9
    && Bullet->YPos - Bullet->blockYL < (16 * a2 + 8) << 9
    && Bullet->blockYL + Bullet->YPos > (16 * a2 - 8) << 9 )
  {
    v6 = 512;
  }
  if ( v6 && Bullet->flags & 0x60 && Get_Tile_Attributes(a1, a2) == 67 )
  {
    if ( !(Bullet->flags & 0x40) )
      Bullet->isAlive = 0;
    Create_Effect(Bullet->XPos, Bullet->YPos, 2, 0);
    Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
    for ( i = 0; i < 4; ++i )
    {
      v3 = Random(-512, 512);
      v4 = Random(-512, 512);
      NPC_Create(Smoke, a1 << 13, a2 << 13, v4, v3, 0, NULL, 256);
    }
    Shift_Map_Parts(a1, a2);
  }
  return v6;
}

//----- (00402B30) --------------------------------------------------------
// Solid tile -> Two stage filter for blocks that bullets are s'posta collide with
int __cdecl Solid_Tile_Complicated(int a1, int a2, _BYTE *a3, int a4)
{
  int v5; // [sp+0h] [bp-20h]@6
  int v6; // [sp+4h] [bp-1Ch]@34
  int v7; // [sp+8h] [bp-18h]@19
  int v8; // [sp+Ch] [bp-14h]@35
  int v9; // [sp+10h] [bp-10h]@18
  int v10; // [sp+14h] [bp-Ch]@1
  int i; // [sp+18h] [bp-8h]@2
  int v12; // [sp+1Ch] [bp-4h]@18

  v10 = 0;
  if ( *(_DWORD *)(a4 + 8) & 0x40 )
  {
    for ( i = 0; i < 4; ++i )
    {
      *(&v5 + i) = *a3 == 65 || *a3 == 97;
      ++a3;
    }
  }
  else
  {
    for ( i = 0; i < 4; ++i )
    {
      *(&v5 + i) = *a3 == 65 || *a3 == 67 || *a3 == 97;
      ++a3;
    }
  }
  v9 = (16 * a1 + 8) << 9;
  v12 = (16 * a2 + 8) << 9;
  if ( v5 && v7 )
  {
    if ( *(_DWORD *)(a4 + 16) - *(_DWORD *)(a4 + 104) < v9 )
      v10 |= 1u;
  }
  else if ( !v5 || v7 )
  {
    if ( !v5
      && v7
      && *(_DWORD *)(a4 + 16) - *(_DWORD *)(a4 + 104) < v9
      && *(_DWORD *)(a4 + 108) + *(_DWORD *)(a4 + 20) > v12 + 1536 )
    {
      v10 |= 1u;
    }
  }
  else if ( *(_DWORD *)(a4 + 16) - *(_DWORD *)(a4 + 104) < v9
         && *(_DWORD *)(a4 + 20) - *(_DWORD *)(a4 + 108) < v12 - 1536 )
  {
    v10 |= 1u;
  }
  if ( v6 && v8 )
  {
    if ( *(_DWORD *)(a4 + 104) + *(_DWORD *)(a4 + 16) > v9 )
      v10 |= 4u;
  }
  else if ( !v6 || v8 )
  {
    if ( !v6
      && v8
      && *(_DWORD *)(a4 + 104) + *(_DWORD *)(a4 + 16) > v9
      && *(_DWORD *)(a4 + 108) + *(_DWORD *)(a4 + 20) > v12 + 1536 )
    {
      v10 |= 4u;
    }
  }
  else if ( *(_DWORD *)(a4 + 104) + *(_DWORD *)(a4 + 16) > v9
         && *(_DWORD *)(a4 + 20) - *(_DWORD *)(a4 + 108) < v12 - 1536 )
  {
    v10 |= 4u;
  }
  if ( v5 && v6 )
  {
    if ( *(_DWORD *)(a4 + 20) - *(_DWORD *)(a4 + 108) < v12 )
      v10 |= 2u;
  }
  else if ( !v5 || v6 )
  {
    if ( !v5
      && v6
      && *(_DWORD *)(a4 + 20) - *(_DWORD *)(a4 + 108) < v12
      && *(_DWORD *)(a4 + 104) + *(_DWORD *)(a4 + 16) > v9 + 1536 )
    {
      v10 |= 2u;
    }
  }
  else if ( *(_DWORD *)(a4 + 20) - *(_DWORD *)(a4 + 108) < v12
         && *(_DWORD *)(a4 + 16) - *(_DWORD *)(a4 + 104) < v9 - 1536 )
  {
    v10 |= 2u;
  }
  if ( v7 && v8 )
  {
    if ( *(_DWORD *)(a4 + 108) + *(_DWORD *)(a4 + 20) > v12 )
      v10 |= 8u;
  }
  else if ( !v7 || v8 )
  {
    if ( !v7
      && v8
      && *(_DWORD *)(a4 + 108) + *(_DWORD *)(a4 + 20) > v12
      && *(_DWORD *)(a4 + 104) + *(_DWORD *)(a4 + 16) > v9 + 1536 )
    {
      v10 |= 8u;
    }
  }
  else if ( *(_DWORD *)(a4 + 108) + *(_DWORD *)(a4 + 20) > v12
         && *(_DWORD *)(a4 + 16) - *(_DWORD *)(a4 + 104) < v9 - 1536 )
  {
    v10 |= 8u;
  }
  if ( *(_DWORD *)(a4 + 8) & 8 )
  {
    if ( v10 & 1 )
    {
      *(_DWORD *)(a4 + 16) = *(_DWORD *)(a4 + 104) + v9;
    }
    else if ( v10 & 4 )
    {
      *(_DWORD *)(a4 + 16) = v9 - *(_DWORD *)(a4 + 104);
    }
    else if ( v10 & 2 )
    {
      *(_DWORD *)(a4 + 20) = *(_DWORD *)(a4 + 108) + v12;
    }
    else if ( v10 & 8 )
    {
      *(_DWORD *)(a4 + 20) = v12 - *(_DWORD *)(a4 + 108);
    }
  }
  else if ( v10 & 0xF )
  {
    Sound_When_Bullet_Hits_Wall_Maybe(a4);
  }
  return v10;
}

//----- (00402F50) --------------------------------------------------------
// Generate effect, sound when Bullet hits wall
void __cdecl Sound_When_Bullet_Hits_Wall_Maybe(int a1)
{
  if ( *(_DWORD *)(a1 + 4) != 37 && *(_DWORD *)(a1 + 4) != 38 && *(_DWORD *)(a1 + 4) != 39 )
    Play_Sound_Effect(Sfx_Shot_Hit_Wall, 1);
  else
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 2, 1);
  *(_DWORD *)(a1 + 12) = 0;
  Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 2, 2);
}

//----- (00402FC0) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_1(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) - 1024 < (a2 << 13) - (((signed int)v3 - HIDWORD(v3)) >> 1) + 2048
      && *(_DWORD *)(BulletID + 20) + 1024 > (16 * a2 - 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) - (((signed int)v4 - HIDWORD(v4)) >> 1) + 3072;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 130;
    }
  }
  return v6;
}

//----- (004030B0) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_2(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) - 1024 < (a2 << 13) - (((signed int)v3 - HIDWORD(v3)) >> 1) - 2048
      && *(_DWORD *)(BulletID + 20) + 1024 > (16 * a2 - 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) - (((signed int)v4 - HIDWORD(v4)) >> 1) - 1024;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 130;
    }
  }
  return v6;
}

//----- (004031A0) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_3(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) - 1024 < (a2 << 13) + (((signed int)v3 - HIDWORD(v3)) >> 1) - 2048
      && *(_DWORD *)(BulletID + 20) + 1024 > (16 * a2 - 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) + (((signed int)v4 - HIDWORD(v4)) >> 1) - 1024;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 66;
    }
  }
  return v6;
}

//----- (00403290) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Roof_Slope_4(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) - 1024 < (a2 << 13) + (((signed int)v3 - HIDWORD(v3)) >> 1) + 2048
      && *(_DWORD *)(BulletID + 20) + 1024 > (16 * a2 - 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) + (((signed int)v4 - HIDWORD(v4)) >> 1) + 3072;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 66;
    }
  }
  return v6;
}

//----- (00403380) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_1(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) - 512 > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) + 1024 > (a2 << 13) + (((signed int)v3 - HIDWORD(v3)) >> 1) - 2048
      && *(_DWORD *)(BulletID + 20) - 1024 < (16 * a2 + 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) + (((signed int)v4 - HIDWORD(v4)) >> 1) - 3072;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 40;
    }
  }
  return v6;
}

//----- (00403470) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_2(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) + 1024 > (a2 << 13) + (((signed int)v3 - HIDWORD(v3)) >> 1) + 2048
      && *(_DWORD *)(BulletID + 20) - 1024 < (16 * a2 + 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) + (((signed int)v4 - HIDWORD(v4)) >> 1) + 1024;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 40;
    }
  }
  return v6;
}

//----- (00403560) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_3(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) + 1024 > (a2 << 13) - (((signed int)v3 - HIDWORD(v3)) >> 1) + 2048
      && *(_DWORD *)(BulletID + 20) - 1024 < (16 * a2 + 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) - (((signed int)v4 - HIDWORD(v4)) >> 1) + 1024;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 24;
    }
  }
  return v6;
}

//----- (00403650) --------------------------------------------------------
signed int __cdecl Bullet_Tile_Collision_Floor_Slope_4(int a1, int a2, int BulletID)
{
  __int64 v3; // rax@3
  __int64 v4; // rax@6
  signed int v6; // [sp+0h] [bp-4h]@1

  v6 = 0;
  if ( *(_DWORD *)(BulletID + 16) < (16 * a1 + 8) << 9 && *(_DWORD *)(BulletID + 16) > (16 * a1 - 8) << 9 )
  {
    v3 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
    if ( *(_DWORD *)(BulletID + 20) + 1024 > (a2 << 13) - (((signed int)v3 - HIDWORD(v3)) >> 1) - 2048
      && *(_DWORD *)(BulletID + 20) - 1024 < (16 * a2 + 8) << 9 )
    {
      if ( *(_DWORD *)(BulletID + 8) & 8 )
      {
        v4 = *(_DWORD *)(BulletID + 16) - (a1 << 13);
        *(_DWORD *)(BulletID + 20) = (a2 << 13) - (((signed int)v4 - HIDWORD(v4)) >> 1) - 3072;
      }
      else
      {
        Sound_When_Bullet_Hits_Wall_Maybe(BulletID);
      }
      v6 = 24;
    }
  }
  return v6;
}

//----- (00403740) --------------------------------------------------------
// Bullet tile collision algorithm
void Bul_Til_Coll_Algo()
{
  __int64 v0; // rax@5
  __int64 v1; // rax@5
  int v2; // esi@11
  signed int v3; // eax@11
  int v4; // esi@12
  signed int v5; // eax@12
  int v6; // esi@13
  signed int v7; // eax@13
  int v8; // esi@14
  signed int v9; // eax@14
  int v10; // esi@15
  signed int v11; // eax@15
  int v12; // esi@16
  signed int v13; // eax@16
  int v14; // esi@17
  signed int v15; // eax@17
  int v16; // esi@18
  signed int v17; // eax@18
  int v18; // esi@19
  signed int v19; // eax@19
  int v20; // esi@21
  int v21; // eax@21
  int v22; // [sp+4h] [bp-34h]@5
  int v23; // [sp+8h] [bp-30h]@5
  int v24; // [sp+Ch] [bp-2Ch]@5
  int v25; // [sp+10h] [bp-28h]@5
  int v26; // [sp+14h] [bp-24h]@5
  int v27; // [sp+18h] [bp-20h]@5
  int v28; // [sp+1Ch] [bp-1Ch]@5
  int v29; // [sp+20h] [bp-18h]@5
  int i; // [sp+24h] [bp-14h]@6
  unsigned __int8 v31; // [sp+28h] [bp-10h]@5
  unsigned __int8 v32; // [sp+29h] [bp-Fh]@5
  unsigned __int8 v33; // [sp+2Ah] [bp-Eh]@5
  unsigned __int8 v34; // [sp+2Bh] [bp-Dh]@5
  int j; // [sp+2Ch] [bp-Ch]@1
  int v36; // [sp+30h] [bp-8h]@5
  int v37; // [sp+34h] [bp-4h]@5

  for ( j = 0; j < 64; ++j )
  {
    if ( Bullet_Objects[j].isAlive & 0x80 )
    {
      v0 = Bullet_Objects[j].XPos / 16;
      v36 = ((WORD2(v0) & 0x1FF) + (signed int)v0) >> 9;
      v1 = Bullet_Objects[j].YPos / 16;
      v37 = ((WORD2(v1) & 0x1FF) + (signed int)v1) >> 9;
      v22 = 0;
      v23 = 1;
      v24 = 0;
      v25 = 1;
      v26 = 0;
      v27 = 0;
      v28 = 1;
      v29 = 1;
      v31 = Get_Tile_Attributes(v36, v37);
      v32 = Get_Tile_Attributes(v36 + 1, v37);
      v33 = Get_Tile_Attributes(v36, v37 + 1);
      v34 = Get_Tile_Attributes(v36 + 1, v37 + 1);
      Bullet_Objects[j].isUsed = 0;
      if ( !(Bullet_Objects[j].flags & 4) )
      {
        for ( i = 0; i < 4; ++i )
        {
          if ( Bullet_Objects[j].isAlive & 0x80 )
          {
            switch ( *(&v31 + i) )
            {
              case 0x41u:
              case 0x43u:
              case 0x44u:
              case 0x61u:
              case 0x64u:
                v2 = j << 7;
                v3 = Chk_Starblck_break(*(&v22 + i) + v36, *(&v26 + i) + v37, &Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v2) | v3;
                break;
              case 0x50u:
              case 0x70u:
                v4 = j << 7;
                v5 = Bullet_Tile_Collision_Roof_Slope_1(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v4) | v5;
                break;
              case 0x51u:
              case 0x71u:
                v6 = j << 7;
                v7 = Bullet_Tile_Collision_Roof_Slope_2(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v6) | v7;
                break;
              case 0x52u:
              case 0x72u:
                v8 = j << 7;
                v9 = Bullet_Tile_Collision_Roof_Slope_3(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v8) | v9;
                break;
              case 0x53u:
              case 0x73u:
                v10 = j << 7;
                v11 = Bullet_Tile_Collision_Roof_Slope_4(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v10) | v11;
                break;
              case 0x54u:
              case 0x74u:
                v12 = j << 7;
                v13 = Bullet_Tile_Collision_Floor_Slope_1(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v12) | v13;
                break;
              case 0x55u:
              case 0x75u:
                v14 = j << 7;
                v15 = Bullet_Tile_Collision_Floor_Slope_2(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v14) | v15;
                break;
              case 0x56u:
              case 0x76u:
                v16 = j << 7;
                v17 = Bullet_Tile_Collision_Floor_Slope_3(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v16) | v17;
                break;
              case 0x57u:
              case 0x77u:
                v18 = j << 7;
                v19 = Bullet_Tile_Collision_Floor_Slope_4(*(&v22 + i) + v36, *(&v26 + i) + v37, (int)&Bullet_Objects[j]);
                Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v18) | v19;
                break;
              default:
                continue;
            }
          }
        }
        v20 = j << 7;
        v21 = Solid_Tile_Complicated(v36, v37, &v31, (int)&Bullet_Objects[j]);
        Bullet_Objects[j].isUsed = *(int *)((char *)&Bullet_Objects[0].isUsed + v20) | v21;
      }
    }
  }
}

//----- (00403C00) --------------------------------------------------------
int Clear_All_Weapons_Object_Slots()
{
  int result; // eax@3
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 64; ++i )
  {
    Bullet_Objects[i].isAlive = 0;
    result = i + 1;
  }
  return result;
}

//----- (00403C40) --------------------------------------------------------
int __cdecl Count_Weapon_Bullets(int WeaponID)
{
  signed int i; // [sp+0h] [bp-8h]@1
  int Shot_Count; // [sp+4h] [bp-4h]@1

  Shot_Count = 0;
  for ( i = 0; i < 64; ++i )
  {
    if ( Bullet_Objects[i].isAlive & 0x80 )
    {
      if ( (Bullet_Objects[i].code_bullet + 2) / 3 == WeaponID )
        ++Shot_Count;
    }
  }
  return Shot_Count;
}

//----- (00403CB0) --------------------------------------------------------
int __cdecl Count_All_Slots_Using_Shot(int ShotID)
{
  signed int i; // [sp+0h] [bp-8h]@1
  int v3; // [sp+4h] [bp-4h]@1

  v3 = 0;
  for ( i = 0; i < 64; ++i )
  {
    if ( Bullet_Objects[i].isAlive & 0x80 )
    {
      if ( Bullet_Objects[i].code_bullet == ShotID )
        ++v3;
    }
  }
  return v3;
}

//----- (00403D10) --------------------------------------------------------
// Unused
int __cdecl Delete_Bullet(int a1)
{
  int result; // eax@6
  signed int i; // [sp+0h] [bp-8h]@1

  for ( i = 0; i < 64; ++i )
  {
    if ( Bullet_Objects[i].isAlive & 0x80 )
    {
      if ( (Bullet_Objects[i].code_bullet + 2) / 3 == a1 )
        Bullet_Objects[i].isAlive = 0;
    }
    result = i + 1;
  }
  return result;
}

//----- (00403D80) --------------------------------------------------------
void __cdecl Clear_Bullets()
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 64; ++i )
    Bullet_Objects[i].isAlive = 0;
}

//----- (00403DC0) --------------------------------------------------------
int __cdecl Render_Bullets(signed int a1, signed int a2)
{
  int result; // eax@10
  signed int i; // [sp+4h] [bp-Ch]@1
  signed int v4; // [sp+8h] [bp-8h]@0
  signed int v5; // [sp+Ch] [bp-4h]@0

  for ( i = 0; i < 64; ++i )
  {
    if ( Bullet_Objects[i].isAlive & 0x80 )
    {
      switch ( Bullet_Objects[i].direction )
      {
        case 0u:
          v4 = Bullet_Objects[i].XPos - Bullet_Objects[i].view.front;
          v5 = Bullet_Objects[i].YPos - Bullet_Objects[i].view.top;
          break;
        case 2u:
          v4 = Bullet_Objects[i].XPos - Bullet_Objects[i].view.back;
          v5 = Bullet_Objects[i].YPos - Bullet_Objects[i].view.top;
          break;
        case 1u:
          v4 = Bullet_Objects[i].XPos - Bullet_Objects[i].view.top;
          v5 = Bullet_Objects[i].YPos - Bullet_Objects[i].view.front;
          break;
        case 3u:
          v4 = Bullet_Objects[i].XPos - Bullet_Objects[i].view.top;
          v5 = Bullet_Objects[i].YPos - Bullet_Objects[i].view.back;
          break;
        default:
          break;
      }
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        v4 / 512 - a1 / 512,
        v5 / 512 - a2 / 512,
        &Bullet_Objects[i].displayRect,
        17);
    }
    result = i + 1;
  }
  return result;
}

//----- (00403F80) --------------------------------------------------------
void __cdecl Create_Bullet(Bullet_enum BulletID, int X_Position, int Y_Position, Directions Direction)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 64 && Bullet_Objects[i].isAlive & 0x80; ++i )
    ;
  if ( i < 64 )
  {
    memset(&Bullet_Objects[i], 0, 0x80u);
    Bullet_Objects[i].code_bullet = BulletID;
    Bullet_Objects[i].isAlive = 128;
    Bullet_Objects[i].direction = Direction;
    Bullet_Objects[i].damage = Weapon_Data_Damage[44 * BulletID];
    Bullet_Objects[i].life = Weapon_Data_Num_Impacts[44 * BulletID];
    Bullet_Objects[i].lifeTime = Weapon_Data_Max_Distance[11 * BulletID];
    Bullet_Objects[i].flags = Weapon_Data_Behaviour_Flags[11 * BulletID];
    Bullet_Objects[i].enemyXL = Weapon_Data_Bullet_Size_Width[11 * BulletID] << 9;
    Bullet_Objects[i].enemyYL = Weapon_Data_Bullet_Size_Height[11 * BulletID] << 9;
    Bullet_Objects[i].blockXL = Weapon_Data_Wall_Collision_X[11 * BulletID] << 9;
    Bullet_Objects[i].blockYL = Weapon_Data_Wall_Collision_Y[11 * BulletID] << 9;
    Bullet_Objects[i].view.back = Weapon_Data_Pos_Offset_Right[11 * BulletID] << 9;
    Bullet_Objects[i].view.front = Weapon_Data_Pos_Offset_Left[11 * BulletID] << 9;
    Bullet_Objects[i].view.top = Weapon_Data_Pos_Offset_Up[11 * BulletID] << 9;
    Bullet_Objects[i].view.bottom = Weapon_Data_Pos_Offset_Down[11 * BulletID] << 9;
    Bullet_Objects[i].XPos = X_Position;
    Bullet_Objects[i].YPos = Y_Position;
  }
}
// 48F04C: using guessed type int Weapon_Data_Max_Distance[];
// 48F050: using guessed type int Weapon_Data_Behaviour_Flags[];
// 48F054: using guessed type int Weapon_Data_Bullet_Size_Width[];
// 48F058: using guessed type int Weapon_Data_Bullet_Size_Height[];
// 48F05C: using guessed type int Weapon_Data_Wall_Collision_X[];
// 48F060: using guessed type int Weapon_Data_Wall_Collision_Y[];
// 48F064: using guessed type int Weapon_Data_Pos_Offset_Left[];
// 48F068: using guessed type int Weapon_Data_Pos_Offset_Up[];
// 48F06C: using guessed type int Weapon_Data_Pos_Offset_Right[];
// 48F070: using guessed type int Weapon_Data_Pos_Offset_Down[];

//----- (00404160) --------------------------------------------------------
void __cdecl Bullet_01_Lvl_1_Snake(int a1)
{
  int *v1; // edx@16
  int v2; // eax@16
  int *v3; // edx@17
  int v4; // eax@17
  int v5; // [sp+4h] [bp-80h]@15
  int v6; // [sp+8h] [bp-7Ch]@15
  int v7; // [sp+Ch] [bp-78h]@15
  int v8; // [sp+10h] [bp-74h]@15
  int v9; // [sp+14h] [bp-70h]@15
  int v10; // [sp+18h] [bp-6Ch]@15
  int v11; // [sp+1Ch] [bp-68h]@15
  int v12; // [sp+20h] [bp-64h]@15
  int v13; // [sp+24h] [bp-60h]@15
  int v14; // [sp+28h] [bp-5Ch]@15
  int v15; // [sp+2Ch] [bp-58h]@15
  int v16; // [sp+30h] [bp-54h]@15
  int v17; // [sp+34h] [bp-50h]@15
  int v18; // [sp+38h] [bp-4Ch]@15
  int v19; // [sp+3Ch] [bp-48h]@15
  int v20; // [sp+40h] [bp-44h]@15
  int v21; // [sp+44h] [bp-40h]@15
  int v22; // [sp+48h] [bp-3Ch]@15
  int v23; // [sp+4Ch] [bp-38h]@15
  int v24; // [sp+50h] [bp-34h]@15
  int v25; // [sp+54h] [bp-30h]@15
  int v26; // [sp+58h] [bp-2Ch]@15
  int v27; // [sp+5Ch] [bp-28h]@15
  int v28; // [sp+60h] [bp-24h]@15
  int v29; // [sp+64h] [bp-20h]@15
  int v30; // [sp+68h] [bp-1Ch]@15
  int v31; // [sp+6Ch] [bp-18h]@15
  int v32; // [sp+70h] [bp-14h]@15
  int v33; // [sp+74h] [bp-10h]@15
  int v34; // [sp+78h] [bp-Ch]@15
  int v35; // [sp+7Ch] [bp-8h]@15
  int v36; // [sp+80h] [bp-4h]@15

  if ( ++*(_DWORD *)(a1 + 76) <= *(_DWORD *)(a1 + 84) )
  {
    if ( *(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    }
    else
    {
      *(_DWORD *)(a1 + 52) = Random(0, 2);
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -1536;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -1536;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = 1536;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = 1536;
          break;
        default:
          break;
      }
    }
    if ( ++*(_DWORD *)(a1 + 48) > 0 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 0;
    v21 = 136;
    v22 = 80;
    v23 = 152;
    v24 = 80;
    v25 = 120;
    v26 = 80;
    v27 = 136;
    v28 = 96;
    v29 = 136;
    v30 = 64;
    v31 = 152;
    v32 = 80;
    v33 = 120;
    v34 = 64;
    v35 = 136;
    v36 = 80;
    v5 = 120;
    v6 = 64;
    v7 = 136;
    v8 = 80;
    v9 = 136;
    v10 = 64;
    v11 = 152;
    v12 = 80;
    v13 = 120;
    v14 = 80;
    v15 = 136;
    v16 = 96;
    v17 = 136;
    v18 = 80;
    v19 = 152;
    v20 = 80;
    if ( *(_BYTE *)(a1 + 56) )
    {
      v3 = &v5 + 4 * *(_DWORD *)(a1 + 52);
      v4 = a1 + 60;
      *(_DWORD *)v4 = *v3;
      *(_DWORD *)(v4 + 4) = v3[1];
      *(_DWORD *)(v4 + 8) = v3[2];
      *(_DWORD *)(v4 + 12) = v3[3];
    }
    else
    {
      v1 = &v21 + 4 * *(_DWORD *)(a1 + 52);
      v2 = a1 + 60;
      *(_DWORD *)v2 = *v1;
      *(_DWORD *)(v2 + 4) = v1[1];
      *(_DWORD *)(v2 + 8) = v1[2];
      *(_DWORD *)(v2 + 12) = v1[3];
    }
  }
  else
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
  }
}

//----- (004043F0) --------------------------------------------------------
void __cdecl Bullet_02_03_Snake(Bullet_vars *bullet, int a2)
{
  int *v2; // ecx@38
  RECT *v3; // edx@38
  int v4; // [sp+10h] [bp-30h]@38
  int v5; // [sp+14h] [bp-2Ch]@38
  int v6; // [sp+18h] [bp-28h]@38
  int v7; // [sp+1Ch] [bp-24h]@38
  int v8; // [sp+20h] [bp-20h]@38
  int v9; // [sp+24h] [bp-1Ch]@38
  int v10; // [sp+28h] [bp-18h]@38
  int v11; // [sp+2Ch] [bp-14h]@38
  int v12; // [sp+30h] [bp-10h]@38
  int v13; // [sp+34h] [bp-Ch]@38
  int v14; // [sp+38h] [bp-8h]@38
  int v15; // [sp+3Ch] [bp-4h]@38

  if ( ++bullet->count1 <= bullet->lifeTime )
  {
    if ( bullet->currentState )
    {
      switch ( bullet->direction )
      {
        case 0u:
          bullet->XVel -= 128;
          break;
        case 1u:
          bullet->YVel -= 128;
          break;
        case 2u:
          bullet->XVel += 128;
          break;
        case 3u:
          bullet->YVel += 128;
          break;
        default:
          break;
      }
      switch ( bullet->direction )
      {
        case 0u:
        case 2u:
          if ( bullet->count1 % 5 == 2 )
          {
            if ( bullet->YVel >= 0 )
              bullet->YVel = -1024;
            else
              bullet->YVel = 1024;
          }
          break;
        case 1u:
        case 3u:
          if ( bullet->count1 % 5 == 2 )
          {
            if ( bullet->XVel >= 0 )
              bullet->XVel = -1024;
            else
              bullet->XVel = 1024;
          }
          break;
        default:
          break;
      }
      bullet->XPos += bullet->XVel;
      bullet->YPos += bullet->YVel;
    }
    else
    {
      bullet->animationNum = Random(0, 2);
      bullet->currentState = 1;
      switch ( bullet->direction )
      {
        case 0u:
          bullet->XVel = -512;
          break;
        case 1u:
          bullet->YVel = -512;
          break;
        case 2u:
          bullet->XVel = 512;
          break;
        case 3u:
          bullet->YVel = 512;
          break;
        default:
          break;
      }
      ++dword_49BC98;
      switch ( bullet->direction )
      {
        case 0u:
        case 2u:
          if ( dword_49BC98 % 2u )
            bullet->YVel = 1024;
          else
            bullet->YVel = -1024;
          break;
        case 1u:
        case 3u:
          if ( dword_49BC98 % 2u )
            bullet->XVel = 1024;
          else
            bullet->XVel = -1024;
          break;
        default:
          break;
      }
    }
    if ( ++bullet->frameTimer > 0 )
    {
      bullet->frameTimer = 0;
      ++bullet->animationNum;
    }
    if ( bullet->animationNum > 2 )
      bullet->animationNum = 0;
    v4 = 192;
    v5 = 16;
    v6 = 208;
    v7 = 32;
    v8 = 208;
    v9 = 16;
    v10 = 224;
    v11 = 32;
    v12 = 224;
    v13 = 16;
    v14 = 240;
    v15 = 32;
    v2 = &v4 + 4 * bullet->animationNum;
    v3 = &bullet->displayRect;
    v3->left = *v2;
    v3->top = v2[1];
    v3->right = v2[2];
    v3->bottom = v2[3];
    if ( a2 == 2 )
      NPC_Create((NPC_Names)129, bullet->XPos, bullet->YPos, 0, -512, (Directions)bullet->animationNum, NULL, 256);
    else
      NPC_Create((NPC_Names)129, bullet->XPos, bullet->YPos, 0, -512, (Directions)(bullet->animationNum + 3), NULL, 256);
  }
  else
  {
    bullet->isAlive = 0;
    Create_Effect(bullet->XPos, bullet->YPos, 3, 0);
  }
}
// 49BC98: using guessed type int dword_49BC98;

//----- (004047B0) --------------------------------------------------------
// Polar Star (all levels)
void __cdecl Bullet_04_05_06_Polar_Star(Bullet_vars *Bullet, int Level)
{
  RECT *Bullet_Rect; // eax@32 MAPDST

  if ( ++Bullet->count1 > Bullet->lifeTime )    //  has bullet reached max distance?
  {
    Bullet->isAlive = 0;                        // Kill bullet
    Create_Effect(Bullet->XPos, Bullet->YPos, Star, 0);// Spawn star at bullet's position
  }
  else
  {
    // Begin bullet code
    if ( !Bullet->currentState )
    {
      // Set up bullet
      Bullet->currentState = 1;
      switch ( Bullet->direction )
      {
        case 0u:
          Bullet->XVel = -4096;
          break;
        case 1u:
          Bullet->YVel = -4096;
          break;
        case 2u:
          Bullet->XVel = 4096;
          break;
        case 3u:
          Bullet->YVel = 4096;
          break;
        default:
          break;
      }
      if ( Level == 1 )
      {
        switch ( Bullet->direction )
        {
          case 0u:
            Bullet->enemyYL = 1024;
            break;
          case 1u:
            Bullet->enemyXL = 1024;
            break;
          case 2u:
            Bullet->enemyYL = 1024;
            break;
          case 3u:
            Bullet->enemyXL = 1024;
            break;
          default:
            break;
        }
      }
      else if ( Level == 2 )
      {
        switch ( Bullet->direction )
        {
          case 0u:
            Bullet->enemyYL = 2048;
            break;
          case 1u:
            Bullet->enemyXL = 2048;
            break;
          case 2u:
            Bullet->enemyYL = 2048;
            break;
          case 3u:
            Bullet->enemyXL = 2048;
            break;
          default:
            break;
        }
      }
    }
    else
    {
      Bullet->XPos += Bullet->XVel;
      Bullet->YPos += Bullet->YVel;
    }
    switch ( Level )
    {
      case 1:
        if ( Bullet->direction != 1 && Bullet->direction != 3 )
        {
          Bullet_Rect = &Bullet->displayRect;
          Bullet_Rect->left = 128;
          Bullet_Rect->top = 32;
          Bullet_Rect->right = 144;
          Bullet_Rect->bottom = 48;
        }
        else
        {
          Bullet_Rect = &Bullet->displayRect;
          Bullet_Rect->left = 144;
          Bullet_Rect->top = 32;
          Bullet_Rect->right = 160;
          Bullet_Rect->bottom = 48;
        }
        break;
      case 2:
        if ( Bullet->direction != 1 && Bullet->direction != 3 )
        {
          Bullet_Rect = &Bullet->displayRect;
          Bullet_Rect->left = 160;
          Bullet_Rect->top = 32;
          Bullet_Rect->right = 176;
          Bullet_Rect->bottom = 48;
        }
        else
        {
          Bullet_Rect = &Bullet->displayRect;
          Bullet_Rect->left = 176;
          Bullet_Rect->top = 32;
          Bullet_Rect->right = 192;
          Bullet_Rect->bottom = 48;
        }
        break;
      case 3:
        if ( Bullet->direction != 1 && Bullet->direction != 3 )
        {
          Bullet_Rect = &Bullet->displayRect;
          Bullet_Rect->left = 128;
          Bullet_Rect->top = 48;
          Bullet_Rect->right = 144;
          Bullet_Rect->bottom = 64;
        }
        else
        {
          Bullet_Rect = &Bullet->displayRect;
          Bullet_Rect->left = 144;
          Bullet_Rect->top = 48;
          Bullet_Rect->right = 160;
          Bullet_Rect->bottom = 64;
        }
        break;
    }
  }
}

//----- (00404B30) --------------------------------------------------------
// Fireball (all levels)
void __cdecl Bullet_07_08_09_Fireball(Bullet_vars *Bullet, int Level)
{
  char *v2; // eax@47 MAPDST
  char *v4; // eax@48 MAPDST
  char *v6; // ecx@53 MAPDST
  char *v8; // ecx@54 MAPDST
  RECT Rects_Right_Level_1[4]; // [sp+4h] [bp-E8h]@43
  RECT Rects_Left_Level_1[4]; // [sp+44h] [bp-A8h]@43
  RECT Rects_Right_Level_2_3[3]; // [sp+88h] [bp-64h]@43
  int v13; // [sp+B8h] [bp-34h]@3
  RECT Rects_Left_Level_2_3[3]; // [sp+BCh] [bp-30h]@43

  if ( ++Bullet->count1 > Bullet->lifeTime )
  {
    // Kill bullet
    Bullet->isAlive = 0;
    Create_Effect(Bullet->XPos, Bullet->YPos, 3, 0);
  }
  else
  {
    v13 = 0;
    if ( Bullet->isUsed & 2 && Bullet->isUsed & 8 )
      v13 = 1;
    if ( Bullet->isUsed & 1 && Bullet->isUsed & 4 )
      v13 = 1;
    if ( !Bullet->direction && Bullet->isUsed & 1 )
      Bullet->direction = 2;
    if ( Bullet->direction == 2 && Bullet->isUsed & 4 )
      Bullet->direction = 0;
    if ( v13 )
    {
      Bullet->isAlive = 0;
      Create_Effect(Bullet->XPos, Bullet->YPos, 2, 0);
      Play_Sound_Effect(Sfx_Shot_Hit_Wall, 1);
    }
    else
    {
      if ( Bullet->currentState )
      {
        if ( Bullet->isUsed & 8 )
        {
          Bullet->YVel = -1024;
        }
        else if ( Bullet->isUsed & 1 )
        {
          Bullet->XVel = 1024;
        }
        else if ( Bullet->isUsed & 4 )
        {
          Bullet->XVel = -1024;
        }
        // Do angle thing
        Bullet->YVel += 85;
        if ( Bullet->YVel > 0x3FF )             // Max downward speed of fireball
          Bullet->YVel = 0x3FF;
        Bullet->XPos += Bullet->XVel;
        Bullet->YPos += Bullet->YVel;
        if ( Bullet->isUsed & 0xD )
          Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
      }
      else
      {
        Bullet->currentState = 1;
        switch ( Bullet->direction )
        {
          case 0u:
            Bullet->XVel = -1024;
            break;
          case 1u:
            Bullet->XVel = Quote.X_Vel;
            if ( Quote.X_Vel >= 0 )
              Bullet->direction = 2;
            else
              Bullet->direction = 0;
            if ( !Quote.Direction )
              Bullet->XVel -= 0x80;
            else
              Bullet->XVel += 0x80;
            Bullet->YVel = -0x5FFu;
            break;
          case 2u:
            Bullet->XVel = 1024;
            break;
          case 3u:
            Bullet->XVel = Quote.X_Vel;
            if ( Quote.X_Vel >= 0 )
              Bullet->direction = 2;
            else
              Bullet->direction = 0;
            Bullet->YVel = 0x5FF;
            break;
          default:
            break;
        }
      }
      Rects_Left_Level_1[0].left = 128;
      Rects_Left_Level_1[0].top = 0;
      Rects_Left_Level_1[0].right = 144;
      Rects_Left_Level_1[0].bottom = 16;
      Rects_Left_Level_1[1].left = 144;
      Rects_Left_Level_1[1].top = 0;
      Rects_Left_Level_1[1].right = 160;
      Rects_Left_Level_1[1].bottom = 16;
      Rects_Left_Level_1[2].left = 160;
      Rects_Left_Level_1[2].top = 0;
      Rects_Left_Level_1[2].right = 176;
      Rects_Left_Level_1[2].bottom = 16;
      Rects_Left_Level_1[3].left = 176;
      Rects_Left_Level_1[3].top = 0;
      Rects_Left_Level_1[3].right = 192;
      Rects_Left_Level_1[3].bottom = 16;
      Rects_Right_Level_1[0].left = 128;
      Rects_Right_Level_1[0].top = 16;
      Rects_Right_Level_1[0].right = 144;
      Rects_Right_Level_1[0].bottom = 32;
      Rects_Right_Level_1[1].left = 144;
      Rects_Right_Level_1[1].top = 16;
      Rects_Right_Level_1[1].right = 160;
      Rects_Right_Level_1[1].bottom = 32;
      Rects_Right_Level_1[2].left = 160;
      Rects_Right_Level_1[2].top = 16;
      Rects_Right_Level_1[2].right = 176;
      Rects_Right_Level_1[2].bottom = 32;
      Rects_Right_Level_1[3].left = 176;
      Rects_Right_Level_1[3].top = 16;
      Rects_Right_Level_1[3].right = 192;
      Rects_Right_Level_1[3].bottom = 32;
      Rects_Left_Level_2_3[0].left = 192;
      Rects_Left_Level_2_3[0].top = 16;
      Rects_Left_Level_2_3[0].right = 208;
      Rects_Left_Level_2_3[0].bottom = 32;
      Rects_Left_Level_2_3[1].left = 208;
      Rects_Left_Level_2_3[1].top = 16;
      Rects_Left_Level_2_3[1].right = 224;
      Rects_Left_Level_2_3[1].bottom = 32;
      Rects_Left_Level_2_3[2].left = 224;
      Rects_Left_Level_2_3[2].top = 16;
      Rects_Left_Level_2_3[2].right = 240;
      Rects_Left_Level_2_3[2].bottom = 32;
      Rects_Right_Level_2_3[0].left = 224;
      Rects_Right_Level_2_3[0].top = 16;
      Rects_Right_Level_2_3[0].right = 240;
      Rects_Right_Level_2_3[0].bottom = 32;
      Rects_Right_Level_2_3[1].left = 208;
      Rects_Right_Level_2_3[1].top = 16;
      Rects_Right_Level_2_3[1].right = 224;
      Rects_Right_Level_2_3[1].bottom = 32;
      Rects_Right_Level_2_3[2].left = 192;
      Rects_Right_Level_2_3[2].top = 16;
      Rects_Right_Level_2_3[2].right = 208;
      Rects_Right_Level_2_3[2].bottom = 32;
      ++Bullet->animationNum;
      if ( Level == 1 )
      {
        if ( Bullet->animationNum > 3 )
          Bullet->animationNum = 0;
        if ( !Bullet->direction )
        {
          v2 = (char *)&Rects_Left_Level_1[Bullet->animationNum];
          v2 = (char *)&Bullet->displayRect;
          *(_DWORD *)v2 = *(_DWORD *)v2;
          *((_DWORD *)v2 + 1) = *((_DWORD *)v2 + 1);
          *((_DWORD *)v2 + 2) = *((_DWORD *)v2 + 2);
          *((_DWORD *)v2 + 3) = *((_DWORD *)v2 + 3);
        }
        else
        {
          v4 = (char *)&Rects_Right_Level_1[Bullet->animationNum];
          v4 = (char *)&Bullet->displayRect;
          *(_DWORD *)v4 = *(_DWORD *)v4;
          *((_DWORD *)v4 + 1) = *((_DWORD *)v4 + 1);
          *((_DWORD *)v4 + 2) = *((_DWORD *)v4 + 2);
          *((_DWORD *)v4 + 3) = *((_DWORD *)v4 + 3);
        }
      }
      else
      {
        if ( Bullet->animationNum > 2 )
          Bullet->animationNum = 0;
        if ( !Bullet->direction )
        {
          v6 = (char *)&Rects_Left_Level_2_3[Bullet->animationNum];
          v6 = (char *)&Bullet->displayRect;
          *(_DWORD *)v6 = *(_DWORD *)v6;
          *((_DWORD *)v6 + 1) = *((_DWORD *)v6 + 1);
          *((_DWORD *)v6 + 2) = *((_DWORD *)v6 + 2);
          *((_DWORD *)v6 + 3) = *((_DWORD *)v6 + 3);
        }
        else
        {
          v8 = (char *)&Rects_Right_Level_2_3[Bullet->animationNum];
          v8 = (char *)&Bullet->displayRect;
          *(_DWORD *)v8 = *(_DWORD *)v8;
          *((_DWORD *)v8 + 1) = *((_DWORD *)v8 + 1);
          *((_DWORD *)v8 + 2) = *((_DWORD *)v8 + 2);
          *((_DWORD *)v8 + 3) = *((_DWORD *)v8 + 3);
        }
        if ( Level == 2 )
          NPC_Create((NPC_Names)129, Bullet->XPos, Bullet->YPos, 0, -512, (Directions)Bullet->animationNum, NULL, 256);
        else
          NPC_Create(
            (NPC_Names)129,
            Bullet->XPos,
            Bullet->YPos,
            0,
            -512,
            (Directions)(Bullet->animationNum + 3),
            NULL,
            256);
      }
    }
  }
}

//----- (00405120) --------------------------------------------------------
// Machine Gun (all levels)
void __cdecl Bullet_0A_0B_0C_Machine_Gun(Bullet_vars *Bullet, int Level)
{
  RECT Rects_Level_2[4]; // [sp+Ch] [bp-C8h]@1
  int Bullet_X_Vel; // [sp+50h] [bp-84h]@8
  RECT Rects_Level_3[4]; // [sp+54h] [bp-80h]@1
  RECT Rects_Level_1[4]; // [sp+94h] [bp-40h]@1

  Rects_Level_1[0].left = 64;
  Rects_Level_1[0].top = 0;
  Rects_Level_1[0].right = 80;
  Rects_Level_1[0].bottom = 16;
  Rects_Level_1[1].left = 80;
  Rects_Level_1[1].top = 0;
  Rects_Level_1[1].right = 96;
  Rects_Level_1[1].bottom = 16;
  Rects_Level_1[2].left = 96;
  Rects_Level_1[2].top = 0;
  Rects_Level_1[2].right = 112;
  Rects_Level_1[2].bottom = 16;
  Rects_Level_1[3].left = 112;
  Rects_Level_1[3].top = 0;
  Rects_Level_1[3].right = 128;
  Rects_Level_1[3].bottom = 16;
  Rects_Level_2[0].left = 64;
  Rects_Level_2[0].top = 16;
  Rects_Level_2[0].right = 80;
  Rects_Level_2[0].bottom = 32;
  Rects_Level_2[1].left = 80;
  Rects_Level_2[1].top = 16;
  Rects_Level_2[1].right = 96;
  Rects_Level_2[1].bottom = 32;
  Rects_Level_2[2].left = 96;
  Rects_Level_2[2].top = 16;
  Rects_Level_2[2].right = 112;
  Rects_Level_2[2].bottom = 32;
  Rects_Level_2[3].left = 112;
  Rects_Level_2[3].top = 16;
  Rects_Level_2[3].right = 128;
  Rects_Level_2[3].bottom = 32;
  Rects_Level_3[0].left = 64;
  Rects_Level_3[0].top = 32;
  Rects_Level_3[0].right = 80;
  Rects_Level_3[0].bottom = 48;
  Rects_Level_3[1].left = 80;
  Rects_Level_3[1].top = 32;
  Rects_Level_3[1].right = 96;
  Rects_Level_3[1].bottom = 48;
  Rects_Level_3[2].left = 96;
  Rects_Level_3[2].top = 32;
  Rects_Level_3[2].right = 112;
  Rects_Level_3[2].bottom = 48;
  Rects_Level_3[3].left = 112;
  Rects_Level_3[3].top = 32;
  Rects_Level_3[3].right = 128;
  Rects_Level_3[3].bottom = 48;
  if ( ++Bullet->count1 > Bullet->lifeTime )
  {
    Bullet->isAlive = 0;
    Create_Effect(Bullet->XPos, Bullet->YPos, 3, 0);
  }
  else if ( Bullet->currentState )
  {
    Bullet->XPos += Bullet->XVel;
    Bullet->YPos += Bullet->YVel;
    switch ( Level )
    {
      case 1:
        Bullet->displayRect = Rects_Level_1[Bullet->direction];
        break;
      case 2:
        Bullet->displayRect = Rects_Level_2[Bullet->direction];
        if ( Bullet->direction == 1 || Bullet->direction == 3 )
          NPC_Create(Treasure_Chest_Closed|0x70, Bullet->XPos, Bullet->YPos, 0, 0, Up, NULL, 256);
        else
          NPC_Create(Treasure_Chest_Closed|0x70, Bullet->XPos, Bullet->YPos, 0, 0, 0, NULL, 256);
        break;
      case 3:
        Bullet->displayRect = Rects_Level_3[Bullet->direction];
        NPC_Create((NPC_Names)128, Bullet->XPos, Bullet->YPos, 0, 0, (Directions)Bullet->direction, NULL, 256);
        break;
    }
  }
  else
  {
    switch ( Level )
    {
      case 1:
        Bullet_X_Vel = 4096;
        break;
      case 2:
        Bullet_X_Vel = 4096;
        break;
      case 3:
        Bullet_X_Vel = 4096;
        break;
    }
    Bullet->currentState = 1;
    switch ( Bullet->direction )
    {
      case 0u:
        Bullet->XVel = -Bullet_X_Vel;
        Bullet->YVel = Random(-170, 170);
        break;
      case 1u:
        Bullet->YVel = -Bullet_X_Vel;
        Bullet->XVel = Random(-170, 170);
        break;
      case 2u:
        Bullet->XVel = Bullet_X_Vel;
        Bullet->YVel = Random(-170, 170);
        break;
      case 3u:
        Bullet->YVel = Bullet_X_Vel;
        Bullet->XVel = Random(-170, 170);
        break;
      default:
        return;
    }
  }
}

//----- (004055A0) --------------------------------------------------------
void __cdecl Bullet_0D_0E_0F_Missile_Launcher(int a1, int a2)
{
  int *v2; // edx@89
  int v3; // eax@89
  int *v4; // edx@90
  int v5; // eax@90
  int *v6; // edx@91
  int v7; // eax@91
  unsigned int v8; // [sp+10h] [bp-D8h]@47
  int v9; // [sp+1Ch] [bp-CCh]@31
  int v10; // [sp+20h] [bp-C8h]@85
  int v11; // [sp+24h] [bp-C4h]@85
  int v12; // [sp+28h] [bp-C0h]@85
  int v13; // [sp+2Ch] [bp-BCh]@85
  int v14; // [sp+30h] [bp-B8h]@85
  int v15; // [sp+34h] [bp-B4h]@85
  int v16; // [sp+38h] [bp-B0h]@85
  int v17; // [sp+3Ch] [bp-ACh]@85
  int v18; // [sp+40h] [bp-A8h]@85
  int v19; // [sp+44h] [bp-A4h]@85
  int v20; // [sp+48h] [bp-A0h]@85
  int v21; // [sp+4Ch] [bp-9Ch]@85
  int v22; // [sp+50h] [bp-98h]@85
  int v23; // [sp+54h] [bp-94h]@85
  int v24; // [sp+58h] [bp-90h]@85
  int v25; // [sp+5Ch] [bp-8Ch]@85
  int v26; // [sp+60h] [bp-88h]@85
  int v27; // [sp+64h] [bp-84h]@85
  int v28; // [sp+68h] [bp-80h]@85
  int v29; // [sp+6Ch] [bp-7Ch]@85
  int v30; // [sp+70h] [bp-78h]@85
  int v31; // [sp+74h] [bp-74h]@85
  int v32; // [sp+78h] [bp-70h]@85
  int v33; // [sp+7Ch] [bp-6Ch]@85
  int v34; // [sp+80h] [bp-68h]@85
  int v35; // [sp+84h] [bp-64h]@85
  int v36; // [sp+88h] [bp-60h]@85
  int v37; // [sp+8Ch] [bp-5Ch]@85
  int v38; // [sp+90h] [bp-58h]@85
  int v39; // [sp+94h] [bp-54h]@85
  int v40; // [sp+98h] [bp-50h]@85
  int v41; // [sp+9Ch] [bp-4Ch]@85
  int v42; // [sp+A0h] [bp-48h]@85
  int v43; // [sp+A4h] [bp-44h]@85
  int v44; // [sp+A8h] [bp-40h]@85
  int v45; // [sp+ACh] [bp-3Ch]@85
  int v46; // [sp+B0h] [bp-38h]@85
  int v47; // [sp+B4h] [bp-34h]@85
  int v48; // [sp+B8h] [bp-30h]@85
  int v49; // [sp+BCh] [bp-2Ch]@85
  int v50; // [sp+C0h] [bp-28h]@85
  int v51; // [sp+C4h] [bp-24h]@85
  int v52; // [sp+C8h] [bp-20h]@85
  int v53; // [sp+CCh] [bp-1Ch]@85
  int v54; // [sp+D0h] [bp-18h]@85
  int v55; // [sp+D4h] [bp-14h]@85
  int v56; // [sp+D8h] [bp-10h]@85
  int v57; // [sp+DCh] [bp-Ch]@85
  int v58; // [sp+E4h] [bp-4h]@3

  if ( ++*(_DWORD *)(a1 + 76) > *(_DWORD *)(a1 + 84) )
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
    return;
  }
  v58 = 0;
  if ( *(_DWORD *)(a1 + 92) != 10 )
    v58 = 1;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 1 )
    v58 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 4 )
    v58 = 1;
  if ( *(_BYTE *)(a1 + 56) == 1 && *(_DWORD *)a1 & 2 )
    v58 = 1;
  if ( *(_BYTE *)(a1 + 56) == 3 && *(_DWORD *)a1 & 8 )
    v58 = 1;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 0x80 )
    v58 = 1;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 0x20 )
    v58 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 0x40 )
    v58 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 0x10 )
    v58 = 1;
  if ( v58 )
  {
    Create_Bullet((Bullet_enum)(a2 + 15), *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 0);
    *(_DWORD *)(a1 + 12) = 0;
  }
  v9 = *(_DWORD *)(a1 + 40);
  if ( !v9 )
  {
    *(_DWORD *)(a1 + 40) = 1;
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
      case 2:
        *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 20);
        break;
      case 1:
      case 3:
        *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 16);
        break;
      default:
        break;
    }
    if ( a2 == 3 )
    {
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
        case 2:
          if ( *(_DWORD *)(a1 + 20) <= Quote.Y_Pos )
            *(_DWORD *)(a1 + 28) = -256;
          else
            *(_DWORD *)(a1 + 28) = 256;
          *(_DWORD *)(a1 + 24) = Random(-512, 512);
          break;
        case 1:
        case 3:
          if ( *(_DWORD *)(a1 + 16) <= Quote.X_Pos )
            *(_DWORD *)(a1 + 24) = -256;
          else
            *(_DWORD *)(a1 + 24) = 256;
          *(_DWORD *)(a1 + 28) = Random(-512, 512);
          break;
        default:
          break;
      }
      v8 = ++dword_49BC9C % 3u;
      if ( dword_49BC9C % 3u )
      {
        if ( v8 == 1 )
        {
          *(_DWORD *)(a1 + 52) = 64;
        }
        else if ( v8 == 2 )
        {
          *(_DWORD *)(a1 + 52) = 51;
        }
      }
      else
      {
        *(_DWORD *)(a1 + 52) = 128;
      }
    }
    else
    {
      *(_DWORD *)(a1 + 52) = 128;
    }
    goto LABEL_56;
  }
  if ( v9 == 1 )
  {
LABEL_56:
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        *(_DWORD *)(a1 + 24) -= *(_DWORD *)(a1 + 52);
        break;
      case 1:
        *(_DWORD *)(a1 + 28) -= *(_DWORD *)(a1 + 52);
        break;
      case 2:
        *(_DWORD *)(a1 + 24) += *(_DWORD *)(a1 + 52);
        break;
      case 3:
        *(_DWORD *)(a1 + 28) += *(_DWORD *)(a1 + 52);
        break;
      default:
        break;
    }
    if ( a2 == 3 )
    {
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
        case 2:
          if ( *(_DWORD *)(a1 + 20) >= *(_DWORD *)(a1 + 36) )
            *(_DWORD *)(a1 + 28) -= 32;
          else
            *(_DWORD *)(a1 + 28) += 32;
          break;
        case 1:
        case 3:
          if ( *(_DWORD *)(a1 + 16) >= *(_DWORD *)(a1 + 32) )
            *(_DWORD *)(a1 + 24) -= 32;
          else
            *(_DWORD *)(a1 + 24) += 32;
          break;
        default:
          break;
      }
    }
    if ( *(_DWORD *)(a1 + 24) < -2560 )
      *(_DWORD *)(a1 + 24) = -2560;
    if ( *(_DWORD *)(a1 + 24) > 2560 )
      *(_DWORD *)(a1 + 24) = 2560;
    if ( *(_DWORD *)(a1 + 28) < -2560 )
      *(_DWORD *)(a1 + 28) = -2560;
    if ( *(_DWORD *)(a1 + 28) > 2560 )
      *(_DWORD *)(a1 + 28) = 2560;
    *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
    *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
  }
  if ( ++*(_DWORD *)(a1 + 80) > 2 )
  {
    *(_DWORD *)(a1 + 80) = 0;
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        Create_Effect(*(_DWORD *)(a1 + 16) + 4096, *(_DWORD *)(a1 + 20), 7, 2);
        break;
      case 1:
        Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20) + 4096, 7, 3);
        break;
      case 2:
        Create_Effect(*(_DWORD *)(a1 + 16) - 4096, *(_DWORD *)(a1 + 20), 7, 0);
        break;
      case 3:
        Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20) - 4096, 7, 1);
        break;
      default:
        break;
    }
  }
  v42 = 0;
  v43 = 0;
  v44 = 16;
  v45 = 16;
  v46 = 16;
  v47 = 0;
  v48 = 32;
  v49 = 16;
  v50 = 32;
  v51 = 0;
  v52 = 48;
  v53 = 16;
  v54 = 48;
  v55 = 0;
  v56 = 64;
  v57 = 16;
  v10 = 0;
  v11 = 16;
  v12 = 16;
  v13 = 32;
  v14 = 16;
  v15 = 16;
  v16 = 32;
  v17 = 32;
  v18 = 32;
  v19 = 16;
  v20 = 48;
  v21 = 32;
  v22 = 48;
  v23 = 16;
  v24 = 64;
  v25 = 32;
  v26 = 0;
  v27 = 32;
  v28 = 16;
  v29 = 48;
  v30 = 16;
  v31 = 32;
  v32 = 32;
  v33 = 48;
  v34 = 32;
  v35 = 32;
  v36 = 48;
  v37 = 48;
  v38 = 48;
  v39 = 32;
  v40 = 64;
  v41 = 48;
  switch ( a2 )
  {
    case 1:
      v2 = &v42 + 4 * *(_BYTE *)(a1 + 56);
      v3 = a1 + 60;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      *(_DWORD *)(v3 + 12) = v2[3];
      break;
    case 2:
      v4 = &v10 + 4 * *(_BYTE *)(a1 + 56);
      v5 = a1 + 60;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      *(_DWORD *)(v5 + 12) = v4[3];
      break;
    case 3:
      v6 = &v26 + 4 * *(_BYTE *)(a1 + 56);
      v7 = a1 + 60;
      *(_DWORD *)v7 = *v6;
      *(_DWORD *)(v7 + 4) = v6[1];
      *(_DWORD *)(v7 + 8) = v6[2];
      *(_DWORD *)(v7 + 12) = v6[3];
      break;
  }
}
// 49BC9C: using guessed type int dword_49BC9C;

//----- (00405D80) --------------------------------------------------------
Bullet_vars *__cdecl Bullet_10_11_12_Missile_Explosion(Bullet_vars *bullet, int a2)
{
  Bullet_vars *result; // eax@1
  int v3; // ST0C_4@17
  int v4; // ST08_4@17
  int v5; // eax@17
  int v6; // ST0C_4@20
  int v7; // ST08_4@20
  int v8; // eax@20
  int v9; // ST0C_4@23
  int v10; // ST08_4@23
  int v11; // eax@23
  int v12; // [sp+8h] [bp-4h]@1

  result = bullet;
  v12 = bullet->currentState;
  if ( v12 )
  {
    if ( v12 != 1 )
      return result;
  }
  else
  {
    bullet->currentState = 1;
    switch ( a2 )
    {
      case 1:
        bullet->act_wait = 10;
        break;
      case 2:
        bullet->act_wait = 15;
        break;
      case 3:
        bullet->act_wait = 5;
        break;
    }
    Play_Sound_Effect(Sfx_Missile_Impact, 1);
  }
  if ( a2 == 1 )
  {
    if ( !(bullet->act_wait % 3) )
    {
      v3 = bullet->enemyXL;
      v4 = bullet->YPos + (Random(-16, 16) << 9);
      v5 = Random(-16, 16);
      Create_Dust_Clouds_Up(bullet->XPos + (v5 << 9), v4, v3, 2);
    }
  }
  else if ( a2 == 2 )
  {
    if ( !(bullet->act_wait % 3) )
    {
      v6 = bullet->enemyXL;
      v7 = bullet->YPos + (Random(-32, 32) << 9);
      v8 = Random(-32, 32);
      Create_Dust_Clouds_Up(bullet->XPos + (v8 << 9), v7, v6, 2);
    }
  }
  else if ( a2 == 3 && !(bullet->act_wait % 3) )
  {
    v9 = bullet->enemyXL;
    v10 = bullet->YPos + (Random(-40, 40) << 9);
    v11 = Random(-40, 40);
    Create_Dust_Clouds_Up(bullet->XPos + (v11 << 9), v10, v9, 2);
  }
  --bullet->act_wait;
  result = bullet;
  if ( bullet->act_wait < 0 )
    bullet->isAlive = 0;
  return result;
}

//----- (00405F30) --------------------------------------------------------
void __cdecl Bullet_13_Bubbler_Lvl1(int a1)
{
  int *v1; // ecx@20
  int v2; // edx@20
  int v3; // [sp+Ch] [bp-40h]@16
  int v4; // [sp+10h] [bp-3Ch]@16
  int v5; // [sp+14h] [bp-38h]@16
  int v6; // [sp+18h] [bp-34h]@16
  int v7; // [sp+1Ch] [bp-30h]@16
  int v8; // [sp+20h] [bp-2Ch]@16
  int v9; // [sp+24h] [bp-28h]@16
  int v10; // [sp+28h] [bp-24h]@16
  int v11; // [sp+2Ch] [bp-20h]@16
  int v12; // [sp+30h] [bp-1Ch]@16
  int v13; // [sp+34h] [bp-18h]@16
  int v14; // [sp+38h] [bp-14h]@16
  int v15; // [sp+3Ch] [bp-10h]@16
  int v16; // [sp+40h] [bp-Ch]@16
  int v17; // [sp+44h] [bp-8h]@16
  int v18; // [sp+48h] [bp-4h]@16

  if ( *(_DWORD *)a1 & 0x2FF )
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 2, 0);
  }
  else
  {
    if ( !*(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -1536;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = 1536;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -1536;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = 1536;
          break;
        default:
          break;
      }
    }
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        *(_DWORD *)(a1 + 24) += 42;
        break;
      case 2:
        *(_DWORD *)(a1 + 24) -= 42;
        break;
      case 1:
        *(_DWORD *)(a1 + 28) += 42;
        break;
      case 3:
        *(_DWORD *)(a1 + 28) -= 42;
        break;
      default:
        break;
    }
    *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
    *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    if ( ++*(_DWORD *)(a1 + 44) > 40 )
    {
      *(_DWORD *)(a1 + 12) = 0;
      Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 15, 0);
    }
    v3 = 192;
    v4 = 0;
    v5 = 200;
    v6 = 8;
    v7 = 200;
    v8 = 0;
    v9 = 208;
    v10 = 8;
    v11 = 208;
    v12 = 0;
    v13 = 216;
    v14 = 8;
    v15 = 216;
    v16 = 0;
    v17 = 224;
    v18 = 8;
    if ( ++*(_DWORD *)(a1 + 48) > 3 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 3;
    v1 = &v3 + 4 * *(_DWORD *)(a1 + 52);
    v2 = a1 + 60;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
}

//----- (00406190) --------------------------------------------------------
void __cdecl Bullet_14_Bubbler_Lvl2(int a1)
{
  int *v1; // ecx@32
  int v2; // edx@32
  signed int v3; // [sp+Ch] [bp-44h]@1
  int v4; // [sp+10h] [bp-40h]@28
  int v5; // [sp+14h] [bp-3Ch]@28
  int v6; // [sp+18h] [bp-38h]@28
  int v7; // [sp+1Ch] [bp-34h]@28
  int v8; // [sp+20h] [bp-30h]@28
  int v9; // [sp+24h] [bp-2Ch]@28
  int v10; // [sp+28h] [bp-28h]@28
  int v11; // [sp+2Ch] [bp-24h]@28
  int v12; // [sp+30h] [bp-20h]@28
  int v13; // [sp+34h] [bp-1Ch]@28
  int v14; // [sp+38h] [bp-18h]@28
  int v15; // [sp+3Ch] [bp-14h]@28
  int v16; // [sp+40h] [bp-10h]@28
  int v17; // [sp+44h] [bp-Ch]@28
  int v18; // [sp+48h] [bp-8h]@28
  int v19; // [sp+4Ch] [bp-4h]@28

  v3 = 0;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 1 )
    v3 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 4 )
    v3 = 1;
  if ( *(_BYTE *)(a1 + 56) == 1 && *(_DWORD *)a1 & 2 )
    v3 = 1;
  if ( *(_BYTE *)(a1 + 56) == 3 && *(_DWORD *)a1 & 8 )
    v3 = 1;
  if ( v3 )
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 2, 0);
  }
  else
  {
    if ( !*(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -1536;
          *(_DWORD *)(a1 + 28) = Random(-256, 256);
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = 1536;
          *(_DWORD *)(a1 + 28) = Random(-256, 256);
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -1536;
          *(_DWORD *)(a1 + 24) = Random(-256, 256);
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = 1536;
          *(_DWORD *)(a1 + 24) = Random(-256, 256);
          break;
        default:
          break;
      }
    }
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        *(_DWORD *)(a1 + 24) += 16;
        break;
      case 2:
        *(_DWORD *)(a1 + 24) -= 16;
        break;
      case 1:
        *(_DWORD *)(a1 + 28) += 16;
        break;
      case 3:
        *(_DWORD *)(a1 + 28) -= 16;
        break;
      default:
        break;
    }
    *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
    *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    if ( ++*(_DWORD *)(a1 + 44) > 60 )
    {
      *(_DWORD *)(a1 + 12) = 0;
      Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 15, 0);
    }
    v4 = 192;
    v5 = 8;
    v6 = 200;
    v7 = 16;
    v8 = 200;
    v9 = 8;
    v10 = 208;
    v11 = 16;
    v12 = 208;
    v13 = 8;
    v14 = 216;
    v15 = 16;
    v16 = 216;
    v17 = 8;
    v18 = 224;
    v19 = 16;
    if ( ++*(_DWORD *)(a1 + 48) > 3 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 3;
    v1 = &v4 + 4 * *(_DWORD *)(a1 + 52);
    v2 = a1 + 60;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
}

//----- (004064D0) --------------------------------------------------------
void __cdecl Bullet_15_Bubbler_Lvl3(int a1)
{
  int *v1; // ecx@39
  int v2; // edx@39
  int v3; // [sp+8h] [bp-40h]@35
  int v4; // [sp+Ch] [bp-3Ch]@35
  int v5; // [sp+10h] [bp-38h]@35
  int v6; // [sp+14h] [bp-34h]@35
  int v7; // [sp+18h] [bp-30h]@35
  int v8; // [sp+1Ch] [bp-2Ch]@35
  int v9; // [sp+20h] [bp-28h]@35
  int v10; // [sp+24h] [bp-24h]@35
  int v11; // [sp+28h] [bp-20h]@35
  int v12; // [sp+2Ch] [bp-1Ch]@35
  int v13; // [sp+30h] [bp-18h]@35
  int v14; // [sp+34h] [bp-14h]@35
  int v15; // [sp+38h] [bp-10h]@35
  int v16; // [sp+3Ch] [bp-Ch]@35
  int v17; // [sp+40h] [bp-8h]@35
  int v18; // [sp+44h] [bp-4h]@35

  if ( ++*(_DWORD *)(a1 + 44) <= 100 && Key_Shoot & Key_Held )
  {
    if ( !*(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = Random(-1024, -512);
          *(_DWORD *)(a1 + 28) = (Random(-4, 4) << 9) / 2;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = Random(512, 1024);
          *(_DWORD *)(a1 + 28) = (Random(-4, 4) << 9) / 2;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = Random(-1024, -512);
          *(_DWORD *)(a1 + 24) = (Random(-4, 4) << 9) / 2;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = Random(128, 256);
          *(_DWORD *)(a1 + 24) = (Random(-4, 4) << 9) / 2;
          break;
        default:
          break;
      }
    }
    if ( *(_DWORD *)(a1 + 16) < Quote.X_Pos )
      *(_DWORD *)(a1 + 24) += 32;
    if ( *(_DWORD *)(a1 + 16) > Quote.X_Pos )
      *(_DWORD *)(a1 + 24) -= 32;
    if ( *(_DWORD *)(a1 + 20) < Quote.Y_Pos )
      *(_DWORD *)(a1 + 28) += 32;
    if ( *(_DWORD *)(a1 + 20) > Quote.Y_Pos )
      *(_DWORD *)(a1 + 28) -= 32;
    if ( *(_DWORD *)(a1 + 24) < 0 && *(_DWORD *)a1 & 1 )
      *(_DWORD *)(a1 + 24) = 1024;
    if ( *(_DWORD *)(a1 + 24) > 0 && *(_DWORD *)a1 & 4 )
      *(_DWORD *)(a1 + 24) = -1024;
    if ( *(_DWORD *)(a1 + 28) < 0 && *(_DWORD *)a1 & 2 )
      *(_DWORD *)(a1 + 28) = 1024;
    if ( *(_DWORD *)(a1 + 28) > 0 && *(_DWORD *)a1 & 8 )
      *(_DWORD *)(a1 + 28) = -1024;
    *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
    *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    v3 = 240;
    v4 = 16;
    v5 = 248;
    v6 = 24;
    v7 = 248;
    v8 = 16;
    v9 = 256;
    v10 = 24;
    v11 = 240;
    v12 = 24;
    v13 = 248;
    v14 = 32;
    v15 = 248;
    v16 = 24;
    v17 = 256;
    v18 = 32;
    if ( ++*(_DWORD *)(a1 + 48) > 3 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 3;
    v1 = &v3 + 4 * *(_DWORD *)(a1 + 52);
    v2 = a1 + 60;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  else
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 2, 0);
    Play_Sound_Effect(Sfx_Bubbler_Shoot_Level_3, 1);
    if ( Quote.Is_Facing_Up )
    {
      Create_Bullet(Bubble_Spurs, *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), Up);
    }
    else if ( Quote.Is_Facing_Down )
    {
      Create_Bullet(Bubble_Spurs, *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), Down);
    }
    else
    {
      Create_Bullet(Bubble_Spurs, *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), (Directions)Quote.Direction);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E210: using guessed type int Key_Held;

//----- (004068B0) --------------------------------------------------------
void __cdecl Bullet_16_Bubble_Spurs(int a1)
{
  int *v1; // edx@17
  int v2; // eax@17
  int *v3; // edx@18
  int v4; // eax@18
  int *v5; // edx@19
  int v6; // eax@19
  int *v7; // edx@20
  int v8; // eax@20
  int v9; // [sp+8h] [bp-60h]@16
  int v10; // [sp+Ch] [bp-5Ch]@16
  int v11; // [sp+10h] [bp-58h]@16
  int v12; // [sp+14h] [bp-54h]@16
  int v13; // [sp+18h] [bp-50h]@16
  int v14; // [sp+1Ch] [bp-4Ch]@16
  int v15; // [sp+20h] [bp-48h]@16
  int v16; // [sp+24h] [bp-44h]@16
  int v17; // [sp+28h] [bp-40h]@16
  int v18; // [sp+2Ch] [bp-3Ch]@16
  int v19; // [sp+30h] [bp-38h]@16
  int v20; // [sp+34h] [bp-34h]@16
  int v21; // [sp+38h] [bp-30h]@16
  int v22; // [sp+3Ch] [bp-2Ch]@16
  int v23; // [sp+40h] [bp-28h]@16
  int v24; // [sp+44h] [bp-24h]@16
  int v25; // [sp+48h] [bp-20h]@16
  int v26; // [sp+4Ch] [bp-1Ch]@16
  int v27; // [sp+50h] [bp-18h]@16
  int v28; // [sp+54h] [bp-14h]@16
  int v29; // [sp+58h] [bp-10h]@16
  int v30; // [sp+5Ch] [bp-Ch]@16
  int v31; // [sp+60h] [bp-8h]@16
  int v32; // [sp+64h] [bp-4h]@16

  if ( ++*(_DWORD *)(a1 + 76) > *(_DWORD *)(a1 + 84) || *(_DWORD *)a1 & 8 )
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
  }
  else
  {
    if ( *(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    }
    else
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -512 * Random(10, 16) / 2;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -512 * Random(10, 16) / 2;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = (Random(10, 16) << 9) / 2;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = (Random(10, 16) << 9) / 2;
          break;
        default:
          break;
      }
    }
    if ( ++*(_DWORD *)(a1 + 48) > 1 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 1 )
      *(_DWORD *)(a1 + 52) = 0;
    v25 = 224;
    v26 = 0;
    v27 = 232;
    v28 = 8;
    v29 = 232;
    v30 = 0;
    v31 = 240;
    v32 = 8;
    v17 = 224;
    v18 = 0;
    v19 = 232;
    v20 = 8;
    v21 = 232;
    v22 = 0;
    v23 = 240;
    v24 = 8;
    v9 = 224;
    v10 = 8;
    v11 = 232;
    v12 = 16;
    v13 = 232;
    v14 = 8;
    v15 = 240;
    v16 = 16;
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        v1 = &v25 + 4 * *(_DWORD *)(a1 + 52);
        v2 = a1 + 60;
        *(_DWORD *)v2 = *v1;
        *(_DWORD *)(v2 + 4) = v1[1];
        *(_DWORD *)(v2 + 8) = v1[2];
        *(_DWORD *)(v2 + 12) = v1[3];
        break;
      case 1:
        v3 = &v9 + 4 * *(_DWORD *)(a1 + 52);
        v4 = a1 + 60;
        *(_DWORD *)v4 = *v3;
        *(_DWORD *)(v4 + 4) = v3[1];
        *(_DWORD *)(v4 + 8) = v3[2];
        *(_DWORD *)(v4 + 12) = v3[3];
        break;
      case 2:
        v5 = &v17 + 4 * *(_DWORD *)(a1 + 52);
        v6 = a1 + 60;
        *(_DWORD *)v6 = *v5;
        *(_DWORD *)(v6 + 4) = v5[1];
        *(_DWORD *)(v6 + 8) = v5[2];
        *(_DWORD *)(v6 + 12) = v5[3];
        break;
      case 3:
        v7 = &v9 + 4 * *(_DWORD *)(a1 + 52);
        v8 = a1 + 60;
        *(_DWORD *)v8 = *v7;
        *(_DWORD *)(v8 + 4) = v7[1];
        *(_DWORD *)(v8 + 8) = v7[2];
        *(_DWORD *)(v8 + 12) = v7[3];
        break;
      default:
        return;
    }
  }
}

//----- (00406BB0) --------------------------------------------------------
void __cdecl Bullet_19_Blade_Lvl_1(int a1)
{
  int *v1; // eax@20
  int v2; // ecx@20
  int *v3; // eax@21
  int v4; // ecx@21
  int v5; // [sp+4h] [bp-80h]@15
  int v6; // [sp+8h] [bp-7Ch]@15
  int v7; // [sp+Ch] [bp-78h]@15
  int v8; // [sp+10h] [bp-74h]@15
  int v9; // [sp+14h] [bp-70h]@15
  int v10; // [sp+18h] [bp-6Ch]@15
  int v11; // [sp+1Ch] [bp-68h]@15
  int v12; // [sp+20h] [bp-64h]@15
  int v13; // [sp+24h] [bp-60h]@15
  int v14; // [sp+28h] [bp-5Ch]@15
  int v15; // [sp+2Ch] [bp-58h]@15
  int v16; // [sp+30h] [bp-54h]@15
  int v17; // [sp+34h] [bp-50h]@15
  int v18; // [sp+38h] [bp-4Ch]@15
  int v19; // [sp+3Ch] [bp-48h]@15
  int v20; // [sp+40h] [bp-44h]@15
  int v21; // [sp+44h] [bp-40h]@15
  int v22; // [sp+48h] [bp-3Ch]@15
  int v23; // [sp+4Ch] [bp-38h]@15
  int v24; // [sp+50h] [bp-34h]@15
  int v25; // [sp+54h] [bp-30h]@15
  int v26; // [sp+58h] [bp-2Ch]@15
  int v27; // [sp+5Ch] [bp-28h]@15
  int v28; // [sp+60h] [bp-24h]@15
  int v29; // [sp+64h] [bp-20h]@15
  int v30; // [sp+68h] [bp-1Ch]@15
  int v31; // [sp+6Ch] [bp-18h]@15
  int v32; // [sp+70h] [bp-14h]@15
  int v33; // [sp+74h] [bp-10h]@15
  int v34; // [sp+78h] [bp-Ch]@15
  int v35; // [sp+7Ch] [bp-8h]@15
  int v36; // [sp+80h] [bp-4h]@15

  if ( ++*(_DWORD *)(a1 + 76) <= *(_DWORD *)(a1 + 84) )
  {
    if ( *(_DWORD *)(a1 + 76) == 3 )
      *(_DWORD *)(a1 + 8) &= 0xFFFFFFFB;
    if ( *(_DWORD *)(a1 + 76) % 5 == 1 )
      Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
    if ( *(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    }
    else
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -2048;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -2048;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = 2048;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = 2048;
          break;
        default:
          break;
      }
    }
    v21 = 0;
    v22 = 48;
    v23 = 16;
    v24 = 64;
    v25 = 16;
    v26 = 48;
    v27 = 32;
    v28 = 64;
    v29 = 32;
    v30 = 48;
    v31 = 48;
    v32 = 64;
    v33 = 48;
    v34 = 48;
    v35 = 64;
    v36 = 64;
    v5 = 64;
    v6 = 48;
    v7 = 80;
    v8 = 64;
    v9 = 80;
    v10 = 48;
    v11 = 96;
    v12 = 64;
    v13 = 96;
    v14 = 48;
    v15 = 112;
    v16 = 64;
    v17 = 112;
    v18 = 48;
    v19 = 128;
    v20 = 64;
    if ( ++*(_DWORD *)(a1 + 48) > 1 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 0;
    if ( *(_BYTE *)(a1 + 56) )
    {
      v3 = &v5 + 4 * *(_DWORD *)(a1 + 52);
      v4 = a1 + 60;
      *(_DWORD *)v4 = *v3;
      *(_DWORD *)(v4 + 4) = v3[1];
      *(_DWORD *)(v4 + 8) = v3[2];
      *(_DWORD *)(v4 + 12) = v3[3];
    }
    else
    {
      v1 = &v21 + 4 * *(_DWORD *)(a1 + 52);
      v2 = a1 + 60;
      *(_DWORD *)v2 = *v1;
      *(_DWORD *)(v2 + 4) = v1[1];
      *(_DWORD *)(v2 + 8) = v1[2];
      *(_DWORD *)(v2 + 12) = v1[3];
    }
  }
  else
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
  }
}

//----- (00406E60) --------------------------------------------------------
void __cdecl Bullet_1A_Blade_Lvl_2(int a1)
{
  int *v1; // eax@20
  int v2; // ecx@20
  int *v3; // eax@21
  int v4; // ecx@21
  int v5; // [sp+4h] [bp-80h]@15
  int v6; // [sp+8h] [bp-7Ch]@15
  int v7; // [sp+Ch] [bp-78h]@15
  int v8; // [sp+10h] [bp-74h]@15
  int v9; // [sp+14h] [bp-70h]@15
  int v10; // [sp+18h] [bp-6Ch]@15
  int v11; // [sp+1Ch] [bp-68h]@15
  int v12; // [sp+20h] [bp-64h]@15
  int v13; // [sp+24h] [bp-60h]@15
  int v14; // [sp+28h] [bp-5Ch]@15
  int v15; // [sp+2Ch] [bp-58h]@15
  int v16; // [sp+30h] [bp-54h]@15
  int v17; // [sp+34h] [bp-50h]@15
  int v18; // [sp+38h] [bp-4Ch]@15
  int v19; // [sp+3Ch] [bp-48h]@15
  int v20; // [sp+40h] [bp-44h]@15
  int v21; // [sp+44h] [bp-40h]@15
  int v22; // [sp+48h] [bp-3Ch]@15
  int v23; // [sp+4Ch] [bp-38h]@15
  int v24; // [sp+50h] [bp-34h]@15
  int v25; // [sp+54h] [bp-30h]@15
  int v26; // [sp+58h] [bp-2Ch]@15
  int v27; // [sp+5Ch] [bp-28h]@15
  int v28; // [sp+60h] [bp-24h]@15
  int v29; // [sp+64h] [bp-20h]@15
  int v30; // [sp+68h] [bp-1Ch]@15
  int v31; // [sp+6Ch] [bp-18h]@15
  int v32; // [sp+70h] [bp-14h]@15
  int v33; // [sp+74h] [bp-10h]@15
  int v34; // [sp+78h] [bp-Ch]@15
  int v35; // [sp+7Ch] [bp-8h]@15
  int v36; // [sp+80h] [bp-4h]@15

  if ( ++*(_DWORD *)(a1 + 76) <= *(_DWORD *)(a1 + 84) )
  {
    if ( *(_DWORD *)(a1 + 76) == 3 )
      *(_DWORD *)(a1 + 8) &= 0xFFFFFFFB;
    if ( *(_DWORD *)(a1 + 76) % 7 == 1 )
      Play_Sound_Effect(Sfx_Spinning_Projectile, 1);
    if ( *(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    }
    else
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -2048;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -2048;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = 2048;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = 2048;
          break;
        default:
          break;
      }
    }
    v21 = 160;
    v22 = 48;
    v23 = 184;
    v24 = 72;
    v25 = 184;
    v26 = 48;
    v27 = 208;
    v28 = 72;
    v29 = 208;
    v30 = 48;
    v31 = 232;
    v32 = 72;
    v33 = 232;
    v34 = 48;
    v35 = 256;
    v36 = 72;
    v5 = 160;
    v6 = 72;
    v7 = 184;
    v8 = 96;
    v9 = 184;
    v10 = 72;
    v11 = 208;
    v12 = 96;
    v13 = 208;
    v14 = 72;
    v15 = 232;
    v16 = 96;
    v17 = 232;
    v18 = 72;
    v19 = 256;
    v20 = 96;
    if ( ++*(_DWORD *)(a1 + 48) > 1 )
    {
      *(_DWORD *)(a1 + 48) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 0;
    if ( *(_BYTE *)(a1 + 56) )
    {
      v3 = &v5 + 4 * *(_DWORD *)(a1 + 52);
      v4 = a1 + 60;
      *(_DWORD *)v4 = *v3;
      *(_DWORD *)(v4 + 4) = v3[1];
      *(_DWORD *)(v4 + 8) = v3[2];
      *(_DWORD *)(v4 + 12) = v3[3];
    }
    else
    {
      v1 = &v21 + 4 * *(_DWORD *)(a1 + 52);
      v2 = a1 + 60;
      *(_DWORD *)v2 = *v1;
      *(_DWORD *)(v2 + 4) = v1[1];
      *(_DWORD *)(v2 + 8) = v1[2];
      *(_DWORD *)(v2 + 12) = v1[3];
    }
  }
  else
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
  }
}

//----- (00407110) --------------------------------------------------------
void __cdecl Bullet_1B_Blade_Lvl_3(int a1)
{
  int v1; // ST08_4@24
  int v2; // eax@24
  int v3; // ST08_4@25
  int v4; // eax@25
  int *v5; // eax@29
  int v6; // ecx@29
  int *v7; // eax@30
  int v8; // ecx@30
  int *v9; // eax@31
  int v10; // ecx@31
  int *v11; // eax@32
  int v12; // ecx@32
  int v13; // [sp+8h] [bp-84h]@1
  int v14; // [sp+Ch] [bp-80h]@1
  int v15; // [sp+10h] [bp-7Ch]@1
  int v16; // [sp+14h] [bp-78h]@1
  int v17; // [sp+18h] [bp-74h]@1
  int v18; // [sp+1Ch] [bp-70h]@1
  int v19; // [sp+20h] [bp-6Ch]@1
  int v20; // [sp+24h] [bp-68h]@1
  int v21; // [sp+28h] [bp-64h]@1
  int v22; // [sp+2Ch] [bp-60h]@1
  int v23; // [sp+30h] [bp-5Ch]@1
  int v24; // [sp+34h] [bp-58h]@1
  int v25; // [sp+38h] [bp-54h]@1
  int v26; // [sp+3Ch] [bp-50h]@1
  int v27; // [sp+40h] [bp-4Ch]@1
  int v28; // [sp+44h] [bp-48h]@1
  int v29; // [sp+48h] [bp-44h]@1
  int v30; // [sp+4Ch] [bp-40h]@1
  int v31; // [sp+50h] [bp-3Ch]@1
  int v32; // [sp+54h] [bp-38h]@1
  int v33; // [sp+58h] [bp-34h]@1
  int v34; // [sp+5Ch] [bp-30h]@1
  int v35; // [sp+60h] [bp-2Ch]@1
  int v36; // [sp+64h] [bp-28h]@1
  int v37; // [sp+68h] [bp-24h]@1
  int v38; // [sp+6Ch] [bp-20h]@1
  int v39; // [sp+70h] [bp-1Ch]@1
  int v40; // [sp+74h] [bp-18h]@1
  int v41; // [sp+78h] [bp-14h]@1
  int v42; // [sp+7Ch] [bp-10h]@1
  int v43; // [sp+80h] [bp-Ch]@1
  int v44; // [sp+84h] [bp-8h]@1
  int v45; // [sp+88h] [bp-4h]@1

  v30 = 272;
  v31 = 0;
  v32 = 296;
  v33 = 24;
  v34 = 296;
  v35 = 0;
  v36 = 320;
  v37 = 24;
  v38 = 272;
  v39 = 48;
  v40 = 296;
  v41 = 72;
  v42 = 296;
  v43 = 0;
  v44 = 320;
  v45 = 24;
  v22 = 272;
  v23 = 24;
  v24 = 296;
  v25 = 48;
  v26 = 296;
  v27 = 24;
  v28 = 320;
  v29 = 48;
  v14 = 296;
  v15 = 48;
  v16 = 320;
  v17 = 72;
  v18 = 296;
  v19 = 24;
  v20 = 320;
  v21 = 48;
  v13 = *(_DWORD *)(a1 + 40);
  if ( v13 )
  {
    if ( v13 != 1 )
    {
      if ( v13 == 2 )
      {
        *(_DWORD *)(a1 + 24) = 0;
        *(_DWORD *)(a1 + 28) = 0;
        ++*(_DWORD *)(a1 + 44);
        if ( !Random(-1, 1) )
        {
          Play_Sound_Effect(Sfx_Spinning_Projectile, 1);
          if ( Random(0, 1) % 2 )
          {
            v1 = *(_DWORD *)(a1 + 20) + (Random(-64, 64) << 9);
            v2 = Random(-64, 64);
            Create_Bullet(Blade_Slash, *(_DWORD *)(a1 + 16) + (v2 << 9), v1, 0);
          }
          else
          {
            v3 = *(_DWORD *)(a1 + 20) + (Random(-64, 64) << 9);
            v4 = Random(-64, 64);
            Create_Bullet(Blade_Slash, *(_DWORD *)(a1 + 16) + (v4 << 9), v3, Right);
          }
        }
        if ( *(_DWORD *)(a1 + 44) > 50 )
          *(_DWORD *)(a1 + 12) = 0;
      }
      goto LABEL_28;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 40) = 1;
    *(_DWORD *)(a1 + 24) = 0;
    *(_DWORD *)(a1 + 28) = 0;
  }
  switch ( *(_BYTE *)(a1 + 56) )
  {
    case 0:
      *(_DWORD *)(a1 + 24) = -2048;
      break;
    case 1:
      *(_DWORD *)(a1 + 28) = -2048;
      break;
    case 2:
      *(_DWORD *)(a1 + 24) = 2048;
      break;
    case 3:
      *(_DWORD *)(a1 + 28) = 2048;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 92) != 100 )
  {
    *(_DWORD *)(a1 + 40) = 2;
    *(_DWORD *)(a1 + 52) = 1;
    *(_DWORD *)(a1 + 88) = -1;
    *(_DWORD *)(a1 + 44) = 0;
  }
  if ( ++*(_DWORD *)(a1 + 44) % 4 == 1 )
  {
    Play_Sound_Effect(Sfx_Spinning_Projectile, 1);
    if ( ++*(_DWORD *)(a1 + 76) % 2 )
      Create_Bullet(Blade_Slash, *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 0);
    else
      Create_Bullet(Blade_Slash, *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), Right);
  }
  if ( ++*(_DWORD *)(a1 + 76) == 5 )
    *(_DWORD *)(a1 + 8) &= 0xFFFFFFFB;
  if ( *(_DWORD *)(a1 + 76) > *(_DWORD *)(a1 + 84) )
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
    return;
  }
LABEL_28:
  *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
  *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
  switch ( *(_BYTE *)(a1 + 56) )
  {
    case 0:
      v5 = &v30 + 4 * *(_DWORD *)(a1 + 52);
      v6 = a1 + 60;
      *(_DWORD *)v6 = *v5;
      *(_DWORD *)(v6 + 4) = v5[1];
      *(_DWORD *)(v6 + 8) = v5[2];
      *(_DWORD *)(v6 + 12) = v5[3];
      break;
    case 1:
      v7 = &v38 + 4 * *(_DWORD *)(a1 + 52);
      v8 = a1 + 60;
      *(_DWORD *)v8 = *v7;
      *(_DWORD *)(v8 + 4) = v7[1];
      *(_DWORD *)(v8 + 8) = v7[2];
      *(_DWORD *)(v8 + 12) = v7[3];
      break;
    case 2:
      v9 = &v22 + 4 * *(_DWORD *)(a1 + 52);
      v10 = a1 + 60;
      *(_DWORD *)v10 = *v9;
      *(_DWORD *)(v10 + 4) = v9[1];
      *(_DWORD *)(v10 + 8) = v9[2];
      *(_DWORD *)(v10 + 12) = v9[3];
      break;
    case 3:
      v11 = &v14 + 4 * *(_DWORD *)(a1 + 52);
      v12 = a1 + 60;
      *(_DWORD *)v12 = *v11;
      *(_DWORD *)(v12 + 4) = v11[1];
      *(_DWORD *)(v12 + 8) = v11[2];
      *(_DWORD *)(v12 + 12) = v11[3];
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 44) % 2 )
    *(_DWORD *)(a1 + 68) = 0;
}

//----- (004075E0) --------------------------------------------------------
int __cdecl Bullet_17_Blade_Slash(int a1)
{
  int *v1; // eax@18
  int v2; // ecx@18
  int result; // eax@18
  int *v4; // eax@19
  int v5; // ecx@19
  int v6; // [sp+0h] [bp-A4h]@1
  int v7; // [sp+4h] [bp-A0h]@17
  int v8; // [sp+8h] [bp-9Ch]@17
  int v9; // [sp+Ch] [bp-98h]@17
  int v10; // [sp+10h] [bp-94h]@17
  int v11; // [sp+14h] [bp-90h]@17
  int v12; // [sp+18h] [bp-8Ch]@17
  int v13; // [sp+1Ch] [bp-88h]@17
  int v14; // [sp+20h] [bp-84h]@17
  int v15; // [sp+24h] [bp-80h]@17
  int v16; // [sp+28h] [bp-7Ch]@17
  int v17; // [sp+2Ch] [bp-78h]@17
  int v18; // [sp+30h] [bp-74h]@17
  int v19; // [sp+34h] [bp-70h]@17
  int v20; // [sp+38h] [bp-6Ch]@17
  int v21; // [sp+3Ch] [bp-68h]@17
  int v22; // [sp+40h] [bp-64h]@17
  int v23; // [sp+44h] [bp-60h]@17
  int v24; // [sp+48h] [bp-5Ch]@17
  int v25; // [sp+4Ch] [bp-58h]@17
  int v26; // [sp+50h] [bp-54h]@17
  int v27; // [sp+54h] [bp-50h]@17
  int v28; // [sp+58h] [bp-4Ch]@17
  int v29; // [sp+5Ch] [bp-48h]@17
  int v30; // [sp+60h] [bp-44h]@17
  int v31; // [sp+64h] [bp-40h]@17
  int v32; // [sp+68h] [bp-3Ch]@17
  int v33; // [sp+6Ch] [bp-38h]@17
  int v34; // [sp+70h] [bp-34h]@17
  int v35; // [sp+74h] [bp-30h]@17
  int v36; // [sp+78h] [bp-2Ch]@17
  int v37; // [sp+7Ch] [bp-28h]@17
  int v38; // [sp+80h] [bp-24h]@17
  int v39; // [sp+84h] [bp-20h]@17
  int v40; // [sp+88h] [bp-1Ch]@17
  int v41; // [sp+8Ch] [bp-18h]@17
  int v42; // [sp+90h] [bp-14h]@17
  int v43; // [sp+94h] [bp-10h]@17
  int v44; // [sp+98h] [bp-Ch]@17
  int v45; // [sp+9Ch] [bp-8h]@17
  int v46; // [sp+A0h] [bp-4h]@17

  v6 = *(_DWORD *)(a1 + 40);
  if ( v6 )
  {
    if ( v6 != 1 )
      goto LABEL_17;
  }
  else
  {
    *(_DWORD *)(a1 + 40) = 1;
    *(_DWORD *)(a1 + 20) -= 6144;
    if ( *(_BYTE *)(a1 + 56) )
      *(_DWORD *)(a1 + 16) -= 0x2000;
    else
      *(_DWORD *)(a1 + 16) += 0x2000;
  }
  if ( ++*(_DWORD *)(a1 + 48) > 2 )
  {
    *(_DWORD *)(a1 + 48) = 0;
    ++*(_DWORD *)(a1 + 52);
  }
  if ( *(_BYTE *)(a1 + 56) )
    *(_DWORD *)(a1 + 16) += 1024;
  else
    *(_DWORD *)(a1 + 16) -= 1024;
  *(_DWORD *)(a1 + 20) += 1024;
  if ( *(_DWORD *)(a1 + 52) == 1 )
    *(_DWORD *)(a1 + 88) = 2;
  else
    *(_DWORD *)(a1 + 88) = 1;
  if ( *(_DWORD *)(a1 + 52) > 4 )
    *(_DWORD *)(a1 + 12) = 0;
LABEL_17:
  v27 = 0;
  v28 = 64;
  v29 = 24;
  v30 = 88;
  v31 = 24;
  v32 = 64;
  v33 = 48;
  v34 = 88;
  v35 = 48;
  v36 = 64;
  v37 = 72;
  v38 = 88;
  v39 = 72;
  v40 = 64;
  v41 = 96;
  v42 = 88;
  v43 = 96;
  v44 = 64;
  v45 = 120;
  v46 = 88;
  v7 = 0;
  v8 = 88;
  v9 = 24;
  v10 = 112;
  v11 = 24;
  v12 = 88;
  v13 = 48;
  v14 = 112;
  v15 = 48;
  v16 = 88;
  v17 = 72;
  v18 = 112;
  v19 = 72;
  v20 = 88;
  v21 = 96;
  v22 = 112;
  v23 = 96;
  v24 = 88;
  v25 = 120;
  v26 = 112;
  if ( *(_BYTE *)(a1 + 56) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 52);
    v5 = a1 + 60;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v27 + 4 * *(_DWORD *)(a1 + 52);
    v2 = a1 + 60;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (004078A0) --------------------------------------------------------
// Unused
int __cdecl Bullet_18__Unused_(int a1)
{
  int v1; // edx@3
  int result; // eax@3

  if ( ++*(_DWORD *)(a1 + 44) > 2 )
    *(_DWORD *)(a1 + 12) = 0;
  v1 = a1 + 60;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 0;
  result = 0;
  *(_DWORD *)(v1 + 8) = 0;
  *(_DWORD *)(v1 + 12) = 0;
  return result;
}

//----- (00407910) --------------------------------------------------------
void __cdecl Bullet_1C_1D_1E_Sup_Mis_Launcher(int a1, int a2)
{
  int *v2; // edx@89
  int v3; // eax@89
  int *v4; // edx@90
  int v5; // eax@90
  int *v6; // edx@91
  int v7; // eax@91
  unsigned int v8; // [sp+10h] [bp-98h]@47
  int v9; // [sp+1Ch] [bp-8Ch]@31
  int v10; // [sp+20h] [bp-88h]@85
  int v11; // [sp+24h] [bp-84h]@85
  int v12; // [sp+28h] [bp-80h]@85
  int v13; // [sp+2Ch] [bp-7Ch]@85
  int v14; // [sp+30h] [bp-78h]@85
  int v15; // [sp+34h] [bp-74h]@85
  int v16; // [sp+38h] [bp-70h]@85
  int v17; // [sp+3Ch] [bp-6Ch]@85
  int v18; // [sp+40h] [bp-68h]@85
  int v19; // [sp+44h] [bp-64h]@85
  int v20; // [sp+48h] [bp-60h]@85
  int v21; // [sp+4Ch] [bp-5Ch]@85
  int v22; // [sp+50h] [bp-58h]@85
  int v23; // [sp+54h] [bp-54h]@85
  int v24; // [sp+58h] [bp-50h]@85
  int v25; // [sp+5Ch] [bp-4Ch]@85
  int v26; // [sp+60h] [bp-48h]@85
  int v27; // [sp+64h] [bp-44h]@85
  int v28; // [sp+68h] [bp-40h]@85
  int v29; // [sp+6Ch] [bp-3Ch]@85
  int v30; // [sp+70h] [bp-38h]@85
  int v31; // [sp+74h] [bp-34h]@85
  int v32; // [sp+78h] [bp-30h]@85
  int v33; // [sp+7Ch] [bp-2Ch]@85
  int v34; // [sp+80h] [bp-28h]@85
  int v35; // [sp+84h] [bp-24h]@85
  int v36; // [sp+88h] [bp-20h]@85
  int v37; // [sp+8Ch] [bp-1Ch]@85
  int v38; // [sp+90h] [bp-18h]@85
  int v39; // [sp+94h] [bp-14h]@85
  int v40; // [sp+98h] [bp-10h]@85
  int v41; // [sp+9Ch] [bp-Ch]@85
  int v42; // [sp+A4h] [bp-4h]@3

  if ( ++*(_DWORD *)(a1 + 76) > *(_DWORD *)(a1 + 84) )
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
    return;
  }
  v42 = 0;
  if ( *(_DWORD *)(a1 + 92) != 10 )
    v42 = 1;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 1 )
    v42 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 4 )
    v42 = 1;
  if ( *(_BYTE *)(a1 + 56) == 1 && *(_DWORD *)a1 & 2 )
    v42 = 1;
  if ( *(_BYTE *)(a1 + 56) == 3 && *(_DWORD *)a1 & 8 )
    v42 = 1;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 0x80 )
    v42 = 1;
  if ( !*(_BYTE *)(a1 + 56) && *(_DWORD *)a1 & 0x20 )
    v42 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 0x40 )
    v42 = 1;
  if ( *(_BYTE *)(a1 + 56) == 2 && *(_DWORD *)a1 & 0x10 )
    v42 = 1;
  if ( v42 )
  {
    Create_Bullet((Bullet_enum)(a2 + 30), *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 0);
    *(_DWORD *)(a1 + 12) = 0;
  }
  v9 = *(_DWORD *)(a1 + 40);
  if ( !v9 )
  {
    *(_DWORD *)(a1 + 40) = 1;
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
      case 2:
        *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 20);
        *(_DWORD *)(a1 + 96) = 4096;
        *(_DWORD *)(a1 + 104) = 4096;
        break;
      case 1:
      case 3:
        *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 100) = 4096;
        *(_DWORD *)(a1 + 108) = 4096;
        break;
      default:
        break;
    }
    if ( a2 == 3 )
    {
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
        case 2:
          if ( *(_DWORD *)(a1 + 20) <= Quote.Y_Pos )
            *(_DWORD *)(a1 + 28) = -256;
          else
            *(_DWORD *)(a1 + 28) = 256;
          *(_DWORD *)(a1 + 24) = Random(-512, 512);
          break;
        case 1:
        case 3:
          if ( *(_DWORD *)(a1 + 16) <= Quote.X_Pos )
            *(_DWORD *)(a1 + 24) = -256;
          else
            *(_DWORD *)(a1 + 24) = 256;
          *(_DWORD *)(a1 + 28) = Random(-512, 512);
          break;
        default:
          break;
      }
      v8 = ++dword_49BCA0 % 3u;
      if ( dword_49BCA0 % 3u )
      {
        if ( v8 == 1 )
        {
          *(_DWORD *)(a1 + 52) = 256;
        }
        else if ( v8 == 2 )
        {
          *(_DWORD *)(a1 + 52) = 170;
        }
      }
      else
      {
        *(_DWORD *)(a1 + 52) = 512;
      }
    }
    else
    {
      *(_DWORD *)(a1 + 52) = 512;
    }
    goto LABEL_56;
  }
  if ( v9 == 1 )
  {
LABEL_56:
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        *(_DWORD *)(a1 + 24) -= *(_DWORD *)(a1 + 52);
        break;
      case 1:
        *(_DWORD *)(a1 + 28) -= *(_DWORD *)(a1 + 52);
        break;
      case 2:
        *(_DWORD *)(a1 + 24) += *(_DWORD *)(a1 + 52);
        break;
      case 3:
        *(_DWORD *)(a1 + 28) += *(_DWORD *)(a1 + 52);
        break;
      default:
        break;
    }
    if ( a2 == 3 )
    {
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
        case 2:
          if ( *(_DWORD *)(a1 + 20) >= *(_DWORD *)(a1 + 36) )
            *(_DWORD *)(a1 + 28) -= 64;
          else
            *(_DWORD *)(a1 + 28) += 64;
          break;
        case 1:
        case 3:
          if ( *(_DWORD *)(a1 + 16) >= *(_DWORD *)(a1 + 32) )
            *(_DWORD *)(a1 + 24) -= 64;
          else
            *(_DWORD *)(a1 + 24) += 64;
          break;
        default:
          break;
      }
    }
    if ( *(_DWORD *)(a1 + 24) < -5120 )
      *(_DWORD *)(a1 + 24) = -5120;
    if ( *(_DWORD *)(a1 + 24) > 5120 )
      *(_DWORD *)(a1 + 24) = 5120;
    if ( *(_DWORD *)(a1 + 28) < -5120 )
      *(_DWORD *)(a1 + 28) = -5120;
    if ( *(_DWORD *)(a1 + 28) > 5120 )
      *(_DWORD *)(a1 + 28) = 5120;
    *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
    *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
  }
  if ( ++*(_DWORD *)(a1 + 80) > 2 )
  {
    *(_DWORD *)(a1 + 80) = 0;
    switch ( *(_BYTE *)(a1 + 56) )
    {
      case 0:
        Create_Effect(*(_DWORD *)(a1 + 16) + 4096, *(_DWORD *)(a1 + 20), 7, 2);
        break;
      case 1:
        Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20) + 4096, 7, 3);
        break;
      case 2:
        Create_Effect(*(_DWORD *)(a1 + 16) - 4096, *(_DWORD *)(a1 + 20), 7, 0);
        break;
      case 3:
        Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20) - 4096, 7, 1);
        break;
      default:
        break;
    }
  }
  v26 = 120;
  v27 = 96;
  v28 = 136;
  v29 = 112;
  v30 = 136;
  v31 = 96;
  v32 = 152;
  v33 = 112;
  v34 = 152;
  v35 = 96;
  v36 = 168;
  v37 = 112;
  v38 = 168;
  v39 = 96;
  v40 = 184;
  v41 = 112;
  v10 = 184;
  v11 = 96;
  v12 = 200;
  v13 = 112;
  v14 = 200;
  v15 = 96;
  v16 = 216;
  v17 = 112;
  v18 = 216;
  v19 = 96;
  v20 = 232;
  v21 = 112;
  v22 = 232;
  v23 = 96;
  v24 = 248;
  v25 = 112;
  switch ( a2 )
  {
    case 1:
      v2 = &v26 + 4 * *(_BYTE *)(a1 + 56);
      v3 = a1 + 60;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      *(_DWORD *)(v3 + 12) = v2[3];
      break;
    case 2:
      v4 = &v10 + 4 * *(_BYTE *)(a1 + 56);
      v5 = a1 + 60;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      *(_DWORD *)(v5 + 12) = v4[3];
      break;
    case 3:
      v6 = &v26 + 4 * *(_BYTE *)(a1 + 56);
      v7 = a1 + 60;
      *(_DWORD *)v7 = *v6;
      *(_DWORD *)(v7 + 4) = v6[1];
      *(_DWORD *)(v7 + 8) = v6[2];
      *(_DWORD *)(v7 + 12) = v6[3];
      break;
  }
}
// 49BCA0: using guessed type int dword_49BCA0;

//----- (00408080) --------------------------------------------------------
int __cdecl Bullet_1F_20_21(int a1, int a2)
{
  int result; // eax@1
  signed int v3; // ST0C_4@17
  int v4; // ST08_4@17
  int v5; // eax@17
  signed int v6; // ST0C_4@20
  int v7; // ST08_4@20
  int v8; // eax@20
  signed int v9; // ST0C_4@23
  int v10; // ST08_4@23
  int v11; // eax@23
  int v12; // [sp+8h] [bp-4h]@1

  result = a1;
  v12 = *(_DWORD *)(a1 + 40);
  if ( v12 )
  {
    if ( v12 != 1 )
      return result;
  }
  else
  {
    *(_DWORD *)(a1 + 40) = 1;
    switch ( a2 )
    {
      case 1:
        *(_DWORD *)(a1 + 44) = 10;
        break;
      case 2:
        *(_DWORD *)(a1 + 44) = 14;
        break;
      case 3:
        *(_DWORD *)(a1 + 44) = 6;
        break;
    }
    Play_Sound_Effect(Sfx_Missile_Impact, 1);
  }
  if ( a2 == 1 )
  {
    if ( !(*(_DWORD *)(a1 + 44) % 3) )
    {
      v3 = *(_DWORD *)(a1 + 96);
      v4 = *(_DWORD *)(a1 + 20) + (Random(-16, 16) << 9);
      v5 = Random(-16, 16);
      Create_Dust_Clouds_Up(*(_DWORD *)(a1 + 16) + (v5 << 9), v4, v3, 2);
    }
  }
  else if ( a2 == 2 )
  {
    if ( !(*(_DWORD *)(a1 + 44) % 3) )
    {
      v6 = *(_DWORD *)(a1 + 96);
      v7 = *(_DWORD *)(a1 + 20) + (Random(-32, 32) << 9);
      v8 = Random(-32, 32);
      Create_Dust_Clouds_Up(*(_DWORD *)(a1 + 16) + (v8 << 9), v7, v6, 2);
    }
  }
  else if ( a2 == 3 && !(*(_DWORD *)(a1 + 44) % 3) )
  {
    v9 = *(_DWORD *)(a1 + 96);
    v10 = *(_DWORD *)(a1 + 20) + (Random(-40, 40) << 9);
    v11 = Random(-40, 40);
    Create_Dust_Clouds_Up(*(_DWORD *)(a1 + 16) + (v11 << 9), v10, v9, 2);
  }
  --*(_DWORD *)(a1 + 44);
  result = a1;
  if ( *(_DWORD *)(a1 + 44) < 0 )
    *(_DWORD *)(a1 + 12) = 0;
  return result;
}

//----- (00408230) --------------------------------------------------------
void __cdecl Bullet_22_23_24_2B_Nemesis(Bullet_vars *Bullet, int level)
{
  int Child_Y_Vel; // eax@15 MAPDST
  int Child_X_Vel; // eax@16 MAPDST
  RECT Rects_Down[2]; // [sp+10h] [bp-80h]@22
  RECT Rects_Left[2]; // [sp+30h] [bp-60h]@22
  RECT Rects_Up[2]; // [sp+50h] [bp-40h]@22
  RECT Rects_Right[2]; // [sp+70h] [bp-20h]@22

  if ( ++Bullet->count1 > Bullet->lifeTime )    // compare bullet distance to max distance.
  {
    Bullet->isAlive = 0;                        // bullet in use = 0 = kills
    Create_Effect(Bullet->XPos, Bullet->YPos, 3, 0);
  }
  else
  {
    if ( !Bullet->currentState )                // bullet was set up? 
    {
      // -----------------------------
      // -----===Create bullet===-----
      // -----------------------------
      Bullet->currentState = 1;                 // Bullet set up = true (doesn't actually create bullet)
      Bullet->count1 = 0;                       // Bullet distance = 0
      // ------=Set Velocities=------
      switch ( Bullet->direction )
      {
        case 0u:
          Bullet->XVel = -4096;
          break;
        case 1u:
          Bullet->YVel = -4096;
          break;
        case 2u:
          Bullet->XVel = 4096;
          break;
        case 3u:
          Bullet->YVel = 4096;
          break;
        default:
          break;
      }
      if ( level == 3 )
      {
        Bullet->XVel /= 3;
        Bullet->YVel /= 3;
      }
    }
    else
    {
      if ( level == 1 && Bullet->count1 % 4 == 1 )
      {
        switch ( Bullet->direction )
        {
          case Left:
            Child_Y_Vel = Random(-512, 512);
            NPC_Create(Smoke, Bullet->XPos, Bullet->YPos, -512, Child_Y_Vel, Right, NULL, 256);
            break;
          case Up:
            Child_X_Vel = Random(-512, 512);
            NPC_Create(Smoke, Bullet->XPos, Bullet->YPos, Child_X_Vel, -512, Right, NULL, 256);
            break;
          case Right:
            Child_Y_Vel = Random(-512, 512);
            NPC_Create(Smoke, Bullet->XPos, Bullet->YPos, 512, Child_Y_Vel, Right, NULL, 256);
            break;
          case Down:
            Child_X_Vel = Random(-512, 512);
            NPC_Create(Smoke, Bullet->XPos, Bullet->YPos, Child_X_Vel, 512, Right, NULL, 256);
            break;
          default:
            break;
        }
      }
      Bullet->XPos += Bullet->XVel;
      Bullet->YPos += Bullet->YVel;
    }
    if ( ++Bullet->animationNum > 1 )
      Bullet->animationNum = 0;
    Rects_Left[0].left = 0;                     // left yellow bullet
    Rects_Left[0].top = 0x70;
    Rects_Left[0].right = 0x20;
    Rects_Left[0].bottom = 0x80;
    Rects_Left[1].left = 0;                     // left blue bullet
    Rects_Left[1].top = 0x80;
    Rects_Left[1].right = 0x20;
    Rects_Left[1].bottom = 0x90;
    Rects_Up[0].left = 0x20;                    // up yellow bullet
    Rects_Up[0].top = 0x70;
    Rects_Up[0].right = 0x30;
    Rects_Up[0].bottom = 0x90;
    Rects_Up[1].left = 0x30;                    // up blue bullet
    Rects_Up[1].top = 0x70;
    Rects_Up[1].right = 0x40;
    Rects_Up[1].bottom = 0x90;
    Rects_Right[0].left = 0x40;                 // right yellow bullet
    Rects_Right[0].top = 0x70;
    Rects_Right[0].right = 0x60;
    Rects_Right[0].bottom = 0x80;
    Rects_Right[1].left = 0x40;                 // right Blue bullet
    Rects_Right[1].top = 0x80;
    Rects_Right[1].right = 0x60;
    Rects_Right[1].bottom = 0x90;
    Rects_Down[0].left = 0x60;                  // down yellow bullet
    Rects_Down[0].top = 0x70;
    Rects_Down[0].right = 0x70;
    Rects_Down[0].bottom = 0x90;
    Rects_Down[1].left = 0x70;                  // Down blue bullet
    Rects_Down[1].top = 0x70;
    Rects_Down[1].right = 0x80;
    Rects_Down[1].bottom = 0x90;
    switch ( Bullet->direction )
    {
      case Left:
        Bullet->displayRect = Rects_Left[Bullet->animationNum];
        break;
      case Up:
        Bullet->displayRect = Rects_Up[Bullet->animationNum];
        break;
      case Right:
        Bullet->displayRect = Rects_Right[Bullet->animationNum];
        break;
      case Down:
        Bullet->displayRect = Rects_Down[Bullet->animationNum];
        break;
      default:
        break;
    }
    // Relatives rects according to weapon level
    Bullet->displayRect.top += 32 * ((level - 1) / 2);
    Bullet->displayRect.bottom += 32 * ((level - 1) / 2);
    Bullet->displayRect.left += (level - 1) % 2 << 7;
    Bullet->displayRect.right += (level - 1) % 2 << 7;
  }
}

//----- (00408710) --------------------------------------------------------
void __cdecl Bullet_25_26_27_ChargelessSpur_AllLevels(int a1, int a2)
{
  int v2; // eax@34
  int v3; // eax@35
  int v4; // ecx@39
  int v5; // ecx@40
  int v6; // edx@44
  int v7; // edx@45

  if ( ++*(_DWORD *)(a1 + 76) <= *(_DWORD *)(a1 + 84) )
  {
    if ( *(_DWORD *)(a1 + 88) && *(_DWORD *)(a1 + 92) != 100 )
      *(_DWORD *)(a1 + 88) = 0;
    if ( *(_DWORD *)(a1 + 40) )
    {
      *(_DWORD *)(a1 + 16) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 20) += *(_DWORD *)(a1 + 28);
    }
    else
    {
      *(_DWORD *)(a1 + 40) = 1;
      switch ( *(_BYTE *)(a1 + 56) )
      {
        case 0:
          *(_DWORD *)(a1 + 24) = -4096;
          break;
        case 1:
          *(_DWORD *)(a1 + 28) = -4096;
          break;
        case 2:
          *(_DWORD *)(a1 + 24) = 4096;
          break;
        case 3:
          *(_DWORD *)(a1 + 28) = 4096;
          break;
        default:
          break;
      }
      if ( a2 == 1 )
      {
        switch ( *(_BYTE *)(a1 + 56) )
        {
          case 0:
            *(_DWORD *)(a1 + 100) = 1024;
            break;
          case 1:
            *(_DWORD *)(a1 + 96) = 1024;
            break;
          case 2:
            *(_DWORD *)(a1 + 100) = 1024;
            break;
          case 3:
            *(_DWORD *)(a1 + 96) = 1024;
            break;
          default:
            break;
        }
      }
      else if ( a2 == 2 )
      {
        switch ( *(_BYTE *)(a1 + 56) )
        {
          case 0:
            *(_DWORD *)(a1 + 100) = 2048;
            break;
          case 1:
            *(_DWORD *)(a1 + 96) = 2048;
            break;
          case 2:
            *(_DWORD *)(a1 + 100) = 2048;
            break;
          case 3:
            *(_DWORD *)(a1 + 96) = 2048;
            break;
          default:
            break;
        }
      }
    }
    *(_DWORD *)(a1 + 88) = *(_DWORD *)(a1 + 92);
    switch ( a2 )
    {
      case 1:
        if ( *(_BYTE *)(a1 + 56) != 1 && *(_BYTE *)(a1 + 56) != 3 )
        {
          v3 = a1 + 60;
          *(_DWORD *)v3 = 128;
          *(_DWORD *)(v3 + 4) = 32;
          *(_DWORD *)(v3 + 8) = 144;
          *(_DWORD *)(v3 + 12) = 48;
        }
        else
        {
          v2 = a1 + 60;
          *(_DWORD *)v2 = 144;
          *(_DWORD *)(v2 + 4) = 32;
          *(_DWORD *)(v2 + 8) = 160;
          *(_DWORD *)(v2 + 12) = 48;
        }
        break;
      case 2:
        if ( *(_BYTE *)(a1 + 56) != 1 && *(_BYTE *)(a1 + 56) != 3 )
        {
          v5 = a1 + 60;
          *(_DWORD *)v5 = 160;
          *(_DWORD *)(v5 + 4) = 32;
          *(_DWORD *)(v5 + 8) = 176;
          *(_DWORD *)(v5 + 12) = 48;
        }
        else
        {
          v4 = a1 + 60;
          *(_DWORD *)v4 = 176;
          *(_DWORD *)(v4 + 4) = 32;
          *(_DWORD *)(v4 + 8) = 192;
          *(_DWORD *)(v4 + 12) = 48;
        }
        break;
      case 3:
        if ( *(_BYTE *)(a1 + 56) != 1 && *(_BYTE *)(a1 + 56) != 3 )
        {
          v7 = a1 + 60;
          *(_DWORD *)v7 = 128;
          *(_DWORD *)(v7 + 4) = 48;
          *(_DWORD *)(v7 + 8) = 144;
          *(_DWORD *)(v7 + 12) = 64;
        }
        else
        {
          v6 = a1 + 60;
          *(_DWORD *)v6 = 144;
          *(_DWORD *)(v6 + 4) = 48;
          *(_DWORD *)(v6 + 8) = 160;
          *(_DWORD *)(v6 + 12) = 64;
        }
        break;
    }
    Create_Bullet((Bullet_enum)(a2 + 39), *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), (Directions)*(_BYTE *)(a1 + 56));
  }
  else
  {
    *(_DWORD *)(a1 + 12) = 0;
    Create_Effect(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20), 3, 0);
  }
}

//----- (00408AE0) --------------------------------------------------------
int __cdecl Bullet_28_to_2A_NonMovingSpur_AllLevels(int a1, int a2)
{
  int result; // eax@8
  int *v3; // ecx@14
  int v4; // edx@14
  int *v5; // ecx@15
  int v6; // edx@15
  int *v7; // edx@19
  int *v8; // edx@20
  int *v9; // eax@24
  int v10; // ecx@24
  int *v11; // eax@25
  int v12; // ecx@25
  int v13; // [sp+4h] [bp-120h]@8
  int v14; // [sp+8h] [bp-11Ch]@8
  int v15; // [sp+Ch] [bp-118h]@8
  int v16; // [sp+10h] [bp-114h]@8
  int v17; // [sp+14h] [bp-110h]@8
  int v18; // [sp+18h] [bp-10Ch]@8
  int v19; // [sp+1Ch] [bp-108h]@8
  int v20; // [sp+20h] [bp-104h]@8
  int v21; // [sp+24h] [bp-100h]@8
  int v22; // [sp+28h] [bp-FCh]@8
  int v23; // [sp+2Ch] [bp-F8h]@8
  int v24; // [sp+30h] [bp-F4h]@8
  int v25; // [sp+34h] [bp-F0h]@8
  int v26; // [sp+38h] [bp-ECh]@8
  int v27; // [sp+3Ch] [bp-E8h]@8
  int v28; // [sp+40h] [bp-E4h]@8
  int v29; // [sp+44h] [bp-E0h]@8
  int v30; // [sp+48h] [bp-DCh]@8
  int v31; // [sp+4Ch] [bp-D8h]@8
  int v32; // [sp+50h] [bp-D4h]@8
  int v33; // [sp+54h] [bp-D0h]@8
  int v34; // [sp+58h] [bp-CCh]@8
  int v35; // [sp+5Ch] [bp-C8h]@8
  int v36; // [sp+60h] [bp-C4h]@8
  int v37; // [sp+64h] [bp-C0h]@8
  int v38; // [sp+68h] [bp-BCh]@8
  int v39; // [sp+6Ch] [bp-B8h]@8
  int v40; // [sp+70h] [bp-B4h]@8
  int v41; // [sp+74h] [bp-B0h]@8
  int v42; // [sp+78h] [bp-ACh]@8
  int v43; // [sp+7Ch] [bp-A8h]@8
  int v44; // [sp+80h] [bp-A4h]@8
  int v45; // [sp+84h] [bp-A0h]@8
  int v46; // [sp+88h] [bp-9Ch]@8
  int v47; // [sp+8Ch] [bp-98h]@8
  int v48; // [sp+90h] [bp-94h]@8
  int v49; // [sp+94h] [bp-90h]@8
  int v50; // [sp+98h] [bp-8Ch]@8
  int v51; // [sp+9Ch] [bp-88h]@8
  int v52; // [sp+A0h] [bp-84h]@8
  int v53; // [sp+A4h] [bp-80h]@8
  int v54; // [sp+A8h] [bp-7Ch]@8
  int v55; // [sp+ACh] [bp-78h]@8
  int v56; // [sp+B0h] [bp-74h]@8
  int v57; // [sp+B4h] [bp-70h]@8
  int v58; // [sp+B8h] [bp-6Ch]@8
  int v59; // [sp+BCh] [bp-68h]@8
  int v60; // [sp+C0h] [bp-64h]@8
  int v61; // [sp+C4h] [bp-60h]@8
  int v62; // [sp+C8h] [bp-5Ch]@8
  int v63; // [sp+CCh] [bp-58h]@8
  int v64; // [sp+D0h] [bp-54h]@8
  int v65; // [sp+D4h] [bp-50h]@8
  int v66; // [sp+D8h] [bp-4Ch]@8
  int v67; // [sp+DCh] [bp-48h]@8
  int v68; // [sp+E0h] [bp-44h]@8
  int v69; // [sp+E4h] [bp-40h]@8
  int v70; // [sp+E8h] [bp-3Ch]@8
  int v71; // [sp+ECh] [bp-38h]@8
  int v72; // [sp+F0h] [bp-34h]@8
  int v73; // [sp+F4h] [bp-30h]@8
  int v74; // [sp+F8h] [bp-2Ch]@8
  int v75; // [sp+FCh] [bp-28h]@8
  int v76; // [sp+100h] [bp-24h]@8
  int v77; // [sp+104h] [bp-20h]@8
  int v78; // [sp+108h] [bp-1Ch]@8
  int v79; // [sp+10Ch] [bp-18h]@8
  int v80; // [sp+110h] [bp-14h]@8
  int v81; // [sp+114h] [bp-10h]@8
  int v82; // [sp+118h] [bp-Ch]@8
  int v83; // [sp+11Ch] [bp-8h]@8
  int v84; // [sp+120h] [bp-4h]@8

  if ( ++*(_DWORD *)(a1 + 76) > 20 )
    *(_DWORD *)(a1 + 52) = *(_DWORD *)(a1 + 76) - 20;
  if ( *(_DWORD *)(a1 + 52) > 2 )
    *(_DWORD *)(a1 + 12) = 0;
  if ( *(_DWORD *)(a1 + 88) && *(_DWORD *)(a1 + 92) != 100 )
    *(_DWORD *)(a1 + 88) = 0;
  v61 = 192;
  v62 = 32;
  v63 = 200;
  v64 = 40;
  v65 = 200;
  v66 = 32;
  v67 = 208;
  v68 = 40;
  v69 = 208;
  v70 = 32;
  v71 = 216;
  v72 = 40;
  v73 = 192;
  v74 = 40;
  v75 = 200;
  v76 = 48;
  v77 = 200;
  v78 = 40;
  v79 = 208;
  v80 = 48;
  v81 = 208;
  v82 = 40;
  v83 = 216;
  v84 = 48;
  v37 = 216;
  v38 = 32;
  v39 = 224;
  v40 = 40;
  v41 = 224;
  v42 = 32;
  v43 = 232;
  v44 = 40;
  v45 = 232;
  v46 = 32;
  v47 = 240;
  v48 = 40;
  v49 = 216;
  v50 = 40;
  v51 = 224;
  v52 = 48;
  v53 = 224;
  v54 = 40;
  v55 = 232;
  v56 = 48;
  v57 = 232;
  v58 = 40;
  v59 = 240;
  v60 = 48;
  v13 = 240;
  v14 = 32;
  v15 = 248;
  v16 = 40;
  v17 = 248;
  v18 = 32;
  v19 = 256;
  v20 = 40;
  v21 = 256;
  v22 = 32;
  v23 = 264;
  v24 = 40;
  v25 = 240;
  v26 = 32;
  v27 = 248;
  v28 = 40;
  v29 = 248;
  v30 = 32;
  v31 = 256;
  v32 = 40;
  v33 = 256;
  v34 = 32;
  v35 = 264;
  v36 = 40;
  result = a2;
  switch ( a2 )
  {
    case 1:
      if ( *(_BYTE *)(a1 + 56) && *(_BYTE *)(a1 + 56) != 2 )
      {
        v5 = &v73 + 4 * *(_DWORD *)(a1 + 52);
        v6 = a1 + 60;
        *(_DWORD *)v6 = *v5;
        *(_DWORD *)(v6 + 4) = v5[1];
        result = v5[2];
        *(_DWORD *)(v6 + 8) = result;
        *(_DWORD *)(v6 + 12) = v5[3];
      }
      else
      {
        v3 = &v61 + 4 * *(_DWORD *)(a1 + 52);
        v4 = a1 + 60;
        *(_DWORD *)v4 = *v3;
        *(_DWORD *)(v4 + 4) = v3[1];
        result = v3[2];
        *(_DWORD *)(v4 + 8) = result;
        *(_DWORD *)(v4 + 12) = v3[3];
      }
      break;
    case 2:
      if ( *(_BYTE *)(a1 + 56) && *(_BYTE *)(a1 + 56) != 2 )
      {
        v8 = &v49 + 4 * *(_DWORD *)(a1 + 52);
        result = a1 + 60;
        *(_DWORD *)result = *v8;
        *(_DWORD *)(result + 4) = v8[1];
        *(_DWORD *)(result + 8) = v8[2];
        *(_DWORD *)(result + 12) = v8[3];
      }
      else
      {
        v7 = &v37 + 4 * *(_DWORD *)(a1 + 52);
        result = a1 + 60;
        *(_DWORD *)result = *v7;
        *(_DWORD *)(result + 4) = v7[1];
        *(_DWORD *)(result + 8) = v7[2];
        *(_DWORD *)(result + 12) = v7[3];
      }
      break;
    case 3:
      if ( *(_BYTE *)(a1 + 56) && *(_BYTE *)(a1 + 56) != 2 )
      {
        v11 = &v25 + 4 * *(_DWORD *)(a1 + 52);
        v12 = a1 + 60;
        *(_DWORD *)v12 = *v11;
        *(_DWORD *)(v12 + 4) = v11[1];
        *(_DWORD *)(v12 + 8) = v11[2];
        result = v11[3];
        *(_DWORD *)(v12 + 12) = result;
      }
      else
      {
        v9 = &v13 + 4 * *(_DWORD *)(a1 + 52);
        v10 = a1 + 60;
        *(_DWORD *)v10 = *v9;
        *(_DWORD *)(v10 + 4) = v9[1];
        *(_DWORD *)(v10 + 8) = v9[2];
        result = v9[3];
        *(_DWORD *)(v10 + 12) = result;
      }
      break;
  }
  return result;
}

//----- (00408F40) --------------------------------------------------------
int __cdecl Bullet_2C_Spur_Lvl_2(int a1)
{
  int result; // eax@2

  if ( ++*(_DWORD *)(a1 + 76) <= *(_DWORD *)(a1 + 84) )
  {
    *(_DWORD *)(a1 + 88) = 10000;
    *(_DWORD *)(a1 + 96) = 819200;
    result = a1;
    *(_DWORD *)(a1 + 100) = 819200;
  }
  else
  {
    result = a1;
    *(_DWORD *)(a1 + 12) = 0;
  }
  return result;
}

//----- (00408F90) --------------------------------------------------------
int __cdecl Bullet_2D_Spur_Lvl_3(int a1)
{
  int result; // eax@1

  ++*(_DWORD *)(a1 + 76);
  result = a1;
  if ( *(_DWORD *)(a1 + 76) > *(_DWORD *)(a1 + 84) )
  {
    result = a1;
    *(_DWORD *)(a1 + 12) = 0;
  }
  return result;
}

//----- (00408FC0) --------------------------------------------------------
void __cdecl Run_Bullet_Code()
{
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < 64; ++i )
  {
    if ( Bullet_Objects[i].isAlive & 0x80 )
    {
      if ( Bullet_Objects[i].life < 1 )
      {
        Bullet_Objects[i].isAlive = 0;
      }
      else
      {
        switch ( Bullet_Objects[i].code_bullet )
        {
          case 1:
            Bullet_01_Lvl_1_Snake((int)&Bullet_Objects[i]);
            break;
          case 2:
            Bullet_02_03_Snake(&Bullet_Objects[i], 2);
            break;
          case 3:
            Bullet_02_03_Snake(&Bullet_Objects[i], 3);
            break;
          case 4:
            Bullet_04_05_06_Polar_Star(&Bullet_Objects[i], 1);
            break;
          case 5:
            Bullet_04_05_06_Polar_Star(&Bullet_Objects[i], 2);
            break;
          case 6:
            Bullet_04_05_06_Polar_Star(&Bullet_Objects[i], 3);
            break;
          case 7:
            Bullet_07_08_09_Fireball(&Bullet_Objects[i], 1);
            break;
          case 8:
            Bullet_07_08_09_Fireball(&Bullet_Objects[i], 2);
            break;
          case 9:
            Bullet_07_08_09_Fireball(&Bullet_Objects[i], 3);
            break;
          case 0xA:
            Bullet_0A_0B_0C_Machine_Gun(&Bullet_Objects[i], 1);
            break;
          case 0xB:
            Bullet_0A_0B_0C_Machine_Gun(&Bullet_Objects[i], 2);
            break;
          case 0xC:
            Bullet_0A_0B_0C_Machine_Gun(&Bullet_Objects[i], 3);
            break;
          case 0xD:
            Bullet_0D_0E_0F_Missile_Launcher((int)&Bullet_Objects[i], 1);
            break;
          case 0xE:
            Bullet_0D_0E_0F_Missile_Launcher((int)&Bullet_Objects[i], 2);
            break;
          case 0xF:
            Bullet_0D_0E_0F_Missile_Launcher((int)&Bullet_Objects[i], 3);
            break;
          case 0x10:
            Bullet_10_11_12_Missile_Explosion(&Bullet_Objects[i], 1);
            break;
          case 0x11:
            Bullet_10_11_12_Missile_Explosion(&Bullet_Objects[i], 2);
            break;
          case 0x12:
            Bullet_10_11_12_Missile_Explosion(&Bullet_Objects[i], 3);
            break;
          case 0x13:
            Bullet_13_Bubbler_Lvl1((int)&Bullet_Objects[i]);
            break;
          case 0x14:
            Bullet_14_Bubbler_Lvl2((int)&Bullet_Objects[i]);
            break;
          case 0x15:
            Bullet_15_Bubbler_Lvl3((int)&Bullet_Objects[i]);
            break;
          case 0x16:
            Bullet_16_Bubble_Spurs((int)&Bullet_Objects[i]);
            break;
          case 0x17:
            Bullet_17_Blade_Slash((int)&Bullet_Objects[i]);
            break;
          case 0x18:
            Bullet_18__Unused_((int)&Bullet_Objects[i]);
            break;
          case 0x19:
            Bullet_19_Blade_Lvl_1((int)&Bullet_Objects[i]);
            break;
          case 0x1A:
            Bullet_1A_Blade_Lvl_2((int)&Bullet_Objects[i]);
            break;
          case 0x1B:
            Bullet_1B_Blade_Lvl_3((int)&Bullet_Objects[i]);
            break;
          case 0x1C:
            Bullet_1C_1D_1E_Sup_Mis_Launcher((int)&Bullet_Objects[i], 1);
            break;
          case 0x1D:
            Bullet_1C_1D_1E_Sup_Mis_Launcher((int)&Bullet_Objects[i], 2);
            break;
          case 0x1E:
            Bullet_1C_1D_1E_Sup_Mis_Launcher((int)&Bullet_Objects[i], 3);
            break;
          case 0x1F:
            Bullet_1F_20_21((int)&Bullet_Objects[i], 1);
            break;
          case 0x20:
            Bullet_1F_20_21((int)&Bullet_Objects[i], 2);
            break;
          case 0x21:
            Bullet_1F_20_21((int)&Bullet_Objects[i], 3);
            break;
          case 0x22:
            Bullet_22_23_24_2B_Nemesis(&Bullet_Objects[i], 1);
            break;
          case 0x23:
            Bullet_22_23_24_2B_Nemesis(&Bullet_Objects[i], 2);
            break;
          case 0x24:
            Bullet_22_23_24_2B_Nemesis(&Bullet_Objects[i], 3);
            break;
          case 0x25:
            Bullet_25_26_27_ChargelessSpur_AllLevels((int)&Bullet_Objects[i], 1);
            break;
          case 0x26:
            Bullet_25_26_27_ChargelessSpur_AllLevels((int)&Bullet_Objects[i], 2);
            break;
          case 0x27:
            Bullet_25_26_27_ChargelessSpur_AllLevels((int)&Bullet_Objects[i], 3);
            break;
          case 0x28:
            Bullet_28_to_2A_NonMovingSpur_AllLevels((int)&Bullet_Objects[i], 1);
            break;
          case 0x29:
            Bullet_28_to_2A_NonMovingSpur_AllLevels((int)&Bullet_Objects[i], 2);
            break;
          case 0x2A:
            Bullet_28_to_2A_NonMovingSpur_AllLevels((int)&Bullet_Objects[i], 3);
            break;
          case 0x2B:
            Bullet_22_23_24_2B_Nemesis(&Bullet_Objects[i], 1);
            break;
          case 0x2C:
            Bullet_2C_Spur_Lvl_2((int)&Bullet_Objects[i]);
            break;
          case 0x2D:
            Bullet_2D_Spur_Lvl_3((int)&Bullet_Objects[i]);
            break;
          default:
            continue;
        }
      }
    }
  }
}

//----- (004095C0) --------------------------------------------------------
signed int Is_some_bullet_active()
{
  signed int result; // eax@6
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; ; ++i )
  {
    if ( i >= 64 )
      return 0;
    if ( Bullet_Objects[i].isAlive & 0x80 )
      break;
For_Loop_Restart:
    ;
  }
  switch ( Bullet_Objects[i].code_bullet )
  {
    case 0xD:
    case 0xE:
    case 0xF:
    case 0x10:
    case 0x11:
    case 0x12:
    case 0x17:
    case 0x19:
    case 0x1A:
    case 0x1B:
    case 0x1C:
    case 0x1D:
    case 0x1E:
    case 0x1F:
    case 0x20:
    case 0x21:
      result = 1;
      break;
    default:
      goto For_Loop_Restart;
  }
  return result;
}

//----- (00409650) --------------------------------------------------------
void __cdecl Init_Effects()
{
  memset(Effect_Objects, 0, 0x1100u);
}

//----- (00409680) --------------------------------------------------------
// mode 0: blue discs, mode 1: red discs
void __cdecl Effect_1_Random_Fountain_Pulsing_Disc_Particles(Effect_vars *Effect)
{
  RECT Red_Disk_Rects[4]; // [sp+0h] [bp-80h]@1
  RECT Blue_Disk_Rects[4]; // [sp+40h] [bp-40h]@1

  Blue_Disk_Rects[0].left = 0;
  Blue_Disk_Rects[0].top = 64;
  Blue_Disk_Rects[0].right = 8;
  Blue_Disk_Rects[0].bottom = 72;
  Blue_Disk_Rects[1].left = 8;
  Blue_Disk_Rects[1].top = 64;
  Blue_Disk_Rects[1].right = 16;
  Blue_Disk_Rects[1].bottom = 72;
  Blue_Disk_Rects[2].left = 16;
  Blue_Disk_Rects[2].top = 64;
  Blue_Disk_Rects[2].right = 24;
  Blue_Disk_Rects[2].bottom = 72;
  Blue_Disk_Rects[3].left = 24;
  Blue_Disk_Rects[3].top = 64;
  Blue_Disk_Rects[3].right = 32;
  Blue_Disk_Rects[3].bottom = 72;
  Red_Disk_Rects[0].left = 64;
  Red_Disk_Rects[0].top = 24;
  Red_Disk_Rects[0].right = 72;
  Red_Disk_Rects[0].bottom = 32;
  Red_Disk_Rects[1].left = 72;
  Red_Disk_Rects[1].top = 24;
  Red_Disk_Rects[1].right = 80;
  Red_Disk_Rects[1].bottom = 32;
  Red_Disk_Rects[2].left = 80;
  Red_Disk_Rects[2].top = 24;
  Red_Disk_Rects[2].right = 88;
  Red_Disk_Rects[2].bottom = 32;
  Red_Disk_Rects[3].left = 88;
  Red_Disk_Rects[3].top = 24;
  Red_Disk_Rects[3].right = 96;
  Red_Disk_Rects[3].bottom = 32;
  if ( !Effect->act_no )                        // If disk not init
  {
    Effect->act_no = 1;                         // Mark disk as initiated
    Effect->X_Vel = Random(-1024, 1024);
    Effect->Y_Vel = Random(-1024, 0);
  }
  Effect->Y_Vel += 64;
  Effect->X_Pos += Effect->X_Vel;
  Effect->Y_Pos += Effect->Y_Vel;
  if ( ++Effect->Ani_wait > 5 )
  {
    Effect->Ani_wait = 0;
    if ( ++Effect->Ani_Num > 3 )
      Effect->Is_Used = 0;
  }
  if ( !Effect->Direction )
    Effect->rect = Blue_Disk_Rects[Effect->Ani_Num];
  else
    Effect->rect = Red_Disk_Rects[Effect->Ani_Num];
}

//----- (00409880) --------------------------------------------------------
// mode 0: green disc, mode 1: diamond explosion
int __cdecl Effect_2_Rising_Disc_And_Exploding_Diamond(BOOL Effect_Vars)
{
  int result; // eax@1
  int *v2; // eax@9
  int v3; // ecx@9
  int *v4; // ecx@14
  int v5; // edx@14
  int *v6; // edx@15
  int v7; // eax@15
  int v8; // [sp+0h] [bp-B4h]@1
  int v9; // [sp+4h] [bp-B0h]@1
  int v10; // [sp+8h] [bp-ACh]@1
  int v11; // [sp+Ch] [bp-A8h]@1
  int v12; // [sp+10h] [bp-A4h]@1
  int v13; // [sp+14h] [bp-A0h]@1
  int v14; // [sp+18h] [bp-9Ch]@1
  int v15; // [sp+1Ch] [bp-98h]@1
  int v16; // [sp+20h] [bp-94h]@1
  int v17; // [sp+24h] [bp-90h]@1
  int v18; // [sp+28h] [bp-8Ch]@1
  int v19; // [sp+2Ch] [bp-88h]@1
  int v20; // [sp+30h] [bp-84h]@1
  int v21; // [sp+34h] [bp-80h]@1
  int v22; // [sp+38h] [bp-7Ch]@1
  int v23; // [sp+3Ch] [bp-78h]@1
  int v24; // [sp+40h] [bp-74h]@1
  int v25; // [sp+44h] [bp-70h]@1
  int v26; // [sp+48h] [bp-6Ch]@1
  int v27; // [sp+4Ch] [bp-68h]@1
  int v28; // [sp+50h] [bp-64h]@1
  int v29; // [sp+54h] [bp-60h]@1
  int v30; // [sp+58h] [bp-5Ch]@1
  int v31; // [sp+5Ch] [bp-58h]@1
  int v32; // [sp+60h] [bp-54h]@1
  int v33; // [sp+64h] [bp-50h]@1
  int v34; // [sp+68h] [bp-4Ch]@1
  int v35; // [sp+6Ch] [bp-48h]@1
  int v36; // [sp+70h] [bp-44h]@1
  int v37; // [sp+74h] [bp-40h]@1
  int v38; // [sp+78h] [bp-3Ch]@1
  int v39; // [sp+7Ch] [bp-38h]@1
  int v40; // [sp+80h] [bp-34h]@1
  int v41; // [sp+84h] [bp-30h]@1
  int v42; // [sp+88h] [bp-2Ch]@1
  int v43; // [sp+8Ch] [bp-28h]@1
  int v44; // [sp+90h] [bp-24h]@1
  int v45; // [sp+94h] [bp-20h]@1
  int v46; // [sp+98h] [bp-1Ch]@1
  int v47; // [sp+9Ch] [bp-18h]@1
  int v48; // [sp+A0h] [bp-14h]@1
  int v49; // [sp+A4h] [bp-10h]@1
  int v50; // [sp+A8h] [bp-Ch]@1
  int v51; // [sp+ACh] [bp-8h]@1
  int v52; // [sp+B0h] [bp-4h]@1

  v37 = 0;
  v38 = 32;
  v39 = 16;
  v40 = 48;
  v41 = 16;
  v42 = 32;
  v43 = 32;
  v44 = 48;
  v45 = 32;
  v46 = 32;
  v47 = 48;
  v48 = 48;
  v49 = 48;
  v50 = 32;
  v51 = 64;
  v52 = 48;
  v21 = 176;
  v22 = 0;
  v23 = 192;
  v24 = 16;
  v25 = 192;
  v26 = 0;
  v27 = 208;
  v28 = 16;
  v29 = 208;
  v30 = 0;
  v31 = 224;
  v32 = 16;
  v33 = 224;
  v34 = 0;
  v35 = 240;
  v36 = 16;
  v9 = 0;
  v10 = 32;
  v11 = 16;
  v12 = 48;
  v13 = 32;
  v14 = 32;
  v15 = 48;
  v16 = 48;
  v17 = 16;
  v18 = 32;
  v19 = 32;
  v20 = 48;
  result = Effect_Vars;
  v8 = *(_DWORD *)(Effect_Vars + 8);
  if ( v8 )
  {
    if ( v8 == 1 )
    {
      v6 = &v9 + 4 * (++*(_DWORD *)(Effect_Vars + 40) / 2 % 3);
      v7 = Effect_Vars + 52;
      *(_DWORD *)v7 = *v6;
      *(_DWORD *)(v7 + 4) = v6[1];
      *(_DWORD *)(v7 + 8) = v6[2];
      *(_DWORD *)(v7 + 12) = v6[3];
      result = Effect_Vars;
      if ( *(_DWORD *)(Effect_Vars + 40) > 24 )
        *(_DWORD *)Effect_Vars = 0;
    }
    else if ( v8 == 2 )
    {
      if ( ++*(_DWORD *)(Effect_Vars + 40) > 2 )
      {
        *(_DWORD *)(Effect_Vars + 40) = 0;
        ++*(_DWORD *)(Effect_Vars + 36);
      }
      if ( *(_DWORD *)(Effect_Vars + 36) > 3 )
        *(_DWORD *)Effect_Vars = 0;
      v4 = &v21 + 4 * *(_DWORD *)(Effect_Vars + 36);
      v5 = Effect_Vars + 52;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      result = v4[2];
      *(_DWORD *)(v5 + 8) = result;
      *(_DWORD *)(v5 + 12) = v4[3];
    }
  }
  else
  {
    *(_DWORD *)(Effect_Vars + 24) -= 16;
    *(_DWORD *)(Effect_Vars + 16) += *(_DWORD *)(Effect_Vars + 24);
    if ( ++*(_DWORD *)(Effect_Vars + 40) > 5 )
    {
      *(_DWORD *)(Effect_Vars + 40) = 0;
      ++*(_DWORD *)(Effect_Vars + 36);
    }
    if ( *(_DWORD *)(Effect_Vars + 36) > 3 )
      *(_DWORD *)Effect_Vars = 0;
    v2 = &v37 + 4 * *(_DWORD *)(Effect_Vars + 36);
    v3 = Effect_Vars + 52;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
  }
  return result;
}

//----- (00409B80) --------------------------------------------------------
// Mode 0 only
int __cdecl Effect_3_Star(BOOL Effect_Vars)
{
  int *v1; // eax@4
  int v2; // ecx@4
  int result; // eax@4
  int v4; // [sp+0h] [bp-40h]@1
  int v5; // [sp+4h] [bp-3Ch]@1
  int v6; // [sp+8h] [bp-38h]@1
  int v7; // [sp+Ch] [bp-34h]@1
  int v8; // [sp+10h] [bp-30h]@1
  int v9; // [sp+14h] [bp-2Ch]@1
  int v10; // [sp+18h] [bp-28h]@1
  int v11; // [sp+1Ch] [bp-24h]@1
  int v12; // [sp+20h] [bp-20h]@1
  int v13; // [sp+24h] [bp-1Ch]@1
  int v14; // [sp+28h] [bp-18h]@1
  int v15; // [sp+2Ch] [bp-14h]@1
  int v16; // [sp+30h] [bp-10h]@1
  int v17; // [sp+34h] [bp-Ch]@1
  int v18; // [sp+38h] [bp-8h]@1
  int v19; // [sp+3Ch] [bp-4h]@1

  v4 = 0;
  v5 = 48;
  v6 = 16;
  v7 = 64;
  v8 = 16;
  v9 = 48;
  v10 = 32;
  v11 = 64;
  v12 = 32;
  v13 = 48;
  v14 = 48;
  v15 = 64;
  v16 = 48;
  v17 = 48;
  v18 = 64;
  v19 = 64;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 2 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 3 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00409C70) --------------------------------------------------------
// mode 0 only
int __cdecl Effect_4_Fireball_Impact(BOOL Effect_Vars)
{
  int *v1; // ecx@4
  int v2; // edx@4
  int result; // eax@4
  int v4; // [sp+0h] [bp-90h]@1
  int v5; // [sp+4h] [bp-8Ch]@1
  int v6; // [sp+8h] [bp-88h]@1
  int v7; // [sp+Ch] [bp-84h]@1
  int v8; // [sp+10h] [bp-80h]@1
  int v9; // [sp+14h] [bp-7Ch]@1
  int v10; // [sp+18h] [bp-78h]@1
  int v11; // [sp+1Ch] [bp-74h]@1
  int v12; // [sp+20h] [bp-70h]@1
  int v13; // [sp+24h] [bp-6Ch]@1
  int v14; // [sp+28h] [bp-68h]@1
  int v15; // [sp+2Ch] [bp-64h]@1
  int v16; // [sp+30h] [bp-60h]@1
  int v17; // [sp+34h] [bp-5Ch]@1
  int v18; // [sp+38h] [bp-58h]@1
  int v19; // [sp+3Ch] [bp-54h]@1
  int v20; // [sp+40h] [bp-50h]@1
  int v21; // [sp+44h] [bp-4Ch]@1
  int v22; // [sp+48h] [bp-48h]@1
  int v23; // [sp+4Ch] [bp-44h]@1
  int v24; // [sp+50h] [bp-40h]@1
  int v25; // [sp+54h] [bp-3Ch]@1
  int v26; // [sp+58h] [bp-38h]@1
  int v27; // [sp+5Ch] [bp-34h]@1
  int v28; // [sp+60h] [bp-30h]@1
  int v29; // [sp+64h] [bp-2Ch]@1
  int v30; // [sp+68h] [bp-28h]@1
  int v31; // [sp+6Ch] [bp-24h]@1
  int v32; // [sp+70h] [bp-20h]@1
  int v33; // [sp+74h] [bp-1Ch]@1
  int v34; // [sp+78h] [bp-18h]@1
  int v35; // [sp+7Ch] [bp-14h]@1
  int v36; // [sp+80h] [bp-10h]@1
  int v37; // [sp+84h] [bp-Ch]@1
  int v38; // [sp+88h] [bp-8h]@1
  int v39; // [sp+8Ch] [bp-4h]@1

  v4 = 64;
  v5 = 32;
  v6 = 80;
  v7 = 48;
  v8 = 80;
  v9 = 32;
  v10 = 96;
  v11 = 48;
  v12 = 96;
  v13 = 32;
  v14 = 112;
  v15 = 48;
  v16 = 64;
  v17 = 48;
  v18 = 80;
  v19 = 64;
  v20 = 80;
  v21 = 48;
  v22 = 96;
  v23 = 64;
  v24 = 96;
  v25 = 48;
  v26 = 112;
  v27 = 64;
  v28 = 64;
  v29 = 64;
  v30 = 80;
  v31 = 80;
  v32 = 80;
  v33 = 64;
  v34 = 96;
  v35 = 80;
  v36 = 96;
  v37 = 64;
  v38 = 112;
  v39 = 80;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 1 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 2 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * (*(_DWORD *)(Effect_Vars + 36) + 3 * *(_DWORD *)(Effect_Vars + 8));
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00409E00) --------------------------------------------------------
// mode 0 only
int __cdecl Effect_5_ZzZ___(BOOL Effect_Vars)
{
  int *v1; // eax@5
  int v2; // ecx@5
  int result; // eax@5
  int v4; // [sp+0h] [bp-70h]@1
  int v5; // [sp+4h] [bp-6Ch]@1
  int v6; // [sp+8h] [bp-68h]@1
  int v7; // [sp+Ch] [bp-64h]@1
  int v8; // [sp+10h] [bp-60h]@1
  int v9; // [sp+14h] [bp-5Ch]@1
  int v10; // [sp+18h] [bp-58h]@1
  int v11; // [sp+1Ch] [bp-54h]@1
  int v12; // [sp+20h] [bp-50h]@1
  int v13; // [sp+24h] [bp-4Ch]@1
  int v14; // [sp+28h] [bp-48h]@1
  int v15; // [sp+2Ch] [bp-44h]@1
  int v16; // [sp+30h] [bp-40h]@1
  int v17; // [sp+34h] [bp-3Ch]@1
  int v18; // [sp+38h] [bp-38h]@1
  int v19; // [sp+3Ch] [bp-34h]@1
  int v20; // [sp+40h] [bp-30h]@1
  int v21; // [sp+44h] [bp-2Ch]@1
  int v22; // [sp+48h] [bp-28h]@1
  int v23; // [sp+4Ch] [bp-24h]@1
  int v24; // [sp+50h] [bp-20h]@1
  int v25; // [sp+54h] [bp-1Ch]@1
  int v26; // [sp+58h] [bp-18h]@1
  int v27; // [sp+5Ch] [bp-14h]@1
  int v28; // [sp+60h] [bp-10h]@1
  int v29; // [sp+64h] [bp-Ch]@1
  int v30; // [sp+68h] [bp-8h]@1
  int v31; // [sp+6Ch] [bp-4h]@1

  v4 = 32;
  v5 = 64;
  v6 = 40;
  v7 = 72;
  v8 = 32;
  v9 = 72;
  v10 = 40;
  v11 = 80;
  v12 = 40;
  v13 = 64;
  v14 = 48;
  v15 = 72;
  v16 = 40;
  v17 = 72;
  v18 = 48;
  v19 = 80;
  v20 = 40;
  v21 = 64;
  v22 = 48;
  v23 = 72;
  v24 = 40;
  v25 = 72;
  v26 = 48;
  v27 = 80;
  v28 = 40;
  v29 = 64;
  v30 = 48;
  v31 = 72;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 4 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    ++*(_DWORD *)(Effect_Vars + 36);
  }
  if ( *(_DWORD *)(Effect_Vars + 36) > 6 )
    *(_DWORD *)Effect_Vars = 0;
  *(_DWORD *)(Effect_Vars + 12) += 128;
  *(_DWORD *)(Effect_Vars + 16) -= 128;
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00409F60) --------------------------------------------------------
// mode 0 only
int __cdecl Effect_6_Booster_Smoke(BOOL Effect_Vars)
{
  int *v1; // eax@4
  int v2; // ecx@4
  int result; // eax@4
  int v4; // [sp+4h] [bp-70h]@1
  int v5; // [sp+8h] [bp-6Ch]@1
  int v6; // [sp+Ch] [bp-68h]@1
  int v7; // [sp+10h] [bp-64h]@1
  int v8; // [sp+14h] [bp-60h]@1
  int v9; // [sp+18h] [bp-5Ch]@1
  int v10; // [sp+1Ch] [bp-58h]@1
  int v11; // [sp+20h] [bp-54h]@1
  int v12; // [sp+24h] [bp-50h]@1
  int v13; // [sp+28h] [bp-4Ch]@1
  int v14; // [sp+2Ch] [bp-48h]@1
  int v15; // [sp+30h] [bp-44h]@1
  int v16; // [sp+34h] [bp-40h]@1
  int v17; // [sp+38h] [bp-3Ch]@1
  int v18; // [sp+3Ch] [bp-38h]@1
  int v19; // [sp+40h] [bp-34h]@1
  int v20; // [sp+44h] [bp-30h]@1
  int v21; // [sp+48h] [bp-2Ch]@1
  int v22; // [sp+4Ch] [bp-28h]@1
  int v23; // [sp+50h] [bp-24h]@1
  int v24; // [sp+54h] [bp-20h]@1
  int v25; // [sp+58h] [bp-1Ch]@1
  int v26; // [sp+5Ch] [bp-18h]@1
  int v27; // [sp+60h] [bp-14h]@1
  int v28; // [sp+64h] [bp-10h]@1
  int v29; // [sp+68h] [bp-Ch]@1
  int v30; // [sp+6Ch] [bp-8h]@1
  int v31; // [sp+70h] [bp-4h]@1

  v4 = 56;
  v5 = 0;
  v6 = 64;
  v7 = 8;
  v8 = 64;
  v9 = 0;
  v10 = 72;
  v11 = 8;
  v12 = 72;
  v13 = 0;
  v14 = 80;
  v15 = 8;
  v16 = 80;
  v17 = 0;
  v18 = 88;
  v19 = 8;
  v20 = 88;
  v21 = 0;
  v22 = 96;
  v23 = 8;
  v24 = 96;
  v25 = 0;
  v26 = 104;
  v27 = 8;
  v28 = 104;
  v29 = 0;
  v30 = 112;
  v31 = 8;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 1 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 6 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  result = *(_DWORD *)(Effect_Vars + 8);
  switch ( result )
  {
    case 0:
      result = Effect_Vars;
      *(_DWORD *)(Effect_Vars + 12) -= 1024;
      break;
    case 1:
      result = Effect_Vars;
      *(_DWORD *)(Effect_Vars + 16) -= 1024;
      break;
    case 2:
      result = Effect_Vars;
      *(_DWORD *)(Effect_Vars + 12) += 1024;
      break;
    case 3:
      result = Effect_Vars;
      *(_DWORD *)(Effect_Vars + 16) += 1024;
      break;
    default:
      return result;
  }
  return result;
}

//----- (0040A120) --------------------------------------------------------
// mode 0: face left, mode 1: face right
signed int __cdecl Effect_7_Drowned_Quote(BOOL Effect_Vars)
{
  int v1; // ecx@2
  signed int result; // eax@2
  int v3; // ecx@3

  if ( *(_DWORD *)(Effect_Vars + 8) )
  {
    v3 = Effect_Vars + 52;
    *(_DWORD *)v3 = 32;
    *(_DWORD *)(v3 + 4) = 80;
    *(_DWORD *)(v3 + 8) = 48;
    result = 96;
    *(_DWORD *)(v3 + 12) = 96;
  }
  else
  {
    v1 = Effect_Vars + 52;
    *(_DWORD *)v1 = 16;
    *(_DWORD *)(v1 + 4) = 80;
    *(_DWORD *)(v1 + 8) = 32;
    result = 96;
    *(_DWORD *)(v1 + 12) = 96;
  }
  return result;
}

//----- (0040A1B0) --------------------------------------------------------
// mode 0: question mark, mode 1: exclamation mark
signed int __cdecl Effect_8_Exclamation_Mark(BOOL Effect_Vars)
{
  int v1; // ecx@6
  signed int result; // eax@6
  int v3; // ecx@7

  if ( ++*(_DWORD *)(Effect_Vars + 40) < 5 )
    *(_DWORD *)(Effect_Vars + 16) -= 2048;
  if ( *(_DWORD *)(Effect_Vars + 40) == 32 )
    *(_DWORD *)Effect_Vars = 0;
  if ( *(_DWORD *)(Effect_Vars + 8) )
  {
    v3 = Effect_Vars + 52;
    *(_DWORD *)v3 = 48;
    *(_DWORD *)(v3 + 4) = 64;
    *(_DWORD *)(v3 + 8) = 64;
    result = 80;
    *(_DWORD *)(v3 + 12) = 80;
  }
  else
  {
    v1 = Effect_Vars + 52;
    *(_DWORD *)v1 = 0;
    *(_DWORD *)(v1 + 4) = 80;
    *(_DWORD *)(v1 + 8) = 16;
    result = 96;
    *(_DWORD *)(v1 + 12) = 96;
  }
  return result;
}

//----- (0040A280) --------------------------------------------------------
// mode 0: level up, mode 1: level down
signed int __cdecl Effect_9_Level_Up_Or_Down(BOOL Effect_Vars)
{
  int *v1; // eax@12
  int v2; // ecx@12
  signed int result; // eax@12
  int *v4; // edx@13
  int v5; // [sp+0h] [bp-40h]@1
  int v6; // [sp+4h] [bp-3Ch]@1
  int v7; // [sp+8h] [bp-38h]@1
  int v8; // [sp+Ch] [bp-34h]@1
  int v9; // [sp+10h] [bp-30h]@1
  int v10; // [sp+14h] [bp-2Ch]@1
  int v11; // [sp+18h] [bp-28h]@1
  int v12; // [sp+1Ch] [bp-24h]@1
  int v13; // [sp+20h] [bp-20h]@1
  int v14; // [sp+24h] [bp-1Ch]@1
  int v15; // [sp+28h] [bp-18h]@1
  int v16; // [sp+2Ch] [bp-14h]@1
  int v17; // [sp+30h] [bp-10h]@1
  int v18; // [sp+34h] [bp-Ch]@1
  int v19; // [sp+38h] [bp-8h]@1
  int v20; // [sp+3Ch] [bp-4h]@1

  v13 = 0;
  v14 = 0;
  v15 = 56;
  v16 = 16;
  v17 = 0;
  v18 = 16;
  v19 = 56;
  v20 = 32;
  v5 = 0;
  v6 = 96;
  v7 = 56;
  v8 = 112;
  v9 = 0;
  v10 = 112;
  v11 = 56;
  v12 = 128;
  ++*(_DWORD *)(Effect_Vars + 40);
  if ( *(_DWORD *)(Effect_Vars + 8) )
  {
    if ( *(_DWORD *)(Effect_Vars + 40) < 20 )
      *(_DWORD *)(Effect_Vars + 16) -= 512;
    if ( *(_DWORD *)(Effect_Vars + 40) == 80 )
      *(_DWORD *)Effect_Vars = 0;
  }
  else
  {
    if ( *(_DWORD *)(Effect_Vars + 40) < 20 )
      *(_DWORD *)(Effect_Vars + 16) -= 1024;
    if ( *(_DWORD *)(Effect_Vars + 40) == 80 )
      *(_DWORD *)Effect_Vars = 0;
  }
  if ( *(_DWORD *)(Effect_Vars + 8) )
  {
    v4 = &v5 + 4 * (*(_DWORD *)(Effect_Vars + 40) / 2 % 2);
    result = Effect_Vars + 52;
    *(_DWORD *)result = *v4;
    *(_DWORD *)(result + 4) = v4[1];
    *(_DWORD *)(result + 8) = v4[2];
    *(_DWORD *)(result + 12) = v4[3];
  }
  else
  {
    v1 = &v13 + 4 * (*(_DWORD *)(Effect_Vars + 40) / 2 % 2);
    v2 = Effect_Vars + 52;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (0040A3F0) --------------------------------------------------------
// mode 0 only
signed int __cdecl Effect_10_Red_Damage_Rings(BOOL Effect_Vars)
{
  int *v1; // ecx@6
  int v2; // edx@6
  signed int result; // eax@6
  int v4; // [sp+0h] [bp-78h]@3
  int v5; // [sp+4h] [bp-74h]@3
  int v6; // [sp+8h] [bp-70h]@3
  int v7; // [sp+Ch] [bp-6Ch]@3
  int v8; // [sp+10h] [bp-68h]@3
  int v9; // [sp+14h] [bp-64h]@3
  int v10; // [sp+18h] [bp-60h]@3
  int v11; // [sp+1Ch] [bp-5Ch]@3
  int v12; // [sp+20h] [bp-58h]@3
  int v13; // [sp+24h] [bp-54h]@3
  int v14; // [sp+28h] [bp-50h]@3
  int v15; // [sp+2Ch] [bp-4Ch]@3
  int v16; // [sp+30h] [bp-48h]@3
  int v17; // [sp+34h] [bp-44h]@3
  int v18; // [sp+38h] [bp-40h]@3
  int v19; // [sp+3Ch] [bp-3Ch]@3
  int v20; // [sp+40h] [bp-38h]@3
  int v21; // [sp+44h] [bp-34h]@3
  int v22; // [sp+48h] [bp-30h]@3
  int v23; // [sp+4Ch] [bp-2Ch]@3
  int v24; // [sp+50h] [bp-28h]@3
  int v25; // [sp+54h] [bp-24h]@3
  int v26; // [sp+58h] [bp-20h]@3
  int v27; // [sp+5Ch] [bp-1Ch]@3
  int v28; // [sp+60h] [bp-18h]@3
  int v29; // [sp+64h] [bp-14h]@3
  int v30; // [sp+68h] [bp-10h]@3
  int v31; // [sp+6Ch] [bp-Ch]@3
  unsigned __int8 v32; // [sp+77h] [bp-1h]@2

  if ( !*(_DWORD *)(Effect_Vars + 28) )
  {
    *(_DWORD *)(Effect_Vars + 28) = 1;
    v32 = Random(0, 255);
    *(_DWORD *)(Effect_Vars + 20) = 2 * GetCos(v32);
    *(_DWORD *)(Effect_Vars + 24) = 2 * GetSin(v32);
  }
  *(_DWORD *)(Effect_Vars + 12) += *(_DWORD *)(Effect_Vars + 20);
  *(_DWORD *)(Effect_Vars + 16) += *(_DWORD *)(Effect_Vars + 24);
  v4 = 56;
  v5 = 8;
  v6 = 64;
  v7 = 16;
  v8 = 64;
  v9 = 8;
  v10 = 72;
  v11 = 16;
  v12 = 72;
  v13 = 8;
  v14 = 80;
  v15 = 16;
  v16 = 80;
  v17 = 8;
  v18 = 88;
  v19 = 16;
  v20 = 88;
  v21 = 8;
  v22 = 96;
  v23 = 16;
  v24 = 96;
  v25 = 8;
  v26 = 104;
  v27 = 16;
  v28 = 104;
  v29 = 8;
  v30 = 112;
  v31 = 16;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 2 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 6 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0040A5A0) --------------------------------------------------------
// mode 0 only
signed int __cdecl Effect_11_Big_Explosion(BOOL Effect_Vars)
{
  int *v1; // eax@4
  int v2; // ecx@4
  signed int result; // eax@4
  int v4; // [sp+0h] [bp-20h]@1
  int v5; // [sp+4h] [bp-1Ch]@1
  int v6; // [sp+8h] [bp-18h]@1
  int v7; // [sp+Ch] [bp-14h]@1
  int v8; // [sp+10h] [bp-10h]@1
  int v9; // [sp+14h] [bp-Ch]@1
  int v10; // [sp+18h] [bp-8h]@1
  int v11; // [sp+1Ch] [bp-4h]@1

  v4 = 112;
  v5 = 0;
  v6 = 144;
  v7 = 32;
  v8 = 144;
  v9 = 0;
  v10 = 176;
  v11 = 32;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 2 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 1 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0040A650) --------------------------------------------------------
// mode 0 only
signed int __cdecl Effect_12_Headbump_Sparks(BOOL Effect_Vars)
{
  int *v1; // edx@11
  int v2; // eax@11
  signed int result; // eax@11
  int v4; // [sp+4h] [bp-24h]@2
  int v5; // [sp+8h] [bp-20h]@1
  int v6; // [sp+Ch] [bp-1Ch]@1
  int v7; // [sp+10h] [bp-18h]@1
  int v8; // [sp+14h] [bp-14h]@1
  int v9; // [sp+18h] [bp-10h]@1
  int v10; // [sp+1Ch] [bp-Ch]@1
  int v11; // [sp+20h] [bp-8h]@1
  int v12; // [sp+24h] [bp-4h]@1

  v5 = 56;
  v6 = 24;
  v7 = 64;
  v8 = 32;
  v9 = 0;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  if ( !*(_DWORD *)(Effect_Vars + 28) )
  {
    *(_DWORD *)(Effect_Vars + 28) = 1;
    v4 = *(_DWORD *)(Effect_Vars + 8);
    if ( v4 )
    {
      if ( v4 == 1 )
        *(_DWORD *)(Effect_Vars + 24) = -512 * Random(1, 3);
    }
    else
    {
      *(_DWORD *)(Effect_Vars + 20) = Random(-1536, 1536);
      *(_DWORD *)(Effect_Vars + 24) = Random(-512, 512);
    }
  }
  if ( !*(_DWORD *)(Effect_Vars + 8) )
  {
    *(_DWORD *)(Effect_Vars + 20) = 4 * *(_DWORD *)(Effect_Vars + 20) / 5;
    *(_DWORD *)(Effect_Vars + 24) = 4 * *(_DWORD *)(Effect_Vars + 24) / 5;
  }
  *(_DWORD *)(Effect_Vars + 12) += *(_DWORD *)(Effect_Vars + 20);
  *(_DWORD *)(Effect_Vars + 16) += *(_DWORD *)(Effect_Vars + 24);
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 20 )
    *(_DWORD *)Effect_Vars = 0;
  v1 = &v5 + 4 * (*(_DWORD *)(Effect_Vars + 40) / 2 % 2);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  result = Effect_Vars;
  if ( *(_DWORD *)(Effect_Vars + 8) == 5 )
  {
    result = Effect_Vars;
    *(_DWORD *)(Effect_Vars + 12) -= 2048;
  }
  return result;
}

//----- (0040A7E0) --------------------------------------------------------
// Unused
int __cdecl Effect_13_Unknown_Unused(int Effect_Vars)
{
  int *v1; // eax@4
  int v2; // ecx@4
  int result; // eax@4
  int v4; // [sp+0h] [bp-50h]@1
  int v5; // [sp+4h] [bp-4Ch]@1
  int v6; // [sp+8h] [bp-48h]@1
  int v7; // [sp+Ch] [bp-44h]@1
  int v8; // [sp+10h] [bp-40h]@1
  int v9; // [sp+14h] [bp-3Ch]@1
  int v10; // [sp+18h] [bp-38h]@1
  int v11; // [sp+1Ch] [bp-34h]@1
  int v12; // [sp+20h] [bp-30h]@1
  int v13; // [sp+24h] [bp-2Ch]@1
  int v14; // [sp+28h] [bp-28h]@1
  int v15; // [sp+2Ch] [bp-24h]@1
  int v16; // [sp+30h] [bp-20h]@1
  int v17; // [sp+34h] [bp-1Ch]@1
  int v18; // [sp+38h] [bp-18h]@1
  int v19; // [sp+3Ch] [bp-14h]@1
  int v20; // [sp+40h] [bp-10h]@1
  int v21; // [sp+44h] [bp-Ch]@1
  int v22; // [sp+48h] [bp-8h]@1
  int v23; // [sp+4Ch] [bp-4h]@1

  v4 = 0;
  v5 = 96;
  v6 = 40;
  v7 = 136;
  v8 = 40;
  v9 = 96;
  v10 = 80;
  v11 = 136;
  v12 = 80;
  v13 = 96;
  v14 = 120;
  v15 = 136;
  v16 = 120;
  v17 = 96;
  v18 = 160;
  v19 = 136;
  v20 = 160;
  v21 = 96;
  v22 = 200;
  v23 = 136;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 1 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 4 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0040A8F0) --------------------------------------------------------
// mode 0 only
signed int __cdecl Effect_14_Small_White_Explosion_Disc(BOOL Effect_Vars)
{
  int *v1; // eax@4
  int v2; // ecx@4
  signed int result; // eax@4
  int v4; // [sp+0h] [bp-40h]@1
  int v5; // [sp+4h] [bp-3Ch]@1
  int v6; // [sp+8h] [bp-38h]@1
  int v7; // [sp+Ch] [bp-34h]@1
  int v8; // [sp+10h] [bp-30h]@1
  int v9; // [sp+14h] [bp-2Ch]@1
  int v10; // [sp+18h] [bp-28h]@1
  int v11; // [sp+1Ch] [bp-24h]@1
  int v12; // [sp+20h] [bp-20h]@1
  int v13; // [sp+24h] [bp-1Ch]@1
  int v14; // [sp+28h] [bp-18h]@1
  int v15; // [sp+2Ch] [bp-14h]@1
  int v16; // [sp+30h] [bp-10h]@1
  int v17; // [sp+34h] [bp-Ch]@1
  int v18; // [sp+38h] [bp-8h]@1
  int v19; // [sp+3Ch] [bp-4h]@1

  v4 = 0;
  v5 = 72;
  v6 = 8;
  v7 = 80;
  v8 = 8;
  v9 = 72;
  v10 = 16;
  v11 = 80;
  v12 = 16;
  v13 = 72;
  v14 = 24;
  v15 = 80;
  v16 = 24;
  v17 = 72;
  v18 = 32;
  v19 = 80;
  if ( ++*(_DWORD *)(Effect_Vars + 40) > 2 )
  {
    *(_DWORD *)(Effect_Vars + 40) = 0;
    if ( ++*(_DWORD *)(Effect_Vars + 36) > 3 )
      *(_DWORD *)Effect_Vars = 0;
  }
  v1 = &v4 + 4 * *(_DWORD *)(Effect_Vars + 36);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0040A9E0) --------------------------------------------------------
// mode 0 only
signed int __cdecl Effect_15_Nothing(BOOL Effect_Vars)
{
  int *v1; // ecx@5
  int v2; // edx@5
  signed int result; // eax@5
  int v4; // [sp+0h] [bp-20h]@1
  int v5; // [sp+4h] [bp-1Ch]@1
  int v6; // [sp+8h] [bp-18h]@1
  int v7; // [sp+Ch] [bp-14h]@1
  int v8; // [sp+10h] [bp-10h]@1
  int v9; // [sp+14h] [bp-Ch]@1
  int v10; // [sp+18h] [bp-8h]@1
  int v11; // [sp+1Ch] [bp-4h]@1

  v4 = 104;
  v5 = 96;
  v6 = 144;
  v7 = 104;
  v8 = 104;
  v9 = 104;
  v10 = 144;
  v11 = 112;
  if ( ++*(_DWORD *)(Effect_Vars + 40) < 10 )
    *(_DWORD *)(Effect_Vars + 16) -= 1024;
  if ( *(_DWORD *)(Effect_Vars + 40) == 40 )
    *(_DWORD *)Effect_Vars = 0;
  v1 = &v4 + 4 * (*(_DWORD *)(Effect_Vars + 40) / 2 % 2);
  v2 = Effect_Vars + 52;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0040AAA0) --------------------------------------------------------
// mode 0 only
signed int __cdecl Effect_16_Push_Jump_Key(BOOL Effect_Vars)
{
  signed int result; // eax@4

  if ( ++*(_DWORD *)(Effect_Vars + 40) >= 40 )
    *(_DWORD *)(Effect_Vars + 40) = 0;
  if ( *(_DWORD *)(Effect_Vars + 40) >= 30 )
  {
    result = Effect_Vars + 52;
    *(_DWORD *)result = 0;
    *(_DWORD *)(result + 4) = 0;
    *(_DWORD *)(result + 8) = 0;
    *(_DWORD *)(result + 12) = 0;
  }
  else
  {
    result = Effect_Vars + 52;
    *(_DWORD *)result = 0;
    *(_DWORD *)(result + 4) = 144;
    *(_DWORD *)(result + 8) = 144;
    *(_DWORD *)(result + 12) = 152;
  }
  return result;
}

//----- (0040AB50) --------------------------------------------------------
void __cdecl Update_Effects()
{
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < 64; ++i )
  {
    if ( Effect_Objects[i].Is_Used & 0x80 )
      Effect_Function_Table[Effect_Objects[i].Effect_Num](&Effect_Objects[i]);
  }
}

//----- (0040ABC0) --------------------------------------------------------
void __cdecl Draw_Effects(signed int Camera_X, signed int Camera_Y)
{
  __int64 temp1; // rax@4 MAPDST
  int temp2; // ST08_4@4
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 64; ++i )
  {
    if ( Effect_Objects[i].Is_Used & 0x80 )
    {
      temp1 = Effect_Objects[i].Y_Pos - Effect_Objects[i].view_top;
      temp2 = (((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9) - Camera_Y / 512;
      temp1 = Effect_Objects[i].X_Pos - Effect_Objects[i].view_left;
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        (((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9) - Camera_X / 512,
        temp2,
        &Effect_Objects[i].rect,
        19);
    }
  }
}

//----- (0040AC90) --------------------------------------------------------
void __cdecl Create_Effect(int X_Pos, int Y_Pos, int Effect_Num, int Effect_Dir)
{
  signed int c; // [sp+0h] [bp-4h]@1

  for ( c = 0; c < 64 && Effect_Objects[c].Is_Used; ++c )// Search for free effect space
    ;
  if ( c != 64 )
  {
    memset(&Effect_Objects[c], 0, 0x44u);
    Effect_Objects[c].Is_Used = 128;
    Effect_Objects[c].Effect_Num = Effect_Num;
    Effect_Objects[c].X_Pos = X_Pos;
    Effect_Objects[c].Y_Pos = Y_Pos;
    Effect_Objects[c].view_left = Effect_Table_View_Left[2 * Effect_Num];
    Effect_Objects[c].view_top = Effect_Table_View_Top[2 * Effect_Num];
    Effect_Objects[c].Direction = Effect_Dir;
  }
}
// 48F830: using guessed type int Effect_Table_View_Left[];
// 48F834: using guessed type int Effect_Table_View_Top[];

//----- (0040AD60) --------------------------------------------------------
// Load Config.dat, check string DOUKUTSU20041206 (return 0 if not equal)
int __cdecl Load_Config_Data(Config_Data_File *config)
{
  int result; // eax@2
  char path[260]; // [sp+0h] [bp-118h]@1
  size_t v3; // [sp+110h] [bp-8h]@3
  FILE *stream; // [sp+114h] [bp-4h]@1

  memset(config, 0, 0x94u);
  sprintf(path, "%s\\%s", ExePath, Config_dat[0]);
  stream = fopen(path, "rb");
  if ( stream )
  {
    v3 = fread(config, 0x94u, 1u, stream);
    fclose(stream);
    if ( v3 == 1 && !strcmp(config->proof, DOUKUTSU20041206) )
    {
      result = 1;
    }
    else
    {
      memset(config, 0, 0x94u);
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 48F90C: using guessed type char *Config_dat[2];

//----- (0040AE30) --------------------------------------------------------
// Sets Config.dat to default values (Called if check above fails)
void __cdecl Set_Default_Config_Data(Config_Data_File *config)
{
  memset(config, 0, 0x94u);
  config->joystick_mode = 1;
  config->joystick_button[0] = 2;
  config->joystick_button[1] = 1;
  config->joystick_button[2] = 5;
  config->joystick_button[3] = 6;
  config->joystick_button[4] = 3;
  config->joystick_button[5] = 4;
  config->joystick_button[6] = 6;
  config->joystick_button[7] = 3;
}

//----- (0040AEC0) --------------------------------------------------------
// Runs when you hit "Version" menu button
signed int __stdcall About_Dialog(HWND Game_Window_Handle, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  signed int result; // eax@4
  const CHAR String[108]; // [sp+8h] [bp-88h]@4
  int v6; // [sp+74h] [bp-1Ch]@4
  int v7; // [sp+78h] [bp-18h]@4
  int v8; // [sp+7Ch] [bp-14h]@4
  int v9; // [sp+80h] [bp-10h]@4
  int v10; // [sp+84h] [bp-Ch]@4
  int v11; // [sp+88h] [bp-8h]@4
  int v12; // [sp+8Ch] [bp-4h]@4

  if ( Msg == WM_INITDIALOG )
  {
    Get_Build_Data((int)&v11, &v6, (int)&v7);
    Get_Version_Number((int)&v10, (int)&v8, (int)&v12, (int)&v9);
    sprintf((char *)String, oVersion_Thingy, v10, v8, v12, v9, v11, v6, v7);
    SetDlgItemTextA(Game_Window_Handle, 1011, String);
    Center_Window(Game_Window_Handle);
    result = 1;
  }
  else
  {
    if ( Msg == WM_COMMAND && (unsigned __int16)wParam == Button_OK )
      EndDialog(Game_Window_Handle, Button_OK);
    result = 0;
  }
  return result;
}

//----- (0040AFC0) --------------------------------------------------------
// Runs when you hit "Mute" menu button
signed int __stdcall Mute_Button(HWND Game_Window_Handle, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  signed int result; // eax@4

  if ( Msg == WM_INITDIALOG )
  {
    Center_Window(Game_Window_Handle);
    CheckDlgButton(Game_Window_Handle, Button_Mute_0, mute[0] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_1, mute[1] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_2, mute[2] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_3, mute[3] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_4, mute[4] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_5, mute[5] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_6, mute[6] != 0);
    CheckDlgButton(Game_Window_Handle, Button_Mute_7, mute[7] != 0);
    result = 1;
  }
  else
  {
    if ( Msg == WM_COMMAND )
    {
      if ( (unsigned __int16)wParam == Button_OK )
      {
        mute[0] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_0);
        mute[1] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_1);
        mute[2] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_2);
        mute[3] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_3);
        mute[4] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_4);
        mute[5] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_5);
        mute[6] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_6);
        mute[7] = IsDlgButtonChecked(Game_Window_Handle, Button_Mute_7);
        EndDialog(Game_Window_Handle, 1);
      }
      else if ( (unsigned __int16)wParam == Button_Cancel )
      {
        EndDialog(Game_Window_Handle, 0);
      }
    }
    result = 0;
  }
  return result;
}

//----- (0040B1D0) --------------------------------------------------------
// Runs when you hit "Debug Save" menu button
signed int __stdcall Debug_Save_Button(HWND hDlg, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  signed int result; // eax@4
  CHAR String[100]; // [sp+8h] [bp-70h]@8

  if ( Msg == WM_INITDIALOG )
  {
    SetDlgItemTextA(hDlg, Field_Save_File, "000.dat");
    Center_Window(hDlg);
    result = 1;
  }
  else
  {
    if ( Msg == WM_COMMAND )
    {
      if ( (unsigned __int16)wParam == Button_OK )
      {
        GetDlgItemTextA(hDlg, Field_Save_File, String, 100);
        Save_Profile(String);
        EndDialog(hDlg, 1);
      }
      else if ( (unsigned __int16)wParam == Button_Cancel )
      {
        EndDialog(hDlg, 0);
      }
    }
    result = 0;
  }
  return result;
}

//----- (0040B290) --------------------------------------------------------
// Runs when you hit "Quit" menu button
signed int __stdcall Yes_No_Dialog(HWND hDlg, int uMsg, WPARAM wParam, const CHAR *lpString)
{
  signed int result; // eax@4

  if ( uMsg == WM_INITDIALOG )
  {
    SetDlgItemTextA(hDlg, Field_Quit_Message, lpString);
    Center_Window(hDlg);
    result = 1;
  }
  else
  {
    if ( uMsg == WM_COMMAND )
    {
      if ( (unsigned __int16)wParam == Button_Yes )
      {
        EndDialog(hDlg, Button_Yes);
      }
      else if ( (unsigned __int16)wParam == Button_No )
      {
        EndDialog(hDlg, Button_No);
      }
    }
    result = 0;
  }
  return result;
}

//----- (0040B320) --------------------------------------------------------
int __cdecl Change_Screen_Offsets(int New_Screen_Offset_Y, int New_Screen_Offset_X)
{
  int result; // eax@1

  result = New_Screen_Offset_Y;
  Screen_Offset_Y = New_Screen_Offset_Y;
  Screen_Offset_X = New_Screen_Offset_X;
  return result;
}

//----- (0040B340) --------------------------------------------------------
// Draws the window. Also contains FPS delimiter
int __cdecl Draw_Window(HWND hWnd)
{
  while ( 1 )
  {
    if ( !MessageQueue() )
      return 0;
    Current_Tick_Count = GetTickCount();
    if ( Current_Tick_Count >= (unsigned int)(Previous_Tick_Count + 20) )
      break;
    Sleep(1u);
  }
  if ( Current_Tick_Count < (unsigned int)(Previous_Tick_Count + 100) )
    Previous_Tick_Count += 20;
  else
    Previous_Tick_Count = Current_Tick_Count;
  GetWindowRect(hWnd, &Final_Screen_Dist_Rects);
  Final_Screen_Dist_Rects.left += Screen_Offset_Y;
  Final_Screen_Dist_Rects.top += Screen_Offset_X;
  Final_Screen_Dist_Rects.right = Fullscreen_Surface_Height + Final_Screen_Dist_Rects.left;
  Final_Screen_Dist_Rects.bottom = Window_Surface_Width + Final_Screen_Dist_Rects.top;
  DD7_Final_Screen_Surface->lpVtbl->Blt(
    DD7_Final_Screen_Surface,
    &Final_Screen_Dist_Rects,
    DD7_Screen_Surface,
    &Window_Idk,
    DDBLT_WAIT,
    NULL);
  if ( Regenerate_Surfaces() )
  {
    Draws_Some_Text();
    Redraw_Room_Text_To_Surface();
    Draw_Text_To_Text_Box_Surfaces();
  }
  return 1;
}
// 49D374: using guessed type int Fullscreen_Surface_Height;
// 49D378: using guessed type int Window_Surface_Width;
// 49D438: using guessed type int Previous_Tick_Count;
// 49D43C: using guessed type int Current_Tick_Count;

//----- (0040B450) --------------------------------------------------------
signed int __cdecl InitDirectDraw(HWND hWnd, int mode, int Bits_Per_Pixel)
{
  signed int result; // eax@2
  DDSURFACEDESC dest; // [sp+4h] [bp-70h]@10

  if ( DirectDrawCreate(NULL, &Direct_Draw_Obj, NULL) )
  {
    result = 0;
  }
  else
  {
    memset(Names_Thingy, 0, 0x5A0u);
    if ( !mode )
    {
      GraphicScale = 1;
      IsFullScreen = 0;
      Direct_Draw_Obj->lpVtbl->SetCooperativeLevel(Direct_Draw_Obj, hWnd, DDSCL_NORMAL);
    }
    else if ( mode == Mode_640_480_Windowed )
    {
      GraphicScale = 2;
      IsFullScreen = 0;
      Direct_Draw_Obj->lpVtbl->SetCooperativeLevel(Direct_Draw_Obj, hWnd, DDSCL_NORMAL);
    }
    else if ( mode == Mode_Fullscreen )
    {
      GraphicScale = 2;
      IsFullScreen = 1;
      Direct_Draw_Obj->lpVtbl->SetCooperativeLevel(Direct_Draw_Obj, hWnd, DDSCL_EXCLUSIVE|DDSCL_FULLSCREEN);
      Direct_Draw_Obj->lpVtbl->SetDisplayMode(Direct_Draw_Obj, 320 * GraphicScale, 240 * GraphicScale, Bits_Per_Pixel);
    }
    Window_Idk.left = 0;
    Window_Idk.top = 0;
    Window_Idk.right = 320 * GraphicScale;
    Window_Idk.bottom = 240 * GraphicScale;
    Fullscreen_Surface_Height = 320 * GraphicScale;
    Window_Surface_Width = 240 * GraphicScale;
    memset(&dest, 0, 108u);
    dest.dwSize = 108;
    dest.dwFlags = DDSD_CAPS;
    dest.ddsCaps.dwCaps = 512;
    dest.dwBackBufferCount = 0;
    if ( Direct_Draw_Obj->lpVtbl->CreateSurface(Direct_Draw_Obj, &dest, &DD7_Final_Screen_Surface, NULL) )
    {
      result = 0;
    }
    else
    {
      memset(&dest, 0, 108u);
      dest.dwSize = 108;
      dest.dwFlags = 7;
      dest.ddsCaps.dwCaps = 64;
      dest.dwWidth = 320 * GraphicScale;
      dest.dwHeight = 240 * GraphicScale;
      if ( Direct_Draw_Obj->lpVtbl->CreateSurface(Direct_Draw_Obj, &dest, &DD7_Screen_Surface, NULL) )
      {
        result = 0;
      }
      else
      {
        Direct_Draw_Obj->lpVtbl->CreateClipper(Direct_Draw_Obj, 0, &Clip_List_Maybe, NULL);
        Clip_List_Maybe->lpVtbl->SetHWnd(Clip_List_Maybe, 0, hWnd);
        DD7_Final_Screen_Surface->lpVtbl->SetClipper(DD7_Final_Screen_Surface, Clip_List_Maybe);
        result = 1;
      }
    }
  }
  return result;
}
// 48F914: using guessed type int GraphicScale;
// 49CDC0: using guessed type int IsFullScreen;
// 49D374: using guessed type int Fullscreen_Surface_Height;
// 49D378: using guessed type int Window_Surface_Width;

//----- (0040B6C0) --------------------------------------------------------
// Kills Direct Draw (Called on program exit)
void *__cdecl End_Direct_Draw(HWND hwnd)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 40; ++i )
  {
    if ( Image_Res_Surface[i] )
    {
      Image_Res_Surface[i]->lpVtbl->Release(Image_Res_Surface[i]);
      Image_Res_Surface[i] = NULL;
    }
  }
  if ( DD7_Final_Screen_Surface )
  {
    DD7_Final_Screen_Surface->lpVtbl->Release(DD7_Final_Screen_Surface);
    DD7_Final_Screen_Surface = NULL;
    DD7_Screen_Surface = NULL;
  }
  if ( IsFullScreen )
    Direct_Draw_Obj->lpVtbl->SetCooperativeLevel(Direct_Draw_Obj, hwnd, DDSCL_NORMAL);
  if ( Direct_Draw_Obj )
  {
    Direct_Draw_Obj->lpVtbl->Release(Direct_Draw_Obj);
    Direct_Draw_Obj = NULL;
  }
  return memset(Names_Thingy, 0, 0x5A0u);
}
// 49CDC0: using guessed type int IsFullScreen;

//----- (0040B7A0) --------------------------------------------------------
// Destroy bitmap objects? (Called on program exit)
void *__cdecl Destroy_Bitmap_Obj_Maybe(int a1)
{
  if ( Image_Res_Surface[a1] )
  {
    ((void (__stdcall *)(LPDIRECTDRAWSURFACE))Image_Res_Surface[a1]->lpVtbl->Release)(Image_Res_Surface[a1]);
    Image_Res_Surface[a1] = NULL;
  }
  return memset(&Names_Thingy[36 * a1], 0, 0x24u);
}

//----- (0040B800) --------------------------------------------------------
int __cdecl MakeSurface_From_Resource(char *Ptr_Graphic, int GraphicID)
{
  int result; // eax@2
  HINSTANCE v3; // eax@5
  int v4; // ST4C_4@9
  int v5; // ST50_4@9
  HDC v6; // ST54_4@9
  int v7; // [sp+14h] [bp-B0h]@7
  int v8; // [sp+18h] [bp-ACh]@7
  int v9; // [sp+1Ch] [bp-A8h]@7
  DDSURFACEDESC ptr; // [sp+2Ch] [bp-98h]@7
  HGDIOBJ v11; // [sp+A0h] [bp-24h]@9
  HDC v12; // [sp+A4h] [bp-20h]@9
  int v13; // [sp+A8h] [bp-1Ch]@9
  int v14; // [sp+ACh] [bp-18h]@9
  HGDIOBJ v15; // [sp+B0h] [bp-14h]@5
  int v16; // [sp+B4h] [bp-10h]@9
  int v17; // [sp+B8h] [bp-Ch]@9
  int v18; // [sp+BCh] [bp-8h]@9
  int v19; // [sp+C0h] [bp-4h]@9

  if ( GraphicID < 40 )
  {
    if ( Image_Res_Surface[GraphicID] )
    {
      result = 0;
    }
    else
    {
      v3 = GetModuleHandleA(NULL);
      v15 = LoadImageA(v3, Ptr_Graphic, 0, 0, 0, 0x2000u);
      if ( v15 )
      {
        GetObjectA(v15, 24, &v7);
        memset(&ptr, 0, 108u);
        ptr.dwSize = 108;
        ptr.dwFlags = 7;
        ptr.ddsCaps.dwCaps = DDSCAPS_OFFSCREENPLAIN;
        ptr.dwWidth = GraphicScale * v8;
        ptr.dwHeight = GraphicScale * v9;
        if ( Direct_Draw_Obj->lpVtbl->CreateSurface(Direct_Draw_Obj, &ptr, &Image_Res_Surface[GraphicID], NULL) )
        {
          result = 0;
        }
        else
        {
          v16 = 0;
          v17 = 0;
          v18 = v8;
          v19 = v9;
          v4 = GraphicScale * v8;
          v5 = GraphicScale * v9;
          v6 = CreateCompatibleDC(NULL);
          v11 = SelectObject(v6, v15);
          Image_Res_Surface[GraphicID]->lpVtbl->GetDC(Image_Res_Surface[GraphicID], &v12);
          StretchBlt(v12, 0, 0, v4, v5, v6, v16, v17, v18, v19, 0xCC0020u);
          Image_Res_Surface[GraphicID]->lpVtbl->ReleaseDC(Image_Res_Surface[GraphicID], v12);
          SelectObject(v6, v11);
          DeleteDC(v6);
          v13 = 0;
          v14 = 0;
          Image_Res_Surface[GraphicID]->lpVtbl->SetColorKey(Image_Res_Surface[GraphicID], 8, (LPDDCOLORKEY)&v13);
          Image_Res_Surface[GraphicID]->lpVtbl->SetClipper(Image_Res_Surface[GraphicID], Clip_List_Maybe);
          dword_49CDE4[9 * GraphicID] = 2;
          dword_49CDDC[9 * GraphicID] = v8;
          dword_49CDE0[9 * GraphicID] = v9;
          dword_49CDE8[9 * GraphicID] = 0;
          strcpy(&Names_Thingy[36 * GraphicID], Ptr_Graphic);
          result = 1;
        }
      }
      else
      {
        result = 0;
      }
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 48F914: using guessed type int GraphicScale;

//----- (0040BAC0) --------------------------------------------------------
// Loads BMP from a file and creates a surface (Permanent)
int __cdecl MakeSurface_From_File(char *name, int destination)
{
  int result; // eax@2
  HINSTANCE v3; // eax@7
  char path; // [sp+0h] [bp-1D0h]@1
  int v5; // [sp+10Ch] [bp-C4h]@9
  int v6; // [sp+110h] [bp-C0h]@9
  int v7; // [sp+114h] [bp-BCh]@9
  int v8; // [sp+118h] [bp-B8h]@9
  HDC v9; // [sp+11Ch] [bp-B4h]@9
  int v10; // [sp+120h] [bp-B0h]@9
  int v11; // [sp+124h] [bp-ACh]@9
  int v12; // [sp+128h] [bp-A8h]@9
  DDSURFACEDESC Surf_Desc; // [sp+138h] [bp-98h]@9
  HGDIOBJ v14; // [sp+1ACh] [bp-24h]@9
  HDC v15; // [sp+1B0h] [bp-20h]@9
  int v16; // [sp+1B4h] [bp-1Ch]@9
  int v17; // [sp+1B8h] [bp-18h]@9
  HGDIOBJ v18; // [sp+1BCh] [bp-14h]@7
  int v19; // [sp+1C0h] [bp-10h]@9
  int v20; // [sp+1C4h] [bp-Ch]@9
  int v21; // [sp+1C8h] [bp-8h]@9
  int v22; // [sp+1CCh] [bp-4h]@9

  sprintf(&path, "%s\\%s.pbm", dataPath, name);
  if ( !IsEnableBitmap(&path) )
  {
    Log_Error((int)&path, 0);
    result = 0;
  }
  else if ( destination <= 40 )
  {
    if ( Image_Res_Surface[destination] )
    {
      Log_Error((int)"existing", destination);
      result = 0;
    }
    else
    {
      v3 = GetModuleHandleA(NULL);
      v18 = LoadImageA(v3, &path, 0, 0, 0, 0x2010u);
      if ( v18 )
      {
        GetObjectA(v18, 24, &v10);
        memset(&Surf_Desc, 0, 108u);
        Surf_Desc.dwSize = 108;
        Surf_Desc.dwFlags = 7;
        Surf_Desc.ddsCaps.dwCaps = DDSCAPS_OFFSCREENPLAIN;
        Surf_Desc.dwWidth = GraphicScale * v11;
        Surf_Desc.dwHeight = GraphicScale * v12;
        Direct_Draw_Obj->lpVtbl->CreateSurface(Direct_Draw_Obj, &Surf_Desc, &Image_Res_Surface[destination], NULL);
        v19 = 0;
        v20 = 0;
        v21 = v11;
        v22 = v12;
        v5 = 0;
        v6 = 0;
        v7 = GraphicScale * v11;
        v8 = GraphicScale * v12;
        v9 = CreateCompatibleDC(NULL);
        v14 = SelectObject(v9, v18);
        Image_Res_Surface[destination]->lpVtbl->GetDC(Image_Res_Surface[destination], &v15);
        StretchBlt(v15, v5, v6, v7, v8, v9, v19, v20, v21, v22, SRCCOPY);
        Image_Res_Surface[destination]->lpVtbl->ReleaseDC(Image_Res_Surface[destination], v15);
        SelectObject(v9, v14);
        DeleteDC(v9);
        v16 = 0;
        v17 = 0;
        Image_Res_Surface[destination]->lpVtbl->SetColorKey(Image_Res_Surface[destination], 8, (LPDDCOLORKEY)&v16);
        Image_Res_Surface[destination]->lpVtbl->SetClipper(Image_Res_Surface[destination], Clip_List_Maybe);
        DeleteObject(v18);
        dword_49CDE4[9 * destination] = 3;
        dword_49CDDC[9 * destination] = v11;
        dword_49CDE0[9 * destination] = v12;
        dword_49CDE8[9 * destination] = 0;
        strcpy(&Names_Thingy[36 * destination], name);
        result = 1;
      }
      else
      {
        Log_Error((int)&path, 1);
        result = 0;
      }
    }
  }
  else
  {
    Log_Error((int)"surface no", destination);
    result = 0;
  }
  return result;
}
// 48F914: using guessed type int GraphicScale;

//----- (0040BE10) --------------------------------------------------------
int __cdecl Load_BMP_From_Resource_Onto_Existing_Surface(char *source, int a2)
{
  int result; // eax@2
  HINSTANCE v3; // eax@3
  int v4; // ST3C_4@5
  int v5; // ST40_4@5
  HDC v6; // ST44_4@5
  int v7; // [sp+14h] [bp-3Ch]@5
  int v8; // [sp+18h] [bp-38h]@5
  int v9; // [sp+1Ch] [bp-34h]@5
  HGDIOBJ v10; // [sp+2Ch] [bp-24h]@5
  HDC v11; // [sp+30h] [bp-20h]@5
  int v12; // [sp+34h] [bp-1Ch]@5
  int v13; // [sp+38h] [bp-18h]@5
  HGDIOBJ v14; // [sp+3Ch] [bp-14h]@3
  int v15; // [sp+40h] [bp-10h]@5
  int v16; // [sp+44h] [bp-Ch]@5
  int v17; // [sp+48h] [bp-8h]@5
  int v18; // [sp+4Ch] [bp-4h]@5

  if ( a2 < 40 )
  {
    v3 = GetModuleHandleA(NULL);
    v14 = LoadImageA(v3, source, 0, 0, 0, 0x2000u);
    if ( v14 )
    {
      GetObjectA(v14, 24, &v7);
      v15 = 0;
      v16 = 0;
      v17 = v8;
      v18 = v9;
      v4 = GraphicScale * v8;
      v5 = GraphicScale * v9;
      v6 = CreateCompatibleDC(NULL);
      v10 = SelectObject(v6, v14);
      Image_Res_Surface[a2]->lpVtbl->GetDC(Image_Res_Surface[a2], &v11);
      StretchBlt(v11, 0, 0, v4, v5, v6, v15, v16, v17, v18, 0xCC0020u);
      Image_Res_Surface[a2]->lpVtbl->ReleaseDC(Image_Res_Surface[a2], v11);
      SelectObject(v6, v10);
      DeleteDC(v6);
      v12 = 0;
      v13 = 0;
      Image_Res_Surface[a2]->lpVtbl->SetColorKey(Image_Res_Surface[a2], 8, (LPDDCOLORKEY)&v12);
      Image_Res_Surface[a2]->lpVtbl->SetClipper(Image_Res_Surface[a2], Clip_List_Maybe);
      dword_49CDE4[9 * a2] = 2;
      strcpy(&Names_Thingy[36 * a2], source);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 48F914: using guessed type int GraphicScale;

//----- (0040BFD0) --------------------------------------------------------
int __cdecl ReloadBitmap_From_File(char *source, int destination)
{
  int result; // eax@2
  HINSTANCE v3; // eax@5
  char str; // [sp+0h] [bp-158h]@1
  int v5; // [sp+110h] [bp-48h]@7
  int v6; // [sp+114h] [bp-44h]@7
  int v7; // [sp+118h] [bp-40h]@7
  int v8; // [sp+11Ch] [bp-3Ch]@7
  HDC v9; // [sp+120h] [bp-38h]@7
  int v10; // [sp+124h] [bp-34h]@7
  int v11; // [sp+128h] [bp-30h]@7
  int v12; // [sp+12Ch] [bp-2Ch]@7
  HGDIOBJ v13; // [sp+13Ch] [bp-1Ch]@7
  HDC v14; // [sp+140h] [bp-18h]@7
  HGDIOBJ v15; // [sp+144h] [bp-14h]@5
  int v16; // [sp+148h] [bp-10h]@7
  int v17; // [sp+14Ch] [bp-Ch]@7
  int v18; // [sp+150h] [bp-8h]@7
  int v19; // [sp+154h] [bp-4h]@7

  sprintf(&str, "%s\\%s.pbm", dataPath, source);
  if ( IsEnableBitmap(&str) )
  {
    if ( destination <= 40 )
    {
      v3 = GetModuleHandleA(NULL);
      v15 = LoadImageA(v3, &str, 0, 0, 0, 0x2010u);
      if ( v15 )
      {
        GetObjectA(v15, 24, &v10);
        v16 = 0;
        v17 = 0;
        v18 = v11;
        v19 = v12;
        v5 = 0;
        v6 = 0;
        v7 = GraphicScale * v11;
        v8 = GraphicScale * v12;
        v9 = CreateCompatibleDC(NULL);
        v13 = SelectObject(v9, v15);
        Image_Res_Surface[destination]->lpVtbl->GetDC(Image_Res_Surface[destination], &v14);
        StretchBlt(v14, v5, v6, v7, v8, v9, v16, v17, v18, v19, 0xCC0020u);
        Image_Res_Surface[destination]->lpVtbl->ReleaseDC(Image_Res_Surface[destination], v14);
        SelectObject(v9, v13);
        DeleteDC(v9);
        DeleteObject(v15);
        dword_49CDE4[9 * destination] = 3;
        strcpy(&Names_Thingy[36 * destination], source);
        result = 1;
      }
      else
      {
        Log_Error((int)&str, 1);
        result = 0;
      }
    }
    else
    {
      Log_Error((int)"surface no", destination);
      result = 0;
    }
  }
  else
  {
    Log_Error((int)&str, 0);
    result = 0;
  }
  return result;
}
// 48F914: using guessed type int GraphicScale;

//----- (0040C1D0) --------------------------------------------------------
signed int __cdecl MakeSurface_Blank(int a1, int a2, signed int a3, int a4)
{
  signed int result; // eax@2
  DDCOLORKEY v5; // [sp+0h] [bp-78h]@8
  DDSURFACEDESC ptr; // [sp+8h] [bp-70h]@5

  if ( a3 <= 40 )
  {
    if ( Image_Res_Surface[a3] )
    {
      result = 0;
    }
    else
    {
      memset(&ptr, 0, 0x6Cu);
      ptr.dwSize = 108;
      ptr.dwFlags = 7;
      if ( a4 )
        ptr.ddsCaps.dwCaps = DDSCAPS_SYSTEMMEMORY|DDSCAPS_OFFSCREENPLAIN;
      else
        ptr.ddsCaps.dwCaps = DDSCAPS_OFFSCREENPLAIN;
      ptr.dwWidth = GraphicScale * a1;
      ptr.dwHeight = GraphicScale * a2;
      Direct_Draw_Obj->lpVtbl->CreateSurface(Direct_Draw_Obj, &ptr, &Image_Res_Surface[a3], NULL);
      v5.dwColorSpaceLowValue = 0;
      v5.dwColorSpaceHighValue = 0;
      Image_Res_Surface[a3]->lpVtbl->SetColorKey(Image_Res_Surface[a3], 8, &v5);
      dword_49CDE4[9 * a3] = 1;
      dword_49CDDC[9 * a3] = ptr.dwWidth / GraphicScale;
      dword_49CDE0[9 * a3] = ptr.dwHeight / GraphicScale;
      if ( a4 )
        dword_49CDE8[9 * a3] = 1;
      else
        dword_49CDE8[9 * a3] = 0;
      strcpy(&Names_Thingy[36 * a3], "generic");
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 48F914: using guessed type int GraphicScale;

//----- (0040C320) --------------------------------------------------------
int __cdecl Backup_Surface(int DstRect, RECT *rect)
{
  memset(&DDBLTFX_ScreenCopy, 0, 0x64u);
  *(_DWORD *)&DDBLTFX_ScreenCopy = 100;
  RECT_ScreenCopy.left = GraphicScale * rect->left;
  RECT_ScreenCopy.top = GraphicScale * rect->top;
  RECT_ScreenCopy.right = GraphicScale * rect->right;
  RECT_ScreenCopy.bottom = GraphicScale * rect->bottom;
  return Image_Res_Surface[DstRect]->lpVtbl->Blt(
           Image_Res_Surface[DstRect],
           &RECT_ScreenCopy,
           DD7_Screen_Surface,
           &RECT_ScreenCopy,
           0x1000000,
           (LPDDBLTFX)&DDBLTFX_ScreenCopy);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040C3C0) --------------------------------------------------------
void __cdecl Draw_Bitmap_With_Transparency(RECT *rcView, int XPos, int YPos, RECT *rect, int GraphicsID)
{
  rcWork.left = rect->left;
  rcWork.top = rect->top;
  rcWork.right = rect->right;
  rcWork.bottom = rect->bottom;
  if ( rect->right + XPos - rect->left > rcView->right )
    rcWork.right -= rect->right + XPos - rect->left - rcView->right;
  if ( XPos < rcView->left )
  {
    rcWork.left += rcView->left - XPos;
    XPos = rcView->left;
  }
  if ( rect->bottom + YPos - rect->top > rcView->bottom )
    rcWork.bottom -= rect->bottom + YPos - rect->top - rcView->bottom;
  if ( YPos < rcView->top )
  {
    rcWork.top += rcView->top - YPos;
    YPos = rcView->top;
  }
  Final_Dst_Rect_1.left = GraphicScale * XPos;
  Final_Dst_Rect_1.top = GraphicScale * YPos;
  Final_Dst_Rect_1.right = GraphicScale * (rcWork.right + XPos - rcWork.left);
  Final_Dst_Rect_1.bottom = GraphicScale * (rcWork.bottom + YPos - rcWork.top);
  rcWork.left *= GraphicScale;
  rcWork.top *= GraphicScale;
  rcWork.right *= GraphicScale;
  rcWork.bottom *= GraphicScale;
  DD7_Screen_Surface->lpVtbl->Blt(
    DD7_Screen_Surface,
    &Final_Dst_Rect_1,
    Image_Res_Surface[GraphicsID],
    &rcWork,
    0x1008000,
    NULL);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040C5B0) --------------------------------------------------------
// Render_Graphics for backgrounds
int __cdecl Draw_Sprite_No_Tranparency(RECT *Dst_Rects, int X_Position, int Y_Position, RECT *Src_Rects, int a5)
{
  Final_Src_Rect_2.left = Src_Rects->left;
  Final_Src_Rect_2.top = Src_Rects->top;
  Final_Src_Rect_2.right = Src_Rects->right;
  Final_Src_Rect_2.bottom = Src_Rects->bottom;
  if ( Src_Rects->right + X_Position - Src_Rects->left > Dst_Rects->right )
    Final_Src_Rect_2.right -= Src_Rects->right + X_Position - Src_Rects->left - Dst_Rects->right;
  if ( X_Position < Dst_Rects->left )
  {
    Final_Src_Rect_2.left += Dst_Rects->left - X_Position;
    X_Position = Dst_Rects->left;
  }
  if ( Src_Rects->bottom + Y_Position - Src_Rects->top > Dst_Rects->bottom )
    Final_Src_Rect_2.bottom -= Src_Rects->bottom + Y_Position - Src_Rects->top - Dst_Rects->bottom;
  if ( Y_Position < Dst_Rects->top )
  {
    Final_Src_Rect_2.top += Dst_Rects->top - Y_Position;
    Y_Position = Dst_Rects->top;
  }
  Final_Dst_Rect_2.left = GraphicScale * X_Position;
  Final_Dst_Rect_2.top = GraphicScale * Y_Position;
  Final_Dst_Rect_2.right = GraphicScale * (Final_Src_Rect_2.right + X_Position - Final_Src_Rect_2.left);
  Final_Dst_Rect_2.bottom = GraphicScale * (Final_Src_Rect_2.bottom + Y_Position - Final_Src_Rect_2.top);
  Final_Src_Rect_2.left *= GraphicScale;
  Final_Src_Rect_2.top *= GraphicScale;
  Final_Src_Rect_2.right *= GraphicScale;
  Final_Src_Rect_2.bottom *= GraphicScale;
  return DD7_Screen_Surface->lpVtbl->Blt(
           DD7_Screen_Surface,
           &Final_Dst_Rect_2,
           Image_Res_Surface[a5],
           &Final_Src_Rect_2,
           0x1000000,
           NULL);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040C7A0) --------------------------------------------------------
int __cdecl Draw_Sprite_Onto_Surface(LONG a1, LONG a2, RECT *a3, int a4, int a5)
{
  Final_Src_Rect_3.left = GraphicScale * a3->left;
  Final_Src_Rect_3.top = GraphicScale * a3->top;
  Final_Src_Rect_3.right = GraphicScale * a3->right;
  Final_Src_Rect_3.bottom = GraphicScale * a3->bottom;
  Final_Dst_Rect_3.left = a1;
  Final_Dst_Rect_3.top = a2;
  Final_Dst_Rect_3.right = a3->right + a1 - a3->left;
  Final_Dst_Rect_3.bottom = a3->bottom + a2 - a3->top;
  Final_Dst_Rect_3.left = GraphicScale * a1;
  Final_Dst_Rect_3.top = GraphicScale * a2;
  Final_Dst_Rect_3.right *= GraphicScale;
  Final_Dst_Rect_3.bottom *= GraphicScale;
  return Image_Res_Surface[a4]->lpVtbl->Blt(
           Image_Res_Surface[a4],
           &Final_Dst_Rect_3,
           Image_Res_Surface[a5],
           &Final_Src_Rect_3,
           0x1008000,
           NULL);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040C8B0) --------------------------------------------------------
LPVOID __cdecl Make_RGB(COLORREF color)
{
  LPVOID result; // eax@2
  COLORREF v2; // [sp+0h] [bp-7Ch]@3
  DDSURFACEDESC ptr; // [sp+4h] [bp-78h]@3
  HDC Screen_Context; // [sp+74h] [bp-8h]@1
  int v5; // [sp+78h] [bp-4h]@5

  if ( DD7_Screen_Surface->lpVtbl->GetDC(DD7_Screen_Surface, &Screen_Context) )
  {
    result = (LPVOID)-1;
  }
  else
  {
    v2 = GetPixel(Screen_Context, 0, 0);
    SetPixel(Screen_Context, 0, 0, color);
    DD7_Screen_Surface->lpVtbl->ReleaseDC(DD7_Screen_Surface, Screen_Context);
    memset(&ptr, 0, 0x6Cu);
    ptr.dwSize = 108;
    if ( DD7_Screen_Surface->lpVtbl->Lock(DD7_Screen_Surface, NULL, &ptr, 1, NULL) )
    {
      result = (LPVOID)-1;
    }
    else
    {
      v5 = *(_DWORD *)ptr.lpSurface;
      if ( ptr.ddpfPixelFormat.dwRGBBitCount < 0x20 )
        v5 &= (1 << SLOBYTE(ptr.ddpfPixelFormat.dwRGBBitCount)) - 1;
      ((void (__cdecl *)(LPDIRECTDRAWSURFACE, _DWORD))DD7_Screen_Surface->lpVtbl->Unlock)(DD7_Screen_Surface, 0);
      if ( DD7_Screen_Surface->lpVtbl->GetDC(DD7_Screen_Surface, &Screen_Context) )
      {
        result = (LPVOID)-1;
      }
      else
      {
        SetPixel(Screen_Context, 0, 0, v2);
        DD7_Screen_Surface->lpVtbl->ReleaseDC(DD7_Screen_Surface, Screen_Context);
        result = (LPVOID)v5;
      }
    }
  }
  return result;
}

//----- (0040C9E0) --------------------------------------------------------
void __cdecl Draw_Color_Fill(RECT *rect, int Mask_Color)
{
  memset(Draw_Colour_Fill_DDBLTFX, 0, 0x64u);
  *(_DWORD *)Draw_Colour_Fill_DDBLTFX = 100;
  *(_DWORD *)Draw_Colour_Fill_DDBLTFX_dxFillColor = Mask_Color;
  Dest_Rect.left = GraphicScale * rect->left;
  Dest_Rect.top = GraphicScale * rect->top;
  Dest_Rect.right = GraphicScale * rect->right;
  Dest_Rect.bottom = GraphicScale * rect->bottom;
  DD7_Screen_Surface->lpVtbl->Blt(
    DD7_Screen_Surface,
    &Dest_Rect,
    NULL,
    NULL,
    16778240,
    (LPDDBLTFX)Draw_Colour_Fill_DDBLTFX);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040CA80) --------------------------------------------------------
void __cdecl Draw_Color_Fill_Onto_Surface(RECT *rect, int column, int surface)
{
  memset(Draw_Colour_Fill_Onto_Surface_DDBLTFX, 0, 0x64u);
  *(_DWORD *)Draw_Colour_Fill_Onto_Surface_DDBLTFX = 100;
  *(_DWORD *)Draw_Colour_Fill_Onto_Surface_DDBLTFX_dxFillColor = column;
  Final_Dst_Rect_5.left = GraphicScale * rect->left;
  Final_Dst_Rect_5.top = GraphicScale * rect->top;
  Final_Dst_Rect_5.right = GraphicScale * rect->right;
  Final_Dst_Rect_5.bottom = GraphicScale * rect->bottom;
  dword_49CDE4[9 * surface] = 1;
  Image_Res_Surface[surface]->lpVtbl->Blt(
    Image_Res_Surface[surface],
    &Final_Dst_Rect_5,
    NULL,
    NULL,
    16778240,
    (LPDDBLTFX)Draw_Colour_Fill_Onto_Surface_DDBLTFX);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040CB30) --------------------------------------------------------
signed int Return_1()
{
  return 1;
}

//----- (0040CB60) --------------------------------------------------------
int Regenerate_Surfaces()
{
  int result; // eax@2
  int v1; // [sp+0h] [bp-1Ch]@14
  RECT a1; // [sp+4h] [bp-18h]@18
  int a3; // [sp+14h] [bp-8h]@9
  int Was_Surface_Lost; // [sp+18h] [bp-4h]@1

  Was_Surface_Lost = 0;
  if ( DD7_Final_Screen_Surface )
  {
    if ( DD7_Screen_Surface )
    {
      if ( DD7_Final_Screen_Surface->lpVtbl->IsLost(DD7_Final_Screen_Surface) == DDERR_SURFACELOST )
      {
        ++Was_Surface_Lost;
        DD7_Final_Screen_Surface->lpVtbl->Restore(DD7_Final_Screen_Surface);
        Return_1();
      }
      if ( DD7_Screen_Surface->lpVtbl->IsLost(DD7_Screen_Surface) == DDERR_SURFACELOST )
      {
        ++Was_Surface_Lost;
        DD7_Screen_Surface->lpVtbl->Restore(DD7_Screen_Surface);
        Return_1();
      }
      for ( a3 = 0; a3 < 40; ++a3 )
      {
        if ( Image_Res_Surface[a3] )
        {
          if ( Image_Res_Surface[a3]->lpVtbl->IsLost(Image_Res_Surface[a3]) == DDERR_SURFACELOST )
          {
            ++Was_Surface_Lost;
            Image_Res_Surface[a3]->lpVtbl->Restore(Image_Res_Surface[a3]);
            Return_1();
            if ( !dword_49CDE8[9 * a3] )
            {
              v1 = dword_49CDE4[9 * a3];
              switch ( v1 )
              {
                case 1:
                  a1.left = 0;
                  a1.top = 0;
                  a1.right = dword_49CDDC[9 * a3];
                  a1.bottom = dword_49CDE0[9 * a3];
                  Draw_Color_Fill_Onto_Surface(&a1, 0, a3);
                  break;
                case 2:
                  Load_BMP_From_Resource_Onto_Existing_Surface(&Names_Thingy[36 * a3], a3);
                  break;
                case 3:
                  ReloadBitmap_From_File(&Names_Thingy[36 * a3], a3);
                  break;
              }
            }
          }
        }
      }
      result = Was_Surface_Lost;
    }
    else
    {
      result = Was_Surface_Lost;
    }
  }
  else
  {
    result = Was_Surface_Lost;
  }
  return result;
}

//----- (0040CD50) --------------------------------------------------------
void __cdecl Init_Font_Object(LPCSTR a1)
{
  signed int v1; // [sp+4h] [bp-8h]@0
  signed int v2; // [sp+8h] [bp-4h]@0

  if ( GraphicScale == 1 )
  {
    v1 = 12;
    v2 = 6;
  }
  else if ( GraphicScale == 2 )
  {
    v1 = 20;
    v2 = 10;
  }
  Font_Handle[0] = CreateFontA(v1, v2, 0, 0, 400, 0, 0, 0, 1u, 4u, 0, 0, 1u, a1);
  if ( !Font_Handle[0] )
    Font_Handle[0] = CreateFontA(v1, v2, 0, 0, 400, 0, 0, 0, 1u, 4u, 0, 0, 1u, NULL);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040CE00) --------------------------------------------------------
// Unused
int __cdecl Draw_String(int a1, int a2, const char *String, COLORREF String_Color)
{
  int v4; // eax@1
  HDC v6; // [sp+0h] [bp-8h]@1
  HGDIOBJ v7; // [sp+4h] [bp-4h]@1

  DD7_Screen_Surface->lpVtbl->GetDC(DD7_Screen_Surface, &v6);
  v7 = SelectObject(v6, Font_Handle[0]);
  SetBkMode(v6, 1);
  SetTextColor(v6, String_Color);
  v4 = strlen(String);
  TextOutA(v6, GraphicScale * a1, GraphicScale * a2, String, v4);
  SelectObject(v6, v7);
  return DD7_Screen_Surface->lpVtbl->ReleaseDC(DD7_Screen_Surface, v6);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040CEB0) --------------------------------------------------------
// Draws text to screen (Message box writing?)
int __cdecl Draw_String_Onto_Surface(int X_Position, int Y_Position, char *Ptr_String, COLORREF color, int DDraw_Thingy)
{
  int v5; // eax@1
  HDC v7; // [sp+0h] [bp-8h]@1
  HGDIOBJ v8; // [sp+4h] [bp-4h]@1

  Image_Res_Surface[DDraw_Thingy]->lpVtbl->GetDC(Image_Res_Surface[DDraw_Thingy], &v7);
  v8 = SelectObject(v7, Font_Handle[0]);
  SetBkMode(v7, 1);
  SetTextColor(v7, color);
  v5 = strlen(Ptr_String);
  TextOutA(v7, GraphicScale * X_Position, GraphicScale * Y_Position, Ptr_String, v5);
  SelectObject(v7, v8);
  return Image_Res_Surface[DDraw_Thingy]->lpVtbl->ReleaseDC(Image_Res_Surface[DDraw_Thingy], v7);
}
// 48F914: using guessed type int GraphicScale;

//----- (0040CF90) --------------------------------------------------------
int Scroll_Credits_Text()
{
  int result; // eax@8
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 16; ++i )
  {
    if ( Text_Object_Array[i].flag & 0x80 && Credit_Script.mode )
      Text_Object_Array[i].y -= 256;
    if ( Text_Object_Array[i].y <= -8192 )
      Text_Object_Array[i].flag = 0;
    result = i + 1;
  }
  return result;
}

//----- (0040D010) --------------------------------------------------------
// Draws something from Bitmap Slot 0x25, which might be the credits text
int Draw_From_Slot_0x25_Credits_Text_Maybe()
{
  int result; // eax@5
  signed int i; // [sp+0h] [bp-14h]@1
  RECT rect; // [sp+4h] [bp-10h]@4

  for ( i = 0; i < 16; ++i )
  {
    if ( Text_Object_Array[i].flag & 0x80 )
    {
      rect.left = 0;
      rect.right = 320;
      rect.top = 16 * i;
      rect.bottom = 16 * i + 16;
      Draw_Bitmap_With_Transparency(&::rect, Text_Object_Array[i].x / 512, Text_Object_Array[i].y / 512, &rect, 35);
      rect.left = 24 * (Text_Object_Array[i].cast % 13);
      rect.right = rect.left + 24;
      rect.top = 24 * (Text_Object_Array[i].cast / 13);
      rect.bottom = rect.top + 24;
      Draw_Bitmap_With_Transparency(
        &::rect,
        Text_Object_Array[i].x / 512 - 24,
        Text_Object_Array[i].y / 512 - 8,
        &rect,
        37);
    }
    result = i + 1;
  }
  return result;
}

//----- (0040D150) --------------------------------------------------------
// Draws some text
int __cdecl Print_Text_Maybe(int arg0, int a2, char *source, int a4)
{
  int result; // eax@4
  signed int i; // [sp+0h] [bp-14h]@1
  RECT a1; // [sp+4h] [bp-10h]@6

  for ( i = 0; i < 16 && Text_Object_Array[i].flag & 0x80; ++i )
    result = i + 1;
  if ( i != 16 )
  {
    Text_Object_Array[i].flag = 128;
    Text_Object_Array[i].x = arg0;
    Text_Object_Array[i].y = a2;
    Text_Object_Array[i].cast = a4;
    strcpy(Text_Object_Array[i].str, source);
    a1.left = 0;
    a1.right = 320;
    a1.top = 16 * i;
    a1.bottom = 16 * i + 16;
    Draw_Color_Fill_Onto_Surface(&a1, 0, 35);
    result = Draw_String_Onto_Surface(0, a1.top, source, 0xFEFFFFu, 35);
  }
  return result;
}

//----- (0040D240) --------------------------------------------------------
// Draws some text
int Draws_Some_Text()
{
  int result; // eax@5
  signed int i; // [sp+0h] [bp-14h]@1
  RECT a1; // [sp+4h] [bp-10h]@4

  for ( i = 0; i < 16; ++i )
  {
    if ( Text_Object_Array[i].flag & 0x80 )
    {
      a1.left = 0;
      a1.right = 320;
      a1.top = 16 * i;
      a1.bottom = 16 * i + 16;
      Draw_Color_Fill_Onto_Surface(&a1, 0, 35);
      Draw_String_Onto_Surface(0, a1.top, Text_Object_Array[i].str, 0xFEFFFFu, 35);
    }
    result = i + 1;
  }
  return result;
}

//----- (0040D2D0) --------------------------------------------------------
// Does some odd stuff with a few variables based on what's the value of 49D608
int Slide_Credits_Picture()
{
  int result; // eax@1

  result = Credit_Pic.Act_Num;
  if ( Credit_Pic.Act_Num )
  {
    if ( Credit_Pic.Act_Num == 1 )
    {
      Credit_Pic.X_Pos += 20480;
      if ( Credit_Pic.X_Pos > 0 )
        Credit_Pic.X_Pos = 0;
    }
    else if ( Credit_Pic.Act_Num == 2 )
    {
      Credit_Pic.X_Pos -= 20480;
      if ( Credit_Pic.X_Pos < -81920 )
        Credit_Pic.X_Pos = -81920;
    }
  }
  else
  {
    Credit_Pic.X_Pos = -81920;
  }
  return result;
}

//----- (0040D350) --------------------------------------------------------
// Draws credits image (from Bitmap Slot 0x24)
void Draw_Credits_Image()
{
  RECT rect; // [sp+0h] [bp-10h]@1

  rect.left = 0;
  rect.top = 0;
  rect.right = 160;
  rect.bottom = 240;
  Draw_Bitmap_With_Transparency(&::rect, Credit_Pic.X_Pos / 512, 0, &rect, 36);
}

//----- (0040D3A0) --------------------------------------------------------
// Slot 36 : Used for Credit images
void __cdecl Load_Credits_Illustration(int Credit_Number)
{
  char name[16]; // [sp+0h] [bp-14h]@1

  sprintf(name, "CREDIT%02d", Credit_Number);
  Load_BMP_From_Resource_Onto_Existing_Surface(name, 36);
}

//----- (0040D3E0) --------------------------------------------------------
void __cdecl InitCreditScript()
{
  memset(&Credit_Script, 0, 0x18u);
  memset(Text_Object_Array, 0, 0x500u);
}

//----- (0040D410) --------------------------------------------------------
void Release_Credit_Script()
{
  if ( Credit_Script.Buffer )
  {
    free(Credit_Script.Buffer);
    Credit_Script.Buffer = NULL;
  }
}

//----- (0040D440) --------------------------------------------------------
// Initializes Credits. Loads a file, puts casts.pbm into slot 0x25
signed int Start_Credits_Script()
{
  signed int result; // eax@4
  char path[260]; // [sp+0h] [bp-110h]@3
  FILE *stream; // [sp+10Ch] [bp-4h]@7

  if ( Credit_Script.Buffer )
  {
    free(Credit_Script.Buffer);
    Credit_Script.Buffer = NULL;
  }
  sprintf(path, "%s\\%s", dataPath, off_48F918);
  Credit_Script.Length = getFileSize(path);
  if ( Credit_Script.Length == -1 )
  {
    result = 0;
  }
  else
  {
    Credit_Script.Buffer = (char *)malloc(Credit_Script.Length);
    if ( !Credit_Script.Buffer )
    {
      result = 0;
    }
    else
    {
      stream = fopen(path, "rb");
      if ( !stream )
      {
        free(Credit_Script.Buffer);
        result = 0;
      }
      else
      {
        fread(Credit_Script.Buffer, 1u, Credit_Script.Length, stream);
        decryptTSCScript((unsigned __int8 *)Credit_Script.Buffer, Credit_Script.Length);
        Credit_Script.offset = 0;
        Credit_Script.wait = 0;
        Credit_Script.mode = 1;
        Credit_Pic.X_Pos = -81920;
        Credit_Pic.Act_Num = 0;
        Rect_Game.left = 160;
        if ( !ReloadBitmap_From_File("casts", 37) )
        {
          result = 0;
        }
        else
        {
          memset(Text_Object_Array, 0, 0x500u);
          result = 1;
        }
      }
    }
  }
  return result;
}
// 48F918: using guessed type char *off_48F918;

//----- (0040D5C0) --------------------------------------------------------
void Credits_Related_Maybe()
{
  if ( Credit_Script.offset < Credit_Script.Length )
  {
    if ( Credit_Script.mode == 1 )
    {
      Credits_Related_2_Maybe();
    }
    else if ( Credit_Script.mode == 2 && --Credit_Script.wait <= 0 )
    {
      Credit_Script.mode = 1;
    }
  }
}

//----- (0040D620) --------------------------------------------------------
void Credits_Related_2_Maybe()
{
  size_t count; // ST18_4@9
  size_t v1; // ST18_4@9
  int music; // ST1C_4@13
  int v3; // ST1C_4@18
  int v4; // ST1C_4@25
  int v5; // ST1C_4@28
  int v6; // [sp+4h] [bp-38h]@15
  int v7; // [sp+4h] [bp-38h]@25
  signed int Music_To_Play; // [sp+Ch] [bp-30h]@3
  char destination[40]; // [sp+10h] [bp-2Ch]@9

  while ( 2 )
  {
    if ( Credit_Script.offset < Credit_Script.Length )
    {
      switch ( Credit_Script.Buffer[Credit_Script.offset] )
      {
        case 91:
          Music_To_Play = ++Credit_Script.offset;
          while ( Credit_Script.Buffer[Music_To_Play] != 93 )
          {
            if ( Is_Shift_JIS(Credit_Script.Buffer[Music_To_Play]) )
              Music_To_Play += 2;
            else
              ++Music_To_Play;
          }
          count = Music_To_Play - Credit_Script.offset;
          memcpy(destination, &Credit_Script.Buffer[Credit_Script.offset], Music_To_Play - Credit_Script.offset);
          destination[count] = 0;
          Credit_Script.offset = Music_To_Play + 1;
          v1 = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[Music_To_Play + 1]);
          Print_Text_Maybe(Credit_Script.start_x, 126976, destination, v1);
          Credit_Script.offset += 4;
          return;
        case 45:
          Credit_Script.wait = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]);
          Credit_Script.offset += 4;
          Credit_Script.mode = 2;
          return;
        case 43:
          Credit_Script.start_x = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]) << 9;
          Credit_Script.offset += 4;
          return;
        case 47:
          Credit_Script.mode = 0;
          return;
        case 33:
          music = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]);
          Credit_Script.offset += 4;
          Change_Music((Music_enum)music);
          return;
        case 126:
          ++Credit_Script.offset;
          Fade_Music();
          return;
        case 106:
          v6 = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]);
          Credit_Script.offset += 4;
          do
          {
LABEL_16:
            if ( Credit_Script.offset >= Credit_Script.Length )
              break;
            if ( Credit_Script.Buffer[Credit_Script.offset] != 108 )
            {
              if ( Is_Shift_JIS(Credit_Script.Buffer[Credit_Script.offset]) )
                Credit_Script.offset += 2;
              else
                ++Credit_Script.offset;
              goto LABEL_16;
            }
            v3 = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]);
            Credit_Script.offset += 4;
          }
          while ( v6 != v3 );
          return;
        case 102:
          v4 = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]);
          Credit_Script.offset += 5;
          v7 = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[Credit_Script.offset]);
          Credit_Script.offset += 4;
          if ( !Get_NPC_Flag(v4) )
            return;
          break;
        default:
          ++Credit_Script.offset;
          continue;
      }
      while ( Credit_Script.offset < Credit_Script.Length )
      {
        if ( Credit_Script.Buffer[Credit_Script.offset] == 108 )
        {
          v5 = Credits_Related_3_Maybe((int)&Credit_Script.Buffer[++Credit_Script.offset]);
          Credit_Script.offset += 4;
          if ( v7 == v5 )
            return;
        }
        else if ( Is_Shift_JIS(Credit_Script.Buffer[Credit_Script.offset]) )
        {
          Credit_Script.offset += 2;
        }
        else
        {
          ++Credit_Script.offset;
        }
      }
    }
    break;
  }
}
// 40D620: using guessed type char destination[40];

//----- (0040DB00) --------------------------------------------------------
int __cdecl Credits_Related_3_Maybe(int a1)
{
  return 10 * (*(_BYTE *)(a1 + 2) - 48)
       + 100 * (*(_BYTE *)(a1 + 1) - 48)
       + 1000 * (*(_BYTE *)a1 - 48)
       + *(_BYTE *)(a1 + 3)
       - 48;
}

//----- (0040DB40) --------------------------------------------------------
void __cdecl Set_Credit_Illustration(int num)
{
  Load_Credits_Illustration(num);
  Credit_Pic.Act_Num = 1;
}

//----- (0040DB60) --------------------------------------------------------
void Cut_Credit_Illustration()
{
  Credit_Pic.Act_Num = 2;
}

//----- (0040DB70) --------------------------------------------------------
// XX1 : Shows distant view of island
int __cdecl Scene_Island_Crash(HWND hWnd, int mode)
{
  int Call_Escape_Ret; // [sp+4h] [bp-50h]@4
  signed int wait; // [sp+8h] [bp-4Ch]@1
  RECT Rect_Ground; // [sp+Ch] [bp-48h]@1
  Coords Sprite; // [sp+1Ch] [bp-38h]@1
  RECT Rect_Frame; // [sp+24h] [bp-30h]@1
  RECT Rect_Sky; // [sp+34h] [bp-20h]@1
  RECT Rect_Sprite; // [sp+44h] [bp-10h]@1

  Rect_Frame.left = 80;
  Rect_Frame.top = 80;
  Rect_Frame.right = 240;
  Rect_Frame.bottom = 160;
  Rect_Sky.left = 0;
  Rect_Sky.top = 0;
  Rect_Sky.right = 160;
  Rect_Sky.bottom = 80;
  Rect_Ground.left = 160;
  Rect_Ground.top = 48;
  Rect_Ground.right = 320;
  Rect_Ground.bottom = 80;
  Rect_Sprite.left = 160;
  Rect_Sprite.top = 0;
  Rect_Sprite.right = 200;
  Rect_Sprite.bottom = 24;
  Sprite.X_Pos = 0x15000;
  Sprite.Y_Pos = 0x8000;
  for ( wait = 0; wait < 900; ++wait )
  {
    Get_Keys();
    if ( Key_Held & 0x8000 )
    {
      Call_Escape_Ret = Call_On_Escape(hWnd);
      if ( !Call_Escape_Ret )
        return 0;
      if ( Call_Escape_Ret == 2 )
        return 2;
    }
    if ( mode )
    {
      if ( mode == 1 )
      {
        if ( wait >= 350 )
        {
          if ( wait >= 500 )
          {
            if ( wait >= 600 )
            {
              if ( wait == 750 )
                wait = 900;
            }
            else
            {
              Sprite.Y_Pos += 12;
            }
          }
          else
          {
            Sprite.Y_Pos += 25;
          }
        }
        else
        {
          Sprite.Y_Pos += 51;
        }
      }
    }
    else
    {
      Sprite.Y_Pos += 51;
    }
    Draw_Color_Fill(&rect, 0);
    Draw_Bitmap_With_Transparency(&Rect_Frame, 80, 80, &Rect_Sky, 21);
    Draw_Bitmap_With_Transparency(&Rect_Frame, Sprite.X_Pos / 512 - 20, Sprite.Y_Pos / 512 - 12, &Rect_Sprite, 21);
    Draw_Bitmap_With_Transparency(&Rect_Frame, 80, 128, &Rect_Ground, 21);
    Draw_Nikamaru_Timer(16, 8);
    Display_FPS_Counter();
    if ( !Draw_Window(hWnd) )
      return 0;
  }
  return 1;
}
// 49E210: using guessed type int Key_Held;

//----- (0040DD70) --------------------------------------------------------
// Called On Esc
int __cdecl Call_On_Escape(HWND hWnd)
{
  RECT Src_Rects; // [sp+0h] [bp-10h]@1

  Src_Rects.left = 0;
  Src_Rects.top = 128;
  Src_Rects.right = 208;
  Src_Rects.bottom = 144;
  do
  {
    Get_Keys();
    if ( Key_Pressed & 0x8000 )
    {
      Key_Pressed = 0;
      return 0;
    }
    if ( Key_Pressed & 0x400 )
    {
      Key_Pressed = 0;
      return 1;
    }
    if ( Key_Pressed & 0x800 )
    {
      Key_Pressed = 0;
      return 2;
    }
    Draw_Color_Fill(&rect, 0);
    Draw_Bitmap_With_Transparency(&rect, 56, 112, &Src_Rects, 26);
    Display_FPS_Counter();
  }
  while ( Draw_Window(hWnd) );
  Key_Pressed = 0;
  return 0;
}
// 49E214: using guessed type int Key_Pressed;

//----- (0040DE60) --------------------------------------------------------
void __cdecl Init_Fade()
{
  memset(&Fade_Obj, 0, 0x268u);
  Mask_Color = (int)Make_RGB(0x200000u);
}

//----- (0040DEA0) --------------------------------------------------------
void Reset_Fade_Vars()
{
  Fade_Obj.bMask = 0;
  Fade_Obj.mode = 0;
}

//----- (0040DEC0) --------------------------------------------------------
void __cdecl Start_Fade_Out(char Direction)
{
  signed int j; // [sp+0h] [bp-8h]@3
  signed int i; // [sp+4h] [bp-4h]@1

  Fade_Obj.mode = 2;
  Fade_Obj.count = 0;
  Fade_Obj.Direction = Direction;
  Fade_Obj.bMask = 0;
  for ( i = 0; i < 15; ++i )
  {
    for ( j = 0; j < 20; ++j )
    {
      Fade_Obj.ani_no[i][j] = 0;
      Fade_Obj.flag[i][j] = 0;
    }
  }
}

//----- (0040DF50) --------------------------------------------------------
void __cdecl Start_Fade_In(char Direction)
{
  signed int j; // [sp+0h] [bp-8h]@3
  signed int i; // [sp+4h] [bp-4h]@1

  Fade_Obj.mode = 1;
  Fade_Obj.count = 0;
  Fade_Obj.Direction = Direction;
  Fade_Obj.bMask = 1;
  for ( i = 0; i < 15; ++i )
  {
    for ( j = 0; j < 20; ++j )
    {
      Fade_Obj.ani_no[i][j] = 15;
      Fade_Obj.flag[i][j] = 0;
    }
  }
}

//----- (0040DFE0) --------------------------------------------------------
void __cdecl Process_Fade()
{
  signed int x; // [sp+Ch] [bp-8h]@6
  signed int xa; // [sp+Ch] [bp-8h]@15
  signed int xb; // [sp+Ch] [bp-8h]@24
  signed int xc; // [sp+Ch] [bp-8h]@33
  signed int xd; // [sp+Ch] [bp-8h]@42
  signed int xe; // [sp+Ch] [bp-8h]@50
  signed int xf; // [sp+Ch] [bp-8h]@58
  signed int xg; // [sp+Ch] [bp-8h]@66
  signed int xr; // [sp+Ch] [bp-8h]@74
  signed int xi; // [sp+Ch] [bp-8h]@87
  signed int xj; // [sp+Ch] [bp-8h]@96
  signed int xk; // [sp+Ch] [bp-8h]@105
  signed int xl; // [sp+Ch] [bp-8h]@114
  signed int xm; // [sp+Ch] [bp-8h]@123
  signed int xn; // [sp+Ch] [bp-8h]@131
  signed int xo; // [sp+Ch] [bp-8h]@139
  signed int xp; // [sp+Ch] [bp-8h]@147
  signed int xq; // [sp+Ch] [bp-8h]@155
  signed int y; // [sp+10h] [bp-4h]@4
  signed int ya; // [sp+10h] [bp-4h]@13
  signed int yb; // [sp+10h] [bp-4h]@22
  signed int yc; // [sp+10h] [bp-4h]@31
  signed int yd; // [sp+10h] [bp-4h]@40
  signed int ye; // [sp+10h] [bp-4h]@48
  signed int yf; // [sp+10h] [bp-4h]@56
  signed int yg; // [sp+10h] [bp-4h]@64
  signed int yr; // [sp+10h] [bp-4h]@72
  signed int yi; // [sp+10h] [bp-4h]@85
  signed int yj; // [sp+10h] [bp-4h]@94
  signed int yk; // [sp+10h] [bp-4h]@103
  signed int yl; // [sp+10h] [bp-4h]@112
  signed int ym; // [sp+10h] [bp-4h]@121
  signed int yn; // [sp+10h] [bp-4h]@129
  signed int yo; // [sp+10h] [bp-4h]@137
  signed int yp; // [sp+10h] [bp-4h]@145
  signed int yq; // [sp+10h] [bp-4h]@153

  if ( Fade_Obj.mode == 1 )
  {
    Fade_Obj.bMask = 0;
    switch ( Fade_Obj.Direction )
    {
      case 0:
        for ( yi = 0; yi < 15; ++yi )
        {
          for ( xi = 0; xi < 20; ++xi )
          {
            if ( 19 - Fade_Obj.count == xi )
              Fade_Obj.flag[yi][xi] = 1;
          }
        }
        break;
      case 2:
        for ( yj = 0; yj < 15; ++yj )
        {
          for ( xj = 0; xj < 20; ++xj )
          {
            if ( Fade_Obj.count == xj )
              Fade_Obj.flag[yj][xj] = 1;
          }
        }
        break;
      case 1:
        for ( yk = 0; yk < 15; ++yk )
        {
          for ( xk = 0; xk < 20; ++xk )
          {
            if ( 14 - Fade_Obj.count == yk )
              Fade_Obj.flag[yk][xk] = 1;
          }
        }
        break;
      case 3:
        for ( yl = 0; yl < 15; ++yl )
        {
          for ( xl = 0; xl < 20; ++xl )
          {
            if ( Fade_Obj.count == yl )
              Fade_Obj.flag[yl][xl] = 1;
          }
        }
        break;
      case 4:
        for ( ym = 0; ym < 7; ++ym )
        {
          for ( xm = 0; xm < 10; ++xm )
          {
            if ( 19 - Fade_Obj.count == ym + xm )
              Fade_Obj.flag[ym][xm] = 1;
          }
        }
        for ( yn = 0; yn < 7; ++yn )
        {
          for ( xn = 10; xn < 20; ++xn )
          {
            if ( 19 - Fade_Obj.count == yn + 19 - xn )
              Fade_Obj.flag[yn][xn] = 1;
          }
        }
        for ( yo = 7; yo < 15; ++yo )
        {
          for ( xo = 0; xo < 10; ++xo )
          {
            if ( 19 - Fade_Obj.count == xo + 14 - yo )
              Fade_Obj.flag[yo][xo] = 1;
          }
        }
        for ( yp = 7; yp < 15; ++yp )
        {
          for ( xp = 10; xp < 20; ++xp )
          {
            if ( 19 - Fade_Obj.count == 14 - yp + 19 - xp )
              Fade_Obj.flag[yp][xp] = 1;
          }
        }
        break;
      default:
        break;
    }
    for ( yq = 0; yq < 15; ++yq )
    {
      for ( xq = 0; xq < 20; ++xq )
      {
        if ( Fade_Obj.ani_no[yq][xq] > 0 && Fade_Obj.flag[yq][xq] )
          --Fade_Obj.ani_no[yq][xq];
      }
    }
    if ( ++Fade_Obj.count > 36 )
      Fade_Obj.mode = 0;
  }
  else if ( Fade_Obj.mode == 2 )
  {
    switch ( Fade_Obj.Direction )
    {
      case 0:
        for ( y = 0; y < 15; ++y )
        {
          for ( x = 0; x < 20; ++x )
          {
            if ( 19 - Fade_Obj.count == x )
              Fade_Obj.flag[y][x] = 1;
          }
        }
        break;
      case 2:
        for ( ya = 0; ya < 15; ++ya )
        {
          for ( xa = 0; xa < 20; ++xa )
          {
            if ( Fade_Obj.count == xa )
              Fade_Obj.flag[ya][xa] = 1;
          }
        }
        break;
      case 1:
        for ( yb = 0; yb < 15; ++yb )
        {
          for ( xb = 0; xb < 20; ++xb )
          {
            if ( 14 - Fade_Obj.count == yb )
              Fade_Obj.flag[yb][xb] = 1;
          }
        }
        break;
      case 3:
        for ( yc = 0; yc < 15; ++yc )
        {
          for ( xc = 0; xc < 20; ++xc )
          {
            if ( Fade_Obj.count == yc )
              Fade_Obj.flag[yc][xc] = 1;
          }
        }
        break;
      case 4:
        for ( yd = 0; yd < 7; ++yd )
        {
          for ( xd = 0; xd < 10; ++xd )
          {
            if ( Fade_Obj.count == yd + xd )
              Fade_Obj.flag[yd][xd] = 1;
          }
        }
        for ( ye = 0; ye < 7; ++ye )
        {
          for ( xe = 10; xe < 20; ++xe )
          {
            if ( Fade_Obj.count == ye + 19 - xe )
              Fade_Obj.flag[ye][xe] = 1;
          }
        }
        for ( yf = 7; yf < 15; ++yf )
        {
          for ( xf = 0; xf < 10; ++xf )
          {
            if ( Fade_Obj.count == xf + 14 - yf )
              Fade_Obj.flag[yf][xf] = 1;
          }
        }
        for ( yg = 7; yg < 15; ++yg )
        {
          for ( xg = 10; xg < 20; ++xg )
          {
            if ( Fade_Obj.count == 14 - yg + 19 - xg )
              Fade_Obj.flag[yg][xg] = 1;
          }
        }
        break;
      default:
        break;
    }
    for ( yr = 0; yr < 15; ++yr )
    {
      for ( xr = 0; xr < 20; ++xr )
      {
        if ( Fade_Obj.ani_no[yr][xr] < 15 && Fade_Obj.flag[yr][xr] )
          ++Fade_Obj.ani_no[yr][xr];
      }
    }
    if ( ++Fade_Obj.count > 36 )
    {
      Fade_Obj.bMask = 1;
      Fade_Obj.mode = 0;
    }
  }
}

//----- (0040E770) --------------------------------------------------------
// Render Fade out / Fade in
void Draw_Fade_Out_In()
{
  signed int x; // [sp+0h] [bp-18h]@6
  signed int y; // [sp+4h] [bp-14h]@4
  RECT rect; // [sp+8h] [bp-10h]@1

  rect.top = 0;
  rect.bottom = 16;
  if ( Fade_Obj.bMask )
  {
    Draw_Color_Fill(&Rect_Game, Mask_Color);
  }
  else if ( Fade_Obj.mode )
  {
    for ( y = 0; y < 15; ++y )
    {
      for ( x = 0; x < 20; ++x )
      {
        rect.left = 16 * Fade_Obj.ani_no[y][x];
        rect.right = rect.left + 16;
        Draw_Bitmap_With_Transparency(&Rect_Game, 16 * x, 16 * y, &rect, 6);
      }
    }
  }
}

//----- (0040E830) --------------------------------------------------------
// If fade is happening, returns 1
bool Get_Fade_Mode()
{
  return Fade_Obj.mode != 0;
}

//----- (0040E850) --------------------------------------------------------
void *Clear_Event_Flags()
{
  return memset(Event_Flags, 0, 0x3E8u);
}

//----- (0040E870) --------------------------------------------------------
void *__cdecl InitSkipFlags()
{
  return memset(SkipFlags, 0, 8u);
}

//----- (0040E890) --------------------------------------------------------
void __cdecl Set_NPC_Flag(signed int Flag_Num)
{
  Event_Flags[Flag_Num / 8] |= 1 << Flag_Num % 8;
}

//----- (0040E8E0) --------------------------------------------------------
void __cdecl Unset_NPC_Flag(signed int Flag_To_Unset)
{
  Event_Flags[Flag_To_Unset / 8] &= ~(1 << Flag_To_Unset % 8);
}

//----- (0040E930) --------------------------------------------------------
bool __cdecl Get_NPC_Flag(signed int Flag_hashtag)
{
  return ((1 << Flag_hashtag % 8) & Event_Flags[Flag_hashtag / 8]) != 0;
}

//----- (0040E970) --------------------------------------------------------
void __cdecl Set_Skip_Flag(signed int Flag_To_Set)
{
  SkipFlags[Flag_To_Set / 8] |= 1 << Flag_To_Set % 8;
}

//----- (0040E9C0) --------------------------------------------------------
int __cdecl Unset_Skip_Flag(signed int Flag_To_Unset)
{
  int result; // eax@1

  result = Flag_To_Unset / 8;
  SkipFlags[Flag_To_Unset / 8] &= ~(1 << Flag_To_Unset % 8);
  return result;
}

//----- (0040EA10) --------------------------------------------------------
bool __cdecl Get_SkipFlag(signed int a1)
{
  return ((1 << a1 % 8) & SkipFlags[a1 / 8]) != 0;
}

//----- (0040EA70) --------------------------------------------------------
void __cdecl Start_Flash(int X_Pos, int Y_Pos, int mode)
{
  Flash.act_no = 0;
  Flash.Flash_Flag = 1;
  Flash.X_Pos = X_Pos;
  Flash.Y_Pos = Y_Pos;
  Flash.mode = mode;
  Flash.cnt = 0;
  Flash.width = 0;
}

//----- (0040EAC0) --------------------------------------------------------
int __cdecl Update_Boss_Explosion(int a1, int a2)
{
  int result; // eax@1
  int v3; // [sp+4h] [bp-10h]@4
  int v4; // [sp+4h] [bp-10h]@17
  int v5; // [sp+8h] [bp-Ch]@4
  int v6; // [sp+Ch] [bp-8h]@4
  int v7; // [sp+10h] [bp-4h]@4
  int v8; // [sp+10h] [bp-4h]@19

  result = Flash.act_no;
  if ( Flash.act_no )
  {
    if ( Flash.act_no == 1 )
    {
      Flash.width -= Flash.width / 8;
      if ( !(Flash.width / 256) )
        Flash.Flash_Flag = 0;
      v4 = (Flash.Y_Pos - a2 - Flash.width) / 512;
      if ( v4 < 0 )
        v4 = 0;
      v8 = (Flash.width + Flash.Y_Pos - a2) / 512;
      if ( v8 > 240 )
        v8 = 240;
      Flash.rect1.left = 0;
      Flash.rect1.right = 0;
      Flash.rect1.top = 0;
      Flash.rect1.bottom = 0;
      Flash.rect2.top = v4;
      result = v8;
      Flash.rect2.bottom = v8;
      Flash.rect2.left = 0;
      Flash.rect2.right = 320;
    }
  }
  else
  {
    Flash.cnt += 512;
    Flash.width += Flash.cnt;
    v6 = (Flash.X_Pos - a1 - Flash.width) / 512;
    v3 = (Flash.Y_Pos - a2 - Flash.width) / 512;
    v5 = (Flash.width + Flash.X_Pos - a1) / 512;
    v7 = (Flash.width + Flash.Y_Pos - a2) / 512;
    if ( v6 < 0 )
      v6 = 0;
    if ( v3 < 0 )
      v3 = 0;
    if ( v5 > 320 )
      v5 = 320;
    if ( v7 > 240 )
      v7 = 240;
    Flash.rect1.left = v6;
    Flash.rect1.right = v5;
    Flash.rect1.top = 0;
    Flash.rect1.bottom = 240;
    Flash.rect2.left = 0;
    Flash.rect2.right = 320;
    Flash.rect2.top = v3;
    result = v7;
    Flash.rect2.bottom = v7;
    if ( Flash.width > 655360 )
    {
      Flash.act_no = 1;
      Flash.cnt = 0;
      Flash.width = 122880;
    }
  }
  return result;
}

//----- (0040ED20) --------------------------------------------------------
int TSC_FLA_Handler()
{
  int result; // eax@1

  ++Flash.cnt;
  Flash.rect1.left = 0;
  Flash.rect1.right = 0;
  Flash.rect1.top = 0;
  Flash.rect1.bottom = 0;
  result = Flash.cnt / 2 % 2;
  if ( result )
  {
    Flash.rect2.top = 0;
    Flash.rect2.bottom = 240;
    Flash.rect2.left = 0;
    Flash.rect2.right = 320;
  }
  else
  {
    Flash.rect2.left = 0;
    Flash.rect2.right = 0;
    Flash.rect2.top = 0;
    Flash.rect2.bottom = 0;
  }
  if ( Flash.cnt > 20 )
    Flash.Flash_Flag = 0;
  return result;
}

//----- (0040EDE0) --------------------------------------------------------
int __cdecl Main_WhiteScreen_Handler(int a1, int a2)
{
  int result; // eax@2

  if ( Flash.Flash_Flag )
  {
    result = Flash.mode;
    if ( Flash.mode == 1 )
    {
      result = Update_Boss_Explosion(a1, a2);
    }
    else if ( Flash.mode == 2 )
    {
      result = TSC_FLA_Handler();
    }
  }
  return result;
}

//----- (0040EE20) --------------------------------------------------------
void Draw_Boss_Explosion()
{
  if ( Flash.Flash_Flag )
  {
    Draw_Color_Fill(&Flash.rect1, FlashColor);
    Draw_Color_Fill(&Flash.rect2, FlashColor);
  }
}

//----- (0040EE70) --------------------------------------------------------
// The camera code. Handles quakes.
void __cdecl Update_Camera()
{
  __int16 a2; // [sp+0h] [bp-8h]@1
  __int16 a3; // [sp+4h] [bp-4h]@1

  Get_Map_Data(NULL, &a2, &a3);
  Camera.X_Pos += (*Camera.Target_X - 81920 - Camera.X_Pos) / Camera.Move_Ticks;
  Camera.Y_Pos += (*Camera.Target_Y - 61440 - Camera.Y_Pos) / Camera.Move_Ticks;
  if ( Camera.X_Pos / 512 < 0 )
    Camera.X_Pos = 0;
  if ( Camera.Y_Pos / 512 < 0 )
    Camera.Y_Pos = 0;
  if ( Camera.X_Pos > (16 * (a2 - 1) - 320) << 9 )
    Camera.X_Pos = (16 * (a2 - 1) - 320) << 9;
  if ( Camera.Y_Pos > (16 * (a3 - 1) - 240) << 9 )
    Camera.Y_Pos = (16 * (a3 - 1) - 240) << 9;
  if ( Camera.HardQuakeDuration )               // If there is still time remaining to the hard quake
  {
    Camera.X_Pos += Random(-5, 5) << 9;
    Camera.Y_Pos += Random(-3, 3) << 9;
    --Camera.HardQuakeDuration;
  }
  else if ( Camera.SoftQuakeDuration )          // If there is still time to the soft quake
  {
    Camera.X_Pos += Random(-1, 1) << 9;
    Camera.Y_Pos += Random(-1, 1) << 9;
    --Camera.SoftQuakeDuration;
  }
}

//----- (0040F020) --------------------------------------------------------
void __cdecl Get_Camera_Position(int *a1, int *a2)
{
  *a1 = Camera.X_Pos;
  *a2 = Camera.Y_Pos;
}

//----- (0040F040) --------------------------------------------------------
// Unused
int __cdecl Camera_Update(signed int a1, int arg4)
{
  int result; // eax@7
  _WORD a2[2]; // [sp+0h] [bp-8h]@1
  _WORD a3[2]; // [sp+4h] [bp-4h]@1

  Camera.SoftQuakeDuration = 0;
  Camera.HardQuakeDuration = 0;
  Get_Map_Data(NULL, a2, a3);
  Camera.X_Pos = a1;
  Camera.Y_Pos = arg4;
  if ( a1 / 512 < 0 )
    Camera.X_Pos = 0;
  if ( Camera.Y_Pos / 512 < 0 )
    Camera.Y_Pos = 0;
  if ( Camera.X_Pos > (16 * ((signed __int16)a2[0] - 1) - 320) << 9 )
    Camera.X_Pos = (16 * ((signed __int16)a2[0] - 1) - 320) << 9;
  result = (16 * ((signed __int16)a3[0] - 1) - 240) << 9;
  if ( Camera.Y_Pos > result )
    Camera.Y_Pos = (16 * ((signed __int16)a3[0] - 1) - 240) << 9;
  return result;
}

//----- (0040F130) --------------------------------------------------------
void __cdecl Set_Camera_Quote()
{
  int Quote_Y_Pos; // [sp+0h] [bp-10h]@1
  int Quote_X_Pos; // [sp+4h] [bp-Ch]@1
  signed __int16 Current_Map_Width; // [sp+8h] [bp-8h]@1
  signed __int16 Current_Map_Length; // [sp+Ch] [bp-4h]@1

  Get_Quote_Pos(&Quote_X_Pos, &Quote_Y_Pos);
  Get_Map_Data(NULL, &Current_Map_Width, &Current_Map_Length);
  Camera.X_Pos = Quote_X_Pos - 81920;
  Camera.Y_Pos = Quote_Y_Pos - 61440;
  if ( (Quote_X_Pos - 81920) / 512 < 0 )
    Camera.X_Pos = 0;
  if ( Camera.Y_Pos / 512 < 0 )
    Camera.Y_Pos = 0;
  if ( Camera.X_Pos > (16 * (Current_Map_Width - 1) - 320) << 9 )
    Camera.X_Pos = (16 * (Current_Map_Width - 1) - 320) << 9;
  if ( Camera.Y_Pos > (16 * (Current_Map_Length - 1) - 240) << 9 )
    Camera.Y_Pos = (16 * (Current_Map_Length - 1) - 240) << 9;
}

//----- (0040F220) --------------------------------------------------------
// Sets camera move ticks
void __cdecl Set_Camera_Target_Quote(int Ticks)
{
  Camera.Target_X = &Quote.Camera_X_Pos;
  Camera.Target_Y = &Quote.Camera_Y_Pos;
  Camera.Move_Ticks = Ticks;
}

//----- (0040F250) --------------------------------------------------------
void __cdecl Set_Camera_Move_Ticks(int event, int Move_Ticks)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512 && NPC_Objects[i].Entity_Eve_Num != event; ++i )
    ;
  if ( i != 512 )
  {
    Camera.Target_X = &NPC_Objects[i].X_pos;
    Camera.Target_Y = &NPC_Objects[i].Y_pos;
    Camera.Move_Ticks = Move_Ticks;
  }
}

//----- (0040F2D0) --------------------------------------------------------
// FON : Focus camera On NPC
int *__cdecl TSC_FOB(int a1, int a2)
{
  int *result; // eax@1

  result = &Boss_Objects[a1].X_pos;
  Camera.Target_X = &Boss_Objects[a1].X_pos;
  Camera.Target_Y = &Boss_Objects[a1].Y_pos;
  Camera.Move_Ticks = a2;
  return result;
}

//----- (0040F310) --------------------------------------------------------
// QUA : Set Soft QUAke Duration
void __cdecl Set_Quake(int Duration)
{
  Camera.SoftQuakeDuration = Duration;
}

//----- (0040F320) --------------------------------------------------------
void __cdecl Set_Hard_Quake_Duration(int Duration)
{
  Camera.HardQuakeDuration = Duration;
}

//----- (0040F330) --------------------------------------------------------
void Reset_Quake()
{
  Camera.SoftQuakeDuration = 0;
  Camera.HardQuakeDuration = 0;
}

//----- (0040F350) --------------------------------------------------------
// Creates random number in given range
int __cdecl Random(signed int Minimum, signed int Maximum)
{
  return Minimum + rand() % (Maximum - Minimum + 1);
}

//----- (0040F380) --------------------------------------------------------
void __cdecl Draw_Numbers(int X_Position, int Y_Position, int Numbers_To_Display, int Number_Of_Digits)
{
  RECT rcView; // [sp+0h] [bp-D0h]@1
  int v5; // [sp+10h] [bp-C0h]@3
  int i; // [sp+14h] [bp-BCh]@3
  int Rects; // [sp+18h] [bp-B8h]@1
  int v8; // [sp+1Ch] [bp-B4h]@1
  int v9; // [sp+20h] [bp-B0h]@1
  int v10; // [sp+24h] [bp-ACh]@1
  int v11; // [sp+28h] [bp-A8h]@1
  int v12; // [sp+2Ch] [bp-A4h]@1
  int v13; // [sp+30h] [bp-A0h]@1
  int v14; // [sp+34h] [bp-9Ch]@1
  int v15; // [sp+38h] [bp-98h]@1
  int v16; // [sp+3Ch] [bp-94h]@1
  int v17; // [sp+40h] [bp-90h]@1
  int v18; // [sp+44h] [bp-8Ch]@1
  int v19; // [sp+48h] [bp-88h]@1
  int v20; // [sp+4Ch] [bp-84h]@1
  int v21; // [sp+50h] [bp-80h]@1
  int v22; // [sp+54h] [bp-7Ch]@1
  int v23; // [sp+58h] [bp-78h]@1
  int v24; // [sp+5Ch] [bp-74h]@1
  int v25; // [sp+60h] [bp-70h]@1
  int v26; // [sp+64h] [bp-6Ch]@1
  int v27; // [sp+68h] [bp-68h]@1
  int v28; // [sp+6Ch] [bp-64h]@1
  int v29; // [sp+70h] [bp-60h]@1
  int v30; // [sp+74h] [bp-5Ch]@1
  int v31; // [sp+78h] [bp-58h]@1
  int v32; // [sp+7Ch] [bp-54h]@1
  int v33; // [sp+80h] [bp-50h]@1
  int v34; // [sp+84h] [bp-4Ch]@1
  int v35; // [sp+88h] [bp-48h]@1
  int v36; // [sp+8Ch] [bp-44h]@1
  int v37; // [sp+90h] [bp-40h]@1
  int v38; // [sp+94h] [bp-3Ch]@1
  int v39; // [sp+98h] [bp-38h]@1
  int v40; // [sp+9Ch] [bp-34h]@1
  int v41; // [sp+A0h] [bp-30h]@1
  int v42; // [sp+A4h] [bp-2Ch]@1
  int v43; // [sp+A8h] [bp-28h]@1
  int v44; // [sp+ACh] [bp-24h]@1
  int v45; // [sp+B0h] [bp-20h]@1
  int v46; // [sp+B4h] [bp-1Ch]@1
  int v47; // [sp+BCh] [bp-14h]@5
  int v48; // [sp+C0h] [bp-10h]@1
  int v49; // [sp+C4h] [bp-Ch]@1
  int v50; // [sp+C8h] [bp-8h]@1
  int v51; // [sp+CCh] [bp-4h]@1

  rcView.left = 0;
  rcView.top = 0;
  rcView.right = 320;
  rcView.bottom = 240;
  Rects = 0;
  v8 = 56;
  v9 = 8;
  v10 = 64;
  v11 = 8;
  v12 = 56;
  v13 = 16;
  v14 = 64;
  v15 = 16;
  v16 = 56;
  v17 = 24;
  v18 = 64;
  v19 = 24;
  v20 = 56;
  v21 = 32;
  v22 = 64;
  v23 = 32;
  v24 = 56;
  v25 = 40;
  v26 = 64;
  v27 = 40;
  v28 = 56;
  v29 = 48;
  v30 = 64;
  v31 = 48;
  v32 = 56;
  v33 = 56;
  v34 = 64;
  v35 = 56;
  v36 = 56;
  v37 = 64;
  v38 = 64;
  v39 = 64;
  v40 = 56;
  v41 = 72;
  v42 = 64;
  v43 = 72;
  v44 = 56;
  v45 = 80;
  v46 = 64;
  v48 = 1000;
  v49 = 100;
  v50 = 10;
  v51 = 1;
  if ( Numbers_To_Display > 9999 )
    Numbers_To_Display = 9999;
  i = 0;
  v5 = 0;
  while ( i < 4 )
  {
    v47 = 0;
    while ( Numbers_To_Display >= *(&v48 + i) )
    {
      Numbers_To_Display -= *(&v48 + i);
      ++v47;
      ++v5;
    }
    if ( Number_Of_Digits && i == 2 || v5 || i == 3 )
      Draw_Bitmap_With_Transparency(&rcView, X_Position + 8 * i, Y_Position, (RECT *)&Rects + v47, 26);
    ++i;
  }
}

//----- (0040F5F0) --------------------------------------------------------
// Updating game window, maintaining game loop, etc
int __cdecl Game_Loop_Selector(HWND hWnd)
{
  int result; // eax@2
  const CHAR FileName; // [sp+0h] [bp-110h]@3
  int mode; // [sp+10Ch] [bp-4h]@5

  if ( !Load_Initial_Resources() )
  {
    MessageBoxA(hWnd, "pt@C", "G[", 0);
    result = 0;
  }
  else
  {
    Play_Sound_Effect(Sfx_Silence_73, -1);
    sprintf((char *)&FileName, "%s\\npc.tbl", dataPath);
    if ( !LoadNPCTable((char *)&FileName) )
    {
      MessageBoxA(hWnd, "NPCe[u", "G[", 0);// Loading unsuccesful
      result = 0;
    }
    else
    {
      Init_TSC();
      InitSkipFlags();
      Init_Map_Data();
      InitCreditScript();
      mode = 1;
      while ( mode )
      {
        if ( mode == 1 )
          mode = Game_Mode_Opening_Cutscene();
        if ( mode == 2 )
          mode = Game_Loop_Title_Screen();
        if ( mode == 3 )
          mode = Game_Loop_Main_Game(hWnd);
      }
      Play_Sound_Effect(Sfx_Silence_73, 0);
      Kill_Level_Layout();
      End_TSC_Script();
      Free_NPC_Table();
      Release_Credit_Script();
      if ( !Is_Fullscreen )
        Save_Window_Rect_File(hWnd, (int)"window.rect");
      result = 1;
    }
  }
  return result;
}
// 49E460: using guessed type int Is_Fullscreen;

//----- (0040F730) --------------------------------------------------------
signed int Game_Mode_Opening_Cutscene()
{
  int TSC_Parser_Ret; // [sp+0h] [bp-14h]@10
  int v2; // [sp+4h] [bp-10h]@4
  int Camera_Y; // [sp+8h] [bp-Ch]@10
  unsigned int Title_Cutscene_Timer; // [sp+Ch] [bp-8h]@1
  int Camera_X; // [sp+10h] [bp-4h]@10

  Init_NPCs();
  Init_Effects();
  Init_Whimsical_Star();
  Init_Fade();
  Init_Flash();
  Init_Boss_Life();
  Change_Music(Mus_Silence);
  Transfer_Stage(72, 100, 3, 3);
  Set_Camera_Target_Quote(16);
  Set_Fade_Mask_();
  Rect_Game.left = 0;
  Game_Flags = 3;
  Cut_Noise();
  Title_Cutscene_Timer = 0;
  while ( Title_Cutscene_Timer < 0x1F4 )
  {
    ++Title_Cutscene_Timer;
    Get_Keys();
    if ( Key_Held & 0x8000 )
    {
      v2 = Call_On_Escape(AppWinHandle);
      if ( !v2 )
        return 0;
      if ( v2 == 2 )
        return 1;
    }
    if ( Key_Ok & Key_Held )
      break;
    Update_NPCs();
    Update_Boss();
    Update_Background();
    Reset_Quote_Collision_Flags();
    Do_Collision_Check_Player_Map();
    Do_Collision_Check_Player_NPCs();
    Do_Collision_Check_Player_Bosses();
    Do_Collision_Check_NPCs_Map();
    Do_Collision_Check_Bosses_Map();
    Do_Collision_Check_Bosses_Bullets();
    Update_Effects();
    Update_Camera();
    Process_Fade();
    Draw_Color_Fill(&rect, 0);
    Get_Camera_Position(&Camera_X, &Camera_Y);
    Draw_Background(Camera_X, Camera_Y);
    Draw_Stage_Background(Camera_X, Camera_Y);
    Draw_Boss(Camera_X, Camera_Y);
    Draw_NPCs(Camera_X, Camera_Y);
    Draw_Map_Data_Vector(Camera_X, Camera_Y);
    Draw_Stage_Foreground(Camera_X, Camera_Y);
    Draw_Foreground(Camera_X, Camera_Y);
    Draw_Effects(Camera_X, Camera_Y);
    Draw_Fade_Out_In();
    TSC_Parser_Ret = TSC_Parser();
    if ( !TSC_Parser_Ret )
      return 0;
    if ( TSC_Parser_Ret == 2 )
      return 1;
    Draw_Map_Name(0);
    Draw_Text_Box();
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
    ++GameTime;
  }
  Title_Cutscene_Timer = GetTickCount();
  while ( GetTickCount() < Title_Cutscene_Timer + 500 )
  {
    Draw_Color_Fill(&Rect_Game, 0);
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  return 2;
}
// 493628: using guessed type int Key_Ok;
// 49E1E8: using guessed type int Game_Flags;
// 49E1EC: using guessed type int GameTime;
// 49E210: using guessed type int Key_Held;

//----- (0040F9B0) --------------------------------------------------------
signed int Game_Loop_Title_Screen()
{
  int *v1; // edx@39
  int *v2; // edx@40
  int *v3; // edx@41
  int *v4; // edx@42
  int *v5; // edx@43
  int v6; // [sp+4h] [bp-1ECh]@29
  int Quote_Frame_A_1; // [sp+8h] [bp-1E8h]@1
  int Quote_Frame_A_2; // [sp+Ch] [bp-1E4h]@1
  int Quote_Frame_A_3; // [sp+10h] [bp-1E0h]@1
  int Quote_Frame_A_4; // [sp+14h] [bp-1DCh]@1
  int Quote_Frame_B_1; // [sp+18h] [bp-1D8h]@1
  int Quote_Frame_B_2; // [sp+1Ch] [bp-1D4h]@1
  int Quote_Frame_B_3; // [sp+20h] [bp-1D0h]@1
  int Quote_Frame_B_4; // [sp+24h] [bp-1CCh]@1
  int Quote_Frame_C_1; // [sp+28h] [bp-1C8h]@1
  int Quote_Frame_C_2; // [sp+2Ch] [bp-1C4h]@1
  int Quote_Frame_C_3; // [sp+30h] [bp-1C0h]@1
  int Quote_Frame_C_4; // [sp+34h] [bp-1BCh]@1
  int Quote_Frame_D_1; // [sp+38h] [bp-1B8h]@1
  int Quote_Frame_D_2; // [sp+3Ch] [bp-1B4h]@1
  int Quote_Frame_D_3; // [sp+40h] [bp-1B0h]@1
  int Quote_Frame_D_4; // [sp+44h] [bp-1ACh]@1
  int Sue_Frame_A_1; // [sp+48h] [bp-1A8h]@1
  int Sue_Frame_A_2; // [sp+4Ch] [bp-1A4h]@1
  int Sue_Frame_A_3; // [sp+50h] [bp-1A0h]@1
  int Sue_Frame_A_4; // [sp+54h] [bp-19Ch]@1
  int Sue_Frame_B_1; // [sp+58h] [bp-198h]@1
  int Sue_Frame_B_2; // [sp+5Ch] [bp-194h]@1
  int Sue_Frame_B_3; // [sp+60h] [bp-190h]@1
  int Sue_Frame_B_4; // [sp+64h] [bp-18Ch]@1
  int Sue_Frame_C_1; // [sp+68h] [bp-188h]@1
  int Sue_Frame_C_2; // [sp+6Ch] [bp-184h]@1
  int Sue_Frame_C_3; // [sp+70h] [bp-180h]@1
  int Sue_Frame_C_4; // [sp+74h] [bp-17Ch]@1
  int Sue_Frame_D_1; // [sp+78h] [bp-178h]@1
  int Sue_Frame_D_2; // [sp+7Ch] [bp-174h]@1
  int Sue_Frame_D_3; // [sp+80h] [bp-170h]@1
  int Sue_Frame_D_4; // [sp+84h] [bp-16Ch]@1
  int Hell_Time; // [sp+8Ch] [bp-164h]@1
  int Toroko_Frame_A_1; // [sp+90h] [bp-160h]@1
  int Toroko_Frame_A_2; // [sp+94h] [bp-15Ch]@1
  int Toroko_Frame_A_3; // [sp+98h] [bp-158h]@1
  int Toroko_Frame_A_4; // [sp+9Ch] [bp-154h]@1
  int Toroko_Frame_B_1; // [sp+A0h] [bp-150h]@1
  int Toroko_Frame_B_2; // [sp+A4h] [bp-14Ch]@1
  int Toroko_Frame_B_3; // [sp+A8h] [bp-148h]@1
  int Toroko_Frame_B_4; // [sp+ACh] [bp-144h]@1
  int Toroko_Frame_C_1; // [sp+B0h] [bp-140h]@1
  int Toroko_Frame_C_2; // [sp+B4h] [bp-13Ch]@1
  int Toroko_Frame_C_3; // [sp+B8h] [bp-138h]@1
  int Toroko_Frame_C_4; // [sp+BCh] [bp-134h]@1
  int Toroko_Frame_D_1; // [sp+C0h] [bp-130h]@1
  int Toroko_Frame_D_2; // [sp+C4h] [bp-12Ch]@1
  int Toroko_Frame_D_3; // [sp+C8h] [bp-128h]@1
  int Toroko_Frame_D_4; // [sp+CCh] [bp-124h]@1
  int Title_Screen_Music; // [sp+D4h] [bp-11Ch]@1
  unsigned int v57; // [sp+D8h] [bp-118h]@22
  int Studio_Pixel_Text_Frame_1; // [sp+DCh] [bp-114h]@1
  int Studio_Pixel_Text_Frame_2; // [sp+E0h] [bp-110h]@1
  int Studio_Pixel_Text_Frame_3; // [sp+E4h] [bp-10Ch]@1
  int Studio_Pixel_Text_Frame_4; // [sp+E8h] [bp-108h]@1
  RECT rect; // [sp+ECh] [bp-104h]@39
  int YPos; // [sp+FCh] [bp-F4h]@45
  int Unknown_Frame_1; // [sp+100h] [bp-F0h]@1
  int Unknown_Frame_2; // [sp+104h] [bp-ECh]@1
  int Unknown_Frame_3; // [sp+108h] [bp-E8h]@1
  int Unknown_Frame_4; // [sp+10Ch] [bp-E4h]@1
  int Curly_Frame_A_1; // [sp+110h] [bp-E0h]@1
  int Curly_Frame_A_2; // [sp+114h] [bp-DCh]@1
  int Curly_Frame_A_3; // [sp+118h] [bp-D8h]@1
  int Curly_Frame_A_4; // [sp+11Ch] [bp-D4h]@1
  int Curly_Frame_B_1; // [sp+120h] [bp-D0h]@1
  int Curly_Frame_B_2; // [sp+124h] [bp-CCh]@1
  int Curly_Frame_B_3; // [sp+128h] [bp-C8h]@1
  int Curly_Frame_B_4; // [sp+12Ch] [bp-C4h]@1
  int Curly_Frame_C_1; // [sp+130h] [bp-C0h]@1
  int Curly_Frame_C_2; // [sp+134h] [bp-BCh]@1
  int Curly_Frame_C_3; // [sp+138h] [bp-B8h]@1
  int Curly_Frame_C_4; // [sp+13Ch] [bp-B4h]@1
  int Curly_Frame_D_1; // [sp+140h] [bp-B0h]@1
  int Curly_Frame_D_2; // [sp+144h] [bp-ACh]@1
  int Curly_Frame_D_3; // [sp+148h] [bp-A8h]@1
  int Curly_Frame_D_4; // [sp+14Ch] [bp-A4h]@1
  int v84; // [sp+154h] [bp-9Ch]@1
  int Version_Dots_Frame_1; // [sp+158h] [bp-98h]@1
  int Version_Dots_Frame_2; // [sp+15Ch] [bp-94h]@1
  int Version_Dots_Frame_3; // [sp+160h] [bp-90h]@1
  int Version_Dots_Frame_4; // [sp+164h] [bp-8Ch]@1
  int King_Frame_A_1; // [sp+168h] [bp-88h]@1
  int King_Frame_A_2; // [sp+16Ch] [bp-84h]@1
  int King_Frame_A_3; // [sp+170h] [bp-80h]@1
  int King_Frame_A_4; // [sp+174h] [bp-7Ch]@1
  int King_Frame_B_1; // [sp+178h] [bp-78h]@1
  int King_Frame_B_2; // [sp+17Ch] [bp-74h]@1
  int King_Frame_B_3; // [sp+180h] [bp-70h]@1
  int King_Frame_B_4; // [sp+184h] [bp-6Ch]@1
  int King_Frame_C_1; // [sp+188h] [bp-68h]@1
  int King_Frame_C_2; // [sp+18Ch] [bp-64h]@1
  int King_Frame_C_3; // [sp+190h] [bp-60h]@1
  int King_Frame_C_4; // [sp+194h] [bp-5Ch]@1
  int King_Frame_D_1; // [sp+198h] [bp-58h]@1
  int King_Frame_D_2; // [sp+19Ch] [bp-54h]@1
  int King_Frame_D_3; // [sp+1A0h] [bp-50h]@1
  int King_Frame_D_4; // [sp+1A4h] [bp-4Ch]@1
  int v105; // [sp+1A8h] [bp-48h]@1
  int v106; // [sp+1ACh] [bp-44h]@1
  int Mask_Color; // [sp+1B0h] [bp-40h]@1
  int GraphicsID; // [sp+1B4h] [bp-3Ch]@39
  int Version_Text_Frame_1; // [sp+1B8h] [bp-38h]@1
  int Version_Text_Frame_2; // [sp+1BCh] [bp-34h]@1
  int Version_Text_Frame_3; // [sp+1C0h] [bp-30h]@1
  int Version_Text_Frame_4; // [sp+1C4h] [bp-2Ch]@1
  int Numbers_To_Display; // [sp+1C8h] [bp-28h]@1
  int v114; // [sp+1CCh] [bp-24h]@1
  int Title_Screen_Frame_1; // [sp+1D0h] [bp-20h]@1
  int Title_Screen_Frame_2; // [sp+1D4h] [bp-1Ch]@1
  int Title_Screen_Frame_3; // [sp+1D8h] [bp-18h]@1
  int Title_Screen_Frame_4; // [sp+1DCh] [bp-14h]@1
  int Continue_Button_Frame_1; // [sp+1E0h] [bp-10h]@1
  int Continue_Button_Frame_2; // [sp+1E4h] [bp-Ch]@1
  int Continue_Button_Frame_3; // [sp+1E8h] [bp-8h]@1
  int Continue_Button_Frame_4; // [sp+1ECh] [bp-4h]@1

  Title_Screen_Frame_1 = 0;
  Title_Screen_Frame_2 = 0;
  Title_Screen_Frame_3 = 144;
  Title_Screen_Frame_4 = 40;
  Studio_Pixel_Text_Frame_1 = 0;
  Studio_Pixel_Text_Frame_2 = 0;
  Studio_Pixel_Text_Frame_3 = 160;
  Studio_Pixel_Text_Frame_4 = 16;
  Unknown_Frame_1 = 144;
  Unknown_Frame_2 = 0;
  Unknown_Frame_3 = 192;
  Unknown_Frame_4 = 16;
  Continue_Button_Frame_1 = 144;
  Continue_Button_Frame_2 = 16;
  Continue_Button_Frame_3 = 192;
  Continue_Button_Frame_4 = 32;
  Version_Text_Frame_1 = 152;
  Version_Text_Frame_2 = 80;
  Version_Text_Frame_3 = 208;
  Version_Text_Frame_4 = 88;
  Version_Dots_Frame_1 = 152;
  Version_Dots_Frame_2 = 88;
  Version_Dots_Frame_3 = 208;
  Version_Dots_Frame_4 = 96;
  Quote_Frame_A_1 = 0;
  Quote_Frame_A_2 = 16;
  Quote_Frame_A_3 = 16;
  Quote_Frame_A_4 = 32;
  Quote_Frame_B_1 = 16;
  Quote_Frame_B_2 = 16;
  Quote_Frame_B_3 = 32;
  Quote_Frame_B_4 = 32;
  Quote_Frame_C_1 = 0;
  Quote_Frame_C_2 = 16;
  Quote_Frame_C_3 = 16;
  Quote_Frame_C_4 = 32;
  Quote_Frame_D_1 = 32;
  Quote_Frame_D_2 = 16;
  Quote_Frame_D_3 = 48;
  Quote_Frame_D_4 = 32;
  Curly_Frame_A_1 = 0;
  Curly_Frame_A_2 = 112;
  Curly_Frame_A_3 = 16;
  Curly_Frame_A_4 = 128;
  Curly_Frame_B_1 = 16;
  Curly_Frame_B_2 = 112;
  Curly_Frame_B_3 = 32;
  Curly_Frame_B_4 = 128;
  Curly_Frame_C_1 = 0;
  Curly_Frame_C_2 = 112;
  Curly_Frame_C_3 = 16;
  Curly_Frame_C_4 = 128;
  Curly_Frame_D_1 = 32;
  Curly_Frame_D_2 = 112;
  Curly_Frame_D_3 = 48;
  Curly_Frame_D_4 = 128;
  Toroko_Frame_A_1 = 64;
  Toroko_Frame_A_2 = 80;
  Toroko_Frame_A_3 = 80;
  Toroko_Frame_A_4 = 96;
  Toroko_Frame_B_1 = 80;
  Toroko_Frame_B_2 = 80;
  Toroko_Frame_B_3 = 96;
  Toroko_Frame_B_4 = 96;
  Toroko_Frame_C_1 = 64;
  Toroko_Frame_C_2 = 80;
  Toroko_Frame_C_3 = 80;
  Toroko_Frame_C_4 = 96;
  Toroko_Frame_D_1 = 96;
  Toroko_Frame_D_2 = 80;
  Toroko_Frame_D_3 = 112;
  Toroko_Frame_D_4 = 96;
  King_Frame_A_1 = 224;
  King_Frame_A_2 = 48;
  King_Frame_A_3 = 240;
  King_Frame_A_4 = 64;
  King_Frame_B_1 = 288;
  King_Frame_B_2 = 48;
  King_Frame_B_3 = 304;
  King_Frame_B_4 = 64;
  King_Frame_C_1 = 224;
  King_Frame_C_2 = 48;
  King_Frame_C_3 = 240;
  King_Frame_C_4 = 64;
  King_Frame_D_1 = 304;
  King_Frame_D_2 = 48;
  King_Frame_D_3 = 320;
  King_Frame_D_4 = 64;
  Sue_Frame_A_1 = 0;
  Sue_Frame_A_2 = 16;
  Sue_Frame_A_3 = 16;
  Sue_Frame_A_4 = 32;
  Sue_Frame_B_1 = 32;
  Sue_Frame_B_2 = 16;
  Sue_Frame_B_3 = 48;
  Sue_Frame_B_4 = 32;
  Sue_Frame_C_1 = 0;
  Sue_Frame_C_2 = 16;
  Sue_Frame_C_3 = 16;
  Sue_Frame_C_4 = 32;
  Sue_Frame_D_1 = 48;
  Sue_Frame_D_2 = 16;
  Sue_Frame_D_3 = 64;
  Sue_Frame_D_4 = 32;
  Init_Effects();
  Init_Whimsical_Star();
  Cut_Noise();
  v84 = 0;
  Title_Screen_Music = 0;
  Mask_Color = (int)Make_RGB(0x202020u);
  Get_Version_Number((int)&Numbers_To_Display, (int)&v105, (int)&v114, (int)&v106);
  CursorPosition = Check_Profile_dat() != 0;
  Hell_Time = Get_Hell_Time();
  if ( Hell_Time && Hell_Time < 18000 )
    Title_Screen_Music = 1;
  if ( Hell_Time && Hell_Time < 15000 )
    Title_Screen_Music = 2;
  if ( Hell_Time && Hell_Time < 12000 )
    Title_Screen_Music = 3;
  if ( Hell_Time && Hell_Time < 9000 )
    Title_Screen_Music = 4;
  switch ( Title_Screen_Music )
  {
    case 1:
      Change_Music(Mus_Running_Hell);
      break;
    case 2:
      Change_Music(Mus_Torokos_Theme);
      break;
    case 3:
      Change_Music(Mus_White);
      break;
    case 4:
      Change_Music(Mus_Safety);
      break;
    default:
      Change_Music(Mus_Cave_Story);
      break;
  }
  Rect_Game.left = 0;
  Game_Flags = 0;
  Quote.Equipped_Items |= 0x100u;
  v57 = 0;
  while ( 1 )
  {
    if ( v57 < 0xA )
      ++v57;
    Get_Keys();
    if ( v57 >= 0xA )
    {
      if ( Key_Ok & Key_Pressed )
        break;
    }
    if ( Key_Held & 0x8000 )
    {
      v6 = Call_On_Escape(AppWinHandle);
      if ( !v6 )
        return 0;
      if ( v6 == 2 )
        return 1;
    }
    if ( Key_Pressed & (Key_Down | Key_Up) )
    {
      Play_Sound_Effect(Sfx_Y_N_Change_Choice, 1);
      CursorPosition = CursorPosition == 0;
    }
    Update_Effects();
    if ( ++v84 >= 40 )
      v84 = 0;
    Draw_Color_Fill(&Rect_Game, Mask_Color);
    Draw_Bitmap_With_Transparency(&Rect_Game, 100, 216, (RECT *)&Version_Text_Frame_1, 26);
    Draw_Bitmap_With_Transparency(&Rect_Game, 156, 216, (RECT *)&Version_Dots_Frame_1, 26);
    Draw_Numbers(140, 216, Numbers_To_Display, 0);
    Draw_Numbers(156, 216, v105, 0);
    Draw_Numbers(172, 216, v114, 0);
    Draw_Numbers(188, 216, v106, 0);
    Draw_Bitmap_With_Transparency(&Rect_Game, 88, 40, (RECT *)&Title_Screen_Frame_1, 0);
    Draw_Bitmap_With_Transparency(&Rect_Game, 136, 128, (RECT *)&Unknown_Frame_1, 0);
    Draw_Bitmap_With_Transparency(&Rect_Game, 136, 148, (RECT *)&Continue_Button_Frame_1, 0);
    Draw_Bitmap_With_Transparency(&Rect_Game, 80, 192, (RECT *)&Studio_Pixel_Text_Frame_1, 1);
    switch ( Title_Screen_Music )
    {
      case 0:
        v1 = &Quote_Frame_A_1 + 4 * (v84 / 10 % 4);
        rect.left = *v1;
        rect.top = v1[1];
        rect.right = v1[2];
        rect.bottom = v1[3];
        GraphicsID = 16;
        break;
      case 1:
        v2 = &Curly_Frame_A_1 + 4 * (v84 / 10 % 4);
        rect.left = *v2;
        rect.top = v2[1];
        rect.right = v2[2];
        rect.bottom = v2[3];
        GraphicsID = 23;
        break;
      case 2:
        v3 = &Toroko_Frame_A_1 + 4 * (v84 / 10 % 4);
        rect.left = *v3;
        rect.top = v3[1];
        rect.right = v3[2];
        rect.bottom = v3[3];
        GraphicsID = 23;
        break;
      case 3:
        v4 = &King_Frame_A_1 + 4 * (v84 / 10 % 4);
        rect.left = *v4;
        rect.top = v4[1];
        rect.right = v4[2];
        rect.bottom = v4[3];
        GraphicsID = 23;
        break;
      case 4:
        v5 = &Sue_Frame_A_1 + 4 * (v84 / 10 % 4);
        rect.left = *v5;
        rect.top = v5[1];
        rect.right = v5[2];
        rect.bottom = v5[3];
        GraphicsID = 23;
        break;
      default:
        break;
    }
    if ( CursorPosition )
      YPos = 147;
    else
      YPos = 127;
    Draw_Bitmap_With_Transparency(&Rect_Game, 116, YPos, &rect, GraphicsID);
    Draw_Effects(0, 0);
    if ( Hell_Time )
      Draw_Nikamaru_Timer(16, 8);
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  Play_Sound_Effect(Sfx_Y_N_Confirm, 1);
  Change_Music(0);
  v57 = GetTickCount();
  while ( GetTickCount() < v57 + 1000 )
  {
    Draw_Color_Fill(&Rect_Game, 0);
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  return 3;
}
// 493628: using guessed type int Key_Ok;
// 493634: using guessed type int Key_Up;
// 49363C: using guessed type int Key_Down;
// 49E1E4: using guessed type int CursorPosition;
// 49E1E8: using guessed type int Game_Flags;
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;

//----- (00410400) --------------------------------------------------------
// Main Game Loop
signed int __cdecl Game_Loop_Main_Game(HWND hWnd)
{
  signed int result; // eax@4
  int v2; // [sp+0h] [bp-20h]@46
  signed int v3; // [sp+4h] [bp-1Ch]@35
  signed int v4; // [sp+8h] [bp-18h]@28
  int v5; // [sp+Ch] [bp-14h]@9
  int a2; // [sp+10h] [bp-10h]@21
  unsigned int v7; // [sp+14h] [bp-Ch]@1
  int Mask_Color; // [sp+18h] [bp-8h]@1
  int a1; // [sp+1Ch] [bp-4h]@21

  Mask_Color = (int)Make_RGB(0x200000u);
  v7 = 1;
  GameTime = 0;
  Rect_Game.left = 0;
  Game_Flags = 3;
  Set_Quote_Initial_Values();
  Init_NPCs();
  Clear_All_Weapons_Object_Slots();
  Init_Effects();
  Init_Whimsical_Star();
  Init_Fade();
  Init_Flash();
  Clear_Weapon_Data();
  Clear_Item_Data();
  Clear_Unlocked_Stages();
  Memset_Map_Flags_0();
  Clear_Event_Flags();
  Init_Boss_Life();
  if ( CursorPosition )
  {
    if ( Load_Dropped_Profile_dat(0) || Initialise_Game(hWnd) )
    {
      while ( 1 )
      {
LABEL_8:
        Get_Keys();
        if ( Key_Pressed & 0x8000 )
        {
          v5 = Call_On_Escape(AppWinHandle);
          if ( !v5 )
            return 0;
          if ( v5 == 2 )
            return 1;
        }
        if ( v7 % 2 && Game_Flags & 1 )
        {
          if ( Game_Flags & 2 )
            Player_Related_Maybe(1);
          else
            Player_Related_Maybe(0);
          Do_Whimsical_Star();
          Update_NPCs();
          Update_Boss();
          Act_Value_View();
          Update_Background();
          Reset_Quote_Collision_Flags();
          Do_Collision_Check_Player_Map();
          Do_Collision_Check_Player_NPCs();
          Do_Collision_Check_Player_Bosses();
          Do_Collision_Check_NPCs_Map();
          Do_Collision_Check_Bosses_Map();
          Bul_Til_Coll_Algo();
          Entity_Bullet_Collision();
          Do_Collision_Check_Bosses_Bullets();
          if ( Game_Flags & 2 )
            Shoot_Bullet();
          Run_Bullet_Code();
          Update_Effects();
          Update_Camera();
          Main_WhiteScreen_Handler(a1, a2);
          if ( Game_Flags & 2 )
            Do_Player_Animation(1);
          else
            Do_Player_Animation(0);
        }
        if ( Game_Flags & 8 )
        {
          Credits_Related_Maybe();
          Slide_Credits_Picture();
          Scroll_Credits_Text();
        }
        Process_Fade();
        Draw_Color_Fill(&rect, Mask_Color);
        Get_Camera_Position(&a1, &a2);
        Draw_Background(a1, a2);
        Draw_Stage_Background(a1, a2);
        Draw_Boss(a1, a2);
        Draw_NPCs(a1, a2);
        Render_Bullets(a1, a2);
        Draw_Quote_And_Gun(a1, a2);
        Draw_Whimsical_Star(a1, a2);
        Draw_Map_Data_Vector(a1, a2);
        Draw_Stage_Foreground(a1, a2);
        Draw_Foreground(a1, a2);
        Draw_Boss_Explosion();
        Draw_Effects(a1, a2);
        Put_Value_View(a1, a2);
        Draw_Boss_Health();
        Draw_Fade_Out_In();
        if ( !(Game_Flags & 4) )
        {
          if ( Key_For_Menu & Key_Pressed )
          {
            Backup_Surface(10, &Rect_Game);
            v4 = Inventory_Loop();
            if ( !v4 )
              return 0;
            if ( v4 == 2 )
              return 1;
            Quote.Flags &= 0xFEu;
          }
          else if ( Quote.Equipped_Items & 2 && Key_For_Minimap & Key_Pressed )
          {
            Backup_Surface(10, &Rect_Game);
            v3 = Game_Loop_Map();
            if ( !v3 )
              return 0;
            if ( v3 == 2 )
              return 1;
          }
        }
        if ( Game_Flags & 2 )
        {
          if ( Key_For_Next_Weapon & Key_Pressed )
          {
            Switch_to_Next_Weap();
          }
          else if ( Key_For_Prev_Weapon & Key_Pressed )
          {
            Switch_to_Prev_Weap();
          }
        }
        if ( v7 % 2 )
        {
          v2 = TSC_Parser();
          if ( !v2 )
            return 0;
          if ( v2 == 2 )
            return 1;
        }
        Draw_Map_Name(0);
        Draw_Nikamaru_Timer(16, 8);
        if ( Game_Flags & 2 )
        {
          Draw_Health_Bar(1);
          Draw_XP_Bar_And_Misc(1);
          Underwater_Timer(120, 104);
          Draw_HUD_Weapon_Icons();
        }
        if ( Game_Flags & 8 )
        {
          Draw_Credits_Image();
          Draw_From_Slot_0x25_Credits_Text_Maybe();
        }
        Draw_Text_Box();
        Display_FPS_Counter();
        if ( !Draw_Window(AppWinHandle) )
          break;
        ++GameTime;
      }
      result = 0;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    if ( Initialise_Game(hWnd) )
      goto LABEL_8;
    result = 0;
  }
  return result;
}
// 493618: using guessed type int Key_For_Next_Weapon;
// 49361C: using guessed type int Key_For_Prev_Weapon;
// 493620: using guessed type int Key_For_Menu;
// 493624: using guessed type int Key_For_Minimap;
// 49E1E4: using guessed type int CursorPosition;
// 49E1E8: using guessed type int Game_Flags;
// 49E1EC: using guessed type int GameTime;
// 49E214: using guessed type int Key_Pressed;

//----- (004108B0) --------------------------------------------------------
int __cdecl Get_Build_Data(int a1, _DWORD *a2, int a3)
{
  int result; // eax@1
  int buf1; // [sp+0h] [bp-4Ch]@1
  void *buf2; // [sp+14h] [bp-38h]@1
  const char *v6; // [sp+18h] [bp-34h]@1
  const char *v7; // [sp+1Ch] [bp-30h]@1
  const char *v8; // [sp+20h] [bp-2Ch]@1
  const char *v9; // [sp+24h] [bp-28h]@1
  const char *v10; // [sp+28h] [bp-24h]@1
  const char *v11; // [sp+2Ch] [bp-20h]@1
  const char *v12; // [sp+30h] [bp-1Ch]@1
  const char *v13; // [sp+34h] [bp-18h]@1
  const char *v14; // [sp+38h] [bp-14h]@1
  const char *v15; // [sp+3Ch] [bp-10h]@1
  const char *v16; // [sp+40h] [bp-Ch]@1
  const char *v17; // [sp+44h] [bp-8h]@1
  int i; // [sp+48h] [bp-4h]@1

  buf2 = "XXX";
  v6 = "Jan";
  v7 = "Feb";
  v8 = "Mar";
  v9 = "Apr";
  v10 = "May";
  v11 = "Jun";
  v12 = "Jul";
  v13 = "Aug";
  v14 = "Sep";
  v15 = "Oct";
  v16 = "Nov";
  v17 = "Dec";
  result = sscanf("Jun 12 2005", "%s %d %d", &buf1, a3, a1);
  for ( i = 0; i < 12; ++i )
  {
    result = memcmp(&buf1, *(&buf2 + i), 3u);
    if ( !result )
      break;
    result = i + 1;
  }
  *a2 = i;
  return result;
}

//----- (00410990) --------------------------------------------------------
int __cdecl Get_Version_Number(int a1, int a2, int a3, int a4)
{
  CHAR tstrFilename; // [sp+0h] [bp-128h]@1
  unsigned int puLen; // [sp+110h] [bp-18h]@4
  LPVOID lpBuffer; // [sp+114h] [bp-14h]@4
  int v8; // [sp+118h] [bp-10h]@1
  DWORD dwHandle; // [sp+11Ch] [bp-Ch]@1
  size_t size; // [sp+120h] [bp-8h]@1
  void *ptr; // [sp+124h] [bp-4h]@1

  ptr = NULL;
  v8 = 0;
  GetModuleFileNameA(NULL, &tstrFilename, 0x104u);
  size = GetFileVersionInfoSizeA(&tstrFilename, &dwHandle);
  if ( size )
  {
    ptr = malloc(size);
    if ( ptr )
    {
      if ( GetFileVersionInfoA(&tstrFilename, 0, size, ptr) && VerQueryValueA(ptr, byte_48C42C, &lpBuffer, &puLen) )
      {
        *(_DWORD *)a1 = (unsigned __int16)(*((_DWORD *)lpBuffer + 2) >> 16);
        *(_DWORD *)a2 = (unsigned __int16)*((_DWORD *)lpBuffer + 2);
        *(_DWORD *)a3 = (unsigned __int16)(*((_DWORD *)lpBuffer + 3) >> 16);
        *(_DWORD *)a4 = *((_WORD *)lpBuffer + 6);
        v8 = 1;
      }
    }
  }
  if ( ptr )
    free(ptr);
  return v8;
}

//----- (00410AB0) --------------------------------------------------------
bool __cdecl Check_For_SndVol32_exe(HWND hwnd)
{
  char str[264]; // [sp+0h] [bp-330h]@1
  const CHAR File; // [sp+108h] [bp-228h]@1
  HINSTANCE v4; // [sp+214h] [bp-11Ch]@4
  size_t i; // [sp+218h] [bp-118h]@1
  HINSTANCE v6; // [sp+21Ch] [bp-114h]@4
  CHAR string; // [sp+220h] [bp-110h]@4

  GetSystemDirectoryA(str, 0x104u);
  sprintf((char *)&File, "%s\\Sndvol32.exe", str);
  for ( i = strlen(str); str[i] != 92; --i )
    ;
  str[i] = 0;
  sprintf(&string, "%s\\Sndvol32.exe", str);
  v4 = ShellExecuteA(hwnd, "open", &File, NULL, NULL, 5);
  v6 = ShellExecuteA(hwnd, "open", &string, NULL, NULL, 5);
  return (signed int)v4 > 32 || (signed int)v6 > 32;
}
// 410AB0: using guessed type CHAR str[264];

//----- (00410BC0) --------------------------------------------------------
// Unused
BOOL Delete_Debug_txt()
{
  const CHAR FileName; // [sp+0h] [bp-110h]@1

  sprintf((char *)&FileName, "%s\\debug.txt", ExePath);
  return DeleteFileA(&FileName);
}

//----- (00410C10) --------------------------------------------------------
// Unused
signed int __cdecl Print_Debug(int a1, int a2, int a3, int a4)
{
  signed int result; // eax@2
  char debug.txt; // [sp+0h] [bp-110h]@1
  FILE *str; // [sp+10Ch] [bp-4h]@1

  sprintf(&debug.txt, "%s\\debug.txt", ExePath);
  str = fopen(&debug.txt, "a+t");
  if ( str )
  {
    fprintf(str, (FILE *)"%s,%d,%d,%d\n", a1, a2, a3, a4);
    fclose(str);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00410CA0) --------------------------------------------------------
// Check If Param Time 2 < Now < Param Time 1
// Unused
int __cdecl Param_Time_Check(PSCOPETABLE_ENTRY *System_Time_1, int System_Time_2)
{
  int result; // eax@2
  FILETIME FileTime1; // [sp+0h] [bp-20h]@1
  FILETIME FileTime2; // [sp+8h] [bp-18h]@1
  SYSTEMTIME SystemTime; // [sp+10h] [bp-10h]@1

  GetSystemTime((LPSYSTEMTIME)&SystemTime);
  SystemTimeToFileTime((PSCOPETABLE_ENTRY *)&SystemTime, (LPFILETIME)&FileTime2);
  SystemTimeToFileTime(System_Time_1, (LPFILETIME)&FileTime1);
  if ( CompareFileTime((EH3_EXCEPTION_REGISTRATION *)&FileTime1, (EH3_EXCEPTION_REGISTRATION *)&FileTime2) < 0 )
  {
    SystemTimeToFileTime((PSCOPETABLE_ENTRY *)System_Time_2, (LPFILETIME)&FileTime1);
    result = CompareFileTime((EH3_EXCEPTION_REGISTRATION *)&FileTime1, (EH3_EXCEPTION_REGISTRATION *)&FileTime2) <= 0;
  }
  else
  {
    result = -1;
  }
  return result;
}

//----- (00410D10) --------------------------------------------------------
signed int __cdecl Check_File_Exists(int a1)
{
  signed int result; // eax@2
  char str; // [sp+0h] [bp-110h]@1
  FILE *stream; // [sp+10Ch] [bp-4h]@1

  sprintf(&str, "%s\\%s", ExePath, a1);
  stream = fopen(&str, "rb");
  if ( stream )
  {
    fclose(stream);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00410D80) --------------------------------------------------------
int __cdecl getFileSize(char *path)
{
  int result; // eax@2
  int File_Size; // ST1C_4@3
  HANDLE hObject; // [sp+4h] [bp-4h]@1

  hObject = CreateFileA(path, 0, 1u, NULL, 3u, 0x80u, NULL);
  if ( hObject == (HANDLE)-1 )
  {
    result = -1;
  }
  else
  {
    File_Size = GetFileSize(hObject, NULL);
    CloseHandle(hObject);
    result = File_Size;
  }
  return result;
}

//----- (00410DE0) --------------------------------------------------------
int __cdecl Log_Error(int Error_String, int Error_Number)
{
  int result; // eax@4
  char FileName; // [sp+0h] [bp-110h]@1
  FILE *stream; // [sp+10Ch] [bp-4h]@3

  sprintf(&FileName, "%s\\%s", ExePath, "error.log");
  if ( getFileSize(&FileName) > 102400 )
    DeleteFileA(&FileName);
  stream = fopen(&FileName, "a+t");
  if ( stream )
  {
    fprintf(stream, &::stream, Error_String, Error_Number);
    fclose(stream);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00410E90) --------------------------------------------------------
bool __cdecl Is_Shift_JIS(unsigned __int8 a1)
{
  bool result; // eax@3

  if ( (signed int)a1 < 129 || (signed int)a1 > 159 )
    result = (signed int)a1 >= 224 && (signed int)a1 <= 239;
  else
    result = 1;
  return result;
}

//----- (00410EE0) --------------------------------------------------------
BOOL __cdecl Center_Window(HWND Window_Handle)
{
  RECT Rect; // [sp+0h] [bp-3Ch]@1
  HWND hWnd; // [sp+10h] [bp-2Ch]@1
  RECT v4; // [sp+14h] [bp-28h]@2
  int X; // [sp+24h] [bp-18h]@4
  int Y; // [sp+28h] [bp-14h]@4
  int pvParam; // [sp+2Ch] [bp-10h]@1
  int v8; // [sp+30h] [bp-Ch]@6
  LONG v9; // [sp+34h] [bp-8h]@8
  LONG v10; // [sp+38h] [bp-4h]@10

  SystemParametersInfoA(0x30u, 0, &pvParam, 0);
  GetWindowRect(Window_Handle, &Rect);
  hWnd = GetParent(Window_Handle);
  if ( hWnd )
    GetWindowRect(hWnd, &v4);
  else
    SystemParametersInfoA(0x30u, 0, &v4, 0);
  X = v4.left + (v4.right - v4.left - (Rect.right - Rect.left)) / 2;
  Y = v4.top + (v4.bottom - v4.top - (Rect.bottom - Rect.top)) / 2;
  if ( v4.left + (v4.right - v4.left - (Rect.right - Rect.left)) / 2 < pvParam )
    X = pvParam;
  if ( Y < v8 )
    Y = v8;
  if ( X + Rect.right - Rect.left > v9 )
    X = v9 - (Rect.right - Rect.left);
  if ( Y + Rect.bottom - Rect.top > v10 )
    Y = v10 - (Rect.bottom - Rect.top);
  return SetWindowPos(Window_Handle, NULL, X, Y, 0, 0, 1u);
}

//----- (00410FE0) --------------------------------------------------------
int __cdecl Load_Window_Rects(HWND Window_Handle, int a2, int a3)
{
  char str; // [sp+0h] [bp-148h]@1
  int v5; // [sp+110h] [bp-38h]@2
  int v6; // [sp+114h] [bp-34h]@2
  int v7; // [sp+118h] [bp-30h]@2
  FILE *stream; // [sp+11Ch] [bp-2Ch]@1
  int v9; // [sp+120h] [bp-28h]@2
  int X; // [sp+124h] [bp-24h]@2
  int Y; // [sp+128h] [bp-20h]@4
  int v12; // [sp+12Ch] [bp-1Ch]@2
  int v13; // [sp+130h] [bp-18h]@4
  int buffer; // [sp+134h] [bp-14h]@1
  int pvParam; // [sp+138h] [bp-10h]@2
  int v16; // [sp+13Ch] [bp-Ch]@12
  int v17; // [sp+140h] [bp-8h]@14
  int v18; // [sp+144h] [bp-4h]@16

  buffer = 1;
  sprintf(&str, (const char *)&::stream._base, ExePath, a2);
  stream = fopen(&str, (const _TSCHAR *)&::stream._file);
  if ( stream )
  {
    fread(&X, 0x10u, 1u, stream);
    fread(&buffer, 4u, 1u, stream);
    fclose(stream);
    SystemParametersInfoA(0x30u, 0, &pvParam, 0);
    v7 = GetSystemMetrics(61);
    v5 = GetSystemMetrics(62);
    v6 = GetSystemMetrics(28);
    v9 = GetSystemMetrics(29);
    if ( v12 - X < v6 )
      v12 = v6 + X;
    if ( v13 - Y < v9 )
      v13 = v9 + Y;
    if ( v12 - X > v7 )
      v12 = v7 + X;
    if ( v13 - Y > v5 )
      v13 = v7 + Y;
    if ( X < pvParam )
    {
      v12 += pvParam - X;
      X = pvParam;
    }
    if ( Y < v16 )
    {
      v13 += v16 - Y;
      Y = v16;
    }
    if ( v12 > v17 )
    {
      X -= v12 - v17;
      v12 -= v12 - v17;
    }
    if ( v13 > v18 )
    {
      Y -= v13 - v18;
      v13 -= v13 - v18;
    }
    if ( a3 )
      MoveWindow(Window_Handle, X, Y, v12 - X, v13 - Y, 0);
    else
      SetWindowPos(Window_Handle, NULL, X, Y, 0, 0, 1u);
  }
  if ( buffer == 3 )
  {
    if ( !ShowWindow(Window_Handle, 3) )
      return 0;
  }
  else
  {
    ShowWindow(Window_Handle, 1);
  }
  return 1;
}

//----- (004111F0) --------------------------------------------------------
int __cdecl Save_Window_Rect_File(HWND hWnd, int a2)
{
  int result; // eax@2
  char str; // [sp+0h] [bp-150h]@7
  WINDOWPLACEMENT wndpl; // [sp+110h] [bp-40h]@1
  FILE *stream; // [sp+13Ch] [bp-14h]@7
  RECT Rect; // [sp+140h] [bp-10h]@4

  if ( !GetWindowPlacement(hWnd, (RECT *)&wndpl) )
    return 0;
  if ( wndpl.showCmd == 1 )
  {
    if ( !GetWindowRect(hWnd, &Rect) )
      return 0;
    wndpl.rcNormalPosition = Rect;
  }
  sprintf(&str, (const char *)&::stream._charbuf, ExePath, a2);
  stream = fopen(&str, (const _TSCHAR *)&::stream._tmpfname);
  if ( stream )
  {
    fwrite(&wndpl.rcNormalPosition, 0x10u, 1u, stream);
    fwrite(&wndpl.showCmd, 4u, 1u, stream);
    fclose(stream);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004112E0) --------------------------------------------------------
BOOL __cdecl IsEnableBitmap(char *filename)
{
  BOOL result; // eax@2
  int str; // [sp+0h] [bp-1Ch]@3
  size_t len; // [sp+14h] [bp-8h]@1
  FILE *stream; // [sp+18h] [bp-4h]@1

  len = strlen(Image_Tag);
  stream = fopen(filename, "rb");
  if ( stream )
  {
    fseek((int)stream, (FILE *)-len, 2);
    fread(&str, 1u, len, stream);
    fclose(stream);
    result = memcmp(&str, Image_Tag, len) == 0;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00411390) --------------------------------------------------------
// Loads initial resources (Called at Startup)
signed int Load_Initial_Resources()
{
  signed int result; // eax@28
  char str; // [sp+0h] [bp-50h]@29
  int bError; // [sp+48h] [bp-8h]@1
  size_t pt_size; // [sp+4Ch] [bp-4h]@29

  MakeSurface_From_Resource("PIXEL", 1);
  bError = 0;
  if ( !MakeSurface_From_File("MyChar", 16) )
    bError = 1;
  if ( !MakeSurface_From_File("Title", 0) )
    bError = 1;
  if ( !MakeSurface_From_File("ArmsImage", 12) )
    bError = 1;
  if ( !MakeSurface_From_File("Arms", 11) )
    bError = 1;
  if ( !MakeSurface_From_File("ItemImage", 8) )
    bError = 1;
  if ( !MakeSurface_From_File("StageImage", 14) )
    bError = 1;
  if ( !MakeSurface_From_File("Npc\\NpcSym", 20) )
    bError = 1;
  if ( !MakeSurface_From_File("Npc\\NpcRegu", 23) )
    bError = 1;
  if ( !MakeSurface_From_File("TextBox", 26) )
    bError = 1;
  if ( !MakeSurface_From_File("Caret", 19) )
    bError = 1;
  if ( !MakeSurface_From_File("Bullet", 17) )
    bError = 1;
  if ( !MakeSurface_From_File("Face", 27) )
    bError = 1;
  if ( !MakeSurface_From_File("Fade", 6) )
    bError = 1;
  MakeSurface_From_Resource("CREDIT01", 36);
  if ( bError )
  {
    result = 0;
  }
  else
  {
    MakeSurface_Blank(320, 240, 10, 1);
    MakeSurface_Blank(320, 240, 28, 0);
    MakeSurface_Blank(320, 240, 9, 1);
    MakeSurface_Blank(320, 240, 37, 0);
    MakeSurface_Blank(256, 256, 2, 0);
    MakeSurface_Blank(160, 16, 13, 0);
    MakeSurface_Blank(40, 240, 29, 0);
    MakeSurface_Blank(320, 240, 21, 0);
    MakeSurface_Blank(320, 240, 22, 0);
    MakeSurface_Blank(320, 240, 35, 0);
    pt_size = Make_PixTone_Object(&Snd_Data_Table, 2, 32);
    pt_size += Make_PixTone_Object(&Ptr_Sound, 2, 33);
    pt_size += Make_PixTone_Object(&dword_48FB00, 2, 34);
    pt_size += Make_PixTone_Object(&dword_48FBE0, 1, 15);
    pt_size += Make_PixTone_Object(&dword_48FC50, 1, 24);
    pt_size += Make_PixTone_Object(&dword_48FCC0, 1, 23);
    pt_size += Make_PixTone_Object(&dword_48FD30, 2, 50);
    pt_size += Make_PixTone_Object(&dword_48FE10, 2, 51);
    pt_size += Make_PixTone_Object(&dword_4907B0, 1, 1);
    pt_size += Make_PixTone_Object(&dword_4909E0, 1, 2);
    pt_size += Make_PixTone_Object(&dword_4911C0, 1, 29);
    pt_size += Make_PixTone_Object(&dword_4913F0, 1, 43);
    pt_size += Make_PixTone_Object(&dword_491460, 3, 44);
    pt_size += Make_PixTone_Object(&dword_4915B0, 1, 45);
    pt_size += Make_PixTone_Object(&dword_491620, 1, 46);
    pt_size += Make_PixTone_Object(&dword_491700, 1, 47);
    pt_size += Make_PixTone_Object(&dword_490EB0, 3, 35);
    pt_size += Make_PixTone_Object(&dword_491000, 3, 39);
    pt_size += Make_PixTone_Object(&dword_48FEF0, 2, 52);
    pt_size += Make_PixTone_Object(&dword_490580, 2, 53);
    pt_size += Make_PixTone_Object(&dword_48FFD0, 2, 70);
    pt_size += Make_PixTone_Object(&dword_4900B0, 2, 71);
    pt_size += Make_PixTone_Object(&dword_490190, 2, 72);
    pt_size += Make_PixTone_Object(&dword_490660, 1, 5);
    pt_size += Make_PixTone_Object(&dword_490740, 1, 11);
    pt_size += Make_PixTone_Object(&dword_490890, 1, 4);
    pt_size += Make_PixTone_Object(&dword_490D60, 2, 25);
    pt_size += Make_PixTone_Object(&dword_490E40, 1, 27);
    pt_size += Make_PixTone_Object(&dword_4910E0, 2, 28);
    pt_size += Make_PixTone_Object(&dword_490A50, 1, 14);
    pt_size += Make_PixTone_Object(&dword_490350, 2, 16);
    pt_size += Make_PixTone_Object(&dword_490430, 3, 17);
    pt_size += Make_PixTone_Object(&dword_490820, 1, 18);
    pt_size += Make_PixTone_Object(&dword_490900, 2, 20);
    pt_size += Make_PixTone_Object(&dword_4906D0, 1, 22);
    pt_size += Make_PixTone_Object(&dword_490B30, 2, 26);
    pt_size += Make_PixTone_Object(&dword_490C10, 1, 21);
    pt_size += Make_PixTone_Object(&dword_490C80, 2, 12);
    pt_size += Make_PixTone_Object(&dword_491230, 2, 38);
    pt_size += Make_PixTone_Object(&dword_491310, 1, 31);
    pt_size += Make_PixTone_Object(&dword_491380, 1, 42);
    pt_size += Make_PixTone_Object(&dword_491770, 1, 48);
    pt_size += Make_PixTone_Object(&unk_4917E0, 2, 49);
    pt_size += Make_PixTone_Object(&dword_4918C0, 1, 100);
    pt_size += Make_PixTone_Object(&dword_491930, 3, 101);
    pt_size += Make_PixTone_Object(&dword_491A80, 2, 54);
    pt_size += Make_PixTone_Object(&dword_491B60, 2, 102);
    pt_size += Make_PixTone_Object(&dword_491C40, 2, 103);
    pt_size += Make_PixTone_Object(&dword_491CB0, 1, 104);
    pt_size += Make_PixTone_Object(&dword_491D20, 1, 105);
    pt_size += Make_PixTone_Object(&dword_491D90, 2, 106);
    pt_size += Make_PixTone_Object(&dword_491E70, 1, 107);
    pt_size += Make_PixTone_Object(&dword_491EE0, 1, 30);
    pt_size += Make_PixTone_Object(&dword_491F50, 1, 108);
    pt_size += Make_PixTone_Object(&dword_491FC0, 1, 109);
    pt_size += Make_PixTone_Object(&dword_492030, 1, 110);
    pt_size += Make_PixTone_Object(&dword_4920A0, 1, 111);
    pt_size += Make_PixTone_Object(&dword_492110, 1, 112);
    pt_size += Make_PixTone_Object(&dword_492180, 1, 113);
    pt_size += Make_PixTone_Object(&dword_4921F0, 2, 114);
    pt_size += Make_PixTone_Object(&dword_4922D0, 2, 150);
    pt_size += Make_PixTone_Object(&dword_4923B0, 2, 151);
    pt_size += Make_PixTone_Object(&dword_492490, 1, 152);
    pt_size += Make_PixTone_Object(&dword_492500, 1, 153);
    pt_size += Make_PixTone_Object(&dword_492570, 2, 154);
    pt_size += Make_PixTone_Object(&dword_4929D0, 2, 155);
    pt_size += Make_PixTone_Object(&dword_492650, 2, 56);
    pt_size += Make_PixTone_Object(&dword_492730, 2, 40);
    pt_size += Make_PixTone_Object(&dword_492730, 2, 41);
    pt_size += Make_PixTone_Object(&dword_492810, 2, 37);
    pt_size += Make_PixTone_Object(&unk_4928F0, 2, 57);
    pt_size += Make_PixTone_Object(&dword_492AB0, 3, 115);
    pt_size += Make_PixTone_Object(&dword_492C00, 1, 104);
    pt_size += Make_PixTone_Object(&dword_492C70, 3, 116);
    pt_size += Make_PixTone_Object(&dword_492DC0, 2, 58);
    pt_size += Make_PixTone_Object(&dword_492EA0, 2, 55);
    pt_size += Make_PixTone_Object(&dword_492F80, 2, 117);
    pt_size += Make_PixTone_Object(&dword_493060, 1, 59);
    pt_size += Make_PixTone_Object(&dword_4930D0, 1, 60);
    pt_size += Make_PixTone_Object(&dword_493140, 1, 61);
    pt_size += Make_PixTone_Object(&dword_4931B0, 2, 62);
    pt_size += Make_PixTone_Object(&dword_493290, 2, 63);
    pt_size += Make_PixTone_Object(&dword_493370, 2, 64);
    pt_size += Make_PixTone_Object(&dword_493450, 1, 65);
    pt_size += Make_PixTone_Object(&dword_4934C0, 1, 3);
    pt_size += Make_PixTone_Object(&dword_493530, 1, 6);
    pt_size += Make_PixTone_Object(&dword_4935A0, 1, 7);
    sprintf(&str, "PixTone = %d byte", pt_size);
    result = 1;
  }
  return result;
}

//----- (00411E10) --------------------------------------------------------
// Unused
int Activate_Direct_Input()
{
  int result; // eax@2

  if ( dword_49E1F4 )
  {
    result = (*(int (__stdcall **)(int))(*(_DWORD *)dword_49E1F4 + 8))(dword_49E1F4);
    dword_49E1F4 = 0;
  }
  if ( DirectInputObj )
  {
    result = DirectInputObj->lpVtbl->Release(DirectInputObj);
    DirectInputObj = NULL;
  }
  return result;
}
// 49E1F4: using guessed type int dword_49E1F4;

//----- (00411E60) --------------------------------------------------------
signed int __cdecl Release_Direct_Input(int a1)
{
  if ( a1 == 1 )
  {
    if ( dword_49E1F4 )
      (*(void (__stdcall **)(int))(*(_DWORD *)dword_49E1F4 + 28))(dword_49E1F4);
  }
  else if ( dword_49E1F4 )
  {
    (*(void (__stdcall **)(int))(*(_DWORD *)dword_49E1F4 + 32))(dword_49E1F4);
  }
  return 1;
}
// 49E1F4: using guessed type int dword_49E1F4;

//----- (00411EB0) --------------------------------------------------------
bool __cdecl Init_Direct_Input(HINSTANCE hinst, int a2)
{
  bool result; // eax@2

  if ( DirectInputCreateA(hinst, 0x500u, &DirectInputObj, NULL) )
    result = 0;
  else
    result = Direct_Input_Something(a2) != 0;
  return result;
}

//----- (00411EF0) --------------------------------------------------------
signed int __cdecl Direct_Input_Something(int a1)
{
  signed int result; // eax@4
  LPDIRECTINPUTA v2; // [sp+0h] [bp-8h]@1
  int v3; // [sp+4h] [bp-4h]@1

  v3 = 0;
  v2 = DirectInputObj;
  ((void (__cdecl *)(LPDIRECTINPUTA))DirectInputObj->lpVtbl->AddRef)(DirectInputObj);
  ((void (__cdecl *)(LPDIRECTINPUTA, signed int, signed int (__stdcall *)(int, int), LPDIRECTINPUTA *, signed int))DirectInputObj->lpVtbl->EnumDevices)(
    DirectInputObj,
    4,
    Enum_Devices_Callback,
    &v2,
    1);
  if ( v2 )
  {
    ((void (__cdecl *)(LPDIRECTINPUTA))v2->lpVtbl->Release)(v2);
    v2 = NULL;
  }
  if ( v3 )
  {
    dword_49E1F4 = v3;
    if ( (*(int (__cdecl **)(int, char *))(*(_DWORD *)v3 + 44))(v3, &byte_480D10) )
    {
      result = 0;
    }
    else if ( (*(int (__cdecl **)(int, int, signed int))(*(_DWORD *)dword_49E1F4 + 52))(dword_49E1F4, a1, 9) )
    {
      result = 0;
    }
    else
    {
      (*(void (__cdecl **)(int))(*(_DWORD *)dword_49E1F4 + 28))(dword_49E1F4);
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 480D10: using guessed type char byte_480D10;
// 49E1F4: using guessed type int dword_49E1F4;

//----- (00411FC0) --------------------------------------------------------
signed int __stdcall Enum_Devices_Callback(int a1, int a2)
{
  signed int result; // eax@4
  const CHAR OutputString; // [sp+0h] [bp-108h]@9
  int v4; // [sp+104h] [bp-4h]@5

  if ( !(dword_49E20C & 1) )
  {
    dword_49E20C |= 1u;
    dword_49E208 = a2;
  }
  if ( (*(int (__cdecl **)(_DWORD, int, int *, _DWORD))(**(_DWORD **)dword_49E208 + 12))(
         *(_DWORD *)dword_49E208,
         a1 + 4,
         &dword_49E204,
         0) )
  {
    *(_DWORD *)(dword_49E208 + 4) = 0;
    result = 1;
  }
  else
  {
    v4 = (**(int (__cdecl ***)(int, const char *, int *))dword_49E204)(dword_49E204, "DY.\x11DEST", &dword_49E200);
    if ( v4 >= 0 )
    {
      if ( dword_49E204 )
      {
        (*(void (__cdecl **)(int))(*(_DWORD *)dword_49E204 + 8))(dword_49E204);
        dword_49E204 = 0;
      }
      *(_DWORD *)(dword_49E208 + 4) = dword_49E200;
      sprintf(
        (char *)&OutputString,
        "DeviceGUID = %x\n",
        *(_DWORD *)(a1 + 4),
        *(_DWORD *)(a1 + 8),
        *(_DWORD *)(a1 + 12),
        *(_DWORD *)(a1 + 16));
      OutputDebugStringA(&OutputString);
      result = 0;
    }
    else
    {
      dword_49E1F4 = 0;
      result = 1;
    }
  }
  return result;
}
// 49E1F4: using guessed type int dword_49E1F4;
// 49E200: using guessed type int dword_49E200;
// 49E204: using guessed type int dword_49E204;
// 49E208: using guessed type int dword_49E208;
// 49E20C: using guessed type int dword_49E20C;

//----- (004120F0) --------------------------------------------------------
signed int __cdecl Read_Controller(int a1)
{
  signed int i; // [sp+0h] [bp-5Ch]@9
  int v3; // [sp+4h] [bp-58h]@5
  int v4; // [sp+8h] [bp-54h]@19
  char v5[32]; // [sp+34h] [bp-28h]@11
  int v6; // [sp+58h] [bp-4h]@5

  if ( !dword_49E1F4 )
    return 0;
  if ( (*(int (__cdecl **)(int))(*(_DWORD *)dword_49E1F4 + 100))(dword_49E1F4) )
    return 0;
  v6 = (*(int (__cdecl **)(int, signed int, int *))(*(_DWORD *)dword_49E1F4 + 36))(dword_49E1F4, 80, &v3);
  if ( v6 )
  {
    if ( v6 != -2147024866 )
      return 0;
    Release_Direct_Input(0);
  }
  for ( i = 0; i < 32; ++i )
  {
    if ( v5[i] & 0x80 )
      *(_DWORD *)(a1 + 4 * i + 16) = 1;
    else
      *(_DWORD *)(a1 + 4 * i + 16) = 0;
  }
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)a1 = 0;
  if ( v3 >= dword_49E1F8 - 10000 )
  {
    if ( v3 > dword_49E1F8 + 10000 )
      *(_DWORD *)(a1 + 4) = 1;
  }
  else
  {
    *(_DWORD *)a1 = 1;
  }
  if ( v4 >= dword_49E1FC - 10000 )
  {
    if ( v4 > dword_49E1FC + 10000 )
      *(_DWORD *)(a1 + 12) = 1;
  }
  else
  {
    *(_DWORD *)(a1 + 8) = 1;
  }
  return 1;
}
// 49E1F4: using guessed type int dword_49E1F4;
// 49E1F8: using guessed type int dword_49E1F8;
// 49E1FC: using guessed type int dword_49E1FC;
// 4120F0: using guessed type char var_28[32];

//----- (00412250) --------------------------------------------------------
signed int ResetJoystickStatus()
{
  int v1; // [sp+0h] [bp-58h]@5
  int v2; // [sp+4h] [bp-54h]@9
  int v3; // [sp+54h] [bp-4h]@5

  if ( !dword_49E1F4 )
    return 0;
  if ( (*(int (__cdecl **)(int))(*(_DWORD *)dword_49E1F4 + 100))(dword_49E1F4) )
    return 0;
  v3 = (*(int (__cdecl **)(int, signed int, int *))(*(_DWORD *)dword_49E1F4 + 36))(dword_49E1F4, 80, &v1);
  if ( v3 )
  {
    if ( v3 != -2147024866 )
      return 0;
    Release_Direct_Input(0);
  }
  dword_49E1F8 = v1;
  dword_49E1FC = v2;
  return 1;
}
// 49E1F4: using guessed type int dword_49E1F4;
// 49E1F8: using guessed type int dword_49E1F8;
// 49E1FC: using guessed type int dword_49E1FC;

//----- (004122E0) --------------------------------------------------------
void __cdecl Get_Keys()
{
  Key_Pressed = (LastKeyHeld ^ Key_Held) & Key_Held;
  LastKeyHeld = Key_Held;
}
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;
// 49E218: using guessed type int LastKeyHeld;

//----- (00412320) --------------------------------------------------------
// Useless since it's already set
BOOL __cdecl Set_Window_Title(HWND hWnd)
{
  const CHAR String; // [sp+0h] [bp-108h]@1

  sprintf((char *)&String, "%s", Window_Name);
  return SetWindowTextA(hWnd, &String);
}

//----- (00412370) --------------------------------------------------------
void Display_FPS_Counter()
{
  int Numbers_To_Display; // ST10_4@2

  if ( FPS_Counter_Enabled )
  {
    Numbers_To_Display = Count_FPS();
    Draw_Numbers(280, 8, Numbers_To_Display, 0);
  }
}
// 49E464: using guessed type int FPS_Counter_Enabled;

//----- (004123A0) --------------------------------------------------------
int Count_FPS()
{
  unsigned int v0; // eax@3

  if ( dword_493644 )
  {
    Timer1000Ticks = GetTickCount();
    dword_493644 = 0;
  }
  v0 = GetTickCount();
  ++Timer1000Elapsed;
  if ( Timer1000Ticks + 1000 <= v0 )
  {
    Timer1000Ticks += 1000;
    Timer1000Time = Timer1000Elapsed;
    Timer1000Elapsed = 0;
  }
  return Timer1000Time;
}
// 493644: using guessed type int dword_493644;
// 49E46C: using guessed type int Timer1000Time;
// 49E470: using guessed type int Timer1000Elapsed;
// 49E474: using guessed type int Timer1000Ticks;

//----- (00412420) --------------------------------------------------------
// Creating game window, starting game
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  int result; // eax@2
  int v5; // esi@39
  int v6; // esi@39
  int v7; // esi@39
  int v8; // esi@39
  int v9; // ST2C_4@39
  int v10; // eax@39
  int v11; // ST1C_4@47
  int v12; // eax@47
  RECT rect; // [sp+1Ch] [bp-124h]@57
  RECT v14; // [sp+2Ch] [bp-114h]@57
  int v15; // [sp+3Ch] [bp-104h]@57
  int BitsPerPixel; // [sp+40h] [bp-100h]@53
  HMENU v17; // [sp+44h] [bp-FCh]@41
  Config_Data_File config; // [sp+48h] [bp-F8h]@3
  WNDCLASSEXA Window_vars; // [sp+E8h] [bp-58h]@33
  int X; // [sp+118h] [bp-28h]@39
  int nHeight; // [sp+11Ch] [bp-24h]@39
  int nWidth; // [sp+120h] [bp-20h]@39
  int i; // [sp+124h] [bp-1Ch]@22
  HWND hWnd; // [sp+128h] [bp-18h]@39
  int Y; // [sp+12Ch] [bp-14h]@39
  int v26; // [sp+130h] [bp-10h]@33
  int v27; // [sp+134h] [bp-Ch]@33
  int v28; // [sp+138h] [bp-8h]@33
  int v29; // [sp+13Ch] [bp-4h]@33

  hObject = OpenMutexA(0x1F0001u, 0, oDoukutsu);
  if ( hObject )
  {
    CloseHandle(hObject);
    result = 0;
  }
  else
  {
    hMutex = CreateMutexA(NULL, 0, oDoukutsu);
    AppInstance = hInstance;
    GetModuleFileNameA(NULL, ExePath, 0x104u);
    PathRemoveFileSpecA(ExePath);
    strcpy(dataPath, ExePath);
    strcat(dataPath, "\\data");
    if ( !Load_Config_Data(&config) )
      Set_Default_Config_Data(&config);
    if ( config.attack_button_mode )
    {
      if ( config.attack_button_mode == 1 )
      {
        Key_Jump = 32;
        Key_Shoot = 64;
      }
    }
    else
    {
      Key_Jump = 64;
      Key_Shoot = 32;
    }
    if ( config.ok_button_mode )
    {
      if ( config.ok_button_mode == 1 )
      {
        Key_Ok = Key_Shoot;
        Key_Cancel = Key_Jump;
      }
    }
    else
    {
      Key_Ok = Key_Jump;
      Key_Cancel = Key_Shoot;
    }
    if ( Check_File_Exists((int)"s_reverse") )
    {
      Key_For_Next_Weapon = 256;
      Key_For_Prev_Weapon = 128;
    }
    if ( config.move_button_mode )
    {
      if ( config.move_button_mode == 1 )
      {
        Key_Left = 0x10000;
        Key_Up = 0x180000;
        Key_Right = 0x40000;
        Key_Down = 0x20000;
      }
    }
    else
    {
      Key_Left = 1;
      Key_Up = 4;
      Key_Right = 2;
      Key_Down = 8;
    }
    for ( i = 0; i < 8; ++i )
    {
      switch ( config.joystick_button[i] )
      {
        case 1:
          Joystick_Button_Table[i] = Key_Jump;
          break;
        case 2:
          Joystick_Button_Table[i] = Key_Shoot;
          break;
        case 3:
          Joystick_Button_Table[i] = Key_For_Next_Weapon;
          break;
        case 6:
          Joystick_Button_Table[i] = Key_For_Prev_Weapon;
          break;
        case 4:
          Joystick_Button_Table[i] = Key_For_Menu;
          break;
        case 5:
          Joystick_Button_Table[i] = Key_For_Minimap;
          break;
        default:
          continue;
      }
    }
    v26 = 0;
    v27 = 0;
    v28 = 320;
    v29 = 240;
    memset(&Window_vars, 0, 0x30u);
    Window_vars.cbSize = 48;
    Window_vars.lpfnWndProc = Window_Procedure;
    Window_vars.hInstance = hInstance;
    Window_vars.hbrBackground = (HBRUSH)GetStockObject(3);
    Window_vars.lpszClassName = Window_Name;
    Window_vars.hCursor = LoadCursorA(hInstance, "CURSOR_NORMAL");
    Window_vars.hIcon = LoadIconA(hInstance, Icon_Name);
    Window_vars.hIconSm = LoadIconA(hInstance, "ICON_MINI");
    switch ( config.display_mode )
    {
      case Display_320_240_Windowed:
      case Display_640_480_Windowed:
        Window_vars.lpszMenuName = "MENU_MAIN";
        if ( RegisterClassExA(&Window_vars) )
        {
          if ( config.display_mode == Display_320_240_Windowed )
          {
            Window_Width = 320;
            Window_Height = 240;
          }
          else
          {
            Window_Width = 640;
            Window_Height = 480;
          }
          nWidth = Window_Width + 2 * GetSystemMetrics(7) + 2;
          v5 = GetSystemMetrics(8);
          v6 = GetSystemMetrics(4) + 2 * v5;
          nHeight = GetSystemMetrics(15) + Window_Height + v6 + 2;
          X = (GetSystemMetrics(0) - nWidth) / 2;
          Y = (GetSystemMetrics(1) - nHeight) / 2;
          v7 = GetSystemMetrics(8);
          v8 = GetSystemMetrics(4) + v7;
          v9 = v8 + GetSystemMetrics(15) + 1;
          v10 = GetSystemMetrics(7);
          Change_Screen_Offsets(v10 + 1, v9);
          // Generate main window
          hWnd = CreateWindowExA(
                   0u,
                   Window_Name,
                   Window_Name,
                   0x10CA0000u,
                   X,
                   Y,
                   nWidth,
                   nHeight,
                   NULL,
                   NULL,
                   hInstance,
                   NULL);
          AppWinHandle = hWnd;
          if ( hWnd )
          {
            v17 = GetMenu(hWnd);
            if ( config.display_mode == Display_320_240_Windowed )
              InitDirectDraw(hWnd, Mode_320_240_Windowed, 0);
            else
              InitDirectDraw(hWnd, Mode_640_480_Windowed, 0);
            goto LABEL_57;
          }
          ReleaseMutex(hMutex);
          result = 0;
        }
        else
        {
          ReleaseMutex(hMutex);
          result = 0;
        }
        break;
      case Display_FullScreen:
      case Display_Full_24_Bit:
      case Display_Full_32_Bit:
        if ( RegisterClassExA(&Window_vars) )
        {
          Window_Width = 640;
          Window_Height = 480;
          Change_Screen_Offsets(0, 0);
          v11 = GetSystemMetrics(1);
          v12 = GetSystemMetrics(0);
          hWnd = CreateWindowExA(0, Window_Name, Window_Name, 0x90080000, 0, 0, v12, v11, NULL, NULL, hInstance, NULL);
          AppWinHandle = hWnd;
          if ( hWnd )
          {
            if ( !config.display_mode )
            {
              // 16-bit mode
              BitsPerPixel = 16;
            }
            else if ( config.display_mode == Display_Full_24_Bit )
            {
              // 24-bit mode
              BitsPerPixel = 24;
            }
            else if ( config.display_mode == Display_Full_32_Bit )
            {
              // 32-bit mode
              BitsPerPixel = 32;
            }
            InitDirectDraw(hWnd, Mode_Fullscreen, BitsPerPixel);
            Is_Fullscreen = 1;
            ShowCursor(0);
            goto LABEL_57;
          }
          ReleaseMutex(hMutex);
          result = 0;
        }
        else
        {
          ReleaseMutex(hMutex);
          result = 0;
        }
        break;
      default:
LABEL_57:
        v14.left = 0;
        v14.top = 0;
        v14.right = 64;
        v14.bottom = 8;
        rect.left = 0;
        rect.top = 0;
        rect.right = 320;
        rect.bottom = 240;
        v15 = MakeSurface_From_File("Loading", 15);
        Draw_Color_Fill(&rect, 0);
        Draw_Bitmap_With_Transparency(&rect, 128, 116, &v14, 15);
        if ( !Draw_Window(AppWinHandle) )
        {
          ReleaseMutex(hMutex);
          result = 1;
        }
        else
        {
          Init_Direct_Sound(hWnd);
          if ( config.joystick_mode && Init_Direct_Input(hInstance, (int)hWnd) )
          {
            ResetJoystickStatus();
            Use_Joystick = 1;
          }
          Init_Font_Object(config.font_name);
          Init_Triangle_Table();
          Game_Loop_Selector(hWnd);
          End_Font_Object();
          End_Direct_Sound();
          End_Direct_Draw(hWnd);
          ReleaseMutex(hMutex);
          result = 1;
        }
        break;
    }
  }
  return result;
}
// 493610: using guessed type int Key_Jump;
// 493614: using guessed type int Key_Shoot;
// 493618: using guessed type int Key_For_Next_Weapon;
// 49361C: using guessed type int Key_For_Prev_Weapon;
// 493620: using guessed type int Key_For_Menu;
// 493624: using guessed type int Key_For_Minimap;
// 493628: using guessed type int Key_Ok;
// 49362C: using guessed type int Key_Cancel;
// 493630: using guessed type int Key_Left;
// 493634: using guessed type int Key_Up;
// 493638: using guessed type int Key_Right;
// 49363C: using guessed type int Key_Down;
// 49E42C: using guessed type int Joystick_Button_Table[];
// 49E450: using guessed type int Window_Width;
// 49E454: using guessed type int Window_Height;
// 49E45C: using guessed type int Use_Joystick;
// 49E460: using guessed type int Is_Fullscreen;

//----- (00412BC0) --------------------------------------------------------
void Windows_Focus_Lost()
{
  if ( CanAcceptInput )
  {
    CanAcceptInput = 0;
    Stop_Organya_Music();
    Play_Sound_40_41_58();
  }
  Play_Sound_Effect(Sfx_Silence_73, 0);
}
// 49E468: using guessed type int CanAcceptInput;

//----- (00412BF0) --------------------------------------------------------
void Windows_Focus_Gained()
{
  if ( !CanAcceptInput )
  {
    CanAcceptInput = 1;
    Stop_Organya_Music();
    Start_Organya_Playback();
    Play_Environmental_Sounds();
  }
  Play_Sound_Effect(Sfx_Silence_73, -1);
}
// 49E468: using guessed type int CanAcceptInput;

//----- (00412C30) --------------------------------------------------------
signed int __cdecl Load_Dropped_Profile(int a1, HDROP a2)
{
  CHAR v3; // [sp+0h] [bp-110h]@2
  HDROP v4; // [sp+10Ch] [bp-4h]@1

  v4 = a2;
  if ( DragQueryFileA(a2, 0xFFFFFFFF, NULL, 0) )
  {
    DragQueryFileA(v4, 0, &v3, 0x104u);
    Load_Dropped_Profile_dat((int)&v3);
  }
  DragFinish(v4);
  return 1;
}

//----- (00412CA0) --------------------------------------------------------
LRESULT __stdcall Window_Procedure(HWND hWnd, UINT Message, WPARAM wParam, LPARAM lParam)
{
  HMENU hMenu; // ST38_4@17
  HIMC v5; // ST30_4@33
  bool actApp; // [sp+18h] [bp-10h]@0
  HMENU v8; // [sp+20h] [bp-8h]@17

  if ( Message > WM_KEYUP )
  {
    if ( Message > WM_DROPFILES )
    {
      if ( Message != WM_IME_NOTIFY )
        return DefWindowProcA(hWnd, Message, wParam, lParam);
      if ( wParam == 8 )
      {
        v5 = ImmGetContext(hWnd);
        ImmSetOpenStatus(v5, 0);
        ImmReleaseContext(hWnd, v5);
      }
    }
    else if ( Message == WM_DROPFILES )
    {
      Load_Dropped_Profile((int)hWnd, (HDROP)wParam);
    }
    else if ( Message == WM_COMMAND )
    {
      switch ( (unsigned __int16)wParam )
      {
        case Button_Quit:
          if ( DialogBoxParamA(AppInstance, "DLG_YESNO", hWnd, (DLGPROC)Yes_No_Dialog, (LPARAM)"Quit?") == Button_Yes )
            PostMessageA(hWnd, 0x10u, 0, 0);
          break;
        case Button_Version:
          DialogBoxParamA(AppInstance, "DLG_ABOUT", hWnd, About_Dialog, 0);
          break;
        case Button_Volume:
          if ( !Check_For_SndVol32_exe(hWnd) )
            MessageBoxA(hWnd, "{[N", Window_Name, 0);
          break;
        case Button_Debug_Save:
          DialogBoxParamA(AppInstance, "DLG_SAVE", hWnd, Debug_Save_Button, 0);
          break;
        case Button_Mute:
          DialogBoxParamA(AppInstance, "DLG_MUTE", hWnd, Mute_Button, 0);
          break;
        default:
          return 1;
      }
    }
    else
    {
      if ( Message != WM_SYSCOMMAND )
        return DefWindowProcA(hWnd, Message, wParam, lParam);
      if ( wParam != 61696 && wParam != 61760 && wParam != 61808 )
        DefWindowProcA(hWnd, Message, wParam, lParam);
    }
  }
  else if ( Message == WM_KEYUP )
  {
    switch ( wParam )
    {
      case VK_ESCAPE:
        Key_Held &= ~0x8000u;
        break;
      case VK_JUNJA|0x40:
        Key_Held &= ~0x10u;
        break;
      case VK_LEFT:
        Key_Held &= ~1u;
        break;
      case VK_RIGHT:
        Key_Held &= ~2u;
        break;
      case VK_UP:
        Key_Held &= ~4u;
        break;
      case VK_DOWN:
        Key_Held &= ~8u;
        break;
      case VK_FINAL|0x40:
        Key_Held &= ~0x20u;
        break;
      case VK_FINAL|VK_RBUTTON|0x40:
        Key_Held &= ~0x40u;
        break;
      case VK_PAUSE|0x40:
        Key_Held &= ~0x80u;
        break;
      case 0x41u:
        Key_Held &= ~0x100u;
        break;
      case VK_SHIFT:
        Key_Held &= ~0x200u;
        break;
      case VK_F1:
        Key_Held &= ~0x400u;
        break;
      case VK_F2:
        Key_Held &= ~0x800u;
        break;
      case VK_CONTROL|0x40:
        Key_Held &= ~0x1000u;
        break;
      case VK_LMENU|VK_FINAL:
        Key_Held &= ~0x10000u;
        break;
      case VK_LMENU|VK_FINAL|VK_RBUTTON:
        Key_Held &= ~0x20000u;
        break;
      case VK_RMENU|VK_FINAL|VK_RBUTTON:
        Key_Held &= ~0x40000u;
        break;
      case VK_CLEAR|0x40:
        Key_Held &= ~0x80000u;
        break;
      case VK_RCONTROL|VK_FINAL:
        Key_Held &= ~0x100000u;
        break;
      default:
        return 1;
    }
  }
  else if ( Message > WM_CLOSE )
  {
    if ( Message != WM_KEYDOWN )
      return DefWindowProcA(hWnd, Message, wParam, lParam);
    switch ( wParam )
    {
      case VK_ESCAPE:
        Key_Held |= 0x8000u;
        break;
      case VK_JUNJA|0x40:
        Key_Held |= 0x10u;
        break;
      case VK_LEFT:
        Key_Held |= 1u;
        break;
      case VK_RIGHT:
        Key_Held |= 2u;
        break;
      case VK_UP:
        Key_Held |= 4u;
        break;
      case VK_DOWN:
        Key_Held |= 8u;
        break;
      case VK_FINAL|0x40:
        Key_Held |= 0x20u;
        break;
      case VK_FINAL|VK_RBUTTON|0x40:
        Key_Held |= 0x40u;
        break;
      case VK_PAUSE|0x40:
        Key_Held |= 0x80u;
        break;
      case 0x41u:
        Key_Held |= 0x100u;
        break;
      case VK_SHIFT:
        Key_Held |= 0x200u;
        break;
      case VK_F1:
        Key_Held |= 0x400u;
        break;
      case VK_F2:
        Key_Held |= 0x800u;
        break;
      case VK_CONTROL|0x40:
        Key_Held |= 0x1000u;
        break;
      case VK_LMENU|VK_FINAL:
        Key_Held |= 0x10000u;
        break;
      case VK_LMENU|VK_FINAL|VK_RBUTTON:
        Key_Held |= 0x20000u;
        break;
      case VK_RMENU|VK_FINAL|VK_RBUTTON:
        Key_Held |= 0x40000u;
        break;
      case VK_CLEAR|0x40:
        Key_Held |= 0x80000u;
        break;
      case VK_RCONTROL|VK_FINAL:
        Key_Held |= 0x100000u;
        break;
      case VK_F5:
        Use_Joystick = 0;
        break;
      default:
        return 1;
    }
  }
  else if ( Message == WM_CLOSE )
  {
    Stop_Organya_Music();
    PostQuitMessage(0);
  }
  else if ( Message == WM_CREATE )
  {
    // Executed when created
    hMenu = GetMenu(hWnd);
    // Delete Debug Save menu
    DeleteMenu(hMenu, 40005u, 0);
    DrawMenuBar(hWnd);
    v8 = GetMenu(hWnd);
    if ( !Check_File_Exists((int)"mute") )
      DeleteMenu(v8, 40007u, 0);
    DrawMenuBar(hWnd);
    if ( Check_File_Exists((int)"fps") )
      FPS_Counter_Enabled = 1;
    if ( !Is_Fullscreen )
      Load_Window_Rects(hWnd, (int)"window.rect", 0);
    Set_Window_Title(hWnd);                     // Useless since it's already set
  }
  else
  {
    if ( Message != WM_ACTIVATE )
      return DefWindowProcA(hWnd, Message, wParam, lParam);
    if ( (_WORD)wParam )
    {
      if ( (signed int)(unsigned __int16)wParam > 0 && (signed int)(unsigned __int16)wParam <= 2 )
        actApp = HIWORD(wParam) == 0;
    }
    else
    {
      actApp = 0;
    }
    if ( actApp )
      Windows_Focus_Gained();
    else
      Windows_Focus_Lost();
  }
  return 1;
}
// 49E20C: using guessed type int dword_49E20C;
// 49E210: using guessed type int Key_Held;
// 49E45C: using guessed type int Use_Joystick;
// 49E460: using guessed type int Is_Fullscreen;
// 49E464: using guessed type int FPS_Counter_Enabled;

//----- (00413570) --------------------------------------------------------
signed int MessageQueue(void)
{
  MSG Msg; // [sp+0h] [bp-1Ch]@1

  while ( PeekMessageA((LPMSG)&Msg, NULL, 0, 0, 0) || !CanAcceptInput )
  {
    if ( !GetMessageA((LPMSG)&Msg, NULL, 0, 0) )
      return 0;
    TranslateMessage((_STARTUPINFOA *)&Msg);
    DispatchMessageA((_STARTUPINFOA *)&Msg);
  }
  if ( Use_Joystick )
    Joystick_Procedure();
  return 1;
}
// 49E45C: using guessed type int Use_Joystick;
// 49E468: using guessed type int CanAcceptInput;

//----- (004135E0) --------------------------------------------------------
signed int Joystick_Procedure()
{
  signed int result; // eax@1
  int v1; // [sp+0h] [bp-98h]@1
  int v2; // [sp+4h] [bp-94h]@5
  int v3; // [sp+8h] [bp-90h]@8
  int v4; // [sp+Ch] [bp-8Ch]@11
  int v5[33]; // [sp+10h] [bp-88h]@19
  int i; // [sp+94h] [bp-4h]@14

  result = Read_Controller((int)&v1);
  if ( result )
  {
    Key_Held &= 0x8C00u;
    if ( v1 )
    {
      Key_Held |= Key_Left;
    }
    else
    {
      result = Key_Held & ~Key_Left;
      Key_Held &= ~Key_Left;
    }
    if ( v2 )
      Key_Held |= Key_Right;
    else
      Key_Held &= ~Key_Right;
    if ( v3 )
    {
      result = Key_Up | Key_Held;
      Key_Held |= Key_Up;
    }
    else
    {
      Key_Held &= ~Key_Up;
    }
    if ( v4 )
    {
      Key_Held |= Key_Down;
    }
    else
    {
      result = Key_Held & ~Key_Down;
      Key_Held &= ~Key_Down;
    }
    for ( i = 0; i < 8; ++i )
    {
      result = Key_Held & ~Joystick_Button_Table[i];
      Key_Held &= ~Joystick_Button_Table[i];
    }
    for ( i = 0; i < 8; ++i )
    {
      if ( v5[i] )
      {
        result = i;
        Key_Held |= Joystick_Button_Table[i];
      }
    }
  }
  return result;
}
// 49362C: using guessed type int Key_Cancel;
// 493630: using guessed type int Key_Left;
// 493634: using guessed type int Key_Up;
// 493638: using guessed type int Key_Right;
// 49363C: using guessed type int Key_Down;
// 49E20C: using guessed type int dword_49E20C;
// 49E210: using guessed type int Key_Held;
// 49E42C: using guessed type int Joystick_Button_Table[];
// 4135E0: using guessed type int var_88[33];

//----- (00413750) --------------------------------------------------------
// Reserves memory for PXM Data
signed int Init_Map_Data()
{
  Current_Map.data = (unsigned __int8 *)malloc(0x4B000u);
  return 1;
}

//----- (00413770) --------------------------------------------------------
// Load PXM file
signed int __cdecl Load_Map_Data(char *path_map)
{
  signed int result; // eax@2
  char path[260]; // [sp+0h] [bp-118h]@1
  unsigned __int8 dum; // [sp+10Fh] [bp-9h]@5
  FILE *stream; // [sp+110h] [bp-8h]@1
  char check[3]; // [sp+114h] [bp-4h]@3

  sprintf(path, "%s\\%s", dataPath, path_map);
  stream = fopen(path, "rb");
  if ( !stream )
  {
    result = 0;
  }
  else
  {
    fread(check, 1u, 3u, stream);
    // Inverting this if() statement will break the de-compiler. Do not do that.
    if ( !memcmp(check, PXM, 3u) )
    {
      fread(&dum, 1u, 1u, stream);
      fread(&Current_Map.Width, 2u, 1u, stream);
      fread(&Current_Map.Length, 2u, 1u, stream);
      if ( Current_Map.data )
      {
        fread(Current_Map.data, 1u, Current_Map.Length * Current_Map.Width, stream);
        fclose(stream);
        result = 1;
      }
      else
      {
        fclose(stream);
        result = 0;
      }
    }
    else
    {
      fclose(stream);
      result = 0;
    }
  }
  return result;
}

//----- (004138A0) --------------------------------------------------------
// Loads PXA file
signed int __cdecl Load_Attribute_Data(char *StageName)
{
  signed int result; // eax@2
  char path[260]; // [sp+0h] [bp-110h]@1
  FILE *stream; // [sp+10Ch] [bp-4h]@1

  sprintf(path, "%s\\%s", dataPath, StageName);
  stream = fopen(path, "rb");
  if ( !stream )
  {
    result = 0;
  }
  else
  {
    fread(Current_Map.Map_Layout_Buffer, 1u, 256u, stream);
    fclose(stream);
    result = 1;
  }
  return result;
}

//----- (00413930) --------------------------------------------------------
void Kill_Level_Layout()
{
  free(Current_Map.data);
}

//----- (00413960) --------------------------------------------------------
void __cdecl Get_Map_Data(unsigned __int8 **data, __int16 *Map_Width, __int16 *Map_Height)
{
  if ( data )
    *data = Current_Map.data;
  if ( Map_Width )
    *Map_Width = Current_Map.Width;
  if ( Map_Height )
    *Map_Height = Current_Map.Length;
}

//----- (004139A0) --------------------------------------------------------
unsigned __int8 __cdecl Get_Tile_Attributes(signed int X_Pos, signed int Y_Pos)
{
  unsigned __int8 result; // al@5

  if ( X_Pos >= 0 && Y_Pos >= 0 && X_Pos < Current_Map.Width && Y_Pos < Current_Map.Length )// Make sure coordinates are valid
    // Get coordinates from PXM file
    result = Current_Map.Map_Layout_Buffer[*(&Current_Map.data[X_Pos] + Y_Pos * Current_Map.Width)];
  else
    // Coordinates are invalid
    result = 0;
  return result;
}

//----- (00413A00) --------------------------------------------------------
char *__cdecl Delete_Tile(int a1, int a2)
{
  char *result; // eax@1

  result = (char *)&Current_Map.data[a1];
  *(&Current_Map.data[a1] + a2 * Current_Map.Width) = 0;
  return result;
}

//----- (00413A20) --------------------------------------------------------
// TSC SMP : Shift Map Parts
void __cdecl Shift_Map_Parts(int X_Pos, int Y_pos)
{
  --*(&Current_Map.data[X_Pos] + Y_pos * Current_Map.Width);
}

//----- (00413A60) --------------------------------------------------------
// TSC CMP : Change Map Parts
signed int __cdecl Change_Map_Parts(int X_Pos, int Y_Pos, unsigned __int8 New_NPC)
{
  signed int result; // eax@2
  signed int i; // [sp+0h] [bp-4h]@3

  if ( *(&Current_Map.data[X_Pos] + Y_Pos * Current_Map.Width) == New_NPC )
  {
    result = 0;
  }
  else
  {
    *(&Current_Map.data[X_Pos] + Y_Pos * Current_Map.Width) = New_NPC;
    for ( i = 0; i < 3; ++i )
      NPC_Create(Smoke, X_Pos << 13, Y_Pos << 13, 0, 0, 0, NULL, 0);
    result = 1;
  }
  return result;
}

//----- (00413AF0) --------------------------------------------------------
void __cdecl Draw_Stage_Background(signed int Camera_X, signed int Camera_Y)
{
  int i; // [sp+0h] [bp-30h]@1
  int offset; // [sp+Ch] [bp-24h]@6
  int j; // [sp+18h] [bp-18h]@3
  RECT rect; // [sp+1Ch] [bp-14h]@7
  int Num_X; // [sp+2Ch] [bp-4h]@1

  Num_X = 21;
  for ( i = (Camera_Y / 512 + 8) / 16; i < (Camera_Y / 512 + 8) / 16 + 16; ++i )
  {
    for ( j = (Camera_X / 512 + 8) / 16; j < Num_X + (Camera_X / 512 + 8) / 16; ++j )
    {
      offset = j + i * Current_Map.Width;
      if ( (signed int)Get_Tile_Attributes(j, i) < 32 )
      {
        rect.left = 16 * (Current_Map.data[offset] % 16);
        rect.top = 16 * ((signed int)Current_Map.data[offset] >> 4);
        rect.right = rect.left + 16;
        rect.bottom = rect.top + 16;
        Draw_Bitmap_With_Transparency(&Rect_Game, 16 * j - 8 - Camera_X / 512, 16 * i - 8 - Camera_Y / 512, &rect, 2);
      }
    }
  }
}

//----- (00413C60) --------------------------------------------------------
void __cdecl Draw_Stage_Foreground(signed int Camera_X, signed int Camera_Y)
{
  int i; // [sp+0h] [bp-40h]@1
  signed int Attributes; // [sp+8h] [bp-38h]@6
  RECT rcSnack; // [sp+Ch] [bp-34h]@1
  int offset; // [sp+1Ch] [bp-24h]@6
  int put_X; // [sp+20h] [bp-20h]@1
  int put_Y; // [sp+24h] [bp-1Ch]@1
  int j; // [sp+28h] [bp-18h]@3
  RECT rect; // [sp+2Ch] [bp-14h]@9
  int num_X; // [sp+3Ch] [bp-4h]@1

  rcSnack.left = 256;
  rcSnack.top = 48;
  rcSnack.right = 272;
  rcSnack.bottom = 64;
  num_X = 21;
  put_X = (Camera_X / 512 + 8) / 16;
  put_Y = (Camera_Y / 512 + 8) / 16;
  for ( i = (Camera_Y / 512 + 8) / 16; i < put_Y + 16; ++i )
  {
    for ( j = put_X; j < num_X + put_X; ++j )
    {
      offset = j + i * Current_Map.Width;
      Attributes = Get_Tile_Attributes(j, i);
      if ( Attributes >= 64 && Attributes < 128 )
      {
        rect.left = 16 * (Current_Map.data[offset] % 16);
        rect.top = 16 * ((signed int)Current_Map.data[offset] >> 4);
        rect.right = rect.left + 16;
        rect.bottom = rect.top + 16;
        Draw_Bitmap_With_Transparency(&Rect_Game, 16 * j - 8 - Camera_X / 512, 16 * i - 8 - Camera_Y / 512, &rect, 2);
        if ( Attributes == 67 )
          Draw_Bitmap_With_Transparency(
            &Rect_Game,
            16 * j - 8 - Camera_X / 512,
            16 * i - 8 - Camera_Y / 512,
            &rcSnack,
            20);
      }
    }
  }
}

//----- (00413E40) --------------------------------------------------------
void __cdecl Draw_Map_Data_Vector(signed int Camera_X, signed int Camera_Y)
{
  int temp1; // ecx@16 MAPDST
  int i; // [sp+4h] [bp-30h]@1
  int Attributes; // [sp+Ch] [bp-28h]@6
  int j; // [sp+1Ch] [bp-18h]@3
  RECT rect; // [sp+20h] [bp-14h]@15
  int num_X; // [sp+30h] [bp-4h]@1

  Draw_Map_Data_Vector::count += 2;
  num_X = 21;
  for ( i = (Camera_Y / 512 + 8) / 16; i < (Camera_Y / 512 + 8) / 16 + 16; ++i )
  {
    for ( j = (Camera_X / 512 + 8) / 16; j < num_X + (Camera_X / 512 + 8) / 16; ++j )
    {
      Attributes = Get_Tile_Attributes(j, i);
      if ( Attributes == 0x80
        || Attributes == 0x81
        || Attributes == 0x82
        || Attributes == 0x83
        || Attributes == 0xA0
        || Attributes == 0xA1
        || Attributes == 0xA2
        || Attributes == 0xA3 )
      {
        switch ( Attributes )
        {
          case 0x80:
          case 0xA0:
            temp1 = (unsigned __int8)Draw_Map_Data_Vector::count % 16;
            rect.left = temp1 + 224;
            rect.right = temp1 + 240;
            rect.top = 48;
            rect.bottom = 64;
            break;
          case 0x81:
          case 0xA1:
            rect.left = 224;
            rect.right = 240;
            temp1 = (unsigned __int8)Draw_Map_Data_Vector::count % 16;
            rect.top = temp1 + 48;
            rect.bottom = temp1 + 64;
            break;
          case 0x82:
          case 0xA2:
            rect.left = 240 - (unsigned __int8)Draw_Map_Data_Vector::count % 16;
            rect.right = rect.left + 16;
            rect.top = 48;
            rect.bottom = 64;
            break;
          case 0x83:
          case 0xA3:
            rect.left = 224;
            rect.right = 240;
            rect.top = 64 - (unsigned __int8)Draw_Map_Data_Vector::count % 16;
            rect.bottom = rect.top + 16;
            break;
          default:
            break;
        }
        Draw_Bitmap_With_Transparency(&Rect_Game, 16 * j - 8 - Camera_X / 512, 16 * i - 8 - Camera_Y / 512, &rect, 19);
      }
    }
  }
}
// 49E58C: using guessed type char Draw_Map_Data_Vector::count;

//----- (004140F0) --------------------------------------------------------
void __cdecl Ready_Map_Name(char *_name)
{
  char name[24]; // [sp+0h] [bp-20h]@1
  int i; // [sp+1Ch] [bp-4h]@2

  name[0] = 31;
  name[1] = 31;
  name[2] = 82;
  name[3] = -141;
  name[4] = -140;
  name[5] = 99;
  name[6] = 104;
  name[7] = 110;
  name[8] = 31;
  name[9] = 79;
  name[10] = 104;
  name[11] = 119;
  name[12] = 100;
  name[13] = 107;
  name[14] = 31;
  name[15] = 111;
  name[16] = 113;
  name[17] = 100;
  name[18] = 114;
  name[19] = 100;
  name[20] = 109;
  name[21] = 115;
  name[22] = 114;
  name[23] = 255;
  Map_Name.flag = 0;
  Map_Name.wait = 0;
  if ( !strcmp(_name, "u") )
  {
    for ( i = 0; i < 24; ++i )
      ++name[i];
    _name = name;
  }
  strcpy(Map_Name.name, _name);
  i = strlen(Map_Name.name);
  Draw_Color_Fill_Onto_Surface(&stru_493650, 0, 13);
  Draw_String_Onto_Surface((160 - 6 * i) / 2 + 6, 1, Map_Name.name, 0x220011u, 13);
  Draw_String_Onto_Surface((160 - 6 * i) / 2 + 6, 0, Map_Name.name, 0xFEFFFFu, 13);
}

//----- (00414250) --------------------------------------------------------
// MNA : Render Map Name
void __cdecl Draw_Map_Name(int bMini)
{
  RECT rcBack; // [sp+0h] [bp-20h]@2
  RECT v1; // [sp+10h] [bp-10h]@1

  v1.left = 0;
  v1.top = 0;
  v1.right = 160;
  v1.bottom = 16;
  if ( bMini )
  {
    rcBack.left = 0;
    rcBack.right = 320;
    rcBack.top = 7;
    rcBack.bottom = 24;
    Draw_Color_Fill(&rcBack, 0);
    Draw_Bitmap_With_Transparency(&Rect_Game, 74, 10, &stru_493650, 13);
  }
  else if ( Map_Name.flag )
  {
    Draw_Bitmap_With_Transparency(&Rect_Game, 74, 80, &stru_493650, 13);
    if ( ++Map_Name.wait > 160 )
      Map_Name.flag = 0;
  }
}

//----- (00414310) --------------------------------------------------------
void Start_Map_Name()
{
  Map_Name.flag = 1;
  Map_Name.wait = 0;
}

//----- (00414330) --------------------------------------------------------
int Redraw_Room_Text_To_Surface()
{
  size_t v0; // ST14_4@1

  v0 = strlen(Map_Name.name);
  Draw_Color_Fill_Onto_Surface(&stru_493650, 0, 13);
  Draw_String_Onto_Surface((signed int)(160 - 6 * v0) / 2 + 6, 1, Map_Name.name, 0x220011u, 13);
  return Draw_String_Onto_Surface((signed int)(160 - 6 * v0) / 2 + 6, 0, Map_Name.name, 0xFEFFFFu, 13);
}

//----- (004143C0) --------------------------------------------------------
void __cdecl Render_Map_System_Green_Stuff(LONG a1)
{
  int v1; // [sp+0h] [bp-48h]@1
  int v2; // [sp+4h] [bp-44h]@1
  int v3; // [sp+8h] [bp-40h]@1
  int v4; // [sp+Ch] [bp-3Ch]@1
  int v5; // [sp+10h] [bp-38h]@1
  int v6; // [sp+14h] [bp-34h]@1
  int v7; // [sp+18h] [bp-30h]@1
  int v8; // [sp+1Ch] [bp-2Ch]@1
  int v9; // [sp+20h] [bp-28h]@1
  int v10; // [sp+24h] [bp-24h]@1
  int v11; // [sp+28h] [bp-20h]@1
  int v12; // [sp+2Ch] [bp-1Ch]@1
  int v13; // [sp+30h] [bp-18h]@1
  int v14; // [sp+34h] [bp-14h]@1
  int v15; // [sp+38h] [bp-10h]@1
  int v16; // [sp+3Ch] [bp-Ch]@1
  LONG i; // [sp+40h] [bp-8h]@1
  unsigned __int8 v18; // [sp+47h] [bp-1h]@3

  v1 = 240;
  v2 = 24;
  v3 = 241;
  v4 = 25;
  v5 = 241;
  v6 = 24;
  v7 = 242;
  v8 = 25;
  v9 = 242;
  v10 = 24;
  v11 = 243;
  v12 = 25;
  v13 = 243;
  v14 = 24;
  v15 = 244;
  v16 = 25;
  for ( i = 0; i < Current_Map.Width; ++i )
  {
    v18 = Get_Tile_Attributes(i, a1);
    if ( v18 )
    {
      if ( v18 != 68
        && v18 != 1
        && v18 != 64
        && v18 != 128
        && v18 != 129
        && v18 != 130
        && v18 != 131
        && v18 != 81
        && v18 != 82
        && v18 != 85
        && v18 != 86
        && v18 != 2
        && v18 != 96
        && v18 != 113
        && v18 != 114
        && v18 != 117
        && v18 != 118
        && v18 != 160
        && v18 != 161
        && v18 != 162
        && v18 != 163 )
      {
        if ( v18 != 67
          && v18 != 99
          && v18 != 80
          && v18 != 83
          && v18 != 84
          && v18 != 87
          && v18 != 96
          && v18 != 112
          && v18 != 115
          && v18 != 116
          && v18 != 119 )
        {
          Draw_Sprite_Onto_Surface(i, a1, (RECT *)&v13, 9, 26);
        }
        else
        {
          Draw_Sprite_Onto_Surface(i, a1, (RECT *)&v9, 9, 26);
        }
      }
      else
      {
        Draw_Sprite_Onto_Surface(i, a1, (RECT *)&v5, 9, 26);
      }
    }
    else
    {
      Draw_Sprite_Onto_Surface(i, a1, (RECT *)&v1, 9, 26);
    }
  }
}

//----- (00414640) --------------------------------------------------------
signed int Game_Loop_Map()
{
  int v1; // [sp+0h] [bp-50h]@32
  int v2; // [sp+4h] [bp-4Ch]@15
  int v3; // [sp+8h] [bp-48h]@4
  RECT Ptr_Img_Rects; // [sp+Ch] [bp-44h]@9
  int My_Y; // [sp+1Ch] [bp-34h]@1
  RECT rect; // [sp+20h] [bp-30h]@12
  int My_X; // [sp+30h] [bp-20h]@1
  char v8; // [sp+37h] [bp-19h]@12
  int i; // [sp+38h] [bp-18h]@1
  LONG v10; // [sp+3Ch] [bp-14h]@12
  RECT My_Rect; // [sp+40h] [bp-10h]@1

  My_Rect.left = 0;
  My_Rect.top = 57;
  My_Rect.right = 1;
  My_Rect.bottom = 58;
  My_X = (Quote.X_Pos / 512 + 8) / 16;
  My_Y = (Quote.Y_Pos / 512 + 8) / 16;
  for ( i = 0; i <= 8; ++i )
  {
    Get_Keys();
    if ( Key_Held & 0x8000 )
    {
      v3 = Call_On_Escape(AppWinHandle);
      if ( !v3 )
        return 0;
      if ( v3 == 2 )
        return 2;
    }
    Draw_Sprite_No_Tranparency(&Rect_Game, 0, 0, &Rect_Game, 10);
    Ptr_Img_Rects.left = 160 - i * Current_Map.Width / 8 / 2;
    Ptr_Img_Rects.right = i * Current_Map.Width / 8 / 2 + 160;
    Ptr_Img_Rects.top = 120 - i * Current_Map.Length / 8 / 2;
    Ptr_Img_Rects.bottom = i * Current_Map.Length / 8 / 2 + 120;
    Draw_Map_Name(1);
    Draw_Color_Fill(&Ptr_Img_Rects, 0);
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  rect.left = 0;
  rect.right = Current_Map.Width;
  rect.top = 0;
  rect.bottom = Current_Map.Length;
  Ptr_Img_Rects.right = --Ptr_Img_Rects.left + Current_Map.Width + 2;
  Ptr_Img_Rects.bottom = --Ptr_Img_Rects.top + Current_Map.Length + 2;
  Draw_Color_Fill_Onto_Surface(&rect, 0, 9);
  v10 = 0;
  v8 = 0;
  while ( 1 )
  {
    Get_Keys();
    if ( Key_Pressed & (Key_Cancel | Key_Ok) )
      break;
    if ( Key_Held & 0x8000 )
    {
      v2 = Call_On_Escape(AppWinHandle);
      if ( !v2 )
        return 0;
      if ( v2 == 2 )
        return 2;
    }
    Draw_Sprite_No_Tranparency(&Rect_Game, 0, 0, &Rect_Game, 10);
    Draw_Color_Fill(&Ptr_Img_Rects, 0);
    if ( v10 < Current_Map.Length )
      Render_Map_System_Green_Stuff(v10++);
    if ( v10 < Current_Map.Length )
      Render_Map_System_Green_Stuff(v10++);
    Draw_Bitmap_With_Transparency(&Rect_Game, Ptr_Img_Rects.left + 1, Ptr_Img_Rects.top + 1, &rect, 9);
    Draw_Map_Name(1);
    if ( ((signed int)(unsigned __int8)++v8 >> 3) % 2 )
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        My_X + Ptr_Img_Rects.left + 1,
        My_Y + Ptr_Img_Rects.top + 1,
        &My_Rect,
        26);
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  for ( i = 8; i >= -1; --i )
  {
    Get_Keys();
    if ( Key_Held & 0x8000 )
    {
      v1 = Call_On_Escape(AppWinHandle);
      if ( !v1 )
        return 0;
      if ( v1 == 2 )
        return 2;
    }
    Draw_Sprite_No_Tranparency(&Rect_Game, 0, 0, &Rect_Game, 10);
    Ptr_Img_Rects.left = 160 - i * Current_Map.Width / 8 / 2;
    Ptr_Img_Rects.right = i * Current_Map.Width / 8 / 2 + 160;
    Ptr_Img_Rects.top = 120 - i * Current_Map.Length / 8 / 2;
    Ptr_Img_Rects.bottom = i * Current_Map.Length / 8 / 2 + 120;
    Draw_Map_Name(1);
    Draw_Color_Fill(&Ptr_Img_Rects, 0);
    Display_FPS_Counter();
    if ( !Draw_Window(AppWinHandle) )
      return 0;
  }
  return 1;
}
// 493628: using guessed type int Key_Ok;
// 49362C: using guessed type int Key_Cancel;
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;

//----- (00414B00) --------------------------------------------------------
// Returns 1 if current map flag set, 0 if not set
bool Check_Map_Flag()
{
  return Map_Flag_Array[Current_Stage_Num] != 0;
}
// 4A57F0: using guessed type int Current_Stage_Num;

//----- (00414B20) --------------------------------------------------------
// Pushes reserved space onto the ram. used for maps, so the higher you set push 128, the more possible maps
void *Memset_Map_Flags_0()
{
  return memset(Map_Flag_Array, 0, 128u);
}

//----- (00414B40) --------------------------------------------------------
// Set MPJ array slot == true for map ID given
void __cdecl Set_Map_Flag(int Map_ID)
{
  Map_Flag_Array[Map_ID] = 1;
}

//----- (00414B50) --------------------------------------------------------
void *Set_Quote_Initial_Values()
{
  void *result; // eax@1

  result = memset(&Quote, 0, 0xB4u);
  Quote.Flags = -128;
  Quote.Direction = 2;
  Quote.Sizebox.back = 4096;
  Quote.Sizebox.top = 4096;
  Quote.Sizebox.front = 4096;
  Quote.Sizebox.bottom = 4096;
  Quote.Hitbox.back = 2560;
  Quote.Hitbox.top = 4096;
  Quote.Hitbox.front = 2560;
  Quote.Hitbox.bottom = 4096;
  Quote.Health = 3;
  Quote.Max_Health = 3;
  Quote.Unit = 0;
  return result;
}

//----- (00414BF0) --------------------------------------------------------
void __cdecl Do_Player_Animation(int bKey)
{
  RECT *Chosen_Rect; // eax@43 MAPDST
  RECT Rects_Right[12]; // [sp+0h] [bp-180h]@1
  RECT Rects_Left[12]; // [sp+C0h] [bp-C0h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 0;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 16;
  Rects_Left[2].bottom = 16;
  Rects_Left[3].left = 32;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 48;
  Rects_Left[3].bottom = 16;
  Rects_Left[4].left = 0;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 16;
  Rects_Left[4].bottom = 16;
  Rects_Left[5].left = 48;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 64;
  Rects_Left[5].bottom = 16;
  Rects_Left[6].left = 64;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 80;
  Rects_Left[6].bottom = 16;
  Rects_Left[7].left = 48;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 64;
  Rects_Left[7].bottom = 16;
  Rects_Left[8].left = 80;
  Rects_Left[8].top = 0;
  Rects_Left[8].right = 96;
  Rects_Left[8].bottom = 16;
  Rects_Left[9].left = 48;
  Rects_Left[9].top = 0;
  Rects_Left[9].right = 64;
  Rects_Left[9].bottom = 16;
  Rects_Left[10].left = 96;
  Rects_Left[10].top = 0;
  Rects_Left[10].right = 112;
  Rects_Left[10].bottom = 16;
  Rects_Left[11].left = 112;
  Rects_Left[11].top = 0;
  Rects_Left[11].right = 128;
  Rects_Left[11].bottom = 16;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 0;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 16;
  Rects_Right[2].bottom = 32;
  Rects_Right[3].left = 32;
  Rects_Right[3].top = 16;
  Rects_Right[3].right = 48;
  Rects_Right[3].bottom = 32;
  Rects_Right[4].left = 0;
  Rects_Right[4].top = 16;
  Rects_Right[4].right = 16;
  Rects_Right[4].bottom = 32;
  Rects_Right[5].left = 48;
  Rects_Right[5].top = 16;
  Rects_Right[5].right = 64;
  Rects_Right[5].bottom = 32;
  Rects_Right[6].left = 64;
  Rects_Right[6].top = 16;
  Rects_Right[6].right = 80;
  Rects_Right[6].bottom = 32;
  Rects_Right[7].left = 48;
  Rects_Right[7].top = 16;
  Rects_Right[7].right = 64;
  Rects_Right[7].bottom = 32;
  Rects_Right[8].left = 80;
  Rects_Right[8].top = 16;
  Rects_Right[8].right = 96;
  Rects_Right[8].bottom = 32;
  Rects_Right[9].left = 48;
  Rects_Right[9].top = 16;
  Rects_Right[9].right = 64;
  Rects_Right[9].bottom = 32;
  Rects_Right[10].left = 96;
  Rects_Right[10].top = 16;
  Rects_Right[10].right = 112;
  Rects_Right[10].bottom = 32;
  Rects_Right[11].left = 112;
  Rects_Right[11].top = 16;
  Rects_Right[11].right = 128;
  Rects_Right[11].bottom = 32;
  if ( !(Quote.Flags & 2) )
  {
    if ( Quote.Collision_Flags & 8 )
    {
      if ( Quote.Flags & 1 )
      {
        Quote.Animation_Num = 11;
      }
      else if ( Key_Up & Key_Held && Key_Held & (Key_Right | Key_Left) && bKey )
      {
        Quote.Flags |= 4u;
        if ( ++Quote.Animation_Timer > 4 )
        {
          Quote.Animation_Timer = 0;
          if ( ++Quote.Animation_Num == 7 || Quote.Animation_Num == 9 )
            Play_Sound_Effect(Sfx_Quote_Walk, 1);
        }
        if ( Quote.Animation_Num > 9 || Quote.Animation_Num < 6 )
          Quote.Animation_Num = 6;
      }
      else if ( Key_Held & (Key_Right | Key_Left) && bKey )
      {
        Quote.Flags |= 4u;
        if ( ++Quote.Animation_Timer > 4 )
        {
          Quote.Animation_Timer = 0;
          if ( ++Quote.Animation_Num == 2 || Quote.Animation_Num == 4 )
            Play_Sound_Effect(Sfx_Quote_Walk, 1);
        }
        if ( Quote.Animation_Num > 4 || Quote.Animation_Num < 1 )
          Quote.Animation_Num = 1;
      }
      else if ( Key_Up & Key_Held && bKey )
      {
        if ( Quote.Flags & 4 )
          Play_Sound_Effect(Sfx_Quote_Walk, 1);
        Quote.Flags &= ~4u;
        Quote.Animation_Num = 5;
      }
      else
      {
        if ( Quote.Flags & 4 )
          Play_Sound_Effect(Sfx_Quote_Walk, 1);
        Quote.Flags &= 0xFBu;
        Quote.Animation_Num = 0;
      }
    }
    else if ( Quote.Is_Facing_Up )
    {
      Quote.Animation_Num = 6;
    }
    else if ( Quote.Is_Facing_Down )
    {
      Quote.Animation_Num = 10;
    }
    else if ( Quote.Y_Vel <= 0 )
    {
      Quote.Animation_Num = 3;
    }
    else
    {
      Quote.Animation_Num = 1;
    }
    if ( !Quote.Direction )
    {
      Chosen_Rect = &Rects_Left[Quote.Animation_Num];
      Quote.Rect.left = Chosen_Rect->left;
      Quote.Rect.top = Chosen_Rect->top;
      Quote.Rect.right = Chosen_Rect->right;
      Quote.Rect.bottom = Chosen_Rect->bottom;
    }
    else
    {
      Chosen_Rect = &Rects_Right[Quote.Animation_Num];
      Quote.Rect.left = Chosen_Rect->left;
      Quote.Rect.top = Chosen_Rect->top;
      Quote.Rect.right = Chosen_Rect->right;
      Quote.Rect.bottom = Chosen_Rect->bottom;
    }
  }
}
// 493630: using guessed type int Key_Left;
// 493634: using guessed type int Key_Up;
// 493638: using guessed type int Key_Right;
// 49E210: using guessed type int Key_Held;

//----- (00415220) --------------------------------------------------------
// TSC HMC/SMC : Hide My Character / Show My Character
void __cdecl Show_Hide_Player(int show)
{
  if ( show )
    Quote.Flags &= 0xFDu;
  else
    Quote.Flags |= 2u;
}

//----- (00415250) --------------------------------------------------------
void __cdecl Draw_Quote_And_Gun(signed int a1, signed int a2)
{
  RECT rect; // [sp+0h] [bp-34h]@22
  int v3; // [sp+10h] [bp-24h]@22
  int v4; // [sp+14h] [bp-20h]@22
  int v5; // [sp+18h] [bp-1Ch]@22
  int v6; // [sp+1Ch] [bp-18h]@22
  int v7; // [sp+20h] [bp-14h]@7
  int Rects; // [sp+24h] [bp-10h]@20
  LONG v9; // [sp+28h] [bp-Ch]@20
  LONG v10; // [sp+2Ch] [bp-8h]@20
  LONG v11; // [sp+30h] [bp-4h]@20

  if ( Quote.Flags & 0x80 && !(Quote.Flags & 2) )
  {
    Quote.Rect_Weapon.left = 24 * (Weapons[Selected_Weapon].ID % 13);
    Quote.Rect_Weapon.right = Quote.Rect_Weapon.left + 24;
    Quote.Rect_Weapon.top = 96 * (Weapons[Selected_Weapon].ID / 13);
    Quote.Rect_Weapon.bottom = Quote.Rect_Weapon.top + 16;
    if ( Quote.Direction == 2 )
    {
      Quote.Rect_Weapon.top += 16;
      Quote.Rect_Weapon.bottom += 16;
    }
    if ( Quote.Is_Facing_Up )
    {
      v7 = -4;
      Quote.Rect_Weapon.top += 32;
      Quote.Rect_Weapon.bottom += 32;
    }
    else if ( Quote.Is_Facing_Down )
    {
      v7 = 4;
      Quote.Rect_Weapon.top += 64;
      Quote.Rect_Weapon.bottom += 64;
    }
    else
    {
      v7 = 0;
    }
    if ( Quote.Animation_Num == 1 || Quote.Animation_Num == 3 || Quote.Animation_Num == 6 || Quote.Animation_Num == 8 )
      ++Quote.Rect_Weapon.top;
    if ( Quote.Direction )
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        (Quote.X_Pos - Quote.Sizebox.front) / 512 - a1 / 512,
        v7 + (Quote.Y_Pos - Quote.Sizebox.top) / 512 - a2 / 512,
        &Quote.Rect_Weapon,
        11);
    else
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        (Quote.X_Pos - Quote.Sizebox.front) / 512 - a1 / 512 - 8,
        v7 + (Quote.Y_Pos - Quote.Sizebox.top) / 512 - a2 / 512,
        &Quote.Rect_Weapon,
        11);
    if ( !(((signed int)Quote.Invincibility_Timer >> 1) % 2) )
    {
      Rects = Quote.Rect.left;
      v9 = Quote.Rect.top;
      v10 = Quote.Rect.right;
      v11 = Quote.Rect.bottom;
      if ( Quote.Equipped_Items & 0x40 )
      {
        v9 += 32;
        v11 += 32;
      }
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        (Quote.X_Pos - Quote.Sizebox.front) / 512 - a1 / 512,
        (Quote.Y_Pos - Quote.Sizebox.top) / 512 - a2 / 512,
        (RECT *)&Rects,
        16);
      rect.left = 56;
      rect.top = 96;
      rect.right = 80;
      rect.bottom = 120;
      v3 = 80;
      v4 = 96;
      v5 = 104;
      v6 = 120;
      ++Quote.bubble;
      if ( Quote.Equipped_Items & 0x10 && Quote.Collision_Flags & 0x100 )
      {
        Draw_Bitmap_With_Transparency(
          &Rect_Game,
          Quote.X_Pos / 512 - 12 - a1 / 512,
          Quote.Y_Pos / 512 - 12 - a2 / 512,
          &rect + ((signed int)Quote.bubble >> 1) % 2,
          19);
      }
      else if ( Quote.Unit == 1 )
      {
        Draw_Bitmap_With_Transparency(
          &Rect_Game,
          Quote.X_Pos / 512 - 12 - a1 / 512,
          Quote.Y_Pos / 512 - 12 - a2 / 512,
          &rect + ((signed int)Quote.bubble >> 1) % 2,
          19);
      }
    }
  }
}
// 499C68: using guessed type int Selected_Weapon;

//----- (004156C0) --------------------------------------------------------
int __cdecl Physics(int a1)
{
  int result; // eax@1
  int X_Pos; // ST48_4@195
  int v3; // ST10_4@195
  int v4; // eax@195
  int v5; // ST48_4@201
  int v6; // ST10_4@201
  int v7; // eax@201
  int Direction; // [sp+0h] [bp-2Ch]@189
  signed int Jump_Speed; // [sp+4h] [bp-28h]@3
  signed int Walk_Speed; // [sp+8h] [bp-24h]@3
  signed int Friction; // [sp+Ch] [bp-20h]@3
  signed int Gravity; // [sp+10h] [bp-1Ch]@3
  signed int Air_Control; // [sp+14h] [bp-18h]@3
  int Quote_Max_Speed; // [sp+18h] [bp-14h]@3
  signed int Gravity_When_Pressing_Jump; // [sp+1Ch] [bp-10h]@3
  signed int j; // [sp+24h] [bp-8h]@193
  signed int i; // [sp+24h] [bp-8h]@199

  result = Quote.Flags & 2;
  if ( !(Quote.Flags & 2) )
  {
    // Agility Code : How fast you move in water or land
    if ( !(Quote.Collision_Flags & 0x100) )
    {
      // Normal physics
      Quote_Max_Speed = 812;
      Gravity = 80;
      Gravity_When_Pressing_Jump = 32;
      Jump_Speed = 1280;
      Walk_Speed = 85;
      Air_Control = 32;
      Friction = 51;
    }
    else
    {
      // Underwater physics
      Quote_Max_Speed = 406;
      Gravity = 40;
      Gravity_When_Pressing_Jump = 16;
      Jump_Speed = 640;
      Walk_Speed = 42;
      Air_Control = 16;
      Friction = 25;
    }
    Quote.ques = 0;
    if ( !a1 )
      Quote.boost_sw = 0;
    if ( Quote.Collision_Flags & 8 || Quote.Collision_Flags & 0x10 || Quote.Collision_Flags & 0x20 )
    {
      Quote.boost_sw = 0;
      if ( Quote.Equipped_Items & 1 )
      {
        Quote.Booster_Fuel = 50;                // Booster 0.8 max fuel
      }
      else if ( Quote.Equipped_Items & 0x20 )
      {
        Quote.Booster_Fuel = 50;                // Booster 2.0 max fuel
      }
      else
      {
        Quote.Booster_Fuel = 0;
      }
      if ( a1 )
      {
        if ( Key_Pressed != Key_Down || Key_Held != Key_Down || Quote.Flags & 1 || Game_Flags & 4 )
        {
          if ( Key_Held != Key_Down )
          {
            if ( Key_Left & Key_Held && Quote.X_Vel > -Quote_Max_Speed )
              Quote.X_Vel -= Walk_Speed;
            if ( Key_Right & Key_Held && Quote.X_Vel < Quote_Max_Speed )
              Quote.X_Vel += Walk_Speed;
            if ( Key_Left & Key_Held )
              Quote.Direction = 0;
            if ( Key_Right & Key_Held )
              Quote.Direction = 2;
          }
        }
        else
        {
          Quote.Flags |= 1u;
          Quote.ques = 1;
        }
      }
      if ( !(Quote.Flags & 0x20) )
      {
        if ( Quote.X_Vel < 0 )
        {
          if ( Quote.X_Vel <= -Friction )
            Quote.X_Vel += Friction;
          else
            Quote.X_Vel = 0;
        }
        if ( Quote.X_Vel > 0 )
        {
          if ( Quote.X_Vel >= Friction )
            Quote.X_Vel -= Friction;
          else
            Quote.X_Vel = 0;
        }
      }
    }
    else
    {
      if ( a1 )
      {
        if ( Quote.Equipped_Items & 0x21 && Key_Jump & Key_Pressed && Quote.Booster_Fuel )
        {
          if ( Quote.Equipped_Items & 1 )
          {
            Quote.boost_sw = 1;
            if ( Quote.Y_Vel > 256 )
              Quote.Y_Vel /= 2;
          }
          if ( Quote.Equipped_Items & 0x20 )
          {
            if ( Key_Up & Key_Held )
            {
              Quote.boost_sw = 2;
              Quote.X_Vel = 0;
              Quote.Y_Vel = -1535;
            }
            else if ( Key_Left & Key_Held )
            {
              Quote.boost_sw = 1;
              Quote.Y_Vel = 0;
              Quote.X_Vel = -1535;
            }
            else if ( Key_Right & Key_Held )
            {
              Quote.boost_sw = 1;
              Quote.Y_Vel = 0;
              Quote.X_Vel = 1535;
            }
            else if ( Key_Down & Key_Held )
            {
              Quote.boost_sw = 3;
              Quote.X_Vel = 0;
              Quote.Y_Vel = 1535;
            }
            else
            {
              Quote.boost_sw = 2;
              Quote.X_Vel = 0;
              Quote.Y_Vel = -1535;
            }
          }
        }
        if ( Key_Left & Key_Held && Quote.X_Vel > -Quote_Max_Speed )
          Quote.X_Vel -= Air_Control;
        if ( Key_Right & Key_Held && Quote.X_Vel < Quote_Max_Speed )
          Quote.X_Vel += Air_Control;
        if ( Key_Left & Key_Held )
          Quote.Direction = 0;
        if ( Key_Right & Key_Held )
          Quote.Direction = 2;
      }
      if ( Quote.Equipped_Items & 0x20 && Quote.boost_sw && (!(Key_Jump & Key_Held) || !Quote.Booster_Fuel) )
      {
        if ( Quote.boost_sw == 1 )
        {
          Quote.X_Vel /= 2;
        }
        else if ( Quote.boost_sw == 2 )
        {
          Quote.Y_Vel /= 2;
        }
      }
      if ( !Quote.Booster_Fuel || !(Key_Jump & Key_Held) )
        Quote.boost_sw = 0;
    }
    if ( a1 )
    {
      Quote.Is_Facing_Up = (Key_Up & Key_Held) != 0;
      Quote.Is_Facing_Down = Key_Down & Key_Held && !(Quote.Collision_Flags & 8);
      if ( Key_Jump & Key_Pressed
        && (Quote.Collision_Flags & 8 || Quote.Collision_Flags & 0x10 || Quote.Collision_Flags & 0x20)
        && !(Quote.Collision_Flags & 0x2000) )
      {
        // Jump function
        Quote.Y_Vel = -Jump_Speed;
        Play_Sound_Effect(Sfx_Quote_Jump, 1);
      }
    }
    if ( a1 && Key_Held & (Key_Shoot | Key_Jump | Key_Up | Key_Right | Key_Left) )
      Quote.Flags &= 0xFEu;
    if ( Quote.boost_sw && Quote.Booster_Fuel )
      --Quote.Booster_Fuel;                     // Decrease booster fuel
    if ( Quote.Collision_Flags & 0x1000 )
      Quote.X_Vel -= 136;
    if ( Quote.Collision_Flags & 0x2000 )
      Quote.Y_Vel -= 128;
    if ( Quote.Collision_Flags & 0x4000 )
      Quote.X_Vel += 136;
    if ( Quote.Collision_Flags & 0x8000 )
      Quote.Y_Vel += 85;
    if ( Quote.Equipped_Items & 0x20 && Quote.boost_sw )
    {
      if ( Quote.boost_sw == 1 )
      {
        if ( Quote.Collision_Flags & 5 )
          Quote.Y_Vel = -256;
        if ( !Quote.Direction )
          Quote.X_Vel -= 32;
        if ( Quote.Direction == 2 )
          Quote.X_Vel += 32;
        if ( Key_Jump & Key_Pressed || Quote.Booster_Fuel % 3 == 1 )
        {
          if ( !Quote.Direction )
            Create_Effect(Quote.X_Pos + 1024, Quote.Y_Pos + 1024, 7, 2);
          if ( Quote.Direction == 2 )
            Create_Effect(Quote.X_Pos - 1024, Quote.Y_Pos + 1024, 7, 0);
          Play_Sound_Effect(Sfx_Booster, 1);    // Play booster sound
        }
      }
      else if ( Quote.boost_sw == 2 )
      {
        Quote.Y_Vel -= 32;
        if ( Key_Jump & Key_Pressed || Quote.Booster_Fuel % 3 == 1 )
        {
          // Make booster fuel trail and play booster sound
          Create_Effect(Quote.X_Pos, Quote.Y_Pos + 3072, 7, 3);
          Play_Sound_Effect(Sfx_Booster, 1);
        }
      }
      else if ( Quote.boost_sw == 3 && (Key_Jump & Key_Pressed || Quote.Booster_Fuel % 3 == 1) )
      {
        Create_Effect(Quote.X_Pos, Quote.Y_Pos - 3072, 7, 1);
        Play_Sound_Effect(Sfx_Booster, 1);
      }
    }
    else if ( Quote.Collision_Flags & 0x2000 )
    {
      Quote.Y_Vel += Gravity;
    }
    else if ( Quote.Equipped_Items & 1 && Quote.boost_sw && Quote.Y_Vel > -1024 )
    {
      Quote.Y_Vel -= 32;
      if ( !(Quote.Booster_Fuel % 3) )
      {
        Create_Effect(Quote.X_Pos, Quote.Y_Pos + Quote.Hitbox.bottom / 2, 7, 3);
        Play_Sound_Effect(Sfx_Booster, 1);
      }
      if ( Quote.Collision_Flags & 2 )
        Quote.Y_Vel = 512;
    }
    else if ( Quote.Y_Vel < 0 && a1 && Key_Jump & Key_Held )
    {
      Quote.Y_Vel += Gravity_When_Pressing_Jump;
    }
    else
    {
      Quote.Y_Vel += Gravity;
    }
    if ( !a1 || !(Key_Jump & Key_Pressed) )
    {
      if ( Quote.Collision_Flags & 0x10 && Quote.X_Vel < 0 )
        Quote.Y_Vel = -Quote.X_Vel;
      if ( Quote.Collision_Flags & 0x20 && Quote.X_Vel > 0 )
        Quote.Y_Vel = Quote.X_Vel;
      if ( Quote.Collision_Flags & 8 && Quote.Collision_Flags & 0x80000 && Quote.X_Vel < 0 )
        Quote.Y_Vel = 1024;
      if ( Quote.Collision_Flags & 8 && Quote.Collision_Flags & 0x10000 && Quote.X_Vel > 0 )
        Quote.Y_Vel = 1024;
      if ( Quote.Collision_Flags & 8 && Quote.Collision_Flags & 0x20000 && Quote.Collision_Flags & 0x40000 )
        Quote.Y_Vel = 1024;
    }
    if ( !(Quote.Collision_Flags & 0x100) || Quote.Collision_Flags & 0xF000 )
    {
      if ( Quote.X_Vel < -1535 )
        Quote.X_Vel = -1535;
      if ( Quote.X_Vel > 1535 )
        Quote.X_Vel = 1535;
      if ( Quote.Y_Vel < -1535 )
        Quote.Y_Vel = -1535;
      if ( Quote.Y_Vel > 1535 )
        Quote.Y_Vel = 1535;
    }
    else
    {
      if ( Quote.X_Vel < -767 )
        Quote.X_Vel = -767;
      if ( Quote.X_Vel > 767 )
        Quote.X_Vel = 767;
      if ( Quote.Y_Vel < -767 )
        Quote.Y_Vel = -767;
      if ( Quote.Y_Vel > 767 )
        Quote.Y_Vel = 767;
    }
    if ( !Quote.sprash && Quote.Collision_Flags & 0x100 )
    {
      if ( Quote.Collision_Flags & 0x800 )
        Direction = 2;
      else
        Direction = 0;
      if ( Quote.Collision_Flags & 8 || Quote.Y_Vel <= 512 )
      {
        if ( Quote.X_Vel > 512 || Quote.X_Vel < -512 )
        {
          for ( i = 0; i < 8; ++i )
          {
            v5 = Quote.X_Pos + (Random(-8, 8) << 9);
            v6 = Random(-512, 128);
            v7 = Random(-512, 512);
            NPC_Create(Balrog_Drop_In|0x40, v5, Quote.Y_Pos, Quote.X_Vel + v7, v6, (Directions)Direction, NULL, 0);
          }
          Play_Sound_Effect(Sfx_Water_Splash, 1);// Play water splash
        }
      }
      else
      {
        for ( j = 0; j < 8; ++j )
        {
          X_Pos = Quote.X_Pos + (Random(-8, 8) << 9);
          v3 = Random(-512, 128) - Quote.Y_Vel / 2;
          v4 = Random(-512, 512);
          NPC_Create(Balrog_Drop_In|0x40, X_Pos, Quote.Y_Pos, Quote.X_Vel + v4, v3, (Directions)Direction, NULL, 0);
        }
        Play_Sound_Effect(Sfx_Water_Splash, 1); // Play water splash
      }
      Quote.sprash = 1;
    }
    if ( !(Quote.Collision_Flags & 0x100) )
      Quote.sprash = 0;
    if ( Quote.Collision_Flags & 0x400 )
      Damage_Player(10);
    if ( Quote.Direction )
    {
      Quote.Camera_X_Vel += 512;
      if ( Quote.Camera_X_Vel > 0x8000 )
        Quote.Camera_X_Vel = 0x8000;
    }
    else
    {
      Quote.Camera_X_Vel -= 512;
      if ( Quote.Camera_X_Vel < -32768 )
        Quote.Camera_X_Vel = -32768;
    }
    if ( Key_Up & Key_Held && a1 )
    {
      Quote.Camera_Y_Vel -= 512;
      if ( Quote.Camera_Y_Vel < -32768 )
        Quote.Camera_Y_Vel = -32768;
    }
    else if ( Key_Down & Key_Held && a1 )
    {
      Quote.Camera_Y_Vel += 512;
      if ( Quote.Camera_Y_Vel > 0x8000 )
        Quote.Camera_Y_Vel = 0x8000;
    }
    else
    {
      if ( Quote.Camera_Y_Vel > 512 )
        Quote.Camera_Y_Vel -= 512;
      if ( Quote.Camera_Y_Vel < -512 )
        Quote.Camera_Y_Vel += 512;
    }
    result = Quote.Camera_X_Vel + Quote.X_Pos;
    Quote.Camera_X_Pos = Quote.Camera_X_Vel + Quote.X_Pos;
    Quote.Camera_Y_Pos = Quote.Camera_Y_Vel + Quote.Y_Pos;
    if ( Quote.X_Vel > Friction || (result = -Friction, Quote.X_Vel < -Friction) )
      Quote.X_Pos += Quote.X_Vel;
    Quote.Y_Pos += Quote.Y_Vel;
  }
  return result;
}
// 493610: using guessed type int Key_Jump;
// 493614: using guessed type int Key_Shoot;
// 493630: using guessed type int Key_Left;
// 493634: using guessed type int Key_Up;
// 493638: using guessed type int Key_Right;
// 49363C: using guessed type int Key_Down;
// 49E1E8: using guessed type int Game_Flags;
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;

//----- (00416470) --------------------------------------------------------
// Also does the fish battle mode
int __cdecl Quote_Movement(int a1)
{
  int result; // eax@73

  Quote.Is_Facing_Up = 0;
  Quote.Is_Facing_Down = 0;
  if ( a1 )
  {
    if ( Key_Held & (Key_Right | Key_Left) )
    {
      if ( Key_Left & Key_Held )
        Quote.X_Vel -= 256;
      if ( Key_Right & Key_Held )
        Quote.X_Vel += 256;
    }
    else if ( Quote.X_Vel >= 128 || Quote.X_Vel <= -128 )
    {
      if ( Quote.X_Vel <= 0 )
        Quote.X_Vel += Quote.X_Vel < 0 ? 0x80 : 0;
      else
        Quote.X_Vel -= 128;
    }
    else
    {
      Quote.X_Vel = 0;
    }
    if ( Key_Held & (Key_Down | Key_Up) )
    {
      if ( Key_Up & Key_Held )
        Quote.Y_Vel -= 256;
      if ( Key_Down & Key_Held )
        Quote.Y_Vel += 256;
    }
    else if ( Quote.Y_Vel >= 128 || Quote.Y_Vel <= -128 )
    {
      if ( Quote.Y_Vel <= 0 )
        Quote.Y_Vel += Quote.Y_Vel < 0 ? 0x80 : 0;
      else
        Quote.Y_Vel -= 128;
    }
    else
    {
      Quote.Y_Vel = 0;
    }
  }
  else
  {
    if ( Quote.X_Vel >= 128 || Quote.X_Vel <= -64 )
    {
      if ( Quote.X_Vel <= 0 )
        Quote.X_Vel += Quote.X_Vel < 0 ? 0x80 : 0;
      else
        Quote.X_Vel -= 128;
    }
    else
    {
      Quote.X_Vel = 0;
    }
    if ( Quote.Y_Vel >= 128 || Quote.Y_Vel <= -64 )
    {
      if ( Quote.Y_Vel <= 0 )
        Quote.Y_Vel += Quote.Y_Vel < 0 ? 0x80 : 0;
      else
        Quote.Y_Vel -= 128;
    }
    else
    {
      Quote.Y_Vel = 0;
    }
  }
  if ( Quote.Y_Vel < -512 && Quote.Collision_Flags & 2 )
    Create_Effect(Quote.X_Pos, Quote.Y_Pos - Quote.Hitbox.top, 13, 5);
  if ( Quote.Y_Vel > 512 && Quote.Collision_Flags & 8 )
    Create_Effect(Quote.X_Pos, Quote.Hitbox.bottom + Quote.Y_Pos, 13, 5);
  if ( Quote.X_Vel > 1024 )
    Quote.X_Vel = 1024;
  if ( Quote.X_Vel < -1024 )
    Quote.X_Vel = -1024;
  if ( Quote.Y_Vel > 1024 )
    Quote.Y_Vel = 1024;
  if ( Quote.Y_Vel < -1024 )
    Quote.Y_Vel = -1024;
  if ( (Key_Held & (Key_Up | Key_Left)) == (Key_Up | Key_Left) )
  {
    if ( Quote.X_Vel < -780 )
      Quote.X_Vel = -780;
    if ( Quote.Y_Vel < -780 )
      Quote.Y_Vel = -780;
  }
  if ( (Key_Held & (Key_Up | Key_Right)) == (Key_Up | Key_Right) )
  {
    if ( Quote.X_Vel > 780 )
      Quote.X_Vel = 780;
    if ( Quote.Y_Vel < -780 )
      Quote.Y_Vel = -780;
  }
  if ( (Key_Held & (Key_Down | Key_Left)) == (Key_Down | Key_Left) )
  {
    if ( Quote.X_Vel < -780 )
      Quote.X_Vel = -780;
    if ( Quote.Y_Vel > 780 )
      Quote.Y_Vel = 780;
  }
  if ( (Key_Held & (Key_Down | Key_Right)) == (Key_Down | Key_Right) )
  {
    if ( Quote.X_Vel > 780 )
      Quote.X_Vel = 780;
    if ( Quote.Y_Vel > 780 )
      Quote.Y_Vel = 780;
  }
  Quote.X_Pos += Quote.X_Vel;
  result = Quote.Y_Vel + Quote.Y_Pos;
  Quote.Y_Pos += Quote.Y_Vel;
  return result;
}
// 493630: using guessed type int Key_Left;
// 493634: using guessed type int Key_Up;
// 493638: using guessed type int Key_Right;
// 49363C: using guessed type int Key_Down;
// 49E210: using guessed type int Key_Held;

//----- (004168C0) --------------------------------------------------------
int __cdecl Player_Related_Maybe(int a1)
{
  int result; // eax@1

  result = Quote.Flags & 0x80;
  if ( Quote.Flags & 0x80 )
  {
    if ( Quote.Level_Bar_Flashes )
      --Quote.Level_Bar_Flashes;
    if ( Quote.Invincibility_Timer )
    {
      --Quote.Invincibility_Timer;
    }
    else if ( Quote.Exp_To_Gain )
    {
      Set_Value_View((__int32)&Quote.X_Pos, (__int32)&Quote.Y_Pos, Quote.Exp_To_Gain);
      Quote.Exp_To_Gain = 0;
    }
    if ( Quote.Unit )
    {
      if ( Quote.Unit == 1 )
        Quote_Movement(a1);
    }
    else
    {
      if ( !(Game_Flags & 4) && a1 )
        Quote_Air();
      Physics(a1);
    }
    result = Quote.Flags & 0xDF;
    Quote.Flags &= 0xDFu;
  }
  return result;
}
// 49E1E8: using guessed type int Game_Flags;

//----- (00416990) --------------------------------------------------------
void Quote_Air()
{
  if ( Quote.Equipped_Items & 0x10 )
  {
    Quote.Air = 1000;
    Quote.air_get = 0;
  }
  else
  {
    if ( Quote.Collision_Flags & 0x100 )
    {
      if ( --Quote.Air <= 0 )
      {
        if ( Get_NPC_Flag(4000) )
        {
          Start_TSC_Event(1100);
        }
        else
        {
          Start_TSC_Event(41);
          if ( Quote.Direction )
            Create_Effect(Quote.X_Pos, Quote.Y_Pos, 8, 2);
          else
            Create_Effect(Quote.X_Pos, Quote.Y_Pos, 8, 0);
          Quote.Flags &= 0x7Fu;
        }
      }
    }
    else
    {
      Quote.Air = 1000;
    }
    if ( Quote.Collision_Flags & 0x100 )
    {
      Quote.air_get = 60;
    }
    else if ( Quote.air_get )
    {
      --Quote.air_get;
    }
  }
}

//----- (00416AA0) --------------------------------------------------------
void __cdecl Get_Quote_Pos(int *X_Pos, int *Y_Pos)
{
  *X_Pos = Quote.X_Pos;
  *Y_Pos = Quote.Y_Pos;
}

//----- (00416AC0) --------------------------------------------------------
// TSC : MOVe Quote
void __cdecl Set_Quote_Position(int X_Pos, int Y_Pos)
{
  Quote.X_Pos = X_Pos;
  Quote.Y_Pos = Y_Pos;
  Quote.Camera_X_Pos = X_Pos;
  Quote.Camera_Y_Pos = Y_Pos;
  Quote.Camera_X_Vel = 0;
  Quote.Camera_Y_Vel = 0;
  Quote.X_Vel = 0;
  Quote.Y_Vel = 0;
  Quote.Flags &= ~1u;
  Init_Whimsical_Star();
}

//----- (00416B30) --------------------------------------------------------
// Unused
int __cdecl Instantly_Set_X_Y_Pos(int New_X_Position, int New_Y_Position)
{
  int result; // eax@1

  result = New_X_Position;
  Quote.X_Pos = New_X_Position;
  Quote.Y_Pos = New_Y_Position;
  return result;
}

//----- (00416B60) --------------------------------------------------------
// TSC : UNiverse Jump ?
// Check if in Fish Battle
int Tsc_UNJ()
{
  return Quote.Unit;
}

//----- (00416B70) --------------------------------------------------------
// TSC : MY char Direction change ?
// Changes the player's direction
void __cdecl Set_Player_Direction(unsigned __int8 New_Direction)
{
  signed int i; // [sp+0h] [bp-4h]@5

  if ( New_Direction == 3 )
  {
    Quote.Flags |= 1u;
LABEL_13:
    Quote.X_Vel = 0;
    Do_Player_Animation(0);
    return;
  }
  Quote.Flags &= 0xFEu;
  if ( (signed int)New_Direction < 10 )
  {
    Quote.Direction = New_Direction;
    goto LABEL_13;
  }
  for ( i = 0; i < 512 && NPC_Objects[i].Entity_Eve_Num != New_Direction; ++i )
    ;
  if ( i != 512 )
  {
    if ( Quote.X_Pos <= NPC_Objects[i].X_pos )
      Quote.Direction = 2;
    else
      Quote.Direction = 0;
    goto LABEL_13;
  }
}

//----- (00416C40) --------------------------------------------------------
void __cdecl Change_Unit(unsigned __int8 New_Unit)
{
  Quote.Unit = New_Unit;
}

//----- (00416C50) --------------------------------------------------------
// Moves the player 4000 units down instantly.
// Unused
int Add_Quote_Y_Pos_4000h()
{
  int result; // eax@1

  result = Quote.Y_Pos + 0x4000;
  Quote.Y_Pos += 0x4000;
  return result;
}

//----- (00416C70) --------------------------------------------------------
// EQ+ : EQuip +
// EQ- : EQuip -
// Equips or unequips items
void __cdecl Equip_Item(int Item_To_Equip, bool Unequip)
{
  if ( !Unequip )
    Quote.Equipped_Items &= ~Item_To_Equip;
  else
    Quote.Equipped_Items |= Item_To_Equip;
}

//----- (00416CA0) --------------------------------------------------------
// Leaves "Inspecting" mode
// Unused
int AND_Player_Flags_minus2()
{
  int result; // eax@1

  result = Quote.Flags & 0xFE;
  Quote.Flags &= 0xFEu;
  return result;
}

//----- (00416CC0) --------------------------------------------------------
void __cdecl Set_Noise(int Num, int Frequency)
{
  Noise_Frequency = Frequency;
  Noise_Num = Num;
  if ( Num == 1 )
  {
    Change_Sound_Frequency(40, Noise_Frequency);
    Change_Sound_Frequency(41, Noise_Frequency + 100);
    Play_Sound_Effect(Sfx_Stream_Noise_SSS_2, -1);
    Play_Sound_Effect(Sfx_Stream_Noise_SSS_1, -1);
  }
  else if ( Num == 2 )
  {
    Play_Sound_Effect(Sfx_Helicopter_Blades_SPS, -1);
  }
}
// 49E6EC: using guessed type int Noise_Num;

//----- (00416D40) --------------------------------------------------------
// Enviroment sound = 0, play sound 28,29,3A
void __cdecl Cut_Noise()
{
  Noise_Num = 0;
  Play_Sound_Effect(Sfx_Stream_Noise_SSS_2, 0);
  Play_Sound_Effect(Sfx_Stream_Noise_SSS_1, 0);
  Play_Sound_Effect(Sfx_Helicopter_Blades_SPS, 0);
}
// 49E6EC: using guessed type int Noise_Num;

//----- (00416D80) --------------------------------------------------------
void Play_Environmental_Sounds()
{
  if ( Noise_Num == 1 )
  {
    Change_Sound_Frequency(40, Noise_Frequency);
    Change_Sound_Frequency(41, Noise_Frequency + 100);
    Play_Sound_Effect(Sfx_Stream_Noise_SSS_2, -1);
    Play_Sound_Effect(Sfx_Stream_Noise_SSS_1, -1);
  }
  else if ( Noise_Num == 2 )
  {
    Play_Sound_Effect(Sfx_Helicopter_Blades_SPS, -1);
  }
}
// 49E6EC: using guessed type int Noise_Num;

//----- (00416DF0) --------------------------------------------------------
void Play_Sound_40_41_58()
{
  Play_Sound_Effect(Sfx_Stream_Noise_SSS_2, 0);
  Play_Sound_Effect(Sfx_Stream_Noise_SSS_1, 0);
  Play_Sound_Effect(Sfx_Helicopter_Blades_SPS, 0);
}

//----- (00416E30) --------------------------------------------------------
signed int __cdecl Quote_Collision_Block(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 4) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 4) << 9
    && Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 8) << 9
    && Quote.X_Pos - Quote.Hitbox.back > X_Pos << 13 )
  {
    Quote.X_Pos = Quote.Hitbox.back + ((16 * X_Pos + 8) << 9);
    if ( Quote.X_Vel < -384 )
      Quote.X_Vel = -384;
    if ( !(Key_Left & Key_Held) && Quote.X_Vel < 0 )
      Quote.X_Vel = 0;
    hit = 1;
  }
  if ( Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 4) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 4) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Hitbox.back + Quote.X_Pos < X_Pos << 13 )
  {
    Quote.X_Pos = ((16 * X_Pos - 8) << 9) - Quote.Hitbox.back;
    if ( Quote.X_Vel > 384 )
      Quote.X_Vel = 384;
    if ( !(Key_Right & Key_Held) && Quote.X_Vel > 0 )
      Quote.X_Vel = 0;
    hit |= 4u;
  }
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 5) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 5) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 8) << 9
    && Quote.Y_Pos - Quote.Hitbox.top > Y_Pos << 13 )
  {
    Quote.Y_Pos = Quote.Hitbox.top + ((16 * Y_Pos + 8) << 9);
    if ( !(Quote.Flags & 2) && Quote.Y_Vel < -512 )
      Put_Bump_Stars();
    if ( Quote.Y_Vel < 0 )
      Quote.Y_Vel = 0;
    hit |= 2u;
  }
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 5) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 5) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 8) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos < Y_Pos << 13 )
  {
    Quote.Y_Pos = ((16 * Y_Pos - 8) << 9) - Quote.Hitbox.bottom;
    if ( Quote.Y_Vel > 1024 )
      Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
    if ( Quote.Y_Vel > 0 )
      Quote.Y_Vel = 0;
    hit |= 8u;
  }
  return hit;
}
// 493630: using guessed type int Key_Left;
// 493638: using guessed type int Key_Right;
// 49E210: using guessed type int Key_Held;

//----- (00417160) --------------------------------------------------------
void Put_Bump_Stars()
{
  if ( !(Quote.Flags & 2) && Quote.Y_Vel < -512 )
  {
    Play_Sound_Effect(Sfx_Quote_Bump_Head, 1);
    Create_Effect(Quote.X_Pos, Quote.Y_Pos - Quote.Hitbox.top, 13, 0);
    Create_Effect(Quote.X_Pos, Quote.Y_Pos - Quote.Hitbox.top, 13, 0);
  }
}

//----- (004171D0) --------------------------------------------------------
signed int __cdecl Quote_Collision_Roof_Slope_1(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 + 2048
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 8) << 9 )
  {
    Quote.Y_Pos = (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 + Quote.Hitbox.top + 2048;
    if ( !(Quote.Flags & 2) && Quote.Y_Vel < -512 )
      Put_Bump_Stars();
    if ( Quote.Y_Vel < 0 )
      Quote.Y_Vel = 0;
    hit = 2;
  }
  return hit;
}

//----- (004172E0) --------------------------------------------------------
signed int __cdecl Quote_Collision_Roof_Slope_2(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 - 2048
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 8) << 9 )
  {
    Quote.Y_Pos = (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 + Quote.Hitbox.top - 2048;
    if ( !(Quote.Flags & 2) && Quote.Y_Vel < -512 )
      Put_Bump_Stars();
    if ( Quote.Y_Vel < 0 )
      Quote.Y_Vel = 0;
    hit = 2;
  }
  return hit;
}

//----- (004173F0) --------------------------------------------------------
signed int __cdecl Quote_Collision_Roof_Slope_3(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (Y_Pos << 13) + (Quote.X_Pos - (X_Pos << 13)) / 2 - 2048
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 8) << 9 )
  {
    Quote.Y_Pos = (Quote.X_Pos - (X_Pos << 13)) / 2 + Quote.Hitbox.top + (Y_Pos << 13) - 2048;
    if ( !(Quote.Flags & 2) && Quote.Y_Vel < -512 )
      Put_Bump_Stars();
    if ( Quote.Y_Vel < 0 )
      Quote.Y_Vel = 0;
    hit = 2;
  }
  return hit;
}

//----- (00417500) --------------------------------------------------------
signed int __cdecl Quote_Collision_Roof_Slope_4(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (Y_Pos << 13) + (Quote.X_Pos - (X_Pos << 13)) / 2 + 2048
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 8) << 9 )
  {
    Quote.Y_Pos = (Quote.X_Pos - (X_Pos << 13)) / 2 + Quote.Hitbox.top + (Y_Pos << 13) + 2048;
    if ( !(Quote.Flags & 2) && Quote.Y_Vel < -512 )
      Put_Bump_Stars();
    if ( Quote.Y_Vel < 0 )
      Quote.Y_Vel = 0;
    hit = 2;
  }
  return hit;
}

//----- (00417610) --------------------------------------------------------
signed int __cdecl Quote_Collision_Floor_Slope_1(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x10000;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (Y_Pos << 13) + (Quote.X_Pos - (X_Pos << 13)) / 2 - 2048
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 8) << 9 )
  {
    Quote.Y_Pos = (Y_Pos << 13) + (Quote.X_Pos - (X_Pos << 13)) / 2 - 2048 - Quote.Hitbox.bottom;
    if ( Quote.Y_Vel > 1024 )
      Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
    if ( Quote.Y_Vel > 0 )
      Quote.Y_Vel = 0;
    hit = 0x10028;
  }
  return hit;
}

//----- (00417720) --------------------------------------------------------
signed int __cdecl Quote_Collision_Floor_Slope_2(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x20000;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (Y_Pos << 13) + (Quote.X_Pos - (X_Pos << 13)) / 2 + 2048
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 8) << 9 )
  {
    Quote.Y_Pos = (Y_Pos << 13) + (Quote.X_Pos - (X_Pos << 13)) / 2 + 2048 - Quote.Hitbox.bottom;
    if ( Quote.Y_Vel > 1024 )
      Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
    if ( Quote.Y_Vel > 0 )
      Quote.Y_Vel = 0;
    hit = 0x20028;
  }
  return hit;
}

//----- (00417830) --------------------------------------------------------
signed int __cdecl Quote_Collision_Floor_Slope_3(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x40000;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 + 2048
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 8) << 9 )
  {
    Quote.Y_Pos = (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 + 2048 - Quote.Hitbox.bottom;
    if ( Quote.Y_Vel > 1024 )
      Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
    if ( Quote.Y_Vel > 0 )
      Quote.Y_Vel = 0;
    hit = 0x40018;
  }
  return hit;
}

//----- (00417940) --------------------------------------------------------
signed int __cdecl Quote_Collision_Floor_Slope_4(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x80000;
  if ( Quote.X_Pos < (16 * X_Pos + 8) << 9
    && Quote.X_Pos > (16 * X_Pos - 8) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 - 2048
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 8) << 9 )
  {
    Quote.Y_Pos = (Y_Pos << 13) - (Quote.X_Pos - (X_Pos << 13)) / 2 - 2048 - Quote.Hitbox.bottom;
    if ( Quote.Y_Vel > 1024 )
      Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
    if ( Quote.Y_Vel > 0 )
      Quote.Y_Vel = 0;
    hit = 524312;
  }
  return hit;
}

//----- (00417A50) --------------------------------------------------------
signed int __cdecl Quote_Collision_Water(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 5) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 5) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 5) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > Y_Pos << 13 )
  {
    hit = 0x100;
  }
  return hit;
}

//----- (00417AE0) --------------------------------------------------------
signed int __cdecl Quote_Collision_Spike(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - 2048 < (16 * X_Pos + 4) << 9
    && Quote.X_Pos + 2048 > (16 * X_Pos - 4) << 9
    && Quote.Y_Pos - 2048 < (16 * Y_Pos + 3) << 9
    && Quote.Y_Pos + 2048 > (16 * Y_Pos - 3) << 9 )
  {
    hit = 0x400;
  }
  return hit;
}

//----- (00417B70) --------------------------------------------------------
signed int __cdecl Quote_Collision_Spike_Water(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - 2048 < (16 * X_Pos + 4) << 9
    && Quote.X_Pos + 2048 > (16 * X_Pos - 4) << 9
    && Quote.Y_Pos - 2048 < (16 * Y_Pos + 3) << 9
    && Quote.Y_Pos + 2048 > (16 * Y_Pos - 3) << 9 )
  {
    hit = 0xD00;
  }
  return hit;
}

//----- (00417C00) --------------------------------------------------------
signed int __cdecl Quote_Collision_Wind_Left(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 6) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 6) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 6) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 6) << 9 )
  {
    hit = 0x1000;
  }
  return hit;
}

//----- (00417C90) --------------------------------------------------------
signed int __cdecl Quote_Collision_Wind_Up(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 6) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 6) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 6) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 6) << 9 )
  {
    hit = 0x2000;
  }
  return hit;
}

//----- (00417D20) --------------------------------------------------------
signed int __cdecl Quote_Collision_Wind_Right(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 6) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 6) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 6) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 6) << 9 )
  {
    hit = 0x4000;
  }
  return hit;
}

//----- (00417DB0) --------------------------------------------------------
signed int __cdecl Quote_Collision_Wind_Down(int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.X_Pos - Quote.Hitbox.back < (16 * X_Pos + 6) << 9
    && Quote.Hitbox.back + Quote.X_Pos > (16 * X_Pos - 6) << 9
    && Quote.Y_Pos - Quote.Hitbox.top < (16 * Y_Pos + 6) << 9
    && Quote.Hitbox.bottom + Quote.Y_Pos > (16 * Y_Pos - 6) << 9 )
  {
    hit = 0x8000;
  }
  return hit;
}

//----- (00417E40) --------------------------------------------------------
void __cdecl Do_Collision_Check_Player_Map()
{
  int Off_X[4]; // [sp+4h] [bp-30h]@1
  char Attributes[4]; // [sp+14h] [bp-20h]@4
  int i; // [sp+18h] [bp-1Ch]@1
  int Off_Y[4]; // [sp+1Ch] [bp-18h]@1
  int Quote_X_Pos_Blocks; // [sp+2Ch] [bp-8h]@1
  int Quote_Y_Pos_Blocks; // [sp+30h] [bp-4h]@1

  Quote_X_Pos_Blocks = Quote.X_Pos / 16 / 512;
  Quote_Y_Pos_Blocks = Quote.Y_Pos / 16 / 512;
  Off_X[0] = 0;
  Off_X[1] = 1;
  Off_X[2] = 0;
  Off_X[3] = 1;
  Off_Y[0] = 0;
  Off_Y[1] = 0;
  Off_Y[2] = 1;
  Off_Y[3] = 1;
  for ( i = 0; i < 4; ++i )
  {
    Attributes[i] = Get_Tile_Attributes(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
    switch ( Attributes[i] )
    {
      case 5:
      case 65:
      case 67:
      case 70:
        Quote.Collision_Flags |= Quote_Collision_Block(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 80:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_1(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 81:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_2(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 82:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_3(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 83:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_4(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 84:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_1(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 85:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_2(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 86:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_3(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 87:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_4(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 66:
        Quote.Collision_Flags |= Quote_Collision_Spike(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 98:
        Quote.Collision_Flags |= Quote_Collision_Spike_Water(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 128:
        Quote.Collision_Flags |= Quote_Collision_Wind_Left(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 129:
        Quote.Collision_Flags |= Quote_Collision_Wind_Up(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 130:
        Quote.Collision_Flags |= Quote_Collision_Wind_Right(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 131:
        Quote.Collision_Flags |= Quote_Collision_Wind_Down(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 2:
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 96:
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 97:
        Quote.Collision_Flags |= Quote_Collision_Block(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 112:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_1(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 113:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_2(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 114:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_3(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 115:
        Quote.Collision_Flags |= Quote_Collision_Roof_Slope_4(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 116:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_1(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 117:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_2(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 118:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_3(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 119:
        Quote.Collision_Flags |= Quote_Collision_Floor_Slope_4(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 160:
        Quote.Collision_Flags |= Quote_Collision_Wind_Left(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 161:
        Quote.Collision_Flags |= Quote_Collision_Wind_Up(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 162:
        Quote.Collision_Flags |= Quote_Collision_Wind_Right(
                                   Off_X[i] + Quote_X_Pos_Blocks,
                                   Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      case 163:
        Quote.Collision_Flags |= Quote_Collision_Wind_Down(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        Quote.Collision_Flags |= Quote_Collision_Water(Off_X[i] + Quote_X_Pos_Blocks, Off_Y[i] + Quote_Y_Pos_Blocks);
        break;
      default:
        continue;
    }
  }
  if ( Quote.Y_Pos > GlobalWaterDepth + 2048 )
    Quote.Collision_Flags |= 0x100u;
}
// 499C90: using guessed type int GlobalWaterDepth;
// 417E40: using guessed type char Attributes[4];

//----- (004187F0) --------------------------------------------------------
signed int __cdecl Entity_Collision_Solid(NPC_vars *npc)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( Quote.Y_Pos - Quote.Hitbox.top < npc->Y_pos + npc->Hitbox.bottom - 1536
    && Quote.Hitbox.bottom + Quote.Y_Pos > npc->Y_pos - npc->Hitbox.top + 1536
    && Quote.X_Pos - Quote.Hitbox.back < npc->Hitbox.back + npc->X_pos
    && Quote.X_Pos - Quote.Hitbox.back > npc->X_pos )
  {
    if ( Quote.X_Vel < 512 )
      Quote.X_Vel += 512;
    hit = 1;
  }
  if ( Quote.Y_Pos - Quote.Hitbox.top < npc->Y_pos + npc->Hitbox.bottom - 1536
    && Quote.Hitbox.bottom + Quote.Y_Pos > npc->Y_pos - npc->Hitbox.top + 1536
    && Quote.X_Pos + Quote.Hitbox.back - 512 > npc->X_pos - npc->Hitbox.back
    && Quote.X_Pos + Quote.Hitbox.back - 512 < npc->X_pos )
  {
    if ( Quote.X_Vel > -512 )
      Quote.X_Vel -= 512;
    hit |= 4u;
  }
  if ( Quote.X_Pos - Quote.Hitbox.back < npc->X_pos + npc->Hitbox.back - 1536
    && Quote.Hitbox.back + Quote.X_Pos > npc->X_pos - npc->Hitbox.back + 1536
    && Quote.Y_Pos - Quote.Hitbox.top < npc->Hitbox.bottom + npc->Y_pos
    && Quote.Y_Pos - Quote.Hitbox.top > npc->Y_pos )
  {
    if ( Quote.Y_Vel < 0 )
      Quote.Y_Vel = 0;
    hit |= 2u;
  }
  if ( Quote.X_Pos - Quote.Hitbox.back < npc->X_pos + npc->Hitbox.back - 1536
    && Quote.Hitbox.back + Quote.X_Pos > npc->X_pos - npc->Hitbox.back + 1536
    && Quote.Hitbox.bottom + Quote.Y_Pos > npc->Y_pos - npc->Hitbox.top
    && Quote.Hitbox.bottom + Quote.Y_Pos < npc->Y_pos + 1536 )
  {
    if ( npc->Entity_Flags & 0x10 )
    {
      Quote.Y_Vel = npc->Y_vel - 512;
      hit |= 8u;
    }
    else if ( !(Quote.Collision_Flags & 8) && Quote.Y_Vel > npc->Y_vel )
    {
      Quote.Y_Pos = npc->Y_pos - npc->Hitbox.top - Quote.Hitbox.bottom + 512;
      Quote.Y_Vel = npc->Y_vel;
      Quote.X_Pos += npc->X_vel;
      hit |= 8u;
    }
  }
  return hit;
}

//----- (00418B10) --------------------------------------------------------
unsigned __int8 __cdecl Entity_Collision_NonSolid(NPC_vars *npc)
{
  if ( npc->Direction )
  {
    if ( Quote.X_Pos + 1024 > npc->X_pos - npc->Hitbox.back
      && Quote.X_Pos - 1024 < npc->Hitbox.front + npc->X_pos
      && Quote.Y_Pos + 1024 > npc->Y_pos - npc->Hitbox.top
      && Quote.Y_Pos - 1024 < npc->Hitbox.bottom + npc->Y_pos )
    {
      return 1;
    }
  }
  else if ( Quote.X_Pos + 1024 > npc->X_pos - npc->Hitbox.front
         && Quote.X_Pos - 1024 < npc->Hitbox.back + npc->X_pos
         && Quote.Y_Pos + 1024 > npc->Y_pos - npc->Hitbox.top
         && Quote.Y_Pos - 1024 < npc->Hitbox.bottom + npc->Y_pos )
  {
    return 1;
  }
  return 0;
}

//----- (00418C20) --------------------------------------------------------
signed int __cdecl Entity_Collision_SpecialSolid(NPC_vars *npc)
{
  float fy2; // ST1C_4@11
  float fx2; // [sp+10h] [bp-14h]@7
  signed int hit; // [sp+18h] [bp-Ch]@1
  float fy1; // [sp+1Ch] [bp-8h]@5
  float fx1; // [sp+20h] [bp-4h]@2

  hit = 0;
  if ( npc->X_pos <= Quote.X_Pos )
    fx1 = (long double)(Quote.X_Pos - npc->X_pos);
  else
    fx1 = (long double)(npc->X_pos - Quote.X_Pos);
  if ( npc->Y_pos <= Quote.Y_Pos )
    fy1 = (long double)(Quote.Y_Pos - npc->Y_pos);
  else
    fy1 = (long double)(npc->Y_pos - Quote.Y_Pos);
  fx2 = (long double)npc->Hitbox.back;
  if ( fx1 == 0.0 )
    fx1 = 1.0;
  if ( fx2 == 0.0 )
    fx2 = 1.0;
  fy2 = (long double)npc->Hitbox.top;
  if ( fy2 / fx2 >= fy1 / fx1 )
  {
    if ( Quote.Y_Pos - Quote.Hitbox.top < npc->Hitbox.bottom + npc->Y_pos
      && Quote.Hitbox.bottom + Quote.Y_Pos > npc->Y_pos - npc->Hitbox.top )
    {
      if ( Quote.X_Pos - Quote.Hitbox.back < npc->Hitbox.back + npc->X_pos
        && Quote.X_Pos - Quote.Hitbox.back > npc->X_pos )
      {
        if ( Quote.X_Vel < npc->X_vel )
          Quote.X_Vel = npc->X_vel;
        Quote.X_Pos = Quote.Hitbox.back + npc->Hitbox.back + npc->X_pos;
        hit = 1;
      }
      if ( Quote.Hitbox.back + Quote.X_Pos > npc->X_pos - npc->Hitbox.back
        && Quote.Hitbox.back + Quote.X_Pos < npc->X_pos )
      {
        if ( Quote.X_Vel > npc->X_vel )
          Quote.X_Vel = npc->X_vel;
        Quote.X_Pos = npc->X_pos - npc->Hitbox.back - Quote.Hitbox.back;
        hit |= 4u;
      }
    }
  }
  else if ( Quote.X_Pos - Quote.Hitbox.back < npc->Hitbox.back + npc->X_pos
         && Quote.Hitbox.back + Quote.X_Pos > npc->X_pos - npc->Hitbox.back )
  {
    if ( Quote.Y_Pos - Quote.Hitbox.top < npc->Hitbox.bottom + npc->Y_pos && Quote.Y_Pos - Quote.Hitbox.top > npc->Y_pos )
    {
      if ( Quote.Y_Vel >= npc->Y_vel )
      {
        if ( Quote.Y_Vel < 0 )
          Quote.Y_Vel = 0;
      }
      else
      {
        Quote.Y_Pos = npc->Hitbox.bottom + npc->Y_pos + Quote.Hitbox.top + 512;
        Quote.Y_Vel = npc->Y_vel;
      }
      hit = 2;
    }
    if ( Quote.Hitbox.bottom + Quote.Y_Pos > npc->Y_pos - npc->Hitbox.top
      && Quote.Hitbox.bottom + Quote.Y_Pos < npc->Y_pos + 1536 )
    {
      if ( Quote.Y_Vel - npc->Y_vel > 1024 )
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      if ( Quote.Unit == 1 )
      {
        Quote.Y_Pos = npc->Y_pos - npc->Hitbox.top - Quote.Hitbox.bottom + 512;
        hit |= 8u;
      }
      else if ( npc->Entity_Flags & 0x10 )
      {
        Quote.Y_Vel = npc->Y_vel - 512;
        hit |= 8u;
      }
      else if ( !(Quote.Collision_Flags & 8) && Quote.Y_Vel > npc->Y_vel )
      {
        Quote.Y_Pos = npc->Y_pos - npc->Hitbox.top - Quote.Hitbox.bottom + 512;
        Quote.Y_Vel = npc->Y_vel;
        Quote.X_Pos += npc->X_vel;
        hit |= 8u;
      }
    }
  }
  return hit;
}

//----- (00419030) --------------------------------------------------------
// Run collision checks for every entity vs. Quote
void Do_Collision_Check_Player_NPCs()
{
  signed int hit; // [sp+0h] [bp-8h]@9
  signed int i; // [sp+4h] [bp-4h]@4

  if ( Quote.Flags & 0x80 && !(Quote.Flags & 2) )
  {
    for ( i = 0; i < 512; ++i )
    {
      if ( NPC_Objects[i].Is_Alive & 0x80 )
      {
        if ( NPC_Objects[i].Entity_Flags & 1 )
        {
          hit = Entity_Collision_Solid(&NPC_Objects[i]);
          Quote.Collision_Flags |= hit;
        }
        else if ( NPC_Objects[i].Entity_Flags & 0x40 )
        {
          hit = Entity_Collision_SpecialSolid(&NPC_Objects[i]);
          Quote.Collision_Flags |= hit;
        }
        else
        {
          hit = Entity_Collision_NonSolid(&NPC_Objects[i]);
        }
        if ( hit && NPC_Objects[i].Entity_Type == Weapon_Energy )
        {
          Play_Sound_Effect(Sfx_Get_EXP, 1);
          Add_Weapon_EXP(NPC_Objects[i].EXP_Amount);
          NPC_Objects[i].Is_Alive = 0;
        }
        if ( hit && NPC_Objects[i].Entity_Type == 86 )
        {
          Play_Sound_Effect(Sfx_Quote_Missile_Get, 1);
          Add_Rocket_Ammo(NPC_Objects[i].Entity_Eve_Num, NPC_Objects[i].EXP_Amount);
          NPC_Objects[i].Is_Alive = 0;
        }
        if ( hit && NPC_Objects[i].Entity_Type == 87 )
        {
          Play_Sound_Effect(Sfx_Quote_Heal, 1);
          Add_Life_Player(NPC_Objects[i].EXP_Amount);
          NPC_Objects[i].Is_Alive = 0;
        }
        if ( !(Game_Flags & 4) && hit && NPC_Objects[i].Entity_Flags & 0x100 )
          Start_TSC_Event(NPC_Objects[i].Entity_Eve_Num);
        if ( Game_Flags & 2 && !(NPC_Objects[i].Entity_Flags & 0x2000) )
        {
          if ( NPC_Objects[i].Entity_Flags & 0x80 )
          {
            if ( hit & 4 && NPC_Objects[i].X_vel < 0 )
              Damage_Player(NPC_Objects[i].Damage);
            if ( hit & 1 && NPC_Objects[i].X_vel > 0 )
              Damage_Player(NPC_Objects[i].Damage);
            if ( hit & 8 && NPC_Objects[i].Y_vel < 0 )
              Damage_Player(NPC_Objects[i].Damage);
            if ( hit & 2 && NPC_Objects[i].Y_vel > 0 )
              Damage_Player(NPC_Objects[i].Damage);
          }
          else if ( hit && NPC_Objects[i].Damage && !(Game_Flags & 4) )
          {
            Damage_Player(NPC_Objects[i].Damage);
          }
        }
        if ( !(Game_Flags & 4) && hit && Quote.Flags & 1 )
        {
          if ( NPC_Objects[i].Entity_Flags & 0x2000 )
          {
            Start_TSC_Event(NPC_Objects[i].Entity_Eve_Num);
            Quote.X_Vel = 0;
            Quote.ques = 0;
          }
        }
      }
    }
    if ( Quote.ques )
      Create_Effect(Quote.X_Pos, Quote.Y_Pos, 9, 0);
  }
}
// 49E1E8: using guessed type int Game_Flags;

//----- (00419450) --------------------------------------------------------
// Run collision checks with boss entities vs. Quote
void Do_Collision_Check_Player_Bosses()
{
  signed int i; // [sp+0h] [bp-8h]@4
  signed int hit; // [sp+4h] [bp-4h]@9

  if ( Quote.Flags & 0x80 && !(Quote.Flags & 2) )
  {
    for ( i = 0; i < 20; ++i )
    {
      if ( Boss_Objects[i].Is_Alive & 0x80 )
      {
        if ( Boss_Objects[i].Entity_Flags & 1 )
        {
          hit = Entity_Collision_Solid(&Boss_Objects[i]);
          Quote.Collision_Flags |= hit;
        }
        else if ( Boss_Objects[i].Entity_Flags & 0x40 )
        {
          hit = Entity_Collision_SpecialSolid(&Boss_Objects[i]);
          Quote.Collision_Flags |= hit;
        }
        else
        {
          hit = Entity_Collision_NonSolid(&Boss_Objects[i]);
        }
        if ( !(Game_Flags & 4) && hit && Boss_Objects[i].Entity_Flags & 0x100 )
        {
          Start_TSC_Event(Boss_Objects[i].Entity_Eve_Num);
          Quote.ques = 0;
        }
        if ( Boss_Objects[i].Entity_Flags & 0x80 )
        {
          if ( hit & 4 && Boss_Objects[i].X_vel < 0 )
            Damage_Player(Boss_Objects[i].Damage);
          if ( hit & 1 && Boss_Objects[i].X_vel > 0 )
            Damage_Player(Boss_Objects[i].Damage);
        }
        else if ( hit && Boss_Objects[i].Damage && !(Game_Flags & 4) )
        {
          Damage_Player(Boss_Objects[i].Damage);
        }
        if ( !(Game_Flags & 4) && hit && Quote.Flags & 1 )
        {
          if ( Boss_Objects[i].Entity_Flags & 0x2000 )
          {
            Start_TSC_Event(Boss_Objects[i].Entity_Eve_Num);
            Quote.X_Vel = 0;
            Quote.ques = 0;
          }
        }
      }
    }
    if ( Quote.ques )
      Create_Effect(Quote.X_Pos, Quote.Y_Pos, 9, 0);
  }
}
// 49E1E8: using guessed type int Game_Flags;

//----- (004196F0) --------------------------------------------------------
void __cdecl Add_Weapon_EXP(int EXP_To_Add)
{
  int Level; // [sp+0h] [bp-8h]@1
  int Weapon_ID; // [sp+4h] [bp-4h]@1

  Level = Weapons[Selected_Weapon].Level - 1;
  Weapon_ID = Weapons[Selected_Weapon].ID;
  Weapons[Selected_Weapon].EXP += EXP_To_Add;
  if ( Level == 2 )
  {
    if ( Weapons[Selected_Weapon].EXP >= Weapon_Level_Table[Weapon_ID].exp[2] )
    {
      Weapons[Selected_Weapon].EXP = Weapon_Level_Table[Weapon_ID].exp[2];
      if ( Quote.Equipped_Items & 0x80 )
      {
        if ( Quote.star < 3 )
          ++Quote.star;
      }
    }
  }
  else
  {
    while ( Level < 2 )
    {
      if ( Weapons[Selected_Weapon].EXP >= Weapon_Level_Table[Weapon_ID].exp[Level] )
      {
        ++Weapons[Selected_Weapon].Level;
        Weapons[Selected_Weapon].EXP = 0;
        if ( Weapons[Selected_Weapon].ID != 13 )
        {
          Play_Sound_Effect(Sfx_Level_Up, 1);
          Create_Effect(Quote.X_Pos, Quote.Y_Pos, 10, 0);
        }
      }
      ++Level;
    }
  }
  if ( Weapons[Selected_Weapon].ID == 13 )
  {
    Quote.Level_Bar_Flashes = 10;
  }
  else
  {
    Quote.Exp_To_Gain += EXP_To_Add;
    Quote.Level_Bar_Flashes = 30;
  }
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00419890) --------------------------------------------------------
int Reset_Selected_Weapon_Level(void)
{
  int result; // eax@1

  result = 20 * Selected_Weapon;
  Weapons[Selected_Weapon].Level = 1;
  Weapons[Selected_Weapon].EXP = 0;
  return result;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (004198C0) --------------------------------------------------------
// Returns 1 if weapon at MAX, 0 otherwise
bool Check_Weapon_MAX(void)
{
  return Weapons[Selected_Weapon].Level == 3
      && Weapons[Selected_Weapon].EXP >= Weapon_Level_Table[Weapons[Selected_Weapon].ID].exp[2];
}
// 499C68: using guessed type int Selected_Weapon;

//----- (00419910) --------------------------------------------------------
void __cdecl Damage_Player(int damage)
{
  if ( Game_Flags | 2 && !Quote.Invincibility_Timer )
  {
    Play_Sound_Effect(Sfx_Quote_Hurt, 1);
    Quote.Flags &= 0xFEu;
    Quote.Invincibility_Timer = -128;
    if ( Quote.Unit != 1 )
      Quote.Y_Vel = -1024;                      // Knock back Quote
    Quote.Health -= damage;
    if ( Quote.Equipped_Items & 0x80 && Quote.star > 0 )
      --Quote.star;
    if ( Quote.Equipped_Items & 4 )
      Weapons[Selected_Weapon].EXP -= damage;
    else
      Weapons[Selected_Weapon].EXP -= 2 * damage;
    while ( Weapons[Selected_Weapon].EXP < 0 )
    {
      if ( Weapons[Selected_Weapon].Level <= 1 )
      {
        Weapons[Selected_Weapon].EXP = 0;
      }
      else
      {
        Weapons[Selected_Weapon].EXP += Weapon_Level_Table[Weapons[Selected_Weapon].ID].exp[--Weapons[Selected_Weapon].Level
                                                                                          - 1];
        if ( Quote.Health > 0 && Weapons[Selected_Weapon].ID != 13 )
          Create_Effect(Quote.X_Pos, Quote.Y_Pos, 10, 2);
      }
    }
    Set_Value_View((__int32)&Quote.X_Pos, (__int32)&Quote.Y_Pos, -damage);
    if ( Quote.Health <= 0 )
    {
      Play_Sound_Effect(Sfx_Quote_Die, 1);
      Quote.Flags = 0;
      Create_Dust_Clouds(Quote.X_Pos, Quote.Y_Pos, 5120, 64);
      Start_TSC_Event(40);
    }
  }
}
// 499C68: using guessed type int Selected_Weapon;
// 49E1E4: using guessed type int CursorPosition;
// 49E1E8: using guessed type int Game_Flags;

//----- (00419B50) --------------------------------------------------------
// TSC ZAM : Zero ArMs EXP
// Resets weapon levels
int Reset_All_Weapons_EXP()
{
  int result; // eax@3
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8; ++i )
  {
    Weapons[i].Level = 1;
    Weapons[i].EXP = 0;
    result = i + 1;
  }
  return result;
}

//----- (00419BA0) --------------------------------------------------------
void __cdecl Add_Rocket_Ammo(int Num, int Ammo_To_Refill)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8 && Weapons[i].ID != 5; ++i )
    ;
  if ( i != 8 )
    goto Add_Ammo;
  for ( i = 0; i < 8 && Weapons[i].ID != 10; ++i )
    ;
  if ( i != 8 )
  {
Add_Ammo:
    Weapons[i].Ammo += Ammo_To_Refill;
    if ( Weapons[i].Ammo > Weapons[i].Max_Ammo )
      Weapons[i].Ammo = Weapons[i].Max_Ammo;
  }
}

//----- (00419C60) --------------------------------------------------------
// LI+ : LIfe +
// Restore Health_To_Restore amount of health
void __cdecl Add_Life_Player(int Health_To_Restore)
{
  Quote.Health += Health_To_Restore;
  if ( Quote.Health > Quote.Max_Health )
    Quote.Health = Quote.Max_Health;
  Quote.Life_Bar = Quote.Health;
}

//----- (00419CB0) --------------------------------------------------------
// MP+ : Max Life +
// Max health increased by Life_To_Add
void __cdecl Add_Max_Life_Player(int Life_To_Add)
{
  Quote.Max_Health += Life_To_Add;
  if ( Quote.Max_Health > 232 )
    Quote.Max_Health = 232;
  Quote.Health += Life_To_Add;
  Quote.Life_Bar = Quote.Health;
}

//----- (00419D10) --------------------------------------------------------
// Renders XP Bar, Weapon Level and Weapon Ammo Displays
void __cdecl Draw_XP_Bar_And_Misc(int a1)
{
  int v1; // eax@18
  RECT rcView; // [sp+0h] [bp-90h]@1
  RECT rect; // [sp+10h] [bp-80h]@1
  RECT v4; // [sp+20h] [bp-70h]@10
  int v5; // [sp+30h] [bp-60h]@10
  RECT v6; // [sp+34h] [bp-5Ch]@10
  RECT v7; // [sp+44h] [bp-4Ch]@10
  RECT v8; // [sp+54h] [bp-3Ch]@10
  int v9; // [sp+64h] [bp-2Ch]@10
  RECT v10; // [sp+68h] [bp-28h]@1
  RECT v11; // [sp+78h] [bp-18h]@1
  int v12; // [sp+88h] [bp-8h]@10
  int v13; // [sp+8Ch] [bp-4h]@10

  v10.left = 72;
  v10.top = 48;
  v10.right = 80;
  v10.bottom = 56;
  v11.left = 80;
  v11.top = 80;
  v11.right = 96;
  v11.bottom = 88;
  rcView.left = 0;
  rcView.top = 0;
  rcView.right = 320;
  rcView.bottom = 240;
  rect.left = 80;
  rect.top = 48;
  rect.right = 96;
  rect.bottom = 56;
  if ( Weapon_Icon_X_Offset > 16 )
    Weapon_Icon_X_Offset -= 2;
  if ( Weapon_Icon_X_Offset < 16 )
    Weapon_Icon_X_Offset += 2;
  if ( Weapons[Selected_Weapon].Max_Ammo )
  {
    Draw_Numbers(Weapon_Icon_X_Offset + 32, 16, Weapons[Selected_Weapon].Ammo, 0);
    Draw_Numbers(Weapon_Icon_X_Offset + 32, 24, Weapons[Selected_Weapon].Max_Ammo, 0);
  }
  else
  {
    Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 48, 16, &rect, 26);
    Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 48, 24, &rect, 26);
  }
  if ( a1 != 1 || !(((signed int)Quote.Invincibility_Timer >> 1) % 2) )
  {
    Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 32, 24, &v10, 26);
    Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset, 32, &v11, 26);
    Draw_Numbers(Weapon_Icon_X_Offset - 8, 32, Weapons[Selected_Weapon].Level, 0);
    v7.left = 0;
    v7.top = 72;
    v7.right = 40;
    v7.bottom = 80;
    v4.left = 0;
    v4.top = 80;
    v4.right = 0;
    v4.bottom = 88;
    v8.left = 40;
    v8.top = 72;
    v8.right = 80;
    v8.bottom = 80;
    v6.left = 40;
    v6.top = 80;
    v6.right = 80;
    v6.bottom = 88;
    v12 = Weapons[Selected_Weapon].Level - 1;
    v13 = Weapons[Selected_Weapon].ID;
    v9 = Weapons[Selected_Weapon].EXP;
    v5 = Weapon_Level_Table[v13].exp[v12];
    Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 24, 32, &v7, 26);
    if ( v12 != 2 || Weapons[Selected_Weapon].EXP != Weapon_Level_Table[v13].exp[2] )
    {
      if ( v5 )
        v4.right += 40 * v9 / v5;
      else
        v4.right = 0;
      Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 24, 32, &v4, 26);
    }
    else
    {
      Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 24, 32, &v8, 26);
    }
    if ( Quote.Level_Bar_Flashes )
    {
      v1 = ((signed int)(unsigned __int8)byte_49E6F8++ >> 1) % 2;
      if ( v1 )
        Draw_Bitmap_With_Transparency(&rcView, Weapon_Icon_X_Offset + 24, 32, &v6, 26);
    }
  }
}
// 499C68: using guessed type int Selected_Weapon;
// 49E6F8: using guessed type char byte_49E6F8;

//----- (0041A0B0) --------------------------------------------------------
int Draw_HUD_Weapon_Icons()
{
  int result; // eax@2
  int i; // [sp+0h] [bp-1Ch]@1
  int XPos; // [sp+4h] [bp-18h]@7
  int j; // [sp+8h] [bp-14h]@5
  RECT rect; // [sp+Ch] [bp-10h]@1

  rect.left = 0;
  rect.top = 0;
  rect.right = 0;
  rect.bottom = 16;
  for ( i = 0; ; ++i )
  {
    result = 20 * i;
    if ( !Weapons[i].ID )
      break;
  }
  if ( i )
  {
    for ( j = 0; ; ++j )
    {
      result = j;
      if ( j >= i )
        break;
      XPos = Weapon_Icon_X_Offset + 16 * (j - Selected_Weapon);
      if ( XPos >= 8 )
      {
        if ( XPos >= 24 )
          XPos += 48;
      }
      else
      {
        XPos += 16 * i + 48;
      }
      if ( XPos >= 16 * (i - 1) + 72 )
        XPos -= 16 * i + 48;
      if ( XPos < 72 && XPos >= 24 )
        XPos -= 48;
      rect.left = 16 * Weapons[j].ID;
      rect.right = rect.left + 16;
      Draw_Bitmap_With_Transparency(&Rect_Game, XPos, 16, &rect, 12);
    }
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;

//----- (0041A1D0) --------------------------------------------------------
// Renders HP bar and HP numbers
void __cdecl Draw_Health_Bar(int Always_1)
{
  int Src_Rects; // [sp+0h] [bp-30h]@1
  int v2; // [sp+4h] [bp-2Ch]@1
  int v3; // [sp+8h] [bp-28h]@1
  int v4; // [sp+Ch] [bp-24h]@1
  RECT rect; // [sp+10h] [bp-20h]@1
  RECT v6; // [sp+20h] [bp-10h]@1

  Src_Rects = 0;
  v2 = 40;
  v3 = 232;
  v4 = 48;
  v6.left = 0;
  v6.top = 24;
  v6.right = 232;
  v6.bottom = 32;
  rect.left = 0;
  rect.top = 32;
  rect.right = 232;
  rect.bottom = 40;
  if ( Always_1 != 1 || !(((signed int)Quote.Invincibility_Timer >> 1) % 2) )
  {
    if ( Quote.Life_Bar < Quote.Health )
      Quote.Life_Bar = Quote.Health;
    if ( Quote.Life_Bar <= Quote.Health )
    {
      Quote.Health_Bar_Timer = 0;
    }
    else if ( ++Quote.Health_Bar_Timer > 30 )
    {
      --Quote.Life_Bar;
    }
    v3 = 64;
    v6.right = 40 * Quote.Health / Quote.Max_Health - 1;
    rect.right = 40 * Quote.Life_Bar / Quote.Max_Health - 1;
    Draw_Bitmap_With_Transparency(&Rect_Game, 16, 40, (RECT *)&Src_Rects, 26);
    Draw_Bitmap_With_Transparency(&Rect_Game, 40, 40, &rect, 26);
    Draw_Bitmap_With_Transparency(&Rect_Game, 40, 40, &v6, 26);
    Draw_Numbers(8, 40, Quote.Life_Bar, 0);
  }
}

//----- (0041A350) --------------------------------------------------------
void __cdecl Underwater_Timer(int X_Position, int Y_Position)
{
  int Rects; // [sp+0h] [bp-20h]@1
  int v3; // [sp+4h] [bp-1Ch]@1
  int v4; // [sp+8h] [bp-18h]@1
  int v5; // [sp+Ch] [bp-14h]@1
  RECT rect; // [sp+10h] [bp-10h]@1

  Rects = 112;
  v3 = 72;
  v4 = 144;
  v5 = 80;
  rect.left = 112;
  rect.top = 80;
  rect.right = 144;
  rect.bottom = 88;
  if ( !(Quote.Equipped_Items & 0x10) && Quote.air_get )
  {
    if ( Quote.air_get % 6 < 4 )
      Draw_Numbers(X_Position + 32, Y_Position, Quote.Air / 10, 0);
    if ( Quote.Air % 30 <= 10 )
      Draw_Bitmap_With_Transparency(&Rect_Game, X_Position, Y_Position, &rect, 26);
    else
      Draw_Bitmap_With_Transparency(&Rect_Game, X_Position, Y_Position, (RECT *)&Rects, 26);
  }
}

//----- (0041A430) --------------------------------------------------------
void __cdecl Draw_Nikamaru_Timer(int X_Pos, int Y_Pos)
{
  RECT Rect_Time[3]; // [sp+0h] [bp-30h]@1

  Rect_Time[0].left = 112;
  Rect_Time[0].top = 104;
  Rect_Time[0].right = 120;
  Rect_Time[0].bottom = 112;
  Rect_Time[1].left = 120;
  Rect_Time[1].top = 104;
  Rect_Time[1].right = 128;
  Rect_Time[1].bottom = 112;
  Rect_Time[2].left = 128;
  Rect_Time[2].top = 104;
  Rect_Time[2].right = 160;
  Rect_Time[2].bottom = 112;
  if ( Quote.Equipped_Items & 0x100 )
  {
    if ( Game_Flags & 2 )
    {
      if ( Nikumaru_Counter < 300000 )
        ++Nikumaru_Counter;
      if ( Nikumaru_Counter % 30 <= 10 )
        Draw_Bitmap_With_Transparency(&Rect_Game, X_Pos, Y_Pos, &Rect_Time[1], 26);
      else
        Draw_Bitmap_With_Transparency(&Rect_Game, X_Pos, Y_Pos, Rect_Time, 26);
    }
    else
    {
      Draw_Bitmap_With_Transparency(&Rect_Game, X_Pos, Y_Pos, Rect_Time, 26);
    }
    Draw_Numbers(X_Pos, Y_Pos, Nikumaru_Counter / 3000, 0);
    Draw_Numbers(X_Pos + 20, Y_Pos, Nikumaru_Counter / 50 % 60, 1);
    Draw_Numbers(X_Pos + 32, Y_Pos, Nikumaru_Counter / 5 % 10, 0);
    Draw_Bitmap_With_Transparency(&Rect_Game, X_Pos + 30, Y_Pos, &Rect_Time[2], 26);
  }
  else
  {
    Nikumaru_Counter = 0;
  }
}
// 49E1E8: using guessed type int Game_Flags;
// 49E6F4: using guessed type int Nikumaru_Counter;

//----- (0041A5D0) --------------------------------------------------------
signed int Save_Hell_Counter()
{
  signed int result; // eax@2
  char v1; // al@8
  char str; // [sp+0h] [bp-130h]@3
  Hell_time_file rec; // [sp+10Ch] [bp-24h]@4
  FILE *stream; // [sp+124h] [bp-Ch]@3
  int i; // [sp+128h] [bp-8h]@6
  char *p; // [sp+12Ch] [bp-4h]@4

  if ( Quote.Equipped_Items & 0x100 )
  {
    sprintf(&str, "%s\\290.rec", ExePath);
    stream = fopen(&str, "rb");
    if ( stream
      && (fread(&rec, 0x14u, 1u, stream),
          fclose(stream),
          p = (char *)&rec,
          LOBYTE(rec.counter[0]) -= rec.random[0],
          BYTE1(rec.counter[0]) -= rec.random[0],
          BYTE2(rec.counter[0]) -= rec.random[0],
          BYTE3(rec.counter[0]) -= (signed int)rec.random[0] >> 1,
          rec.counter[0] < Nikumaru_Counter) )
    {
      result = 1;
    }
    else
    {
      for ( i = 0; i < 4; ++i )
      {
        rec.counter[i] = Nikumaru_Counter;
        v1 = Random(0, 250);
        rec.random[i] = i + v1;
        p = (char *)&rec + 4 * i;
        LOBYTE(rec.counter[i]) += rec.random[i];
        p[1] += rec.random[i];
        p[2] += rec.random[i];
        p[3] += (signed int)rec.random[i] >> 1;
      }
      stream = fopen(&str, "wb");
      if ( stream )
      {
        fwrite(&rec, 0x14u, 1u, stream);
        fclose(stream);
        result = 1;
      }
      else
      {
        result = 0;
      }
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 49E6F4: using guessed type int Nikumaru_Counter;

//----- (0041A7C0) --------------------------------------------------------
// Returns hell time
int Get_Hell_Time()
{
  int result; // eax@2
  char str; // [sp+0h] [bp-130h]@1
  int buffer; // [sp+10Ch] [bp-24h]@3
  int v3; // [sp+110h] [bp-20h]@6
  int v4; // [sp+114h] [bp-1Ch]@7
  char v5[4]; // [sp+11Ch] [bp-14h]@5
  FILE *stream; // [sp+124h] [bp-Ch]@1
  int i; // [sp+128h] [bp-8h]@3
  int *v8; // [sp+12Ch] [bp-4h]@5

  sprintf(&str, "%s\\290.rec", ExePath);
  stream = fopen(&str, "rb");
  if ( stream )
  {
    fread(&buffer, 0x14u, 1u, stream);
    fclose(stream);
    for ( i = 0; i < 4; ++i )
    {
      v8 = &buffer + i;
      *((_BYTE *)&buffer + 4 * i) -= v5[i];
      *((_BYTE *)v8 + 1) -= v5[i];
      *((_BYTE *)v8 + 2) -= v5[i];
      *((_BYTE *)v8 + 3) -= (signed int)(unsigned __int8)v5[i] >> 1;
    }
    if ( buffer == v3 && buffer == v4 )
    {
      Nikumaru_Counter = buffer;
      result = buffer;
    }
    else
    {
      Nikumaru_Counter = 0;
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 49E6F4: using guessed type int Nikumaru_Counter;
// 41A7C0: using guessed type char var_14[4];

//----- (0041A8F0) --------------------------------------------------------
signed int __cdecl MakeSoundObject8(char *wavep, char track, char pipi)
{
  signed int result; // eax@2
  LPVOID lpbuf2; // [sp+0h] [bp-60h]@17
  int hr; // [sp+4h] [bp-5Ch]@17
  size_t dwbuf1; // [sp+8h] [bp-58h]@17
  LPVOID lpbuf1; // [sp+Ch] [bp-54h]@17
  size_t dwbuf2; // [sp+10h] [bp-50h]@17
  unsigned int i; // [sp+14h] [bp-4Ch]@3
  unsigned int j; // [sp+18h] [bp-48h]@5
  DSBUFFERDESC dsbd; // [sp+1Ch] [bp-44h]@10
  size_t data_size; // [sp+44h] [bp-1Ch]@8
  void *wp; // [sp+48h] [bp-18h]@12
  int work; // [sp+4Ch] [bp-14h]@14
  _BYTE *wp_sub; // [sp+50h] [bp-10h]@12
  size_t k; // [sp+54h] [bp-Ch]@12
  unsigned int wave_size; // [sp+58h] [bp-8h]@7
  unsigned int wav_tp; // [sp+5Ch] [bp-4h]@12 Wave pointer pointing to table

  if ( !lpDS )
  {
    result = 0;
  }
  else
  {
    for ( i = 0; i < 8; ++i )
    {
      for ( j = 0; j < 2; ++j )
      {
        wave_size = oct_wave[i].wave_size;
        if ( pipi )
          data_size = wave_size * oct_wave[i].oct_size;
        else
          data_size = wave_size;
        memset(&dsbd, 0, 36u);
        dsbd.dwSize = 36;
        dsbd.dwBufferBytes = data_size;
        dsbd.lpwfxFormat = (LPWAVEFORMATEX)format_tbl2;
        dsbd.dwFlags = DSBCAPS_CTRLVOLUME|DSBCAPS_CTRLPAN|DSBCAPS_CTRLFREQUENCY|DSBCAPS_STATIC|0x8000;
        if ( lpDS->lpVtbl->CreateSoundBuffer(lpDS, &dsbd, &lpORGANBUFFER[track][i][j], 0) )
          return 0;
        wp = malloc(data_size);                 // Make file workspace
        wp_sub = wp;
        wav_tp = 0;
        for ( k = 0; k < data_size; ++k )
        {
          work = wavep[wav_tp];
          work += 0x80;
          *wp_sub = work;
          wav_tp += 256 / wave_size;
          if ( wav_tp > 255 )
            wav_tp -= 256;
          ++wp_sub;
        }
        dwbuf2 = 0;
        // Data transfer
        hr = lpORGANBUFFER[track][i][j]->lpVtbl->Lock(
               lpORGANBUFFER[track][i][j],
               0,
               data_size,
               &lpbuf1,
               &dwbuf1,
               &lpbuf2,
               &dwbuf2,
               0);
        if ( hr )
          return 0;
        memcpy(lpbuf1, wp, dwbuf1);
        if ( dwbuf2 )
          memcpy(lpbuf2, (char *)wp + dwbuf1, dwbuf2);
        lpORGANBUFFER[track][i][j]->lpVtbl->Unlock(lpORGANBUFFER[track][i][j], lpbuf1, dwbuf1, lpbuf2, dwbuf2);
        lpORGANBUFFER[track][i][j]->lpVtbl->SetCurrentPosition(lpORGANBUFFER[track][i][j], 0);
        free(wp);
      }
    }
    result = 1;
  }
  return result;
}
// D: found interdependent unknown calls

//----- (0041ABA0) --------------------------------------------------------
void __cdecl Change_Organ_Frequency(unsigned __int8 key, char track, int a)
{
  __int64 tmpDouble; // rax@6
  signed int j; // [sp+0h] [bp-8h]@4
  signed int i; // [sp+4h] [bp-4h]@2

  if ( lpDS )
  {
    for ( i = 0; i < 8; ++i )
    {
      for ( j = 0; j < 2; ++j )
      {
        tmpDouble = oct_wave[i].oct_par * freq_tbl[key] * (signed int)oct_wave[i].wave_size;
        lpORGANBUFFER[track][i][j]->lpVtbl->SetFrequency(
          lpORGANBUFFER[track][i][j],
          (((BYTE4(tmpDouble) & 7) + (signed int)tmpDouble) >> 3) + a - 1000);
      }
    }
  }
}

//----- (0041AC70) --------------------------------------------------------
void __cdecl Change_Organ_Pan(unsigned __int8 key, unsigned __int8 pan, char track)
{
  if ( lpDS )
  {
    if ( old_key[track] != 255 )
      lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->SetPan(
        lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]],
        10 * (pan_tbl[pan] - 256));
  }
}

//----- (0041AD20) --------------------------------------------------------
void __cdecl Change_Organ_Volume(int no, __int32 volume, char track)
{
  if ( lpDS )
  {
    if ( old_key[track] != 255 )
      lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->SetVolume(
        lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]],
        8 * volume - 2040);
  }
}

//----- (0041ADC0) --------------------------------------------------------
void __cdecl Play_Organya_Object(unsigned __int8 key, int mode, char track, DWORD freq)
{
  if ( lpDS && lpORGANBUFFER[track][key / 12][key_twin[track]] )
  {
    if ( mode == -1 )
    {
      if ( old_key[track] == KEYDUMMY )
      {
        Change_Organ_Frequency(key % 12, track, freq);
        lpORGANBUFFER[track][key / 12][key_twin[track]]->lpVtbl->Play(
          lpORGANBUFFER[track][key / 12][key_twin[track]],
          0,
          0,
          DSBPLAY_LOOPING);
        old_key[track] = key;
        key_on[track] = 1;
      }
      else if ( key_on[track] != 1 || old_key[track] != key )
      {
        lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->Play(
          lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]],
          0,
          0,
          0);
        if ( (signed int)++key_twin[track] > 1 )
          key_twin[track] = 0;
        Change_Organ_Frequency(key % 12, track, freq);
        lpORGANBUFFER[track][key / 12][key_twin[track]]->lpVtbl->Play(
          lpORGANBUFFER[track][key / 12][key_twin[track]],
          0,
          0,
          DSBPLAY_LOOPING);
        old_key[track] = key;
      }
      else
      {
        lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->Play(
          lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]],
          0,
          0,
          0);
        if ( (signed int)++key_twin[track] > 1 )
          key_twin[track] = 0;
        lpORGANBUFFER[track][key / 12][key_twin[track]]->lpVtbl->Play(
          lpORGANBUFFER[track][key / 12][key_twin[track]],
          0,
          0,
          DSBPLAY_LOOPING);
      }
    }
    else if ( mode )
    {
      if ( mode == 2 && old_key[track] != 255 )
      {
        lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->Play(
          lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]],
          0,
          0,
          0);
        old_key[track] = 255;
      }
    }
    else if ( old_key[track] != 255 )
    {
      lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->Stop(lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]);
      lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]]->lpVtbl->SetCurrentPosition(
        lpORGANBUFFER[track][old_key[track] / 12][key_twin[track]],
        0);
    }
  }
}

//----- (0041B2A0) --------------------------------------------------------
void __cdecl Release_Organya_Object(char track)
{
  signed int i; // [sp+0h] [bp-4h]@2

  if ( lpDS )
  {
    for ( i = 0; i < 8; ++i )
    {
      if ( lpORGANBUFFER[track][i][0] )
      {
        lpORGANBUFFER[track][i][0]->lpVtbl->Release(lpORGANBUFFER[track][i][0]);
        lpORGANBUFFER[track][i][0] = NULL;
      }
      if ( lpORGANBUFFER[track][i][1] )
      {
        lpORGANBUFFER[track][i][1]->lpVtbl->Release(lpORGANBUFFER[track][i][1]);
        lpORGANBUFFER[track][i][1] = NULL;
      }
    }
  }
}

//----- (0041B380) --------------------------------------------------------
BOOL Init_Wave_Data_100(void)
{
  BOOL result; // eax@2
  HGLOBAL temp1; // eax@5
  LPVOID lpdword; // ST10_4@5
  HRSRC hrscr; // [sp+0h] [bp-8h]@3

  if ( lpDS )
  {
    hrscr = FindResourceA(NULL, "WAVE100", "WAVE");
    if ( !hrscr )
    {
      result = 0;
    }
    else
    {
      temp1 = LoadResource(NULL, hrscr);
      lpdword = LockResource(temp1);
      memcpy(wave_data, lpdword, 25600u);
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041B3F0) --------------------------------------------------------
BOOL __cdecl Make_Organya_Wave(char track, char wave_num, char pipi)
{
  BOOL result; // eax@2

  if ( lpDS )
  {
    if ( wave_num > 99 )
    {
      result = 0;
    }
    else
    {
      Release_Organya_Object(track);
      MakeSoundObject8(&wave_data[256 * wave_num], track, pipi);
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041B440) --------------------------------------------------------
void __cdecl Change_Dram_Frequency(unsigned __int8 key, char track)
{
  if ( lpDS )
    ((void (__stdcall *)(_DWORD, _DWORD))lpDRAMBUFFER[track]->lpVtbl->SetFrequency)(
      lpDRAMBUFFER[track],
      800 * key + 100);
}

//----- (0041B480) --------------------------------------------------------
void __cdecl Change_Dram_Pan(unsigned __int8 pan, char track)
{
  if ( lpDS )
    lpDRAMBUFFER[track]->lpVtbl->SetPan(lpDRAMBUFFER[track], 10 * (pan_tbl[pan] - 256));
}

//----- (0041B4D0) --------------------------------------------------------
void __cdecl Change_Dram_Volume(__int32 volume, char track)
{
  if ( lpDS )
    lpDRAMBUFFER[track]->lpVtbl->SetVolume(lpDRAMBUFFER[track], 8 * volume - 2040);
}

//----- (0041B510) --------------------------------------------------------
void __cdecl Play_Dram_Object(unsigned __int8 key, int mode, char track)
{
  if ( lpDS && lpDRAMBUFFER[track] )
  {
    if ( !mode )
    {
      lpDRAMBUFFER[track]->lpVtbl->Stop(lpDRAMBUFFER[track]);
      lpDRAMBUFFER[track]->lpVtbl->SetCurrentPosition(lpDRAMBUFFER[track], 0);
    }
    else if ( mode == 1 )
    {
      lpDRAMBUFFER[track]->lpVtbl->Stop(lpDRAMBUFFER[track]);
      lpDRAMBUFFER[track]->lpVtbl->SetCurrentPosition(lpDRAMBUFFER[track], 0);
      Change_Dram_Frequency(key, track);
      lpDRAMBUFFER[track]->lpVtbl->Play(lpDRAMBUFFER[track], 0, 0, 0);
    }
  }
}

//----- (0041B600) --------------------------------------------------------
OrgData *__thiscall OrgData::OrgData(OrgData *this)
{
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < 16; ++i )
  {
    this->info.tdata[i].note_list = NULL;
    this->info.tdata[i].note_p = NULL;
  }
  return this;
}

//----- (0041B650) --------------------------------------------------------
void __thiscall OrgData::InitOrgData(OrgData *this)
{
  signed int i; // [sp+4h] [bp-4h]@1

  this->track = 0;
  this->info.alloc_note = ALLOCNOTE;
  this->info.dot = 4;
  this->info.line = 4;
  this->info.wait = 128;
  this->info.repeat_x = 0;
  this->info.end_x = 255 * this->info.line * this->info.dot;
  for ( i = 0; i < (signed int)MAXTRACK; ++i )
  {
    this->info.tdata[i].freq = 1000;
    this->info.tdata[i].wave_no = 0;
    this->info.tdata[i].pipi = 0;
  }
  OrgData::NoteAlloc(this, this->info.alloc_note);
  OrgData::SetMusicInfo(this, &this->info, -1u);
  BYTE1(this[1].info.end_x) = 6;
  BYTE2(this[1].info.end_x) = -56;
}

//----- (0041B730) --------------------------------------------------------
BOOL __thiscall OrgData::SetMusicInfo(OrgData *this, MUSICINFO *mi, unsigned __int32 flag)
{
  char str[32]; // [sp+4h] [bp-28h]@4
  int i; // [sp+28h] [bp-4h]@8

  if ( flag & SETGRID )                         // Enable grid
  {
    this->info.dot = mi->dot;
    this->info.line = mi->line;
  }
  if ( flag & SETWAIT )
  {
    this->info.wait = mi->wait;
    _itoa(mi->wait, str, 10);
  }
  if ( flag & MAXDRAM )
  {
    this->info.repeat_x = mi->repeat_x;
    this->info.end_x = mi->end_x;
  }
  if ( flag & SETFREQ )
  {
    for ( i = 0; i < (signed int)MAXMELODY; ++i )
    {
      this->info.tdata[i].freq = mi->tdata[i].freq;
      this->info.tdata[i].pipi = this->info.tdata[i].pipi;
    }
  }
  if ( flag & SETWAVE )
  {
    for ( i = 0; i < (signed int)MAXTRACK; ++i )
      this->info.tdata[i].wave_no = mi->tdata[i].wave_no;
  }
  if ( flag & SETPIPI )
  {
    for ( i = 0; i < (signed int)MAXTRACK; ++i )
      this->info.tdata[i].pipi = mi->tdata[i].pipi;
  }
  return 1;
}

//----- (0041B890) --------------------------------------------------------
BOOL __thiscall OrgData::NoteAlloc(OrgData *this, unsigned __int16 alloc)
{
  signed int i; // [sp+4h] [bp-8h]@1
  signed int j; // [sp+4h] [bp-8h]@14
  signed int l; // [sp+8h] [bp-4h]@4
  signed int k; // [sp+8h] [bp-4h]@10

  for ( i = 0; ; ++i )
  {
    if ( i >= (signed int)MAXTRACK )
    {
      for ( j = 0; j < (signed int)MAXMELODY; ++j )
        Make_Organya_Wave(j, this->info.tdata[j].wave_no, this->info.tdata[j].pipi);
      this->track = 0;
      return 1;
    }
    this->info.tdata[i].wave_no = 0;
    this->info.tdata[i].note_list = NULL;
    this->info.tdata[i].note_p = (NOTELIST *)malloc(16 * alloc);
    if ( !this->info.tdata[i].note_p )
      break;
    for ( k = 0; k < alloc; ++k )
    {
      this->info.tdata[i].note_p[k].from = NULL;
      this->info.tdata[i].note_p[k].to = NULL;
      this->info.tdata[i].note_p[k].length = 0;
      this->info.tdata[i].note_p[k].pan = PANDUMMY;
      this->info.tdata[i].note_p[k].volume = VOLDUMMY;
      this->info.tdata[i].note_p[k].y = KEYDUMMY;
    }
  }
  for ( l = 0; l < 16; ++l )
  {
    if ( this->info.tdata[l].note_p )
    {
      free(this->info.tdata[l].note_p);
      this->info.tdata[i].note_p = NULL;
    }
  }
  return 0;
}

//----- (0041BA70) --------------------------------------------------------
void __thiscall OrgData::ReleaseNote(OrgData *this)
{
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < (signed int)MAXTRACK; ++i )
  {
    if ( this->info.tdata[i].note_p )
    {
      free(this->info.tdata[i].note_p);
      this->info.tdata[i].note_p = NULL;
    }
  }
}

//----- (0041BAD0) --------------------------------------------------------
signed int __thiscall OrgData::InitMusicData(OrgData *this, char *lpName)
{
  signed int result; // eax@2
  HGLOBAL Load_res_ret; // eax@3
  NOTELIST *np; // ST18_4@20 MAPDST
  signed int j; // [sp+4h] [bp-98h]@15
  signed int k; // [sp+4h] [bp-98h]@39
  signed int l; // [sp+4h] [bp-98h]@42
  MUSICINFO_file destination; // [sp+Ch] [bp-90h]@9
  int pass_check; // [sp+80h] [bp-1Ch]@3
  HRSRC hResInfo; // [sp+8Ch] [bp-10h]@1
  char ver; // [sp+93h] [bp-9h]@1
  int i; // [sp+94h] [bp-8h]@9
  char *p; // [sp+98h] [bp-4h]@3

  ver = 0;
  hResInfo = FindResourceA(NULL, lpName, "ORG");
  if ( !hResInfo )
  {
    result = 0;
  }
  else
  {
    Load_res_ret = LoadResource(NULL, hResInfo);
    p = (char *)LockResource(Load_res_ret);
    memcpy(&pass_check, p, 6u);
    p += 6;
    if ( !memcmp(&pass_check, "Org-01", 6u) )
      ver = 1;
    if ( !memcmp(&pass_check, "Org-02", 6u) )
      ver = 2;
    if ( !ver )
    {
      result = 0;
    }
    else
    {
      memcpy(&destination, p, 108u);
      p += 108;
      this->info.wait = destination.wait;
      this->info.line = destination.line;
      this->info.dot = destination.dot;
      this->info.repeat_x = destination.repeat_x;
      this->info.end_x = destination.end_x;
      for ( i = 0; i < (signed int)MAXTRACK; ++i )
      {
        this->info.tdata[i].freq = destination.tdata[i].freq;
        if ( ver == 1 )
          this->info.tdata[i].pipi = 0;
        else
          this->info.tdata[i].pipi = destination.tdata[i].pipi;
        this->info.tdata[i].wave_no = destination.tdata[i].wave_no;
      }
      for ( j = 0; j < (signed int)MAXTRACK; ++j )
      {
        if ( !destination.tdata[j].note_num )
        {
          this->info.tdata[j].note_list = NULL;
        }
        else
        {
          np = this->info.tdata[j].note_p;
          this->info.tdata[j].note_list = this->info.tdata[j].note_p;
          np->from = NULL;
          np->to = np + 1;
          ++np;
          for ( i = 1; i < destination.tdata[j].note_num; ++i )
          {
            np->from = np - 1;
            np->to = np + 1;
            ++np;
          }
          np[-1].to = NULL;
          np = this->info.tdata[j].note_p;
          for ( i = 0; i < destination.tdata[j].note_num; ++i )
          {
            memcpy(&np->x, p, 4u);
            p += 4;
            ++np;
          }
          np = this->info.tdata[j].note_p;
          for ( i = 0; i < destination.tdata[j].note_num; ++i )
          {
            memcpy(&np->y, p++, 1u);
            ++np;
          }
          np = this->info.tdata[j].note_p;
          for ( i = 0; i < destination.tdata[j].note_num; ++i )
          {
            memcpy(&np->length, p++, 1u);
            ++np;
          }
          np = this->info.tdata[j].note_p;
          for ( i = 0; i < destination.tdata[j].note_num; ++i )
          {
            memcpy(&np->volume, p++, 1u);
            ++np;
          }
          np = this->info.tdata[j].note_p;
          for ( i = 0; i < destination.tdata[j].note_num; ++i )
          {
            memcpy(&np->pan, p++, 1u);
            ++np;
          }
        }
      }
      for ( k = 0; k < (signed int)MAXMELODY; ++k )
        Make_Organya_Wave(k, this->info.tdata[k].wave_no, this->info.tdata[k].pipi);
      for ( l = 8; l < (signed int)MAXTRACK; ++l )
        i = this->info.tdata[l].wave_no;
      OrgData::SetPlayPointer(this, 0);
      result = 1;
    }
  }
  return result;
}

//----- (0041C0B0) --------------------------------------------------------
// Unused
// Acquire song information
void __thiscall OrgData::GetMusicInfo(OrgData *this, MUSICINFO *mi)
{
  signed int i; // [sp+4h] [bp-4h]@1

  mi->dot = this->info.dot;
  mi->line = this->info.line;
  mi->alloc_note = this->info.alloc_note;
  mi->wait = this->info.wait;
  mi->repeat_x = this->info.repeat_x;
  mi->end_x = this->info.end_x;
  for ( i = 0; i < (signed int)MAXTRACK; ++i )
  {
    mi->tdata[i].freq = this->info.tdata[i].freq;
    mi->tdata[i].wave_no = this->info.tdata[i].wave_no;
    mi->tdata[i].pipi = this->info.tdata[i].pipi;
  }
}

//----- (0041C180) --------------------------------------------------------
// Set the timer accuracy.
bool InitMMTimer()
{
  bool result; // eax@2
  struct timecaps_tag ptc; // [sp+0h] [bp-Ch]@1
  MMRESULT ret; // [sp+8h] [bp-4h]@1

  // Acquire timer accuracy information
  ret = timeGetDevCaps(&ptc, 8u);
  if ( ret )
  {
    result = 0;
  }
  else
  {
    if ( ExactTime < ptc.wPeriodMin )
      ExactTime = ptc.wPeriodMin;
    // Initialize with this accuracy
    ret = timeBeginPeriod(ExactTime);
    result = ret == TIMERR_NOERROR;
  }
  return result;
}

//----- (0041C1E0) --------------------------------------------------------
int __cdecl StartTimer(DWORD dwTimer)
{
  ExactTime = dwTimer;
  TimerID = timeSetEvent(dwTimer, 10u, (LPTIMECALLBACK)TimerProc, NULL, TIME_PERIODIC);
  IsTimerActive = 1;
  return 1;
}
// 4A4DAC: using guessed type int IsTimerActive;

//----- (0041C230) --------------------------------------------------------
void __cdecl TimerProc(UINT uTID, UINT uMsg, DWORD dwUser, DWORD dwParam1, DWORD dwParam2)
{
  timeGetTime();
  OrgData::PlayData(&Music_Object);
}

//----- (0041C250) --------------------------------------------------------
signed int QuitMMTimer()
{
  signed int result; // eax@2

  if ( IsTimerActive )
  {
    if ( TimerID && timeKillEvent(TimerID) )
    {
      result = 0;
    }
    else if ( timeEndPeriod(ExactTime) )
    {
      result = 0;
    }
    else
    {
      IsTimerActive = 0;
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 4A4DAC: using guessed type int IsTimerActive;

//----- (0041C2B0) --------------------------------------------------------
void __thiscall OrgData::PlayData(OrgData *this)
{
  signed int i; // [sp+4h] [bp-4h]@6
  signed int j; // [sp+4h] [bp-4h]@25

  if ( Music_Fade_Flag_Maybe && Volume )
    Volume -= 2;
  if ( Volume < 0 )
    Volume = 0;
  // Melody playback
  for ( i = 0; i < (signed int)MAXMELODY; ++i )
  {
    if ( np[i] && Play_Position == np[i]->x )
    {
      if ( !mute[i] && np[i]->y != KEYDUMMY )
      {
        Play_Organya_Object(np[i]->y, -1, i, this->info.tdata[i].freq);
        Note_Lengths[i] = np[i]->length;
      }
      if ( np[i]->pan != PANDUMMY )
        Change_Organ_Pan(np[i]->y, np[i]->pan, i);
      if ( np[i]->volume != VOLDUMMY )
        Track_Volume[i] = np[i]->volume;
      np[i] = np[i]->to;                        // Point to the next note
    }
    if ( !Note_Lengths[i] )
      Play_Organya_Object(NULL, 2, i, this->info.tdata[i].freq);
    if ( Note_Lengths[i] > 0 )
      --Note_Lengths[i];
    if ( np[i] )
      Change_Organ_Volume(np[i]->y, Volume * Track_Volume[i] / 127, i);
  }
  // Do drum playback
  for ( j = MAXMELODY; j < (signed int)MAXTRACK; ++j )
  {
    if ( np[j] && Play_Position == np[j]->x )
    {
      if ( np[j]->y != KEYDUMMY && !mute[j] )
        Play_Dram_Object(np[j]->y, 1, j - MAXMELODY);
      if ( np[j]->pan != PANDUMMY )
        Change_Dram_Pan(np[j]->pan, j - MAXMELODY);
      if ( np[j]->volume != VOLDUMMY )
        Track_Volume[j] = np[j]->volume;
      np[j] = np[j]->to;                        // Point to the next note
    }
    if ( np[j] )
      Change_Dram_Volume(Volume * Track_Volume[j] / 127, j - 8);
  }
  if ( ++Play_Position >= this->info.end_x )
  {
    Play_Position = this->info.repeat_x;
    OrgData::SetPlayPointer(this, Play_Position);
  }
}
// 4A4E10: using guessed type int Music_Fade_Flag_Maybe;

//----- (0041C630) --------------------------------------------------------
void __thiscall OrgData::SetPlayPointer(OrgData *this, __int32 x)
{
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < (signed int)MAXTRACK; ++i )
  {
    for ( np[i] = this->info.tdata[i].note_list; np[i] && np[i]->x < x; np[i] = np[i]->to )
      ;
  }
  Play_Position = x;
}

//----- (0041C6C0) --------------------------------------------------------
signed int Start_Organya()
{
  signed int result; // eax@2

  if ( lpDS )
  {
    if ( Init_Wave_Data_100() )
    {
      OrgData::InitOrgData(&Music_Object);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041C6F0) --------------------------------------------------------
int __cdecl Load_Organya(LPCSTR lpName)
{
  int result; // eax@2

  if ( lpDS )
  {
    if ( OrgData::InitMusicData(&Music_Object, (char *)lpName) )
    {
      Volume = 100;
      Music_Fade_Flag_Maybe = 0;
      result = 0;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 4A4E10: using guessed type int Music_Fade_Flag_Maybe;

//----- (0041C730) --------------------------------------------------------
void __cdecl Set_Organya_Position(int a1)
{
  if ( lpDS )
  {
    OrgData::SetPlayPointer(&Music_Object, a1);
    Volume = 100;
    Music_Fade_Flag_Maybe = 0;
  }
}
// 4A4E10: using guessed type int Music_Fade_Flag_Maybe;

//----- (0041C770) --------------------------------------------------------
__int32 Get_Organya_Position()
{
  __int32 result; // eax@2

  if ( lpDS )
    result = Play_Position;
  else
    result = 0;
  return result;
}

//----- (0041C790) --------------------------------------------------------
int Start_Organya_Playback()
{
  int result; // eax@2

  if ( lpDS )
  {
    QuitMMTimer();
    InitMMTimer();
    result = StartTimer(Music_Object.info.wait);
  }
  return result;
}

//----- (0041C7C0) --------------------------------------------------------
signed int __cdecl Change_Organya_Volume(signed int Volume)
{
  signed int result; // eax@2

  if ( lpDS )
  {
    if ( Volume >= 0 && Volume <= 100 )
    {
      ::Volume = Volume;
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041C7F0) --------------------------------------------------------
void Stop_Organya_Music()
{
  signed int i; // [sp+0h] [bp-4h]@2

  if ( lpDS )
  {
    QuitMMTimer();
    for ( i = 0; i < 8; ++i )
      Play_Organya_Object(0, 2, i, 0);
    memset(old_key, 255, 16u);
    memset(key_on, 0, 16u);
    memset(key_twin, 0, 16u);
    Sleep(100u);
  }
}

//----- (0041C890) --------------------------------------------------------
void End_Organya()
{
  signed int i; // [sp+0h] [bp-4h]@2

  if ( lpDS )
  {
    QuitMMTimer();
    OrgData::ReleaseNote(&Music_Object);
    for ( i = 0; i < (signed int)MAXMELODY; ++i )
    {
      Play_Organya_Object(0, 0, i, 0);
      Release_Organya_Object(i);
    }
  }
}

//----- (0041C8F0) --------------------------------------------------------
void MakeWaveTables()
{
  sin((long double)0 * 6.283184 / 256.0);
}

//----- (0041CB10) --------------------------------------------------------
signed int __cdecl MakePixelWaveData(int a1, int a2)
{
  int v2; // ST40_4@24
  __int64 v3; // rax@24
  int v4; // ecx@24
  __int64 v5; // rax@24
  __int64 v6; // rax@24
  __int64 v7; // rax@24
  double v9; // [sp+18h] [bp-158h]@14
  double v10; // [sp+28h] [bp-148h]@13
  double v11; // [sp+38h] [bp-138h]@1
  double v12; // [sp+38h] [bp-138h]@4
  double v13; // [sp+38h] [bp-138h]@7
  double v14; // [sp+38h] [bp-138h]@10
  double v15; // [sp+40h] [bp-130h]@20
  double v16; // [sp+48h] [bp-128h]@17
  double v17; // [sp+50h] [bp-120h]@13
  _BYTE ptr[260]; // [sp+58h] [bp-118h]@1
  int i; // [sp+160h] [bp-10h]@1
  int v20; // [sp+164h] [bp-Ch]@24
  double v21; // [sp+168h] [bp-8h]@13

  MakeWaveTables();
  memset(ptr, 0, 0x100u);
  i = 0;
  v11 = (long double)*(signed int *)(a1 + 80);
  while ( i < *(_DWORD *)(a1 + 84) )
  {
    ptr[i] = (unsigned __int64)v11;
    v11 = ((long double)*(signed int *)(a1 + 88) - (long double)*(signed int *)(a1 + 80))
        / (long double)*(signed int *)(a1 + 84)
        + v11;
    ++i;
  }
  v12 = (long double)*(signed int *)(a1 + 88);
  while ( i < *(_DWORD *)(a1 + 92) )
  {
    ptr[i] = (unsigned __int64)v12;
    v12 = ((long double)*(signed int *)(a1 + 96) - (long double)*(signed int *)(a1 + 88))
        / (long double)(*(_DWORD *)(a1 + 92) - *(_DWORD *)(a1 + 84))
        + v12;
    ++i;
  }
  v13 = (long double)*(signed int *)(a1 + 96);
  while ( i < *(_DWORD *)(a1 + 100) )
  {
    ptr[i] = (unsigned __int64)v13;
    v13 = ((long double)*(signed int *)(a1 + 104) - (long double)*(signed int *)(a1 + 96))
        / (long double)(*(_DWORD *)(a1 + 100) - *(_DWORD *)(a1 + 92))
        + v13;
    ++i;
  }
  v14 = (long double)*(signed int *)(a1 + 104);
  while ( i < 256 )
  {
    ptr[i] = (unsigned __int64)v14;
    v14 = v14 - (long double)*(signed int *)(a1 + 104) / (long double)(256 - *(_DWORD *)(a1 + 100));
    ++i;
  }
  v17 = (long double)*(signed int *)(a1 + 52);
  v10 = (long double)*(signed int *)(a1 + 28);
  v21 = (long double)*(signed int *)(a1 + 76);
  if ( *(double *)(a1 + 16) == 0.0 )
    v9 = 0.0;
  else
    v9 = 256.0 / ((long double)*(signed int *)(a1 + 4) / *(double *)(a1 + 16));
  if ( *(double *)(a1 + 40) == 0.0 )
    v16 = 0.0;
  else
    v16 = 256.0 / ((long double)*(signed int *)(a1 + 4) / *(double *)(a1 + 40));
  if ( *(double *)(a1 + 64) == 0.0 )
    v15 = 0.0;
  else
    v15 = 256.0 / ((long double)*(signed int *)(a1 + 4) / *(double *)(a1 + 64));
  for ( i = 0; i < *(_DWORD *)(a1 + 4); ++i )
  {
    v20 = (signed int)(unsigned __int64)v10 % 256;
    v2 = (signed int)(unsigned __int64)v17 % 256;
    v3 = *(_DWORD *)(a1 + 24) * (signed int)*(&byte_4A4F00[256 * *(_DWORD *)(a1 + 8)] + v20);
    v4 = ((BYTE4(v3) & 0x3F) + (signed int)v3) >> 6;
    v5 = *(_DWORD *)(a1 + 72)
       * (signed int)*(&byte_4A4F00[256 * *(_DWORD *)(a1 + 56)] + (signed int)(unsigned __int64)v21 % 256);
    v6 = v4 * ((((BYTE4(v5) & 0x3F) + (signed int)v5) >> 6) + 64);
    v7 = ptr[(unsigned int)(unsigned __int64)((long double)(i << 8) / (long double)*(signed int *)(a1 + 4))]
       * (((BYTE4(v6) & 0x3F) + (signed int)v6) >> 6);
    *(_BYTE *)(i + a2) = (((BYTE4(v7) & 0x3F) + (signed int)v7) >> 6) + -128;
    if ( *(&byte_4A4F00[256 * *(_DWORD *)(a1 + 32)] + v2) >= 0 )
      v10 = (v9 + v9)
          * (long double)*(&byte_4A4F00[256 * *(_DWORD *)(a1 + 32)] + (signed int)(unsigned __int64)v17 % 256)
          * (long double)*(signed int *)(a1 + 48)
          / 64.0
          / 64.0
          + v9
          + v10;
    else
      v10 = v9
          - v9
          * 0.5
          * (long double)-*(&byte_4A4F00[256 * *(_DWORD *)(a1 + 32)] + (signed int)(unsigned __int64)v17 % 256)
          * (long double)*(signed int *)(a1 + 48)
          / 64.0
          / 64.0
          + v10;
    v17 = v17 + v16;
    v21 = v21 + v15;
  }
  return 1;
}

//----- (0041CFC0) --------------------------------------------------------
// Returns 1 or 0
signed int Check_Profile_dat(void)
{
  signed int result; // eax@2
  char str; // [sp+0h] [bp-110h]@1
  HANDLE hObject; // [sp+10Ch] [bp-4h]@1

  sprintf(&str, "%s\\%s", ExePath, Default_Name);
  hObject = CreateFileA(&str, 0, 1u, NULL, 3u, 0x80u, NULL);
  if ( hObject == (HANDLE)-1 )
  {
    result = 0;
  }
  else
  {
    CloseHandle(hObject);
    result = 1;
  }
  return result;
}

//----- (0041D040) --------------------------------------------------------
signed int __cdecl Save_Profile(const char *name)
{
  signed int result; // eax@5
  char string[108]; // [sp+0h] [bp-720h]@2
  Profile_struct profile; // [sp+108h] [bp-618h]@6
  FILE *stream; // [sp+718h] [bp-8h]@4
  void *FLAG; // [sp+71Ch] [bp-4h]@1

  FLAG = "FLAG";
  if ( !name )
    sprintf(string, "%s\\%s", ExePath, Default_Name);
  else
    sprintf(string, "%s\\%s", ExePath, name);
  stream = fopen(string, "wb");
  if ( !stream )
  {
    result = 0;
  }
  else
  {
    memset(&profile, 0, 0x604u);
    memcpy(&profile, offset_Profile_dat_check, 8u);
    memcpy(profile.FLAG, FLAG, 4u);
    profile.Stage_Num = Current_Stage_Num;
    profile.Song_Num = Current_Song_Number;
    profile.X_Pos = Quote.X_Pos;
    profile.Y_Pos = Quote.Y_Pos;
    profile.Direction = Quote.Direction;
    profile.Max_HP = Quote.Max_Health;
    profile.HP = Quote.Health;
    profile.star = Quote.star;
    profile.Selected_Weapon = Selected_Weapon;
    profile.Selected_Item = Selected_Item;
    profile.Equipped_Items = Quote.Equipped_Items;
    profile.Unit = Quote.Unit;
    profile.Game_Time = GameTime;
    memcpy(profile.Weapons, Weapons, 0xA0u);
    memcpy(profile.Inventory, Quote_Inventory, 0x80u);
    memcpy(profile.Unlocked_Stages, Unlocked_Stages, 0x40u);
    memcpy(profile.Map_Flag_Array, Map_Flag_Array, 0x80u);
    memcpy(profile.Event_Flags, Event_Flags, 0x3E8u);
    fwrite(&profile, 0x604u, 1u, stream);
    fclose(stream);
    result = 1;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;
// 499C6C: using guessed type int Selected_Item;
// 49E1EC: using guessed type int GameTime;
// 4A57F0: using guessed type int Current_Stage_Num;
// 4A57F4: using guessed type int Current_Song_Number;

//----- (0041D260) --------------------------------------------------------
signed int __cdecl Load_Dropped_Profile_dat(int a1)
{
  signed int result; // eax@5
  char str; // [sp+0h] [bp-718h]@2
  Profile_struct Profile_file; // [sp+108h] [bp-610h]@6
  FILE *offset; // [sp+714h] [bp-4h]@4

  if ( a1 )
    sprintf(&str, "%s", a1);
  else
    sprintf(&str, "%s\\%s", ExePath, Default_Name);
  offset = fopen(&str, "rb");
  if ( offset )
  {
    fread(&Profile_file, 8u, 1u, offset);
    if ( !memcmp(&Profile_file, offset_Profile_dat_check, 8u) )
    {
      fseek((int)offset, NULL, 0);
      memset(&Profile_file, 0, 0x604u);
      fread(&Profile_file, 0x604u, 1u, offset);
      fclose(offset);
      Selected_Weapon = Profile_file.Selected_Weapon;
      Selected_Item = Profile_file.Selected_Item;
      GameTime = Profile_file.Game_Time;
      memcpy(Weapons, Profile_file.Weapons, 0xA0u);
      memcpy(Quote_Inventory, Profile_file.Inventory, 0x80u);
      memcpy(Unlocked_Stages, Profile_file.Unlocked_Stages, 0x40u);
      memcpy(Map_Flag_Array, Profile_file.Map_Flag_Array, 0x80u);
      memcpy(Event_Flags, Profile_file.Event_Flags, 0x3E8u);
      Change_Music((Music_enum)Profile_file.Song_Num);
      Set_Quote_Initial_Values();
      if ( Transfer_Stage(Profile_file.Stage_Num, 0, 0, 1) )
      {
        Quote.Equipped_Items = Profile_file.Equipped_Items;
        Quote.Unit = Profile_file.Unit;
        Quote.Direction = Profile_file.Direction;
        Quote.Max_Health = Profile_file.Max_HP;
        Quote.Health = Profile_file.HP;
        Quote.star = Profile_file.star;
        Quote.Flags = -128;
        Quote.Air = 1000;
        Quote.Life_Bar = Profile_file.HP;
        Quote.X_Pos = Profile_file.X_Pos;
        Quote.Y_Pos = Profile_file.Y_Pos;
        Quote.Rect_Weapon.left = 24 * (Weapons[Selected_Weapon].ID % 10);
        Quote.Rect_Weapon.right = Quote.Rect_Weapon.left + 24;
        Quote.Rect_Weapon.top = 32 * (Weapons[Selected_Weapon].ID / 10);
        Quote.Rect_Weapon.bottom = Quote.Rect_Weapon.top + 16;
        Reset_Fade_Vars();
        Set_Camera_Quote();
        Set_Camera_Target_Quote(16);
        Init_Boss_Life();
        Cut_Noise();
        Init_Whimsical_Star();
        Clear_Value_View();
        Super_X_Pos = 0;
        result = 1;
      }
      else
      {
        result = 0;
      }
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;
// 499C6C: using guessed type int Selected_Item;
// 49E1EC: using guessed type int GameTime;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (0041D550) --------------------------------------------------------
int __cdecl Initialise_Game(HWND hWnd)
{
  int result; // eax@2

  Set_Quote_Initial_Values();
  Selected_Weapon = 0;
  Selected_Item = 0;
  GameTime = 0;
  Clear_Weapon_Data();
  Clear_Item_Data();
  Clear_Unlocked_Stages();
  Memset_Map_Flags_0();
  Clear_Event_Flags();
  if ( Transfer_Stage(13, 200, 10, 8) )
  {
    Reset_Fade_Vars();
    Set_Camera_Quote();
    Set_Camera_Target_Quote(16);
    Init_Boss_Life();
    Cut_Noise();
    Clear_Value_View();
    Super_X_Pos = 0;
    Set_Fade_Mask_();
    Set_Camera_Target_Quote(16);
    result = 1;
  }
  else
  {
    MessageBoxA(hWnd, "Xe[Ws", "G[", 0);
    result = 0;
  }
  return result;
}
// 499C68: using guessed type int Selected_Weapon;
// 499C6C: using guessed type int Selected_Item;
// 49E1EC: using guessed type int GameTime;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (0041D610) --------------------------------------------------------
void *Clear_Unlocked_Stages()
{
  return memset(Unlocked_Stages, 0, 0x40u);
}

//----- (0041D630) --------------------------------------------------------
signed int __cdecl Add_Permit_Stage(int index, int event)
{
  signed int result; // eax@7
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 8 && Unlocked_Stages[i].index != index && Unlocked_Stages[i].index; ++i )
    ;
  if ( i == 8 )
  {
    result = 0;
  }
  else
  {
    Unlocked_Stages[i].index = index;
    Unlocked_Stages[i].event = event;
    result = 1;
  }
  return result;
}

//----- (0041D6A0) --------------------------------------------------------
signed int __cdecl Remove_Unlocked_Stage(int a1)
{
  signed int result; // eax@6
  int v2; // ecx@9
  signed int i; // [sp+0h] [bp-4h]@1
  int ia; // [sp+0h] [bp-4h]@7

  for ( i = 0; i < 8 && Unlocked_Stages[i].index != a1; ++i )
    ;
  if ( i == 32 )
  {
    result = 0;
  }
  else
  {
    for ( ia = i + 1; ia < 8; ++ia )
    {
      v2 = Unlocked_Stages[ia].event;
      dword_4A54F8[2 * ia] = Unlocked_Stages[ia].index;
      dword_4A54FC[2 * ia] = v2;
    }
    dword_4A54F8[2 * ia] = 0;
    dword_4A54FC[2 * ia] = 0;
    result = 1;
  }
  return result;
}
// 4A54F8: using guessed type int dword_4A54F8[];
// 4A54FC: using guessed type int dword_4A54FC[];

//----- (0041D740) --------------------------------------------------------
void __cdecl Move_Stage_Select_Cursor()
{
  int i; // [sp+0h] [bp-8h]@1

  for ( i = 0; Unlocked_Stages[i].index; ++i )
    ;
  if ( i )
  {
    if ( Key_Left & Key_Pressed )
      --Selected_Stage;
    if ( Key_Right & Key_Pressed )
      ++Selected_Stage;
    if ( Selected_Stage < 0 )
      Selected_Stage = i - 1;
    if ( Selected_Stage > i - 1 )
      Selected_Stage = 0;
    if ( Key_Pressed & (Key_Right | Key_Left) )
      Start_TSC_Event(Unlocked_Stages[Selected_Stage].index + 1000);
    if ( Key_Pressed & (Key_Right | Key_Left) )
      Play_Sound_Effect(Sfx_Y_N_Change_Choice, 1);
  }
}
// 493630: using guessed type int Key_Left;
// 493638: using guessed type int Key_Right;
// 49E214: using guessed type int Key_Pressed;
// 4A5544: using guessed type int Selected_Stage;

//----- (0041D840) --------------------------------------------------------
void Draw_Teleporter_Menu()
{
  RECT v0; // [sp+0h] [bp-5Ch]@10
  RECT RectView; // [sp+10h] [bp-4Ch]@1
  int j; // [sp+20h] [bp-3Ch]@3
  RECT RectCur[2]; // [sp+24h] [bp-38h]@1
  RECT RectTitle_1; // [sp+44h] [bp-18h]@1
  int v5; // [sp+54h] [bp-8h]@7
  int i; // [sp+58h] [bp-4h]@7

  RectView.left = 0;
  RectView.top = 0;
  RectView.right = 320;
  RectView.bottom = 240;
  RectCur[0].left = 80;
  RectCur[0].top = 88;
  RectCur[0].right = 112;
  RectCur[0].bottom = 104;
  RectCur[1].left = 80;
  RectCur[1].top = 104;
  RectCur[1].right = 112;
  RectCur[1].bottom = 120;
  RectTitle_1.left = 80;
  RectTitle_1.top = 64;
  RectTitle_1.right = 144;
  RectTitle_1.bottom = 72;
  if ( Y_Position_Teleporter > 46 )
    --Y_Position_Teleporter;
  Draw_Bitmap_With_Transparency(&RectView, 128, Y_Position_Teleporter, &RectTitle_1, 26);
  for ( j = 0; Unlocked_Stages[j].index; ++j )
    ;
  ++dword_4A5548;
  if ( j )
  {
    v5 = (320 - 40 * j) / 2;
    Draw_Bitmap_With_Transparency(
      &RectView,
      v5 + 40 * Selected_Stage,
      64,
      &RectCur[((unsigned int)dword_4A5548 >> 1) % 2],
      26);
    for ( i = 0; i < 8 && Unlocked_Stages[i].index; ++i )
    {
      v0.left = 32 * (Unlocked_Stages[i].index % 8);
      v0.right = v0.left + 32;
      v0.top = 16 * (Unlocked_Stages[i].index / 8);
      v0.bottom = v0.top + 16;
      Draw_Bitmap_With_Transparency(&RectView, v5 + 40 * i, 64, &v0, 14);
    }
  }
}
// 4A5544: using guessed type int Selected_Stage;
// 4A5548: using guessed type int dword_4A5548;

//----- (0041DA00) --------------------------------------------------------
signed int __cdecl Game_Loop_Stage_Select(_DWORD *p_event)
{
  int TSC_Parser_Ret; // [sp+0h] [bp-128h]@8
  int Call_Escape_Ret; // [sp+4h] [bp-124h]@3
  char old_script_path; // [sp+8h] [bp-120h]@1
  RECT rcView; // [sp+118h] [bp-10h]@1

  rcView.left = 0;
  rcView.top = 0;
  rcView.right = 320;
  rcView.bottom = 240;
  Selected_Stage = 0;
  Backup_Surface(10, &rect);
  GetTextScriptPath(&old_script_path);
  Load_Special_TSC("StageSelect.tsc");
  Y_Position_Teleporter = 54;
  Start_TSC_Event(Unlocked_Stages[Selected_Stage].index + 1000);
  do
  {
    Get_Keys();
    if ( Key_Held & 0x8000 )
    {
      Call_Escape_Ret = Call_On_Escape(AppWinHandle);
      if ( !Call_Escape_Ret )
        return 0;
      if ( Call_Escape_Ret == 2 )
        return 2;
    }
    Move_Stage_Select_Cursor();
    TSC_Parser_Ret = TSC_Parser();
    if ( !TSC_Parser_Ret )
      return 0;
    if ( TSC_Parser_Ret == 2 )
      return 2;
    Draw_Bitmap_With_Transparency(&rcView, 0, 0, &rcView, 10);
    Draw_Teleporter_Menu();
    Draw_Text_Box();
    if ( Key_Ok & Key_Pressed )
    {
      Stop_Text_Script();
      loadTSCScript(&old_script_path);
      *p_event = Unlocked_Stages[Selected_Stage].event;
      return 1;
    }
    if ( Key_Cancel & Key_Pressed )
    {
      Stop_Text_Script();
      loadTSCScript(&old_script_path);
      *p_event = 0;
      return 1;
    }
    Display_FPS_Counter();
  }
  while ( Draw_Window(AppWinHandle) );
  return 0;
}
// 493628: using guessed type int Key_Ok;
// 49362C: using guessed type int Key_Cancel;
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;
// 4A5544: using guessed type int Selected_Stage;

//----- (0041DBD0) --------------------------------------------------------
void __cdecl Snake(int Level)
{
  int BulletID; // [sp+4h] [bp-4h]@0

  switch ( Level )
  {
    case 1:
      BulletID = 1;
      break;
    case 2:
      BulletID = 2;
      break;
    case 3:
      BulletID = 3;
      break;
  }
  if ( Count_Weapon_Bullets(1) <= 3 && Key_Shoot & Key_Pressed )
  {
    if ( !Use_Ammo(1) )
    {
      Change_To_First_Weapon();
    }
    else
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos - 5120, Up);
          Create_Effect(Quote.X_Pos + 1536, Quote.Y_Pos - 5120, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos - 5120, Up);
          Create_Effect(Quote.X_Pos - 1536, Quote.Y_Pos - 5120, 3, 0);
        }
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos + 5120, Down);
          Create_Effect(Quote.X_Pos + 1536, Quote.Y_Pos + 5120, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos + 5120, Down);
          Create_Effect(Quote.X_Pos - 1536, Quote.Y_Pos + 5120, 3, 0);
        }
      }
      else if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos + 1024, Right);
        Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1024, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos + 1024, 0);
        Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1024, 3, 0);
      }
      Play_Sound_Effect(Sfx_Fireball_Shoot, 1);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;

//----- (0041DE60) --------------------------------------------------------
void __cdecl Polar_Star(int Level)
{
  int BulletID; // [sp+4h] [bp-4h]@0

  switch ( Level )
  {
    case 1:
      BulletID = 4;
      break;
    case 2:
      BulletID = 5;
      break;
    case 3:
      BulletID = 6;
      break;
  }
  if ( Count_Weapon_Bullets(2) <= 1 && Key_Shoot & Key_Pressed )
  {
    if ( Use_Ammo(1) )
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos - 4096, Up);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos - 4096, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos - 4096, Up);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos - 4096, 3, 0);
        }
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos + 4096, Down);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos + 4096, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos + 4096, Down);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos + 4096, 3, 0);
        }
      }
      else if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos + 1536, Right);
        Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1536, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos + 1536, 0);
        Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1536, 3, 0);
      }
      if ( Level == 3 )
        Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_3, 1);
      else
        Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_1_2, 1);
    }
    else
    {
      Play_Sound_Effect(Sfx_No_Ammo, 1);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;

//----- (0041E110) --------------------------------------------------------
void __cdecl Fireball(int a1)
{
  int BulletID; // [sp+4h] [bp-4h]@0

  switch ( a1 )
  {
    case 1:
      if ( Count_Weapon_Bullets(3) > 1 )
        return;
      BulletID = 7;
      break;
    case 2:
      if ( Count_Weapon_Bullets(3) > 2 )
        return;
      BulletID = 8;
      break;
    case 3:
      if ( Count_Weapon_Bullets(3) > 3 )
        return;
      BulletID = 9;
      break;
  }
  if ( Key_Shoot & Key_Pressed )
  {
    if ( Use_Ammo(1) )
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 2048, Quote.Y_Pos - 4096, Up);
          Create_Effect(Quote.X_Pos + 2048, Quote.Y_Pos - 4096, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 2048, Quote.Y_Pos - 4096, Up);
          Create_Effect(Quote.X_Pos - 2048, Quote.Y_Pos - 4096, 3, 0);
        }
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 2048, Quote.Y_Pos + 4096, Down);
          Create_Effect(Quote.X_Pos + 2048, Quote.Y_Pos + 4096, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 2048, Quote.Y_Pos + 4096, Down);
          Create_Effect(Quote.X_Pos - 2048, Quote.Y_Pos + 4096, 3, 0);
        }
      }
      else if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos + 1024, Right);
        Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1024, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos + 1024, 0);
        Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1024, 3, 0);
      }
      Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
    }
    else
    {
      Change_To_First_Weapon();
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;

//----- (0041E3D0) --------------------------------------------------------
void __cdecl Machine_Gun(int Level)
{
  int BulletID; // [sp+4h] [bp-4h]@0

  if ( Count_Weapon_Bullets(4) <= 4 )
  {
    switch ( Level )
    {
      case 1:
        BulletID = 10;
        break;
      case 2:
        BulletID = 11;
        break;
      case 3:
        BulletID = 12;
        break;
    }
    if ( !(Key_Shoot & Key_Held) )
      Quote.Time_Between_Shots = 6;
    if ( Key_Shoot & Key_Held )
    {
      ++Quote.Time_Between_Shots;
      if ( (signed int)Quote.Time_Between_Shots >= 6 )
      {
        Quote.Time_Between_Shots = 0;
        if ( Use_Ammo(1) )
        {
          if ( Quote.Is_Facing_Up )
          {
            if ( Level == 3 )
              Quote.Y_Vel += 256;
            if ( Quote.Direction )
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos - 4096, Up);
              Create_Effect(Quote.X_Pos + 1536, Quote.Y_Pos - 4096, 3, 0);
            }
            else
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos - 4096, Up);
              Create_Effect(Quote.X_Pos - 1536, Quote.Y_Pos - 4096, 3, 0);
            }
          }
          else if ( Quote.Is_Facing_Down )
          {
            if ( Level == 3 )
            {
              if ( Quote.Y_Vel > 0 )
                Quote.Y_Vel /= 2;
              if ( Quote.Y_Vel > -1024 )
              {
                Quote.Y_Vel -= 512;
                if ( Quote.Y_Vel < -1024 )
                  Quote.Y_Vel = -1024;
              }
            }
            if ( Quote.Direction )
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos + 4096, Down);
              Create_Effect(Quote.X_Pos + 1536, Quote.Y_Pos + 4096, 3, 0);
            }
            else
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos + 4096, Down);
              Create_Effect(Quote.X_Pos - 1536, Quote.Y_Pos + 4096, 3, 0);
            }
          }
          else if ( Quote.Direction )
          {
            Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 6144, Quote.Y_Pos + 1536, Right);
            Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1536, 3, 0);
          }
          else
          {
            Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 6144, Quote.Y_Pos + 1536, 0);
            Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1536, 3, 0);
          }
          if ( Level == 3 )
            Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_3, 1);
          else
            Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_1_2, 1);
        }
        else
        {
          Play_Sound_Effect(Sfx_No_Ammo, 1);
          if ( !Empty_Effect_Timer )
          {
            Create_Effect(Quote.X_Pos, Quote.Y_Pos, 16, 0);
            Empty_Effect_Timer = 50;
          }
        }
      }
    }
    else
    {
      ++Machine_Gun_Reload_Timer;
      if ( Quote.Equipped_Items & 8 )
      {
        if ( Machine_Gun_Reload_Timer > 1 )
        {
          Machine_Gun_Reload_Timer = 0;
          Add_Ammo(1);
        }
      }
      else if ( Machine_Gun_Reload_Timer > 4 )
      {
        Machine_Gun_Reload_Timer = 0;
        Add_Ammo(1);
      }
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E210: using guessed type int Key_Held;
// 4A554C: using guessed type int Empty_Effect_Timer;
// 4A5554: using guessed type int Machine_Gun_Reload_Timer;

//----- (0041E7B0) --------------------------------------------------------
void __cdecl Missile_Launcher(int Level, bool Super)
{
  int BulletID; // [sp+10h] [bp-4h]@0

  if ( Super )
  {
    // Check Super Missile level
    switch ( Level )
    {
      case 1:
        BulletID = 28;
        break;
      case 2:
        BulletID = 29;
        break;
      case 3:
        BulletID = 30;
        break;
    }
    if ( Level == 1 )
    {
      if ( Count_Weapon_Bullets(10) > 0 || Count_Weapon_Bullets(11) > 0 )
        return;
    }
    else if ( Level == 2 )
    {
      if ( Count_Weapon_Bullets(10) > 1 || Count_Weapon_Bullets(11) > 1 )
        return;
    }
    else if ( Level == 3 && (Count_Weapon_Bullets(10) > 3 || Count_Weapon_Bullets(11) > 3) )
    {
      return;
    }
  }
  else
  {
    // Normal missile launcher
    switch ( Level )
    {
      case 1:
        BulletID = 13;
        break;
      case 2:
        BulletID = 14;
        break;
      case 3:
        BulletID = 15;
        break;
    }
    if ( Level == 1 )
    {
      if ( Count_Weapon_Bullets(5) > 0 || Count_Weapon_Bullets(6) > 0 )
        return;
    }
    else if ( Level == 2 )
    {
      if ( Count_Weapon_Bullets(5) > 1 || Count_Weapon_Bullets(6) > 1 )
        return;
    }
    else if ( Level == 3 && (Count_Weapon_Bullets(5) > 3 || Count_Weapon_Bullets(6) > 3) )
    {
      return;
    }
  }
  if ( !(Key_Shoot & Key_Pressed) )
    return;
  if ( Level < 3 )
  {
    if ( !Use_Ammo(1) )
    {
      Play_Sound_Effect(Sfx_No_Ammo, 1);
      if ( !Empty_Effect_Timer )
      {
        Create_Effect(Quote.X_Pos, Quote.Y_Pos, 16, 0);
        Empty_Effect_Timer = 50;
      }
      return;
    }
    if ( Quote.Is_Facing_Up )
    {
      if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos - 4096, Up);
        Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos - 4096, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos - 4096, Up);
        Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos - 4096, 3, 0);
      }
    }
    else if ( Quote.Is_Facing_Down )
    {
      if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos + 4096, Down);
        Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos + 4096, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos + 4096, Down);
        Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos + 4096, 3, 0);
      }
    }
    else if ( Quote.Direction )
    {
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos, Right);
      Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos, 3, 0);
    }
    else
    {
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos, 0);
      Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos, 3, 0);
    }
LABEL_78:
    Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_1_2, 1);
    return;
  }
  if ( Use_Ammo(1) )
  {
    if ( Quote.Is_Facing_Up )
    {
      if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos - 4096, Up);
        Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos - 4096, 3, 0);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos, Up);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos, Up);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos - 4096, Up);
        Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos - 4096, 3, 0);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos, Up);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos, Up);
      }
    }
    else if ( Quote.Is_Facing_Down )
    {
      if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos + 4096, Down);
        Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos + 4096, 3, 0);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos, Down);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos, Down);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos + 4096, Down);
        Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos + 4096, 3, 0);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos, Down);
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos, Down);
      }
    }
    else if ( Quote.Direction )
    {
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos + 512, Right);
      Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 512, 3, 0);
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos, Quote.Y_Pos - 4096, Right);
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 2048, Quote.Y_Pos - 512, Right);
    }
    else
    {
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos + 512, 0);
      Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 512, 3, 0);
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos, Quote.Y_Pos - 4096, 0);
      Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 2048, Quote.Y_Pos - 512, 0);
    }
    goto LABEL_78;
  }
  Play_Sound_Effect(Sfx_No_Ammo, 1);
  if ( !Empty_Effect_Timer )
  {
    Create_Effect(Quote.X_Pos, Quote.Y_Pos, 16, 0);
    Empty_Effect_Timer = 50;
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;
// 4A554C: using guessed type int Empty_Effect_Timer;

//----- (0041EFD0) --------------------------------------------------------
void Bubbler_Lvl_1_()
{
  // Shot limit : 3
  if ( Count_Weapon_Bullets(7) <= 3 )
  {
    if ( !(Key_Shoot & Key_Pressed) )
    {
      if ( ++Bubbler_Lvl_1_Refill_Timer > 20 )
      {
        Bubbler_Lvl_1_Refill_Timer = 0;
        Add_Ammo(1);
      }
    }
    else if ( !Use_Ammo(1) )
    {
      // No ammo left
      Play_Sound_Effect(Sfx_No_Ammo, 1);
      if ( !Empty_Effect_Timer )
      {
        Create_Effect(Quote.X_Pos, Quote.Y_Pos, 16, Left);
        Empty_Effect_Timer = 50;
      }
    }
    else
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
        {
          Create_Bullet(Bubbler_Lvl_1, Quote.X_Pos + 512, Quote.Y_Pos - 1024, Up);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos - 1024, 3, Left);
        }
        else
        {
          Create_Bullet(Bubbler_Lvl_1, Quote.X_Pos - 512, Quote.Y_Pos - 1024, Up);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos - 1024, 3, Left);
        }
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
        {
          Create_Bullet(Bubbler_Lvl_1, Quote.X_Pos + 512, Quote.Y_Pos + 1024, Down);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos + 1024, 3, Left);
        }
        else
        {
          Create_Bullet(Bubbler_Lvl_1, Quote.X_Pos - 512, Quote.Y_Pos + 1024, Down);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos + 1024, 3, Left);
        }
      }
      else if ( Quote.Direction )
      {
        Create_Bullet(Bubbler_Lvl_1, Quote.X_Pos + 3072, Quote.Y_Pos + 1536, Right);
        Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1536, 3, Left);
      }
      else
      {
        Create_Bullet(Bubbler_Lvl_1, Quote.X_Pos - 3072, Quote.Y_Pos + 1536, Left);
        Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1536, 3, Left);
      }
      Play_Sound_Effect(Sfx_Bubbler_Shoot, 1);
    }
  }
}
/* Orphan comments:
Spend 1 bullet per ammo
*/
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;
// 4A554C: using guessed type int Empty_Effect_Timer;
// 4A5558: using guessed type int Bubbler_Lvl_1_Refill_Timer;

//----- (0041F280) --------------------------------------------------------
void __cdecl Bubbler_Lvl_2_3(int Level)
{
  int BulletID; // [sp+8h] [bp+8h]@2

  if ( Count_Weapon_Bullets(7) <= 15 )
  {
    BulletID = Level + 18;
    if ( !(Key_Shoot & Key_Held) )
      Quote.Time_Between_Shots = 6;
    if ( Key_Shoot & Key_Held )
    {
      ++Quote.Time_Between_Shots;
      if ( (signed int)Quote.Time_Between_Shots >= 7 )
      {
        Quote.Time_Between_Shots = 0;
        if ( Use_Ammo(1) )
        {
          if ( Quote.Is_Facing_Up )
          {
            if ( Quote.Direction )
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos - 4096, Up);
              Create_Effect(Quote.X_Pos + 1536, Quote.Y_Pos - 0x2000, 3, 0);
            }
            else
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos - 4096, Up);
              Create_Effect(Quote.X_Pos - 1536, Quote.Y_Pos - 0x2000, 3, 0);
            }
          }
          else if ( Quote.Is_Facing_Down )
          {
            if ( Quote.Direction )
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 1536, Quote.Y_Pos + 4096, Down);
              Create_Effect(Quote.X_Pos + 1536, Quote.Y_Pos + 0x2000, 3, 0);
            }
            else
            {
              Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 1536, Quote.Y_Pos + 4096, Down);
              Create_Effect(Quote.X_Pos - 1536, Quote.Y_Pos + 0x2000, 3, 0);
            }
          }
          else if ( Quote.Direction )
          {
            Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos + 1536, Right);
            Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1536, 3, 0);
          }
          else
          {
            Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos + 1536, 0);
            Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1536, 3, 0);
          }
          Play_Sound_Effect(Sfx_Bubbler_Shoot, 1);
        }
        else
        {
          Play_Sound_Effect(Sfx_No_Ammo, 1);
          if ( !Empty_Effect_Timer )
          {
            Create_Effect(Quote.X_Pos, Quote.Y_Pos, 16, 0);
            Empty_Effect_Timer = 50;
          }
        }
      }
    }
    else if ( ++dword_4A555C > 1 )
    {
      dword_4A555C = 0;
      Add_Ammo(1);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E210: using guessed type int Key_Held;
// 4A554C: using guessed type int Empty_Effect_Timer;
// 4A555C: using guessed type int dword_4A555C;

//----- (0041F580) --------------------------------------------------------
void __cdecl Blade(int a1)
{
  int BulletID; // [sp+4h] [bp-4h]@0

  if ( Count_Weapon_Bullets(9) <= 0 )
  {
    switch ( a1 )
    {
      case 1:
        BulletID = 25;
        break;
      case 2:
        BulletID = 26;
        break;
      case 3:
        BulletID = 27;
        break;
    }
    if ( Key_Shoot & Key_Pressed )
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos + 2048, Up);
        else
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos + 2048, Up);
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos - 3072, Down);
        else
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos - 3072, Down);
      }
      else if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos - 1536, Right);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos - 1536, 0);
      }
      Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;

//----- (0041F710) --------------------------------------------------------
void __cdecl Nemesis(int Bullet_Level)
{
  int BulletID; // [sp+8h] [bp-4h]@0

  switch ( Bullet_Level )
  {
    case 1:
      BulletID = 34;
      break;
    case 2:
      BulletID = 35;
      break;
    case 3:
      BulletID = 36;
      break;
  }
  if ( Count_Weapon_Bullets(12) <= 1 && Key_Shoot & Key_Pressed )
  {
    if ( Use_Ammo(1) )
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos - 6144, Up);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos - 6144, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos - 6144, Up);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos - 6144, 3, 0);
        }
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos + 6144, Down);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos + 6144, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos + 6144, Down);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos + 6144, 3, 0);
        }
      }
      else if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 11264, Quote.Y_Pos + 1536, Right);
        Create_Effect(Quote.X_Pos + 0x2000, Quote.Y_Pos + 1536, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 11264, Quote.Y_Pos + 1536, 0);
        Create_Effect(Quote.X_Pos - 0x2000, Quote.Y_Pos + 1536, 3, 0);
      }
      switch ( Bullet_Level )
      {
        case 1:
          Play_Sound_Effect(Sfx_Nemesis_Shot, 1);
          break;
        case 2:
          Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_3, 1);
          break;
        case 3:
          Play_Sound_Effect(Sfx_Spur_Charge_Level_2, 1);
          break;
      }
    }
    else
    {
      Play_Sound_Effect(Sfx_No_Ammo, 1);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E214: using guessed type int Key_Pressed;

//----- (0041F9E0) --------------------------------------------------------
int Reset_Spur_Charge()
{
  int result; // eax@1

  dword_4A5550 = 0;
  result = 20 * Selected_Weapon;
  if ( Weapons[Selected_Weapon].ID == 13 )
    result = Reset_Selected_Weapon_Level();
  return result;
}
// 499C68: using guessed type int Selected_Weapon;
// 4A5550: using guessed type int dword_4A5550;

//----- (0041FA10) --------------------------------------------------------
void __cdecl Spur(int level)
{
  signed int v1; // [sp+Ch] [bp-8h]@1
  int BulletID; // [sp+10h] [bp-4h]@0

  v1 = 0;
  if ( Key_Shoot & Key_Held )
  {
    if ( Quote.Equipped_Items & 8 )
      Add_Weapon_EXP(3);
    else
      Add_Weapon_EXP(2);
    if ( ++dword_4A5550 / 2 % 2 )
    {
      if ( level == 1 )
      {
        Play_Sound_Effect(Sfx_Spur_Charge_Level_1, 1);
      }
      else if ( level == 2 )
      {
        Play_Sound_Effect(Sfx_Spur_Charge_Level_2, 1);
      }
      else if ( level == 3 && !Check_Weapon_MAX() )
      {
        Play_Sound_Effect(Sfx_Spur_Charge_Level_3, 1);
      }
    }
  }
  else
  {
    if ( dword_4A5550 )
      v1 = 1;
    dword_4A5550 = 0;
  }
  if ( Check_Weapon_MAX() )
  {
    if ( !dword_4A5560 )
    {
      dword_4A5560 = 1;
      Play_Sound_Effect(Sfx_Spur_Charge_MAX, 1);
    }
  }
  else
  {
    dword_4A5560 = 0;
  }
  if ( !(Key_Shoot & Key_Held) )
    Reset_Selected_Weapon_Level();
  switch ( level )
  {
    case 1:
      BulletID = Polar_Star_Lvl_3;
      v1 = 0;
      break;
    case 2:
      BulletID = Chargeless_Spur_Lvl_1;
      break;
    case 3:
      if ( dword_4A5560 )
        BulletID = Chargeless_Spur_Lvl_3;
      else
        BulletID = Chargeless_Spur_Lvl_2;
      break;
  }
  if ( Count_Weapon_Bullets(13) <= 0 && Count_Weapon_Bullets(14) <= 0 && (Key_Shoot & Key_Pressed || v1) )
  {
    if ( Use_Ammo(1) )
    {
      if ( Quote.Is_Facing_Up )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos - 4096, Up);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos - 4096, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos - 4096, Up);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos - 4096, 3, 0);
        }
      }
      else if ( Quote.Is_Facing_Down )
      {
        if ( Quote.Direction )
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 512, Quote.Y_Pos + 4096, Down);
          Create_Effect(Quote.X_Pos + 512, Quote.Y_Pos + 4096, 3, 0);
        }
        else
        {
          Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 512, Quote.Y_Pos + 4096, Down);
          Create_Effect(Quote.X_Pos - 512, Quote.Y_Pos + 4096, 3, 0);
        }
      }
      else if ( Quote.Direction )
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos + 3072, Quote.Y_Pos + 1536, Right);
        Create_Effect(Quote.X_Pos + 6144, Quote.Y_Pos + 1536, 3, 0);
      }
      else
      {
        Create_Bullet((Bullet_enum)BulletID, Quote.X_Pos - 3072, Quote.Y_Pos + 1536, 0);
        Create_Effect(Quote.X_Pos - 6144, Quote.Y_Pos + 1536, 3, 0);
      }
      switch ( BulletID )
      {
        case 6:
          Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_3, 1);
          break;
        case 37:
          Play_Sound_Effect(Sfx_Spur_Shoot_Level_1, 1);
          break;
        case 38:
          Play_Sound_Effect(Sfx_Spur_Shoot_Level_2, 1);
          break;
        case 39:
          Play_Sound_Effect(Sfx_Spur_Shoot_Level_3, 1);
          break;
        default:
          return;
      }
    }
    else
    {
      Play_Sound_Effect(Sfx_No_Ammo, 1);
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;
// 4A5550: using guessed type int dword_4A5550;
// 4A5560: using guessed type int dword_4A5560;

//----- (0041FE70) --------------------------------------------------------
void Shoot_Bullet()
{
  int v0; // [sp+0h] [bp-Ch]@23
  int v1; // [sp+4h] [bp-8h]@15

  if ( Empty_Effect_Timer )
    --Empty_Effect_Timer;
  if ( dword_4A5564 )
    --dword_4A5564;
  if ( Key_Shoot & Key_Pressed )
  {
    if ( dword_4A5564 )
      return;
    dword_4A5564 = 4;
  }
  if ( !(Quote.Flags & 2) )
  {
    switch ( Weapons[Selected_Weapon].ID )
    {
      case 1:
        Snake(Weapons[Selected_Weapon].Level);
        break;
      case 2:
        Polar_Star(Weapons[Selected_Weapon].Level);
        break;
      case 3:
        Fireball(Weapons[Selected_Weapon].Level);
        break;
      case 4:
        Machine_Gun(Weapons[Selected_Weapon].Level);
        break;
      case 5:
        Missile_Launcher(Weapons[Selected_Weapon].Level, 0);
        break;
      case 7:
        v1 = Weapons[Selected_Weapon].Level;
        switch ( v1 )
        {
          case 1:
            Bubbler_Lvl_1_();
            break;
          case 2:
            Bubbler_Lvl_2_3(2);
            break;
          case 3:
            Bubbler_Lvl_2_3(3);
            break;
        }
        break;
      case 9:
        v0 = Weapons[Selected_Weapon].Level;
        switch ( v0 )
        {
          case 1:
            Blade(1);
            break;
          case 2:
            Blade(2);
            break;
          case 3:
            Blade(3);
            break;
        }
        break;
      case 0xA:
        Missile_Launcher(Weapons[Selected_Weapon].Level, 1);
        break;
      case 0xC:
        Nemesis(Weapons[Selected_Weapon].Level);
        break;
      case 0xD:
        Spur(Weapons[Selected_Weapon].Level);
        break;
      default:
        return;
    }
  }
}
// 493614: using guessed type int Key_Shoot;
// 499C68: using guessed type int Selected_Weapon;
// 49E214: using guessed type int Key_Pressed;
// 4A554C: using guessed type int Empty_Effect_Timer;
// 4A5564: using guessed type int dword_4A5564;

//----- (004200C0) --------------------------------------------------------
BOOL __cdecl Init_Direct_Sound(HWND hwnd)
{
  BOOL result; // eax@2
  DSBUFFERDESC dsbd; // [sp+0h] [bp-18h]@3
  int i; // [sp+14h] [bp-4h]@3

  // Initialise direct draw
  if ( DirectSoundCreate(NULL, &lpDS, NULL) )
  {
    lpDS = NULL;
    Start_Organya();
    result = 0;
  }
  else
  {
    lpDS->lpVtbl->SetCooperativeLevel(lpDS, hwnd, 3);
    // Initialise primary buffer
    memset(&dsbd, 0, 20u);
    dsbd.dwSize = 20;
    dsbd.dwFlags = DSBCAPS_CTRLVOLUME|DSBCAPS_CTRLPAN|DSBCAPS_PRIMARYBUFFER;
    lpDS->lpVtbl->CreateSoundBuffer(lpDS, &dsbd, &lpPRIMARYBUFFER, NULL);
    for ( i = 0; i < 160; ++i )
      lpSECONDARYBUFFER[i] = NULL;
    Start_Organya();
    result = 1;
  }
  return result;
}

//----- (004201A0) --------------------------------------------------------
// Direct Sound termination
void __cdecl End_Direct_Sound()
{
  signed int i; // [sp+0h] [bp-4h]@2

  if ( lpDS )
  {
    End_Organya();
    for ( i = 0; i < 160; ++i )
    {
      if ( lpSECONDARYBUFFER[i] )
        lpSECONDARYBUFFER[i]->lpVtbl->Release(lpSECONDARYBUFFER[i]);
    }
    if ( lpPRIMARYBUFFER )
      lpPRIMARYBUFFER->lpVtbl->Release(lpPRIMARYBUFFER);
    if ( lpDS )
      ((void (__cdecl *)(_DWORD))lpDS->lpVtbl->Release)(lpDS);
    lpDS = NULL;
  }
}

//----- (00420240) --------------------------------------------------------
// Unused
signed int __cdecl Init_Sound_Object(LPCSTR Resource_Name, int num)
{
  signed int result; // eax@2
  HGLOBAL temp1; // eax@5
  void *lpbuf2; // [sp+0h] [bp-2Ch]@7
  HRSRC hrscr; // [sp+4h] [bp-28h]@3
  size_t dwbuf1; // [sp+8h] [bp-24h]@7
  DSBUFFERDESC dsbd; // [sp+Ch] [bp-20h]@5
  DWORD *lpdword; // [sp+20h] [bp-Ch]@5 Resource address
  void *lpbuf1; // [sp+24h] [bp-8h]@7
  size_t dwbuf2; // [sp+28h] [bp-4h]@7

  if ( lpDS )
  {
    // Search for resources
    hrscr = FindResourceA(NULL, Resource_Name, "WAVE");
    if ( !hrscr )
    {
      result = 0;
    }
    else
    {
      // Get resource address
      temp1 = LoadResource(NULL, hrscr);
      lpdword = (DWORD *)LockResource(temp1);
      // Generate secondary buffer
      memset(&dsbd, 0, 20u);
      dsbd.dwSize = 20;
      dsbd.dwFlags = DSBCAPS_CTRLVOLUME|DSBCAPS_CTRLPAN|DSBCAPS_CTRLFREQUENCY|DSBCAPS_STATIC|0x8000;
      dsbd.dwBufferBytes = *(DWORD *)((char *)lpdword + 0x36);
      dsbd.lpwfxFormat = (LPWAVEFORMATEX)(lpdword + 5);
      if ( lpDS->lpVtbl->CreateSoundBuffer(lpDS, &dsbd, &lpSECONDARYBUFFER[num], 0) )
      {
        result = 0;
      }
      else
      {
        // Lock secondary buffer
        lpSECONDARYBUFFER[num]->lpVtbl->Lock(
          lpSECONDARYBUFFER[num],
          0,
          *(DWORD *)((char *)lpdword + 0x36),
          &lpbuf1,
          &dwbuf1,
          &lpbuf2,
          &dwbuf2,
          0);
        // Setting of sound source data
        memcpy(lpbuf1, (char *)lpdword + 58, dwbuf1);
        if ( dwbuf2 )
          memcpy(lpbuf2, (char *)lpdword + dwbuf1 + 58, dwbuf2);
        // Unlock secondary buffer
        lpSECONDARYBUFFER[num]->lpVtbl->Unlock(lpSECONDARYBUFFER[num], lpbuf1, dwbuf1, lpbuf2, dwbuf2);
        result = 1;
      }
    }
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (00420390) --------------------------------------------------------
// Unused
BOOL __cdecl Load_Sound_Object(char *file_name, int num)
{
  BOOL result; // eax@2
  LPVOID lpbuf2; // [sp+0h] [bp-184h]@23
  char str; // [sp+4h] [bp-180h]@1
  char check_box[58]; // [sp+10Ch] [bp-78h]@9
  int hr; // [sp+14Ch] [bp-38h]@23
  DWORD dwbuf1; // [sp+150h] [bp-34h]@23
  DSBUFFERDESC dsbd; // [sp+154h] [bp-30h]@21
  HANDLE hFile; // [sp+168h] [bp-1Ch]@3
  LPVOID lpbuf1; // [sp+16Ch] [bp-18h]@23
  void *wp; // [sp+170h] [bp-14h]@18
  FILE *fp; // [sp+174h] [bp-10h]@5
  DWORD dwbuf2; // [sp+178h] [bp-Ch]@23
  size_t i; // [sp+17Ch] [bp-8h]@7
  size_t file_size; // [sp+180h] [bp-4h]@1

  file_size = 0;
  sprintf(&str, "%s\\%s", ExePath, file_name);
  if ( lpDS )
  {
    hFile = CreateFileA(&str, 0x80000000, 0, NULL, 3u, 0x80u, NULL);
    if ( hFile == (HANDLE)-1 )
    {
      result = 0;
    }
    else
    {
      file_size = GetFileSize(hFile, NULL);
      CloseHandle(hFile);
      fp = fopen(&str, "rb");
      if ( fp )
      {
        for ( i = 0; i < 58; ++i )
          fread(&check_box[i], 1u, 1u, fp);
        if ( check_box[0] != 'R' )
        {
          result = 0;
        }
        else if ( check_box[1] != 'I' )
        {
          result = 0;
        }
        else if ( check_box[2] != 'F' )
        {
          result = 0;
        }
        else if ( check_box[3] != 'F' )
        {
          result = 0;
        }
        else
        {
          wp = malloc(file_size);               // Make a file workspace
          fseek((int)fp, NULL, 0);
          for ( i = 0; i < file_size; ++i )
            fread((char *)wp + i, 1u, 1u, fp);
          fclose(fp);
          // Generate secondary buffer
          memset(&dsbd, 0, 20u);
          dsbd.dwSize = 20;
          dsbd.dwFlags = DSBCAPS_CTRLVOLUME|DSBCAPS_CTRLPAN|DSBCAPS_CTRLFREQUENCY|DSBCAPS_STATIC|0x8000;
          dsbd.dwBufferBytes = *(_DWORD *)((char *)wp + 0x36);// WAVE data size
          dsbd.lpwfxFormat = (LPWAVEFORMATEX)((char *)wp + 20);
          if ( lpDS->lpVtbl->CreateSoundBuffer(lpDS, &dsbd, &lpSECONDARYBUFFER[num], 0) )
          {
            result = 0;
          }
          else
          {
            hr = lpSECONDARYBUFFER[num]->lpVtbl->Lock(
                   lpSECONDARYBUFFER[num],
                   0,
                   *(_DWORD *)((char *)wp + 54),
                   &lpbuf1,
                   (size_t *)&dwbuf1,
                   &lpbuf2,
                   (size_t *)&dwbuf2,
                   0);
            if ( hr )
            {
              result = 0;
            }
            else
            {
              memcpy(lpbuf1, (char *)wp + 58, dwbuf1);// head of data
              if ( dwbuf2 )
                memcpy(lpbuf2, (char *)wp + dwbuf1 + 58, dwbuf2);
              lpSECONDARYBUFFER[num]->lpVtbl->Unlock(lpSECONDARYBUFFER[num], lpbuf1, dwbuf1, lpbuf2, dwbuf2);
              free(wp);
              result = 1;
            }
          }
        }
      }
      else
      {
        result = 0;
      }
    }
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (00420640) --------------------------------------------------------
// Play sound
void __cdecl Play_Sound_Effect(Sound_Effects_enum Num, int Mode)
{
  if ( lpDS && lpSECONDARYBUFFER[Num] )
  {
    if ( Mode == -1 )
    {
      // Play loop
      lpSECONDARYBUFFER[Num]->lpVtbl->Play(lpSECONDARYBUFFER[Num], 0, 0, DSBPLAY_LOOPING);
    }
    else if ( !Mode )
    {
      // Stop
      lpSECONDARYBUFFER[Num]->lpVtbl->Stop(lpSECONDARYBUFFER[Num]);
    }
    else if ( Mode == 1 )
    {
      // Playback
      lpSECONDARYBUFFER[Num]->lpVtbl->Stop(lpSECONDARYBUFFER[Num]);
      lpSECONDARYBUFFER[Num]->lpVtbl->SetCurrentPosition(lpSECONDARYBUFFER[Num], 0);
      lpSECONDARYBUFFER[Num]->lpVtbl->Play(lpSECONDARYBUFFER[Num], 0, 0, 0);
    }
  }
}

//----- (00420720) --------------------------------------------------------
void __cdecl Change_Sound_Frequency(int Num, DWORD rate)
{
  if ( lpDS )
    ((void (__stdcall *)(_DWORD, _DWORD))lpSECONDARYBUFFER[Num]->lpVtbl->SetFrequency)(
      lpSECONDARYBUFFER[Num],
      10 * rate + 100);
}

//----- (00420760) --------------------------------------------------------
void __cdecl Change_Sound_Volume(int Num, int Volume)
{
  if ( lpDS )
    lpSECONDARYBUFFER[Num]->lpVtbl->SetVolume(lpSECONDARYBUFFER[Num], 8 * Volume - 2400);
}

//----- (004207A0) --------------------------------------------------------
void __cdecl Change_Sound_Pan(int Num, int Pan)
{
  if ( lpDS )
    lpSECONDARYBUFFER[Num]->lpVtbl->SetPan(lpSECONDARYBUFFER[Num], 10 * (Pan - 256));
}

//----- (004207E0) --------------------------------------------------------
size_t __cdecl Make_PixTone_Object(int *Ptr_Sound, int Channels, int SoundID)
{
  size_t result; // eax@2
  size_t num; // [sp+0h] [bp-7Ch]@34
  int j; // [sp+4h] [bp-78h]@25
  void *v6; // [sp+8h] [bp-74h]@34
  void *v7; // [sp+Ch] [bp-70h]@3
  int ptr; // [sp+10h] [bp-6Ch]@8
  int v9; // [sp+14h] [bp-68h]@8
  size_t v10; // [sp+18h] [bp-64h]@8
  int *v11; // [sp+20h] [bp-5Ch]@8
  void *v12; // [sp+24h] [bp-58h]@34
  void *source; // [sp+28h] [bp-54h]@3
  void *src; // [sp+2Ch] [bp-50h]@3
  size_t size; // [sp+30h] [bp-4Ch]@3
  void *v16; // [sp+34h] [bp-48h]@3
  int i; // [sp+38h] [bp-44h]@3
  void *dest; // [sp+3Ch] [bp-40h]@10
  void *pBlock; // [sp+40h] [bp-3Ch]@10
  size_t count; // [sp+44h] [bp-38h]@34
  int *v21; // [sp+48h] [bp-34h]@3
  int destination; // [sp+4Ch] [bp-30h]@3
  int v23; // [sp+50h] [bp-2Ch]@3
  int v24; // [sp+54h] [bp-28h]@3
  int dst; // [sp+58h] [bp-24h]@3
  int v26; // [sp+5Ch] [bp-20h]@3
  int v27; // [sp+60h] [bp-1Ch]@3
  int v28; // [sp+64h] [bp-18h]@3
  int v29; // [sp+68h] [bp-14h]@3
  __int16 v30; // [sp+6Ch] [bp-10h]@3
  __int16 v31; // [sp+6Eh] [bp-Eh]@3
  int v32; // [sp+70h] [bp-Ch]@3
  int v33; // [sp+74h] [bp-8h]@3

  if ( lpDS )
  {
    source = "RIFF";
    src = "fmt ";
    v16 = "WAVE";
    v7 = "data";
    v31 = 8;
    v28 = 22050;
    v27 = 65537;
    v26 = 16;
    memcpy(&destination, "RIFF", 4u);
    memcpy(&dst, "fmt ", 4u);
    memcpy(&v24, "WAVE", 4u);
    memcpy(&v32, "data", 4u);
    v30 = 1;
    v29 = 22050;
    v33 = Ptr_Sound[1];
    v23 = v33 + 36;
    v21 = Ptr_Sound;
    size = 0;
    for ( i = 0; i < Channels; ++i )
    {
      if ( v21[1] > (signed int)size )
        size = v21[1];
      v21 += 28;
    }
    memset(&ptr, 0, 0x14u);
    ptr = 20;
    v9 = 32994;
    v10 = size;
    v11 = &v27;
    if ( lpDS->lpVtbl->CreateSoundBuffer(lpDS, (DSBUFFERDESC *)&ptr, (LPDIRECTSOUNDBUFFER *)(4 * SoundID + 4871528), 0) )
    {
      result = -1;
    }
    else
    {
      pBlock = NULL;
      dest = NULL;
      dest = malloc(size);
      pBlock = malloc(size);
      if ( dest && pBlock )
      {
        memset(dest, 128, size);
        memset(pBlock, 128, size);
        v21 = Ptr_Sound;
        for ( i = 0; i < Channels; ++i )
        {
          if ( !MakePixelWaveData((int)v21, (int)dest) )
          {
            if ( dest )
              free(dest);
            if ( pBlock )
              free(pBlock);
            return -1;
          }
          for ( j = 0; j < v21[1]; ++j )
          {
            if ( *((_BYTE *)dest + j) + *((_BYTE *)pBlock + j) - 256 >= -127 )
            {
              if ( *((_BYTE *)dest + j) + *((_BYTE *)pBlock + j) - 256 <= 127 )
                *((_BYTE *)pBlock + j) += *((_BYTE *)dest + j) + -128;
              else
                *((_BYTE *)pBlock + j) = -1;
            }
            else
            {
              *((_BYTE *)pBlock + j) = 0;
            }
          }
          v21 += 28;
        }
        *(_BYTE *)pBlock = *(_BYTE *)pBlock;
        *((char *)pBlock + size - 1) = *((char *)pBlock + size - 1);
        lpSECONDARYBUFFER[SoundID]->lpVtbl->Lock(lpSECONDARYBUFFER[SoundID], 0, size, &v6, &num, &v12, &count, 0);
        memcpy(v6, pBlock, num);
        if ( count )
          memcpy(v12, (char *)pBlock + num, count);
        lpSECONDARYBUFFER[SoundID]->lpVtbl->Unlock(lpSECONDARYBUFFER[SoundID], v6, num, v12, count);
        if ( dest )
          free(dest);
        if ( pBlock )
          free(pBlock);
        result = size;
      }
      else
      {
        if ( dest )
          free(dest);
        if ( pBlock )
          free(pBlock);
        result = -1;
      }
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00420BE0) --------------------------------------------------------
// Load stage
signed int __cdecl Transfer_Stage(int number, int Event, int X_Pos, int Y_Pos)
{
  signed int result; // eax@18
  char path[260]; // [sp+0h] [bp-128h]@1
  int bError; // [sp+10Ch] [bp-1Ch]@1
  char path_dir[20]; // [sp+110h] [bp-18h]@1

  // Change player's position
  Set_Quote_Position(X_Pos << 13, Y_Pos << 13);
  bError = 0;
  strcpy(path_dir, "stage");
  sprintf(path, "%s\\Prt%s", path_dir, &Map_Headers[number]);
  if ( !ReloadBitmap_From_File(path, 2) )
    bError = 1;
  sprintf(path, "%s\\%s.pxa", path_dir, &Map_Headers[number]);
  if ( !Load_Attribute_Data(path) )
    bError = 1;
  sprintf(path, "%s\\%s.pxm", path_dir, Map_Headers[number].Map);
  if ( !Load_Map_Data(path) )
    bError = 1;
  sprintf(path, "%s\\%s.pxe", path_dir, Map_Headers[number].Map);
  if ( !Load_Event(path) )
    bError = 1;
  sprintf(path, "%s\\%s.tsc", path_dir, Map_Headers[number].Map);
  if ( !loadTSCScript(path) )
    bError = 1;
  sprintf(path, "%s", Map_Headers[number].Background_File);
  if ( !Init_Background(path, Map_Headers[number].bkType) )
    bError = 1;
  strcpy(path_dir, "Npc");
  sprintf(path, "%s\\Npc%s", path_dir, Map_Headers[number].Npc_File);
  if ( !ReloadBitmap_From_File(path, 21) )
    bError = 1;
  sprintf(path, "%s\\Npc%s", path_dir, Map_Headers[number].Boss_File);
  if ( !ReloadBitmap_From_File(path, 22) )
    bError = 1;
  if ( bError )
  {
    result = 0;
  }
  else
  {
    Ready_Map_Name(Map_Headers[number].Name);
    Start_TSC_Event(Event);
    Set_Camera_Quote();
    Clear_Bullets();
    Init_Effects();
    Clear_Value_View();
    Reset_Quake();
    Init_Room_Boss(Map_Headers[number].Boss_Num);
    Reset_Flash();
    Current_Stage_Num = number;
    result = 1;
  }
  return result;
}
// 4A57F0: using guessed type int Current_Stage_Num;

//----- (00420EE0) --------------------------------------------------------
// CMU : Change MUsic
// Change playing music to Music_To_Play
void __cdecl Change_Music(Music_enum num)
{
  if ( num == Mus_Silence || num != Current_Song_Number )
  {
    Old_Song_Pos = Get_Organya_Position();
    Old_Song_Number = Current_Song_Number;
    Stop_Organya_Music();
    Load_Organya(off_4981E8[num]);
    Change_Organya_Volume(100);
    Set_Organya_Position(0);
    Start_Organya_Playback();
    Current_Song_Number = num;
  }
}
// 4A57F4: using guessed type int Current_Song_Number;
// 4A57F8: using guessed type int Old_Song_Pos;
// 4A57FC: using guessed type int Old_Song_Number;

//----- (00420F50) --------------------------------------------------------
// RMU : Play pRevious MUsic
int ReCall_Music()
{
  int result; // eax@1

  Stop_Organya_Music();
  Load_Organya(off_4981E8[Old_Song_Number]);
  Set_Organya_Position(Old_Song_Pos);
  Change_Organya_Volume(100);
  Start_Organya_Playback();
  result = Old_Song_Number;
  Current_Song_Number = Old_Song_Number;
  return result;
}
// 4A57F4: using guessed type int Current_Song_Number;
// 4A57F8: using guessed type int Old_Song_Pos;
// 4A57FC: using guessed type int Old_Song_Number;

//----- (00420FA0) --------------------------------------------------------
// Move whimsical star to Quote's position
void __cdecl Init_Whimsical_Star()
{
  memset(Whimsical_Star, 0, 0xCCu);
  Whimsical_Star[0].X_Pos = Quote.X_Pos;
  Whimsical_Star[0].Y_Pos = Quote.Y_Pos;
  Whimsical_Star[1].X_Pos = Quote.X_Pos;
  Whimsical_Star[1].Y_Pos = Quote.Y_Pos;
  Whimsical_Star[2].X_Pos = Quote.X_Pos;
  Whimsical_Star[2].Y_Pos = Quote.Y_Pos;
  Whimsical_Star[0].X_Vel = 1024;
  Whimsical_Star[0].Y_Vel = -512;
  Whimsical_Star[1].X_Vel = -512;
  Whimsical_Star[1].Y_Vel = 1024;
  Whimsical_Star[2].X_Vel = 512;
  Whimsical_Star[2].Y_Vel = 512;
}

//----- (00421040) --------------------------------------------------------
int Do_Whimsical_Star()
{
  int result; // eax@1
  signed int i; // [sp+0h] [bp-4h]@1

  result = ++CurrentStarID / 3;
  CurrentStarID %= 3;
  for ( i = 0; i < 3; ++i )
  {
    if ( i )
    {
      if ( Whimsical_Star[i - 1].X_Pos >= Whimsical_Star[i].X_Pos )
        Whimsical_Star[i].X_Vel += 128;
      else
        Whimsical_Star[i].X_Vel -= 128;
      if ( Whimsical_Star[i - 1].Y_Pos >= Whimsical_Star[i].Y_Pos )
        Whimsical_Star[i].Y_Vel += 170;
      else
        Whimsical_Star[i].Y_Vel -= 170;
    }
    else
    {
      if ( Quote.X_Pos >= Whimsical_Star[0].X_Pos )
        Whimsical_Star[0].X_Vel += 128;
      else
        Whimsical_Star[0].X_Vel -= 128;
      if ( Quote.Y_Pos >= Whimsical_Star[0].Y_Pos )
        Whimsical_Star[0].Y_Vel += 170;
      else
        Whimsical_Star[0].Y_Vel -= 170;
    }
    if ( Whimsical_Star[i].X_Vel > 2560 )
      Whimsical_Star[i].X_Vel = 2560;
    if ( Whimsical_Star[i].X_Vel < -2560 )
      Whimsical_Star[i].X_Vel = -2560;
    if ( Whimsical_Star[i].Y_Vel > 2560 )
      Whimsical_Star[i].Y_Vel = 2560;
    if ( Whimsical_Star[i].Y_Vel < -2560 )
      Whimsical_Star[i].Y_Vel = -2560;
    if ( Whimsical_Star[i].X_Vel > 2560 )
      Whimsical_Star[i].X_Vel = 2560;
    if ( Whimsical_Star[i].X_Vel < -2560 )
      Whimsical_Star[i].X_Vel = -2560;
    if ( Whimsical_Star[i].Y_Vel > 2560 )
      Whimsical_Star[i].Y_Vel = 2560;
    if ( Whimsical_Star[i].Y_Vel < -2560 )
      Whimsical_Star[i].Y_Vel = -2560;
    Whimsical_Star[i].X_Pos += Whimsical_Star[i].X_Vel;
    result = 68 * i;
    Whimsical_Star[i].Y_Pos += Whimsical_Star[i].Y_Vel;
    if ( i < Quote.star )
    {
      if ( Quote.Equipped_Items & 0x80 )
      {
        result = Game_Flags & 2;
        if ( Game_Flags & 2 )
        {
          if ( CurrentStarID == i )
            Create_Bullet(Spur_Lvl_3, Whimsical_Star[CurrentStarID].X_Pos, Whimsical_Star[CurrentStarID].Y_Pos, 0);
        }
      }
    }
  }
  return result;
}
// 49E1E8: using guessed type int Game_Flags;
// 4A58CC: using guessed type int CurrentStarID;

//----- (004213B0) --------------------------------------------------------
void __cdecl Draw_Whimsical_Star(signed int a1, signed int a2)
{
  signed int i; // [sp+0h] [bp-34h]@3
  RECT rect; // [sp+4h] [bp-30h]@1
  int v4; // [sp+14h] [bp-20h]@1
  int v5; // [sp+18h] [bp-1Ch]@1
  int v6; // [sp+1Ch] [bp-18h]@1
  int v7; // [sp+20h] [bp-14h]@1
  int v8; // [sp+24h] [bp-10h]@1
  int v9; // [sp+28h] [bp-Ch]@1
  int v10; // [sp+2Ch] [bp-8h]@1
  int v11; // [sp+30h] [bp-4h]@1

  rect.left = 192;
  rect.top = 0;
  rect.right = 200;
  rect.bottom = 8;
  v4 = 192;
  v5 = 8;
  v6 = 200;
  v7 = 16;
  v8 = 192;
  v9 = 16;
  v10 = 200;
  v11 = 24;
  if ( !(Quote.Flags & 2) && Quote.Equipped_Items & 0x80 )
  {
    for ( i = 0; i < 3; ++i )
    {
      if ( i < Quote.star )
        Draw_Bitmap_With_Transparency(
          &Rect_Game,
          Whimsical_Star[i].X_Pos / 512 - a1 / 512 - 4,
          Whimsical_Star[i].Y_Pos / 512 - a2 / 512 - 4,
          &rect + i,
          16);
    }
  }
}

//----- (004214E0) --------------------------------------------------------
// Might be related to text box text surfaces ?
_BOOL4 __cdecl Init_TSC()
{
  signed int i; // [sp+0h] [bp-4h]@1

  byte_4A5ADC = 0;
  Game_Flags &= -5u;
  for ( i = 0; i < 4; ++i )
    MakeSurface_Blank(unk_498298, unk_49829C, i + 30, 0);
  memset(&textBuffer, 0, 0x100u);
  scriptBuffer = (unsigned __int8 *)malloc(0x5000u);
  return scriptBuffer != NULL;
}
// 49E1E8: using guessed type int Game_Flags;
// 4A5ADC: using guessed type char byte_4A5ADC;

//----- (00421570) --------------------------------------------------------
void *End_TSC_Script()
{
  void *result; // eax@1
  signed int i; // [sp+0h] [bp-4h]@1

  free(scriptBuffer);
  result = Destroy_Bitmap_Obj_Maybe(26);
  for ( i = 0; i < 4; ++i )
    result = Destroy_Bitmap_Obj_Maybe(i + 30);
  return result;
}

//----- (004215C0) --------------------------------------------------------
void __cdecl decryptTSCScript(unsigned __int8 *TSCData, signed int size)
{
  int val1; // [sp+0h] [bp-10h]@2
  signed int i; // [sp+8h] [bp-8h]@4
  int half; // [sp+Ch] [bp-4h]@1

  half = size / 2;
  if ( TSCData[size / 2] )
    val1 = -(TSCData[half] % 256);
  else
    LOBYTE(val1) = -7;
  for ( i = 0; i < size; ++i )
  {
    if ( i != half )
      TSCData[i] += val1;
  }
}

//----- (00421660) --------------------------------------------------------
int __cdecl Load_Special_TSC(char *source)
{
  int result; // eax@2
  char str; // [sp+0h] [bp-110h]@1
  FILE *stream; // [sp+10Ch] [bp-4h]@3

  sprintf(&str, "%s\\%s", dataPath, source);
  size = getFileSize(&str);
  if ( size == -1 )
  {
    result = 0;
  }
  else
  {
    stream = fopen(&str, "rb");
    if ( stream )
    {
      fread(scriptBuffer, 1u, size, stream);
      scriptBuffer[size] = 0;
      fclose(stream);
      strcpy(&textBuffer.path[256], source);
      decryptTSCScript(scriptBuffer, size);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (00421750) --------------------------------------------------------
signed int __cdecl loadTSCScript(char *name)
{
  signed int result; // eax@2
  char path[260]; // [sp+0h] [bp-118h]@1
  size_t headSize; // [sp+10Ch] [bp-Ch]@1
  FILE *stream; // [sp+110h] [bp-8h]@3
  size_t bodySize; // [sp+114h] [bp-4h]@5

  sprintf(path, "%s\\%s", dataPath, "Head.tsc");
  headSize = getFileSize(path);
  if ( headSize == -1 )
  {
    result = 0;
  }
  else
  {
    stream = fopen(path, "rb");
    if ( stream )
    {
      fread(scriptBuffer, 1u, headSize, stream);
      decryptTSCScript(scriptBuffer, headSize);
      scriptBuffer[headSize] = 0;
      fclose(stream);
      sprintf(path, "%s\\%s", dataPath, name);
      bodySize = getFileSize(path);
      if ( bodySize == -1 )
      {
        result = 0;
      }
      else
      {
        stream = fopen(path, "rb");
        if ( stream )
        {
          fread(&scriptBuffer[headSize], 1u, bodySize, stream);
          decryptTSCScript(&scriptBuffer[headSize], bodySize);
          *(&scriptBuffer[bodySize] + headSize) = 0;
          fclose(stream);
          size = bodySize + headSize;
          strcpy(&textBuffer.path[256], name);
          result = 1;
        }
        else
        {
          result = 0;
        }
      }
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (00421900) --------------------------------------------------------
// Getting 4 decimal digits from a TSC file and converting to hexadecimal number
int __cdecl Get_TSC_Number(int num)
{
  return 1000 * ((char)scriptBuffer[num] - 48)
       + 100 * ((char)scriptBuffer[num + 1] - 48)
       + 10 * ((char)scriptBuffer[num + 2] - 48)
       + (char)scriptBuffer[num + 3]
       - 48;
}

//----- (00421990) --------------------------------------------------------
signed int __cdecl Start_TSC_Event(int Event)
{
  int Event_Num; // [sp+0h] [bp-4h]@5

  byte_4A5ADC = 1;
  Game_Flags |= 5u;
  dword_4A5AE8[0] = 0;
  TextColumn = 0;
  dword_4A5AFC = 4;
  byte_4A5ADD = 0;
  byte_4A5B30 = 0;
  Face_Num = 0;
  dword_4A5B14 = 0;
  dword_4A5B2C = 0;
  Quote.Invincibility_Timer = 0;                // Resets the invincibility timer. You may want to remove this
  rcView.left = 52;
  rcView.top = 184;
  rcView.right = 268;
  rcView.bottom = 232;
  for ( Script_Pos = 0; ; ++Script_Pos )
  {
    if ( !scriptBuffer[Script_Pos] )
      return 0;
    if ( scriptBuffer[Script_Pos] != 35 )
      continue;
    Event_Num = Get_TSC_Number(++Script_Pos);
    if ( Event == Event_Num )
      break;
    if ( Event < Event_Num )
      return 0;
  }
  while ( scriptBuffer[Script_Pos] != 10 )
    ++Script_Pos;
  ++Script_Pos;
  return 1;
}
// 49E1E8: using guessed type int Game_Flags;
// 4A5ADC: using guessed type char byte_4A5ADC;
// 4A5ADD: using guessed type char byte_4A5ADD;
// 4A5AE4: using guessed type int TextColumn;
// 4A5AFC: using guessed type int dword_4A5AFC;
// 4A5B0C: using guessed type int Face_Num;
// 4A5B14: using guessed type int dword_4A5B14;
// 4A5B2C: using guessed type int dword_4A5B2C;
// 4A5B30: using guessed type char byte_4A5B30;

//----- (00421AF0) --------------------------------------------------------
signed int __cdecl Script_Jump(int Event_To_Jump_To)
{
  int Event_Num; // [sp+0h] [bp-8h]@8
  signed int i; // [sp+4h] [bp-4h]@1

  byte_4A5ADC = 1;
  Game_Flags |= 4u;
  dword_4A5AE8[0] = 0;
  TextColumn = 0;
  dword_4A5AFC = 4;
  byte_4A5B30 = 0;
  for ( i = 0; i < 4; ++i )
  {
    dword_4A5AEC[i] = 16 * i;
    Draw_Color_Fill_Onto_Surface(&unk_498290, 0, i + 30);
    memset((char *)&textBuffer + 64 * i, 0, 0x40u);
  }
  for ( Script_Pos = 0; ; ++Script_Pos )
  {
    if ( !scriptBuffer[Script_Pos] )
      return 0;
    if ( scriptBuffer[Script_Pos] != 35 )
      continue;
    Event_Num = Get_TSC_Number(++Script_Pos);
    if ( Event_To_Jump_To == Event_Num )
      break;
    if ( Event_To_Jump_To < Event_Num )
      return 0;
  }
  while ( scriptBuffer[Script_Pos] != 10 )
    ++Script_Pos;
  ++Script_Pos;
  return 1;
}
// 49E1E4: using guessed type int CursorPosition;
// 49E1E8: using guessed type int Game_Flags;
// 4A5ADC: using guessed type char byte_4A5ADC;
// 4A5AE4: using guessed type int TextColumn;
// 4A5AEC: using guessed type int dword_4A5AEC[];
// 4A5AFC: using guessed type int dword_4A5AFC;
// 4A5B30: using guessed type char byte_4A5B30;

//----- (00421C50) --------------------------------------------------------
void __cdecl Stop_Text_Script()
{
  byte_4A5ADC = 0;
  Game_Flags &= ~4u;
  Game_Flags |= 3u;
  byte_4A5ADD = 0;
}
// 49E1E4: using guessed type int CursorPosition;
// 49E1E8: using guessed type int Game_Flags;
// 4A5ADC: using guessed type char byte_4A5ADC;
// 4A5ADD: using guessed type char byte_4A5ADD;

//----- (00421C80) --------------------------------------------------------
void __cdecl CheckNewLine()
{
  if ( dword_4A5AEC[(signed __int32)dword_4A5AE8[0] % 4] == 48 )
  {
    byte_4A5ADC = 3;
    Game_Flags |= 4u;
    Draw_Color_Fill_Onto_Surface(&unk_498290, 0, (signed __int32)dword_4A5AE8[0] % 4 + 30);
    memset((char *)&textBuffer + 64 * ((signed __int32)dword_4A5AE8[0] % 4), 0, 0x40u);
  }
}
// 49E1E8: using guessed type int Game_Flags;
// 4A5ADC: using guessed type char byte_4A5ADC;
// 4A5AEC: using guessed type int dword_4A5AEC[];

//----- (00421D10) --------------------------------------------------------
void __cdecl Print_NUM(int index)
{
  char string[5]; // [sp+0h] [bp-2Ch]@5
  int bZero; // [sp+Ch] [bp-20h]@1
  int b; // [sp+10h] [bp-1Ch]@5
  int table[3]; // [sp+14h] [bp-18h]@1
  int offset; // [sp+20h] [bp-Ch]@1
  int i; // [sp+24h] [bp-8h]@1
  int a; // [sp+28h] [bp-4h]@1

  table[0] = 1000;
  table[1] = 100;
  table[2] = 10;
  a = NumberTextScript[index];
  bZero = 0;
  offset = 0;
  for ( i = 0; i < 3; ++i )
  {
    if ( a / table[i] || bZero )
    {
      b = a / table[i];
      string[offset] = b + 48;
      bZero = 1;
      a -= table[i] * b;
      ++offset;
    }
  }
  string[offset] = a + 48;
  string[offset + 1] = 0;
  Draw_String_Onto_Surface(6 * TextColumn, 0, string, 0xFEFFFFu, (signed __int32)dword_4A5AE8[0] % 4 + 30);
  strcat((char *)&textBuffer + 64 * ((signed __int32)dword_4A5AE8[0] % 4), string);
  Play_Sound_Effect(Sfx_Message_Typing, 1);
  byte_4A5B30 = 0;
  TextColumn += strlen(string);
  if ( TextColumn >= 35 )
  {
    TextColumn = 0;
    ++dword_4A5AE8[0];
    CheckNewLine();
  }
}
// 4A5AE4: using guessed type int TextColumn;
// 4A5B30: using guessed type char byte_4A5B30;

//----- (00421E90) --------------------------------------------------------
void __cdecl Clear_Text_Line()
{
  signed int i; // [sp+0h] [bp-4h]@1

  dword_4A5AE8[0] = 0;
  TextColumn = 0;
  dword_4A5B2C = 0;
  for ( i = 0; i < 4; ++i )
  {
    dword_4A5AEC[i] = 16 * i;
    Draw_Color_Fill_Onto_Surface(&unk_498290, 0, i + 30);
    memset((char *)&textBuffer + 64 * i, 0, 0x40u);
  }
}
// 4A5AE4: using guessed type int TextColumn;
// 4A5AEC: using guessed type int dword_4A5AEC[];
// 4A5B2C: using guessed type int dword_4A5B2C;

//----- (00421F10) --------------------------------------------------------
void Draw_Text_Box()
{
  int v0; // edx@19
  RECT v1; // [sp+0h] [bp-C8h]@7
  RECT rect; // [sp+10h] [bp-B8h]@7
  RECT v3; // [sp+20h] [bp-A8h]@7
  RECT v4; // [sp+30h] [bp-98h]@11
  RECT v5; // [sp+40h] [bp-88h]@22
  RECT v6; // [sp+50h] [bp-78h]@22
  RECT v7; // [sp+60h] [bp-68h]@22
  RECT v8; // [sp+70h] [bp-58h]@28
  RECT v9; // [sp+80h] [bp-48h]@22
  int YPos; // [sp+90h] [bp-38h]@7
  RECT v11; // [sp+94h] [bp-34h]@28
  RECT Ptr_Img_Rects; // [sp+A4h] [bp-24h]@21
  int v13; // [sp+B4h] [bp-14h]@14
  RECT v14; // [sp+B8h] [bp-10h]@22

  if ( byte_4A5ADC && byte_4A5ADD & 1 )
  {
    if ( byte_4A5ADD & 0x20 )
    {
      rcView.top = 32;
      rcView.bottom = 80;
    }
    else
    {
      rcView.top = 184;
      rcView.bottom = 232;
    }
    if ( byte_4A5ADD & 2 )
    {
      rect.left = 0;
      rect.top = 0;
      rect.right = 244;
      rect.bottom = 8;
      v3.left = 0;
      v3.top = 8;
      v3.right = 244;
      v3.bottom = 16;
      v1.left = 0;
      v1.top = 16;
      v1.right = 244;
      v1.bottom = 24;
      Draw_Bitmap_With_Transparency(&::rect, 38, rcView.top - 10, &rect, 26);
      for ( YPos = 1; YPos < 7; ++YPos )
        Draw_Bitmap_With_Transparency(&::rect, 38, rcView.top + 8 * YPos - 10, &v3, 26);
      Draw_Bitmap_With_Transparency(&::rect, 38, rcView.top + 8 * YPos - 10, &v1, 26);
    }
    v4.left = 48 * (Face_Num % 6);
    v4.top = 48 * (Face_Num / 6);
    v4.right = 48 * (Face_Num % 6) + 48;
    v4.bottom = 48 * (Face_Num / 6) + 48;
    if ( dword_4A5B10 < 26624 )
      dword_4A5B10 += 4096;
    Draw_Bitmap_With_Transparency(&rcView, dword_4A5B10 / 512, rcView.top - 3, &v4, 27);
    if ( Face_Num )
      v13 = 56;
    else
      v13 = 0;
    for ( YPos = 0; YPos < 4; ++YPos )
      Draw_Bitmap_With_Transparency(
        &rcView,
        v13 + 52,
        dword_4A5B2C + dword_4A5AEC[YPos] + rcView.top,
        &unk_498290,
        YPos + 30);
    v0 = (unsigned __int8)byte_4A5B30++ % 20;
    if ( v0 > 12 && byte_4A5ADC == 2 )
    {
      Ptr_Img_Rects.left = 6 * TextColumn + v13 + 52;
      Ptr_Img_Rects.top = dword_4A5B2C + rcView.top + dword_4A5AEC[(signed __int32)dword_4A5AE8[0] % 4];
      Ptr_Img_Rects.right = 6 * TextColumn + v13 + 57;
      Ptr_Img_Rects.bottom = Ptr_Img_Rects.top + 11;
      Draw_Color_Fill(&Ptr_Img_Rects, 16711679);
    }
    v14.left = 0;
    v14.top = 0;
    v14.right = 72;
    v14.bottom = 16;
    v9.left = 0;
    v9.top = 8;
    v9.right = 72;
    v9.bottom = 24;
    v5.left = 240;
    v5.top = 0;
    v5.right = 244;
    v5.bottom = 8;
    v7.left = 240;
    v7.top = 8;
    v7.right = 244;
    v7.bottom = 16;
    v6.left = 240;
    v6.top = 16;
    v6.right = 244;
    v6.bottom = 24;
    if ( dword_4A5B14 )
    {
      Draw_Bitmap_With_Transparency(&::rect, 120, 128, &v14, 26);
      Draw_Bitmap_With_Transparency(&::rect, 120, 144, &v9, 26);
      Draw_Bitmap_With_Transparency(&::rect, 192, 128, &v5, 26);
      Draw_Bitmap_With_Transparency(&::rect, 192, 136, &v7, 26);
      Draw_Bitmap_With_Transparency(&::rect, 192, 144, &v7, 26);
      Draw_Bitmap_With_Transparency(&::rect, 192, 152, &v6, 26);
      if ( ::YPos < 136 )
        ++::YPos;
      if ( dword_4A5B14 >= 1000 )
      {
        Ptr_Img_Rects.left = 32 * ((dword_4A5B14 - 1000) % 8);
        Ptr_Img_Rects.right = Ptr_Img_Rects.left + 32;
        Ptr_Img_Rects.top = 16 * ((dword_4A5B14 - 1000) / 8);
        Ptr_Img_Rects.bottom = 16 * ((dword_4A5B14 - 1000) / 8) + 16;
        Draw_Bitmap_With_Transparency(&::rect, 140, ::YPos, &Ptr_Img_Rects, 8);
      }
      else
      {
        Ptr_Img_Rects.left = 16 * (dword_4A5B14 % 16);
        Ptr_Img_Rects.right = Ptr_Img_Rects.left + 16;
        Ptr_Img_Rects.top = 16 * (dword_4A5B14 / 16);
        Ptr_Img_Rects.bottom = 16 * (dword_4A5B14 / 16) + 16;
        Draw_Bitmap_With_Transparency(&::rect, 148, ::YPos, &Ptr_Img_Rects, 12);
      }
    }
    v8.left = 152;
    v8.top = 48;
    v8.right = 244;
    v8.bottom = 80;
    v11.left = 112;
    v11.top = 88;
    v11.right = 128;
    v11.bottom = 104;
    if ( byte_4A5ADC == 6 )
    {
      if ( dword_4A5AFC >= 2 )
        YPos = 144;
      else
        YPos = 4 * (2 - dword_4A5AFC) + 144;
      Draw_Bitmap_With_Transparency(&::rect, 216, YPos, &v8, 26);
      if ( dword_4A5AFC == 16 )
        Draw_Bitmap_With_Transparency(&::rect, 41 * byte_4A5B08 + 211, 154, &v11, 26);
    }
  }
}
// 4A5ADC: using guessed type char byte_4A5ADC;
// 4A5ADD: using guessed type char byte_4A5ADD;
// 4A5AE4: using guessed type int TextColumn;
// 4A5AEC: using guessed type int dword_4A5AEC[];
// 4A5AFC: using guessed type int dword_4A5AFC;
// 4A5B08: using guessed type char byte_4A5B08;
// 4A5B0C: using guessed type int Face_Num;
// 4A5B10: using guessed type int dword_4A5B10;
// 4A5B14: using guessed type int dword_4A5B14;
// 4A5B2C: using guessed type int dword_4A5B2C;
// 4A5B30: using guessed type char byte_4A5B30;

//----- (00422510) --------------------------------------------------------
int TSC_Parser(void)
{
  int result; // eax@77
  int Scene_Down_Island_Ret; // [sp+0h] [bp-C8h]@421
  signed int Game_Loop_Map_Select_Returned; // [sp+4h] [bp-C4h]@308
  signed int Game_Loop_Map_Returned; // [sp+8h] [bp-C0h]@300
  const CHAR Text; // [sp+10h] [bp-B8h]@430
  char format[72]; // [sp+50h] [bp-78h]@443
  int bExit; // [sp+9Ch] [bp-2Ch]@6
  char source; // [sp+A0h] [bp-28h]@446
  unsigned __int8 v8; // [sp+A1h] [bp-27h]@447
  char v9; // [sp+A2h] [bp-26h]@447
  int TSC_Num; // [sp+A4h] [bp-24h]@20
  RECT RectSymbol; // [sp+A8h] [bp-20h]@1
  int i; // [sp+B8h] [bp-10h]@463
  signed int TSC_Num_3; // [sp+BCh] [bp-Ch]@16
  size_t TSC_Num_2; // [sp+C0h] [bp-8h]@56
  int NPC_ID; // [sp+C4h] [bp-4h]@44

  RectSymbol.left = 64;
  RectSymbol.top = 48;
  RectSymbol.right = 72;
  RectSymbol.bottom = 56;
  switch ( byte_4A5ADC )
  {
    case 1:
      ++dword_4A5AFC;
      if ( !(Game_Flags & 2) && Key_Held & (Key_Cancel | Key_Ok) )
        dword_4A5AFC += 4;
      if ( dword_4A5AFC < 4 )
        goto default;
      dword_4A5AFC = 0;
      bExit = 0;
      break;
    case 2:
      if ( Key_Pressed & (Key_Cancel | Key_Ok) )
        byte_4A5ADC = 1;
      goto default;
    case 3:
      for ( i = 0; i < 4; ++i )
      {
        dword_4A5AEC[i] -= 4;
        if ( !dword_4A5AEC[i] )
          byte_4A5ADC = 1;
        if ( dword_4A5AEC[i] == -16 )
          dword_4A5AEC[i] = 48;
      }
      goto default;
    case 4:
      if ( dword_4A5B00 != 9999 )
      {
        if ( dword_4A5AFC != 9999 )
          ++dword_4A5AFC;
        if ( dword_4A5AFC >= dword_4A5B00 )
        {
          byte_4A5ADC = 1;
          byte_4A5B30 = 0;
        }
      }
      goto default;
    case 5:
      if ( !Get_Fade_Mode() )
      {
        byte_4A5ADC = 1;
        byte_4A5B30 = 0;
      }
      goto default;
    case 7:
      if ( Quote.Collision_Flags & 8 )
      {
        byte_4A5ADC = 1;
        byte_4A5B30 = 0;
      }
      goto default;
    case 6:
      if ( dword_4A5AFC >= 16 )
      {
        if ( Key_Ok & Key_Pressed )
        {
          Play_Sound_Effect(Sfx_Y_N_Confirm, 1);
          if ( byte_4A5B08 == 1 )
          {
            Script_Jump(dword_4A5B04);
          }
          else
          {
            byte_4A5ADC = 1;
            byte_4A5B30 = 0;
          }
        }
        else if ( Key_Left & Key_Pressed )
        {
          byte_4A5B08 = 0;
          Play_Sound_Effect(Sfx_Y_N_Change_Choice, 1);
        }
        else if ( Key_Right & Key_Pressed )
        {
          byte_4A5B08 = 1;
          Play_Sound_Effect(Sfx_Y_N_Change_Choice, 1);
        }
      }
      else
      {
        ++dword_4A5AFC;
      }
      goto default;
    default:
default:
      if ( byte_4A5ADC )
        Game_Flags |= 4u;
      else
        Game_Flags &= 0xFFFFFFFB;
      return 1;
  }
  while ( 1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        while ( 1 )
        {
          while ( 1 )
          {
            while ( 1 )
            {
              while ( 1 )
              {
                while ( 1 )
                {
                  while ( 1 )
                  {
                    while ( 1 )
                    {
                      while ( 1 )
                      {
                        while ( 1 )
                        {
                          while ( 1 )
                          {
                            while ( 1 )
                            {
                              while ( 1 )
                              {
                                while ( 1 )
                                {
                                  while ( 1 )
                                  {
                                    while ( 1 )
                                    {
                                      while ( 1 )
                                      {
                                        while ( 1 )
                                        {
                                          while ( 1 )
                                          {
                                            while ( 1 )
                                            {
                                              while ( 1 )
                                              {
                                                while ( 1 )
                                                {
                                                  while ( 1 )
                                                  {
                                                    while ( 1 )
                                                    {
                                                      while ( 1 )
                                                      {
                                                        while ( 1 )
                                                        {
                                                          while ( 1 )
                                                          {
                                                            while ( 1 )
                                                            {
                                                              while ( 1 )
                                                              {
                                                                while ( 1 )
                                                                {
                                                                  while ( 1 )
                                                                  {
                                                                    while ( 1 )
                                                                    {
                                                                      while ( 1 )
                                                                      {
                                                                        while ( 1 )
                                                                        {
                                                                          while ( 1 )
                                                                          {
                                                                            while ( 1 )
                                                                            {
                                                                              while ( 1 )
                                                                              {
                                                                                while ( 1 )
                                                                                {
                                                                                  while ( 1 )
                                                                                  {
                                                                                    while ( 1 )
                                                                                    {
                                                                                      while ( 1 )
                                                                                      {
                                                                                        while ( 1 )
                                                                                        {
                                                                                          while ( 1 )
                                                                                          {
                                                                                            while ( 1 )
                                                                                            {
                                                                                              while ( 1 )
                                                                                              {
                                                                                                while ( 1 )
                                                                                                {
                                                                                                  while ( 1 )
                                                                                                  {
                                                                                                    while ( 1 )
                                                                                                    {
                                                                                                      while ( 1 )
                                                                                                      {
                                                                                                        while ( 1 )
                                                                                                        {
                                                                                                          while ( 1 )
                                                                                                          {
                                                                                                            while ( 1 )
                                                                                                            {
                                                                                                              while ( 1 )
                                                                                                              {
                                                                                                                while ( 1 )
                                                                                                                {
                                                                                                                  while ( 1 )
                                                                                                                  {
                                                                                                                    while ( 1 )
                                                                                                                    {
                                                                                                                      while ( 1 )
                                                                                                                      {
                                                                                                                        while ( 1 )
                                                                                                                        {
                                                                                                                          while ( 1 )
                                                                                                                          {
                                                                                                                            while ( 1 )
                                                                                                                            {
                                                                                                                              while ( 1 )
                                                                                                                              {
                                                                                                                                while ( 1 )
                                                                                                                                {
                                                                                                                                  while ( 1 )
                                                                                                                                  {
                                                                                                                                    while ( 1 )
                                                                                                                                    {
                                                                                                                                      while ( 1 )
                                                                                                                                      {
                                                                                                                                        while ( 1 )
                                                                                                                                        {
                                                                                                                                          while ( 1 )
                                                                                                                                          {
                                                                                                                                            while ( 1 )
                                                                                                                                            {
                                                                                                                                              while ( 1 )
                                                                                                                                              {
                                                                                                                                                while ( 1 )
                                                                                                                                                {
                                                                                                                                                  while ( 1 )
                                                                                                                                                  {
                                                                                                                                                    while ( 1 )
                                                                                                                                                    {
                                                                                                                                                      while ( 1 )
                                                                                                                                                      {
                                                                                                                                                        while ( 1 )
                                                                                                                                                        {
                                                                                                                                                          while ( 1 )
                                                                                                                                                          {
                                                                                                                                                            while ( 1 )
                                                                                                                                                            {
                                                                                                                                                              while ( 1 )
                                                                                                                                                              {
                                                                                                                                                                while ( 1 )
                                                                                                                                                                {
                                                                                                                                                                  while ( 1 )
                                                                                                                                                                  {
                                                                                                                                                                    while ( 1 )
                                                                                                                                                                    {
                                                                                                                                                                      while ( 1 )
                                                                                                                                                                      {
                                                                                                                                                                        while ( 1 )
                                                                                                                                                                        {
                                                                                                                                                                          while ( 1 )
                                                                                                                                                                          {
                                                                                                                                                                            while ( 1 )
                                                                                                                                                                            {
                                                                                                                                                                              while ( 1 )
                                                                                                                                                                              {
                                                                                                                                                                                while ( 1 )
                                                                                                                                                                                {
                                                                                                                                                                                  while ( 1 )
                                                                                                                                                                                  {
                                                                                                                                                                                    while ( 1 )
                                                                                                                                                                                    {
                                                                                                                                                                                      while ( 1 )
                                                                                                                                                                                      {
                                                                                                                                                                                        while ( 1 )
                                                                                                                                                                                        {
                                                                                                                                                                                          if ( bExit )
                                                                                                                                                                                            goto default;
                                                                                                                                                                                          if ( scriptBuffer[Script_Pos] == '<' )
                                                                                                                                                                                            break;
                                                                                                                                                                                          if ( scriptBuffer[Script_Pos] == '\r' )
                                                                                                                                                                                          {
                                                                                                                                                                                            Script_Pos += 2;
                                                                                                                                                                                            TextColumn = 0;
                                                                                                                                                                                            if ( byte_4A5ADD & 1 )
                                                                                                                                                                                            {
                                                                                                                                                                                              ++dword_4A5AE8[0];
                                                                                                                                                                                              CheckNewLine();
                                                                                                                                                                                            }
                                                                                                                                                                                          }
                                                                                                                                                                                          else if ( byte_4A5ADD & 0x10 )
                                                                                                                                                                                          {
                                                                                                                                                                                            for ( TSC_Num_3 = Script_Pos;
                                                                                                                                                                                                  scriptBuffer[TSC_Num_3] != 60 && scriptBuffer[TSC_Num_3] != '\r';
                                                                                                                                                                                                  ++TSC_Num_3 )
                                                                                                                                                                                            {
                                                                                                                                                                                              if ( scriptBuffer[TSC_Num_3] & 0x80 )
                                                                                                                                                                                                ++TSC_Num_3;
                                                                                                                                                                                            }
                                                                                                                                                                                            TSC_Num_2 = TSC_Num_3 - Script_Pos;
                                                                                                                                                                                            memcpy(format, &scriptBuffer[Script_Pos], TSC_Num_3 - Script_Pos);
                                                                                                                                                                                            format[TSC_Num_2] = 0;
                                                                                                                                                                                            TextColumn = TSC_Num_3;
                                                                                                                                                                                            Draw_String_Onto_Surface(0, 0, format, 0xFEFFFFu, (signed __int32)dword_4A5AE8[0] % 4 + 30);
                                                                                                                                                                                            sprintf((char *)&textBuffer + 64 * ((signed __int32)dword_4A5AE8[0] % 4), format);
                                                                                                                                                                                            Script_Pos += TSC_Num_2;
                                                                                                                                                                                            if ( TextColumn >= 35 )
                                                                                                                                                                                              CheckNewLine();
                                                                                                                                                                                            bExit = 1;
                                                                                                                                                                                          }
                                                                                                                                                                                          else
                                                                                                                                                                                          {
                                                                                                                                                                                            source = scriptBuffer[Script_Pos];
                                                                                                                                                                                            if ( source & 0x80 )
                                                                                                                                                                                            {
                                                                                                                                                                                              v8 = scriptBuffer[Script_Pos + 1];
                                                                                                                                                                                              v9 = 0;
                                                                                                                                                                                            }
                                                                                                                                                                                            else
                                                                                                                                                                                            {
                                                                                                                                                                                              v8 = 0;
                                                                                                                                                                                            }
                                                                                                                                                                                            if ( source == 61 )
                                                                                                                                                                                              Draw_Sprite_Onto_Surface(6 * TextColumn, 2, &RectSymbol, (signed __int32)dword_4A5AE8[0] % 4 + 30, 26);
                                                                                                                                                                                            else
                                                                                                                                                                                              Draw_String_Onto_Surface(6 * TextColumn, 0, &source, 0xFEFFFFu, (signed __int32)dword_4A5AE8[0] % 4 + 30);
                                                                                                                                                                                            strcat((char *)&textBuffer + 64 * ((signed __int32)dword_4A5AE8[0] % 4), &source);
                                                                                                                                                                                            Play_Sound_Effect(Sfx_Message_Typing, 1);
                                                                                                                                                                                            byte_4A5B30 = 0;
                                                                                                                                                                                            if ( source & 0x80 )
                                                                                                                                                                                            {
                                                                                                                                                                                              Script_Pos += 2;
                                                                                                                                                                                              TextColumn += 2;
                                                                                                                                                                                            }
                                                                                                                                                                                            else
                                                                                                                                                                                            {
                                                                                                                                                                                              ++Script_Pos;
                                                                                                                                                                                              ++TextColumn;
                                                                                                                                                                                            }
                                                                                                                                                                                            if ( TextColumn >= 35 )
                                                                                                                                                                                            {
                                                                                                                                                                                              CheckNewLine();
                                                                                                                                                                                              TextColumn = 0;
                                                                                                                                                                                              ++dword_4A5AE8[0];
                                                                                                                                                                                              CheckNewLine();
                                                                                                                                                                                            }
                                                                                                                                                                                            bExit = 1;
                                                                                                                                                                                          }
                                                                                                                                                                                        }
                                                                                                                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'E' || scriptBuffer[Script_Pos + 2] != 'N' || scriptBuffer[Script_Pos + 3] != 'D' )
                                                                                                                                                                                          break;
                                                                                                                                                                                        byte_4A5ADC = 0;
                                                                                                                                                                                        Quote.Flags &= 0xFEu;
                                                                                                                                                                                        Game_Flags |= 3u;
                                                                                                                                                                                        Face_Num = 0;
                                                                                                                                                                                        bExit = 1;
                                                                                                                                                                                      }
                                                                                                                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'L' || scriptBuffer[Script_Pos + 2] != 'I' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                                        break;
                                                                                                                                                                                      TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                                      Add_Life_Player(TSC_Num_3);
                                                                                                                                                                                      Script_Pos += 8;
                                                                                                                                                                                    }
                                                                                                                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'M' || scriptBuffer[Script_Pos + 2] != 'L' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                                      break;
                                                                                                                                                                                    TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                                    Add_Max_Life_Player(TSC_Num);
                                                                                                                                                                                    Script_Pos += 8;
                                                                                                                                                                                  }
                                                                                                                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'A' || scriptBuffer[Script_Pos + 2] != 'E' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                                    break;
                                                                                                                                                                                  Fill_Weapon_Ammo();
                                                                                                                                                                                  Script_Pos += 4;
                                                                                                                                                                                }
                                                                                                                                                                                if ( scriptBuffer[Script_Pos + 1] != 'I' || scriptBuffer[Script_Pos + 2] != 'T' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                                  break;
                                                                                                                                                                                TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                                Play_Sound_Effect(Sfx_Item_Get, 1);
                                                                                                                                                                                Add_Item_Data(TSC_Num_3);
                                                                                                                                                                                Script_Pos += 8;
                                                                                                                                                                              }
                                                                                                                                                                              if ( scriptBuffer[Script_Pos + 1] != 'I' || scriptBuffer[Script_Pos + 2] != 'T' || scriptBuffer[Script_Pos + 3] != '-' )
                                                                                                                                                                                break;
                                                                                                                                                                              TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                              Sub_Item_Data(TSC_Num);
                                                                                                                                                                              Script_Pos += 8;
                                                                                                                                                                            }
                                                                                                                                                                            if ( scriptBuffer[Script_Pos + 1] != 'E' || scriptBuffer[Script_Pos + 2] != 'Q' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                              break;
                                                                                                                                                                            TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                            Equip_Item(TSC_Num, 1);
                                                                                                                                                                            Script_Pos += 8;
                                                                                                                                                                          }
                                                                                                                                                                          if ( scriptBuffer[Script_Pos + 1] != 'E' || scriptBuffer[Script_Pos + 2] != 'Q' || scriptBuffer[Script_Pos + 3] != '-' )
                                                                                                                                                                            break;
                                                                                                                                                                          TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                          Equip_Item(TSC_Num, 0);
                                                                                                                                                                          Script_Pos += 8;
                                                                                                                                                                        }
                                                                                                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'A' || scriptBuffer[Script_Pos + 2] != 'M' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                          break;
                                                                                                                                                                        NPC_ID = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                        TSC_Num_3 = Get_TSC_Number(Script_Pos + 9);
                                                                                                                                                                        NumberTextScript[0] = TSC_Num_3;
                                                                                                                                                                        NumberTextScript[1] = TSC_Num;
                                                                                                                                                                        Play_Sound_Effect(Sfx_Item_Get, 1);
                                                                                                                                                                        Add_Weapon(NPC_ID, TSC_Num_3);
                                                                                                                                                                        Script_Pos += 13;
                                                                                                                                                                      }
                                                                                                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'A' || scriptBuffer[Script_Pos + 2] != 'M' || scriptBuffer[Script_Pos + 3] != '-' )
                                                                                                                                                                        break;
                                                                                                                                                                      TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                      Lose_Weapon(TSC_Num);
                                                                                                                                                                      Script_Pos += 8;
                                                                                                                                                                    }
                                                                                                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'Z' || scriptBuffer[Script_Pos + 2] != 'A' || scriptBuffer[Script_Pos + 3] != 'M' )
                                                                                                                                                                      break;
                                                                                                                                                                    Reset_All_Weapons_EXP();
                                                                                                                                                                    Script_Pos += 4;
                                                                                                                                                                  }
                                                                                                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'T' || scriptBuffer[Script_Pos + 2] != 'A' || scriptBuffer[Script_Pos + 3] != 'M' )
                                                                                                                                                                    break;
                                                                                                                                                                  TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                  TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                                                                                                                                                  TSC_Num = Get_TSC_Number(Script_Pos + 14);
                                                                                                                                                                  Trade_Weapon(TSC_Num_3, TSC_Num_2, TSC_Num);
                                                                                                                                                                  Script_Pos += 18;
                                                                                                                                                                }
                                                                                                                                                                if ( scriptBuffer[Script_Pos + 1] != 'P' || scriptBuffer[Script_Pos + 2] != 'S' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                  break;
                                                                                                                                                                TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                                TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                                                                                                                                                Add_Permit_Stage(TSC_Num_3, TSC_Num_2);
                                                                                                                                                                Script_Pos += 13;
                                                                                                                                                              }
                                                                                                                                                              if ( scriptBuffer[Script_Pos + 1] != 'M' || scriptBuffer[Script_Pos + 2] != 'P' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                                break;
                                                                                                                                                              TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                              Set_Map_Flag(TSC_Num_3);
                                                                                                                                                              Script_Pos += 8;
                                                                                                                                                            }
                                                                                                                                                            if ( scriptBuffer[Script_Pos + 1] != 'U' || scriptBuffer[Script_Pos + 2] != 'N' || scriptBuffer[Script_Pos + 3] != 'I' )
                                                                                                                                                              break;
                                                                                                                                                            TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                            Change_Unit(TSC_Num);
                                                                                                                                                            Script_Pos += 8;
                                                                                                                                                          }
                                                                                                                                                          if ( scriptBuffer[Script_Pos + 1] != 'S' || scriptBuffer[Script_Pos + 2] != 'T' || scriptBuffer[Script_Pos + 3] != 'C' )
                                                                                                                                                            break;
                                                                                                                                                          Save_Hell_Counter();
                                                                                                                                                          Script_Pos += 4;
                                                                                                                                                        }
                                                                                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'T' || scriptBuffer[Script_Pos + 2] != 'R' || scriptBuffer[Script_Pos + 3] != 'A' )
                                                                                                                                                          break;
                                                                                                                                                        TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                        NPC_ID = Get_TSC_Number(Script_Pos + 9);
                                                                                                                                                        TSC_Num_3 = Get_TSC_Number(Script_Pos + 14);
                                                                                                                                                        TSC_Num_2 = Get_TSC_Number(Script_Pos + 19);
                                                                                                                                                        if ( !Transfer_Stage(TSC_Num, NPC_ID, TSC_Num_3, TSC_Num_2) )
                                                                                                                                                        {
                                                                                                                                                          MessageBoxA(AppWinHandle, "Xe[Ws", "G[", 0);
                                                                                                                                                          return 0;
                                                                                                                                                        }
                                                                                                                                                      }
                                                                                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'M' || scriptBuffer[Script_Pos + 2] != 'O' || scriptBuffer[Script_Pos + 3] != 'V' )
                                                                                                                                                        break;
                                                                                                                                                      TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                      TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                                                                                                                                      Set_Quote_Position(TSC_Num_3 << 13, TSC_Num_2 << 13);
                                                                                                                                                      Script_Pos += 13;
                                                                                                                                                    }
                                                                                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'H' || scriptBuffer[Script_Pos + 2] != 'M' || scriptBuffer[Script_Pos + 3] != 'C' )
                                                                                                                                                      break;
                                                                                                                                                    Show_Hide_Player(0);
                                                                                                                                                    Script_Pos += 4;
                                                                                                                                                  }
                                                                                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'S' || scriptBuffer[Script_Pos + 2] != 'M' || scriptBuffer[Script_Pos + 3] != 'C' )
                                                                                                                                                    break;
                                                                                                                                                  Show_Hide_Player(1);
                                                                                                                                                  Script_Pos += 4;
                                                                                                                                                }
                                                                                                                                                if ( scriptBuffer[Script_Pos + 1] != 'F' || scriptBuffer[Script_Pos + 2] != 'L' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                                  break;
                                                                                                                                                TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                                Set_NPC_Flag(TSC_Num);
                                                                                                                                                Script_Pos += 8;
                                                                                                                                              }
                                                                                                                                              if ( scriptBuffer[Script_Pos + 1] != 'F' || scriptBuffer[Script_Pos + 2] != 'L' || scriptBuffer[Script_Pos + 3] != '-' )
                                                                                                                                                break;
                                                                                                                                              TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                              Unset_NPC_Flag(TSC_Num);
                                                                                                                                              Script_Pos += 8;
                                                                                                                                            }
                                                                                                                                            if ( scriptBuffer[Script_Pos + 1] != 'S' || scriptBuffer[Script_Pos + 2] != 'K' || scriptBuffer[Script_Pos + 3] != '+' )
                                                                                                                                              break;
                                                                                                                                            TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                            Set_Skip_Flag(TSC_Num);
                                                                                                                                            Script_Pos += 8;
                                                                                                                                          }
                                                                                                                                          if ( scriptBuffer[Script_Pos + 1] != 'S' || scriptBuffer[Script_Pos + 2] != 'K' || scriptBuffer[Script_Pos + 3] != '-' )
                                                                                                                                            break;
                                                                                                                                          TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                                                          Unset_Skip_Flag(TSC_Num);
                                                                                                                                          Script_Pos += 8;
                                                                                                                                        }
                                                                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'K' || scriptBuffer[Script_Pos + 2] != 'E' || scriptBuffer[Script_Pos + 3] != 'Y' )
                                                                                                                                          break;
                                                                                                                                        Game_Flags &= ~2u;
                                                                                                                                        Game_Flags |= 1u;
                                                                                                                                        Quote.Is_Facing_Up = 0;
                                                                                                                                        Quote.Invincibility_Timer = 0;
                                                                                                                                        Script_Pos += 4;
                                                                                                                                      }
                                                                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'P' || scriptBuffer[Script_Pos + 2] != 'R' || scriptBuffer[Script_Pos + 3] != 'I' )
                                                                                                                                        break;
                                                                                                                                      Game_Flags &= ~3u;
                                                                                                                                      Quote.Invincibility_Timer = 0;
                                                                                                                                      Script_Pos += 4;
                                                                                                                                    }
                                                                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'F' || scriptBuffer[Script_Pos + 2] != 'R' || scriptBuffer[Script_Pos + 3] != 'E' )
                                                                                                                                      break;
                                                                                                                                    Game_Flags |= 3u;
                                                                                                                                    Script_Pos += 4;
                                                                                                                                  }
                                                                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'N' || scriptBuffer[Script_Pos + 2] != 'O' || scriptBuffer[Script_Pos + 3] != 'D' )
                                                                                                                                    break;
                                                                                                                                  byte_4A5ADC = 2;
                                                                                                                                  Script_Pos += 4;
                                                                                                                                  bExit = 1;
                                                                                                                                }
                                                                                                                                if ( scriptBuffer[Script_Pos + 1] != 'C' || scriptBuffer[Script_Pos + 2] != 'L' || scriptBuffer[Script_Pos + 3] != 'R' )
                                                                                                                                  break;
                                                                                                                                Clear_Text_Line();
                                                                                                                                Script_Pos += 4;
                                                                                                                              }
                                                                                                                              if ( scriptBuffer[Script_Pos + 1] != 'M' || scriptBuffer[Script_Pos + 2] != 'S' || scriptBuffer[Script_Pos + 3] != 'G' )
                                                                                                                                break;
                                                                                                                              Clear_Text_Line();
                                                                                                                              byte_4A5ADD |= 3u;
                                                                                                                              byte_4A5ADD &= ~0x30u;
                                                                                                                              if ( byte_4A5ADD & 0x40 )
                                                                                                                                byte_4A5ADD |= 0x10u;
                                                                                                                              Script_Pos += 4;
                                                                                                                              bExit = 1;
                                                                                                                            }
                                                                                                                            if ( scriptBuffer[Script_Pos + 1] != 'M' || scriptBuffer[Script_Pos + 2] != 'S' || scriptBuffer[Script_Pos + 3] != '2' )
                                                                                                                              break;
                                                                                                                            Clear_Text_Line();
                                                                                                                            byte_4A5ADD &= 0xEDu;
                                                                                                                            byte_4A5ADD |= 0x21u;
                                                                                                                            if ( byte_4A5ADD & 0x40 )
                                                                                                                              byte_4A5ADD |= 0x10u;
                                                                                                                            Face_Num = 0;
                                                                                                                            Script_Pos += 4;
                                                                                                                            bExit = 1;
                                                                                                                          }
                                                                                                                          if ( scriptBuffer[Script_Pos + 1] != 'M' || scriptBuffer[Script_Pos + 2] != 'S' || scriptBuffer[Script_Pos + 3] != '3' )
                                                                                                                            break;
                                                                                                                          Clear_Text_Line();
                                                                                                                          byte_4A5ADD &= 0xEFu;
                                                                                                                          byte_4A5ADD |= 0x23u;
                                                                                                                          if ( byte_4A5ADD & 0x40 )
                                                                                                                            byte_4A5ADD |= 0x10u;
                                                                                                                          Script_Pos += 4;
                                                                                                                          bExit = 1;
                                                                                                                        }
                                                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'W' || scriptBuffer[Script_Pos + 2] != 'A' || scriptBuffer[Script_Pos + 3] != 'I' )
                                                                                                                          break;
                                                                                                                        byte_4A5ADC = 4;
                                                                                                                        dword_4A5B00 = Get_TSC_Number(Script_Pos + 4);
                                                                                                                        Script_Pos += 8;
                                                                                                                        bExit = 1;
                                                                                                                      }
                                                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'W' || scriptBuffer[Script_Pos + 2] != 'A' || scriptBuffer[Script_Pos + 3] != 83 )
                                                                                                                        break;
                                                                                                                      byte_4A5ADC = 7;
                                                                                                                      Script_Pos += 4;
                                                                                                                      bExit = 1;
                                                                                                                    }
                                                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'T' || scriptBuffer[Script_Pos + 2] != 'U' || scriptBuffer[Script_Pos + 3] != 'R' )
                                                                                                                      break;
                                                                                                                    Script_Pos += 4;
                                                                                                                    byte_4A5ADD |= 0x10u;
                                                                                                                  }
                                                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'S' || scriptBuffer[Script_Pos + 2] != 'A' || scriptBuffer[Script_Pos + 3] != 'T' )
                                                                                                                    break;
                                                                                                                  Script_Pos += 4;
                                                                                                                  byte_4A5ADD |= 0x40u;
                                                                                                                }
                                                                                                                if ( scriptBuffer[Script_Pos + 1] != 'C' || scriptBuffer[Script_Pos + 2] != 'A' || scriptBuffer[Script_Pos + 3] != 'T' )
                                                                                                                  break;
                                                                                                                Script_Pos += 4;
                                                                                                                byte_4A5ADD |= 0x40u;
                                                                                                              }
                                                                                                              if ( scriptBuffer[Script_Pos + 1] != 'C' || scriptBuffer[Script_Pos + 2] != 'L' || scriptBuffer[Script_Pos + 3] != 'O' )
                                                                                                                break;
                                                                                                              byte_4A5ADD &= 0xCCu;
                                                                                                              Script_Pos += 4;
                                                                                                            }
                                                                                                            if ( scriptBuffer[Script_Pos + 1] != 'E' || scriptBuffer[Script_Pos + 2] != 'V' || scriptBuffer[Script_Pos + 3] != 'E' )
                                                                                                              break;
                                                                                                            TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                                            Script_Jump(TSC_Num);
                                                                                                          }
                                                                                                          if ( scriptBuffer[Script_Pos + 1] != 'Y' || scriptBuffer[Script_Pos + 2] != 'N' || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                                            break;
                                                                                                          dword_4A5B04 = Get_TSC_Number(Script_Pos + 4);
                                                                                                          Script_Pos += 8;
                                                                                                          byte_4A5ADC = 6;
                                                                                                          Play_Sound_Effect(Sfx_Y_N_Prompt, 1);
                                                                                                          dword_4A5AFC = 0;
                                                                                                          byte_4A5B08 = 0;
                                                                                                          bExit = 1;
                                                                                                        }
                                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'F' || scriptBuffer[Script_Pos + 2] != 'L' || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                                          break;
                                                                                                        TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                        TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                                        if ( Get_NPC_Flag(TSC_Num_3) )
                                                                                                          Script_Jump(TSC_Num);
                                                                                                        else
                                                                                                          Script_Pos += 13;
                                                                                                      }
                                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'S' || scriptBuffer[Script_Pos + 2] != 'K' || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                                        break;
                                                                                                      TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                      TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                                      if ( Get_SkipFlag(TSC_Num_3) )
                                                                                                        Script_Jump(TSC_Num);
                                                                                                      else
                                                                                                        Script_Pos += 13;
                                                                                                    }
                                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'I' || scriptBuffer[Script_Pos + 2] != 'T' || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                                      break;
                                                                                                    TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                    TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                                    if ( Check_For_Item(TSC_Num_3) )
                                                                                                      Script_Jump(TSC_Num);
                                                                                                    else
                                                                                                      Script_Pos += 13;
                                                                                                  }
                                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'A' || scriptBuffer[Script_Pos + 2] != 'M' || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                                    break;
                                                                                                  TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                  TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                                  if ( Check_For_Weapon(TSC_Num_3) )
                                                                                                    Script_Jump(TSC_Num);
                                                                                                  else
                                                                                                    Script_Pos += 13;
                                                                                                }
                                                                                                if ( scriptBuffer[Script_Pos + 1] != 'U' || scriptBuffer[Script_Pos + 2] != 'N' || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                                  break;
                                                                                                TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                                TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                                if ( Tsc_UNJ() == TSC_Num_3 )
                                                                                                  Script_Jump(TSC_Num);
                                                                                                else
                                                                                                  Script_Pos += 13;
                                                                                              }
                                                                                              if ( scriptBuffer[Script_Pos + 1] != 'E'
                                                                                                || scriptBuffer[Script_Pos + 2] != 'C'
                                                                                                || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                              {
                                                                                                break;
                                                                                              }
                                                                                              TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                              TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                              if ( Check_NPC_alive(TSC_Num_3) )
                                                                                                Script_Jump(TSC_Num);
                                                                                              else
                                                                                                Script_Pos += 13;
                                                                                            }
                                                                                            if ( scriptBuffer[Script_Pos + 1] != 'N'
                                                                                              || scriptBuffer[Script_Pos + 2] != 'C'
                                                                                              || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                            {
                                                                                              break;
                                                                                            }
                                                                                            TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                            TSC_Num = Get_TSC_Number(Script_Pos + 9);
                                                                                            if ( Is_NPC_code(TSC_Num_3) )
                                                                                              Script_Jump(TSC_Num);
                                                                                            else
                                                                                              Script_Pos += 13;
                                                                                          }
                                                                                          if ( scriptBuffer[Script_Pos + 1] != 'M'
                                                                                            || scriptBuffer[Script_Pos + 2] != 'P'
                                                                                            || scriptBuffer[Script_Pos + 3] != 'J' )
                                                                                          {
                                                                                            break;
                                                                                          }
                                                                                          TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                          if ( Check_Map_Flag() )
                                                                                            Script_Jump(TSC_Num_3);
                                                                                          else
                                                                                            Script_Pos += 8;
                                                                                        }
                                                                                        if ( scriptBuffer[Script_Pos + 1] != 'S'
                                                                                          || scriptBuffer[Script_Pos + 2] != 'S'
                                                                                          || scriptBuffer[Script_Pos + 3] != 'S' )
                                                                                        {
                                                                                          break;
                                                                                        }
                                                                                        TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                                        Set_Noise(1, TSC_Num_3);
                                                                                        Script_Pos += 8;
                                                                                      }
                                                                                      if ( scriptBuffer[Script_Pos + 1] != 'C'
                                                                                        || scriptBuffer[Script_Pos + 2] != 'S'
                                                                                        || scriptBuffer[Script_Pos + 3] != 'S' )
                                                                                      {
                                                                                        break;
                                                                                      }
                                                                                      Cut_Noise();
                                                                                      Script_Pos += 4;
                                                                                    }
                                                                                    if ( scriptBuffer[Script_Pos + 1] != 'S'
                                                                                      || scriptBuffer[Script_Pos + 2] != 'P'
                                                                                      || scriptBuffer[Script_Pos + 3] != 'S' )
                                                                                    {
                                                                                      break;
                                                                                    }
                                                                                    Set_Noise(2, TSC_Num_3);
                                                                                    Script_Pos += 4;
                                                                                  }
                                                                                  if ( scriptBuffer[Script_Pos + 1] != 'C'
                                                                                    || scriptBuffer[Script_Pos + 2] != 'P'
                                                                                    || scriptBuffer[Script_Pos + 3] != 'S' )
                                                                                  {
                                                                                    break;
                                                                                  }
                                                                                  Cut_Noise();
                                                                                  Script_Pos += 4;
                                                                                }
                                                                                if ( scriptBuffer[Script_Pos + 1] != 'Q'
                                                                                  || scriptBuffer[Script_Pos + 2] != 'U'
                                                                                  || scriptBuffer[Script_Pos + 3] != 'A' )
                                                                                {
                                                                                  break;
                                                                                }
                                                                                TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                                Set_Quake(TSC_Num);
                                                                                Script_Pos += 8;
                                                                              }
                                                                              if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                                                || scriptBuffer[Script_Pos + 2] != 'L'
                                                                                || scriptBuffer[Script_Pos + 3] != 'A' )
                                                                              {
                                                                                break;
                                                                              }
                                                                              Start_Flash(0, 0, 2);
                                                                              Script_Pos += 4;
                                                                            }
                                                                            if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                                              || scriptBuffer[Script_Pos + 2] != 'A'
                                                                              || scriptBuffer[Script_Pos + 3] != 'I' )
                                                                            {
                                                                              break;
                                                                            }
                                                                            TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                            Start_Fade_In(TSC_Num);
                                                                            byte_4A5ADC = 5;
                                                                            Script_Pos += 8;
                                                                            bExit = 1;
                                                                          }
                                                                          if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                                            || scriptBuffer[Script_Pos + 2] != 'A'
                                                                            || scriptBuffer[Script_Pos + 3] != 'O' )
                                                                          {
                                                                            break;
                                                                          }
                                                                          TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                          Start_Fade_Out(TSC_Num);
                                                                          byte_4A5ADC = 5;
                                                                          Script_Pos += 8;
                                                                          bExit = 1;
                                                                        }
                                                                        if ( scriptBuffer[Script_Pos + 1] != 'M'
                                                                          || scriptBuffer[Script_Pos + 2] != 'N'
                                                                          || scriptBuffer[Script_Pos + 3] != 'A' )
                                                                        {
                                                                          break;
                                                                        }
                                                                        Start_Map_Name();
                                                                        Script_Pos += 4;
                                                                      }
                                                                      if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                                        || scriptBuffer[Script_Pos + 2] != 'O'
                                                                        || scriptBuffer[Script_Pos + 3] != 'M' )
                                                                      {
                                                                        break;
                                                                      }
                                                                      TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                      Set_Camera_Target_Quote(TSC_Num);
                                                                      Script_Pos += 8;
                                                                    }
                                                                    if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                                      || scriptBuffer[Script_Pos + 2] != 'O'
                                                                      || scriptBuffer[Script_Pos + 3] != 'N' )
                                                                    {
                                                                      break;
                                                                    }
                                                                    TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                    TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                                                    Set_Camera_Move_Ticks(TSC_Num_3, TSC_Num_2);
                                                                    Script_Pos += 13;
                                                                  }
                                                                  if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                                    || scriptBuffer[Script_Pos + 2] != 'O'
                                                                    || scriptBuffer[Script_Pos + 3] != 'B' )
                                                                  {
                                                                    break;
                                                                  }
                                                                  TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                                                  TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                                                  TSC_FOB(TSC_Num_3, TSC_Num_2);
                                                                  Script_Pos += 13;
                                                                }
                                                                if ( scriptBuffer[Script_Pos + 1] != 'S'
                                                                  || scriptBuffer[Script_Pos + 2] != 'O'
                                                                  || scriptBuffer[Script_Pos + 3] != 'U' )
                                                                {
                                                                  break;
                                                                }
                                                                TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                                Play_Sound_Effect((Sound_Effects_enum)TSC_Num, 1);
                                                                Script_Pos += 8;
                                                              }
                                                              if ( scriptBuffer[Script_Pos + 1] != 'C'
                                                                || scriptBuffer[Script_Pos + 2] != 'M'
                                                                || scriptBuffer[Script_Pos + 3] != 'U' )
                                                              {
                                                                break;
                                                              }
                                                              TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                              Change_Music((Music_enum)TSC_Num);
                                                              Script_Pos += 8;
                                                            }
                                                            if ( scriptBuffer[Script_Pos + 1] != 'F'
                                                              || scriptBuffer[Script_Pos + 2] != 'M'
                                                              || scriptBuffer[Script_Pos + 3] != 'U' )
                                                            {
                                                              break;
                                                            }
                                                            Fade_Music();
                                                            Script_Pos += 4;
                                                          }
                                                          if ( scriptBuffer[Script_Pos + 1] != 'R'
                                                            || scriptBuffer[Script_Pos + 2] != 'M'
                                                            || scriptBuffer[Script_Pos + 3] != 'U' )
                                                          {
                                                            break;
                                                          }
                                                          ReCall_Music();
                                                          Script_Pos += 4;
                                                        }
                                                        if ( scriptBuffer[Script_Pos + 1] != 'M'
                                                          || scriptBuffer[Script_Pos + 2] != 'L'
                                                          || scriptBuffer[Script_Pos + 3] != 'P' )
                                                        {
                                                          break;
                                                        }
                                                        Script_Pos += 4;
                                                        bExit = 1;
                                                        Game_Loop_Map_Returned = Game_Loop_Map();
                                                        if ( !Game_Loop_Map_Returned )
                                                          return 0;
                                                        if ( Game_Loop_Map_Returned == 2 )
                                                          return 2;
                                                      }
                                                      if ( scriptBuffer[Script_Pos + 1] != 'S'
                                                        || scriptBuffer[Script_Pos + 2] != 'L'
                                                        || scriptBuffer[Script_Pos + 3] != 'P' )
                                                      {
                                                        break;
                                                      }
                                                      bExit = 1;
                                                      Game_Loop_Map_Select_Returned = Game_Loop_Stage_Select(&TSC_Num);
                                                      if ( !Game_Loop_Map_Select_Returned )
                                                        return 0;
                                                      if ( Game_Loop_Map_Select_Returned == 2 )
                                                        return 2;
                                                      Script_Jump(TSC_Num);
                                                      Game_Flags &= 0xFFFFFFFC;
                                                    }
                                                    if ( scriptBuffer[Script_Pos + 1] != 'D'
                                                      || scriptBuffer[Script_Pos + 2] != 'N'
                                                      || scriptBuffer[Script_Pos + 3] != 'P' )
                                                    {
                                                      break;
                                                    }
                                                    TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                    Delete_NPC_Event(TSC_Num);
                                                    Script_Pos += 8;
                                                  }
                                                  if ( scriptBuffer[Script_Pos + 1] != 'D'
                                                    || scriptBuffer[Script_Pos + 2] != 'N'
                                                    || scriptBuffer[Script_Pos + 3] != 'A' )
                                                  {
                                                    break;
                                                  }
                                                  TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                  Kill_NPC(TSC_Num, 1);
                                                  Script_Pos += 8;
                                                }
                                                if ( scriptBuffer[Script_Pos + 1] != 'B'
                                                  || scriptBuffer[Script_Pos + 2] != 'O'
                                                  || scriptBuffer[Script_Pos + 3] != 'A' )
                                                {
                                                  break;
                                                }
                                                TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                                Set_Boss_Script_State(TSC_Num);
                                                Script_Pos += 8;
                                              }
                                              if ( scriptBuffer[Script_Pos + 1] != 'C'
                                                || scriptBuffer[Script_Pos + 2] != 'N'
                                                || scriptBuffer[Script_Pos + 3] != 'P' )
                                              {
                                                break;
                                              }
                                              TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                              TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                              TSC_Num = Get_TSC_Number(Script_Pos + 14);
                                              Spawn_NPC(TSC_Num_3, TSC_Num_2, TSC_Num);
                                              Script_Pos += 18;
                                            }
                                            if ( scriptBuffer[Script_Pos + 1] != 'A'
                                              || scriptBuffer[Script_Pos + 2] != 'N'
                                              || scriptBuffer[Script_Pos + 3] != 'P' )
                                            {
                                              break;
                                            }
                                            TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                            TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                            TSC_Num = Get_TSC_Number(Script_Pos + 14);
                                            Set_NPC_State(TSC_Num_3, TSC_Num_2, TSC_Num);
                                            Script_Pos += 18;
                                          }
                                          if ( scriptBuffer[Script_Pos + 1] != 'I'
                                            || scriptBuffer[Script_Pos + 2] != 'N'
                                            || scriptBuffer[Script_Pos + 3] != 'P' )
                                          {
                                            break;
                                          }
                                          TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                          TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                          TSC_Num = Get_TSC_Number(Script_Pos + 14);
                                          Change_Checkable_NPC_By_Event(TSC_Num_3, TSC_Num_2, TSC_Num);
                                          Script_Pos += 18;
                                        }
                                        if ( scriptBuffer[Script_Pos + 1] != 'S'
                                          || scriptBuffer[Script_Pos + 2] != 'N'
                                          || scriptBuffer[Script_Pos + 3] != 'P' )
                                        {
                                          break;
                                        }
                                        NPC_ID = Get_TSC_Number(Script_Pos + 4);
                                        TSC_Num_3 = Get_TSC_Number(Script_Pos + 9);
                                        TSC_Num_2 = Get_TSC_Number(Script_Pos + 14);
                                        TSC_Num = Get_TSC_Number(Script_Pos + 19);
                                        NPC_Create(
                                          (NPC_Names)NPC_ID,
                                          TSC_Num_3 << 13,
                                          TSC_Num_2 << 13,
                                          0,
                                          0,
                                          (Directions)TSC_Num,
                                          NULL,
                                          256);
                                        Script_Pos += 23;
                                      }
                                      if ( scriptBuffer[Script_Pos + 1] != 'M'
                                        || scriptBuffer[Script_Pos + 2] != 'N'
                                        || scriptBuffer[Script_Pos + 3] != 'P' )
                                      {
                                        break;
                                      }
                                      NPC_ID = Get_TSC_Number(Script_Pos + 4);
                                      TSC_Num_3 = Get_TSC_Number(Script_Pos + 9);
                                      TSC_Num_2 = Get_TSC_Number(Script_Pos + 14);
                                      TSC_Num = Get_TSC_Number(Script_Pos + 19);
                                      Move_NPC(NPC_ID, TSC_Num_3 << 13, TSC_Num_2 << 13, TSC_Num);
                                      Script_Pos += 23;
                                    }
                                    if ( scriptBuffer[Script_Pos + 1] != 'S'
                                      || scriptBuffer[Script_Pos + 2] != 'M'
                                      || scriptBuffer[Script_Pos + 3] != 'P' )
                                    {
                                      break;
                                    }
                                    TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                    TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                    Shift_Map_Parts(TSC_Num_3, TSC_Num_2);
                                    Script_Pos += 13;
                                  }
                                  if ( scriptBuffer[Script_Pos + 1] != 'C'
                                    || scriptBuffer[Script_Pos + 2] != 'M'
                                    || scriptBuffer[Script_Pos + 3] != 'P' )
                                  {
                                    break;
                                  }
                                  TSC_Num_3 = Get_TSC_Number(Script_Pos + 4);
                                  TSC_Num_2 = Get_TSC_Number(Script_Pos + 9);
                                  TSC_Num = Get_TSC_Number(Script_Pos + 14);
                                  Change_Map_Parts(TSC_Num_3, TSC_Num_2, TSC_Num);
                                  Script_Pos += 18;
                                }
                                if ( scriptBuffer[Script_Pos + 1] != 'B'
                                  || scriptBuffer[Script_Pos + 2] != 'S'
                                  || scriptBuffer[Script_Pos + 3] != 'L' )
                                {
                                  break;
                                }
                                TSC_Num = Get_TSC_Number(Script_Pos + 4);
                                if ( TSC_Num )
                                  Start_Boss_Life(TSC_Num);
                                else
                                  Start_Boss_Life_2();
                                Script_Pos += 8;
                              }
                              if ( scriptBuffer[Script_Pos + 1] != 'M'
                                || scriptBuffer[Script_Pos + 2] != 'Y'
                                || scriptBuffer[Script_Pos + 3] != 'D' )
                              {
                                break;
                              }
                              TSC_Num = Get_TSC_Number(Script_Pos + 4);
                              Set_Player_Direction(TSC_Num);
                              Script_Pos += 8;
                            }
                            if ( scriptBuffer[Script_Pos + 1] != 'M'
                              || scriptBuffer[Script_Pos + 2] != 'Y'
                              || scriptBuffer[Script_Pos + 3] != 'B' )
                            {
                              break;
                            }
                            TSC_Num = Get_TSC_Number(Script_Pos + 4);
                            Back_Step_Player(TSC_Num);
                            Script_Pos += 8;
                          }
                          if ( scriptBuffer[Script_Pos + 1] != 'M'
                            || scriptBuffer[Script_Pos + 2] != 'M'
                            || scriptBuffer[Script_Pos + 3] != '0' )
                          {
                            break;
                          }
                          Make_Quote_X_Vel_0();
                          Script_Pos += 4;
                        }
                        if ( scriptBuffer[Script_Pos + 1] != 'I'
                          || scriptBuffer[Script_Pos + 2] != 'N'
                          || scriptBuffer[Script_Pos + 3] != 'I' )
                        {
                          break;
                        }
                        Initialise_Game(AppWinHandle);
                        Script_Pos += 4;
                      }
                      if ( scriptBuffer[Script_Pos + 1] != 'S'
                        || scriptBuffer[Script_Pos + 2] != 'V'
                        || scriptBuffer[Script_Pos + 3] != 'P' )
                      {
                        break;
                      }
                      Save_Profile(NULL);
                      Script_Pos += 4;
                    }
                    if ( scriptBuffer[Script_Pos + 1] != 'L'
                      || scriptBuffer[Script_Pos + 2] != 'D'
                      || scriptBuffer[Script_Pos + 3] != 'P' )
                    {
                      break;
                    }
                    if ( !Load_Dropped_Profile_dat(0) )
                      Initialise_Game(AppWinHandle);
                  }
                  if ( scriptBuffer[Script_Pos + 1] != 'F'
                    || scriptBuffer[Script_Pos + 2] != 'A'
                    || scriptBuffer[Script_Pos + 3] != 'C' )
                  {
                    break;
                  }
                  TSC_Num = Get_TSC_Number(Script_Pos + 4);
                  if ( Face_Num != (char)TSC_Num )
                  {
                    Face_Num = (char)TSC_Num;
                    dword_4A5B10 = 2048;
                  }
                  Script_Pos += 8;
                }
                if ( scriptBuffer[Script_Pos + 1] != 'F'
                  || scriptBuffer[Script_Pos + 2] != 'A'
                  || scriptBuffer[Script_Pos + 3] != 'C' )
                {
                  break;
                }
                TSC_Num = Get_TSC_Number(Script_Pos + 4);
                if ( Face_Num != (char)TSC_Num )
                {
                  Face_Num = (char)TSC_Num;
                  dword_4A5B10 = 2048;
                }
                Script_Pos += 8;
              }
              if ( scriptBuffer[Script_Pos + 1] != 'G'
                || scriptBuffer[Script_Pos + 2] != 'I'
                || scriptBuffer[Script_Pos + 3] != 'T' )
              {
                break;
              }
              TSC_Num = Get_TSC_Number(Script_Pos + 4);
              dword_4A5B14 = TSC_Num;
              YPos = 128;
              Script_Pos += 8;
            }
            if ( scriptBuffer[Script_Pos + 1] != 'N'
              || scriptBuffer[Script_Pos + 2] != 'U'
              || scriptBuffer[Script_Pos + 3] != 'M' )
            {
              break;
            }
            TSC_Num = Get_TSC_Number(Script_Pos + 4);
            Print_NUM(TSC_Num);
            Script_Pos += 8;
          }
          if ( scriptBuffer[Script_Pos + 1] != 'C'
            || scriptBuffer[Script_Pos + 2] != 'R'
            || scriptBuffer[Script_Pos + 3] != 'E' )
          {
            break;
          }
          Game_Flags |= 8u;
          Start_Credits_Script();
          Script_Pos += 4;
        }
        if ( scriptBuffer[Script_Pos + 1] != 'S'
          || scriptBuffer[Script_Pos + 2] != 'I'
          || scriptBuffer[Script_Pos + 3] != 'L' )
        {
          break;
        }
        TSC_Num = Get_TSC_Number(Script_Pos + 4);
        Set_Credit_Illustration(TSC_Num);
        Script_Pos += 8;
      }
      if ( scriptBuffer[Script_Pos + 1] != 'C'
        || scriptBuffer[Script_Pos + 2] != 'I'
        || scriptBuffer[Script_Pos + 3] != 'L' )
      {
        break;
      }
      Cut_Credit_Illustration();
      Script_Pos += 4;
    }
    if ( scriptBuffer[Script_Pos + 1] != 'X'
      || scriptBuffer[Script_Pos + 2] != 'X'
      || scriptBuffer[Script_Pos + 3] != '1' )
    {
      break;
    }
    bExit = 1;
    TSC_Num = Get_TSC_Number(Script_Pos + 4);
    Scene_Down_Island_Ret = Scene_Island_Crash(AppWinHandle, TSC_Num);
    if ( !Scene_Down_Island_Ret )
      return 0;
    if ( Scene_Down_Island_Ret == 2 )
      return 2;
    Script_Pos += 8;
  }
  if ( scriptBuffer[Script_Pos + 1] != 'E' || scriptBuffer[Script_Pos + 2] != 'S' || scriptBuffer[Script_Pos + 3] != 'C' )
  {
    sprintf(
      (char *)&Text,
      "sR[h:<%c%c%c",
      (char)scriptBuffer[Script_Pos + 1],
      (char)scriptBuffer[Script_Pos + 2],
      (char)scriptBuffer[Script_Pos + 3]);
    MessageBoxA(NULL, &Text, "G[", 0);
    result = 0;
  }
  else
  {
    result = 2;
  }
  return result;
}
// 493628: using guessed type int Key_Ok;
// 49362C: using guessed type int Key_Cancel;
// 493630: using guessed type int Key_Left;
// 493638: using guessed type int Key_Right;
// 49E1E4: using guessed type int CursorPosition;
// 49E1E8: using guessed type int Game_Flags;
// 49E210: using guessed type int Key_Held;
// 49E214: using guessed type int Key_Pressed;
// 4A5ADC: using guessed type char byte_4A5ADC;
// 4A5ADD: using guessed type char byte_4A5ADD;
// 4A5AE4: using guessed type int TextColumn;
// 4A5AEC: using guessed type int dword_4A5AEC[];
// 4A5AFC: using guessed type int dword_4A5AFC;
// 4A5B00: using guessed type int dword_4A5B00;
// 4A5B04: using guessed type int dword_4A5B04;
// 4A5B08: using guessed type char byte_4A5B08;
// 4A5B0C: using guessed type int Face_Num;
// 4A5B10: using guessed type int dword_4A5B10;
// 4A5B14: using guessed type int dword_4A5B14;
// 4A5B30: using guessed type char byte_4A5B30;
// 422510: using guessed type char format[72];

//----- (00425790) --------------------------------------------------------
int Draw_Text_To_Text_Box_Surfaces()
{
  int result; // eax@3
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 4; ++i )
  {
    Draw_Color_Fill_Onto_Surface(&unk_498290, 0, i + 30);
    Draw_String_Onto_Surface(0, 0, (char *)&textBuffer + 64 * i, 0xFEFFFFu, i + 30);
    result = i + 1;
  }
  return result;
}

//----- (004257F0) --------------------------------------------------------
void Init_Triangle_Table()
{
  sin((long double)0 * 6.2832 / 256.0);
}

//----- (004258B0) --------------------------------------------------------
int __cdecl GetSin(unsigned __int8 deg)
{
  return Sin_Table[deg];
}
// 4A5B48: using guessed type int Sin_Table[];

//----- (004258C0) --------------------------------------------------------
int __cdecl GetCos(unsigned __int8 deg)
{
  return Sin_Table[(unsigned __int8)(deg + 64)];
}
// 4A5B48: using guessed type int Sin_Table[];

//----- (004258E0) --------------------------------------------------------
// Returns a value in degrees
unsigned __int8 __cdecl GetArcTan(int X, int Y)
{
  unsigned __int8 a; // [sp+7h] [bp-1h]@1
  int Neg_X; // [sp+10h] [bp+8h]@1
  int Neg_Y; // [sp+14h] [bp+Ch]@1

  Neg_X = -X;
  Neg_Y = -Y;
  a = 0;
  if ( Neg_X <= 0 )
  {
    if ( Neg_Y <= 0 )
    {
      if ( -Neg_X <= -Neg_Y )
      {
        while ( (signed __int16)(-8192 * Neg_X / -Neg_Y) > gTan[a] )
          ++a;
        a = -64 - a;
      }
      else
      {
        while ( (signed __int16)(-8192 * Neg_Y / -Neg_X) > gTan[a] )
          ++a;
        a += -128;
      }
    }
    else if ( -Neg_X <= Neg_Y )
    {
      while ( (signed __int16)(-8192 * Neg_X / Neg_Y) > gTan[a] )
        ++a;
      a += 64;
    }
    else
    {
      while ( (signed __int16)((Neg_Y << 13) / -Neg_X) > gTan[a] )
        ++a;
      a = -128 - a;
    }
  }
  else if ( Neg_Y <= 0 )
  {
    if ( Neg_X <= -Neg_Y )
    {
      while ( (signed __int16)((Neg_X << 13) / -Neg_Y) > gTan[a] )
        ++a;
      a -= 64;
    }
    else
    {
      while ( (signed __int16)(-8192 * Neg_Y / Neg_X) > gTan[a] )
        ++a;
      a = -a;
    }
  }
  else if ( Neg_X <= Neg_Y )
  {
    while ( (signed __int16)((Neg_X << 13) / Neg_Y) > gTan[a] )
      ++a;
    a = 64 - a;
  }
  else
  {
    while ( (signed __int16)((Neg_Y << 13) / Neg_X) > gTan[a] )
      ++a;
  }
  return a;
}
// 4A5F48: using guessed type __int16 gTan[];

//----- (00425B40) --------------------------------------------------------
// Microsoft VisualC 2-11/net runtime
void __cdecl call_call_cos(float a1)
{
  call_cos(a1);
}

//----- (00425B60) --------------------------------------------------------
void __cdecl call_cos(float a1)
{
  cos(a1);
}

//----- (00425B80) --------------------------------------------------------
// Mcrosoft VisualC 2-11/net runtime
void __cdecl call_call_sin(float a1)
{
  call_sin(a1);
}

//----- (00425BA0) --------------------------------------------------------
void __cdecl call_sin(float a1)
{
  sin(a1);
}

//----- (00425BC0) --------------------------------------------------------
void Clear_Value_View(void)
{
  memset(&Event_InUse, 0, 0x280u);
  Event_Index = 0;
}
// 4A5F90: using guessed type int Event_Index;

//----- (00425BF0) --------------------------------------------------------
int __cdecl Set_Value_View(__int32 a1, __int32 a2, __int32 a3)
{
  int result; // eax@32
  int v4; // [sp+0h] [bp-19Ch]@31
  int v5; // [sp+4h] [bp-198h]@31
  int v6; // [sp+8h] [bp-194h]@31
  int v7; // [sp+Ch] [bp-190h]@31
  int v8; // [sp+10h] [bp-18Ch]@31
  int v9; // [sp+14h] [bp-188h]@31
  int v10; // [sp+18h] [bp-184h]@31
  int v11; // [sp+1Ch] [bp-180h]@31
  int v12; // [sp+20h] [bp-17Ch]@31
  int v13; // [sp+24h] [bp-178h]@19
  int v14[4]; // [sp+28h] [bp-174h]@27
  int v15; // [sp+38h] [bp-164h]@11
  int v16; // [sp+3Ch] [bp-160h]@16
  int i; // [sp+40h] [bp-15Ch]@1
  int v18; // [sp+44h] [bp-158h]@25
  int v19; // [sp+48h] [bp-154h]@25
  int v20; // [sp+4Ch] [bp-150h]@25
  int v21; // [sp+50h] [bp-14Ch]@25
  int v22; // [sp+54h] [bp-148h]@25
  int v23; // [sp+58h] [bp-144h]@25
  int v24; // [sp+5Ch] [bp-140h]@25
  int v25; // [sp+60h] [bp-13Ch]@25
  int v26; // [sp+64h] [bp-138h]@25
  int v27; // [sp+68h] [bp-134h]@25
  int v28; // [sp+6Ch] [bp-130h]@25
  int v29; // [sp+70h] [bp-12Ch]@25
  int v30; // [sp+74h] [bp-128h]@25
  int v31; // [sp+78h] [bp-124h]@25
  int v32; // [sp+7Ch] [bp-120h]@25
  int v33; // [sp+80h] [bp-11Ch]@25
  int v34; // [sp+84h] [bp-118h]@25
  int v35; // [sp+88h] [bp-114h]@25
  int v36; // [sp+8Ch] [bp-110h]@25
  int v37; // [sp+90h] [bp-10Ch]@25
  int v38; // [sp+94h] [bp-108h]@25
  int v39; // [sp+98h] [bp-104h]@25
  int v40; // [sp+9Ch] [bp-100h]@25
  int v41; // [sp+A0h] [bp-FCh]@25
  int v42; // [sp+A4h] [bp-F8h]@25
  int v43; // [sp+A8h] [bp-F4h]@25
  int v44; // [sp+ACh] [bp-F0h]@25
  int v45; // [sp+B0h] [bp-ECh]@25
  int v46; // [sp+B4h] [bp-E8h]@25
  int v47; // [sp+B8h] [bp-E4h]@25
  int v48; // [sp+BCh] [bp-E0h]@25
  int v49; // [sp+C0h] [bp-DCh]@25
  int v50; // [sp+C4h] [bp-D8h]@25
  int v51; // [sp+C8h] [bp-D4h]@25
  int v52; // [sp+CCh] [bp-D0h]@25
  int v53; // [sp+D0h] [bp-CCh]@25
  int v54; // [sp+D4h] [bp-C8h]@25
  int v55; // [sp+D8h] [bp-C4h]@25
  int v56; // [sp+DCh] [bp-C0h]@25
  int v57; // [sp+E0h] [bp-BCh]@25
  int v58; // [sp+E4h] [bp-B8h]@25
  int v59; // [sp+E8h] [bp-B4h]@25
  int v60; // [sp+ECh] [bp-B0h]@25
  int v61; // [sp+F0h] [bp-ACh]@25
  int v62; // [sp+F4h] [bp-A8h]@25
  int v63; // [sp+F8h] [bp-A4h]@25
  int v64; // [sp+FCh] [bp-A0h]@25
  int v65; // [sp+100h] [bp-9Ch]@25
  int v66; // [sp+104h] [bp-98h]@25
  int v67; // [sp+108h] [bp-94h]@25
  int v68; // [sp+10Ch] [bp-90h]@25
  int v69; // [sp+110h] [bp-8Ch]@25
  int v70; // [sp+114h] [bp-88h]@25
  int v71; // [sp+118h] [bp-84h]@25
  int v72; // [sp+11Ch] [bp-80h]@25
  int v73; // [sp+120h] [bp-7Ch]@25
  int v74; // [sp+124h] [bp-78h]@25
  int v75; // [sp+128h] [bp-74h]@25
  int v76; // [sp+12Ch] [bp-70h]@25
  int v77; // [sp+130h] [bp-6Ch]@25
  int v78; // [sp+134h] [bp-68h]@25
  int v79; // [sp+138h] [bp-64h]@25
  int v80; // [sp+13Ch] [bp-60h]@25
  int v81; // [sp+140h] [bp-5Ch]@25
  int v82; // [sp+144h] [bp-58h]@25
  int v83; // [sp+148h] [bp-54h]@25
  int v84; // [sp+14Ch] [bp-50h]@25
  int v85; // [sp+150h] [bp-4Ch]@25
  int v86; // [sp+154h] [bp-48h]@25
  int v87; // [sp+158h] [bp-44h]@25
  int v88; // [sp+15Ch] [bp-40h]@25
  int v89; // [sp+160h] [bp-3Ch]@25
  int v90; // [sp+164h] [bp-38h]@25
  int v91; // [sp+168h] [bp-34h]@25
  int v92; // [sp+16Ch] [bp-30h]@25
  int v93; // [sp+170h] [bp-2Ch]@25
  int v94; // [sp+174h] [bp-28h]@25
  int v95; // [sp+178h] [bp-24h]@25
  int v96; // [sp+17Ch] [bp-20h]@25
  int v97; // [sp+180h] [bp-1Ch]@25
  __int32 v98; // [sp+188h] [bp-14h]@18
  int v99; // [sp+18Ch] [bp-10h]@25
  int v100; // [sp+190h] [bp-Ch]@25
  int v101; // [sp+194h] [bp-8h]@25
  int v102; // [sp+198h] [bp-4h]@25

  for ( i = 0;
        i < 16
     && (!*((_DWORD *)&Event_InUse + 10 * i)
      || Event_Collision[10 * i] != a1
      || (Event_X_Velocity[10 * i] >= 0 || a3 >= 0) && (Event_X_Velocity[10 * i] <= 0 || a3 <= 0));
        ++i )
  {
    ;
  }
  if ( i == 16 )
  {
    v15 = Event_Index++;
    if ( Event_Index == 16 )
      Event_Index = 0;
    Event_Y_Velocity[10 * v15] = 0;
    Event_Y_Position[10 * v15] = 0;
    Event_X_Velocity[10 * v15] = a3;
  }
  else
  {
    v15 = i;
    Event_Y_Velocity[10 * i] = 32;
    Event_X_Velocity[10 * v15] += a3;
    a3 = Event_X_Velocity[10 * v15];
  }
  if ( a3 >= 0 )
  {
    v16 = 0;
  }
  else
  {
    a3 = -a3;
    v16 = 1;
  }
  v98 = a3;
  if ( a3 <= 999 )
  {
    if ( a3 <= 99 )
    {
      if ( a3 <= 9 )
        v13 = 16;
      else
        v13 = 24;
    }
    else
    {
      v13 = 32;
    }
  }
  else
  {
    v13 = 40;
  }
  *((_DWORD *)&Event_InUse + 10 * v15) = 1;
  Event_Collision[10 * v15] = a1;
  Event_X_Position[10 * v15] = a2;
  Event_AltVel_X[10 * v15] = 40 - v13;
  Event_AltVel_Y[10 * v15] = 8 * v15;
  Event_Unknown1[10 * v15] = 40;
  Event_Unknown2[10 * v15] = 8 * v15 + 8;
  v18 = 0;
  v19 = 56;
  v20 = 8;
  v21 = 64;
  v22 = 8;
  v23 = 56;
  v24 = 16;
  v25 = 64;
  v26 = 16;
  v27 = 56;
  v28 = 24;
  v29 = 64;
  v30 = 24;
  v31 = 56;
  v32 = 32;
  v33 = 64;
  v34 = 32;
  v35 = 56;
  v36 = 40;
  v37 = 64;
  v38 = 40;
  v39 = 56;
  v40 = 48;
  v41 = 64;
  v42 = 48;
  v43 = 56;
  v44 = 56;
  v45 = 64;
  v46 = 56;
  v47 = 56;
  v48 = 64;
  v49 = 64;
  v50 = 64;
  v51 = 56;
  v52 = 72;
  v53 = 64;
  v54 = 72;
  v55 = 56;
  v56 = 80;
  v57 = 64;
  v58 = 0;
  v59 = 64;
  v60 = 8;
  v61 = 72;
  v62 = 8;
  v63 = 64;
  v64 = 16;
  v65 = 72;
  v66 = 16;
  v67 = 64;
  v68 = 24;
  v69 = 72;
  v70 = 24;
  v71 = 64;
  v72 = 32;
  v73 = 72;
  v74 = 32;
  v75 = 64;
  v76 = 40;
  v77 = 72;
  v78 = 40;
  v79 = 64;
  v80 = 48;
  v81 = 72;
  v82 = 48;
  v83 = 64;
  v84 = 56;
  v85 = 72;
  v86 = 56;
  v87 = 64;
  v88 = 64;
  v89 = 72;
  v90 = 64;
  v91 = 64;
  v92 = 72;
  v93 = 72;
  v94 = 72;
  v95 = 64;
  v96 = 80;
  v97 = 72;
  v99 = 1;
  v100 = 10;
  v101 = 100;
  v102 = 1000;
  for ( i = 3; i >= 0; --i )
  {
    v14[i] = 0;
    while ( v98 >= *(&v99 + i) )
    {
      v98 -= *(&v99 + i);
      ++v14[i];
    }
  }
  v12 = 0;
  v8 = 32;
  v9 = 48;
  v10 = 40;
  v11 = 56;
  v4 = 40;
  v5 = 48;
  v6 = 48;
  v7 = 56;
  Draw_Color_Fill_Onto_Surface((RECT *)&Event_AltVel_X[10 * v15], 0, 29);
  if ( v16 )
    result = Draw_Sprite_Onto_Surface(Event_AltVel_X[10 * v15], Event_AltVel_Y[10 * v15], (RECT *)&v4, 29, 26);
  else
    result = Draw_Sprite_Onto_Surface(Event_AltVel_X[10 * v15], Event_AltVel_Y[10 * v15], (RECT *)&v8, 29, 26);
  for ( i = 3; i >= 0; --i )
  {
    if ( v12 || !i || v14[i] )
    {
      v12 = 1;
      if ( v16 )
        v14[i] += 10;
      Draw_Sprite_Onto_Surface(8 * (3 - i) + 8, Event_AltVel_Y[10 * v15], (RECT *)&v18 + v14[i], 29, 26);
    }
    result = i - 1;
  }
  return result;
}
// 4A5F90: using guessed type int Event_Index;
// 4A5F9C: using guessed type int Event_Collision[];
// 4A5FA0: using guessed type int Event_X_Position[];
// 4A5FA4: using guessed type int Event_Y_Position[];
// 4A5FA8: using guessed type int Event_X_Velocity[];
// 4A5FAC: using guessed type int Event_Y_Velocity[];
// 4A5FB0: using guessed type int Event_AltVel_X[];
// 4A5FB4: using guessed type int Event_AltVel_Y[];
// 4A5FB8: using guessed type int Event_Unknown1[];
// 4A5FBC: using guessed type int Event_Unknown2[];
// 425BF0: using guessed type int var_174[4];

//----- (00426360) --------------------------------------------------------
int Act_Value_View()
{
  int result; // eax@2
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 16; ++i )
  {
    if ( *((_DWORD *)&Event_InUse + 10 * i) )
    {
      if ( ++Event_Y_Velocity[10 * i] < 32 )
        Event_Y_Position[10 * i] -= 256;
      if ( Event_Y_Velocity[10 * i] > 72 )
        ++Event_AltVel_Y[10 * i];
      if ( Event_Y_Velocity[10 * i] > 80 )
        *((_DWORD *)&Event_InUse + 10 * i) = 0;
    }
    result = i + 1;
  }
  return result;
}
// 4A5FA4: using guessed type int Event_Y_Position[];
// 4A5FAC: using guessed type int Event_Y_Velocity[];
// 4A5FB4: using guessed type int Event_AltVel_Y[];

//----- (00426430) --------------------------------------------------------
int __cdecl Put_Value_View(int Camera_X_Pos, int Camera_Y_Pos)
{
  int result; // eax@2
  __int64 v3; // rax@5
  int v4; // ST14_4@5
  __int64 v5; // rax@5
  int v6; // ST08_4@5
  __int64 v7; // rax@5
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < 16; ++i )
  {
    if ( *((_DWORD *)&Event_InUse + 10 * i) )
    {
      v3 = Event_Unknown1[10 * i] - Event_AltVel_X[10 * i];
      v4 = ((signed int)v3 - HIDWORD(v3)) >> 1;
      v5 = *(_DWORD *)Event_X_Position[10 * i];
      v6 = (((WORD2(v5) & 0x1FF) + (signed int)v5) >> 9) + Event_Y_Position[10 * i] / 512 - 4 - Camera_Y_Pos / 512;
      v7 = *(_DWORD *)Event_Collision[10 * i];
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        (((WORD2(v7) & 0x1FF) + (signed int)v7) >> 9) - v4 - Camera_X_Pos / 512,
        v6,
        (RECT *)&Event_AltVel_X[10 * i],
        29);
    }
    result = i + 1;
  }
  return result;
}
// 4A5F9C: using guessed type int Event_Collision[];
// 4A5FA0: using guessed type int Event_X_Position[];
// 4A5FA4: using guessed type int Event_Y_Position[];
// 4A5FB0: using guessed type int Event_AltVel_X[];
// 4A5FB8: using guessed type int Event_Unknown1[];

//----- (00426530) --------------------------------------------------------
// NPC 0 : Nothing.
// This NPC does basically nothing.
void __cdecl NPC0_Nothing(NPC_vars *npc)
{
  RECT *npc_Rect; // eax@4

  if ( !npc->Current_State )
  {
    npc->Current_State = 1;
    if ( npc->Direction == Right )
      npc->Y_pos += 0x2000;                     // If NPC facing right, make it 1 block lower
  }
  npc_Rect = &npc->Rect;
  npc_Rect->left = 0;
  npc_Rect->top = 0;
  npc_Rect->right = 16;
  npc_Rect->bottom = 16;
}

//----- (004265B0) --------------------------------------------------------
// NPC 1 : Weapon Energy
// Gives you EXP
void __cdecl NPC1_Weapon_Energy(NPC_vars *npc)
{
  RECT *npc_Rect; // eax@68
  int npx_Exp_Amount; // [sp+0h] [bp-74h]@56
  RECT Rects[6]; // [sp+14h] [bp-60h]@47

  if ( Current_Background.Mode != 5 && Current_Background.Mode != 6 )
  {
    if ( !npc->Current_State )                  // If uninitialised
    {
      npc->Current_State = 1;
      npc->Ani_Num = Random(0, 4);
      npc->X_vel = Random(-512, 512);
      npc->Y_vel = Random(-1024, 0);
      if ( Random(0, 1) )                       // Direction is random
        npc->Direction = 0;
      else
        npc->Direction = 2;
    }
    if ( npc->Collision_flags & 0x100 )
      npc->Y_vel += 21;
    else
      npc->Y_vel += 42;
    if ( npc->Collision_flags & 1 && npc->X_vel < 0 )
      npc->X_vel = -npc->X_vel;
    if ( npc->Collision_flags & 4 && npc->X_vel > 0 )
      npc->X_vel = -npc->X_vel;
    if ( npc->Collision_flags & 2 && npc->Y_vel < 0 )
      npc->Y_vel = -npc->Y_vel;
    if ( npc->Collision_flags & 8 )
    {
      Play_Sound_Effect(Sfx_EXP_Bounce, 1);
      npc->Y_vel = -640;
      npc->X_vel = 2 * npc->X_vel / 3;
    }
    if ( npc->Collision_flags & 0xD )
    {
      Play_Sound_Effect(Sfx_EXP_Bounce, 1);
      if ( ++npc->count2 > 2 )
        npc->Y_pos -= 512;
    }
    else
    {
      npc->count2 = 0;
    }
    if ( npc->X_vel < -1535 )
      npc->X_vel = -1535;
    if ( npc->X_vel > 1535 )
      npc->X_vel = 1535;
    if ( npc->Y_vel < -1535 )
      npc->Y_vel = -1535;
    if ( npc->Y_vel > 1535 )
      npc->Y_vel = 1535;
  }
  else
  {
    if ( !npc->Current_State )
    {
      npc->Current_State = 1;
      npc->Y_vel = Random(-128, 128);
      npc->X_vel = Random(127, 256);
    }
    npc->X_vel -= 8;
    if ( npc->X_pos < 40960 )
      npc->Is_Alive = 0;
    if ( npc->X_pos < -1536 )
      npc->X_pos = -1536;
    if ( npc->Collision_flags & 1 )
      npc->X_vel = 256;
    if ( npc->Collision_flags & 2 )
      npc->Y_vel = 64;
    if ( npc->Collision_flags & 8 )
      npc->Y_vel = -64;
  }
  npc->Y_pos += npc->Y_vel;
  npc->X_pos += npc->X_vel;
  Rects[0].left = 0;
  Rects[0].top = 16;
  Rects[0].right = 16;
  Rects[0].bottom = 32;
  Rects[1].left = 16;
  Rects[1].top = 16;
  Rects[1].right = 32;
  Rects[1].bottom = 32;
  Rects[2].left = 32;
  Rects[2].top = 16;
  Rects[2].right = 48;
  Rects[2].bottom = 32;
  Rects[3].left = 48;
  Rects[3].top = 16;
  Rects[3].right = 64;
  Rects[3].bottom = 32;
  Rects[4].left = 64;
  Rects[4].top = 16;
  Rects[4].right = 80;
  Rects[4].bottom = 32;
  Rects[5].left = 80;
  Rects[5].top = 16;
  Rects[5].right = 96;
  Rects[5].bottom = 32;
  ++npc->ani_wait;
  if ( npc->Direction )
  {
    if ( npc->ani_wait > 2 )
    {
      npc->ani_wait = 0;
      if ( --npc->Ani_Num < 0 )
        npc->Ani_Num = 5;
    }
  }
  else if ( npc->ani_wait > 2 )
  {
    npc->ani_wait = 0;
    if ( ++npc->Ani_Num > 5 )
      npc->Ani_Num = 0;
  }
  npc->Rect = Rects[npc->Ani_Num];
  if ( npc->Current_State )
  {
    npx_Exp_Amount = npc->EXP_Amount;
    if ( npx_Exp_Amount == 5 )
    {
      npc->Rect.top += 16;
      npc->Rect.bottom += 16;
    }
    else if ( npx_Exp_Amount == 20 )
    {
      npc->Rect.top += 32;
      npc->Rect.bottom += 32;
    }
    npc->Current_State = 1;
  }
  if ( ++npc->count1 > 500 && npc->Ani_Num == 5 && npc->ani_wait == 2 )
    npc->Is_Alive = 0;
  if ( npc->count1 > 400 )
  {
    if ( npc->count1 / 2 % 2 )
    {
      npc_Rect = &npc->Rect;
      npc_Rect->left = 0;
      npc_Rect->top = 0;
      npc_Rect->right = 0;
      npc_Rect->bottom = 0;
    }
  }
}

//----- (00426AF0) --------------------------------------------------------
// NPC 2 : Behemoth (Enemy)
// Appears in the Egg Corridor.
void __cdecl NPC2_Enemy_Behemoth(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-E4h]@5
  RECT Rects_Right[7]; // [sp+4h] [bp-E0h]@1
  RECT Rects_Left[7]; // [sp+74h] [bp-70h]@1

  Rects_Left[0].left = 32;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 64;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 0;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 64;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 64;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 96;
  Rects_Left[3].bottom = 24;
  Rects_Left[4].left = 96;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 128;
  Rects_Left[4].bottom = 24;
  Rects_Left[5].left = 128;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 160;
  Rects_Left[5].bottom = 24;
  Rects_Left[6].left = 160;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 192;
  Rects_Left[6].bottom = 24;
  Rects_Right[0].left = 32;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 64;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 0;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 64;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 64;
  Rects_Right[3].top = 24;
  Rects_Right[3].right = 96;
  Rects_Right[3].bottom = 48;
  Rects_Right[4].left = 96;
  Rects_Right[4].top = 24;
  Rects_Right[4].right = 128;
  Rects_Right[4].bottom = 48;
  Rects_Right[5].left = 128;
  Rects_Right[5].top = 24;
  Rects_Right[5].right = 160;
  Rects_Right[5].bottom = 48;
  Rects_Right[6].left = 160;
  Rects_Right[6].top = 24;
  Rects_Right[6].right = 192;
  Rects_Right[6].bottom = 48;
  if ( npc->Collision_flags & 1 )
  {
    npc->Direction = 2;
  }
  else if ( npc->Collision_flags & 4 )
  {
    npc->Direction = 0;
  }
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State == 1 )
    {
      npc->X_vel = 7 * npc->X_vel / 8;
      if ( ++npc->count1 > 40 )
      {
        if ( npc->Is_Being_Hit )
        {
          npc->count1 = 0;
          npc->Current_State = 2;
          npc->Ani_Num = 6;
          npc->ani_wait = 0;
          npc->Damage = 5;
        }
        else
        {
          npc->Current_State = 0;
          npc->ani_wait = 0;
        }
      }
    }
    else if ( npc_Current_State == 2 )
    {
      if ( npc->Direction )
        npc->X_vel = 1024;
      else
        npc->X_vel = -1024;
      if ( ++npc->count1 > 200 )
      {
        npc->Current_State = 0;
        npc->Damage = 1;
      }
      if ( ++npc->ani_wait > 5 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 6 )
      {
        npc->Ani_Num = 5;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        NPC_Create(Smoke, npc->X_pos, npc->Y_pos + 1536, 0, 0, 0, NULL, 256);
        Set_Quake(8);
      }
    }
  }
  else
  {
    if ( npc->Direction )
      npc->X_vel = 256;
    else
      npc->X_vel = -256;
    if ( ++npc->ani_wait > 8 )
    {
      npc->ani_wait = 0;
      ++npc->Ani_Num;
    }
    if ( npc->Ani_Num > 3 )
      npc->Ani_Num = 0;
    if ( npc->Is_Being_Hit )
    {
      npc->count1 = 0;
      npc->Current_State = 1;
      npc->Ani_Num = 4;
    }
  }
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00426FD0) --------------------------------------------------------
// NPC 3 : Nothing?
// This NPC deletes itself
void __cdecl NPC3_Deletes_Itself(NPC_vars *npc)
{
  RECT *npc_Rect; // edx@3

  if ( ++npc->count1 > 100 )
    npc->Is_Alive = Free;
  npc_Rect = &npc->Rect;
  npc_Rect->left = 0;
  npc_Rect->top = 0;
  npc_Rect->right = 0;
  npc_Rect->bottom = 0;
}

//----- (00427040) --------------------------------------------------------
// NPC 4 : Smoke
// This NPC simply is smoke.
void __cdecl NPC4_Smoke(NPC_vars *npc)
{
  int v1; // esi@4
  int v2; // esi@4
  RECT Rects_Left_Right[8]; // [sp+0h] [bp-108h]@1
  RECT Rects_Up[8]; // [sp+80h] [bp-88h]@1
  unsigned __int8 v5; // [sp+107h] [bp-1h]@4

  Rects_Left_Right[0].left = 16;
  Rects_Left_Right[0].top = 0;
  Rects_Left_Right[0].right = 17;
  Rects_Left_Right[0].bottom = 1;
  Rects_Left_Right[1].left = 16;
  Rects_Left_Right[1].top = 0;
  Rects_Left_Right[1].right = 32;
  Rects_Left_Right[1].bottom = 16;
  Rects_Left_Right[2].left = 32;
  Rects_Left_Right[2].top = 0;
  Rects_Left_Right[2].right = 48;
  Rects_Left_Right[2].bottom = 16;
  Rects_Left_Right[3].left = 48;
  Rects_Left_Right[3].top = 0;
  Rects_Left_Right[3].right = 64;
  Rects_Left_Right[3].bottom = 16;
  Rects_Left_Right[4].left = 64;
  Rects_Left_Right[4].top = 0;
  Rects_Left_Right[4].right = 80;
  Rects_Left_Right[4].bottom = 16;
  Rects_Left_Right[5].left = 80;
  Rects_Left_Right[5].top = 0;
  Rects_Left_Right[5].right = 96;
  Rects_Left_Right[5].bottom = 16;
  Rects_Left_Right[6].left = 96;
  Rects_Left_Right[6].top = 0;
  Rects_Left_Right[6].right = 112;
  Rects_Left_Right[6].bottom = 16;
  Rects_Left_Right[7].left = 112;
  Rects_Left_Right[7].top = 0;
  Rects_Left_Right[7].right = 128;
  Rects_Left_Right[7].bottom = 16;
  Rects_Up[0].left = 16;
  Rects_Up[0].top = 0;
  Rects_Up[0].right = 17;
  Rects_Up[0].bottom = 1;
  Rects_Up[1].left = 80;
  Rects_Up[1].top = 48;
  Rects_Up[1].right = 96;
  Rects_Up[1].bottom = 64;
  Rects_Up[2].left = 0;
  Rects_Up[2].top = 128;
  Rects_Up[2].right = 16;
  Rects_Up[2].bottom = 144;
  Rects_Up[3].left = 16;
  Rects_Up[3].top = 128;
  Rects_Up[3].right = 32;
  Rects_Up[3].bottom = 144;
  Rects_Up[4].left = 32;
  Rects_Up[4].top = 128;
  Rects_Up[4].right = 48;
  Rects_Up[4].bottom = 144;
  Rects_Up[5].left = 48;
  Rects_Up[5].top = 128;
  Rects_Up[5].right = 64;
  Rects_Up[5].bottom = 144;
  Rects_Up[6].left = 64;
  Rects_Up[6].top = 128;
  Rects_Up[6].right = 80;
  Rects_Up[6].bottom = 144;
  Rects_Up[7].left = 80;
  Rects_Up[7].top = 128;
  Rects_Up[7].right = 96;
  Rects_Up[7].bottom = 144;
  if ( npc->Current_State )
  {
    npc->X_vel = 20 * npc->X_vel / 21;
    npc->Y_vel = 20 * npc->Y_vel / 21;
    npc->X_pos += npc->X_vel;
    npc->Y_pos += npc->Y_vel;
  }
  else
  {
    if ( !npc->Direction || npc->Direction == 1 )
    {
      v5 = Random(0, 255);
      v1 = GetCos(v5);
      npc->X_vel = v1 * Random(512, 1535) / 512;
      v2 = GetSin(v5);
      npc->Y_vel = v2 * Random(512, 1535) / 512;
    }
    npc->Ani_Num = Random(0, 4);
    npc->ani_wait = Random(0, 3);
    npc->Current_State = 1;
  }
  if ( ++npc->ani_wait > 4 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num <= 7 )
  {
    if ( npc->Direction == Up )
      npc->Rect = Rects_Up[npc->Ani_Num];
    if ( !npc->Direction )
      npc->Rect = Rects_Left_Right[npc->Ani_Num];
    if ( npc->Direction == Right )
      npc->Rect = Rects_Left_Right[npc->Ani_Num];
  }
  else
  {
    npc->Is_Alive = 0;
  }
}

//----- (00427480) --------------------------------------------------------
// NPC 5 : Critter (Enemy) (Hopping, Green)
// Appears in the Egg Corridor.
void __cdecl NPC5_Enemy_Critter_Hopping_Green(NPC_vars *npc)
{
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 48;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 64;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 48;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 64;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 48;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 64;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 64;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 80;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 64;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 80;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 64;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 80;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Y_pos += 1536;
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( npc->X_pos <= Quote.X_Pos )
        npc->Direction = 2;
      else
        npc->Direction = 0;
      if ( npc->Wait_Timer < 8
        || npc->X_pos - 57344 >= Quote.X_Pos
        || npc->X_pos + 57344 <= Quote.X_Pos
        || npc->Y_pos - 40960 >= Quote.Y_Pos
        || npc->Y_pos + 40960 <= Quote.Y_Pos )
      {
        if ( npc->Wait_Timer < 8 )
          ++npc->Wait_Timer;
        npc->Ani_Num = 0;
      }
      else
      {
        npc->Ani_Num = 1;
      }
      if ( npc->Is_Being_Hit )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      if ( npc->Wait_Timer >= 8
        && npc->X_pos - 24576 < Quote.X_Pos
        && npc->X_pos + 24576 > Quote.X_Pos
        && npc->Y_pos - 40960 < Quote.Y_Pos
        && npc->Y_pos + 24576 > Quote.Y_Pos )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 2;
        npc->Y_vel = -1535;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
        if ( npc->Direction )
          npc->X_vel = 256;
        else
          npc->X_vel = -256;
      }
      break;
    case 3:
      if ( npc->Collision_flags & 8 )
      {
        npc->X_vel = 0;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->Current_State = 1;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    default:
      break;
  }
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )                        // If direction == Left
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00427820) --------------------------------------------------------
// NPC 6 : Beetle (Enemy) (Horizontal, Green)
// Appears in the Egg Corridor.
void __cdecl NPC6_Enemy_Beetle_Horiz_Green(NPC_vars *npc)
{
  RECT Rects_Left[5]; // [sp+4h] [bp-A0h]@1
  RECT Rects_Right[5]; // [sp+54h] [bp-50h]@1

  Rects_Right[0].left = 0;
  Rects_Right[0].top = 80;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 96;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 80;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 96;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 80;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 96;
  Rects_Right[3].left = 48;
  Rects_Right[3].top = 80;
  Rects_Right[3].right = 64;
  Rects_Right[3].bottom = 96;
  Rects_Right[4].left = 64;
  Rects_Right[4].top = 80;
  Rects_Right[4].right = 80;
  Rects_Right[4].bottom = 96;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 96;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 112;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 96;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 112;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 96;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 112;
  Rects_Left[3].left = 48;
  Rects_Left[3].top = 96;
  Rects_Left[3].right = 64;
  Rects_Left[3].bottom = 112;
  Rects_Left[4].left = 64;
  Rects_Left[4].top = 96;
  Rects_Left[4].right = 80;
  Rects_Left[4].bottom = 112;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      if ( npc->Direction )
        npc->Current_State = 3;
      else
        npc->Current_State = 1;
      break;
    case 1:
      npc->X_vel -= 16;
      if ( npc->X_vel < -1024 )
        npc->X_vel = -1024;
      if ( npc->Is_Being_Hit )
        npc->X_pos += npc->X_vel / 2;
      else
        npc->X_pos += npc->X_vel;
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 2 )
        npc->Ani_Num = 1;
      if ( npc->Collision_flags & 1 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->X_vel = 0;
        npc->Direction = 2;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 60 )
      {
        npc->Current_State = 3;
        npc->ani_wait = 0;
        npc->Ani_Num = 1;
      }
      break;
    case 3:
      npc->X_vel += 16;
      if ( npc->X_vel > 1024 )
        npc->X_vel = 1024;
      if ( npc->Is_Being_Hit )
        npc->X_pos += npc->X_vel / 2;
      else
        npc->X_pos += npc->X_vel;
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 2 )
        npc->Ani_Num = 1;
      if ( npc->Collision_flags & 4 )
      {
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->X_vel = 0;
        npc->Direction = 0;
      }
      break;
    case 4:
      if ( ++npc->Wait_Timer > 60 )
      {
        npc->Current_State = 1;
        npc->ani_wait = 0;
        npc->Ani_Num = 1;
      }
      break;
    default:
      break;
  }
  if ( npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00427C60) --------------------------------------------------------
// NPC 6 : Beetle (Enemy) (Horizontal, Green)
// Appears in the Egg Corridor.
void __cdecl NPC7_Enemy_Basil(NPC_vars *npc)
{
  int npc_act_no; // [sp+0h] [bp-64h]@1
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@1

  Rects_Left[0].left = 256;
  Rects_Left[0].top = 64;
  Rects_Left[0].right = 288;
  Rects_Left[0].bottom = 80;
  Rects_Left[1].left = 256;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 288;
  Rects_Left[1].bottom = 96;
  Rects_Left[2].left = 256;
  Rects_Left[2].top = 96;
  Rects_Left[2].right = 288;
  Rects_Left[2].bottom = 112;
  Rects_Right[0].left = 288;
  Rects_Right[0].top = 64;
  Rects_Right[0].right = 320;
  Rects_Right[0].bottom = 80;
  Rects_Right[1].left = 288;
  Rects_Right[1].top = 80;
  Rects_Right[1].right = 320;
  Rects_Right[1].bottom = 96;
  Rects_Right[2].left = 288;
  Rects_Right[2].top = 96;
  Rects_Right[2].right = 320;
  Rects_Right[2].bottom = 112;
  npc_act_no = npc->Current_State;
  if ( npc_act_no )
  {
    if ( npc_act_no == 1 )
    {
      npc->X_vel -= 64;
      if ( npc->X_pos < Quote.X_Pos - 98304 )
        npc->Current_State = 2;
      if ( npc->Collision_flags & 1 )
      {
        npc->X_vel = 0;
        npc->Current_State = 2;
      }
    }
    else if ( npc_act_no == 2 )
    {
      npc->X_vel += 64;
      if ( npc->X_pos > Quote.X_Pos + 98304 )
        npc->Current_State = 1;
      if ( npc->Collision_flags & 4 )
      {
        npc->X_vel = 0;
        npc->Current_State = 1;
      }
    }
  }
  else
  {
    npc->X_pos = Quote.X_Pos;
    if ( npc->Direction )
      npc->Current_State = 2;
    else
      npc->Current_State = 1;
  }
  if ( npc->X_vel >= 0 )
    npc->Direction = 2;
  else
    npc->Direction = 0;
  if ( npc->X_vel > 1535 )
    npc->X_vel = 1535;
  if ( npc->X_vel < -1535 )
    npc->X_vel = -1535;
  npc->X_pos += npc->X_vel;
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 2 )
    npc->Ani_Num = 0;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00427F00) --------------------------------------------------------
// NPC 8 : Beetle (Enemy) (Follow 1)
// Appears in the Egg Corridor.
void __cdecl NPC8_Enemy_Beetle_Follow1(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-44h]@1
  RECT Rects_Right[2]; // [sp+4h] [bp-40h]@1
  RECT Rects_Left[2]; // [sp+24h] [bp-20h]@1

  Rects_Left[0].left = 80;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 96;
  Rects_Left[0].bottom = 96;
  Rects_Left[1].left = 96;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 112;
  Rects_Left[1].bottom = 96;
  Rects_Right[0].left = 80;
  Rects_Right[0].top = 96;
  Rects_Right[0].right = 96;
  Rects_Right[0].bottom = 112;
  Rects_Right[1].left = 96;
  Rects_Right[1].top = 96;
  Rects_Right[1].right = 112;
  Rects_Right[1].bottom = 112;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State == 1 )
    {
      if ( npc->X_pos <= Quote.X_Pos )
      {
        npc->Direction = 2;
        npc->X_vel += 16;
      }
      else
      {
        npc->Direction = 0;
        npc->X_vel -= 16;
      }
      if ( npc->X_vel > 767 )
        npc->X_vel = 767;
      if ( npc->X_vel < -767 )
        npc->X_vel = -767;
      if ( npc->Y_pos >= npc->Curly_Target_Y )
        npc->Y_vel -= 8;
      else
        npc->Y_vel += 8;
      if ( npc->Y_vel > 256 )
        npc->Y_vel = 256;
      if ( npc->Y_vel < -256 )
        npc->Y_vel = -256;
      if ( npc->Is_Being_Hit )
      {
        npc->X_pos += npc->X_vel / 2;
        npc->Y_pos += npc->Y_vel / 2;
      }
      else
      {
        npc->X_pos += npc->X_vel;
        npc->Y_pos += npc->Y_vel;
      }
    }
  }
  else
  {
    if ( Quote.X_Pos >= npc->X_pos + 0x2000 || Quote.X_Pos <= npc->X_pos - 0x2000 )
    {
      npc->Entity_Flags &= 0xFFDFu;
      npc->Rect.right = 0;
      npc->Damage = 0;
      npc->X_vel = 0;
      npc->Y_vel = 0;
      return;
    }
    npc->Entity_Flags |= 0x20u;
    npc->Y_vel = -256;
    npc->Curly_Target_Y = npc->Y_pos;
    npc->Current_State = 1;
    npc->Damage = 2;
    if ( npc->Direction )
    {
      npc->X_pos = Quote.X_Pos - 0x20000;
      npc->X_vel = 767;
    }
    else
    {
      npc->X_pos = Quote.X_Pos + 0x20000;
      npc->X_vel = -767;
    }
  }
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 1 )
    npc->Ani_Num = 0;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00428260) --------------------------------------------------------
// NPC 9 : Balrog (drops in)
void __cdecl NPC9_Balrog_DropIn(NPC_vars *npc)
{
  int Child_Y_Vel; // ST10_4@12
  int Child_X_Vel; // ST0C_4@12
  int Child_Y_Pos; // ST08_4@12
  int X_Pos_Modifier; // eax@12
  int npc_Current_State; // [sp+0h] [bp-68h]@1
  RECT Rects_Right[3]; // [sp+4h] [bp-64h]@21
  RECT Rects_Left[3]; // [sp+34h] [bp-34h]@21
  int i; // [sp+64h] [bp-4h]@10

  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
    {
      if ( npc_Current_State == 2 && ++npc->Wait_Timer > 16 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 0;
        npc->ani_wait = 0;
      }
      goto LABEL_17;
    }
  }
  else
  {
    npc->Current_State = 1;
    npc->Ani_Num = 2;
  }
  npc->Y_vel += 32;
  if ( npc->count1 >= 40 )
  {
    npc->Entity_Flags &= 0xFFF7u;
    npc->Entity_Flags |= 1u;
  }
  else
  {
    ++npc->count1;
  }
  if ( npc->Collision_flags & 8 )
  {
    for ( i = 0; i < 4; ++i )
    {
      Child_Y_Vel = Random(-1536, 0);
      Child_X_Vel = Random(-341, 341);
      Child_Y_Pos = npc->Y_pos + (Random(-12, 12) << 9);
      X_Pos_Modifier = Random(-12, 12);
      NPC_Create(Smoke, npc->X_pos + (X_Pos_Modifier << 9), Child_Y_Pos, Child_X_Vel, Child_Y_Vel, 0, NULL, 256);
    }
    npc->Current_State = 2;
    npc->Ani_Num = 1;
    npc->Wait_Timer = 0;
    Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
    Set_Quake(30);
  }
LABEL_17:
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  if ( npc->Y_vel < -1535 )
    npc->Y_vel = -1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 80;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 120;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 120;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 160;
  Rects_Left[2].bottom = 24;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 80;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 120;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 120;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 160;
  Rects_Right[2].bottom = 48;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00428540) --------------------------------------------------------
// NPC 10 : Balrog (Boss) (Shooting)
// Balrog when he is shooting an energy shot.
// azertyuiop
void __cdecl NPC10_Boss_Balrog_Shooting(NPC_vars *npc)
{
  RECT Rects_Right[4]; // [sp+4h] [bp-90h]@25
  int Child_Y_Vel; // [sp+44h] [bp-50h]@7
  int Child_X_Vel; // [sp+48h] [bp-4Ch]@7
  RECT Rects_Left[4]; // [sp+4Ch] [bp-48h]@25
  unsigned __int8 deg; // [sp+93h] [bp-1h]@7

  switch ( npc->Current_State )                 // Balrog (Shoot) Turret Behavior
                                                // State 0 and 1 do the default behavior.
                                                // State 2 makes Balrog stand in place and shoot his 
                                                // mouth shots for 43.52 years
                                                // State 3 makes Balrog wait 3 frames then jump towards Quote and 
                                                // then reset to normal behaviour
                                                // State 4 makes Balrog act as if he was flying, just without 
                                                // velocity and with the wrong rect.
                                                // State 5 makes Balrog wait 3 frames then reset to state 1
                                                // Other values make him just stand in place doing nothing
  {
    case 0:
      npc->Current_State = 1;                   // On init
      goto case_1;
    case 1:
case_1:
      if ( ++npc->Wait_Timer > 12 )             // Wait 12 frames
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->count1 = 3;                        // Shoot 3 orbs at Quote
        npc->Ani_Num = 1;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 16 )             // Wait 16 frames per orb
      {
        --npc->count1;                          // Fail : Counter is decreased before checking for it being equal 
                                                // to 0. This means that if the counter is initiated at 0, Balrog 
                                                // will shoot at Quote for 68719476480 frames, or 1374389529.6 
                                                // seconds, or 22906492.16 minutes, or 381774.72 hours, or 
                                                // 15907.2 days, or 43.52 years
        npc->Wait_Timer = 0;
        deg = GetArcTan(npc->X_pos - Quote.X_Pos, npc->Y_pos + 2048 - Quote.Y_Pos);
        deg += Random(-16, 16);                 // Shoot an orb at Quote
        Child_Y_Vel = GetSin(deg);
        Child_X_Vel = GetCos(deg);
        NPC_Create(
          Projectile_Balrog_Energy_Bounce,
          npc->X_pos,
          npc->Y_pos + 2048,
          Child_X_Vel,
          Child_Y_Vel,
          0,
          NULL,
          256);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        if ( !npc->count1 )
        {
          npc->Current_State = 3;
          npc->Wait_Timer = 0;
        }
      }
      break;
    case 3:
      if ( ++npc->Wait_Timer > 3 )              // Jump towards Quote
      {
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
        npc->X_vel = (Quote.X_Pos - npc->X_pos) / 100;
        npc->Y_vel = -1536;
        npc->Ani_Num = 3;
      }
      break;
    case 4:
      if ( npc->Collision_flags & 5 )           // When touching a wall, stop
        npc->X_vel = 0;
      if ( npc->Y_pos + 0x2000 >= Quote.Y_Pos )
        npc->Damage = 0;
      else
        npc->Damage = 5;
      if ( npc->Collision_flags & 8 )
      {
        npc->Current_State = 5;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 2;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
        npc->Damage = 0;
      }
      break;
    case 5:
      npc->X_vel = 0;
      if ( ++npc->Wait_Timer > 3 )              // Wait 3 frames, then reset 
      {
        npc->Current_State = 1;
        npc->Wait_Timer = 0;
      }
      break;
    default:
      break;
  }
  npc->Y_vel += 32;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 40;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 80;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 120;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 120;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 160;
  Rects_Left[3].bottom = 24;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 40;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 80;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 120;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 120;
  Rects_Right[3].top = 24;
  Rects_Right[3].right = 160;
  Rects_Right[3].bottom = 48;
  if ( npc->X_pos >= Quote.X_Pos )
    npc->Direction = 0;
  else
    npc->Direction = 2;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (004289B0) --------------------------------------------------------
// NPC 11 : Balrog (Projectile) (energy bounce)
// The projectile Balrog 2 shoots.
void __cdecl NPC11_Projectile_Balrog_Energy_Bounce(NPC_vars *npc)
{
  RECT Rects[3]; // [sp+0h] [bp-30h]@3

  if ( npc->Collision_flags & 0xFF )
  {
    npc->Is_Alive = 0;
    Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
  }
  npc->Y_pos += npc->Y_vel;
  npc->X_pos += npc->X_vel;
  Rects[0].left = 208;
  Rects[0].top = 104;
  Rects[0].right = 224;
  Rects[0].bottom = 120;
  Rects[1].left = 224;
  Rects[1].top = 104;
  Rects[1].right = 240;
  Rects[1].bottom = 120;
  Rects[2].left = 240;
  Rects[2].top = 104;
  Rects[2].right = 256;
  Rects[2].bottom = 120;
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    if ( ++npc->Ani_Num > 2 )
      npc->Ani_Num = 0;
  }
  npc->Rect = Rects[npc->Ani_Num];
  if ( ++npc->count1 > 150 )
  {
    Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
    npc->Is_Alive = 0;
  }
}

//----- (00428B10) --------------------------------------------------------
// NPC 12 : Balrog (cutscene)
// Balrog when he is in a cutscene.
void __cdecl NPC12_Balrog_Cutscene(NPC_vars *npc)
{
  int v1; // ST10_4@32
  int v2; // ST0C_4@32
  int v3; // ST08_4@32
  int v4; // eax@32
  int v5; // ST10_4@98
  int v6; // ST0C_4@98
  int v7; // ST08_4@98
  int v8; // eax@98
  RECT Rects_Right[14]; // [sp+4h] [bp-1D0h]@101
  RECT Rects_Left[14]; // [sp+E4h] [bp-F0h]@101
  int i; // [sp+1C8h] [bp-Ch]@30
  int X_Pos; // [sp+1CCh] [bp-8h]@90
  int Y_Pos; // [sp+1D0h] [bp-4h]@90

  switch ( npc->Current_State )
  {
    case 0:
      if ( npc->Direction == 4 )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
      }
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      goto LABEL_7;
    case 1:
LABEL_7:
      if ( !Random(0, 100) )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 16 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 0xA:
      if ( npc->Direction == 4 )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
      }
      npc->Current_State = 11;
      npc->Ani_Num = 2;
      npc->Wait_Timer = 0;
      npc->Curly_Target_X = 0;
      goto LABEL_18;
    case 0xB:
LABEL_18:
      if ( ++npc->Wait_Timer > 30 )
      {
        npc->Current_State = 12;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 3;
        npc->Y_vel = -2048;
        npc->Entity_Flags |= 8u;
      }
      break;
    case 0xC:
      if ( npc->Collision_flags & 5 )
        npc->X_vel = 0;
      if ( npc->Y_pos < 0 )
      {
        npc->Entity_Type = 0;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
      }
      break;
    case 0x14:
      if ( npc->Direction == 4 )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
      }
      npc->Current_State = 21;
      npc->Ani_Num = 5;
      npc->Wait_Timer = 0;
      npc->count1 = 0;
      for ( i = 0; i < 4; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = npc->Y_pos + (Random(-12, 12) << 9);
        v4 = Random(-12, 12);
        NPC_Create(Smoke, npc->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
      Play_Sound_Effect(Sfx_Explosion, 1);
      goto LABEL_34;
    case 0x15:
LABEL_34:
      npc->Curly_Target_X = 1;
      if ( npc->Collision_flags & 8 )
        ++npc->Wait_Timer;
      if ( ++npc->count1 / 2 % 2 )
        npc->X_pos += 512;
      else
        npc->X_pos -= 512;
      if ( npc->Wait_Timer > 100 )
      {
        npc->Current_State = 11;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 2;
      }
      npc->Y_vel += 32;
      if ( npc->Y_vel > 1535 )
        npc->Y_vel = 1535;
      break;
    case 0x1E:
      npc->Ani_Num = 4;
      if ( ++npc->Wait_Timer > 100 )
      {
        npc->Current_State = 0;
        npc->Ani_Num = 0;
      }
      break;
    case 0x28:
      if ( npc->Direction == 4 )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
      }
      npc->Current_State = 41;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 5;
      goto LABEL_52;
    case 0x29:
LABEL_52:
      if ( ++npc->ani_wait / 2 % 2 )
        npc->Ani_Num = 5;
      else
        npc->Ani_Num = 6;
      break;
    case 0x2A:
      if ( npc->Direction == 4 )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
      }
      npc->Current_State = 43;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 6;
      goto LABEL_61;
    case 0x2B:
LABEL_61:
      if ( ++npc->ani_wait / 2 % 2 )
        npc->Ani_Num = 7;
      else
        npc->Ani_Num = 6;
      break;
    case 0x32:
      npc->Ani_Num = 8;
      npc->X_vel = 0;
      break;
    case 0x3C:
      npc->Current_State = 61;
      npc->Ani_Num = 9;
      npc->ani_wait = 0;
      goto LABEL_67;
    case 0x3D:
LABEL_67:
      if ( ++npc->ani_wait > 3 )
      {
        npc->ani_wait = 0;
        if ( ++npc->Ani_Num == 10 || npc->Ani_Num == 11 )
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      if ( npc->Ani_Num > 12 )
        npc->Ani_Num = 9;
      if ( npc->Direction )
        npc->X_vel = 512;
      else
        npc->X_vel = -512;
      break;
    case 0x46:
      npc->Current_State = 71;
      npc->Wait_Timer = 64;
      Play_Sound_Effect(Sfx_Teleport, 1);
      npc->Ani_Num = 13;
      goto LABEL_78;
    case 0x47:
LABEL_78:
      if ( !--npc->Wait_Timer )
        npc->Is_Alive = 0;
      break;
    case 0x50:
      npc->count1 = 0;
      npc->Current_State = 81;
      goto LABEL_82;
    case 0x51:
LABEL_82:
      if ( ++npc->count1 / 2 % 2 )
        npc->X_pos += 512;
      else
        npc->X_pos -= 512;
      npc->Ani_Num = 5;
      npc->X_vel = 0;
      npc->Y_vel += 32;
      break;
    case 0x64:
      npc->Current_State = 101;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 2;
      goto LABEL_87;
    case 0x65:
LABEL_87:
      if ( ++npc->Wait_Timer > 20 )
      {
        npc->Current_State = 102;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 3;
        npc->Y_vel = -2048;
        npc->Entity_Flags |= 8u;
        Kill_NPC(150, 0);
        Kill_NPC(117, 0);
        NPC_Create((NPC_Names)355, 0, 0, 0, 0, 0, npc, 256);
        NPC_Create((NPC_Names)355, 0, 0, 0, 0, Up, npc, 256);
      }
      break;
    case 0x66:
      X_Pos = npc->X_pos / 512 / 16;
      Y_Pos = npc->Y_pos / 512 / 16;
      if ( Y_Pos >= 0 && Y_Pos < 35 && Change_Map_Parts(X_Pos, Y_Pos, 0) )
      {
        Change_Map_Parts(X_Pos - 1, Y_Pos, 0);
        Change_Map_Parts(X_Pos + 1, Y_Pos, 0);
        Play_Sound_Effect(Sfx_Missile_Impact, 1);
        Set_Hard_Quake_Duration(10);
      }
      if ( npc->Y_pos < -16384 )
      {
        npc->Entity_Type = 0;
        Set_Quake(30);
      }
      break;
    default:
      break;
  }
  if ( npc->Curly_Target_X && !Random(0, 10) )
  {
    v5 = Random(-1536, 0);
    v6 = Random(-341, 341);
    v7 = npc->Y_pos + (Random(-12, 12) << 9);
    v8 = Random(-12, 12);
    NPC_Create(Smoke, npc->X_pos + (v8 << 9), v7, v6, v5, 0, NULL, 256);
  }
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 160;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 200;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 120;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 120;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 160;
  Rects_Left[3].bottom = 24;
  Rects_Left[4].left = 240;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 280;
  Rects_Left[4].bottom = 24;
  Rects_Left[5].left = 200;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 240;
  Rects_Left[5].bottom = 24;
  Rects_Left[6].left = 280;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 320;
  Rects_Left[6].bottom = 24;
  Rects_Left[7].left = 0;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 0;
  Rects_Left[7].bottom = 0;
  Rects_Left[8].left = 80;
  Rects_Left[8].top = 48;
  Rects_Left[8].right = 120;
  Rects_Left[8].bottom = 72;
  Rects_Left[9].left = 0;
  Rects_Left[9].top = 48;
  Rects_Left[9].right = 40;
  Rects_Left[9].bottom = 72;
  Rects_Left[10].left = 0;
  Rects_Left[10].top = 0;
  Rects_Left[10].right = 40;
  Rects_Left[10].bottom = 24;
  Rects_Left[11].left = 40;
  Rects_Left[11].top = 48;
  Rects_Left[11].right = 80;
  Rects_Left[11].bottom = 72;
  Rects_Left[12].left = 0;
  Rects_Left[12].top = 0;
  Rects_Left[12].right = 40;
  Rects_Left[12].bottom = 24;
  Rects_Left[13].left = 280;
  Rects_Left[13].top = 0;
  Rects_Left[13].right = 320;
  Rects_Left[13].bottom = 24;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 160;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 200;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 120;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 120;
  Rects_Right[3].top = 24;
  Rects_Right[3].right = 160;
  Rects_Right[3].bottom = 48;
  Rects_Right[4].left = 240;
  Rects_Right[4].top = 24;
  Rects_Right[4].right = 280;
  Rects_Right[4].bottom = 48;
  Rects_Right[5].left = 200;
  Rects_Right[5].top = 24;
  Rects_Right[5].right = 240;
  Rects_Right[5].bottom = 48;
  Rects_Right[6].left = 280;
  Rects_Right[6].top = 24;
  Rects_Right[6].right = 320;
  Rects_Right[6].bottom = 48;
  Rects_Right[7].left = 0;
  Rects_Right[7].top = 0;
  Rects_Right[7].right = 0;
  Rects_Right[7].bottom = 0;
  Rects_Right[8].left = 80;
  Rects_Right[8].top = 72;
  Rects_Right[8].right = 120;
  Rects_Right[8].bottom = 96;
  Rects_Right[9].left = 0;
  Rects_Right[9].top = 72;
  Rects_Right[9].right = 40;
  Rects_Right[9].bottom = 96;
  Rects_Right[10].left = 0;
  Rects_Right[10].top = 24;
  Rects_Right[10].right = 40;
  Rects_Right[10].bottom = 48;
  Rects_Right[11].left = 40;
  Rects_Right[11].top = 72;
  Rects_Right[11].right = 80;
  Rects_Right[11].bottom = 96;
  Rects_Right[12].left = 0;
  Rects_Right[12].top = 24;
  Rects_Right[12].right = 40;
  Rects_Right[12].bottom = 48;
  Rects_Right[13].left = 280;
  Rects_Right[13].top = 24;
  Rects_Right[13].right = 320;
  Rects_Right[13].bottom = 48;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
  if ( npc->Current_State == 71 )
  {
    npc->Rect.bottom = npc->Rect.top + npc->Wait_Timer / 2;
    if ( npc->Wait_Timer % 2 )
      ++npc->Rect.left;
  }
}

//----- (00429940) --------------------------------------------------------
// NPC 13 : Forcefield
void __cdecl NPC13_Forcefield(NPC_vars *npc)
{
  RECT Rects[4]; // [sp+0h] [bp-40h]@1

  Rects[0].left = 128;
  Rects[0].top = 0;
  Rects[0].right = 144;
  Rects[0].bottom = 16;
  Rects[1].left = 144;
  Rects[1].top = 0;
  Rects[1].right = 160;
  Rects[1].bottom = 16;
  Rects[2].left = 160;
  Rects[2].top = 0;
  Rects[2].right = 176;
  Rects[2].bottom = 16;
  Rects[3].left = 176;
  Rects[3].top = 0;
  Rects[3].right = 192;
  Rects[3].bottom = 16;
  if ( ++npc->ani_wait > 0 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 3 )
    npc->Ani_Num = 0;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (00429A30) --------------------------------------------------------
// NPC 14 : Santa's Key
// Can be found in Grasstown
void __cdecl NPC14_Santas_Key(NPC_vars *npc)
{
  int Rand_Y_Vel; // ST10_4@5
  int Rand_X_Vel; // ST0C_4@5
  int Rand_Y_Pos; // ST08_4@5
  int Rand_X_Pos; // eax@5
  signed int i; // [sp+4h] [bp-34h]@3
  RECT Rects[3]; // [sp+8h] [bp-30h]@1

  Rects[0].left = 192;
  Rects[0].top = 0;
  Rects[0].right = 208;
  Rects[0].bottom = 16;
  Rects[1].left = 208;
  Rects[1].top = 0;
  Rects[1].right = 224;
  Rects[1].bottom = 16;
  Rects[2].left = 224;
  Rects[2].top = 0;
  Rects[2].right = 240;
  Rects[2].bottom = 16;
  if ( !npc->Current_State )
  {
    npc->Current_State = 1;
    if ( npc->Direction == 2 )
    {
      npc->Y_vel = -512;
      for ( i = 0; i < 4; ++i )
      {
        Rand_Y_Vel = Random(-1536, 0);
        Rand_X_Vel = Random(-341, 341);
        Rand_Y_Pos = npc->Y_pos + (Random(-12, 12) << 9);
        Rand_X_Pos = Random(-12, 12);
        NPC_Create(Smoke, npc->X_pos + (Rand_X_Pos << 9), Rand_Y_Pos, Rand_X_Vel, Rand_Y_Vel, 0, NULL, 256);// Create some smoke
      }
    }
  }
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 2 )
    npc->Ani_Num = 0;
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->Y_pos += npc->Y_vel;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (00429BF0) --------------------------------------------------------
// NPC 15 : Treasure Chest, closed
void __cdecl NPC15_Treasure_Chest_Closed(NPC_vars *npc)
{
  int v1; // ST10_4@8
  int v2; // ST0C_4@8
  int v3; // ST08_4@8
  int v4; // eax@8
  int Npc_Current_State; // [sp+0h] [bp-38h]@1
  signed int i; // [sp+4h] [bp-34h]@6
  RECT Rects[3]; // [sp+8h] [bp-30h]@1

  Rects[0].left = 240;
  Rects[0].top = 0;
  Rects[0].right = 256;
  Rects[0].bottom = 16;
  Rects[1].left = 256;
  Rects[1].top = 0;
  Rects[1].right = 272;
  Rects[1].bottom = 16;
  Rects[2].left = 272;
  Rects[2].top = 0;
  Rects[2].right = 288;
  Rects[2].bottom = 16;
  Npc_Current_State = npc->Current_State;
  if ( !Npc_Current_State )
  {
    npc->Current_State = 1;
    npc->Entity_Flags |= 0x2000u;
    if ( npc->Direction == 2 )
    {
      npc->Y_vel = -512;
      for ( i = 0; i < 4; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = npc->Y_pos + (Random(-12, 12) << 9);
        v4 = Random(-12, 12);
        NPC_Create(Smoke, npc->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
    }
  }
  else if ( Npc_Current_State != 1 )
  {
    if ( Npc_Current_State == 2 )
    {
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 2 )
      {
        npc->Ani_Num = 0;
        npc->Current_State = 1;
      }
    }
    goto LABEL_16;
  }
  npc->Ani_Num = 0;
  if ( !Random(0, 30) )
    npc->Current_State = 2;
LABEL_16:
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->Y_pos += npc->Y_vel;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (00429E00) --------------------------------------------------------
void __cdecl NPC16(NPC_vars *npc)
{
  int Y_vel_Child; // ST10_4@7
  int X_Vel_Child; // ST0C_4@7
  int Y_Pos_Child; // ST08_4@7
  int X_Pos_Child; // eax@7
  int npc_Current_State; // [sp+0h] [bp-88h]@1
  signed int i; // [sp+4h] [bp-84h]@5
  RECT Rects[8]; // [sp+8h] [bp-80h]@1

  Rects[0].left = 96;
  Rects[0].top = 16;
  Rects[0].right = 112;
  Rects[0].bottom = 32;
  Rects[1].left = 112;
  Rects[1].top = 16;
  Rects[1].right = 128;
  Rects[1].bottom = 32;
  Rects[2].left = 128;
  Rects[2].top = 16;
  Rects[2].right = 144;
  Rects[2].bottom = 32;
  Rects[3].left = 144;
  Rects[3].top = 16;
  Rects[3].right = 160;
  Rects[3].bottom = 32;
  Rects[4].left = 160;
  Rects[4].top = 16;
  Rects[4].right = 176;
  Rects[4].bottom = 32;
  Rects[5].left = 176;
  Rects[5].top = 16;
  Rects[5].right = 192;
  Rects[5].bottom = 32;
  Rects[6].left = 192;
  Rects[6].top = 16;
  Rects[6].right = 208;
  Rects[6].bottom = 32;
  Rects[7].left = 208;
  Rects[7].top = 16;
  Rects[7].right = 224;
  Rects[7].bottom = 32;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
      goto LABEL_10;
  }
  else
  {
    npc->Entity_Flags |= 0x2000u;
    npc->Current_State = 1;
    if ( npc->Direction == 2 )
    {
      npc->Entity_Flags &= 0xDFFFu;
      npc->Y_vel = -512;
      for ( i = 0; i < 4; ++i )
      {
        Y_vel_Child = Random(-1536, 0);
        X_Vel_Child = Random(-341, 341);
        Y_Pos_Child = npc->Y_pos + (Random(-12, 12) << 9);
        X_Pos_Child = Random(-12, 12);
        NPC_Create(Smoke, npc->X_pos + (X_Pos_Child << 9), Y_Pos_Child, X_Vel_Child, Y_vel_Child, 0, NULL, 256);
      }
    }
  }
  if ( npc->Collision_flags & 8 )
    npc->Entity_Flags |= 0x2000u;
LABEL_10:
  if ( ++npc->ani_wait > 2 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 7 )
    npc->Ani_Num = 0;
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->Y_pos += npc->Y_vel;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042A0B0) --------------------------------------------------------
void __cdecl NPC17(NPC_vars *npc)
{
  int v1; // ST10_4@5
  int v2; // ST0C_4@5
  int v3; // ST08_4@5
  int v4; // eax@5
  RECT *Cur_Rect; // eax@12 MAPDST
  signed int i; // [sp+24h] [bp-4h]@3
  int ia; // [sp+24h] [bp-4h]@6

  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      if ( npc->Direction == 2 )
      {
        npc->Y_vel = -512;
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = npc->Y_pos + (Random(-12, 12) << 9);
          v4 = Random(-12, 12);
          NPC_Create(Smoke, npc->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
      }
      goto LABEL_6;
    case 1:
LABEL_6:
      ia = Random(0, 30);
      if ( ia >= 10 )
      {
        if ( ia >= 25 )
          npc->Current_State = 4;
        else
          npc->Current_State = 3;
      }
      else
      {
        npc->Current_State = 2;
      }
      npc->Wait_Timer = Random(16, 64);
      npc->ani_wait = 0;
      break;
    case 2:
      Cur_Rect = &npc->Rect;
      Cur_Rect->left = 288;
      Cur_Rect->top = 0;
      Cur_Rect->right = 304;
      Cur_Rect->bottom = 16;
      if ( !--npc->Wait_Timer )
        npc->Current_State = 1;
      break;
    case 3:
      if ( ++npc->ani_wait % 2 )
      {
        Cur_Rect = &npc->Rect;
        Cur_Rect->left = 288;
        Cur_Rect->top = 0;
        Cur_Rect->right = 304;
        Cur_Rect->bottom = 16;
      }
      else
      {
        Cur_Rect = &npc->Rect;
        Cur_Rect->left = 304;
        Cur_Rect->top = 0;
        Cur_Rect->right = 320;
        Cur_Rect->bottom = 16;
      }
      if ( !--npc->Wait_Timer )
        npc->Current_State = 1;
      break;
    case 4:
      Cur_Rect = &npc->Rect;
      Cur_Rect->left = 304;
      Cur_Rect->top = 0;
      Cur_Rect->right = 320;
      Cur_Rect->bottom = 16;
      if ( !--npc->Wait_Timer )
        npc->Current_State = 1;
      break;
    default:
      break;
  }
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->Y_pos += npc->Y_vel;
}

//----- (0042A360) --------------------------------------------------------
void __cdecl NPC18(NPC_vars *npc)
{
  int Child_Y_Vel; // ST10_4@10
  int Child_X_Vel; // eax@10
  RECT *npc_Rect; // eax@11 MAPDST
  int npc_Current_State; // [sp+0h] [bp-28h]@1
  signed int i; // [sp+4h] [bp-24h]@8

  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State == 1 )
    {
      for ( i = 0; i < 4; ++i )
      {
        Child_Y_Vel = Random(-1536, 0);
        Child_X_Vel = Random(-341, 341);
        NPC_Create(Smoke, npc->X_pos, npc->Y_pos, Child_X_Vel, Child_Y_Vel, 0, NULL, 256);
      }
      npc->Current_State = 0;
      npc_Rect = &npc->Rect;
      npc_Rect->left = 224;
      npc_Rect->top = 16;
      npc_Rect->right = 240;
      npc_Rect->bottom = 40;
    }
  }
  else if ( !npc->Direction )
  {
    npc_Rect = &npc->Rect;
    // Left Rects
    npc_Rect->left = 224;
    npc_Rect->top = 16;
    npc_Rect->right = 240;
    npc_Rect->bottom = 40;
  }
  else
  {
    npc_Rect = &npc->Rect;
    // Right Rects
    npc_Rect->left = 192;
    npc_Rect->top = 112;
    npc_Rect->right = 208;
    npc_Rect->bottom = 136;
  }
}

//----- (0042A490) --------------------------------------------------------
void __cdecl NPC19(NPC_vars *npc)
{
  int Child_Y_Vel; // ST10_4@4
  int Child_X_Vel; // ST0C_4@4
  int Child_Y_Pos; // ST08_4@4
  int Child_X_Pos; // eax@4
  RECT Rects_Right[4]; // [sp+4h] [bp-88h]@22
  RECT Rects_Left[4]; // [sp+44h] [bp-48h]@22
  int i; // [sp+88h] [bp-4h]@2

  switch ( npc->Current_State )
  {
    case 0:
      for ( i = 0; i < 16; ++i )
      {
        Child_Y_Vel = Random(-1536, 0);
        Child_X_Vel = Random(-341, 341);
        Child_Y_Pos = npc->Y_pos + (Random(-12, 12) << 9);
        Child_X_Pos = Random(-12, 12);
        NPC_Create(Smoke, npc->X_pos + (Child_X_Pos << 9), Child_Y_Pos, Child_X_Vel, Child_Y_Vel, 0, NULL, 256);
      }
      npc->Y_pos += 5120;
      npc->Current_State = 1;
      npc->Ani_Num = 3;
      npc->Y_vel = -256;
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      Set_Quake(30);
      goto LABEL_6;
    case 1:
LABEL_6:
      npc->Y_vel += 16;
      if ( npc->Y_vel > 0 && npc->Collision_flags & 8 )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 2;
        npc->Wait_Timer = 0;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 16 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 0;
        npc->ani_wait = 0;
      }
      break;
    case 3:
      if ( !Random(0, 100) )
      {
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      break;
    case 4:
      if ( ++npc->Wait_Timer > 16 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 0;
      }
      break;
    default:
      break;
  }
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  if ( npc->Y_vel < -1535 )
    npc->Y_vel = -1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 160;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 200;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 120;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 120;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 160;
  Rects_Left[3].bottom = 24;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 160;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 200;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 120;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 120;
  Rects_Right[3].top = 24;
  Rects_Right[3].right = 160;
  Rects_Right[3].bottom = 48;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042A830) --------------------------------------------------------
void __cdecl NPC20(NPC_vars *npc)
{
  RECT Rects_Right[3]; // [sp+0h] [bp-40h]@1
  RECT Rects_Left; // [sp+30h] [bp-10h]@1

  Rects_Left.left = 288;
  Rects_Left.top = 16;
  Rects_Left.right = 320;
  Rects_Left.bottom = 40;
  Rects_Right[0].left = 288;
  Rects_Right[0].top = 40;
  Rects_Right[0].right = 320;
  Rects_Right[0].bottom = 64;
  Rects_Right[1].left = 288;
  Rects_Right[1].top = 40;
  Rects_Right[1].right = 320;
  Rects_Right[1].bottom = 64;
  Rects_Right[2].left = 288;
  Rects_Right[2].top = 64;
  Rects_Right[2].right = 320;
  Rects_Right[2].bottom = 88;
  if ( ++npc->ani_wait > 3 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 2 )
    npc->Ani_Num = 0;
  if ( npc->Direction )
    npc->Rect = Rects_Right[npc->Ani_Num];
  else
    npc->Rect = Rects_Left;
}

//----- (0042A940) --------------------------------------------------------
void __cdecl NPC21(NPC_vars *npc)
{
  RECT *npc_Rect; // eax@4

  if ( !npc->Current_State )
  {
    npc->Current_State = 1;
    if ( npc->Direction == 2 )
      npc->Y_pos += 0x2000;
  }
  npc_Rect = &npc->Rect;
  npc_Rect->left = 224;
  npc_Rect->top = 40;
  npc_Rect->right = 240;
  npc_Rect->bottom = 48;
}

//----- (0042A9C0) --------------------------------------------------------
void __cdecl NPC22(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-24h]@1
  RECT Rects[2]; // [sp+4h] [bp-20h]@1

  Rects[0].left = 240;
  Rects[0].top = 16;
  Rects[0].right = 264;
  Rects[0].bottom = 48;
  Rects[1].left = 248;
  Rects[1].top = 152;
  Rects[1].right = 272;
  Rects[1].bottom = 184;
  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    npc->Ani_Num = 0;
  }
  else if ( npc_Current_State == 1 && ++npc->Ani_Num > 1 )
  {
    npc->Ani_Num = 0;
  }
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042AA70) --------------------------------------------------------
void __cdecl NPC23(NPC_vars *npc)
{
  RECT Rects[8]; // [sp+0h] [bp-80h]@1

  Rects[0].left = 264;
  Rects[0].top = 16;
  Rects[0].right = 288;
  Rects[0].bottom = 20;
  Rects[1].left = 264;
  Rects[1].top = 20;
  Rects[1].right = 288;
  Rects[1].bottom = 24;
  Rects[2].left = 264;
  Rects[2].top = 24;
  Rects[2].right = 288;
  Rects[2].bottom = 28;
  Rects[3].left = 264;
  Rects[3].top = 28;
  Rects[3].right = 288;
  Rects[3].bottom = 32;
  Rects[4].left = 264;
  Rects[4].top = 32;
  Rects[4].right = 288;
  Rects[4].bottom = 36;
  Rects[5].left = 264;
  Rects[5].top = 36;
  Rects[5].right = 288;
  Rects[5].bottom = 40;
  Rects[6].left = 264;
  Rects[6].top = 40;
  Rects[6].right = 288;
  Rects[6].bottom = 44;
  Rects[7].left = 264;
  Rects[7].top = 44;
  Rects[7].right = 288;
  Rects[7].bottom = 48;
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 7 )
    npc->Ani_Num = 0;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042ABD0) --------------------------------------------------------
void __cdecl NPC24(NPC_vars *npc)
{
  RECT Rects_Right[6]; // [sp+4h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+64h] [bp-60h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 24;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 24;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 48;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 48;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 72;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 72;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 96;
  Rects_Left[3].bottom = 24;
  Rects_Left[4].left = 96;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 120;
  Rects_Left[4].bottom = 24;
  Rects_Left[5].left = 120;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 144;
  Rects_Left[5].bottom = 24;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 24;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 24;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 48;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 48;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 72;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 72;
  Rects_Right[3].top = 24;
  Rects_Right[3].right = 96;
  Rects_Right[3].bottom = 48;
  Rects_Right[4].left = 96;
  Rects_Right[4].top = 24;
  Rects_Right[4].right = 120;
  Rects_Right[4].bottom = 48;
  Rects_Right[5].left = 120;
  Rects_Right[5].top = 24;
  Rects_Right[5].right = 144;
  Rects_Right[5].bottom = 48;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Y_pos += 1536;
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( npc->Wait_Timer < 8
        || npc->X_pos - 0x10000 >= Quote.X_Pos
        || npc->X_pos + 0x10000 <= Quote.X_Pos
        || npc->Y_pos - 0x10000 >= Quote.Y_Pos
        || npc->Y_pos + 0x6000 <= Quote.Y_Pos )
      {
        if ( npc->Wait_Timer < 8 )
          ++npc->Wait_Timer;
        npc->Ani_Num = 0;
      }
      else
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
        npc->Ani_Num = 1;
      }
      if ( npc->Is_Being_Hit )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      if ( npc->Wait_Timer >= 8
        && npc->X_pos - 0xC000 < Quote.X_Pos
        && npc->X_pos + 0xC000 > Quote.X_Pos
        && npc->Y_pos - 0xC000 < Quote.Y_Pos
        && npc->Y_pos + 0x6000 > Quote.Y_Pos )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 2;
        npc->Y_vel = -1535;
        Play_Sound_Effect(Sfx_Power_Critter_Large_Enemy_Jump, 1);
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
        if ( npc->Direction )
          npc->X_vel = 256;
        else
          npc->X_vel = -256;
      }
      break;
    case 3:
      if ( npc->Y_vel > 512 )
      {
        npc->Curly_Target_Y = npc->Y_pos;
        npc->Current_State = 4;
        npc->Ani_Num = 3;
        npc->Wait_Timer = 0;
        npc->Wait_Timer = 0;
      }
      break;
    case 4:
      if ( npc->X_pos >= Quote.X_Pos )
        npc->Direction = 0;
      else
        npc->Direction = 2;
      ++npc->Wait_Timer;
      if ( npc->Collision_flags & 7 || npc->Wait_Timer > 100 )
      {
        npc->Damage = 12;
        npc->Current_State = 5;
        npc->Ani_Num = 2;
        npc->X_vel /= 2;
      }
      else
      {
        if ( npc->Wait_Timer % 4 == 1 )
          Play_Sound_Effect(Sfx_Power_Critter_Flys, 1);
        if ( ++npc->ani_wait > 0 )
        {
          npc->ani_wait = 0;
          ++npc->Ani_Num;
        }
        if ( npc->Ani_Num > 5 )
          npc->Ani_Num = 3;
      }
      break;
    case 5:
      if ( npc->Collision_flags & 8 )
      {
        npc->Damage = 2;
        npc->X_vel = 0;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->Current_State = 1;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
      }
      break;
    default:
      break;
  }
  if ( npc->Current_State == 4 )
  {
    if ( npc->X_pos >= Quote.X_Pos )
      npc->X_vel -= 32;
    else
      npc->X_vel += 32;
    if ( npc->Y_pos <= npc->Curly_Target_Y )
      npc->Y_vel += 16;
    else
      npc->Y_vel -= 16;
    if ( npc->Y_vel > 512 )
      npc->Y_vel = 512;
    if ( npc->Y_vel < -512 )
      npc->Y_vel = -512;
    if ( npc->X_vel > 512 )
      npc->X_vel = 512;
    if ( npc->X_vel < -512 )
      npc->X_vel = -512;
  }
  else
  {
    npc->Y_vel += 32;
    if ( npc->Y_vel > 1535 )
      npc->Y_vel = 1535;
  }
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042B280) --------------------------------------------------------
void __cdecl NPC25(NPC_vars *npc)
{
  RECT Rects[2]; // [sp+8h] [bp-20h]@1

  Rects[0].left = 256;
  Rects[0].top = 64;
  Rects[0].right = 288;
  Rects[0].bottom = 80;
  Rects[1].left = 256;
  Rects[1].top = 80;
  Rects[1].right = 288;
  Rects[1].bottom = 96;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      npc->X_pos += 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++npc->Wait_Timer > 150 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 64 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      else
      {
        npc->Y_pos -= 512;
      }
      break;
    case 3:
      if ( ++npc->Wait_Timer > 150 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      break;
    case 4:
      if ( ++npc->Wait_Timer > 64 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      else
      {
        npc->Y_pos -= 512;
      }
      break;
    case 5:
      if ( ++npc->Wait_Timer > 150 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      break;
    case 6:
      if ( ++npc->Wait_Timer > 64 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      else
      {
        npc->Y_pos += 512;
      }
      break;
    case 7:
      if ( ++npc->Wait_Timer > 150 )
      {
        npc->Wait_Timer = 0;
        ++npc->Current_State;
      }
      break;
    case 8:
      if ( ++npc->Wait_Timer > 64 )
      {
        npc->Wait_Timer = 0;
        npc->Current_State = 1;
      }
      else
      {
        npc->Y_pos += 512;
      }
      break;
    default:
      break;
  }
  switch ( npc->Current_State )
  {
    case 2:
    case 4:
    case 6:
    case 8:
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 1 )
        npc->Ani_Num = 0;
      break;
    default:
      break;
  }
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042B5E0) --------------------------------------------------------
void __cdecl NPC26(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-8Ch]@1
  RECT Rects_Right[4]; // [sp+4h] [bp-88h]@37
  RECT Rects_Left[4]; // [sp+44h] [bp-48h]@37
  unsigned __int8 rand_Y_Pos; // [sp+8Bh] [bp-1h]@5

  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    rand_Y_Pos = Random(0, 255);
    npc->X_vel = GetCos(rand_Y_Pos);
    npc->Curly_Target_X = npc->X_pos + 8 * GetCos(rand_Y_Pos + 64);
    rand_Y_Pos = Random(0, 255);
    npc->Y_vel = GetSin(rand_Y_Pos);
    rand_Y_Pos += 64;
    npc->Curly_Target_Y = npc->Y_pos + 8 * GetSin(rand_Y_Pos);
    npc->Current_State = 1;
    npc->count1 = 120;
  }
  else if ( npc_Current_State != 1 )
  {
    if ( npc_Current_State == 3 )
    {
      npc->Y_vel += 64;
      if ( npc->Y_vel > 1535 )
        npc->Y_vel = 1535;
      if ( npc->Collision_flags & 8 )
      {
        npc->Y_vel = 0;
        npc->X_vel *= 2;
        npc->count1 = 0;
        npc->Current_State = 1;
        npc->Entity_Flags |= 8u;
      }
    }
    goto LABEL_37;
  }
  if ( Quote.X_Pos >= npc->X_pos )
    npc->Direction = 2;
  else
    npc->Direction = 0;
  if ( npc->Curly_Target_X < npc->X_pos )
    npc->X_vel -= 16;
  if ( npc->Curly_Target_X > npc->X_pos )
    npc->X_vel += 16;
  if ( npc->Curly_Target_Y < npc->Y_pos )
    npc->Y_vel -= 16;
  if ( npc->Curly_Target_Y > npc->Y_pos )
    npc->Y_vel += 16;
  if ( npc->X_vel > 512 )
    npc->X_vel = 512;
  if ( npc->X_vel < -512 )
    npc->X_vel = -512;
  if ( npc->Y_vel > 512 )
    npc->Y_vel = 512;
  if ( npc->Y_vel < -512 )
    npc->Y_vel = -512;
  if ( npc->count1 >= 120 )
  {
    if ( npc->X_pos - 4096 < Quote.X_Pos
      && npc->X_pos + 4096 > Quote.X_Pos
      && npc->Y_pos < Quote.Y_Pos
      && npc->Y_pos + 49152 > Quote.Y_Pos )
    {
      npc->X_vel /= 2;
      npc->Y_vel = 0;
      npc->Current_State = 3;
      npc->Entity_Flags &= 0xFFF7u;
    }
  }
  else
  {
    ++npc->count1;
  }
LABEL_37:
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 32;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 48;
  Rects_Left[0].bottom = 96;
  Rects_Left[1].left = 48;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 64;
  Rects_Left[1].bottom = 96;
  Rects_Left[2].left = 64;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 80;
  Rects_Left[2].bottom = 96;
  Rects_Left[3].left = 80;
  Rects_Left[3].top = 80;
  Rects_Left[3].right = 96;
  Rects_Left[3].bottom = 96;
  Rects_Right[0].left = 32;
  Rects_Right[0].top = 96;
  Rects_Right[0].right = 48;
  Rects_Right[0].bottom = 112;
  Rects_Right[1].left = 48;
  Rects_Right[1].top = 96;
  Rects_Right[1].right = 64;
  Rects_Right[1].bottom = 112;
  Rects_Right[2].left = 64;
  Rects_Right[2].top = 96;
  Rects_Right[2].right = 80;
  Rects_Right[2].bottom = 112;
  Rects_Right[3].left = 80;
  Rects_Right[3].top = 96;
  Rects_Right[3].right = 96;
  Rects_Right[3].bottom = 112;
  if ( npc->Current_State == 3 )
  {
    npc->Ani_Num = 3;
  }
  else
  {
    if ( ++npc->ani_wait > 1 )
    {
      npc->ani_wait = 0;
      ++npc->Ani_Num;
    }
    if ( npc->Ani_Num > 2 )
      npc->Ani_Num = 0;
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042BA90) --------------------------------------------------------
void __cdecl NPC27(NPC_vars *npc)
{
  char *v1; // edx@1 MAPDST
  RECT Rects[1]; // [sp+0h] [bp-10h]@1

  Rects[0].left = 96;
  Rects[0].top = 64;
  Rects[0].right = 128;
  Rects[0].bottom = 88;
  v1 = (char *)&Rects[npc->Ani_Num];
  v1 = (char *)&npc->Rect;
  *(_DWORD *)v1 = *(_DWORD *)v1;
  *((_DWORD *)v1 + 1) = *((_DWORD *)v1 + 1);
  *((_DWORD *)v1 + 2) = *((_DWORD *)v1 + 2);
  *((_DWORD *)v1 + 3) = *((_DWORD *)v1 + 3);
}

//----- (0042BAE0) --------------------------------------------------------
void __cdecl NPC28(NPC_vars *npc)
{
  RECT Rects_Right[6]; // [sp+4h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+64h] [bp-60h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 48;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 64;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 48;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 64;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 48;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 64;
  Rects_Left[3].left = 48;
  Rects_Left[3].top = 48;
  Rects_Left[3].right = 64;
  Rects_Left[3].bottom = 64;
  Rects_Left[4].left = 64;
  Rects_Left[4].top = 48;
  Rects_Left[4].right = 80;
  Rects_Left[4].bottom = 64;
  Rects_Left[5].left = 80;
  Rects_Left[5].top = 48;
  Rects_Left[5].right = 96;
  Rects_Left[5].bottom = 64;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 64;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 80;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 64;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 80;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 64;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 80;
  Rects_Right[3].left = 48;
  Rects_Right[3].top = 64;
  Rects_Right[3].right = 64;
  Rects_Right[3].bottom = 80;
  Rects_Right[4].left = 64;
  Rects_Right[4].top = 64;
  Rects_Right[4].right = 80;
  Rects_Right[4].bottom = 80;
  Rects_Right[5].left = 80;
  Rects_Right[5].top = 64;
  Rects_Right[5].right = 96;
  Rects_Right[5].bottom = 80;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Y_pos += 1536;
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( npc->Wait_Timer < 8
        || npc->X_pos - 0x10000 >= Quote.X_Pos
        || npc->X_pos + 0x10000 <= Quote.X_Pos
        || npc->Y_pos - 0x10000 >= Quote.Y_Pos
        || npc->Y_pos + 24576 <= Quote.Y_Pos )
      {
        if ( npc->Wait_Timer < 8 )
          ++npc->Wait_Timer;
        npc->Ani_Num = 0;
      }
      else
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
        npc->Ani_Num = 1;
      }
      if ( npc->Is_Being_Hit )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      if ( npc->Wait_Timer >= 8
        && npc->X_pos - 49152 < Quote.X_Pos
        && npc->X_pos + 49152 > Quote.X_Pos
        && npc->Y_pos - 49152 < Quote.Y_Pos
        && npc->Y_pos + 24576 > Quote.Y_Pos )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 2;
        npc->Y_vel = -1228;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
        if ( npc->Direction )
          npc->X_vel = 256;
        else
          npc->X_vel = -256;
      }
      break;
    case 3:
      if ( npc->Y_vel > 256 )
      {
        npc->Curly_Target_Y = npc->Y_pos;
        npc->Current_State = 4;
        npc->Ani_Num = 3;
        npc->Wait_Timer = 0;
        npc->Wait_Timer = 0;
      }
      break;
    case 4:
      if ( npc->X_pos >= Quote.X_Pos )
        npc->Direction = 0;
      else
        npc->Direction = 2;
      ++npc->Wait_Timer;
      if ( npc->Collision_flags & 7 || npc->Wait_Timer > 100 )
      {
        npc->Damage = 3;
        npc->Current_State = 5;
        npc->Ani_Num = 2;
        npc->X_vel /= 2;
      }
      else
      {
        if ( npc->Wait_Timer % 4 == 1 )
          Play_Sound_Effect(Sfx_Critter_Fly, 1);
        if ( npc->Collision_flags & 8 )
          npc->Y_vel = -512;
        if ( ++npc->ani_wait > 0 )
        {
          npc->ani_wait = 0;
          ++npc->Ani_Num;
        }
        if ( npc->Ani_Num > 5 )
          npc->Ani_Num = 3;
      }
      break;
    case 5:
      if ( npc->Collision_flags & 8 )
      {
        npc->Damage = 2;
        npc->X_vel = 0;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->Current_State = 1;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    default:
      break;
  }
  if ( npc->Current_State == 4 )
  {
    if ( npc->X_pos >= Quote.X_Pos )
      npc->X_vel -= 32;
    else
      npc->X_vel += 32;
    if ( npc->Y_pos <= npc->Curly_Target_Y )
      npc->Y_vel += 16;
    else
      npc->Y_vel -= 16;
    if ( npc->Y_vel > 512 )
      npc->Y_vel = 512;
    if ( npc->Y_vel < -512 )
      npc->Y_vel = -512;
    if ( npc->X_vel > 512 )
      npc->X_vel = 512;
    if ( npc->X_vel < -512 )
      npc->X_vel = -512;
  }
  else
  {
    npc->Y_vel += 64;
    if ( npc->Y_vel > 1535 )
      npc->Y_vel = 1535;
  }
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042C1A0) --------------------------------------------------------
void __cdecl NPC29(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-44h]@1
  RECT Rects_Right[2]; // [sp+4h] [bp-40h]@1
  RECT Rects_Left[2]; // [sp+24h] [bp-20h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 192;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 216;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 192;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 216;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 216;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 240;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 216;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 240;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
      goto LABEL_11;
  }
  else
  {
    npc->Current_State = 1;
    npc->Ani_Num = 0;
    npc->ani_wait = 0;
  }
  npc->Ani_Num = npc->X_pos - 24576 < Quote.X_Pos
              && npc->X_pos + 24576 > Quote.X_Pos
              && npc->Y_pos - 24576 < Quote.Y_Pos
              && npc->Y_pos + 0x2000 > Quote.Y_Pos;
LABEL_11:
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042C320) --------------------------------------------------------
void __cdecl NPC30(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-34h]@2
  RECT Rects[3]; // [sp+4h] [bp-30h]@1

  Rects[0].left = 48;
  Rects[0].top = 0;
  Rects[0].right = 64;
  Rects[0].bottom = 16;
  Rects[1].left = 48;
  Rects[1].top = 16;
  Rects[1].right = 64;
  Rects[1].bottom = 32;
  Rects[2].left = 0;
  Rects[2].top = 32;
  Rects[2].right = 16;
  Rects[2].bottom = 48;
  if ( !npc->Direction )
  {
    npc_Current_State = npc->Current_State;
    if ( !npc_Current_State )
    {
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
    }
    else if ( npc_Current_State != 1 )
    {
      if ( npc_Current_State == 2 && ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      goto LABEL_17;
    }
    if ( Random(0, 120) == 10 )
    {
      npc->Current_State = 2;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 1;
    }
  }
  else
  {
    if ( !npc->Current_State )
    {
      npc->Current_State = 1;
      npc->Y_pos += 0x2000;
      npc->Ani_Num = 2;
    }
    if ( ++npc->Wait_Timer > 100 )
    {
      npc->Wait_Timer = 0;
      Create_Effect(npc->X_pos, npc->Y_pos - 1024, 5, 0);
    }
  }
LABEL_17:
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042C4C0) --------------------------------------------------------
void __cdecl NPC31(NPC_vars *npc)
{
  RECT Rects_Right[5]; // [sp+4h] [bp-A0h]@1
  RECT Rects_Left[5]; // [sp+54h] [bp-50h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 96;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 96;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 96;
  Rects_Left[3].left = 48;
  Rects_Left[3].top = 80;
  Rects_Left[3].right = 64;
  Rects_Left[3].bottom = 96;
  Rects_Left[4].left = 64;
  Rects_Left[4].top = 80;
  Rects_Left[4].right = 80;
  Rects_Left[4].bottom = 96;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 96;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 112;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 96;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 112;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 96;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 112;
  Rects_Right[3].left = 48;
  Rects_Right[3].top = 96;
  Rects_Right[3].right = 64;
  Rects_Right[3].bottom = 112;
  Rects_Right[4].left = 64;
  Rects_Right[4].top = 96;
  Rects_Right[4].right = 80;
  Rects_Right[4].bottom = 112;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      if ( npc->X_pos - 4096 < Quote.X_Pos
        && npc->X_pos + 4096 > Quote.X_Pos
        && npc->Y_pos - 4096 < Quote.Y_Pos
        && npc->Y_pos + 49152 > Quote.Y_Pos )
      {
        npc->Ani_Num = 0;
        npc->Current_State = 3;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 3:
      npc->Ani_Num = 0;
      if ( npc->Is_Being_Hit || npc->X_pos - 10240 > Quote.X_Pos || npc->X_pos + 10240 < Quote.X_Pos )
      {
        npc->Ani_Num = 1;
        npc->ani_wait = 0;
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
      }
      break;
    case 4:
      npc->Y_vel += 32;
      if ( npc->Y_vel > 1535 )
        npc->Y_vel = 1535;
      if ( (++npc->Wait_Timer >= 20 || npc->Collision_flags & 8)
        && (npc->Collision_flags & 8 || npc->Y_pos > Quote.Y_Pos - 0x2000) )
      {
        npc->ani_wait = 0;
        npc->Ani_Num = 2;
        npc->Current_State = 5;
        npc->Curly_Target_Y = npc->Y_pos;
        if ( npc->Collision_flags & 8 )
          npc->Y_vel = -512;
      }
      break;
    case 5:
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 4 )
        npc->Ani_Num = 2;
      if ( Quote.X_Pos >= npc->X_pos )
        npc->Direction = 2;
      else
        npc->Direction = 0;
      if ( Quote.X_Pos < npc->X_pos )
        npc->X_vel -= 16;
      if ( Quote.X_Pos > npc->X_pos )
        npc->X_vel += 16;
      if ( npc->Curly_Target_Y < npc->Y_pos )
        npc->Y_vel -= 16;
      if ( npc->Curly_Target_Y > npc->Y_pos )
        npc->Y_vel += 16;
      if ( npc->X_vel > 512 )
        npc->X_vel = 512;
      if ( npc->X_vel < -512 )
        npc->X_vel = -512;
      if ( npc->Y_vel > 512 )
        npc->Y_vel = 512;
      if ( npc->Y_vel < -512 )
        npc->Y_vel = -512;
      if ( npc->Collision_flags & 8 )
        npc->Y_vel = -512;
      if ( npc->Collision_flags & 2 )
        npc->Y_vel = 512;
      break;
    default:
      break;
  }
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042CA10) --------------------------------------------------------
void __cdecl NPC32(NPC_vars *npc)
{
  RECT Rects[2]; // [sp+0h] [bp-20h]@1

  Rects[0].left = 32;
  Rects[0].top = 96;
  Rects[0].right = 48;
  Rects[0].bottom = 112;
  Rects[1].left = 48;
  Rects[1].top = 96;
  Rects[1].right = 64;
  Rects[1].bottom = 112;
  if ( ++npc->ani_wait > 2 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 1 )
    npc->Ani_Num = 0;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042CAC0) --------------------------------------------------------
void __cdecl NPC33(NPC_vars *npc)
{
  RECT Rects[2]; // [sp+0h] [bp-20h]@5

  if ( npc->Collision_flags & 5 )
  {
    Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
    npc->Is_Alive = 0;
  }
  else if ( npc->Collision_flags & 8 )
  {
    npc->Y_vel = -1024;
  }
  npc->Y_vel += 42;
  npc->Y_pos += npc->Y_vel;
  npc->X_pos += npc->X_vel;
  Rects[0].left = 240;
  Rects[0].top = 64;
  Rects[0].right = 256;
  Rects[0].bottom = 80;
  Rects[1].left = 240;
  Rects[1].top = 80;
  Rects[1].right = 256;
  Rects[1].bottom = 96;
  if ( ++npc->ani_wait > 2 )
  {
    npc->ani_wait = 0;
    if ( ++npc->Ani_Num > 1 )
      npc->Ani_Num = 0;
  }
  npc->Rect = Rects[npc->Ani_Num];
  if ( ++npc->Wait_Timer > 250 )
  {
    Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
    npc->Is_Alive = 0;                          // NPC suicides after 250 frames
  }
}

//----- (0042CC20) --------------------------------------------------------
void __cdecl NPC34(NPC_vars *npc)
{
  RECT *npc_Rect; // ecx@3 MAPDST

  if ( !npc->Direction )
  {
    npc_Rect = &npc->Rect;
    npc_Rect->left = 192;
    npc_Rect->top = 48;
    npc_Rect->right = 224;
    npc_Rect->bottom = 64;
  }
  else
  {
    npc_Rect = &npc->Rect;
    npc_Rect->left = 192;
    npc_Rect->top = 184;
    npc_Rect->right = 224;
    npc_Rect->bottom = 200;
  }
}

//----- (0042CCB0) --------------------------------------------------------
void __cdecl NPC35(NPC_vars *npc)
{
  RECT Rects_Right[4]; // [sp+4h] [bp-80h]@22
  RECT Rects_Left[4]; // [sp+44h] [bp-40h]@22

  if ( npc->Current_State < 3 && npc->Life < 90 )
  {
    Play_Sound_Effect(Sfx_Quote_Smash_Into_Ground, 1);
    Create_Dust_Clouds(npc->X_pos, npc->Y_pos, npc->view.back, 8);
    Spawn_Exp(npc->X_pos, npc->Y_pos, npc->EXP_Amount);
    npc->Current_State = 3;
    npc->Wait_Timer = 0;
    npc->Ani_Num = 2;
    npc->Entity_Flags &= 0xFFDFu;
    npc->Damage = 0;
  }
  switch ( npc->Current_State )
  {
    case 0:
    case 1:
      if ( npc->Is_Being_Hit )
      {
        if ( npc->Direction )
          NPC_Create(
            Enemy_Basil|0x60,
            npc->X_pos + 4096,
            npc->Y_pos + 4096,
            0,
            0,
            (Directions)npc->Direction,
            NULL,
            256);
        else
          NPC_Create(
            Enemy_Basil|0x60,
            npc->X_pos - 4096,
            npc->Y_pos + 4096,
            0,
            0,
            (Directions)npc->Direction,
            NULL,
            256);
        npc->Ani_Num = 1;
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 20 )
      {
        npc->Wait_Timer = 0;
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 3:
      if ( ++npc->Wait_Timer == 50 || npc->Wait_Timer == 60 )
        npc->Ani_Num = 3;
      if ( npc->Wait_Timer == 53 || npc->Wait_Timer == 63 )
        npc->Ani_Num = 2;
      if ( npc->Wait_Timer > 100 )
        npc->Current_State = 4;
      break;
    default:
      break;
  }
  Rects_Left[0].left = 96;
  Rects_Left[0].top = 64;
  Rects_Left[0].right = 120;
  Rects_Left[0].bottom = 96;
  Rects_Left[1].left = 120;
  Rects_Left[1].top = 64;
  Rects_Left[1].right = 144;
  Rects_Left[1].bottom = 96;
  Rects_Left[2].left = 144;
  Rects_Left[2].top = 64;
  Rects_Left[2].right = 168;
  Rects_Left[2].bottom = 96;
  Rects_Left[3].left = 168;
  Rects_Left[3].top = 64;
  Rects_Left[3].right = 192;
  Rects_Left[3].bottom = 96;
  Rects_Right[0].left = 96;
  Rects_Right[0].top = 96;
  Rects_Right[0].right = 120;
  Rects_Right[0].bottom = 128;
  Rects_Right[1].left = 120;
  Rects_Right[1].top = 96;
  Rects_Right[1].right = 144;
  Rects_Right[1].bottom = 128;
  Rects_Right[2].left = 144;
  Rects_Right[2].top = 96;
  Rects_Right[2].right = 168;
  Rects_Right[2].bottom = 128;
  Rects_Right[3].left = 168;
  Rects_Right[3].top = 96;
  Rects_Right[3].right = 192;
  Rects_Right[3].bottom = 128;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042D010) --------------------------------------------------------
void __cdecl NPC36(NPC_vars *npc)
{
  int v1; // ST10_4@38 MAPDST
  int v2; // ST0C_4@38 MAPDST
  int v3; // ST08_4@38 MAPDST
  int v4; // eax@38 MAPDST
  RECT Rects_Right[6]; // [sp+4h] [bp-D0h]@51
  int Child_Y_Vel; // [sp+64h] [bp-70h]@7
  int Child_X_Vel; // [sp+68h] [bp-6Ch]@7
  RECT Rects_Left[6]; // [sp+6Ch] [bp-68h]@51
  int i; // [sp+CCh] [bp-8h]@36
  unsigned __int8 Vel_Randomiser; // [sp+D3h] [bp-1h]@7

  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++npc->Wait_Timer > 12 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->count1 = 3;
        npc->Ani_Num = 1;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 16 )
      {
        --npc->count1;
        npc->Wait_Timer = 0;
        Vel_Randomiser = GetArcTan(npc->X_pos - Quote.X_Pos, npc->Y_pos + 2048 - Quote.Y_Pos);
        Vel_Randomiser += Random(-16, 16);
        Child_Y_Vel = GetSin(Vel_Randomiser);
        Child_X_Vel = GetCos(Vel_Randomiser);
        NPC_Create(
          Projectile_Balrog_Energy_Bounce,
          npc->X_pos,
          npc->Y_pos + 2048,
          Child_X_Vel,
          Child_Y_Vel,
          0,
          NULL,
          256);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        if ( !npc->count1 )
        {
          npc->Current_State = 3;
          npc->Wait_Timer = 0;
        }
      }
      break;
    case 3:
      if ( ++npc->Wait_Timer > 3 )
      {
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
        npc->X_vel = (Quote.X_Pos - npc->X_pos) / 100;
        npc->Y_vel = -1536;
        npc->Ani_Num = 3;
      }
      break;
    case 4:
      if ( npc->Y_vel > -512 )
      {
        if ( npc->Life <= 60 )
        {
          npc->Current_State = 6;
        }
        else
        {
          npc->Current_State = 5;
          npc->Ani_Num = 4;
          npc->ani_wait = 0;
          npc->Wait_Timer = 0;
          npc->Curly_Target_Y = npc->Y_pos;
        }
      }
      break;
    case 5:
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 5 )
      {
        npc->Ani_Num = 4;
        Play_Sound_Effect(Sfx_Strange_Click, 1);
      }
      if ( ++npc->Wait_Timer > 100 )
      {
        npc->Current_State = 6;
        npc->Ani_Num = 3;
      }
      if ( npc->Y_pos >= npc->Curly_Target_Y )
        npc->Y_vel -= 64;
      else
        npc->Y_vel += 64;
      if ( npc->Y_vel < -512 )
        npc->Y_vel = -512;
      if ( npc->Y_vel > 512 )
        npc->Y_vel = 512;
      break;
    case 6:
      if ( npc->Y_pos + 0x2000 >= Quote.Y_Pos )
        npc->Damage = 0;
      else
        npc->Damage = 10;
      if ( npc->Collision_flags & 8 )
      {
        npc->Current_State = 7;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 2;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Play_Sound_Effect(Sfx_Silly_Explosion, 1);
        Set_Quake(30);
        npc->Damage = 0;
        for ( i = 0; i < 8; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = npc->Y_pos + (Random(-12, 12) << 9);
          v4 = Random(-12, 12);
          NPC_Create(Smoke, npc->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
        for ( i = 0; i < 8; ++i )
        {
          v1 = Random(-1024, 0);
          v2 = Random(-1024, 1024);
          v3 = npc->Y_pos + (Random(-12, 12) << 9);
          v4 = Random(-12, 12);
          NPC_Create((NPC_Names)33, npc->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
      }
      break;
    case 7:
      npc->X_vel = 0;
      if ( ++npc->Wait_Timer > 3 )
      {
        npc->Current_State = 1;
        npc->Wait_Timer = 0;
      }
      break;
    default:
      break;
  }
  if ( npc->Current_State != 5 )
  {
    npc->Y_vel += 51;
    if ( npc->X_pos >= Quote.X_Pos )
      npc->Direction = 0;
    else
      npc->Direction = 2;
  }
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 40;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 80;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 120;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 120;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 160;
  Rects_Left[3].bottom = 24;
  Rects_Left[4].left = 160;
  Rects_Left[4].top = 48;
  Rects_Left[4].right = 200;
  Rects_Left[4].bottom = 72;
  Rects_Left[5].left = 200;
  Rects_Left[5].top = 48;
  Rects_Left[5].right = 240;
  Rects_Left[5].bottom = 72;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 40;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 80;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 120;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 120;
  Rects_Right[3].top = 24;
  Rects_Right[3].right = 160;
  Rects_Right[3].bottom = 48;
  Rects_Right[4].left = 160;
  Rects_Right[4].top = 72;
  Rects_Right[4].right = 200;
  Rects_Right[4].bottom = 96;
  Rects_Right[5].left = 200;
  Rects_Right[5].top = 72;
  Rects_Right[5].right = 240;
  Rects_Right[5].bottom = 96;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042D760) --------------------------------------------------------
void __cdecl NPC37(NPC_vars *npc)
{
  RECT *v1; // eax@5
  char *v2; // ecx@5
  RECT Rects[2]; // [sp+0h] [bp-20h]@1

  Rects[0].left = 192;
  Rects[0].top = 64;
  Rects[0].right = 208;
  Rects[0].bottom = 80;
  Rects[1].left = 208;
  Rects[1].top = 64;
  Rects[1].right = 224;
  Rects[1].bottom = 80;
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 1 )
    npc->Ani_Num = 0;
  v1 = &Rects[npc->Ani_Num];
  v2 = (char *)&npc->Rect;
  *(_DWORD *)v2 = v1->left;
  *((_DWORD *)v2 + 1) = v1->top;
  *((_DWORD *)v2 + 2) = v1->right;
  *((_DWORD *)v2 + 3) = v1->bottom;
}

//----- (0042D810) --------------------------------------------------------
void __cdecl NPC38(NPC_vars *npc)
{
  RECT *v1; // edx@9
  char *v2; // eax@9
  int npc_Current_State; // [sp+0h] [bp-44h]@1
  RECT Rects[4]; // [sp+4h] [bp-40h]@1

  Rects[0].left = 128;
  Rects[0].top = 64;
  Rects[0].right = 144;
  Rects[0].bottom = 80;
  Rects[1].left = 144;
  Rects[1].top = 64;
  Rects[1].right = 160;
  Rects[1].bottom = 80;
  Rects[2].left = 160;
  Rects[2].top = 64;
  Rects[2].right = 176;
  Rects[2].bottom = 80;
  Rects[3].left = 176;
  Rects[3].top = 64;
  Rects[3].right = 192;
  Rects[3].bottom = 80;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State == 10 )
    {
      npc->Current_State = 11;
      Create_Dust_Clouds(npc->X_pos, npc->Y_pos, npc->view.back, 8);
    }
    else if ( npc_Current_State != 11 )
    {
      return;
    }
    npc->Rect.left = 0;
    npc->Rect.right = 0;
    return;
  }
  if ( ++npc->ani_wait > 3 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 3 )
    npc->Ani_Num = 0;
  v1 = &Rects[npc->Ani_Num];
  v2 = (char *)&npc->Rect;
  *(_DWORD *)v2 = v1->left;
  *((_DWORD *)v2 + 1) = v1->top;
  *((_DWORD *)v2 + 2) = v1->right;
  *((_DWORD *)v2 + 3) = v1->bottom;
}

//----- (0042D960) --------------------------------------------------------
void __cdecl NPC39(NPC_vars *npc)
{
  RECT Rects[2]; // [sp+0h] [bp-20h]@1

  Rects[0].left = 224;
  Rects[0].top = 64;
  Rects[0].right = 240;
  Rects[0].bottom = 80;
  Rects[1].left = 240;
  Rects[1].top = 64;
  Rects[1].right = 256;
  Rects[1].bottom = 80;
  if ( npc->Direction )
    npc->Ani_Num = 1;
  else
    npc->Ani_Num = 0;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042D9F0) --------------------------------------------------------
void __cdecl NPC40(NPC_vars *npc)
{
  RECT Rects_Right[7]; // [sp+4h] [bp-E0h]@1
  RECT Rects_Left[7]; // [sp+74h] [bp-70h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 32;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 48;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 32;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 48;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 32;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 48;
  Rects_Left[3].left = 0;
  Rects_Left[3].top = 32;
  Rects_Left[3].right = 16;
  Rects_Left[3].bottom = 48;
  Rects_Left[4].left = 48;
  Rects_Left[4].top = 32;
  Rects_Left[4].right = 64;
  Rects_Left[4].bottom = 48;
  Rects_Left[5].left = 0;
  Rects_Left[5].top = 32;
  Rects_Left[5].right = 16;
  Rects_Left[5].bottom = 48;
  Rects_Left[6].left = 64;
  Rects_Left[6].top = 32;
  Rects_Left[6].right = 80;
  Rects_Left[6].bottom = 48;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 48;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 64;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 48;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 64;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 48;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 64;
  Rects_Right[3].left = 0;
  Rects_Right[3].top = 48;
  Rects_Right[3].right = 16;
  Rects_Right[3].bottom = 64;
  Rects_Right[4].left = 48;
  Rects_Right[4].top = 48;
  Rects_Right[4].right = 64;
  Rects_Right[4].bottom = 64;
  Rects_Right[5].left = 0;
  Rects_Right[5].top = 48;
  Rects_Right[5].right = 16;
  Rects_Right[5].bottom = 64;
  Rects_Right[6].left = 64;
  Rects_Right[6].top = 48;
  Rects_Right[6].right = 80;
  Rects_Right[6].bottom = 64;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      if ( npc->X_pos - 0x4000 < Quote.X_Pos
        && npc->X_pos + 0x4000 > Quote.X_Pos
        && npc->Y_pos - 0x4000 < Quote.Y_Pos
        && npc->Y_pos + 0x2000 > Quote.Y_Pos )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = Right;
        else
          npc->Direction = Left;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 3:
      npc->Current_State = 4;
      npc->Ani_Num = 2;
      npc->ani_wait = 0;
      goto LABEL_17;
    case 4:
LABEL_17:
      if ( ++npc->ani_wait > 4 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 5 )
        npc->Ani_Num = 2;
      if ( !npc->Direction )
        npc->X_pos -= 512;
      else
        npc->X_pos += 512;
      break;
    case 5:
      npc->Ani_Num = 6;
      break;
    default:
      break;
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042DE00) --------------------------------------------------------
void __cdecl NPC41(NPC_vars *npc)
{
  RECT *npc_Rect; // ecx@3

  if ( !npc->Current_State )
  {
    ++npc->Current_State;
    npc->Y_pos -= 0x2000;
  }
  npc_Rect = &npc->Rect;
  npc_Rect->left = 0;
  npc_Rect->top = 80;
  npc_Rect->right = 48;
  npc_Rect->bottom = 112;
}

//----- (0042DE70) --------------------------------------------------------
void __cdecl NPC42(NPC_vars *npc)
{
  RECT Rects_Right[13]; // [sp+4h] [bp-1A8h]@1
  int i; // [sp+D8h] [bp-D4h]@39
  RECT Rects_Left[13]; // [sp+DCh] [bp-D0h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 16;
  Rects_Left[3].left = 0;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 16;
  Rects_Left[3].bottom = 16;
  Rects_Left[4].left = 48;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 64;
  Rects_Left[4].bottom = 16;
  Rects_Left[5].left = 0;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 16;
  Rects_Left[5].bottom = 16;
  Rects_Left[6].left = 64;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 80;
  Rects_Left[6].bottom = 16;
  Rects_Left[7].left = 80;
  Rects_Left[7].top = 32;
  Rects_Left[7].right = 96;
  Rects_Left[7].bottom = 48;
  Rects_Left[8].left = 96;
  Rects_Left[8].top = 32;
  Rects_Left[8].right = 112;
  Rects_Left[8].bottom = 48;
  Rects_Left[9].left = 128;
  Rects_Left[9].top = 32;
  Rects_Left[9].right = 144;
  Rects_Left[9].bottom = 48;
  Rects_Left[10].left = 0;
  Rects_Left[10].top = 0;
  Rects_Left[10].right = 16;
  Rects_Left[10].bottom = 16;
  Rects_Left[11].left = 112;
  Rects_Left[11].top = 32;
  Rects_Left[11].right = 128;
  Rects_Left[11].bottom = 48;
  Rects_Left[12].left = 160;
  Rects_Left[12].top = 32;
  Rects_Left[12].right = 176;
  Rects_Left[12].bottom = 48;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 32;
  Rects_Right[3].left = 0;
  Rects_Right[3].top = 16;
  Rects_Right[3].right = 16;
  Rects_Right[3].bottom = 32;
  Rects_Right[4].left = 48;
  Rects_Right[4].top = 16;
  Rects_Right[4].right = 64;
  Rects_Right[4].bottom = 32;
  Rects_Right[5].left = 0;
  Rects_Right[5].top = 16;
  Rects_Right[5].right = 16;
  Rects_Right[5].bottom = 32;
  Rects_Right[6].left = 64;
  Rects_Right[6].top = 16;
  Rects_Right[6].right = 80;
  Rects_Right[6].bottom = 32;
  Rects_Right[7].left = 80;
  Rects_Right[7].top = 48;
  Rects_Right[7].right = 96;
  Rects_Right[7].bottom = 64;
  Rects_Right[8].left = 96;
  Rects_Right[8].top = 48;
  Rects_Right[8].right = 112;
  Rects_Right[8].bottom = 64;
  Rects_Right[9].left = 128;
  Rects_Right[9].top = 48;
  Rects_Right[9].right = 144;
  Rects_Right[9].bottom = 64;
  Rects_Right[10].left = 0;
  Rects_Right[10].top = 16;
  Rects_Right[10].right = 16;
  Rects_Right[10].bottom = 32;
  Rects_Right[11].left = 112;
  Rects_Right[11].top = 48;
  Rects_Right[11].right = 128;
  Rects_Right[11].bottom = 64;
  Rects_Right[12].left = 160;
  Rects_Right[12].top = 48;
  Rects_Right[12].right = 176;
  Rects_Right[12].bottom = 64;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      npc->X_vel = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 3:
      npc->Current_State = 4;
      npc->Ani_Num = 2;
      npc->ani_wait = 0;
      goto LABEL_10;
    case 4:
LABEL_10:
      if ( ++npc->ani_wait > 4 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 5 )
        npc->Ani_Num = 2;
      if ( npc->Direction )
        npc->X_vel = 512;
      else
        npc->X_vel = -512;
      break;
    case 5:
      npc->Ani_Num = 6;
      npc->X_vel = 0;
      break;
    case 6:
      Play_Sound_Effect(Sfx_Toroko_Enemy_Squeal, 1);
      npc->Wait_Timer = 0;
      npc->Current_State = 7;
      npc->Ani_Num = 7;
      goto LABEL_20;
    case 7:
LABEL_20:
      if ( ++npc->Wait_Timer > 10 )
        npc->Current_State = 0;
      break;
    case 8:
      Play_Sound_Effect(Sfx_Toroko_Enemy_Squeal, 1);
      npc->Wait_Timer = 0;
      npc->Current_State = 9;
      npc->Ani_Num = 7;
      npc->Y_vel = -512;
      if ( npc->Direction )
        npc->X_vel = -1024;
      else
        npc->X_vel = 1024;
      goto LABEL_26;
    case 9:
LABEL_26:
      if ( ++npc->Wait_Timer > 3 && npc->Collision_flags & 8 )
      {
        npc->Current_State = 10;
        if ( npc->Direction )
          npc->Direction = 0;
        else
          npc->Direction = 2;
      }
      break;
    case 0xA:
      npc->X_vel = 0;
      npc->Ani_Num = 8;
      break;
    case 0xB:
      npc->Current_State = 12;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 9;
      npc->ani_wait = 0;
      npc->X_vel = 0;
      goto LABEL_34;
    case 0xC:
LABEL_34:
      if ( ++npc->ani_wait > 8 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 10 )
        npc->Ani_Num = 9;
      break;
    case 0xD:
      npc->Ani_Num = 11;
      npc->X_vel = 0;
      npc->Y_vel = 0;
      npc->Current_State = 14;
      for ( i = 0; i < 512 && NPC_Objects[i].Entity_Eve_Num != 501; ++i )
        ;
      if ( i == 512 )
      {
        npc->Current_State = 0;
      }
      else
      {
        npc->Parent_NPC = &NPC_Objects[i];
LABEL_46:
        if ( npc->Parent_NPC->Direction )
          npc->Direction = 0;
        else
          npc->Direction = 2;
        if ( npc->Parent_NPC->Direction )
          npc->X_pos = npc->Parent_NPC->X_pos + 3072;
        else
          npc->X_pos = npc->Parent_NPC->X_pos - 3072;
        npc->Y_pos = npc->Parent_NPC->Y_pos + 2048;
        if ( npc->Parent_NPC->Ani_Num == 2 || npc->Parent_NPC->Ani_Num == 4 )
          npc->Y_pos -= 512;
      }
      break;
    case 0xE:
      goto LABEL_46;
    case 0xF:
      npc->Current_State = 16;
      NPC_Create((NPC_Names)257, npc->X_pos + 0x10000, npc->Y_pos, 0, 0, 0, NULL, 0);
      NPC_Create((NPC_Names)257, npc->X_pos + 0x10000, npc->Y_pos, 0, 0, Right, NULL, 128);
      npc->X_vel = 0;
      npc->Ani_Num = 0;
      goto LABEL_57;
    case 0x10:
LABEL_57:
      Super_Y_Pos = npc->X_pos - 12288;
      Curly_Shoot_Y = npc->Y_pos - 4096;
      break;
    case 0x11:
      npc->X_vel = 0;
      npc->Ani_Num = 12;
      Super_Y_Pos = npc->X_pos;
      Curly_Shoot_Y = npc->Y_pos - 4096;
      break;
    case 0x14:
      npc->Current_State = 21;
      npc->Ani_Num = 2;
      npc->ani_wait = 0;
      goto LABEL_60;
    case 0x15:
LABEL_60:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 5 )
        npc->Ani_Num = 2;
      if ( npc->Direction )
        npc->X_vel = 1024;
      else
        npc->X_vel = -1024;
      if ( npc->X_pos < Quote.X_Pos - 4096 )
      {
        npc->Direction = 2;
        npc->Current_State = 0;
      }
      break;
    case 0x1E:
      npc->Current_State = 31;
      npc->Ani_Num = 2;
      npc->ani_wait = 0;
      goto LABEL_71;
    case 0x1F:
LABEL_71:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 5 )
        npc->Ani_Num = 2;
      if ( npc->Direction )
        npc->X_vel = 1024;
      else
        npc->X_vel = -1024;
      break;
    case 0x28:
      npc->Current_State = 41;
      npc->Ani_Num = 9;
      npc->Y_vel = -1024;
      break;
    default:
      break;
  }
  if ( npc->Current_State != 14 )
  {
    npc->Y_vel += 64;
    if ( npc->X_vel > 1024 )
      npc->X_vel = 1024;
    if ( npc->X_vel < -1024 )
      npc->X_vel = -1024;
    if ( npc->Y_vel > 1535 )
      npc->Y_vel = 1535;
    npc->X_pos += npc->X_vel;
    npc->Y_pos += npc->Y_vel;
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (0042E9F0) --------------------------------------------------------
void __cdecl NPC43(NPC_vars *npc)
{
  RECT *npc_Rect; // ecx@4 MAPDST

  if ( !npc->Current_State )
  {
    npc->Current_State = 1;
    npc->Y_pos -= 0x2000;
  }
  if ( npc->Direction )
  {
    npc_Rect = &npc->Rect;
    npc_Rect->left = 168;
    npc_Rect->top = 80;
    npc_Rect->right = 208;
    npc_Rect->bottom = 112;
  }
  else
  {
    npc_Rect = &npc->Rect;
    npc_Rect->left = 128;
    npc_Rect->top = 80;
    npc_Rect->right = 168;
    npc_Rect->bottom = 112;
  }
}

//----- (0042EAB0) --------------------------------------------------------
void __cdecl NPC44(NPC_vars *npc)
{
  signed int i; // [sp+4h] [bp-64h]@54
  RECT Rects_Right[3]; // [sp+8h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+38h] [bp-30h]@1

  Rects_Right[0].left = 0;
  Rects_Right[0].top = 0;
  Rects_Right[0].right = 32;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 32;
  Rects_Right[1].top = 0;
  Rects_Right[1].right = 64;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 64;
  Rects_Right[2].top = 0;
  Rects_Right[2].right = 96;
  Rects_Right[2].bottom = 32;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 32;
  Rects_Left[0].bottom = 32;
  Rects_Left[1].left = 96;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 128;
  Rects_Left[1].bottom = 32;
  Rects_Left[2].left = 128;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 160;
  Rects_Left[2].bottom = 32;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      npc->Ani_Num = 0;
      if ( npc->Direction )
        npc->Current_State = 2;
      else
        npc->Current_State = 8;
      goto LABEL_6;
    case 2:
LABEL_6:
      npc->Y_vel += 32;
      if ( npc->Y_vel > 0 && npc->Collision_flags & 8 )
      {
        npc->Y_vel = -256;
        npc->X_vel += 256;
      }
      if ( npc->Collision_flags & 4 )
        npc->Current_State = 3;
      break;
    case 3:
      npc->X_vel += 32;
      if ( npc->X_vel > 0 && npc->Collision_flags & 4 )
      {
        npc->X_vel = -256;
        npc->Y_vel -= 256;
      }
      if ( npc->Collision_flags & 2 )
        npc->Current_State = 4;
      break;
    case 4:
      npc->Y_vel -= 32;
      if ( npc->Y_vel < 0 && npc->Collision_flags & 2 )
      {
        npc->Y_vel = 256;
        npc->X_vel -= 256;
      }
      if ( npc->Collision_flags & 1 )
        npc->Current_State = 5;
      break;
    case 5:
      npc->X_vel -= 32;
      if ( npc->X_vel < 0 && npc->Collision_flags & 1 )
      {
        npc->X_vel = 256;
        npc->Y_vel += 256;
      }
      if ( npc->Collision_flags & 8 )
        npc->Current_State = 2;
      break;
    case 6:
      npc->Y_vel += 32;
      if ( npc->Y_vel > 0 && npc->Collision_flags & 8 )
      {
        npc->Y_vel = -256;
        npc->X_vel -= 256;
      }
      if ( npc->Collision_flags & 1 )
        npc->Current_State = 7;
      break;
    case 7:
      npc->X_vel -= 32;
      if ( npc->X_vel < 0 && npc->Collision_flags & 1 )
      {
        npc->X_vel = 256;
        npc->Y_vel -= 256;
      }
      if ( npc->Collision_flags & 2 )
        npc->Current_State = 8;
      break;
    case 8:
      npc->Y_vel -= 32;
      if ( npc->Y_vel < 0 && npc->Collision_flags & 2 )
      {
        npc->Y_vel = 256;
        npc->X_vel += 256;
      }
      if ( npc->Collision_flags & 4 )
        npc->Current_State = 9;
      break;
    case 9:
      npc->X_vel += 32;
      if ( npc->X_vel > 0 && npc->Collision_flags & 4 )
      {
        npc->X_vel = -256;
        npc->Y_vel += 256;
      }
      if ( npc->Collision_flags & 8 )
        npc->Current_State = 6;
      break;
    default:
      break;
  }
  if ( npc->Life <= 100 )
  {
    for ( i = 0; i < 10; ++i )
      NPC_Create(Forcefield|0x20, npc->X_pos, npc->Y_pos, 0, 0, 0, NULL, 256);
    Create_Dust_Clouds(npc->X_pos, npc->Y_pos, npc->view.back, 8);
    Play_Sound_Effect(Sfx_Silly_Explosion, 1);
    npc->Is_Alive = 0;
  }
  if ( npc->X_vel > 512 )
    npc->X_vel = 512;
  if ( npc->X_vel < -512 )
    npc->X_vel = -512;
  if ( npc->Y_vel > 512 )
    npc->Y_vel = 512;
  if ( npc->Y_vel < -512 )
    npc->Y_vel = -512;
  if ( npc->Is_Being_Hit )
  {
    npc->X_pos += npc->X_vel / 2;
    npc->Y_pos += npc->Y_vel / 2;
  }
  else
  {
    npc->X_pos += npc->X_vel;
    npc->Y_pos += npc->Y_vel;
  }
  if ( npc->Current_State >= 2 && npc->Current_State <= 9 && ++npc->Ani_Num > 2 )
    npc->Ani_Num = 1;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (0042F060) --------------------------------------------------------
void __cdecl NPC45(NPC_vars *npc)
{
  RECT *v1; // ecx@37
  char *v2; // edx@37
  int npc_Current_State; // [sp+0h] [bp-34h]@1
  RECT Rects[3]; // [sp+4h] [bp-30h]@1

  Rects[0].left = 0;
  Rects[0].top = 32;
  Rects[0].right = 16;
  Rects[0].bottom = 48;
  Rects[1].left = 16;
  Rects[1].top = 32;
  Rects[1].right = 32;
  Rects[1].bottom = 48;
  Rects[2].left = 32;
  Rects[2].top = 32;
  Rects[2].right = 48;
  Rects[2].bottom = 48;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State <= 0 || npc_Current_State > 2 )
      goto LABEL_14;
  }
  else
  {
    npc->Current_State = 2;
    if ( Random(0, 1) )
      npc->X_vel = Random(-512, -256);
    else
      npc->X_vel = Random(256, 512);
    if ( Random(0, 1) )
      npc->Y_vel = Random(-512, -256);
    else
      npc->Y_vel = Random(256, 512);
    npc->X_vel2 = npc->X_vel;
    npc->Y_vel2 = npc->Y_vel;
  }
  if ( ++npc->Ani_Num > 2 )
    npc->Ani_Num = 1;
LABEL_14:
  if ( npc->X_vel2 < 0 && npc->Collision_flags & 1 )
    npc->X_vel2 = -npc->X_vel2;
  if ( npc->X_vel2 > 0 && npc->Collision_flags & 4 )
    npc->X_vel2 = -npc->X_vel2;
  if ( npc->Y_vel2 < 0 && npc->Collision_flags & 2 )
    npc->Y_vel2 = -npc->Y_vel2;
  if ( npc->Y_vel2 > 0 && npc->Collision_flags & 8 )
    npc->Y_vel2 = -npc->Y_vel2;
  if ( npc->X_vel2 > 512 )
    npc->X_vel2 = 512;
  if ( npc->X_vel2 < -512 )
    npc->X_vel2 = -512;
  if ( npc->Y_vel2 > 512 )
    npc->Y_vel2 = 512;
  if ( npc->Y_vel2 < -512 )
    npc->Y_vel2 = -512;
  if ( npc->Is_Being_Hit )
  {
    npc->X_pos += npc->X_vel2 / 2;
    npc->Y_pos += npc->Y_vel2 / 2;
  }
  else
  {
    npc->X_pos += npc->X_vel2;
    npc->Y_pos += npc->Y_vel2;
  }
  v1 = &Rects[npc->Ani_Num];
  v2 = (char *)&npc->Rect;
  *(_DWORD *)v2 = v1->left;
  *((_DWORD *)v2 + 1) = v1->top;
  *((_DWORD *)v2 + 2) = v1->right;
  *((_DWORD *)v2 + 3) = v1->bottom;
}

//----- (0042F320) --------------------------------------------------------
void __cdecl NPC46(NPC_vars *npc)
{
  RECT *npc_Rect; // edx@9

  npc->Entity_Flags |= 0x100u;
  if ( npc->Direction )
  {
    if ( npc->Y_pos >= Quote.Y_Pos )
      npc->Y_pos -= 1535;
    else
      npc->Y_pos += 1535;
  }
  else if ( npc->X_pos >= Quote.X_Pos )
  {
    npc->X_pos -= 1535;
  }
  else
  {
    npc->X_pos += 1535;
  }
  npc_Rect = &npc->Rect;
  npc_Rect->left = 0;
  npc_Rect->top = 0;
  npc_Rect->right = 16;
  npc_Rect->bottom = 16;
}

//----- (0042F3F0) --------------------------------------------------------
void __cdecl NPC47(NPC_vars *npc)
{
  RECT Rects[5]; // [sp+4h] [bp-50h]@29

  switch ( npc->Current_State )
  {
    case 0:
      npc->Ani_Num = 0;
      npc->Current_State = 1;
      npc->Wait_Timer = 0;
      npc->Curly_Target_Y = npc->Y_pos;
      npc->Entity_Flags &= 0xFFDFu;
      npc->Entity_Flags &= 0xFFFBu;
      npc->Entity_Flags &= 0xFFFEu;
      npc->Entity_Flags &= 0xFFF7u;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos > npc->X_pos - 4096
        && Quote.X_Pos < npc->X_pos + 4096
        && Quote.Y_Pos > npc->Y_pos
        && Quote.Y_Pos < npc->Y_pos + 4096 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        Play_Sound_Effect(Sfx_Sand_Croc, 1);
      }
      if ( npc->X_pos < Quote.X_Pos )
        npc->X_pos += 1024;
      if ( npc->X_pos > Quote.X_Pos )
        npc->X_pos -= 1024;
      break;
    case 2:
      if ( ++npc->ani_wait > 3 )
      {
        ++npc->Ani_Num;
        npc->ani_wait = 0;
      }
      if ( npc->Ani_Num == 3 )
        npc->Damage = 10;
      if ( npc->Ani_Num == 4 )
      {
        npc->Entity_Flags |= 0x20u;
        npc->Current_State = 3;
        npc->Wait_Timer = 0;
      }
      break;
    case 3:
      npc->Entity_Flags |= 1u;
      npc->Damage = 0;
      ++npc->Wait_Timer;
      if ( npc->Is_Being_Hit )
      {
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
      }
      break;
    case 4:
      npc->Entity_Flags |= 8u;
      npc->Y_pos += 512;
      if ( ++npc->Wait_Timer == 32 )
      {
        npc->Entity_Flags &= 0xFFFEu;
        npc->Entity_Flags &= 0xFFDFu;
        npc->Current_State = 5;
        npc->Wait_Timer = 0;
      }
      break;
    case 5:
      if ( npc->Wait_Timer >= 100 )
      {
        npc->Y_pos = npc->Curly_Target_Y;
        npc->Ani_Num = 0;
        npc->Current_State = 0;
      }
      else
      {
        ++npc->Wait_Timer;
      }
      break;
    default:
      break;
  }
  Rects[0].left = 0;
  Rects[0].top = 48;
  Rects[0].right = 48;
  Rects[0].bottom = 80;
  Rects[1].left = 48;
  Rects[1].top = 48;
  Rects[1].right = 96;
  Rects[1].bottom = 80;
  Rects[2].left = 96;
  Rects[2].top = 48;
  Rects[2].right = 144;
  Rects[2].bottom = 80;
  Rects[3].left = 144;
  Rects[3].top = 48;
  Rects[3].right = 192;
  Rects[3].bottom = 80;
  Rects[4].left = 192;
  Rects[4].top = 48;
  Rects[4].right = 240;
  Rects[4].bottom = 80;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (0042F780) --------------------------------------------------------
void __cdecl NPC48(NPC_vars *npc)
{
  RECT *v1; // edx@20 MAPDST
  char *v4; // eax@21
  RECT Rects_Right[2]; // [sp+0h] [bp-40h]@14
  RECT Rects_Left[2]; // [sp+20h] [bp-20h]@14

  if ( npc->Collision_flags & 1 && npc->X_vel < 0 )
  {
    npc->X_vel = -npc->X_vel;
  }
  else if ( npc->Collision_flags & 4 && npc->X_vel > 0 )
  {
    npc->X_vel = -npc->X_vel;
  }
  else if ( npc->Collision_flags & 8 )
  {
    if ( ++npc->count1 <= 2 && npc->Direction != 2 )
    {
      npc->Y_vel = -256;
    }
    else
    {
      Vanish_NPC(npc);
      Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
    }
  }
  if ( npc->Direction == 2 )
  {
    npc->Entity_Flags &= 0xFFDFu;
    npc->Entity_Flags |= 4u;
  }
  npc->Y_vel += 5;
  npc->Y_pos += npc->Y_vel;
  npc->X_pos += npc->X_vel;
  Rects_Left[0].left = 288;
  Rects_Left[0].top = 88;
  Rects_Left[0].right = 304;
  Rects_Left[0].bottom = 104;
  Rects_Left[1].left = 304;
  Rects_Left[1].top = 88;
  Rects_Left[1].right = 320;
  Rects_Left[1].bottom = 104;
  Rects_Right[0].left = 288;
  Rects_Right[0].top = 104;
  Rects_Right[0].right = 304;
  Rects_Right[0].bottom = 120;
  Rects_Right[1].left = 304;
  Rects_Right[1].top = 104;
  Rects_Right[1].right = 320;
  Rects_Right[1].bottom = 120;
  if ( ++npc->ani_wait > 2 )
  {
    npc->ani_wait = 0;
    if ( ++npc->Ani_Num > 1 )
      npc->Ani_Num = 0;
  }
  if ( ++npc->Wait_Timer > 750 )
  {
    Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
    npc->Is_Alive = 0;
  }
  if ( !npc->Direction )
  {
    v1 = &Rects_Left[npc->Ani_Num];
    v1 = &npc->Rect;
    v1->left = v1->left;
    v1->top = v1->top;
    v1->right = v1->right;
    v1->bottom = v1->bottom;
  }
  else
  {
    v1 = &Rects_Right[npc->Ani_Num];
    v4 = (char *)&npc->Rect;
    *(_DWORD *)v4 = v1->left;
    *((_DWORD *)v4 + 1) = v1->top;
    *((_DWORD *)v4 + 2) = v1->right;
    *((_DWORD *)v4 + 3) = v1->bottom;
  }
}

//----- (0042F9E0) --------------------------------------------------------
void __cdecl NPC49(NPC_vars *npc)
{
  int Y_Vel; // ST24_4@39
  RECT *v2; // eax@47
  char *v3; // ecx@47
  RECT *v4; // eax@48
  char *v5; // ecx@48
  RECT Rects_Right[3]; // [sp+8h] [bp-68h]@46
  int v7; // [sp+38h] [bp-38h]@39
  RECT Rects_Left[3]; // [sp+3Ch] [bp-34h]@46
  unsigned __int8 v9; // [sp+6Fh] [bp-1h]@39

  if ( npc->Current_State >= 10 && npc->Parent_NPC->Entity_Type == 3 )
  {
    npc->Current_State = 3;
    npc->X_vel = 0;
    npc->Y_vel = 0;
    npc->count2 = 1;
  }
  if ( npc->Collision_flags & 1 )
  {
    npc->Direction = 2;
    npc->X_vel = 256;
  }
  if ( npc->Collision_flags & 4 )
  {
    npc->Direction = 0;
    npc->X_vel = -256;
  }
  switch ( npc->Current_State )
  {
    case 0:
      if ( npc->Parent_NPC )
        npc->Current_State = 10;
      else
        npc->Current_State = 1;
      goto LABEL_12;
    case 1:
LABEL_12:
      if ( ++npc->Wait_Timer > 3 )
      {
        npc->Y_vel = -1024;
        npc->Current_State = 3;
        npc->Ani_Num = 2;
        if ( npc->count2 )
        {
          if ( npc->Direction )
            npc->X_vel = 512;
          else
            npc->X_vel = -512;
        }
        else if ( npc->Direction )
        {
          npc->X_vel = 256;
        }
        else
        {
          npc->X_vel = -256;
        }
      }
      npc->Ani_Num = 1;
      break;
    case 3:
      if ( npc->Collision_flags & 8 )
      {
        npc->Current_State = 1;
        npc->Wait_Timer = 0;
        npc->X_vel = 0;
      }
      if ( npc->Collision_flags & 8 || npc->Y_vel > 0 )
        npc->Ani_Num = 1;
      else
        npc->Ani_Num = 2;
      break;
    case 0xA:
      if ( npc->count1 >= 50 )
      {
        if ( npc->X_pos - 0x10000 < Quote.X_Pos
          && npc->X_pos + 0x10000 > Quote.X_Pos
          && npc->Y_pos - 49152 < Quote.Y_Pos
          && npc->Y_pos + 49152 > Quote.Y_Pos )
        {
          npc->Current_State = 11;
          npc->Wait_Timer = 0;
          npc->Ani_Num = 2;
        }
      }
      else
      {
        ++npc->count1;
      }
      break;
    case 0xB:
      if ( ++npc->Wait_Timer == 30 || npc->Wait_Timer == 35 )
      {
        v9 = GetArcTan(npc->X_pos - Quote.X_Pos, npc->Y_pos + 2048 - Quote.Y_Pos);
        Y_Vel = 2 * GetSin(v9);
        v7 = 2 * GetCos(v9);
        NPC_Create((NPC_Names)50, npc->X_pos, npc->Y_pos, v7, Y_Vel, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      if ( npc->Wait_Timer > 50 )
      {
        npc->count1 = 0;
        npc->Current_State = 10;
        npc->Ani_Num = 1;
      }
      break;
    default:
      break;
  }
  if ( npc->Current_State >= 10 )
  {
    npc->X_pos = npc->Parent_NPC->X_pos;
    npc->Y_pos = npc->Parent_NPC->Y_pos + 0x2000;
    npc->Direction = npc->Parent_NPC->Direction;
    --npc->Parent_NPC->count1;
  }
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 32;
  Rects_Left[0].bottom = 104;
  Rects_Left[1].left = 32;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 64;
  Rects_Left[1].bottom = 104;
  Rects_Left[2].left = 64;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 96;
  Rects_Left[2].bottom = 104;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 104;
  Rects_Right[0].right = 32;
  Rects_Right[0].bottom = 128;
  Rects_Right[1].left = 32;
  Rects_Right[1].top = 104;
  Rects_Right[1].right = 64;
  Rects_Right[1].bottom = 128;
  Rects_Right[2].left = 64;
  Rects_Right[2].top = 104;
  Rects_Right[2].right = 96;
  Rects_Right[2].bottom = 128;
  if ( !npc->Direction )
  {
    v2 = &Rects_Left[npc->Ani_Num];
    v3 = (char *)&npc->Rect;
    *(_DWORD *)v3 = v2->left;
    *((_DWORD *)v3 + 1) = v2->top;
    *((_DWORD *)v3 + 2) = v2->right;
    *((_DWORD *)v3 + 3) = v2->bottom;
  }
  else
  {
    v4 = &Rects_Right[npc->Ani_Num];
    v5 = (char *)&npc->Rect;
    *(_DWORD *)v5 = v4->left;
    *((_DWORD *)v5 + 1) = v4->top;
    *((_DWORD *)v5 + 2) = v4->right;
    *((_DWORD *)v5 + 3) = v4->bottom;
  }
}

//----- (0042FEC0) --------------------------------------------------------
void __cdecl NPC50(NPC_vars *npc)
{
  char *v1; // edx@33 MAPDST
  int npc_Current_State; // [sp+0h] [bp-44h]@1
  RECT Rects[4]; // [sp+4h] [bp-40h]@23

  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
    {
      if ( npc_Current_State == 2 )
      {
        npc->Y_vel += 64;
        npc->X_pos += npc->X_vel;
        npc->Y_pos += npc->Y_vel;
        if ( npc->Collision_flags & 8 )
        {
          if ( ++npc->count1 > 1 )
          {
            Create_Effect(npc->X_pos, npc->Y_pos, 2, 0);
            npc->Is_Alive = 0;
          }
        }
      }
      goto LABEL_19;
    }
  }
  else if ( npc->Direction == 2 )
  {
    npc->Current_State = 2;
  }
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( npc->Collision_flags & 1 )
  {
    npc->Current_State = 2;
    npc->X_vel = 512;
    ++npc->count1;
  }
  if ( npc->Collision_flags & 4 )
  {
    npc->Current_State = 2;
    npc->X_vel = -512;
    ++npc->count1;
  }
  if ( npc->Collision_flags & 2 )
  {
    npc->Current_State = 2;
    npc->Y_vel = 512;
    ++npc->count1;
  }
  if ( npc->Collision_flags & 8 )
  {
    npc->Current_State = 2;
    npc->Y_vel = -512;
    ++npc->count1;
  }
LABEL_19:
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  if ( npc->Y_vel < -1535 )
    npc->Y_vel = -1535;
  Rects[0].left = 48;
  Rects[0].top = 32;
  Rects[0].right = 64;
  Rects[0].bottom = 48;
  Rects[1].left = 64;
  Rects[1].top = 32;
  Rects[1].right = 80;
  Rects[1].bottom = 48;
  Rects[2].left = 80;
  Rects[2].top = 32;
  Rects[2].right = 96;
  Rects[2].bottom = 48;
  Rects[3].left = 96;
  Rects[3].top = 32;
  Rects[3].right = 112;
  Rects[3].bottom = 48;
  if ( npc->Direction )
  {
    if ( ++npc->ani_wait > 1 )
    {
      npc->ani_wait = 0;
      --npc->Ani_Num;
    }
    if ( npc->Ani_Num < 0 )
      npc->Ani_Num = 3;
  }
  else
  {
    if ( ++npc->ani_wait > 1 )
    {
      npc->ani_wait = 0;
      ++npc->Ani_Num;
    }
    if ( npc->Ani_Num > 3 )
      npc->Ani_Num = 0;
  }
  v1 = (char *)&Rects[npc->Ani_Num];
  v1 = (char *)&npc->Rect;
  *(_DWORD *)v1 = *(_DWORD *)v1;
  *((_DWORD *)v1 + 1) = *((_DWORD *)v1 + 1);
  *((_DWORD *)v1 + 2) = *((_DWORD *)v1 + 2);
  *((_DWORD *)v1 + 3) = *((_DWORD *)v1 + 3);
}

//----- (004301B0) --------------------------------------------------------
void __cdecl NPC51(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-A4h]@1
  RECT Rects_Right[5]; // [sp+4h] [bp-A0h]@65
  RECT Rects_Left[5]; // [sp+54h] [bp-50h]@65

  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
    {
      if ( npc_Current_State == 2 )
      {
        if ( Quote.X_Pos >= npc->X_pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
        if ( npc->Y_pos <= Quote.Y_Pos + 0x4000 )
        {
          if ( Quote.X_Pos < npc->X_pos )
            npc->X_vel -= 16;
          if ( Quote.X_Pos > npc->X_pos )
            npc->X_vel += 16;
        }
        else
        {
          if ( Quote.X_Pos < npc->X_pos )
            npc->X_vel += 16;
          if ( Quote.X_Pos > npc->X_pos )
            npc->X_vel -= 16;
        }
        if ( Quote.Y_Pos < npc->Y_pos )
          npc->Y_vel -= 16;
        if ( Quote.Y_Pos > npc->Y_pos )
          npc->Y_vel += 16;
        if ( npc->Is_Being_Hit )
        {
          npc->Y_vel += 32;
          npc->X_vel = 0;
        }
      }
      goto LABEL_45;
    }
  }
  else
  {
    if ( npc->X_pos - 163840 >= Quote.X_Pos
      || npc->X_pos + 163840 <= Quote.X_Pos
      || npc->Y_pos - 163840 >= Quote.Y_Pos
      || npc->Y_pos + 163840 <= Quote.Y_Pos )
    {
      goto LABEL_45;
    }
    npc->Curly_Target_X = npc->X_pos;
    npc->Curly_Target_Y = npc->Y_pos;
    npc->Y_vel = 1024;
    npc->Current_State = 1;
    NPC_Create((NPC_Names)49, 0, 0, 0, 0, 0, npc, 0);
  }
  if ( Quote.X_Pos >= npc->X_pos )
    npc->Direction = 2;
  else
    npc->Direction = 0;
  if ( npc->Curly_Target_Y < npc->Y_pos )
    npc->Y_vel -= 10;
  if ( npc->Curly_Target_Y > npc->Y_pos )
    npc->Y_vel += 10;
  if ( npc->Y_vel > 512 )
    npc->Y_vel = 512;
  if ( npc->Y_vel < -512 )
    npc->Y_vel = -512;
  if ( npc->count1 >= 10 )
    npc->Current_State = 2;
  else
    ++npc->count1;
LABEL_45:
  if ( npc->X_vel < 0 && npc->Collision_flags & 1 )
    npc->X_vel = 256;
  if ( npc->X_vel > 0 && npc->Collision_flags & 4 )
    npc->X_vel = -256;
  if ( npc->Y_vel < 0 && npc->Collision_flags & 2 )
    npc->Y_vel = 256;
  if ( npc->Y_vel > 0 && npc->Collision_flags & 8 )
    npc->Y_vel = -256;
  if ( npc->X_vel > 1024 )
    npc->X_vel = 1024;
  if ( npc->X_vel < -1024 )
    npc->X_vel = -1024;
  if ( npc->Y_vel > 512 )
    npc->Y_vel = 512;
  if ( npc->Y_vel < -512 )
    npc->Y_vel = -512;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 96;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 128;
  Rects_Left[0].bottom = 112;
  Rects_Left[1].left = 128;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 160;
  Rects_Left[1].bottom = 112;
  Rects_Left[2].left = 160;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 192;
  Rects_Left[2].bottom = 112;
  Rects_Left[3].left = 192;
  Rects_Left[3].top = 80;
  Rects_Left[3].right = 224;
  Rects_Left[3].bottom = 112;
  Rects_Left[4].left = 224;
  Rects_Left[4].top = 80;
  Rects_Left[4].right = 256;
  Rects_Left[4].bottom = 112;
  Rects_Right[0].left = 96;
  Rects_Right[0].top = 112;
  Rects_Right[0].right = 128;
  Rects_Right[0].bottom = 144;
  Rects_Right[1].left = 128;
  Rects_Right[1].top = 112;
  Rects_Right[1].right = 160;
  Rects_Right[1].bottom = 144;
  Rects_Right[2].left = 160;
  Rects_Right[2].top = 112;
  Rects_Right[2].right = 192;
  Rects_Right[2].bottom = 144;
  Rects_Right[3].left = 192;
  Rects_Right[3].top = 112;
  Rects_Right[3].right = 224;
  Rects_Right[3].bottom = 144;
  Rects_Right[4].left = 224;
  Rects_Right[4].top = 112;
  Rects_Right[4].right = 256;
  Rects_Right[4].bottom = 144;
  if ( npc->Is_Being_Hit )
  {
    npc->Ani_Num = 4;
  }
  else if ( npc->Current_State != 2 || npc->Y_pos >= Quote.Y_Pos - 0x4000 )
  {
    if ( npc->Current_State )
    {
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 1 )
        npc->Ani_Num = 0;
    }
  }
  else
  {
    npc->Ani_Num = 0;
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00430780) --------------------------------------------------------
// NPC 52 : Sitting Blue Bot
void __cdecl NPC52_Sitting_Blue_Bot(NPC_vars *npc)
{
  RECT *npc_Rect; // eax@1

  npc_Rect = &npc->Rect;
  npc_Rect->left = 240;
  npc_Rect->top = 96;
  npc_Rect->right = 256;
  npc_Rect->bottom = 112;
}

//----- (004307D0) --------------------------------------------------------
void __cdecl NPC53(NPC_vars *npc)
{
  NPC_vars *npc_Parent_NPC; // esi@17 MAPDST
  RECT *v3; // eax@23
  char *v4; // ecx@23
  RECT *v5; // eax@24
  char *v6; // ecx@24
  int npc_Current_State; // [sp+0h] [bp-48h]@3
  RECT Rects_Right[2]; // [sp+4h] [bp-44h]@1
  RECT Rects_Left[2]; // [sp+24h] [bp-24h]@1
  unsigned __int8 Parent_Count_Plus_Parent_X_Vel; // [sp+47h] [bp-1h]@17

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 128;
  Rects_Left[0].right = 24;
  Rects_Left[0].bottom = 144;
  Rects_Left[1].left = 24;
  Rects_Left[1].top = 128;
  Rects_Left[1].right = 48;
  Rects_Left[1].bottom = 144;
  Rects_Right[0].left = 48;
  Rects_Right[0].top = 128;
  Rects_Right[0].right = 72;
  Rects_Right[0].bottom = 144;
  Rects_Right[1].left = 72;
  Rects_Right[1].top = 128;
  Rects_Right[1].right = 96;
  Rects_Right[1].bottom = 144;
  if ( npc->Parent_NPC->Entity_Type == 3 )
  {
    Vanish_NPC(npc);
    Create_Dust_Clouds(npc->X_pos, npc->Y_pos, npc->view.back, 4);
    return;
  }
  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    npc->Current_State = 1;
    npc->count1 = 10;
LABEL_7:
    if ( !npc->Direction && npc->Collision_flags & 0x20 )
    {
      npc->Parent_NPC->Y_pos -= 1024;
      npc->Parent_NPC->Y_vel -= 256;
    }
    if ( npc->Direction == 2 && npc->Collision_flags & 0x10 )
    {
      npc->Parent_NPC->Y_pos -= 1024;
      npc->Parent_NPC->Y_vel -= 256;
    }
    if ( npc->Collision_flags & 8 )
    {
      npc->Parent_NPC->Y_pos -= 1024;
      npc->Parent_NPC->Y_vel -= 256;
      if ( npc->Parent_NPC->Direction )
        npc->Parent_NPC->X_vel += 128;
      else
        npc->Parent_NPC->X_vel -= 128;
    }
    Parent_Count_Plus_Parent_X_Vel = LOBYTE(npc->Parent_NPC->count2) + LOBYTE(npc->X_vel);
    npc_Parent_NPC = npc->Parent_NPC;
    npc->X_pos = npc_Parent_NPC->X_pos + npc->count1 * GetCos(Parent_Count_Plus_Parent_X_Vel);
    npc_Parent_NPC = npc->Parent_NPC;
    npc->Y_pos = npc_Parent_NPC->Y_pos + npc->count1 * GetSin(Parent_Count_Plus_Parent_X_Vel);
    npc->Direction = npc->Parent_NPC->Direction;
    goto LABEL_18;
  }
  if ( npc_Current_State == 1 )
    goto LABEL_7;
LABEL_18:
  npc->Direction = npc->Parent_NPC->Direction;
  npc->Ani_Num = (signed int)Parent_Count_Plus_Parent_X_Vel < 20 || (signed int)Parent_Count_Plus_Parent_X_Vel > 108;
  if ( !npc->Direction )
  {
    v3 = &Rects_Left[npc->Ani_Num];
    v4 = (char *)&npc->Rect;
    *(_DWORD *)v4 = v3->left;
    *((_DWORD *)v4 + 1) = v3->top;
    *((_DWORD *)v4 + 2) = v3->right;
    *((_DWORD *)v4 + 3) = v3->bottom;
  }
  else
  {
    v5 = &Rects_Right[npc->Ani_Num];
    v6 = (char *)&npc->Rect;
    *(_DWORD *)v6 = v5->left;
    *((_DWORD *)v6 + 1) = v5->top;
    *((_DWORD *)v6 + 2) = v5->right;
    *((_DWORD *)v6 + 3) = v5->bottom;
  }
}

//----- (00430B00) --------------------------------------------------------
void __cdecl NPC54(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-68h]@1
  RECT Rects_Right[3]; // [sp+4h] [bp-64h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-34h]@1
  unsigned __int8 npc_Count2; // [sp+67h] [bp-1h]@6

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 32;
  Rects_Left[0].bottom = 104;
  Rects_Left[1].left = 32;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 64;
  Rects_Left[1].bottom = 104;
  Rects_Left[2].left = 64;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 96;
  Rects_Left[2].bottom = 104;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 104;
  Rects_Right[0].right = 32;
  Rects_Right[0].bottom = 128;
  Rects_Right[1].left = 32;
  Rects_Right[1].top = 104;
  Rects_Right[1].right = 64;
  Rects_Right[1].bottom = 128;
  Rects_Right[2].left = 64;
  Rects_Right[2].top = 104;
  Rects_Right[2].right = 96;
  Rects_Right[2].bottom = 128;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
    {
      if ( npc_Current_State == 2 )
      {
        ++npc->Wait_Timer;
        npc->Is_Being_Hit += LOBYTE(npc->Wait_Timer);
        if ( npc->Wait_Timer > 50 )
        {
          Vanish_NPC(npc);
          Create_Dust_Clouds(npc->X_pos, npc->Y_pos, npc->view.back, 8);
          Play_Sound_Effect(Sfx_Silly_Explosion, 1);
        }
      }
      goto LABEL_28;
    }
  }
  else
  {
    NPC_Create((NPC_Names)53, 0, 0, 0, 0, (Directions)npc->Direction, npc, 256);
    NPC_Create((NPC_Names)53, 0, 0, 128, 0, (Directions)npc->Direction, npc, 0);
    npc->Current_State = 1;
    npc->Ani_Num = 1;
  }
  npc_Count2 = npc->count2;
  if ( npc->Direction )
    npc_Count2 += 6;
  else
    npc_Count2 -= 6;
  npc->count2 = npc_Count2;
  if ( npc->Collision_flags & 8 )
  {
    npc->X_vel = 3 * npc->X_vel / 4;
    if ( ++npc->Wait_Timer > 60 )
    {
      npc->Current_State = 2;
      npc->Wait_Timer = 0;
    }
  }
  else
  {
    npc->Wait_Timer = 0;
  }
  if ( npc->Direction || !(npc->Collision_flags & 1) )
  {
    if ( npc->Direction == 2 && npc->Collision_flags & 4 )
    {
      if ( ++npc->count1 > 8 )
      {
        npc->Direction = 0;
        npc->X_vel = -npc->X_vel;
      }
    }
    else
    {
      npc->count1 = 0;
    }
  }
  else if ( ++npc->count1 > 8 )
  {
    npc->Direction = 2;
    npc->X_vel = -npc->X_vel;
  }
LABEL_28:
  npc->Y_vel += 128;
  if ( npc->X_vel > 767 )
    npc->X_vel = 767;
  if ( npc->X_vel < -767 )
    npc->X_vel = -767;
  if ( npc->Y_vel > 767 )
    npc->Y_vel = 767;
  if ( npc->Y_vel < -767 )
    npc->Y_vel = -767;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00430EB0) --------------------------------------------------------
void __cdecl NPC55(NPC_vars *npc)
{
  RECT Rects_Right[6]; // [sp+4h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+64h] [bp-60h]@1

  Rects_Left[0].left = 192;
  Rects_Left[0].top = 192;
  Rects_Left[0].right = 208;
  Rects_Left[0].bottom = 216;
  Rects_Left[1].left = 208;
  Rects_Left[1].top = 192;
  Rects_Left[1].right = 224;
  Rects_Left[1].bottom = 216;
  Rects_Left[2].left = 192;
  Rects_Left[2].top = 192;
  Rects_Left[2].right = 208;
  Rects_Left[2].bottom = 216;
  Rects_Left[3].left = 224;
  Rects_Left[3].top = 192;
  Rects_Left[3].right = 240;
  Rects_Left[3].bottom = 216;
  Rects_Left[4].left = 192;
  Rects_Left[4].top = 192;
  Rects_Left[4].right = 208;
  Rects_Left[4].bottom = 216;
  Rects_Left[5].left = 240;
  Rects_Left[5].top = 192;
  Rects_Left[5].right = 256;
  Rects_Left[5].bottom = 216;
  Rects_Right[0].left = 192;
  Rects_Right[0].top = 216;
  Rects_Right[0].right = 208;
  Rects_Right[0].bottom = 240;
  Rects_Right[1].left = 208;
  Rects_Right[1].top = 216;
  Rects_Right[1].right = 224;
  Rects_Right[1].bottom = 240;
  Rects_Right[2].left = 192;
  Rects_Right[2].top = 216;
  Rects_Right[2].right = 208;
  Rects_Right[2].bottom = 240;
  Rects_Right[3].left = 224;
  Rects_Right[3].top = 216;
  Rects_Right[3].right = 240;
  Rects_Right[3].bottom = 240;
  Rects_Right[4].left = 192;
  Rects_Right[4].top = 216;
  Rects_Right[4].right = 208;
  Rects_Right[4].bottom = 240;
  Rects_Right[5].left = 240;
  Rects_Right[5].top = 216;
  Rects_Right[5].right = 256;
  Rects_Right[5].bottom = 240;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      break;
    case 3:
      npc->Current_State = 4;
      npc->Ani_Num = 1;
      npc->ani_wait = 0;
      goto LABEL_4;
    case 4:
LABEL_4:
      if ( ++npc->ani_wait > 4 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 4 )
        npc->Ani_Num = 1;
      if ( npc->Direction )
        npc->X_pos += 512;
      else
        npc->X_pos -= 512;
      break;
    case 5:
      npc->Ani_Num = 5;
      break;
    default:
      break;
  }
  npc->Y_vel += 32;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (004311D0) --------------------------------------------------------
void __cdecl NPC56(NPC_vars *npc)
{
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 144;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 160;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 144;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 160;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 144;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 160;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 160;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 176;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 160;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 176;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 160;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 176;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      if ( npc->Direction )
        npc->Current_State = 3;
      else
        npc->Current_State = 1;
      break;
    case 1:
      npc->X_vel -= 16;
      if ( npc->X_vel < -1024 )
        npc->X_vel = -1024;
      if ( npc->Is_Being_Hit )
        npc->X_pos += npc->X_vel / 2;
      else
        npc->X_pos += npc->X_vel;
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 2 )
        npc->Ani_Num = 1;
      if ( npc->Collision_flags & 1 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->X_vel = 0;
        npc->Direction = 2;
      }
      break;
    case 2:
      if ( npc->X_pos < Quote.X_Pos
        && npc->X_pos > Quote.X_Pos - 0x20000
        && npc->Y_pos < Quote.Y_Pos + 4096
        && npc->Y_pos > Quote.Y_Pos - 4096 )
      {
        npc->Current_State = 3;
        npc->ani_wait = 0;
        npc->Ani_Num = 1;
      }
      break;
    case 3:
      npc->X_vel += 16;
      if ( npc->X_vel > 1024 )
        npc->X_vel = 1024;
      if ( npc->Is_Being_Hit )
        npc->X_pos += npc->X_vel / 2;
      else
        npc->X_pos += npc->X_vel;
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 2 )
        npc->Ani_Num = 1;
      if ( npc->Collision_flags & 4 )
      {
        npc->Current_State = 4;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->X_vel = 0;
        npc->Direction = 0;
      }
      break;
    case 4:
      if ( npc->X_pos < Quote.X_Pos + 0x20000
        && npc->X_pos > Quote.X_Pos
        && npc->Y_pos < Quote.Y_Pos + 4096
        && npc->Y_pos > Quote.Y_Pos - 4096 )
      {
        npc->Current_State = 1;
        npc->ani_wait = 0;
        npc->Ani_Num = 1;
      }
      break;
    default:
      break;
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (004315E0) --------------------------------------------------------
void __cdecl NPC57(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-ACh]@1
  RECT Rects_Right[5]; // [sp+4h] [bp-A8h]@70
  RECT Rects_Left[5]; // [sp+54h] [bp-58h]@70
  unsigned __int8 v4; // [sp+ABh] [bp-1h]@5

  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    v4 = Random(0, 255);
    npc->X_vel = GetCos(v4);
    npc->Curly_Target_X = npc->X_pos + 8 * GetCos(v4 + 64);
    v4 = Random(0, 255);
    npc->Y_vel = GetSin(v4);
    v4 += 64;
    npc->Curly_Target_Y = npc->Y_pos + 8 * GetSin(v4);
    npc->Current_State = 1;
    npc->count1 = 120;
    npc->Ani_Num = Random(0, 1);
    npc->ani_wait = Random(0, 4);
  }
  else if ( npc_Current_State != 1 )
  {
    if ( npc_Current_State == 2 )
    {
      if ( Quote.X_Pos >= npc->X_pos )
        npc->Direction = 2;
      else
        npc->Direction = 0;
      if ( npc->Y_pos <= Quote.Y_Pos + 24576 )
      {
        if ( Quote.X_Pos < npc->X_pos )
          npc->X_vel -= 16;
        if ( Quote.X_Pos > npc->X_pos )
          npc->X_vel += 16;
      }
      else
      {
        if ( Quote.X_Pos < npc->X_pos )
          npc->X_vel += 16;
        if ( Quote.X_Pos > npc->X_pos )
          npc->X_vel -= 16;
      }
      if ( Quote.Y_Pos < npc->Y_pos )
        npc->Y_vel -= 16;
      if ( Quote.Y_Pos > npc->Y_pos )
        npc->Y_vel += 16;
      if ( npc->Is_Being_Hit )
      {
        npc->Y_vel += 32;
        npc->X_vel = 0;
      }
      if ( npc->X_vel < 0 && npc->Collision_flags & 1 )
        npc->X_vel = 512;
      if ( npc->X_vel > 0 && npc->Collision_flags & 4 )
        npc->X_vel = -512;
      if ( npc->Y_vel < 0 && npc->Collision_flags & 2 )
        npc->Y_vel = 512;
      if ( npc->Y_vel > 0 && npc->Collision_flags & 8 )
        npc->Y_vel = -512;
      if ( npc->X_vel > 1535 )
        npc->X_vel = 1535;
      if ( npc->X_vel < -1535 )
        npc->X_vel = -1535;
      if ( npc->Y_vel > 1535 )
        npc->Y_vel = 1535;
      if ( npc->Y_vel < -1535 )
        npc->Y_vel = -1535;
    }
    goto LABEL_70;
  }
  // npc-->Current_State == 1
  if ( Quote.X_Pos >= npc->X_pos )
    npc->Direction = 2;
  else
    npc->Direction = 0;
  if ( npc->Curly_Target_X < npc->X_pos )
    npc->X_vel -= 16;
  if ( npc->Curly_Target_X > npc->X_pos )
    npc->X_vel += 16;
  if ( npc->Curly_Target_Y < npc->Y_pos )
    npc->Y_vel -= 16;
  if ( npc->Curly_Target_Y > npc->Y_pos )
    npc->Y_vel += 16;
  if ( npc->X_vel > 512 )
    npc->X_vel = 512;
  if ( npc->X_vel < -512 )
    npc->X_vel = -512;
  if ( npc->Y_vel > 512 )
    npc->Y_vel = 512;
  if ( npc->Y_vel < -512 )
    npc->Y_vel = -512;
  if ( npc->Is_Being_Hit )
  {
    npc->Current_State = 2;
    npc->Wait_Timer = 0;
    if ( npc->Direction == 2 )
      npc->X_vel = -512;
    else
      npc->X_vel = 512;
    npc->Y_vel = 0;
  }
LABEL_70:
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 96;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 128;
  Rects_Left[0].bottom = 112;
  Rects_Left[1].left = 128;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 160;
  Rects_Left[1].bottom = 112;
  Rects_Left[2].left = 160;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 192;
  Rects_Left[2].bottom = 112;
  Rects_Left[3].left = 192;
  Rects_Left[3].top = 80;
  Rects_Left[3].right = 224;
  Rects_Left[3].bottom = 112;
  Rects_Left[4].left = 224;
  Rects_Left[4].top = 80;
  Rects_Left[4].right = 256;
  Rects_Left[4].bottom = 112;
  Rects_Right[0].left = 96;
  Rects_Right[0].top = 112;
  Rects_Right[0].right = 128;
  Rects_Right[0].bottom = 144;
  Rects_Right[1].left = 128;
  Rects_Right[1].top = 112;
  Rects_Right[1].right = 160;
  Rects_Right[1].bottom = 144;
  Rects_Right[2].left = 160;
  Rects_Right[2].top = 112;
  Rects_Right[2].right = 192;
  Rects_Right[2].bottom = 144;
  Rects_Right[3].left = 192;
  Rects_Right[3].top = 112;
  Rects_Right[3].right = 224;
  Rects_Right[3].bottom = 144;
  Rects_Right[4].left = 224;
  Rects_Right[4].top = 112;
  Rects_Right[4].right = 256;
  Rects_Right[4].bottom = 144;
  if ( npc->Is_Being_Hit )
  {
    npc->Ani_Num = 4;
  }
  else
  {
    if ( ++npc->ani_wait > 1 )
    {
      npc->ani_wait = 0;
      ++npc->Ani_Num;
    }
    if ( npc->Ani_Num > 1 )
      npc->Ani_Num = 0;
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00431C20) --------------------------------------------------------
void __cdecl NPC58(NPC_vars *npc)
{
  unsigned __int8 v1; // ST2F_1@42
  unsigned __int8 v2; // ST2F_1@42
  int Y_Vel; // ST24_4@42
  int X_Vel; // ST28_4@42
  int npc_Current_State; // [sp+0h] [bp-70h]@1
  RECT Rects_Right[3]; // [sp+10h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+40h] [bp-30h]@1

  Rects_Left[0].left = 192;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 216;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 216;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 240;
  Rects_Left[1].bottom = 24;
  Rects_Left[2].left = 240;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 264;
  Rects_Left[2].bottom = 24;
  Rects_Right[0].left = 192;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 216;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 216;
  Rects_Right[1].top = 24;
  Rects_Right[1].right = 240;
  Rects_Right[1].bottom = 48;
  Rects_Right[2].left = 240;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 264;
  Rects_Right[2].bottom = 48;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
      goto LABEL_58;
    if ( npc->X_pos <= Quote.X_Pos )
    {
      npc->Direction = 2;
      npc->X_vel += 16;
    }
    else
    {
      npc->Direction = 0;
      npc->X_vel -= 16;
    }
    if ( npc->Collision_flags & 1 )
      npc->X_vel = 512;
    if ( npc->Collision_flags & 4 )
      npc->X_vel = -512;
    if ( npc->Y_pos >= npc->Curly_Target_Y )
      npc->Y_vel -= 8;
    else
      npc->Y_vel += 8;
    if ( npc->X_vel > 767 )
      npc->X_vel = 767;
    if ( npc->X_vel < -767 )
      npc->X_vel = -767;
    if ( npc->Y_vel > 256 )
      npc->Y_vel = 256;
    if ( npc->Y_vel < -256 )
      npc->Y_vel = -256;
    if ( npc->Is_Being_Hit )
    {
      npc->X_pos += npc->X_vel / 2;
      npc->Y_pos += npc->Y_vel / 2;
    }
    else
    {
      npc->X_pos += npc->X_vel;
      npc->Y_pos += npc->Y_vel;
    }
    if ( Quote.X_Pos <= npc->X_pos + 204800 && Quote.X_Pos >= npc->X_pos - 204800 )
    {
LABEL_58:
      if ( npc->Current_State )
      {
        if ( npc->Wait_Timer < 150 )
          ++npc->Wait_Timer;
        if ( npc->Wait_Timer == 150 )
        {
          if ( !(++npc->count2 % 8) && npc->X_pos < Quote.X_Pos + 81920 && npc->X_pos > Quote.X_Pos - 81920 )
          {
            v1 = GetArcTan(npc->X_pos - Quote.X_Pos, npc->Y_pos - Quote.Y_Pos);
            v2 = Random(-6, 6) + v1;
            Y_Vel = 2 * GetSin(v2);
            X_Vel = 2 * GetCos(v2);
            NPC_Create((NPC_Names)84, npc->X_pos, npc->Y_pos, X_Vel, Y_Vel, 0, NULL, 256);
            Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          }
          if ( npc->count2 > 8 )
          {
            npc->Wait_Timer = 0;
            npc->count2 = 0;
          }
        }
      }
      if ( ++npc->ani_wait > 1 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 1 )
        npc->Ani_Num = 0;
      if ( npc->Wait_Timer > 120 && npc->Wait_Timer / 2 % 2 == 1 && npc->Ani_Num == 1 )
        npc->Ani_Num = 2;
      if ( !npc->Direction )
        npc->Rect = Rects_Left[npc->Ani_Num];
      else
        npc->Rect = Rects_Right[npc->Ani_Num];
    }
    else
    {
      npc->Current_State = 0;
      npc->X_vel = 0;
      npc->Direction = npc->count1;
      npc->X_pos = npc->Curly_Target_X;
      npc->Rect.right = 0;
      npc->Damage = 0;
    }
  }
  else if ( Quote.X_Pos >= npc->X_pos + 0x2000 || Quote.X_Pos <= npc->X_pos - 0x2000 )
  {
    npc->Rect.right = 0;
    npc->Damage = 0;
    npc->X_vel = 0;
    npc->Y_vel = 0;
    npc->Entity_Flags &= 0xFFDFu;
  }
  else
  {
    npc->Entity_Flags |= 0x20u;
    npc->Y_vel = -256;
    npc->Curly_Target_X = npc->X_pos;
    npc->Curly_Target_Y = npc->Y_pos;
    npc->Current_State = 1;
    npc->Wait_Timer = 0;
    npc->count1 = npc->Direction;
    npc->count2 = 0;
    npc->Damage = 6;
    if ( npc->Direction )
    {
      npc->X_pos = Quote.X_Pos - 0x20000;
      npc->X_vel = 767;
    }
    else
    {
      npc->X_pos = Quote.X_Pos + 0x20000;
      npc->X_vel = -767;
    }
  }
}

//----- (004321F0) --------------------------------------------------------
void __cdecl NPC59(NPC_vars *npc)
{
  RECT Rects_Normal[3]; // [sp+4h] [bp-40h]@1
  RECT Rect_Hurt; // [sp+34h] [bp-10h]@1

  Rects_Normal[0].left = 224;
  Rects_Normal[0].top = 16;
  Rects_Normal[0].right = 240;
  Rects_Normal[0].bottom = 40;
  Rects_Normal[1].left = 208;
  Rects_Normal[1].top = 80;
  Rects_Normal[1].right = 224;
  Rects_Normal[1].bottom = 104;
  Rects_Normal[2].left = 224;
  Rects_Normal[2].top = 80;
  Rects_Normal[2].right = 240;
  Rects_Normal[2].bottom = 104;
  Rect_Hurt.left = 240;
  Rect_Hurt.top = 80;
  Rect_Hurt.right = 256;
  Rect_Hurt.bottom = 104;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( npc->X_pos - 0x8000 < Quote.X_Pos
        && npc->X_pos + 0x8000 > Quote.X_Pos
        && npc->Y_pos - 0x8000 < Quote.Y_Pos
        && npc->Y_pos + 0x8000 > Quote.Y_Pos )
      {
        npc->Current_State = 2;
        npc->ani_wait = 0;
      }
      break;
    case 2:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num == 2 )
        npc->Current_State = 3;
      break;
    case 3:
      if ( npc->X_pos - 0x8000 >= Quote.X_Pos
        || npc->X_pos + 0x8000 <= Quote.X_Pos
        || npc->Y_pos - 0x8000 >= Quote.Y_Pos
        || npc->Y_pos + 0x8000 <= Quote.Y_Pos )
      {
        npc->Current_State = 4;
        npc->ani_wait = 0;
      }
      break;
    case 4:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        --npc->Ani_Num;
      }
      if ( !npc->Ani_Num )
        npc->Current_State = 1;
      break;
    default:
      break;
  }
  if ( npc->Is_Being_Hit )
    npc->Rect = Rect_Hurt;
  else
    npc->Rect = Rects_Normal[npc->Ani_Num];
}

//----- (00432460) --------------------------------------------------------
void __cdecl NPC60(NPC_vars *npc)
{
  int v1; // edx@37
  int v2; // eax@42
  int v3; // eax@50
  RECT Rects_Right[8]; // [sp+4h] [bp-100h]@1
  RECT Rects_Left[8]; // [sp+84h] [bp-80h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 64;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 80;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 64;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 80;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 64;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 80;
  Rects_Left[3].left = 16;
  Rects_Left[3].top = 64;
  Rects_Left[3].right = 32;
  Rects_Left[3].bottom = 80;
  Rects_Left[4].left = 48;
  Rects_Left[4].top = 64;
  Rects_Left[4].right = 64;
  Rects_Left[4].bottom = 80;
  Rects_Left[5].left = 16;
  Rects_Left[5].top = 64;
  Rects_Left[5].right = 32;
  Rects_Left[5].bottom = 80;
  Rects_Left[6].left = 112;
  Rects_Left[6].top = 64;
  Rects_Left[6].right = 128;
  Rects_Left[6].bottom = 80;
  Rects_Left[7].left = 128;
  Rects_Left[7].top = 64;
  Rects_Left[7].right = 144;
  Rects_Left[7].bottom = 80;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 80;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 96;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 80;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 96;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 80;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 96;
  Rects_Right[3].left = 16;
  Rects_Right[3].top = 80;
  Rects_Right[3].right = 32;
  Rects_Right[3].bottom = 96;
  Rects_Right[4].left = 48;
  Rects_Right[4].top = 80;
  Rects_Right[4].right = 64;
  Rects_Right[4].bottom = 96;
  Rects_Right[5].left = 16;
  Rects_Right[5].top = 80;
  Rects_Right[5].right = 32;
  Rects_Right[5].bottom = 96;
  Rects_Right[6].left = 112;
  Rects_Right[6].top = 80;
  Rects_Right[6].right = 128;
  Rects_Right[6].bottom = 96;
  Rects_Right[7].left = 128;
  Rects_Right[7].top = 80;
  Rects_Right[7].right = 144;
  Rects_Right[7].bottom = 96;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      npc->X_vel = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      if ( npc->X_pos - 0x2000 < Quote.X_Pos
        && npc->X_pos + 0x2000 > Quote.X_Pos
        && npc->Y_pos - 0x2000 < Quote.Y_Pos
        && npc->Y_pos + 0x2000 > Quote.Y_Pos )
      {
        if ( npc->X_pos <= Quote.X_Pos )
          npc->Direction = 2;
        else
          npc->Direction = 0;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 3:
      npc->Current_State = 4;
      npc->Ani_Num = 1;
      npc->ani_wait = 0;
      goto LABEL_17;
    case 4:
LABEL_17:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 4 )
        npc->Ani_Num = 1;
      if ( npc->Collision_flags & 1 )
      {
        npc->Direction = 2;
        npc->X_vel = 512;
      }
      if ( npc->Collision_flags & 4 )
      {
        npc->Direction = 0;
        npc->X_vel = -512;
      }
      if ( npc->Direction )
        npc->X_vel = 1024;
      else
        npc->X_vel = -1024;
      break;
    case 6:
      npc->Current_State = 7;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 1;
      npc->ani_wait = 0;
      npc->Y_vel = -1024;
      goto LABEL_30;
    case 7:
LABEL_30:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 4 )
        npc->Ani_Num = 1;
      if ( npc->Direction )
        npc->X_vel = 256;
      else
        npc->X_vel = -256;
      v1 = npc->Wait_Timer++;
      if ( v1 && npc->Collision_flags & 8 )
        npc->Current_State = 3;
      break;
    case 8:
      npc->Ani_Num = 1;
      npc->Wait_Timer = 0;
      npc->Current_State = 9;
      npc->Y_vel = -512;
      goto LABEL_42;
    case 9:
LABEL_42:
      v2 = npc->Wait_Timer++;
      if ( v2 && npc->Collision_flags & 8 )
        npc->Current_State = 0;
      break;
    case 0xA:
      npc->Current_State = 11;
      npc->Ani_Num = 6;
      npc->Y_vel = -1024;
      Play_Sound_Effect(Sfx_Toroko_Enemy_Squeal, 1);
      if ( npc->Direction )
        npc->X_vel = 256;
      else
        npc->X_vel = -256;
      break;
    case 0xB:
      v3 = npc->Wait_Timer++;
      if ( v3 && npc->Collision_flags & 8 )
      {
        npc->Current_State = 12;
        npc->Ani_Num = 7;
        npc->Entity_Flags |= 0x2000u;
      }
      break;
    case 0xC:
      npc->X_vel = 0;
      break;
    default:
      break;
  }
  npc->Y_vel += 64;
  if ( npc->X_vel > 1024 )
    npc->X_vel = 1024;
  if ( npc->X_vel < -1024 )
    npc->X_vel = -1024;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00432B50) --------------------------------------------------------
void __cdecl NPC61(NPC_vars *npc)
{
  int npc_Wait_Timer; // ecx@14
  int v2; // ST10_4@50
  int v3; // ST0C_4@50
  int v4; // ST08_4@50
  int v5; // eax@50
  RECT Rects_Right[11]; // [sp+4h] [bp-168h]@1
  int i; // [sp+B8h] [bp-B4h]@48
  RECT Rects_Left[11]; // [sp+BCh] [bp-B0h]@1

  Rects_Left[0].left = 224;
  Rects_Left[0].top = 32;
  Rects_Left[0].right = 240;
  Rects_Left[0].bottom = 48;
  Rects_Left[1].left = 240;
  Rects_Left[1].top = 32;
  Rects_Left[1].right = 256;
  Rects_Left[1].bottom = 48;
  Rects_Left[2].left = 256;
  Rects_Left[2].top = 32;
  Rects_Left[2].right = 272;
  Rects_Left[2].bottom = 48;
  Rects_Left[3].left = 272;
  Rects_Left[3].top = 32;
  Rects_Left[3].right = 288;
  Rects_Left[3].bottom = 48;
  Rects_Left[4].left = 288;
  Rects_Left[4].top = 32;
  Rects_Left[4].right = 304;
  Rects_Left[4].bottom = 48;
  Rects_Left[5].left = 224;
  Rects_Left[5].top = 32;
  Rects_Left[5].right = 240;
  Rects_Left[5].bottom = 48;
  Rects_Left[6].left = 304;
  Rects_Left[6].top = 32;
  Rects_Left[6].right = 320;
  Rects_Left[6].bottom = 48;
  Rects_Left[7].left = 224;
  Rects_Left[7].top = 32;
  Rects_Left[7].right = 240;
  Rects_Left[7].bottom = 48;
  Rects_Left[8].left = 272;
  Rects_Left[8].top = 32;
  Rects_Left[8].right = 288;
  Rects_Left[8].bottom = 48;
  Rects_Left[9].left = 0;
  Rects_Left[9].top = 0;
  Rects_Left[9].right = 0;
  Rects_Left[9].bottom = 0;
  Rects_Left[10].left = 112;
  Rects_Left[10].top = 32;
  Rects_Left[10].right = 128;
  Rects_Left[10].bottom = 48;
  Rects_Right[0].left = 224;
  Rects_Right[0].top = 48;
  Rects_Right[0].right = 240;
  Rects_Right[0].bottom = 64;
  Rects_Right[1].left = 240;
  Rects_Right[1].top = 48;
  Rects_Right[1].right = 256;
  Rects_Right[1].bottom = 64;
  Rects_Right[2].left = 256;
  Rects_Right[2].top = 48;
  Rects_Right[2].right = 272;
  Rects_Right[2].bottom = 64;
  Rects_Right[3].left = 272;
  Rects_Right[3].top = 48;
  Rects_Right[3].right = 288;
  Rects_Right[3].bottom = 64;
  Rects_Right[4].left = 288;
  Rects_Right[4].top = 48;
  Rects_Right[4].right = 304;
  Rects_Right[4].bottom = 64;
  Rects_Right[5].left = 224;
  Rects_Right[5].top = 48;
  Rects_Right[5].right = 240;
  Rects_Right[5].bottom = 64;
  Rects_Right[6].left = 304;
  Rects_Right[6].top = 48;
  Rects_Right[6].right = 320;
  Rects_Right[6].bottom = 64;
  Rects_Right[7].left = 224;
  Rects_Right[7].top = 48;
  Rects_Right[7].right = 240;
  Rects_Right[7].bottom = 64;
  Rects_Right[8].left = 272;
  Rects_Right[8].top = 48;
  Rects_Right[8].right = 288;
  Rects_Right[8].bottom = 64;
  Rects_Right[9].left = 0;
  Rects_Right[9].top = 0;
  Rects_Right[9].right = 0;
  Rects_Right[9].bottom = 0;
  Rects_Right[10].left = 112;
  Rects_Right[10].top = 32;
  Rects_Right[10].right = 128;
  Rects_Right[10].bottom = 48;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      npc->X_vel = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 5:
      npc->Ani_Num = 3;
      npc->X_vel = 0;
      break;
    case 6:
      npc->Current_State = 7;
      npc->Wait_Timer = 0;
      npc->ani_wait = 0;
      npc->Y_vel = -1024;
      goto LABEL_11;
    case 7:
LABEL_11:
      npc->Ani_Num = 2;
      if ( npc->Direction )
        npc->X_vel = 512;
      else
        npc->X_vel = -512;
      npc_Wait_Timer = npc->Wait_Timer++;
      if ( npc_Wait_Timer && npc->Collision_flags & 8 )
        npc->Current_State = 5;
      break;
    case 8:
      npc->Current_State = 9;
      npc->Ani_Num = 4;
      npc->ani_wait = 0;
      goto LABEL_19;
    case 9:
LABEL_19:
      if ( ++npc->ani_wait > 4 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 7 )
        npc->Ani_Num = 4;
      if ( npc->Direction )
        npc->X_vel = 512;
      else
        npc->X_vel = -512;
      break;
    case 0xA:
      npc->Current_State = 11;
      npc->Ani_Num = 4;
      npc->ani_wait = 0;
      goto LABEL_28;
    case 0xB:
LABEL_28:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 7 )
        npc->Ani_Num = 4;
      if ( npc->Direction )
        npc->X_vel = 1024;
      else
        npc->X_vel = -1024;
      break;
    case 0x14:
      NPC_Create((NPC_Names)145, 0, 0, 0, 0, Right, npc, 256);
      npc->Ani_Num = 0;
      npc->Current_State = 0;
      break;
    case 0x1E:
      npc->Current_State = 31;
      npc->Wait_Timer = 0;
      npc->ani_wait = 0;
      npc->Y_vel = 0;
      goto LABEL_38;
    case 0x1F:
LABEL_38:
      npc->Ani_Num = 2;
      if ( npc->Direction )
        npc->X_vel = 1536;
      else
        npc->X_vel = -1536;
      if ( npc->Collision_flags & 1 )
      {
        npc->Direction = 2;
        npc->Current_State = 7;
        npc->Wait_Timer = 0;
        npc->ani_wait = 0;
        npc->Y_vel = -1024;
        npc->X_vel = 512;
        Play_Sound_Effect(Sfx_Quote_Smash_Into_Ground, 1);
        Create_Dust_Clouds(npc->X_pos, npc->Y_pos, 2048, 4);
      }
      break;
    case 0x28:
      npc->Current_State = 42;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 8;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_45;
    case 0x2A:
LABEL_45:
      if ( ++npc->Ani_Num > 9 )
        npc->Ani_Num = 8;
      if ( ++npc->Wait_Timer > 100 )
      {
        for ( i = 0; i < 4; ++i )
        {
          v2 = Random(-1536, 0);
          v3 = Random(-341, 341);
          v4 = npc->Y_pos + (Random(-12, 12) << 9);
          v5 = Random(-12, 12);
          NPC_Create(Smoke, npc->X_pos + (v5 << 9), v4, v3, v2, 0, NULL, 256);
        }
        npc->Current_State = 50;
        npc->Entity_Spritesheet = 20;
        npc->Ani_Num = 10;
      }
      break;
    case 0x3C:
      npc->Ani_Num = 6;
      npc->Current_State = 61;
      npc->Y_vel = -1535;
      npc->X_vel = 1024;
      npc->count2 = 1;
      break;
    case 0x3D:
      npc->Y_vel += 64;
      if ( npc->Collision_flags & 8 )
      {
        npc->Current_State = 0;
        npc->count2 = 0;
        npc->X_vel = 0;
      }
      break;
    default:
      break;
  }
  if ( npc->Current_State < 30 || npc->Current_State >= 40 )
  {
    npc->Y_vel += 64;
    if ( npc->X_vel > 1024 )
      npc->X_vel = 1024;
    if ( npc->X_vel < -1024 )
      npc->X_vel = -1024;
    if ( npc->Y_vel > 1535 )
      npc->Y_vel = 1535;
  }
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (004334C0) --------------------------------------------------------
void __cdecl NPC62(NPC_vars *npc)
{
  RECT Rects[3]; // [sp+4h] [bp-30h]@1

  Rects[0].left = 272;
  Rects[0].top = 192;
  Rects[0].right = 288;
  Rects[0].bottom = 216;
  Rects[1].left = 288;
  Rects[1].top = 192;
  Rects[1].right = 304;
  Rects[1].bottom = 216;
  Rects[2].left = 304;
  Rects[2].top = 192;
  Rects[2].right = 320;
  Rects[2].bottom = 216;
  switch ( npc->Current_State )
  {
    case 0:
      npc->X_pos -= 2048;
      npc->Y_pos += 0x2000;
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      goto case_1;
    case 1:
case_1:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 1 )
        npc->Ani_Num = 0;
      if ( Random(0, 80) == 1 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      if ( Random(0, 120) == 10 )
      {
        npc->Current_State = 3;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 2;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 40 )
      {
        npc->Current_State = 3;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 2;
      }
      break;
    case 3:
      if ( ++npc->Wait_Timer > 80 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    default:
      break;
  }
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (004336C0) --------------------------------------------------------
void __cdecl NPC63(NPC_vars *npc)
{
  int v1; // ecx@12
  int v2; // ecx@36
  RECT Rects_Right[6]; // [sp+4h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+64h] [bp-60h]@1

  Rects_Left[0].left = 64;
  Rects_Left[0].top = 64;
  Rects_Left[0].right = 80;
  Rects_Left[0].bottom = 80;
  Rects_Left[1].left = 80;
  Rects_Left[1].top = 64;
  Rects_Left[1].right = 96;
  Rects_Left[1].bottom = 80;
  Rects_Left[2].left = 64;
  Rects_Left[2].top = 64;
  Rects_Left[2].right = 80;
  Rects_Left[2].bottom = 80;
  Rects_Left[3].left = 96;
  Rects_Left[3].top = 64;
  Rects_Left[3].right = 112;
  Rects_Left[3].bottom = 80;
  Rects_Left[4].left = 112;
  Rects_Left[4].top = 64;
  Rects_Left[4].right = 128;
  Rects_Left[4].bottom = 80;
  Rects_Left[5].left = 128;
  Rects_Left[5].top = 64;
  Rects_Left[5].right = 144;
  Rects_Left[5].bottom = 80;
  Rects_Right[0].left = 64;
  Rects_Right[0].top = 80;
  Rects_Right[0].right = 80;
  Rects_Right[0].bottom = 96;
  Rects_Right[1].left = 80;
  Rects_Right[1].top = 80;
  Rects_Right[1].right = 96;
  Rects_Right[1].bottom = 96;
  Rects_Right[2].left = 64;
  Rects_Right[2].top = 80;
  Rects_Right[2].right = 80;
  Rects_Right[2].bottom = 96;
  Rects_Right[3].left = 96;
  Rects_Right[3].top = 80;
  Rects_Right[3].right = 112;
  Rects_Right[3].bottom = 96;
  Rects_Right[4].left = 112;
  Rects_Right[4].top = 80;
  Rects_Right[4].right = 128;
  Rects_Right[4].bottom = 96;
  Rects_Right[5].left = 128;
  Rects_Right[5].top = 80;
  Rects_Right[5].right = 144;
  Rects_Right[5].bottom = 96;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Wait_Timer = 0;
      npc->ani_wait = 0;
      npc->Y_vel = -1024;
      goto case_1;
    case 1:
case_1:
      if ( npc->Y_vel > 0 )
        npc->Entity_Flags &= 0xFFF7u;
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 3 )
        npc->Ani_Num = 0;
      if ( npc->Direction )
        npc->X_vel = 256;
      else
        npc->X_vel = -256;
      v1 = npc->Wait_Timer++;
      if ( v1 && npc->Collision_flags & 8 )
        npc->Current_State = 2;
      break;
    case 2:
      npc->Current_State = 3;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      goto case_3;
    case 3:
case_3:
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 3 )
        npc->Ani_Num = 0;
      if ( ++npc->Wait_Timer > 50 )
      {
        npc->Wait_Timer = 40;
        npc->X_vel = -npc->X_vel;
        if ( npc->Direction )
          npc->Direction = 0;
        else
          npc->Direction = 2;
      }
      if ( npc->Wait_Timer > 35 )
        npc->Entity_Flags |= 0x20u;
      if ( npc->Direction )
        npc->X_vel += 64;
      else
        npc->X_vel -= 64;
      if ( npc->Is_Being_Hit )
      {
        npc->Current_State = 4;
        npc->Ani_Num = 4;
        npc->Y_vel = -1024;
        npc->Entity_Flags &= 0xFFDFu;
        npc->Damage = 0;
      }
      break;
    case 4:
      if ( npc->Direction )
        npc->X_vel = 256;
      else
        npc->X_vel = -256;
      v2 = npc->Wait_Timer++;
      if ( v2 && npc->Collision_flags & 8 )
      {
        npc->Current_State = 5;
        npc->Entity_Flags |= 0x2000u;
      }
      break;
    case 5:
      npc->X_vel = 0;
      npc->Ani_Num = 5;
      break;
    default:
      break;
  }
  npc->Y_vel += 64;
  if ( npc->X_vel > 1024 )
    npc->X_vel = 1024;
  if ( npc->X_vel < -1024 )
    npc->X_vel = -1024;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00433C00) --------------------------------------------------------
void __cdecl NPC64(NPC_vars *npc)
{
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 16;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 32;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Y_pos += 1536;
      npc->Current_State = 1;
      goto case_1;
    case 1:
case_1:
      if ( npc->X_pos <= Quote.X_Pos )
        npc->Direction = 2;
      else
        npc->Direction = 0;
      if ( npc->Curly_Target_X < 100 )
        ++npc->Curly_Target_X;
      if ( npc->Wait_Timer < 8
        || npc->X_pos - 57344 >= Quote.X_Pos
        || npc->X_pos + 57344 <= Quote.X_Pos
        || npc->Y_pos - 40960 >= Quote.Y_Pos
        || npc->Y_pos + 40960 <= Quote.Y_Pos )
      {
        if ( npc->Wait_Timer < 8 )
          ++npc->Wait_Timer;
        npc->Ani_Num = 0;
      }
      else
      {
        npc->Ani_Num = 1;
      }
      if ( npc->Is_Being_Hit )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      if ( npc->Wait_Timer >= 8
        && npc->Curly_Target_X >= 100
        && npc->X_pos - 0x8000 < Quote.X_Pos
        && npc->X_pos + 0x8000 > Quote.X_Pos
        && npc->Y_pos - 40960 < Quote.Y_Pos
        && npc->Y_pos + 24576 > Quote.Y_Pos )
      {
        npc->Current_State = 2;
        npc->Ani_Num = 0;
        npc->Wait_Timer = 0;
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 3;
        npc->Ani_Num = 2;
        npc->Y_vel = -1535;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
        if ( npc->Direction )
          npc->X_vel = 256;
        else
          npc->X_vel = -256;
      }
      break;
    case 3:
      if ( npc->Collision_flags & 8 )
      {
        npc->X_vel = 0;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 0;
        npc->Current_State = 1;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    default:
      break;
  }
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00433FC0) --------------------------------------------------------
void __cdecl NPC65(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-84h]@1
  RECT Rects_Right[4]; // [sp+4h] [bp-80h]@19
  RECT Rects_Left[4]; // [sp+44h] [bp-40h]@19

  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    npc->Curly_Target_X = npc->X_pos;
    npc->Curly_Target_Y = npc->Y_pos;
    npc->count1 = 120;
    npc->Current_State = 1;
    npc->Wait_Timer = Random(0, 50);
  }
  else if ( npc_Current_State != 1 )
  {
    if ( npc_Current_State == 2 )
    {
      if ( Quote.X_Pos >= npc->X_pos )
        npc->Direction = 2;
      else
        npc->Direction = 0;
      if ( npc->Curly_Target_Y < npc->Y_pos )
        npc->Y_vel -= 16;
      if ( npc->Curly_Target_Y > npc->Y_pos )
        npc->Y_vel += 16;
      if ( npc->Y_vel > 768 )
        npc->Y_vel = 768;
      if ( npc->Y_vel < -768 )
        npc->Y_vel = -768;
    }
    goto LABEL_19;
  }
  // npc->Current_State == 1
  if ( ++npc->Wait_Timer >= 50 )
  {
    npc->Wait_Timer = 0;
    npc->Current_State = 2;
    npc->Y_vel = 768;
  }
LABEL_19:
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 32;
  Rects_Left[0].top = 32;
  Rects_Left[0].right = 48;
  Rects_Left[0].bottom = 48;
  Rects_Left[1].left = 48;
  Rects_Left[1].top = 32;
  Rects_Left[1].right = 64;
  Rects_Left[1].bottom = 48;
  Rects_Left[2].left = 64;
  Rects_Left[2].top = 32;
  Rects_Left[2].right = 80;
  Rects_Left[2].bottom = 48;
  Rects_Left[3].left = 80;
  Rects_Left[3].top = 32;
  Rects_Left[3].right = 96;
  Rects_Left[3].bottom = 48;
  Rects_Right[0].left = 32;
  Rects_Right[0].top = 48;
  Rects_Right[0].right = 48;
  Rects_Right[0].bottom = 64;
  Rects_Right[1].left = 48;
  Rects_Right[1].top = 48;
  Rects_Right[1].right = 64;
  Rects_Right[1].bottom = 64;
  Rects_Right[2].left = 64;
  Rects_Right[2].top = 48;
  Rects_Right[2].right = 80;
  Rects_Right[2].bottom = 64;
  Rects_Right[3].left = 80;
  Rects_Right[3].top = 48;
  Rects_Right[3].right = 96;
  Rects_Right[3].bottom = 64;
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 2 )
    npc->Ani_Num = 0;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (004342B0) --------------------------------------------------------
void __cdecl NPC66(NPC_vars *npc)
{
  unsigned __int8 Targeting_Thingy; // ST13_1@10
  RECT *v2; // ecx@31
  char *v3; // edx@31
  int npc_Current_State; // [sp+0h] [bp-4Ch]@1
  int i; // [sp+4h] [bp-48h]@5
  RECT Rects[4]; // [sp+Ch] [bp-40h]@1

  Rects[0].left = 32;
  Rects[0].top = 192;
  Rects[0].right = 56;
  Rects[0].bottom = 216;
  Rects[1].left = 56;
  Rects[1].top = 192;
  Rects[1].right = 80;
  Rects[1].bottom = 216;
  Rects[2].left = 32;
  Rects[2].top = 216;
  Rects[2].right = 56;
  Rects[2].bottom = 240;
  Rects[3].left = 56;
  Rects[3].top = 216;
  Rects[3].right = 80;
  Rects[3].bottom = 240;
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State )
  {
    if ( npc_Current_State != 1 )
    {
      if ( npc_Current_State == 2 )
      {
        npc->X_vel -= 32;
        npc->Y_vel -= 32;
        if ( npc->X_vel < -1535 )
          npc->X_vel = -1535;
        if ( npc->Y_vel < -1535 )
          npc->Y_vel = -1535;
        if ( npc->Y_pos < -4096 )
          npc->Is_Alive = 0;
        if ( ++npc->ani_wait > 3 )
        {
          npc->ani_wait = 0;
          ++npc->Ani_Num;
        }
        if ( npc->Ani_Num > 3 )
          npc->Ani_Num = 2;
      }
      goto LABEL_31;
    }
  }
  else
  {
    for ( i = 0; i < 512 && NPC_Objects[i].Entity_Eve_Num != 1000; ++i )
      ;
    if ( i == 512 )
      goto LABEL_31;
    npc->Curly_Target_X = NPC_Objects[i].X_pos;
    npc->Curly_Target_Y = NPC_Objects[i].Y_pos;
    npc->count1 = i;
    Targeting_Thingy = GetArcTan(npc->X_pos - npc->Curly_Target_X, npc->Y_pos - npc->Curly_Target_Y);
    npc->X_vel = 2 * GetCos(Targeting_Thingy);
    npc->Y_vel = 2 * GetSin(Targeting_Thingy);
    npc->Current_State = 1;
  }
  if ( ++npc->ani_wait > 1 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 1 )
    npc->Ani_Num = 0;
  if ( npc->X_pos - 1536 < npc->Curly_Target_X
    && npc->X_pos + 1536 > npc->Curly_Target_X
    && npc->Y_pos - 1536 < npc->Curly_Target_Y
    && npc->Y_pos + 1536 > npc->Curly_Target_Y )
  {
    npc->Current_State = 2;
    npc->Ani_Num = 2;
    NPC_Objects[npc->count1].Is_Alive = 0;
    Play_Sound_Effect(Sfx_Bubble, 1);
  }
LABEL_31:
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  v2 = &Rects[npc->Ani_Num];
  v3 = (char *)&npc->Rect;
  *(_DWORD *)v3 = v2->left;
  *((_DWORD *)v3 + 1) = v2->top;
  *((_DWORD *)v3 + 2) = v2->right;
  *((_DWORD *)v3 + 3) = v2->bottom;
}

//----- (004345E0) --------------------------------------------------------
void __cdecl NPC67(NPC_vars *npc)
{
  RECT Rects_Right[8]; // [sp+4h] [bp-100h]@39
  RECT Rects_Left[8]; // [sp+84h] [bp-80h]@39

  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Curly_Target_X = npc->X_pos;
      npc->Curly_Target_Y = npc->Y_pos;
      npc->Ani_Num = 0;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto case_1;
    case 1:
case_1:
      npc->X_pos = npc->Curly_Target_X + (Random(-1, 1) << 9);
      if ( ++npc->Wait_Timer == 32 )
        npc->Current_State = 10;
      break;
    case 10:
      npc->Current_State = 11;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 0;
      npc->Y_vel = 512;
      goto case_11;
    case 11:
case_11:
      if ( npc->Curly_Target_Y < npc->Y_pos )
        npc->Y_vel -= 16;
      if ( npc->Curly_Target_Y > npc->Y_pos )
        npc->Y_vel += 16;
      if ( npc->Y_vel > 256 )
        npc->Y_vel = 256;
      if ( npc->Y_vel < -256 )
        npc->Y_vel = -256;
      break;
    case 13:
      npc->Ani_Num = 1;
      npc->Y_vel += 64;
      if ( npc->Y_vel > 1535 )
        npc->Y_vel = 1535;
      if ( npc->Collision_flags & 8 )
      {
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
        npc->Y_vel = 0;
        npc->Current_State = 14;
        npc->Entity_Flags |= 8u;
        npc->Ani_Num = 2;
      }
      break;
    case 15:
      npc->Current_State = 16;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 4;
      goto case_16;
    case 16:
case_16:
      if ( ++npc->Wait_Timer == 30 )
      {
        Play_Sound_Effect(Sfx_Bubble, 1);
        NPC_Create((NPC_Names)66, npc->X_pos, npc->Y_pos - 0x2000, 0, 0, 0, npc, 0);
      }
      if ( npc->Wait_Timer == 50 )
        npc->Current_State = 14;
      break;
    case 20:
      npc->Current_State = 21;
      npc->Ani_Num = 0;
      npc->Y_vel = 0;
      npc->Entity_Flags |= 8u;
      goto case_21;
    case 21:
case_21:
      npc->Y_vel -= 32;
      if ( npc->Y_pos < -4096 )
        npc->Is_Alive = 0;
      break;
    case 25:
      npc->Current_State = 26;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 5;
      npc->ani_wait = 0;
      goto case_26;
    case 26:
case_26:
      if ( ++npc->Ani_Num > 7 )
        npc->Ani_Num = 5;
      if ( ++npc->Wait_Timer == 30 )
      {
        Play_Sound_Effect(Sfx_Lightning, 1);
        Start_Flash(0, 0, 2);
        npc->Current_State = 27;
        npc->Ani_Num = 7;
      }
      break;
    case 27:
      if ( ++npc->Wait_Timer == 50 )
        npc->Current_State = 14;
      break;
    default:
      break;
  }
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 80;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 96;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 96;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 112;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 112;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 128;
  Rects_Left[2].bottom = 16;
  Rects_Left[3].left = 128;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 144;
  Rects_Left[3].bottom = 16;
  Rects_Left[4].left = 144;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 160;
  Rects_Left[4].bottom = 16;
  Rects_Left[5].left = 160;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 176;
  Rects_Left[5].bottom = 16;
  Rects_Left[6].left = 176;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 192;
  Rects_Left[6].bottom = 16;
  Rects_Left[7].left = 144;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 160;
  Rects_Left[7].bottom = 16;
  Rects_Right[0].left = 80;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 96;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 96;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 112;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 112;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 128;
  Rects_Right[2].bottom = 32;
  Rects_Right[3].left = 128;
  Rects_Right[3].top = 16;
  Rects_Right[3].right = 144;
  Rects_Right[3].bottom = 32;
  Rects_Right[4].left = 144;
  Rects_Right[4].top = 16;
  Rects_Right[4].right = 160;
  Rects_Right[4].bottom = 32;
  Rects_Right[5].left = 160;
  Rects_Right[5].top = 16;
  Rects_Right[5].right = 176;
  Rects_Right[5].bottom = 32;
  Rects_Right[6].left = 176;
  Rects_Right[6].top = 16;
  Rects_Right[6].right = 192;
  Rects_Right[6].bottom = 32;
  Rects_Right[7].left = 144;
  Rects_Right[7].top = 16;
  Rects_Right[7].right = 160;
  Rects_Right[7].bottom = 32;
  if ( npc->Current_State == 11 )
  {
    if ( npc->ani_wait )
    {
      --npc->ani_wait;
      npc->Ani_Num = 1;
    }
    else
    {
      if ( Random(0, 100) == 1 )
        npc->ani_wait = 30;
      npc->Ani_Num = 0;
    }
  }
  if ( npc->Current_State == 14 )
  {
    if ( npc->ani_wait )
    {
      --npc->ani_wait;
      npc->Ani_Num = 3;
    }
    else
    {
      if ( Random(0, 100) == 1 )
        npc->ani_wait = 30;
      npc->Ani_Num = 2;
    }
  }
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
  if ( npc->Current_State == 1 && npc->ani_wait < 32 )
    npc->Rect.bottom = ++npc->ani_wait / 2 + npc->Rect.bottom - 16;
}

//----- (00434D10) --------------------------------------------------------
void __cdecl NPC68(NPC_vars *npc)
{
  RECT Rects_Right[9]; // [sp+4h] [bp-120h]@62
  RECT Rects_Left[9]; // [sp+94h] [bp-90h]@62

  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->Wait_Timer = 30;
      if ( npc->X_pos <= Quote.X_Pos )
        npc->Direction = 2;
      else
        npc->Direction = 0;
      goto case_1;
    case 1:
case_1:
      if ( !--npc->Wait_Timer )
      {
        npc->Current_State = 2;
        ++npc->count1;
      }
      break;
    case 2:
      npc->Current_State = 3;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 1;
      npc->ani_wait = 0;
      goto case_3;
    case 3:
case_3:
      if ( ++npc->ani_wait > 3 )
      {
        npc->ani_wait = 0;
        if ( ++npc->Ani_Num == 2 || npc->Ani_Num == 4 )
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      if ( npc->Ani_Num > 4 )
        npc->Ani_Num = 1;
      if ( npc->Direction )
        npc->X_vel += 16;
      else
        npc->X_vel -= 16;
      if ( npc->Wait_Timer < 8
        || npc->X_pos - 6144 >= Quote.X_Pos
        || npc->X_pos + 6144 <= Quote.X_Pos
        || npc->Y_pos - 6144 >= Quote.Y_Pos
        || npc->Y_pos + 4096 <= Quote.Y_Pos )
      {
        ++npc->Wait_Timer;
        if ( npc->Collision_flags & 5 || npc->Wait_Timer > 75 )
        {
          npc->Current_State = 9;
          npc->Ani_Num = 0;
        }
        else if ( !(npc->count1 % 3) && npc->Wait_Timer > 25 )
        {
          npc->Current_State = 4;
          npc->Ani_Num = 7;
          npc->Y_vel = -1024;
        }
      }
      else
      {
        npc->Current_State = 10;
        npc->Ani_Num = 5;
        Quote.Flags |= 2u;
        Damage_Player(2);
      }
      break;
    case 4:
      if ( npc->Collision_flags & 8 )
      {
        npc->Current_State = 9;
        npc->Ani_Num = 8;
        Set_Quake(30);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      }
      if ( npc->Wait_Timer >= 8
        && npc->X_pos - 6144 < Quote.X_Pos
        && npc->X_pos + 6144 > Quote.X_Pos
        && npc->Y_pos - 6144 < Quote.Y_Pos
        && npc->Y_pos + 4096 > Quote.Y_Pos )
      {
        npc->Current_State = 10;
        npc->Ani_Num = 5;
        Quote.Flags |= 2u;
        Damage_Player(2);
      }
      break;
    case 9:
      npc->X_vel = 4 * npc->X_vel / 5;
      if ( !npc->X_vel )
        npc->Current_State = 0;
      break;
    case 10:
      Quote.X_Pos = npc->X_pos;
      Quote.Y_Pos = npc->Y_pos;
      npc->X_vel = 4 * npc->X_vel / 5;
      if ( !npc->X_vel )
      {
        npc->Current_State = 11;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 5;
        npc->ani_wait = 0;
      }
      break;
    case 11:
      Quote.X_Pos = npc->X_pos;
      Quote.Y_Pos = npc->Y_pos;
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 6 )
        npc->Ani_Num = 5;
      if ( ++npc->Wait_Timer > 100 )
        npc->Current_State = 20;
      break;
    case 20:
      Play_Sound_Effect(Sfx_Silly_Explosion, 1);
      Quote.Flags &= 0xFDu;
      if ( npc->Direction )
      {
        Quote.X_Pos -= 2048;
        Quote.Y_Pos -= 4096;
        Quote.X_Vel = -1535;
        Quote.Y_Vel = -512;
        Quote.Direction = 0;
        npc->Direction = 0;
      }
      else
      {
        Quote.X_Pos += 2048;
        Quote.Y_Pos -= 4096;
        Quote.X_Vel = 1535;
        Quote.Y_Vel = -512;
        Quote.Direction = 2;
        npc->Direction = 2;
      }
      npc->Current_State = 21;
      npc->Wait_Timer = 0;
      npc->Ani_Num = 7;
      goto case_21;
    case 21:
case_21:
      if ( ++npc->Wait_Timer >= 50 )
        npc->Current_State = 0;
      break;
    default:
      break;
  }
  npc->Y_vel += 32;
  if ( npc->X_vel < -1024 )
    npc->X_vel = -1024;
  if ( npc->X_vel > 1024 )
    npc->X_vel = 1024;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 24;
  Rects_Left[1].left = 0;
  Rects_Left[1].top = 48;
  Rects_Left[1].right = 40;
  Rects_Left[1].bottom = 72;
  Rects_Left[2].left = 0;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 40;
  Rects_Left[2].bottom = 24;
  Rects_Left[3].left = 40;
  Rects_Left[3].top = 48;
  Rects_Left[3].right = 80;
  Rects_Left[3].bottom = 72;
  Rects_Left[4].left = 0;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 40;
  Rects_Left[4].bottom = 24;
  Rects_Left[5].left = 80;
  Rects_Left[5].top = 48;
  Rects_Left[5].right = 120;
  Rects_Left[5].bottom = 72;
  Rects_Left[6].left = 120;
  Rects_Left[6].top = 48;
  Rects_Left[6].right = 160;
  Rects_Left[6].bottom = 72;
  Rects_Left[7].left = 120;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 160;
  Rects_Left[7].bottom = 24;
  Rects_Left[8].left = 80;
  Rects_Left[8].top = 0;
  Rects_Left[8].right = 120;
  Rects_Left[8].bottom = 24;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 24;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 48;
  Rects_Right[1].left = 0;
  Rects_Right[1].top = 72;
  Rects_Right[1].right = 40;
  Rects_Right[1].bottom = 96;
  Rects_Right[2].left = 0;
  Rects_Right[2].top = 24;
  Rects_Right[2].right = 40;
  Rects_Right[2].bottom = 48;
  Rects_Right[3].left = 40;
  Rects_Right[3].top = 72;
  Rects_Right[3].right = 80;
  Rects_Right[3].bottom = 96;
  Rects_Right[4].left = 0;
  Rects_Right[4].top = 24;
  Rects_Right[4].right = 40;
  Rects_Right[4].bottom = 48;
  Rects_Right[5].left = 80;
  Rects_Right[5].top = 72;
  Rects_Right[5].right = 120;
  Rects_Right[5].bottom = 96;
  Rects_Right[6].left = 120;
  Rects_Right[6].top = 72;
  Rects_Right[6].right = 160;
  Rects_Right[6].bottom = 96;
  Rects_Right[7].left = 120;
  Rects_Right[7].top = 24;
  Rects_Right[7].right = 160;
  Rects_Right[7].bottom = 48;
  Rects_Right[8].left = 80;
  Rects_Right[8].top = 24;
  Rects_Right[8].right = 120;
  Rects_Right[8].bottom = 48;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (004355F0) --------------------------------------------------------
void __cdecl NPC69(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-C8h]@32
  RECT Rects_Right[6]; // [sp+8h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+68h] [bp-60h]@1

  Rects_Left[0].left = 48;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 64;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 64;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 80;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 96;
  Rects_Left[2].bottom = 16;
  Rects_Left[3].left = 96;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 112;
  Rects_Left[3].bottom = 16;
  Rects_Left[4].left = 48;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 64;
  Rects_Left[4].bottom = 16;
  Rects_Left[5].left = 112;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 128;
  Rects_Left[5].bottom = 16;
  Rects_Right[0].left = 48;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 64;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 64;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 80;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 96;
  Rects_Right[2].bottom = 32;
  Rects_Right[3].left = 96;
  Rects_Right[3].top = 16;
  Rects_Right[3].right = 112;
  Rects_Right[3].bottom = 32;
  Rects_Right[4].left = 48;
  Rects_Right[4].top = 16;
  Rects_Right[4].right = 64;
  Rects_Right[4].bottom = 32;
  Rects_Right[5].left = 112;
  Rects_Right[5].top = 16;
  Rects_Right[5].right = 128;
  Rects_Right[5].bottom = 32;
  switch ( npc->Current_State )
  {
    case 0:
      npc->Current_State = 1;
      npc->Ani_Num = 0;
      npc->ani_wait = 0;
      npc->X_vel = 0;
      goto case_1;
    case 1:
case_1:
      if ( Random(0, 100) == 1 )
      {
        npc->Current_State = 2;
        npc->Wait_Timer = 0;
        npc->Ani_Num = 1;
      }
      else
      {
        if ( Random(0, 150) == 1 )
        {
          if ( npc->Direction )
            npc->Direction = 0;
          else
            npc->Direction = 2;
        }
        if ( Random(0, 150) == 1 )
        {
          npc->Current_State = 3;
          npc->Wait_Timer = 50;
          npc->Ani_Num = 0;
        }
      }
      break;
    case 2:
      if ( ++npc->Wait_Timer > 8 )
      {
        npc->Current_State = 1;
        npc->Ani_Num = 0;
      }
      break;
    case 3:
      npc->Current_State = 4;
      npc->Ani_Num = 2;
      npc->ani_wait = 0;
      goto case_4;
    case 4:
case_4:
      if ( !--npc->Wait_Timer )
        npc->Current_State = 0;
      if ( ++npc->ani_wait > 2 )
      {
        npc->ani_wait = 0;
        ++npc->Ani_Num;
      }
      if ( npc->Ani_Num > 4 )
        npc->Ani_Num = 2;
      if ( npc->Collision_flags & 1 )
      {
        npc->Direction = 2;
        npc->X_vel = 512;
      }
      if ( npc->Collision_flags & 4 )
      {
        npc->Direction = 0;
        npc->X_vel = -512;
      }
      if ( npc->Direction )
        npc->X_vel = 256;
      else
        npc->X_vel = -256;
      break;
    case 5:
      if ( npc->Collision_flags & 8 )
        npc->Current_State = 0;
      break;
    default:
      break;
  }
  npc_Current_State = npc->Current_State;
  if ( npc_Current_State > 0 && (npc_Current_State <= 2 || npc_Current_State == 4) && npc->Is_Being_Hit )
  {
    npc->Y_vel = -512;
    npc->Ani_Num = 5;
    npc->Current_State = 5;
  }
  npc->Y_vel += 64;
  if ( npc->Y_vel > 1535 )
    npc->Y_vel = 1535;
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00435AB0) --------------------------------------------------------
void __cdecl NPC70(NPC_vars *npc)
{
  RECT Rects[4]; // [sp+0h] [bp-40h]@1

  Rects[0].left = 96;
  Rects[0].top = 48;
  Rects[0].right = 112;
  Rects[0].bottom = 64;
  Rects[1].left = 112;
  Rects[1].top = 48;
  Rects[1].right = 128;
  Rects[1].bottom = 64;
  Rects[2].left = 128;
  Rects[2].top = 48;
  Rects[2].right = 144;
  Rects[2].bottom = 64;
  Rects[3].left = 144;
  Rects[3].top = 48;
  Rects[3].right = 160;
  Rects[3].bottom = 64;
  if ( ++npc->ani_wait > 3 )
  {
    npc->ani_wait = 0;
    ++npc->Ani_Num;
  }
  if ( npc->Ani_Num > 3 )
    npc->Ani_Num = 0;
  npc->Rect = Rects[npc->Ani_Num];
}

//----- (00435BA0) --------------------------------------------------------
void __cdecl NPC71(NPC_vars *NPC)
{
  int NPC_Current_State; // [sp+0h] [bp-64h]@1
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@13
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@13

  NPC_Current_State = NPC->Current_State;
  if ( !NPC_Current_State )
  {
    NPC->Current_State = 1;
    NPC->Curly_Target_X = NPC->X_pos;
    NPC->Curly_Target_Y = NPC->Y_pos;
    NPC->Y_vel = 128;
  }
  else if ( NPC_Current_State != 1 )
  {
    goto LABEL_13;
  }
  // NPC->Current_State == 1
  if ( NPC->Curly_Target_Y < NPC->Y_pos )
    NPC->Y_vel -= 8;
  if ( NPC->Curly_Target_Y > NPC->Y_pos )
    NPC->Y_vel += 8;
  if ( NPC->Y_vel > 256 )
    NPC->Y_vel = 256;
  if ( NPC->Y_vel < -256 )
    NPC->Y_vel = -256;
LABEL_13:
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  Rects_Left[0].left = 64;
  Rects_Left[0].top = 32;
  Rects_Left[0].right = 80;
  Rects_Left[0].bottom = 48;
  Rects_Left[1].left = 80;
  Rects_Left[1].top = 32;
  Rects_Left[1].right = 96;
  Rects_Left[1].bottom = 48;
  Rects_Left[2].left = 96;
  Rects_Left[2].top = 32;
  Rects_Left[2].right = 112;
  Rects_Left[2].bottom = 48;
  Rects_Right[0].left = 64;
  Rects_Right[0].top = 48;
  Rects_Right[0].right = 80;
  Rects_Right[0].bottom = 64;
  Rects_Right[1].left = 80;
  Rects_Right[1].top = 48;
  Rects_Right[1].right = 96;
  Rects_Right[1].bottom = 64;
  Rects_Right[2].left = 96;
  Rects_Right[2].top = 48;
  Rects_Right[2].right = 112;
  Rects_Right[2].bottom = 64;
  if ( ++NPC->ani_wait > 4 )
  {
    NPC->ani_wait = 0;
    ++NPC->Ani_Num;
  }
  if ( NPC->Ani_Num > 1 )
    NPC->Ani_Num = 0;
  if ( NPC->Is_Being_Hit )
    NPC->Ani_Num = 2;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00435DE0) --------------------------------------------------------
void __cdecl NPC72(NPC_vars *NPC)
{
  int Child_Y_Vel; // ST10_4@11 MAPDST
  int Child_X_Vel; // eax@11 MAPDST
  RECT Rects[2]; // [sp+0h] [bp-20h]@13

  if ( !NPC->Direction )
  {
    if ( ++NPC->ani_wait > 1 )
    {
      NPC->ani_wait = 0;
      ++NPC->Ani_Num;
    }
    if ( NPC->Ani_Num > 1 )
    {
      NPC->Ani_Num = 0;
      return;
    }
    if ( Quote.X_Pos < NPC->X_pos + 0x28000
      && Quote.X_Pos > NPC->X_pos - 0x28000
      && Quote.Y_Pos < NPC->Y_pos + 0x1E000
      && Quote.Y_Pos > NPC->Y_pos - 0x1E000 )
    {
      if ( ++NPC->Current_State % 2 )
      {
        Child_Y_Vel = 3 * Random(-512, 128);
        Child_X_Vel = Random(-512, 512);
        NPC_Create(Balrog_Drop_In|0x40, NPC->X_pos, NPC->Y_pos, 2 * Child_X_Vel, Child_Y_Vel, 0, NULL, 256);
      }
      Child_Y_Vel = 3 * Random(-512, 128);
      Child_X_Vel = Random(-512, 512);
      NPC_Create(Balrog_Drop_In|0x40, NPC->X_pos, NPC->Y_pos, 2 * Child_X_Vel, Child_Y_Vel, 0, NULL, 256);
    }
  }
  Rects[0].left = 224;
  Rects[0].top = 48;
  Rects[0].right = 240;
  Rects[0].bottom = 64;
  Rects[1].left = 240;
  Rects[1].top = 48;
  Rects[1].right = 256;
  Rects[1].bottom = 64;
  NPC->Rect = Rects[NPC->Ani_Num];
}

//----- (00435FC0) --------------------------------------------------------
void __cdecl NPC73(NPC_vars *NPC)
{
  RECT Rects[5]; // [sp+0h] [bp-50h]@1

  Rects[0].left = 72;
  Rects[0].top = 16;
  Rects[0].right = 74;
  Rects[0].bottom = 18;
  Rects[1].left = 74;
  Rects[1].top = 16;
  Rects[1].right = 76;
  Rects[1].bottom = 18;
  Rects[2].left = 76;
  Rects[2].top = 16;
  Rects[2].right = 78;
  Rects[2].bottom = 18;
  Rects[3].left = 78;
  Rects[3].top = 16;
  Rects[3].right = 80;
  Rects[3].bottom = 18;
  Rects[4].left = 80;
  Rects[4].top = 16;
  Rects[4].right = 82;
  Rects[4].bottom = 18;
  NPC->Y_vel += 32;
  NPC->Ani_Num = Random(0, 4);
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  NPC->Rect = Rects[NPC->Ani_Num];
  if ( NPC->Direction == 2 )
  {
    NPC->Rect.top += 2;
    NPC->Rect.bottom += 2;
  }
  if ( ++NPC->Wait_Timer > 10 )
  {
    if ( NPC->Collision_flags & 1 )
      NPC->Is_Alive = 0;
    if ( NPC->Collision_flags & 4 )
      NPC->Is_Alive = 0;
    if ( NPC->Collision_flags & 8 )
      NPC->Is_Alive = 0;
    if ( NPC->Collision_flags & 0x100 )
      NPC->Is_Alive = 0;
  }
  if ( NPC->Y_pos > Current_Map.Length << 13 )
    NPC->Is_Alive = 0;
}

//----- (00436180) --------------------------------------------------------
void __cdecl NPC74(NPC_vars *NPC)
{
  RECT Rects_Right[6]; // [sp+4h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+64h] [bp-60h]@1

  Rects_Left[0].left = 64;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 80;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 80;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 96;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 96;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 112;
  Rects_Left[2].bottom = 16;
  Rects_Left[3].left = 64;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 80;
  Rects_Left[3].bottom = 16;
  Rects_Left[4].left = 112;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 128;
  Rects_Left[4].bottom = 16;
  Rects_Left[5].left = 64;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 80;
  Rects_Left[5].bottom = 16;
  Rects_Right[0].left = 64;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 80;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 80;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 96;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 96;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 112;
  Rects_Right[2].bottom = 32;
  Rects_Right[3].left = 64;
  Rects_Right[3].top = 16;
  Rects_Right[3].right = 80;
  Rects_Right[3].bottom = 32;
  Rects_Right[4].left = 112;
  Rects_Right[4].top = 16;
  Rects_Right[4].right = 128;
  Rects_Right[4].bottom = 32;
  Rects_Right[5].left = 64;
  Rects_Right[5].top = 16;
  Rects_Right[5].right = 80;
  Rects_Right[5].bottom = 32;
  switch ( NPC->Current_State )
  {
    case 0:
      NPC->Current_State = 1;
      NPC->Ani_Num = 0;
      NPC->ani_wait = 0;
      NPC->X_vel = 0;
      goto case_1;
    case 1:
case_1:
      if ( Random(0, 120) == 10 )
      {
        NPC->Current_State = 2;
        NPC->Wait_Timer = 0;
        NPC->Ani_Num = 1;
      }
      break;
    case 2:
      if ( ++NPC->Wait_Timer > 8 )
      {
        NPC->Current_State = 1;
        NPC->Ani_Num = 0;
      }
      break;
    case 8:
      NPC->Current_State = 9;
      NPC->Ani_Num = 2;
      NPC->ani_wait = 0;
      goto case_9;
    case 9:
case_9:
      if ( ++NPC->ani_wait > 4 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 5 )
        NPC->Ani_Num = 2;
      if ( NPC->Direction )
        NPC->X_vel = 512;
      else
        NPC->X_vel = -512;
      break;
    default:
      break;
  }
  NPC->Y_vel += 64;
  if ( NPC->X_vel > 1024 )
    NPC->X_vel = 1024;
  if ( NPC->X_vel < -1024 )
    NPC->X_vel = -1024;
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00436540) --------------------------------------------------------
void __cdecl NPC75(NPC_vars *NPC)
{
  int NPC_Current_State; // [sp+0h] [bp-24h]@1
  RECT Rects[2]; // [sp+4h] [bp-20h]@1

  Rects[0].left = 272;
  Rects[0].top = 32;
  Rects[0].right = 296;
  Rects[0].bottom = 56;
  Rects[1].left = 296;
  Rects[1].top = 32;
  Rects[1].right = 320;
  Rects[1].bottom = 56;
  NPC_Current_State = NPC->Current_State;
  if ( NPC_Current_State )
  {
    if ( NPC_Current_State != 1 )
      goto LABEL_11;
  }
  else
  {
    // NPC->Current_State == 1
    NPC->Current_State = 1;
    NPC->Ani_Num = 0;
    NPC->ani_wait = 0;
  }
  NPC->Ani_Num = NPC->X_pos - 24576 < Quote.X_Pos
              && NPC->X_pos + 24576 > Quote.X_Pos
              && NPC->Y_pos - 24576 < Quote.Y_Pos
              && NPC->Y_pos + 0x2000 > Quote.Y_Pos;
LABEL_11:
  NPC->Rect = Rects[NPC->Ani_Num];
}

//----- (00436650) --------------------------------------------------------
void __cdecl NPC76(NPC_vars *NPC)
{
  NPC->Rect.left = 16 * NPC->Entity_Eve_Num;    // Rects depend on the Entity's event number... Strange
  NPC->Rect.top = 0;
  NPC->Rect.right = NPC->Rect.left + 16;
  NPC->Rect.bottom = 16;
}

//----- (00436690) --------------------------------------------------------
// NPC 77 : Sandaim the farmer
void __cdecl NPC77_Sandaim_the_Farmer(NPC_vars *NPC)
{
  int Script_State; // [sp+0h] [bp-34h]@1
  RECT Rects_Left[2]; // [sp+4h] [bp-30h]@1
  RECT Rect_Right; // [sp+24h] [bp-10h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 16;
  Rects_Left[0].right = 48;
  Rects_Left[0].bottom = 48;
  Rects_Left[1].left = 48;
  Rects_Left[1].top = 16;
  Rects_Left[1].right = 96;
  Rects_Left[1].bottom = 48;
  Rect_Right.left = 96;
  Rect_Right.top = 16;
  Rect_Right.right = 144;
  Rect_Right.bottom = 48;
  Script_State = NPC->Current_State;
  if ( !Script_State )
  {
    NPC->Current_State = 1;
    NPC->Ani_Num = 0;
    NPC->ani_wait = 0;
  }
  else if ( Script_State != 1 )
  {
    if ( Script_State == 2 && ++NPC->Wait_Timer > 8 )
    {
      NPC->Current_State = 1;
      NPC->Ani_Num = 0;
    }
    goto LABEL_11;
  }
  // NPC->Current_State == 1
  if ( Random(0, 120) == 10 )
  {
    NPC->Current_State = 2;
    NPC->Wait_Timer = 0;
    NPC->Ani_Num = 1;
  }
LABEL_11:
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rect_Right;
}

//----- (004367E0) --------------------------------------------------------
// NPC 78 : Pot
void __cdecl NPC78_Pot(NPC_vars *NPC)
{
  RECT *Cur_Rect; // ecx@3 MAPDST

  if ( !NPC->Direction )
  {
    Cur_Rect = &NPC->Rect;
    Cur_Rect->left = 160;
    Cur_Rect->top = 48;
    Cur_Rect->right = 176;
    Cur_Rect->bottom = 64;
  }
  else
  {
    Cur_Rect = &NPC->Rect;
    Cur_Rect->left = 176;
    Cur_Rect->top = 48;
    Cur_Rect->right = 192;
    Cur_Rect->bottom = 64;
  }
}

//----- (00436870) --------------------------------------------------------
void __cdecl NPC79(NPC_vars *NPC)
{
  int NPC_Current_State; // [sp+0h] [bp-64h]@1
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 16;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 16;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 32;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 32;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 48;
  Rects_Left[2].bottom = 16;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 16;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 16;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 32;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 32;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 48;
  Rects_Right[2].bottom = 32;
  NPC_Current_State = NPC->Current_State;
  if ( !NPC_Current_State )
  {
    NPC->Current_State = 1;
    NPC->Ani_Num = 2;
    NPC->ani_wait = 0;
  }
  else if ( NPC_Current_State == 2 )
  {
    NPC->Ani_Num = 0;
    if ( Random(0, 120) == 10 )
    {
      NPC->Current_State = 3;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 1;
    }
    if ( NPC->X_pos - 0x4000 < Quote.X_Pos
      && NPC->X_pos + 0x4000 > Quote.X_Pos
      && NPC->Y_pos - 0x4000 < Quote.Y_Pos
      && NPC->Y_pos + 0x2000 > Quote.Y_Pos )
    {
      if ( NPC->X_pos <= Quote.X_Pos )
        NPC->Direction = 2;
      else
        NPC->Direction = 0;
    }
  }
  else if ( NPC_Current_State == 3 && ++NPC->Wait_Timer > 8 )
  {
    NPC->Current_State = 2;
    NPC->Ani_Num = 0;
  }
  NPC->Y_vel += 64;
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->Y_pos += NPC->Y_vel;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00436AE0) --------------------------------------------------------
void __cdecl NPC80(NPC_vars *NPC)
{
  RECT Rects_Right[7]; // [sp+4h] [bp-E0h]@1
  RECT Rects_Left[7]; // [sp+74h] [bp-70h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 64;
  Rects_Left[0].right = 24;
  Rects_Left[0].bottom = 88;
  Rects_Left[1].left = 24;
  Rects_Left[1].top = 64;
  Rects_Left[1].right = 48;
  Rects_Left[1].bottom = 88;
  Rects_Left[2].left = 0;
  Rects_Left[2].top = 64;
  Rects_Left[2].right = 24;
  Rects_Left[2].bottom = 88;
  Rects_Left[3].left = 48;
  Rects_Left[3].top = 64;
  Rects_Left[3].right = 72;
  Rects_Left[3].bottom = 88;
  Rects_Left[4].left = 72;
  Rects_Left[4].top = 64;
  Rects_Left[4].right = 96;
  Rects_Left[4].bottom = 88;
  Rects_Left[5].left = 96;
  Rects_Left[5].top = 64;
  Rects_Left[5].right = 120;
  Rects_Left[5].bottom = 88;
  Rects_Left[6].left = 120;
  Rects_Left[6].top = 64;
  Rects_Left[6].right = 144;
  Rects_Left[6].bottom = 88;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 88;
  Rects_Right[0].right = 24;
  Rects_Right[0].bottom = 112;
  Rects_Right[1].left = 24;
  Rects_Right[1].top = 88;
  Rects_Right[1].right = 48;
  Rects_Right[1].bottom = 112;
  Rects_Right[2].left = 0;
  Rects_Right[2].top = 88;
  Rects_Right[2].right = 24;
  Rects_Right[2].bottom = 112;
  Rects_Right[3].left = 48;
  Rects_Right[3].top = 88;
  Rects_Right[3].right = 72;
  Rects_Right[3].bottom = 112;
  Rects_Right[4].left = 72;
  Rects_Right[4].top = 88;
  Rects_Right[4].right = 96;
  Rects_Right[4].bottom = 112;
  Rects_Right[5].left = 96;
  Rects_Right[5].top = 88;
  Rects_Right[5].right = 120;
  Rects_Right[5].bottom = 112;
  Rects_Right[6].left = 120;
  Rects_Right[6].top = 88;
  Rects_Right[6].right = 144;
  Rects_Right[6].bottom = 112;
  switch ( NPC->Current_State )
  {
    case 0:
      NPC->Entity_Flags &= 0xFFDFu;
      NPC->Current_State = 1;
      NPC->Damage = 0;
      NPC->Hitbox.front = 2048;
      goto case_1;
    case 1:
case_1:
      NPC->Ani_Num = 0;
      if ( NPC->X_pos - 0x10000 < Quote.X_Pos
        && NPC->X_pos + 0x10000 > Quote.X_Pos
        && NPC->Y_pos - 24576 < Quote.Y_Pos
        && NPC->Y_pos + 0x4000 > Quote.Y_Pos )
      {
        NPC->ani_wait = 0;
        NPC->Current_State = 2;
      }
      if ( NPC->Is_Being_Hit )
      {
        NPC->Ani_Num = 1;
        NPC->ani_wait = 0;
        NPC->Current_State = 2;
        NPC->Entity_Flags &= 0xFFDFu;
      }
      if ( Quote.X_Pos >= NPC->X_pos )
        NPC->Direction = 2;
      else
        NPC->Direction = 0;
      break;
    case 2:
      if ( ++NPC->ani_wait > 6 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 3 )
        NPC->Ani_Num = 0;
      if ( NPC->X_pos - 0x2000 < Quote.X_Pos && NPC->X_pos + 0x2000 > Quote.X_Pos )
      {
        NPC->Hitbox.front = 9216;
        NPC->Wait_Timer = 0;
        NPC->Current_State = 3;
        NPC->Entity_Flags |= 0x20u;
        Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
        if ( NPC->Direction )
          NPC->X_vel = 1024;
        else
          NPC->X_vel = -1024;
      }
      if ( Quote.X_Pos >= NPC->X_pos )
      {
        NPC->Direction = 2;
        NPC->X_vel = 256;
      }
      else
      {
        NPC->Direction = 0;
        NPC->X_vel = -256;
      }
      break;
    case 3:
      NPC->X_vel = 0;
      if ( ++NPC->Wait_Timer > 40 )
      {
        NPC->Wait_Timer = 0;
        NPC->Current_State = 4;
        Play_Sound_Effect(Sfx_Spinning_Projectile, 1);
      }
      NPC->Ani_Num = 4;
      break;
    case 4:
      NPC->Damage = 10;
      if ( ++NPC->Wait_Timer > 2 )
      {
        NPC->Wait_Timer = 0;
        NPC->Current_State = 5;
      }
      NPC->Ani_Num = 5;
      break;
    case 5:
      NPC->Ani_Num = 6;
      if ( ++NPC->Wait_Timer > 60 )
        NPC->Current_State = 0;
      break;
    default:
      break;
  }
  if ( NPC->X_vel < 0 && NPC->Collision_flags & 1 )
    NPC->X_vel = 0;
  if ( NPC->X_vel > 0 && NPC->Collision_flags & 4 )
    NPC->X_vel = 0;
  NPC->Y_vel += 32;
  if ( NPC->X_vel > 1024 )
    NPC->X_vel = 1024;
  if ( NPC->X_vel < -1024 )
    NPC->X_vel = -1024;
  if ( NPC->Y_vel > 1535 )
    NPC->X_vel = 1535;
  if ( NPC->Y_vel < -1535 )
    NPC->X_vel = -1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (004370F0) --------------------------------------------------------
void __cdecl NPC81(NPC_vars *NPC)
{
  int NPC_Current_State; // [sp+0h] [bp-C8h]@32
  RECT Rects_Right[6]; // [sp+8h] [bp-C0h]@1
  RECT Rects_Left[6]; // [sp+68h] [bp-60h]@1

  Rects_Left[0].left = 144;
  Rects_Left[0].top = 64;
  Rects_Left[0].right = 168;
  Rects_Left[0].bottom = 88;
  Rects_Left[1].left = 168;
  Rects_Left[1].top = 64;
  Rects_Left[1].right = 192;
  Rects_Left[1].bottom = 88;
  Rects_Left[2].left = 192;
  Rects_Left[2].top = 64;
  Rects_Left[2].right = 216;
  Rects_Left[2].bottom = 88;
  Rects_Left[3].left = 216;
  Rects_Left[3].top = 64;
  Rects_Left[3].right = 240;
  Rects_Left[3].bottom = 88;
  Rects_Left[4].left = 144;
  Rects_Left[4].top = 64;
  Rects_Left[4].right = 168;
  Rects_Left[4].bottom = 88;
  Rects_Left[5].left = 240;
  Rects_Left[5].top = 64;
  Rects_Left[5].right = 264;
  Rects_Left[5].bottom = 88;
  Rects_Right[0].left = 144;
  Rects_Right[0].top = 88;
  Rects_Right[0].right = 168;
  Rects_Right[0].bottom = 112;
  Rects_Right[1].left = 168;
  Rects_Right[1].top = 88;
  Rects_Right[1].right = 192;
  Rects_Right[1].bottom = 112;
  Rects_Right[2].left = 192;
  Rects_Right[2].top = 88;
  Rects_Right[2].right = 216;
  Rects_Right[2].bottom = 112;
  Rects_Right[3].left = 216;
  Rects_Right[3].top = 88;
  Rects_Right[3].right = 240;
  Rects_Right[3].bottom = 112;
  Rects_Right[4].left = 144;
  Rects_Right[4].top = 88;
  Rects_Right[4].right = 168;
  Rects_Right[4].bottom = 112;
  Rects_Right[5].left = 240;
  Rects_Right[5].top = 88;
  Rects_Right[5].right = 264;
  Rects_Right[5].bottom = 112;
  switch ( NPC->Current_State )
  {
    case 0:
      NPC->Current_State = 1;
      NPC->Ani_Num = 0;
      NPC->ani_wait = 0;
      NPC->X_vel = 0;
      goto case_1;
    case 1:
case_1:
      if ( Random(0, 100) == 1 )
      {
        NPC->Current_State = 2;
        NPC->Wait_Timer = 0;
        NPC->Ani_Num = 1;
      }
      else
      {
        if ( Random(0, 150) == 1 )
        {
          if ( NPC->Direction )
            NPC->Direction = 0;
          else
            NPC->Direction = 2;
        }
        if ( Random(0, 150) == 1 )
        {
          NPC->Current_State = 3;
          NPC->Wait_Timer = 50;
          NPC->Ani_Num = 0;
        }
      }
      break;
    case 2:
      if ( ++NPC->Wait_Timer > 8 )
      {
        NPC->Current_State = 1;
        NPC->Ani_Num = 0;
      }
      break;
    case 3:
      NPC->Current_State = 4;
      NPC->Ani_Num = 2;
      NPC->ani_wait = 0;
      goto case_4;
    case 4:
case_4:
      if ( !--NPC->Wait_Timer )
        NPC->Current_State = 0;
      if ( ++NPC->ani_wait > 2 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 4 )
        NPC->Ani_Num = 2;
      if ( NPC->Collision_flags & 1 )
      {
        NPC->Direction = 2;
        NPC->X_vel = 512;
      }
      if ( NPC->Collision_flags & 4 )
      {
        NPC->Direction = 0;
        NPC->X_vel = -512;
      }
      if ( NPC->Direction )
        NPC->X_vel = 256;
      else
        NPC->X_vel = -256;
      break;
    case 5:
      if ( NPC->Collision_flags & 8 )
        NPC->Current_State = 0;
      break;
    default:
      break;
  }
  NPC_Current_State = NPC->Current_State;
  if ( NPC_Current_State > 0 && (NPC_Current_State <= 2 || NPC_Current_State == 4) && NPC->Is_Being_Hit )
  {
    NPC->Y_vel = -512;
    NPC->Ani_Num = 5;
    NPC->Current_State = 5;
    if ( NPC->X_pos >= Quote.X_Pos )
      NPC->X_vel = -256;
    else
      NPC->X_vel = 256;
  }
  NPC->Y_vel += 64;
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (004375E0) --------------------------------------------------------
void __cdecl NPC82(NPC_vars *NPC)
{
  int Child_X_Vel; // eax@39
  int NPC_Wait_Timer; // [sp+0h] [bp-128h]@36
  RECT Rects_Right[9]; // [sp+8h] [bp-120h]@44
  RECT Rects_Left[9]; // [sp+98h] [bp-90h]@44

  switch ( NPC->Current_State )
  {
    case 0:
      NPC->Current_State = 1;
      NPC->Ani_Num = 2;
      goto case_1;
    case 1:
case_1:
      if ( Random(0, 120) == 10 )
      {
        NPC->Current_State = 2;
        NPC->Wait_Timer = 0;
        NPC->Ani_Num = 3;
      }
      break;
    case 2:
      if ( ++NPC->Wait_Timer > 8 )
      {
        NPC->Current_State = 1;
        NPC->Ani_Num = 2;
      }
      break;
    case 15:
      NPC->Current_State = 16;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 4;
      goto case_16;
    case 16:
case_16:
      if ( ++NPC->Wait_Timer == 30 )
      {
        Play_Sound_Effect(Sfx_Bubble, 1);
        NPC_Create((NPC_Names)66, NPC->X_pos, NPC->Y_pos - 0x2000, 0, 0, 0, NPC, 0);
      }
      if ( NPC->Wait_Timer == 50 )
        NPC->Current_State = 14;
      break;
    case 20:
      NPC->Current_State = 21;
      NPC->Ani_Num = 0;
      NPC->Y_vel = 0;
      NPC->Entity_Flags |= 8u;
      goto case_21;
    case 21:
case_21:
      NPC->Y_vel -= 32;
      if ( NPC->Y_pos < -4096 )
        NPC->Is_Alive = 0;
      break;
    case 25:
      NPC->Current_State = 26;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 5;
      NPC->ani_wait = 0;
      goto case_26;
    case 26:
case_26:
      if ( ++NPC->Ani_Num > 7 )
        NPC->Ani_Num = 5;
      if ( ++NPC->Wait_Timer == 30 )
      {
        Play_Sound_Effect(Sfx_Lightning, 1);
        Start_Flash(0, 0, 2);
        NPC->Current_State = 27;
        NPC->Ani_Num = 7;
      }
      break;
    case 27:
      if ( ++NPC->Wait_Timer == 50 )
      {
        NPC->Current_State = 0;
        NPC->Ani_Num = 0;
      }
      break;
    case 30:
      NPC->Current_State = 31;
      NPC->Ani_Num = 3;
      NPC->ani_wait = 0;
      goto case_31;
    case 31:
case_31:
      if ( ++NPC->ani_wait > 10 )
      {
        NPC->Current_State = 32;
        NPC->Ani_Num = 4;
        NPC->ani_wait = 0;
      }
      break;
    case 32:
      if ( ++NPC->ani_wait > 100 )
      {
        NPC->Current_State = 1;
        NPC->Ani_Num = 2;
      }
      break;
    case 40:
      NPC->Current_State = 41;
      NPC->Wait_Timer = 0;
      goto case_41;
    case 41:
case_41:
      NPC->Ani_Num = 4;
      NPC_Wait_Timer = ++NPC->Wait_Timer;
      if ( NPC_Wait_Timer == 30 || NPC_Wait_Timer == 40 || NPC_Wait_Timer == 50 )
      {
        Child_X_Vel = Random(-512, 0);
        NPC_Create(
          Projectile_Balrog_Energy_Bounce,
          NPC->X_pos + 4096,
          NPC->Y_pos - 4096,
          1536,
          Child_X_Vel,
          Left,
          NULL,
          256);
        Play_Sound_Effect(Sfx_Fireball_Shoot, 1);
      }
      if ( NPC->Wait_Timer > 50 )
        NPC->Current_State = 0;
      break;
    case 50:
      NPC->Ani_Num = 8;
      break;
    default:
      break;
  }
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  Rects_Left[0].left = 80;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 96;
  Rects_Left[0].bottom = 16;
  Rects_Left[1].left = 96;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 112;
  Rects_Left[1].bottom = 16;
  Rects_Left[2].left = 112;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 128;
  Rects_Left[2].bottom = 16;
  Rects_Left[3].left = 128;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 144;
  Rects_Left[3].bottom = 16;
  Rects_Left[4].left = 144;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 160;
  Rects_Left[4].bottom = 16;
  Rects_Left[5].left = 160;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 176;
  Rects_Left[5].bottom = 16;
  Rects_Left[6].left = 176;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 192;
  Rects_Left[6].bottom = 16;
  Rects_Left[7].left = 144;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 160;
  Rects_Left[7].bottom = 16;
  Rects_Left[8].left = 208;
  Rects_Left[8].top = 64;
  Rects_Left[8].right = 224;
  Rects_Left[8].bottom = 80;
  Rects_Right[0].left = 80;
  Rects_Right[0].top = 16;
  Rects_Right[0].right = 96;
  Rects_Right[0].bottom = 32;
  Rects_Right[1].left = 96;
  Rects_Right[1].top = 16;
  Rects_Right[1].right = 112;
  Rects_Right[1].bottom = 32;
  Rects_Right[2].left = 112;
  Rects_Right[2].top = 16;
  Rects_Right[2].right = 128;
  Rects_Right[2].bottom = 32;
  Rects_Right[3].left = 128;
  Rects_Right[3].top = 16;
  Rects_Right[3].right = 144;
  Rects_Right[3].bottom = 32;
  Rects_Right[4].left = 144;
  Rects_Right[4].top = 16;
  Rects_Right[4].right = 160;
  Rects_Right[4].bottom = 32;
  Rects_Right[5].left = 160;
  Rects_Right[5].top = 16;
  Rects_Right[5].right = 176;
  Rects_Right[5].bottom = 32;
  Rects_Right[6].left = 176;
  Rects_Right[6].top = 16;
  Rects_Right[6].right = 192;
  Rects_Right[6].bottom = 32;
  Rects_Right[7].left = 144;
  Rects_Right[7].top = 16;
  Rects_Right[7].right = 160;
  Rects_Right[7].bottom = 32;
  Rects_Right[8].left = 208;
  Rects_Right[8].top = 80;
  Rects_Right[8].right = 224;
  Rects_Right[8].bottom = 96;
  if ( NPC->Current_State == 11 )
  {
    if ( NPC->ani_wait )
    {
      --NPC->ani_wait;
      NPC->Ani_Num = 1;
    }
    else
    {
      if ( Random(0, 100) == 1 )
        NPC->ani_wait = 30;
      NPC->Ani_Num = 0;
    }
  }
  if ( NPC->Current_State == 14 )
  {
    if ( NPC->ani_wait )
    {
      --NPC->ani_wait;
      NPC->Ani_Num = 3;
    }
    else
    {
      if ( Random(0, 100) == 1 )
        NPC->ani_wait = 30;
      NPC->Ani_Num = 2;
    }
  }
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00437D90) --------------------------------------------------------
void __cdecl NPC83(NPC_vars *NPC)
{
  RECT Rects_Right[8]; // [sp+4h] [bp-100h]@1
  RECT Rects_Left[8]; // [sp+84h] [bp-80h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 40;
  Rects_Left[1].left = 40;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 80;
  Rects_Left[1].bottom = 40;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 120;
  Rects_Left[2].bottom = 40;
  Rects_Left[3].left = 0;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 40;
  Rects_Left[3].bottom = 40;
  Rects_Left[4].left = 120;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 160;
  Rects_Left[4].bottom = 40;
  Rects_Left[5].left = 0;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 40;
  Rects_Left[5].bottom = 40;
  Rects_Left[6].left = 160;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 200;
  Rects_Left[6].bottom = 40;
  Rects_Left[7].left = 200;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 240;
  Rects_Left[7].bottom = 40;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 40;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 80;
  Rects_Right[1].left = 40;
  Rects_Right[1].top = 40;
  Rects_Right[1].right = 80;
  Rects_Right[1].bottom = 80;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 40;
  Rects_Right[2].right = 120;
  Rects_Right[2].bottom = 80;
  Rects_Right[3].left = 0;
  Rects_Right[3].top = 40;
  Rects_Right[3].right = 40;
  Rects_Right[3].bottom = 80;
  Rects_Right[4].left = 120;
  Rects_Right[4].top = 40;
  Rects_Right[4].right = 160;
  Rects_Right[4].bottom = 80;
  Rects_Right[5].left = 0;
  Rects_Right[5].top = 40;
  Rects_Right[5].right = 40;
  Rects_Right[5].bottom = 80;
  Rects_Right[6].left = 160;
  Rects_Right[6].top = 40;
  Rects_Right[6].right = 200;
  Rects_Right[6].bottom = 80;
  Rects_Right[7].left = 200;
  Rects_Right[7].top = 40;
  Rects_Right[7].right = 240;
  Rects_Right[7].bottom = 80;
  switch ( NPC->Current_State )
  {
    case 0:
      NPC->X_vel = 0;
      NPC->Current_State = 1;
      NPC->Ani_Num = 0;
      NPC->ani_wait = 0;
      goto case_1;
    case 1:
case_1:
      if ( ++NPC->ani_wait > 5 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 1 )
        NPC->Ani_Num = 0;
      break;
    case 2:
      NPC->Current_State = 3;
      NPC->Ani_Num = 2;
      NPC->ani_wait = 0;
      goto case_3;
    case 3:
case_3:
      if ( ++NPC->ani_wait > 3 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 5 )
        NPC->Ani_Num = 2;
      if ( NPC->Direction )
        NPC->X_vel = 512;
      else
        NPC->X_vel = -512;
      break;
    case 4:
      NPC->X_vel = 0;
      NPC->Current_State = 5;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 6;
      goto case_5;
    case 5:
case_5:
      if ( ++NPC->Wait_Timer > 10 )
      {
        NPC->Wait_Timer = 0;
        NPC->Current_State = 6;
        NPC->Ani_Num = 7;
        Play_Sound_Effect(Sfx_Enemy_Smoke_Poof, 1);
      }
      break;
    case 6:
      if ( ++NPC->Wait_Timer > 8 )
      {
        NPC->Current_State = 0;
        NPC->Ani_Num = 0;
      }
      break;
    case 7:
      NPC->Current_State = 1;
      break;
    default:
      break;
  }
  NPC->Y_vel += 64;
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00438250) --------------------------------------------------------
void __cdecl NPC84(NPC_vars *NPC)
{
  RECT Rects[4]; // [sp+0h] [bp-40h]@3

  if ( NPC->Collision_flags & 0xFF )
  {
    Create_Effect(NPC->X_pos, NPC->Y_pos, 2, 0);
    NPC->Is_Alive = 0;
  }
  NPC->Y_pos += NPC->Y_vel;
  NPC->X_pos += NPC->X_vel;
  Rects[0].left = 48;
  Rects[0].top = 48;
  Rects[0].right = 64;
  Rects[0].bottom = 64;
  Rects[1].left = 64;
  Rects[1].top = 48;
  Rects[1].right = 80;
  Rects[1].bottom = 64;
  Rects[2].left = 48;
  Rects[2].top = 64;
  Rects[2].right = 64;
  Rects[2].bottom = 80;
  Rects[3].left = 64;
  Rects[3].top = 64;
  Rects[3].right = 80;
  Rects[3].bottom = 80;
  if ( ++NPC->ani_wait > 2 )
  {
    NPC->ani_wait = 0;
    ++NPC->Ani_Num;
  }
  if ( NPC->Ani_Num > 3 )
    NPC->Ani_Num = 0;
  NPC->Rect = Rects[NPC->Ani_Num];
  if ( ++NPC->count1 > 300 )
  {
    Create_Effect(NPC->X_pos, NPC->Y_pos, 2, 0);
    NPC->Is_Alive = 0;
  }
}

//----- (004383D0) --------------------------------------------------------
void __cdecl NPC85(NPC_vars *NPC)
{
  int NPC_Current_State; // [sp+0h] [bp-64h]@1
  RECT Rects_Right[3]; // [sp+4h] [bp-60h]@1
  RECT Rects_Left[3]; // [sp+34h] [bp-30h]@1

  Rects_Left[0].left = 256;
  Rects_Left[0].top = 96;
  Rects_Left[0].right = 272;
  Rects_Left[0].bottom = 120;
  Rects_Left[1].left = 256;
  Rects_Left[1].top = 96;
  Rects_Left[1].right = 272;
  Rects_Left[1].bottom = 120;
  Rects_Left[2].left = 272;
  Rects_Left[2].top = 96;
  Rects_Left[2].right = 288;
  Rects_Left[2].bottom = 120;
  Rects_Right[0].left = 256;
  Rects_Right[0].top = 96;
  Rects_Right[0].right = 272;
  Rects_Right[0].bottom = 120;
  Rects_Right[1].left = 288;
  Rects_Right[1].top = 96;
  Rects_Right[1].right = 304;
  Rects_Right[1].bottom = 120;
  Rects_Right[2].left = 304;
  Rects_Right[2].top = 96;
  Rects_Right[2].right = 320;
  Rects_Right[2].bottom = 120;
  NPC_Current_State = NPC->Current_State;
  if ( !NPC_Current_State )
  {
    NPC->Ani_Num = 0;
    if ( NPC->X_pos - 4096 < Quote.X_Pos
      && NPC->X_pos + 4096 > Quote.X_Pos
      && NPC->Y_pos - 0x2000 < Quote.Y_Pos
      && NPC->Y_pos + 4096 > Quote.Y_Pos )
    {
      Play_Sound_Effect(Sfx_Computer_Screen_On, 1);
      NPC->Current_State = 1;
    }
  }
  else if ( NPC_Current_State == 1 && ++NPC->Ani_Num > 2 )
  {
    NPC->Ani_Num = 1;
  }
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00438590) --------------------------------------------------------
void __cdecl NPC86(NPC_vars *NPC)
{
  RECT *Cur_Rect; // eax@34
  int NPC_EXP_Amount; // [sp+0h] [bp-54h]@21
  RECT Rects_Much_EXP[2]; // [sp+14h] [bp-40h]@1
  RECT Rects_Not_Much_EXP[2]; // [sp+34h] [bp-20h]@1

  Rects_Not_Much_EXP[0].left = 0;
  Rects_Not_Much_EXP[0].top = 80;
  Rects_Not_Much_EXP[0].right = 16;
  Rects_Not_Much_EXP[0].bottom = 96;
  Rects_Not_Much_EXP[1].left = 16;
  Rects_Not_Much_EXP[1].top = 80;
  Rects_Not_Much_EXP[1].right = 32;
  Rects_Not_Much_EXP[1].bottom = 96;
  Rects_Much_EXP[0].left = 0;
  Rects_Much_EXP[0].top = 112;
  Rects_Much_EXP[0].right = 16;
  Rects_Much_EXP[0].bottom = 128;
  Rects_Much_EXP[1].left = 16;
  Rects_Much_EXP[1].top = 112;
  Rects_Much_EXP[1].right = 32;
  Rects_Much_EXP[1].bottom = 128;
  if ( !NPC->Direction )
  {
    if ( ++NPC->ani_wait > 2 )
    {
      NPC->ani_wait = 0;
      ++NPC->Ani_Num;
    }
    if ( NPC->Ani_Num > 1 )
      NPC->Ani_Num = 0;
  }
  if ( Current_Background.Mode == 5 || Current_Background.Mode == 6 )
  {
    if ( !NPC->Current_State )
    {
      NPC->Current_State = 1;
      NPC->Y_vel = Random(-32, 32);
      NPC->X_vel = Random(127, 256);
    }
    NPC->X_vel -= 8;
    if ( NPC->X_pos < 40960 )
      NPC->Is_Alive = 0;
    if ( NPC->X_pos < -1536 )
      NPC->X_pos = -1536;
    if ( NPC->Collision_flags & 1 )
      NPC->X_vel = 256;
    if ( NPC->Collision_flags & 2 )
      NPC->Y_vel = 64;
    if ( NPC->Collision_flags & 8 )
      NPC->Y_vel = -64;
    NPC->X_pos += NPC->X_vel;
    NPC->Y_pos += NPC->Y_vel;
  }
  NPC_EXP_Amount = NPC->EXP_Amount;
  if ( NPC_EXP_Amount == 1 )
  {
    NPC->Rect = Rects_Not_Much_EXP[NPC->Ani_Num];
  }
  else if ( NPC_EXP_Amount == 3 )
  {
    NPC->Rect = Rects_Much_EXP[NPC->Ani_Num];
  }
  if ( !NPC->Direction )
    ++NPC->count1;
  if ( NPC->count1 > 550 )
    NPC->Is_Alive = 0;
  if ( NPC->count1 > 500 && NPC->count1 / 2 % 2 )
    NPC->Rect.right = 0;
  if ( NPC->count1 > 547 )
  {
    Cur_Rect = &NPC->Rect;
    Cur_Rect->left = 16;
    Cur_Rect->top = 0;
    Cur_Rect->right = 32;
    Cur_Rect->bottom = 16;
  }
}

//----- (00438850) --------------------------------------------------------
void __cdecl NPC87(NPC_vars *NPC)
{
  int NPC_EXP_Amount; // [sp+0h] [bp-54h]@21
  RECT Rects_Not_Much_EXP[2]; // [sp+4h] [bp-50h]@1
  RECT Rects_Count_Thingy; // [sp+24h] [bp-30h]@1
  RECT Rects_Much_EXP[2]; // [sp+34h] [bp-20h]@1

  Rects_Not_Much_EXP[0].left = 32;
  Rects_Not_Much_EXP[0].top = 80;
  Rects_Not_Much_EXP[0].right = 48;
  Rects_Not_Much_EXP[0].bottom = 96;
  Rects_Not_Much_EXP[1].left = 48;
  Rects_Not_Much_EXP[1].top = 80;
  Rects_Not_Much_EXP[1].right = 64;
  Rects_Not_Much_EXP[1].bottom = 96;
  Rects_Much_EXP[0].left = 64;
  Rects_Much_EXP[0].top = 80;
  Rects_Much_EXP[0].right = 80;
  Rects_Much_EXP[0].bottom = 96;
  Rects_Much_EXP[1].left = 80;
  Rects_Much_EXP[1].top = 80;
  Rects_Much_EXP[1].right = 96;
  Rects_Much_EXP[1].bottom = 96;
  Rects_Count_Thingy.left = 16;
  Rects_Count_Thingy.top = 0;
  Rects_Count_Thingy.right = 32;
  Rects_Count_Thingy.bottom = 16;
  if ( !NPC->Direction )
  {
    if ( ++NPC->ani_wait > 2 )
    {
      NPC->ani_wait = 0;
      ++NPC->Ani_Num;
    }
    if ( NPC->Ani_Num > 1 )
      NPC->Ani_Num = 0;
  }
  if ( Current_Background.Mode == 5 || Current_Background.Mode == 6 )
  {
    if ( !NPC->Current_State )
    {
      NPC->Current_State = 1;
      NPC->Y_vel = Random(-32, 32);
      NPC->X_vel = Random(127, 256);
    }
    NPC->X_vel -= 8;
    if ( NPC->X_pos < 40960 )
      NPC->Is_Alive = 0;
    if ( NPC->X_pos < -1536 )
      NPC->X_pos = -1536;
    if ( NPC->Collision_flags & 1 )
      NPC->X_vel = 256;
    if ( NPC->Collision_flags & 2 )
      NPC->Y_vel = 64;
    if ( NPC->Collision_flags & 8 )
      NPC->Y_vel = -64;
    NPC->X_pos += NPC->X_vel;
    NPC->Y_pos += NPC->Y_vel;
  }
  NPC_EXP_Amount = NPC->EXP_Amount;
  if ( NPC_EXP_Amount == 2 )
  {
    NPC->Rect = Rects_Not_Much_EXP[NPC->Ani_Num];
  }
  else if ( NPC_EXP_Amount == 6 )
  {
    NPC->Rect = Rects_Much_EXP[NPC->Ani_Num];
  }
  if ( !NPC->Direction )
    ++NPC->count1;
  if ( NPC->count1 > 550 )
    NPC->Is_Alive = 0;
  if ( NPC->count1 > 500 && NPC->count1 / 2 % 2 )
    NPC->Rect.right = 0;
  if ( NPC->count1 > 547 )
    NPC->Rect = Rects_Count_Thingy;
}

//----- (00438B10) --------------------------------------------------------
void __cdecl NPC88(NPC_vars *NPC)
{
  int v1; // ST10_4@49
  int v2; // ST0C_4@49
  int v3; // ST08_4@49
  int v4; // eax@49
  int Y_Vel; // ST24_4@62
  RECT Rects_Right[12]; // [sp+8h] [bp-190h]@1
  int X_Vel; // [sp+C8h] [bp-D0h]@62
  int i; // [sp+CCh] [bp-CCh]@47
  RECT Rects_Left[12]; // [sp+D0h] [bp-C8h]@1
  unsigned __int8 v10; // [sp+197h] [bp-1h]@60

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 40;
  Rects_Left[1].left = 40;
  Rects_Left[1].top = 0;
  Rects_Left[1].right = 80;
  Rects_Left[1].bottom = 40;
  Rects_Left[2].left = 80;
  Rects_Left[2].top = 0;
  Rects_Left[2].right = 120;
  Rects_Left[2].bottom = 40;
  Rects_Left[3].left = 0;
  Rects_Left[3].top = 0;
  Rects_Left[3].right = 40;
  Rects_Left[3].bottom = 40;
  Rects_Left[4].left = 120;
  Rects_Left[4].top = 0;
  Rects_Left[4].right = 160;
  Rects_Left[4].bottom = 40;
  Rects_Left[5].left = 0;
  Rects_Left[5].top = 0;
  Rects_Left[5].right = 40;
  Rects_Left[5].bottom = 40;
  Rects_Left[6].left = 160;
  Rects_Left[6].top = 0;
  Rects_Left[6].right = 200;
  Rects_Left[6].bottom = 40;
  Rects_Left[7].left = 200;
  Rects_Left[7].top = 0;
  Rects_Left[7].right = 240;
  Rects_Left[7].bottom = 40;
  Rects_Left[8].left = 0;
  Rects_Left[8].top = 80;
  Rects_Left[8].right = 40;
  Rects_Left[8].bottom = 120;
  Rects_Left[9].left = 40;
  Rects_Left[9].top = 80;
  Rects_Left[9].right = 80;
  Rects_Left[9].bottom = 120;
  Rects_Left[10].left = 240;
  Rects_Left[10].top = 0;
  Rects_Left[10].right = 280;
  Rects_Left[10].bottom = 40;
  Rects_Left[11].left = 280;
  Rects_Left[11].top = 0;
  Rects_Left[11].right = 320;
  Rects_Left[11].bottom = 40;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 40;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 80;
  Rects_Right[1].left = 40;
  Rects_Right[1].top = 40;
  Rects_Right[1].right = 80;
  Rects_Right[1].bottom = 80;
  Rects_Right[2].left = 80;
  Rects_Right[2].top = 40;
  Rects_Right[2].right = 120;
  Rects_Right[2].bottom = 80;
  Rects_Right[3].left = 0;
  Rects_Right[3].top = 40;
  Rects_Right[3].right = 40;
  Rects_Right[3].bottom = 80;
  Rects_Right[4].left = 120;
  Rects_Right[4].top = 40;
  Rects_Right[4].right = 160;
  Rects_Right[4].bottom = 80;
  Rects_Right[5].left = 0;
  Rects_Right[5].top = 40;
  Rects_Right[5].right = 40;
  Rects_Right[5].bottom = 80;
  Rects_Right[6].left = 160;
  Rects_Right[6].top = 40;
  Rects_Right[6].right = 200;
  Rects_Right[6].bottom = 80;
  Rects_Right[7].left = 200;
  Rects_Right[7].top = 40;
  Rects_Right[7].right = 240;
  Rects_Right[7].bottom = 80;
  Rects_Right[8].left = 120;
  Rects_Right[8].top = 80;
  Rects_Right[8].right = 160;
  Rects_Right[8].bottom = 120;
  Rects_Right[9].left = 160;
  Rects_Right[9].top = 80;
  Rects_Right[9].right = 200;
  Rects_Right[9].bottom = 120;
  Rects_Right[10].left = 240;
  Rects_Right[10].top = 40;
  Rects_Right[10].right = 280;
  Rects_Right[10].bottom = 80;
  Rects_Right[11].left = 280;
  Rects_Right[11].top = 40;
  Rects_Right[11].right = 320;
  Rects_Right[11].bottom = 80;
  switch ( NPC->Current_State )
  {
    case 0:
      NPC->X_vel = 0;
      NPC->Current_State = 1;
      NPC->Ani_Num = 0;
      NPC->ani_wait = 0;
      goto case_1;
    case 1:
case_1:
      if ( ++NPC->ani_wait > 5 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 1 )
        NPC->Ani_Num = 0;
      if ( ++NPC->Wait_Timer > 50 )
        NPC->Current_State = 2;
      break;
    case 2:
      NPC->Current_State = 3;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 2;
      NPC->ani_wait = 0;
      if ( ++NPC->count1 >= 3 && NPC->Life <= 150 )
      {
        NPC->count2 = 1;
        if ( Quote.X_Pos >= NPC->X_pos )
          NPC->Direction = 0;
        else
          NPC->Direction = 2;
      }
      else
      {
        NPC->count2 = 0;
        if ( Quote.X_Pos >= NPC->X_pos )
          NPC->Direction = 2;
        else
          NPC->Direction = 0;
      }
      goto case_3;
    case 3:
case_3:
      ++NPC->Wait_Timer;
      if ( ++NPC->ani_wait > 3 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num > 5 )
        NPC->Ani_Num = 2;
      if ( NPC->Direction )
        NPC->X_vel = 512;
      else
        NPC->X_vel = -512;
      if ( NPC->count2 )
      {
        if ( NPC->Wait_Timer > 16 )
        {
          NPC->Current_State = 9;
          NPC->X_vel = 0;
          NPC->Ani_Num = 10;
        }
      }
      else if ( NPC->Wait_Timer <= 50 )
      {
        if ( NPC->Direction )
        {
          if ( NPC->X_pos + 12288 > Quote.X_Pos )
            NPC->Current_State = 4;
        }
        else if ( NPC->X_pos - 12288 < Quote.X_Pos )
        {
          NPC->Current_State = 4;
        }
      }
      else
      {
        NPC->Ani_Num = 8;
        NPC->Y_vel = -1024;
        NPC->Current_State = 7;
        NPC->Wait_Timer = 0;
        NPC->X_vel = 3 * NPC->X_vel / 2;
        NPC->Damage = 2;
      }
      break;
    case 4:
      NPC->X_vel = 0;
      NPC->Current_State = 5;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 6;
      goto case_5;
    case 5:
case_5:
      if ( ++NPC->Wait_Timer > 12 )
      {
        NPC->Wait_Timer = 0;
        NPC->Current_State = 6;
        NPC->Ani_Num = 7;
        Play_Sound_Effect(Sfx_Enemy_Smoke_Poof, 1);
        NPC->Damage = 5;
        NPC->Hitbox.front = 12288;
        NPC->Hitbox.top = 1;
      }
      break;
    case 6:
      if ( ++NPC->Wait_Timer > 10 )
      {
        NPC->Current_State = 0;
        NPC->Ani_Num = 0;
        NPC->Damage = 0;
        NPC->Hitbox.front = 4096;
        NPC->Hitbox.top = 0x2000;
      }
      break;
    case 7:
      if ( NPC->Collision_flags & 8 )
      {
        NPC->Current_State = 8;
        NPC->Ani_Num = 9;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
        NPC->Damage = 0;
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = NPC->Y_pos + (Random(-12, 12) << 9);
          v4 = Random(-12, 12);
          NPC_Create(Smoke, NPC->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
      }
      break;
    case 8:
      NPC->X_vel = 0;
      if ( ++NPC->Wait_Timer > 10 )
      {
        NPC->Current_State = 0;
        NPC->Ani_Num = 0;
        NPC->Damage = 0;
      }
      break;
    case 9:
      NPC->Current_State = 10;
      NPC->Wait_Timer = 0;
      if ( Quote.X_Pos >= NPC->X_pos )
        NPC->Direction = 2;
      else
        NPC->Direction = 0;
      goto case_10;
    case 10:
case_10:
      if ( ++NPC->Wait_Timer > 100 && NPC->Wait_Timer % 6 == 1 )
      {
        if ( NPC->Direction )
          v10 = -8;
        else
          v10 = -120;
        v10 += Random(-16, 16);
        Y_Vel = 3 * GetSin(v10);
        X_Vel = 3 * GetCos(v10);
        NPC_Create(Projectile_Balrog_Energy_Bounce, NPC->X_pos, NPC->Y_pos + 2048, X_Vel, Y_Vel, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      }
      if ( NPC->Wait_Timer > 50 && NPC->Wait_Timer / 2 % 2 )
        NPC->Ani_Num = 11;
      else
        NPC->Ani_Num = 10;
      if ( NPC->Wait_Timer > 132 )
      {
        NPC->Current_State = 0;
        NPC->Ani_Num = 0;
        NPC->count1 = 0;
      }
      break;
    default:
      break;
  }
  NPC->Y_vel += 64;
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( !NPC->Direction )
    NPC->Rect = Rects_Left[NPC->Ani_Num];
  else
    NPC->Rect = Rects_Right[NPC->Ani_Num];
}

//----- (00439580) --------------------------------------------------------
void __cdecl NPC89(NPC_vars *NPC)
{
  int Child_Y_Vel; // ST10_4@7
  int Child_X_Vel; // ST0C_4@7
  int Child_Y_Pos; // ST08_4@7
  int Child_X_Pos; // eax@7
  int Child_Y_Vel_; // ST10_4@12
  int Child_X_Vel_; // ST0C_4@12
  int Child_Y_Pos_; // ST08_4@12
  int Child_X_Pos_; // eax@12
  RECT *NPC_Rect; // eax@15 MAPDST
  int _Child_Y_Vel; // ST10_4@26
  int _Child_X_Vel; // ST0C_4@26
  int _Child_Y_Pos; // ST08_4@26
  int _Child_X_Pos; // eax@26
  RECT Rects_Right[4]; // [sp+4h] [bp-88h]@1
  int i; // [sp+48h] [bp-44h]@5
  RECT Rects_Left[4]; // [sp+4Ch] [bp-40h]@1

  Rects_Left[0].left = 80;
  Rects_Left[0].top = 80;
  Rects_Left[0].right = 120;
  Rects_Left[0].bottom = 120;
  Rects_Left[1].left = 240;
  Rects_Left[1].top = 80;
  Rects_Left[1].right = 264;
  Rects_Left[1].bottom = 104;
  Rects_Left[2].left = 264;
  Rects_Left[2].top = 80;
  Rects_Left[2].right = 288;
  Rects_Left[2].bottom = 104;
  Rects_Left[3].left = 288;
  Rects_Left[3].top = 80;
  Rects_Left[3].right = 312;
  Rects_Left[3].bottom = 104;
  Rects_Right[0].left = 200;
  Rects_Right[0].top = 80;
  Rects_Right[0].right = 240;
  Rects_Right[0].bottom = 120;
  Rects_Right[1].left = 240;
  Rects_Right[1].top = 104;
  Rects_Right[1].right = 264;
  Rects_Right[1].bottom = 128;
  Rects_Right[2].left = 264;
  Rects_Right[2].top = 104;
  Rects_Right[2].right = 288;
  Rects_Right[2].bottom = 128;
  Rects_Right[3].left = 288;
  Rects_Right[3].top = 104;
  Rects_Right[3].right = 312;
  Rects_Right[3].bottom = 128;
  switch ( NPC->Current_State )
  {
    case 0:
      Play_Sound_Effect(Sfx_Explosion, 1);
      if ( NPC->X_pos <= Quote.X_Pos )
        NPC->Direction = 2;
      else
        NPC->Direction = 0;
      for ( i = 0; i < 8; ++i )
      {
        Child_Y_Vel = Random(-1536, 0);
        Child_X_Vel = Random(-341, 341);
        Child_Y_Pos = NPC->Y_pos + (Random(-12, 12) << 9);
        Child_X_Pos = Random(-12, 12);
        NPC_Create(Smoke, NPC->X_pos + (Child_X_Pos << 9), Child_Y_Pos, Child_X_Vel, Child_Y_Vel, Left, NULL, 256);
      }
      NPC->Current_State = 1;
      goto case_1;
    case 1:
case_1:
      if ( ++NPC->Wait_Timer > 100 )
      {
        NPC->Wait_Timer = 0;
        NPC->Current_State = 2;
      }
      if ( !(NPC->Wait_Timer % 5) )
      {
        Child_Y_Vel_ = Random(-1536, 0);
        Child_X_Vel_ = Random(-341, 341);
        Child_Y_Pos_ = NPC->Y_pos + (Random(-12, 12) << 9);
        Child_X_Pos_ = Random(-12, 12);
        NPC_Create(Smoke, NPC->X_pos + (Child_X_Pos_ << 9), Child_Y_Pos_, Child_X_Vel_, Child_Y_Vel_, 0, NULL, 256);
      }
      if ( NPC->Direction )
      {
        NPC_Rect = &NPC->Rect;
        NPC_Rect->left = Rects_Right[0].left;
        NPC_Rect->top = Rects_Right[0].top;
        NPC_Rect->right = Rects_Right[0].right;
        NPC_Rect->bottom = Rects_Right[0].bottom;
      }
      else
      {
        NPC_Rect = &NPC->Rect;
        NPC_Rect->left = Rects_Left[0].left;
        NPC_Rect->top = Rects_Left[0].top;
        NPC_Rect->right = Rects_Left[0].right;
        NPC_Rect->bottom = Rects_Left[0].bottom;
      }
      if ( NPC->Wait_Timer / 2 % 2 )
        --NPC->Rect.left;
      break;
    case 2:
      if ( ++NPC->Wait_Timer / 2 % 2 && NPC->Wait_Timer < 100 )
      {
        NPC->Ani_Num = 0;
        NPC->view.back = 10240;
        NPC->view.front = 10240;
        NPC->view.top = 10240;
      }
      else
      {
        NPC->Ani_Num = 1;
        NPC->view.back = 6144;
        NPC->view.front = 6144;
        NPC->view.top = 4096;
      }
      if ( NPC->Wait_Timer > 150 )
      {
        NPC->Wait_Timer = 0;
        NPC->Current_State = 3;
        NPC->Ani_Num = 1;
      }
      if ( !(NPC->Wait_Timer % 9) )
      {
        _Child_Y_Vel = Random(-1536, 0);
        _Child_X_Vel = Random(-341, 341);
        _Child_Y_Pos = NPC->Y_pos + (Random(-12, 12) << 9);
        _Child_X_Pos = Random(-12, 12);
        NPC_Create(Smoke, NPC->X_pos + (_Child_X_Pos << 9), _Child_Y_Pos, _Child_X_Vel, _Child_Y_Vel, Left, NULL, 256);
      }
      if ( !NPC->Direction )
        NPC->Rect = Rects_Left[NPC->Ani_Num];
      else
        NPC->Rect = Rects_Right[NPC->Ani_Num];
      break;
    case 3:
      if ( ++NPC->ani_wait > 50 )
      {
        NPC->ani_wait = 0;
        ++NPC->Ani_Num;
      }
      if ( NPC->Ani_Num == 3 )
        NPC->Current_State = 4;
      if ( !NPC->Direction )
        NPC->Rect = Rects_Left[NPC->Ani_Num];
      else
        NPC->Rect = Rects_Right[NPC->Ani_Num];
      break;
    default:
      break;
  }
  NPC->Y_vel += 64;
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
}

//----- (00439B00) --------------------------------------------------------
void __cdecl NPC90(NPC_vars *NPC)
{
  RECT *NPC_Rect; // eax@1

  NPC_Rect = &NPC->Rect;
  NPC_Rect->left = 280;
  NPC_Rect->top = 80;
  NPC_Rect->right = 296;
  NPC_Rect->bottom = 104;
}

//----- (00439B50) --------------------------------------------------------
signed int __cdecl NPC91(int a1)
{
  int v1; // ecx@3
  signed int result; // eax@3

  if ( !*(_DWORD *)(a1 + 116) )
  {
    ++*(_DWORD *)(a1 + 116);
    *(_DWORD *)(a1 + 12) += 0x2000;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 96;
  *(_DWORD *)(v1 + 4) = 88;
  *(_DWORD *)(v1 + 8) = 128;
  result = 112;
  *(_DWORD *)(v1 + 12) = 112;
  return result;
}

//----- (00439BC0) --------------------------------------------------------
int __cdecl NPC92(int a1)
{
  int *v1; // ecx@17
  int v2; // edx@17
  int result; // eax@17
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 272;
  v5 = 216;
  v6 = 288;
  v7 = 240;
  v8 = 288;
  v9 = 216;
  v10 = 304;
  v11 = 240;
  v12 = 304;
  v13 = 216;
  v14 = 320;
  v15 = 240;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) -= 2048;
      *(_DWORD *)(a1 + 12) += 0x2000;
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( Random(0, 80) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 40 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
      }
      break;
    case 3:
      if ( ++*(_DWORD *)(a1 + 120) > 80 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00439DC0) --------------------------------------------------------
int __cdecl NPC93(int a1)
{
  int *v1; // eax@28
  int v2; // ecx@28
  int result; // eax@28
  int *v4; // eax@29
  int v5; // ecx@29
  int v6; // [sp+4h] [bp-E0h]@1
  int v7; // [sp+8h] [bp-DCh]@1
  int v8; // [sp+Ch] [bp-D8h]@1
  int v9; // [sp+10h] [bp-D4h]@1
  int v10; // [sp+14h] [bp-D0h]@1
  int v11; // [sp+18h] [bp-CCh]@1
  int v12; // [sp+1Ch] [bp-C8h]@1
  int v13; // [sp+20h] [bp-C4h]@1
  int v14; // [sp+24h] [bp-C0h]@1
  int v15; // [sp+28h] [bp-BCh]@1
  int v16; // [sp+2Ch] [bp-B8h]@1
  int v17; // [sp+30h] [bp-B4h]@1
  int v18; // [sp+34h] [bp-B0h]@1
  int v19; // [sp+38h] [bp-ACh]@1
  int v20; // [sp+3Ch] [bp-A8h]@1
  int v21; // [sp+40h] [bp-A4h]@1
  int v22; // [sp+44h] [bp-A0h]@1
  int v23; // [sp+48h] [bp-9Ch]@1
  int v24; // [sp+4Ch] [bp-98h]@1
  int v25; // [sp+50h] [bp-94h]@1
  int v26; // [sp+54h] [bp-90h]@1
  int v27; // [sp+58h] [bp-8Ch]@1
  int v28; // [sp+5Ch] [bp-88h]@1
  int v29; // [sp+60h] [bp-84h]@1
  int v30; // [sp+64h] [bp-80h]@1
  int v31; // [sp+68h] [bp-7Ch]@1
  int v32; // [sp+6Ch] [bp-78h]@1
  int v33; // [sp+70h] [bp-74h]@1
  int v34; // [sp+74h] [bp-70h]@1
  int v35; // [sp+78h] [bp-6Ch]@1
  int v36; // [sp+7Ch] [bp-68h]@1
  int v37; // [sp+80h] [bp-64h]@1
  int v38; // [sp+84h] [bp-60h]@1
  int v39; // [sp+88h] [bp-5Ch]@1
  int v40; // [sp+8Ch] [bp-58h]@1
  int v41; // [sp+90h] [bp-54h]@1
  int v42; // [sp+94h] [bp-50h]@1
  int v43; // [sp+98h] [bp-4Ch]@1
  int v44; // [sp+9Ch] [bp-48h]@1
  int v45; // [sp+A0h] [bp-44h]@1
  int v46; // [sp+A4h] [bp-40h]@1
  int v47; // [sp+A8h] [bp-3Ch]@1
  int v48; // [sp+ACh] [bp-38h]@1
  int v49; // [sp+B0h] [bp-34h]@1
  int v50; // [sp+B4h] [bp-30h]@1
  int v51; // [sp+B8h] [bp-2Ch]@1
  int v52; // [sp+BCh] [bp-28h]@1
  int v53; // [sp+C0h] [bp-24h]@1
  int v54; // [sp+C4h] [bp-20h]@1
  int v55; // [sp+C8h] [bp-1Ch]@1
  int v56; // [sp+CCh] [bp-18h]@1
  int v57; // [sp+D0h] [bp-14h]@1
  int v58; // [sp+D4h] [bp-10h]@1
  int v59; // [sp+D8h] [bp-Ch]@1
  int v60; // [sp+DCh] [bp-8h]@1
  int v61; // [sp+E0h] [bp-4h]@1

  v34 = 128;
  v35 = 0;
  v36 = 144;
  v37 = 16;
  v38 = 144;
  v39 = 0;
  v40 = 160;
  v41 = 16;
  v42 = 160;
  v43 = 0;
  v44 = 176;
  v45 = 16;
  v46 = 128;
  v47 = 0;
  v48 = 144;
  v49 = 16;
  v50 = 176;
  v51 = 0;
  v52 = 192;
  v53 = 16;
  v54 = 128;
  v55 = 0;
  v56 = 144;
  v57 = 16;
  v58 = 32;
  v59 = 32;
  v60 = 48;
  v61 = 48;
  v6 = 128;
  v7 = 16;
  v8 = 144;
  v9 = 32;
  v10 = 144;
  v11 = 16;
  v12 = 160;
  v13 = 32;
  v14 = 160;
  v15 = 16;
  v16 = 176;
  v17 = 32;
  v18 = 128;
  v19 = 16;
  v20 = 144;
  v21 = 32;
  v22 = 176;
  v23 = 16;
  v24 = 192;
  v25 = 32;
  v26 = 128;
  v27 = 16;
  v28 = 144;
  v29 = 32;
  v30 = 32;
  v31 = 32;
  v32 = 48;
  v33 = 48;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_DWORD *)(a1 + 8) - 0x4000 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 0x4000 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 3:
      *(_DWORD *)(a1 + 116) = 4;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_17;
    case 4:
LABEL_17:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) += 512;
      else
        *(_DWORD *)(a1 + 8) -= 512;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 104) = 6;
      if ( ++*(_DWORD *)(a1 + 120) > 200 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 5, 0);
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v34 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (0043A220) --------------------------------------------------------
// NPC 94 : Giant Jelly
int __cdecl NPC94_Giant_Jelly(int a1)
{
  int *v1; // edx@46
  int result; // eax@46
  int v3; // [sp+4h] [bp-50h]@1
  int v4; // [sp+8h] [bp-4Ch]@1
  int v5; // [sp+Ch] [bp-48h]@1
  int v6; // [sp+10h] [bp-44h]@1
  int v7; // [sp+14h] [bp-40h]@1
  int v8; // [sp+18h] [bp-3Ch]@1
  int v9; // [sp+1Ch] [bp-38h]@1
  int v10; // [sp+20h] [bp-34h]@1
  int v11; // [sp+24h] [bp-30h]@1
  int v12; // [sp+28h] [bp-2Ch]@1
  int v13; // [sp+2Ch] [bp-28h]@1
  int v14; // [sp+30h] [bp-24h]@1
  int v15; // [sp+34h] [bp-20h]@1
  int v16; // [sp+38h] [bp-1Ch]@1
  int v17; // [sp+3Ch] [bp-18h]@1
  int v18; // [sp+40h] [bp-14h]@1
  int v19; // [sp+44h] [bp-10h]@1
  int v20; // [sp+48h] [bp-Ch]@1
  int v21; // [sp+4Ch] [bp-8h]@1
  int v22; // [sp+50h] [bp-4h]@1

  v3 = 272;
  v4 = 0;
  v5 = 320;
  v6 = 24;
  v7 = 272;
  v8 = 24;
  v9 = 320;
  v10 = 48;
  v11 = 272;
  v12 = 48;
  v13 = 320;
  v14 = 72;
  v15 = 272;
  v16 = 72;
  v17 = 320;
  v18 = 96;
  v19 = 272;
  v20 = 96;
  v21 = 320;
  v22 = 120;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 104) = 4;
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xA:
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
      if ( ++*(_DWORD *)(a1 + 120) > 40 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 116) = 11;
      }
      break;
    case 0xB:
      if ( ++*(_DWORD *)(a1 + 100) > 5 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 104) = 3;
      }
      break;
    case 0xC:
      *(_DWORD *)(a1 + 20) = -341;
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 16) /= 2;
      *(_DWORD *)(a1 + 20) += 32;
      if ( !*(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 120) = 30;
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_BYTE *)(a1 + 156) )
  {
    if ( ++*(_DWORD *)(a1 + 112) > 12 )
    {
      *(_DWORD *)(a1 + 116) = 20;
      *(_DWORD *)(a1 + 104) = 4;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 4u;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 112) = 0;
  }
  if ( *(_DWORD *)(a1 + 116) >= 10 )
  {
    if ( *(_DWORD *)(a1 + 4) & 1 )
    {
      *(_DWORD *)(a1 + 108) = 50;
      *(_DWORD *)(a1 + 76) = 2;
    }
    if ( *(_DWORD *)(a1 + 4) & 4 )
    {
      *(_DWORD *)(a1 + 108) = 50;
      *(_DWORD *)(a1 + 76) = 0;
    }
    if ( *(_DWORD *)(a1 + 108) )
    {
      --*(_DWORD *)(a1 + 108);
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) += 128;
      else
        *(_DWORD *)(a1 + 16) -= 128;
    }
    else
    {
      *(_DWORD *)(a1 + 108) = 50;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
    }
    *(_DWORD *)(a1 + 20) += 16;
    if ( *(_DWORD *)(a1 + 4) & 8 )
      *(_DWORD *)(a1 + 20) = -1024;
  }
  if ( *(_DWORD *)(a1 + 16) > 256 )
    *(_DWORD *)(a1 + 16) = 256;
  if ( *(_DWORD *)(a1 + 16) < -256 )
    *(_DWORD *)(a1 + 16) = -256;
  if ( *(_DWORD *)(a1 + 20) > 768 )
    *(_DWORD *)(a1 + 20) = 768;
  if ( *(_DWORD *)(a1 + 20) < -768 )
    *(_DWORD *)(a1 + 20) = -768;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0043A680) --------------------------------------------------------
int __cdecl NPC95(int a1)
{
  int *v1; // edx@44
  int result; // eax@44
  int *v3; // edx@45
  int v4; // [sp+4h] [bp-80h]@1
  int v5; // [sp+8h] [bp-7Ch]@1
  int v6; // [sp+Ch] [bp-78h]@1
  int v7; // [sp+10h] [bp-74h]@1
  int v8; // [sp+14h] [bp-70h]@1
  int v9; // [sp+18h] [bp-6Ch]@1
  int v10; // [sp+1Ch] [bp-68h]@1
  int v11; // [sp+20h] [bp-64h]@1
  int v12; // [sp+24h] [bp-60h]@1
  int v13; // [sp+28h] [bp-5Ch]@1
  int v14; // [sp+2Ch] [bp-58h]@1
  int v15; // [sp+30h] [bp-54h]@1
  int v16; // [sp+34h] [bp-50h]@1
  int v17; // [sp+38h] [bp-4Ch]@1
  int v18; // [sp+3Ch] [bp-48h]@1
  int v19; // [sp+40h] [bp-44h]@1
  int v20; // [sp+44h] [bp-40h]@1
  int v21; // [sp+48h] [bp-3Ch]@1
  int v22; // [sp+4Ch] [bp-38h]@1
  int v23; // [sp+50h] [bp-34h]@1
  int v24; // [sp+54h] [bp-30h]@1
  int v25; // [sp+58h] [bp-2Ch]@1
  int v26; // [sp+5Ch] [bp-28h]@1
  int v27; // [sp+60h] [bp-24h]@1
  int v28; // [sp+64h] [bp-20h]@1
  int v29; // [sp+68h] [bp-1Ch]@1
  int v30; // [sp+6Ch] [bp-18h]@1
  int v31; // [sp+70h] [bp-14h]@1
  int v32; // [sp+74h] [bp-10h]@1
  int v33; // [sp+78h] [bp-Ch]@1
  int v34; // [sp+7Ch] [bp-8h]@1
  int v35; // [sp+80h] [bp-4h]@1

  v20 = 208;
  v21 = 64;
  v22 = 224;
  v23 = 80;
  v24 = 224;
  v25 = 64;
  v26 = 240;
  v27 = 80;
  v28 = 240;
  v29 = 64;
  v30 = 256;
  v31 = 80;
  v32 = 256;
  v33 = 64;
  v34 = 272;
  v35 = 80;
  v4 = 208;
  v5 = 80;
  v6 = 224;
  v7 = 96;
  v8 = 224;
  v9 = 80;
  v10 = 240;
  v11 = 96;
  v12 = 240;
  v13 = 80;
  v14 = 256;
  v15 = 96;
  v16 = 256;
  v17 = 80;
  v18 = 272;
  v19 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = Random(0, 50);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = -512;
      else
        *(_DWORD *)(a1 + 16) = 512;
      goto LABEL_5;
    case 1:
LABEL_5:
      if ( --*(_DWORD *)(a1 + 120) > 0 )
        break;
      *(_DWORD *)(a1 + 116) = 10;
      goto LABEL_7;
    case 0xA:
LABEL_7:
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 116) = 11;
      }
      break;
    case 0xB:
      if ( ++*(_DWORD *)(a1 + 100) > 5 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) == 2 )
      {
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) += 256;
        else
          *(_DWORD *)(a1 + 16) -= 256;
        *(_DWORD *)(a1 + 20) -= 512;
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 104) = 3;
      }
      break;
    case 0xC:
      ++*(_DWORD *)(a1 + 120);
      if ( *(_DWORD *)(a1 + 12) > *(_DWORD *)(a1 + 36) && *(_DWORD *)(a1 + 120) > 10 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 8) <= *(_DWORD *)(a1 + 32) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 4) & 1 )
  {
    *(_DWORD *)(a1 + 108) = 50;
    *(_DWORD *)(a1 + 76) = 2;
  }
  if ( *(_DWORD *)(a1 + 4) & 4 )
  {
    *(_DWORD *)(a1 + 108) = 50;
    *(_DWORD *)(a1 + 76) = 0;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 4) & 8 )
    *(_DWORD *)(a1 + 20) = -1024;
  if ( *(_DWORD *)(a1 + 16) > 256 )
    *(_DWORD *)(a1 + 16) = 256;
  if ( *(_DWORD *)(a1 + 16) < -256 )
    *(_DWORD *)(a1 + 16) = -256;
  if ( *(_DWORD *)(a1 + 20) > 512 )
    *(_DWORD *)(a1 + 20) = 512;
  if ( *(_DWORD *)(a1 + 20) < -512 )
    *(_DWORD *)(a1 + 20) = -512;
  if ( *(_BYTE *)(a1 + 156) )
  {
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16) / 2;
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20) / 2;
  }
  else
  {
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v20 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (0043AAF0) --------------------------------------------------------
int __cdecl NPC96(int a1)
{
  int v1; // eax@18
  int *v2; // ecx@24
  int v3; // edx@24
  int result; // eax@24
  int v5; // [sp+0h] [bp-34h]@1
  int v6; // [sp+4h] [bp-30h]@1
  int v7; // [sp+8h] [bp-2Ch]@1
  int v8; // [sp+Ch] [bp-28h]@1
  int v9; // [sp+10h] [bp-24h]@1
  int v10; // [sp+14h] [bp-20h]@1
  int v11; // [sp+18h] [bp-1Ch]@1
  int v12; // [sp+1Ch] [bp-18h]@1
  int v13; // [sp+20h] [bp-14h]@1
  int v14; // [sp+24h] [bp-10h]@1
  int v15; // [sp+28h] [bp-Ch]@1
  int v16; // [sp+2Ch] [bp-8h]@1
  int v17; // [sp+30h] [bp-4h]@1

  v6 = 272;
  v7 = 120;
  v8 = 288;
  v9 = 136;
  v10 = 288;
  v11 = 120;
  v12 = 304;
  v13 = 136;
  v14 = 304;
  v15 = 120;
  v16 = 320;
  v17 = 136;
  v5 = *(_DWORD *)(a1 + 116);
  if ( !v5 )
  {
    if ( *(_DWORD *)(a1 + 76) == 2 )
      *(_DWORD *)(a1 + 116) = 2;
    else
      *(_DWORD *)(a1 + 104) = 1;
    goto LABEL_8;
  }
  if ( v5 == 1 )
  {
LABEL_8:
    *(_DWORD *)(a1 + 104) = 0;
    goto LABEL_24;
  }
  if ( v5 == 2 )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 0 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
    if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
      && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 122880
      && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 122880
      && Random(0, 5) == 1 )
    {
      v1 = Random(-8, 8);
      NPC_Create(Enemy_Basil|0xC0, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v1 << 9), 0, 0, 0, NULL, 256);
    }
    if ( Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 4096
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 4096
      && Quote.X_Pos < *(_DWORD *)(a1 + 8)
      && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 49152 )
    {
      Quote.X_Vel -= 136;
      Quote.Flags |= 0x20u;
    }
  }
LABEL_24:
  v2 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  v3 = a1 + 84;
  *(_DWORD *)v3 = *v2;
  *(_DWORD *)(v3 + 4) = v2[1];
  result = v2[2];
  *(_DWORD *)(v3 + 8) = result;
  *(_DWORD *)(v3 + 12) = v2[3];
  return result;
}

//----- (0043AD10) --------------------------------------------------------
int __cdecl NPC97(int a1)
{
  int v1; // ST08_4@18
  int v2; // eax@18
  int *v3; // edx@24
  int result; // eax@24
  int v5; // [sp+0h] [bp-34h]@1
  int v6; // [sp+4h] [bp-30h]@1
  int v7; // [sp+8h] [bp-2Ch]@1
  int v8; // [sp+Ch] [bp-28h]@1
  int v9; // [sp+10h] [bp-24h]@1
  int v10; // [sp+14h] [bp-20h]@1
  int v11; // [sp+18h] [bp-1Ch]@1
  int v12; // [sp+1Ch] [bp-18h]@1
  int v13; // [sp+20h] [bp-14h]@1
  int v14; // [sp+24h] [bp-10h]@1
  int v15; // [sp+28h] [bp-Ch]@1
  int v16; // [sp+2Ch] [bp-8h]@1
  int v17; // [sp+30h] [bp-4h]@1

  v6 = 272;
  v7 = 136;
  v8 = 288;
  v9 = 152;
  v10 = 288;
  v11 = 136;
  v12 = 304;
  v13 = 152;
  v14 = 304;
  v15 = 136;
  v16 = 320;
  v17 = 152;
  v5 = *(_DWORD *)(a1 + 116);
  if ( !v5 )
  {
    if ( *(_DWORD *)(a1 + 76) == 2 )
      *(_DWORD *)(a1 + 116) = 2;
    else
      *(_DWORD *)(a1 + 104) = 1;
    goto LABEL_8;
  }
  if ( v5 == 1 )
  {
LABEL_8:
    *(_DWORD *)(a1 + 104) = 0;
    goto LABEL_24;
  }
  if ( v5 == 2 )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 0 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
    if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
      && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 122880
      && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 122880
      && Random(0, 5) == 1 )
    {
      v1 = *(_DWORD *)(a1 + 12);
      v2 = Random(-8, 8);
      NPC_Create(Enemy_Basil|0xC0, *(_DWORD *)(a1 + 8) + (v2 << 9), v1, 0, 0, Up, NULL, 256);
    }
    if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 4096
      && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 4096
      && Quote.Y_Pos < *(_DWORD *)(a1 + 12)
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 49152 )
    {
      Quote.Y_Vel -= 136;
    }
  }
LABEL_24:
  v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v3;
  *(_DWORD *)(result + 4) = v3[1];
  *(_DWORD *)(result + 8) = v3[2];
  *(_DWORD *)(result + 12) = v3[3];
  return result;
}

//----- (0043AF20) --------------------------------------------------------
int __cdecl NPC98(int a1)
{
  int v1; // eax@18
  int *v2; // ecx@24
  int v3; // edx@24
  int result; // eax@24
  int v5; // [sp+0h] [bp-34h]@1
  int v6; // [sp+4h] [bp-30h]@1
  int v7; // [sp+8h] [bp-2Ch]@1
  int v8; // [sp+Ch] [bp-28h]@1
  int v9; // [sp+10h] [bp-24h]@1
  int v10; // [sp+14h] [bp-20h]@1
  int v11; // [sp+18h] [bp-1Ch]@1
  int v12; // [sp+1Ch] [bp-18h]@1
  int v13; // [sp+20h] [bp-14h]@1
  int v14; // [sp+24h] [bp-10h]@1
  int v15; // [sp+28h] [bp-Ch]@1
  int v16; // [sp+2Ch] [bp-8h]@1
  int v17; // [sp+30h] [bp-4h]@1

  v6 = 272;
  v7 = 152;
  v8 = 288;
  v9 = 168;
  v10 = 288;
  v11 = 152;
  v12 = 304;
  v13 = 168;
  v14 = 304;
  v15 = 152;
  v16 = 320;
  v17 = 168;
  v5 = *(_DWORD *)(a1 + 116);
  if ( !v5 )
  {
    if ( *(_DWORD *)(a1 + 76) == 2 )
      *(_DWORD *)(a1 + 116) = 2;
    else
      *(_DWORD *)(a1 + 104) = 1;
    goto LABEL_8;
  }
  if ( v5 == 1 )
  {
LABEL_8:
    *(_DWORD *)(a1 + 104) = 0;
    goto LABEL_24;
  }
  if ( v5 == 2 )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 0 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
    if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
      && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 122880
      && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 122880
      && Random(0, 5) == 1 )
    {
      v1 = Random(-8, 8);
      NPC_Create(Enemy_Basil|0xC0, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v1 << 9), 0, 0, Right, NULL, 256);
    }
    if ( Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 4096
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 4096
      && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 49152
      && Quote.X_Pos > *(_DWORD *)(a1 + 8) )
    {
      Quote.X_Vel += 136;
      Quote.Flags |= 0x20u;
    }
  }
LABEL_24:
  v2 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  v3 = a1 + 84;
  *(_DWORD *)v3 = *v2;
  *(_DWORD *)(v3 + 4) = v2[1];
  result = v2[2];
  *(_DWORD *)(v3 + 8) = result;
  *(_DWORD *)(v3 + 12) = v2[3];
  return result;
}

//----- (0043B140) --------------------------------------------------------
int __cdecl NPC99(int a1)
{
  int v1; // ST08_4@18
  int v2; // eax@18
  int *v3; // edx@24
  int result; // eax@24
  int v5; // [sp+0h] [bp-34h]@1
  int v6; // [sp+4h] [bp-30h]@1
  int v7; // [sp+8h] [bp-2Ch]@1
  int v8; // [sp+Ch] [bp-28h]@1
  int v9; // [sp+10h] [bp-24h]@1
  int v10; // [sp+14h] [bp-20h]@1
  int v11; // [sp+18h] [bp-1Ch]@1
  int v12; // [sp+1Ch] [bp-18h]@1
  int v13; // [sp+20h] [bp-14h]@1
  int v14; // [sp+24h] [bp-10h]@1
  int v15; // [sp+28h] [bp-Ch]@1
  int v16; // [sp+2Ch] [bp-8h]@1
  int v17; // [sp+30h] [bp-4h]@1

  v6 = 272;
  v7 = 168;
  v8 = 288;
  v9 = 184;
  v10 = 288;
  v11 = 168;
  v12 = 304;
  v13 = 184;
  v14 = 304;
  v15 = 168;
  v16 = 320;
  v17 = 184;
  v5 = *(_DWORD *)(a1 + 116);
  if ( !v5 )
  {
    if ( *(_DWORD *)(a1 + 76) == 2 )
      *(_DWORD *)(a1 + 116) = 2;
    else
      *(_DWORD *)(a1 + 104) = 1;
    goto LABEL_8;
  }
  if ( v5 == 1 )
  {
LABEL_8:
    *(_DWORD *)(a1 + 104) = 0;
    goto LABEL_24;
  }
  if ( v5 == 2 )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 0 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
    if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
      && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 122880
      && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 122880
      && Random(0, 5) == 1 )
    {
      v1 = *(_DWORD *)(a1 + 12);
      v2 = Random(-8, 8);
      NPC_Create(Enemy_Basil|0xC0, *(_DWORD *)(a1 + 8) + (v2 << 9), v1, 0, 0, Down, NULL, 256);
    }
    if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 4096
      && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 4096
      && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 49152
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) )
    {
      Quote.Y_Vel += 136;
    }
  }
LABEL_24:
  v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v3;
  *(_DWORD *)(result + 4) = v3[1];
  *(_DWORD *)(result + 8) = v3[2];
  *(_DWORD *)(result + 12) = v3[3];
  return result;
}

//----- (0043B350) --------------------------------------------------------
signed int __cdecl NPC100(int a1)
{
  int v1; // ecx@3
  signed int result; // eax@3

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 12) += 0x2000;
    *(_DWORD *)(a1 + 116) = 1;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 272;
  *(_DWORD *)(v1 + 4) = 48;
  *(_DWORD *)(v1 + 8) = 288;
  result = 64;
  *(_DWORD *)(v1 + 12) = 64;
  return result;
}

//----- (0043B410) --------------------------------------------------------
int __cdecl NPC101(int a1)
{
  int *v1; // eax@5
  int v2; // ecx@5
  int result; // eax@5
  int v4; // [sp+0h] [bp-30h]@1
  int v5; // [sp+4h] [bp-2Ch]@1
  int v6; // [sp+8h] [bp-28h]@1
  int v7; // [sp+Ch] [bp-24h]@1
  int v8; // [sp+10h] [bp-20h]@1
  int v9; // [sp+14h] [bp-1Ch]@1
  int v10; // [sp+18h] [bp-18h]@1
  int v11; // [sp+1Ch] [bp-14h]@1
  int v12; // [sp+20h] [bp-10h]@1
  int v13; // [sp+24h] [bp-Ch]@1
  int v14; // [sp+28h] [bp-8h]@1
  int v15; // [sp+2Ch] [bp-4h]@1

  v4 = 240;
  v5 = 136;
  v6 = 256;
  v7 = 152;
  v8 = 240;
  v9 = 136;
  v10 = 256;
  v11 = 152;
  v12 = 256;
  v13 = 136;
  v14 = 272;
  v15 = 152;
  if ( ++*(_DWORD *)(a1 + 100) > 3 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0043B4E0) --------------------------------------------------------
int __cdecl NPC102(int a1)
{
  int *v1; // edx@7
  int result; // eax@7
  int v3; // [sp+0h] [bp-40h]@1
  int v4; // [sp+4h] [bp-3Ch]@1
  int v5; // [sp+8h] [bp-38h]@1
  int v6; // [sp+Ch] [bp-34h]@1
  int v7; // [sp+10h] [bp-30h]@1
  int v8; // [sp+14h] [bp-2Ch]@1
  int v9; // [sp+18h] [bp-28h]@1
  int v10; // [sp+1Ch] [bp-24h]@1
  int v11; // [sp+20h] [bp-20h]@1
  int v12; // [sp+24h] [bp-1Ch]@1
  int v13; // [sp+28h] [bp-18h]@1
  int v14; // [sp+2Ch] [bp-14h]@1
  int v15; // [sp+30h] [bp-10h]@1
  int v16; // [sp+34h] [bp-Ch]@1
  int v17; // [sp+38h] [bp-8h]@1
  int v18; // [sp+3Ch] [bp-4h]@1

  v3 = 208;
  v4 = 120;
  v5 = 224;
  v6 = 136;
  v7 = 224;
  v8 = 120;
  v9 = 240;
  v10 = 136;
  v11 = 240;
  v12 = 120;
  v13 = 256;
  v14 = 136;
  v15 = 256;
  v16 = 120;
  v17 = 272;
  v18 = 136;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) += 4096;
  }
  if ( ++*(_DWORD *)(a1 + 100) > 0 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 3 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0043B5F0) --------------------------------------------------------
void __cdecl NPC103(int a1)
{
  int *v1; // eax@13
  int v2; // ecx@13
  int *v3; // eax@14
  int v4; // ecx@14
  int v5; // [sp+0h] [bp-64h]@1
  int v6; // [sp+4h] [bp-60h]@1
  int v7; // [sp+8h] [bp-5Ch]@1
  int v8; // [sp+Ch] [bp-58h]@1
  int v9; // [sp+10h] [bp-54h]@1
  int v10; // [sp+14h] [bp-50h]@1
  int v11; // [sp+18h] [bp-4Ch]@1
  int v12; // [sp+1Ch] [bp-48h]@1
  int v13; // [sp+20h] [bp-44h]@1
  int v14; // [sp+24h] [bp-40h]@1
  int v15; // [sp+28h] [bp-3Ch]@1
  int v16; // [sp+2Ch] [bp-38h]@1
  int v17; // [sp+30h] [bp-34h]@1
  int v18; // [sp+34h] [bp-30h]@1
  int v19; // [sp+38h] [bp-2Ch]@1
  int v20; // [sp+3Ch] [bp-28h]@1
  int v21; // [sp+40h] [bp-24h]@1
  int v22; // [sp+44h] [bp-20h]@1
  int v23; // [sp+48h] [bp-1Ch]@1
  int v24; // [sp+4Ch] [bp-18h]@1
  int v25; // [sp+50h] [bp-14h]@1
  int v26; // [sp+54h] [bp-10h]@1
  int v27; // [sp+58h] [bp-Ch]@1
  int v28; // [sp+5Ch] [bp-8h]@1
  int v29; // [sp+60h] [bp-4h]@1

  v18 = 192;
  v19 = 96;
  v20 = 208;
  v21 = 120;
  v22 = 208;
  v23 = 96;
  v24 = 224;
  v25 = 120;
  v26 = 224;
  v27 = 96;
  v28 = 240;
  v29 = 120;
  v6 = 192;
  v7 = 120;
  v8 = 208;
  v9 = 144;
  v10 = 208;
  v11 = 120;
  v12 = 224;
  v13 = 144;
  v14 = 224;
  v15 = 120;
  v16 = 240;
  v17 = 144;
  v5 = *(_DWORD *)(a1 + 116);
  if ( v5 )
  {
    if ( v5 != 1 )
      goto LABEL_12;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( *(_DWORD *)(a1 + 76) )
    *(_DWORD *)(a1 + 16) += 32;
  else
    *(_DWORD *)(a1 + 16) -= 32;
  if ( ++*(_DWORD *)(a1 + 100) > 0 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
LABEL_12:
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    *(_DWORD *)(v4 + 8) = v3[2];
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  else
  {
    v1 = &v18 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  if ( ++*(_DWORD *)(a1 + 108) > 100 )
    *(_BYTE *)a1 = 0;
  if ( *(_DWORD *)(a1 + 108) % 4 == 1 )
    Play_Sound_Effect(Sfx_Iron_Head_Shot, 1);
}

//----- (0043B7F0) --------------------------------------------------------
int __cdecl NPC104(int a1)
{
  int *v1; // edx@56
  int result; // eax@56
  int *v3; // edx@57
  signed int v4; // [sp+4h] [bp-64h]@32
  int v5; // [sp+8h] [bp-60h]@1
  int v6; // [sp+Ch] [bp-5Ch]@1
  int v7; // [sp+10h] [bp-58h]@1
  int v8; // [sp+14h] [bp-54h]@1
  int v9; // [sp+18h] [bp-50h]@1
  int v10; // [sp+1Ch] [bp-4Ch]@1
  int v11; // [sp+20h] [bp-48h]@1
  int v12; // [sp+24h] [bp-44h]@1
  int v13; // [sp+28h] [bp-40h]@1
  int v14; // [sp+2Ch] [bp-3Ch]@1
  int v15; // [sp+30h] [bp-38h]@1
  int v16; // [sp+34h] [bp-34h]@1
  int v17; // [sp+38h] [bp-30h]@1
  int v18; // [sp+3Ch] [bp-2Ch]@1
  int v19; // [sp+40h] [bp-28h]@1
  int v20; // [sp+44h] [bp-24h]@1
  int v21; // [sp+48h] [bp-20h]@1
  int v22; // [sp+4Ch] [bp-1Ch]@1
  int v23; // [sp+50h] [bp-18h]@1
  int v24; // [sp+54h] [bp-14h]@1
  int v25; // [sp+58h] [bp-10h]@1
  int v26; // [sp+5Ch] [bp-Ch]@1
  int v27; // [sp+60h] [bp-8h]@1
  int v28; // [sp+64h] [bp-4h]@1

  v17 = 0;
  v18 = 112;
  v19 = 32;
  v20 = 144;
  v21 = 32;
  v22 = 112;
  v23 = 64;
  v24 = 144;
  v25 = 64;
  v26 = 112;
  v27 = 96;
  v28 = 144;
  v5 = 0;
  v6 = 144;
  v7 = 32;
  v8 = 176;
  v9 = 32;
  v10 = 144;
  v11 = 64;
  v12 = 176;
  v13 = 64;
  v14 = 144;
  v15 = 96;
  v16 = 176;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 76) != 4 )
      {
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
        goto LABEL_8;
      }
      if ( Random(0, 1) )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      *(_WORD *)(a1 + 80) |= 8u;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 116) = 3;
      break;
    case 1:
LABEL_8:
      ++*(_DWORD *)(a1 + 120);
      if ( Random(0, 50) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
      }
      break;
    case 2:
      ++*(_DWORD *)(a1 + 120);
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 120) > 18 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 116) = 1;
      }
      break;
    case 3:
      if ( ++*(_DWORD *)(a1 + 120) > 40 )
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      goto LABEL_24;
    case 0xB:
LABEL_24:
      if ( *(_DWORD *)(a1 + 4) & 1 && *(_DWORD *)(a1 + 16) < 0 )
      {
        *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 4) & 4 && *(_DWORD *)(a1 + 16) > 0 )
      {
        *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 76) = 0;
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    default:
      break;
  }
  v4 = 0;
  if ( *(_DWORD *)(a1 + 116) < 10 && *(_DWORD *)(a1 + 116) != 3 && *(_DWORD *)(a1 + 120) > 10 )
  {
    if ( *(_BYTE *)(a1 + 156) )
      v4 = 1;
    if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos - 81920
      && *(_DWORD *)(a1 + 8) <= Quote.X_Pos + 81920
      && *(_DWORD *)(a1 + 12) >= Quote.Y_Pos - 0x8000
      && *(_DWORD *)(a1 + 12) <= Quote.Y_Pos + 0x8000
      && Random(0, 50) == 2 )
    {
      v4 = 1;
    }
  }
  if ( v4 )
  {
    if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 0;
    else
      *(_DWORD *)(a1 + 76) = 2;
    *(_DWORD *)(a1 + 116) = 10;
    *(_DWORD *)(a1 + 104) = 2;
    *(_DWORD *)(a1 + 20) = -1535;
    if ( !(Quote.Flags & 2) )
      Play_Sound_Effect(Sfx_Critter_Hop, 1);
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 16) = 512;
    else
      *(_DWORD *)(a1 + 16) = -512;
  }
  *(_DWORD *)(a1 + 20) += 128;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v17 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (0043BD00) --------------------------------------------------------
int __cdecl NPC105(int a1)
{
  int *v1; // edx@5
  int result; // eax@5
  int v3; // [sp+0h] [bp-20h]@1
  int v4; // [sp+4h] [bp-1Ch]@1
  int v5; // [sp+8h] [bp-18h]@1
  int v6; // [sp+Ch] [bp-14h]@1
  int v7; // [sp+10h] [bp-10h]@1
  int v8; // [sp+14h] [bp-Ch]@1
  int v9; // [sp+18h] [bp-8h]@1
  int v10; // [sp+1Ch] [bp-4h]@1

  v3 = 128;
  v4 = 32;
  v5 = 144;
  v6 = 48;
  v7 = 128;
  v8 = 32;
  v9 = 128;
  v10 = 32;
  if ( ++*(_DWORD *)(a1 + 120) > 30 )
    *(_BYTE *)a1 = 0;
  if ( *(_DWORD *)(a1 + 120) < 5 )
    *(_DWORD *)(a1 + 12) -= 512;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0043BDB0) --------------------------------------------------------
int __cdecl NPC106(int a1)
{
  int result; // eax@1

  result = a1;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    NPC_Create((NPC_Names)105, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) - 4096, 0, 0, 0, NULL, 384);
    result = a1;
    *(_DWORD *)(a1 + 116) = 1;
  }
  return result;
}

//----- (0043BE00) --------------------------------------------------------
int __cdecl NPC107(int a1)
{
  int v1; // ST10_4@7
  int v2; // eax@7
  int v3; // ST10_4@28
  int v4; // eax@28
  int v5; // ST10_4@40
  int v6; // eax@40
  int *v7; // ecx@51
  int v8; // edx@51
  int result; // eax@51
  int v10; // [sp+4h] [bp-A8h]@51
  int v11; // [sp+8h] [bp-A4h]@51
  int v12; // [sp+Ch] [bp-A0h]@51
  int v13; // [sp+10h] [bp-9Ch]@51
  int v14; // [sp+14h] [bp-98h]@51
  int v15; // [sp+18h] [bp-94h]@51
  int v16; // [sp+1Ch] [bp-90h]@51
  int v17; // [sp+20h] [bp-8Ch]@51
  int v18; // [sp+24h] [bp-88h]@51
  int v19; // [sp+28h] [bp-84h]@51
  int v20; // [sp+2Ch] [bp-80h]@51
  int v21; // [sp+30h] [bp-7Ch]@51
  int v22; // [sp+34h] [bp-78h]@51
  int v23; // [sp+38h] [bp-74h]@51
  int v24; // [sp+3Ch] [bp-70h]@51
  int v25; // [sp+40h] [bp-6Ch]@51
  int v26; // [sp+44h] [bp-68h]@51
  int v27; // [sp+48h] [bp-64h]@51
  int v28; // [sp+4Ch] [bp-60h]@51
  int v29; // [sp+50h] [bp-5Ch]@51
  int v30; // [sp+54h] [bp-58h]@51
  int v31; // [sp+58h] [bp-54h]@51
  int v32; // [sp+5Ch] [bp-50h]@51
  int v33; // [sp+60h] [bp-4Ch]@51
  int v34; // [sp+64h] [bp-48h]@51
  int v35; // [sp+68h] [bp-44h]@51
  int v36; // [sp+6Ch] [bp-40h]@51
  int v37; // [sp+70h] [bp-3Ch]@51
  int v38; // [sp+74h] [bp-38h]@51
  int v39; // [sp+78h] [bp-34h]@51
  int v40; // [sp+7Ch] [bp-30h]@51
  int v41; // [sp+80h] [bp-2Ch]@51
  int v42; // [sp+84h] [bp-28h]@51
  int v43; // [sp+88h] [bp-24h]@51
  int v44; // [sp+8Ch] [bp-20h]@51
  int v45; // [sp+90h] [bp-1Ch]@51
  int v46; // [sp+94h] [bp-18h]@51
  int v47; // [sp+98h] [bp-14h]@51
  int v48; // [sp+9Ch] [bp-10h]@51
  int v49; // [sp+A0h] [bp-Ch]@51
  int i; // [sp+A8h] [bp-4h]@5

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      if ( *(_DWORD *)(a1 + 76) == 2 )
        *(_DWORD *)(a1 + 104) = 5;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      for ( i = 0; i < 4; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v2, v1, 0, NULL, 256);
      }
      goto LABEL_8;
    case 0xB:
LABEL_8:
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        Play_Sound_Effect(Sfx_Computer_Screen_On, 1);
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 100 )
        *(_DWORD *)(a1 + 116) = 12;
      break;
    case 0xC:
      *(_DWORD *)(a1 + 116) = 13;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 1;
      goto LABEL_16;
    case 0xD:
LABEL_16:
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 14;
      break;
    case 0xE:
      *(_DWORD *)(a1 + 116) = 15;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_20;
    case 0xF:
LABEL_20:
      if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
      {
        *(_DWORD *)(a1 + 8) += 512;
        Play_Sound_Effect(Sfx_Door_Open, 1);
      }
      else
      {
        *(_DWORD *)(a1 + 8) -= 512;
      }
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 16;
      break;
    case 0x10:
      *(_DWORD *)(a1 + 116) = 17;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 2;
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      for ( i = 0; i < 8; ++i )
      {
        v3 = Random(-1536, 0);
        v4 = Random(-341, 341);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v4, v3, 0, NULL, 256);
      }
      goto LABEL_29;
    case 0x11:
LABEL_29:
      if ( ++*(_DWORD *)(a1 + 120) > 150 )
        *(_DWORD *)(a1 + 116) = 18;
      break;
    case 0x12:
      *(_DWORD *)(a1 + 116) = 19;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_33;
    case 0x13:
LABEL_33:
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
      {
        Play_Sound_Effect(Sfx_Door_Open, 1);
        *(_DWORD *)(a1 + 104) = 3;
      }
      if ( ++*(_DWORD *)(a1 + 120) > 100 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        for ( i = 0; i < 4; ++i )
        {
          v5 = Random(-1536, 0);
          v6 = Random(-341, 341);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v6, v5, 0, NULL, 256);
        }
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 104) = 4;
      break;
    case 0x15:
      *(_DWORD *)(a1 + 116) = 22;
      *(_DWORD *)(a1 + 104) = 5;
      Play_Sound_Effect(Sfx_Critter_Small_Hurt, 1);
      break;
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 104) = 6;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_45;
    case 0x65:
LABEL_45:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 9 )
        *(_DWORD *)(a1 + 104) = 6;
      break;
    case 0x6E:
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0x2000, 16);
      *(_BYTE *)a1 = 0;
      break;
    default:
      break;
  }
  v10 = 144;
  v11 = 0;
  v12 = 160;
  v13 = 24;
  v14 = 160;
  v15 = 0;
  v16 = 176;
  v17 = 24;
  v18 = 176;
  v19 = 0;
  v20 = 192;
  v21 = 24;
  v22 = 192;
  v23 = 0;
  v24 = 208;
  v25 = 24;
  v26 = 208;
  v27 = 0;
  v28 = 224;
  v29 = 24;
  v30 = 224;
  v31 = 0;
  v32 = 240;
  v33 = 24;
  v34 = 176;
  v35 = 0;
  v36 = 192;
  v37 = 24;
  v38 = 192;
  v39 = 0;
  v40 = 208;
  v41 = 24;
  v42 = 208;
  v43 = 0;
  v44 = 224;
  v45 = 24;
  v46 = 192;
  v47 = 0;
  v48 = 208;
  v49 = 24;
  v7 = &v10 + 4 * *(_DWORD *)(a1 + 104);
  v8 = a1 + 84;
  *(_DWORD *)v8 = *v7;
  *(_DWORD *)(v8 + 4) = v7[1];
  result = v7[2];
  *(_DWORD *)(v8 + 8) = result;
  *(_DWORD *)(v8 + 12) = v7[3];
  return result;
}

//----- (0043C4B0) --------------------------------------------------------
int __cdecl NPC108(int a1)
{
  int *v1; // eax@7
  int v2; // ecx@7
  int result; // eax@7
  int v4; // [sp+0h] [bp-30h]@3
  int v5; // [sp+4h] [bp-2Ch]@3
  int v6; // [sp+8h] [bp-28h]@3
  int v7; // [sp+Ch] [bp-24h]@3
  int v8; // [sp+10h] [bp-20h]@3
  int v9; // [sp+14h] [bp-1Ch]@3
  int v10; // [sp+18h] [bp-18h]@3
  int v11; // [sp+1Ch] [bp-14h]@3
  int v12; // [sp+20h] [bp-10h]@3
  int v13; // [sp+24h] [bp-Ch]@3
  int v14; // [sp+28h] [bp-8h]@3
  int v15; // [sp+2Ch] [bp-4h]@3

  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
    *(_BYTE *)a1 = 0;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v4 = 96;
  v5 = 48;
  v6 = 112;
  v7 = 64;
  v8 = 112;
  v9 = 48;
  v10 = 128;
  v11 = 64;
  v12 = 128;
  v13 = 48;
  v14 = 144;
  v15 = 64;
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  result = a1;
  if ( ++*(_DWORD *)(a1 + 108) > 300 )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
    result = a1;
    *(_BYTE *)a1 = 0;
  }
  return result;
}

//----- (0043C610) --------------------------------------------------------
int __cdecl NPC109(int a1)
{
  int v1; // ST10_4@20
  int v2; // eax@20
  int *v3; // edx@24
  int result; // eax@24
  int *v5; // edx@25
  int v6; // [sp+4h] [bp-44h]@1
  int v7; // [sp+8h] [bp-40h]@1
  int v8; // [sp+Ch] [bp-3Ch]@1
  int v9; // [sp+10h] [bp-38h]@1
  int v10; // [sp+14h] [bp-34h]@1
  int v11; // [sp+18h] [bp-30h]@1
  int v12; // [sp+1Ch] [bp-2Ch]@1
  int v13; // [sp+20h] [bp-28h]@1
  int i; // [sp+24h] [bp-24h]@18
  int v15; // [sp+28h] [bp-20h]@1
  int v16; // [sp+2Ch] [bp-1Ch]@1
  int v17; // [sp+30h] [bp-18h]@1
  int v18; // [sp+34h] [bp-14h]@1
  int v19; // [sp+38h] [bp-10h]@1
  int v20; // [sp+3Ch] [bp-Ch]@1
  int v21; // [sp+40h] [bp-8h]@1
  int v22; // [sp+44h] [bp-4h]@1

  v15 = 240;
  v16 = 0;
  v17 = 256;
  v18 = 24;
  v19 = 256;
  v20 = 0;
  v21 = 272;
  v22 = 24;
  v6 = 240;
  v7 = 24;
  v8 = 256;
  v9 = 48;
  v10 = 256;
  v11 = 24;
  v12 = 272;
  v13 = 48;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      if ( --*(_DWORD *)(a1 + 120) )
        *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_5;
    case 1:
LABEL_5:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_DWORD *)(a1 + 8) - 0x4000 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 0x4000 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 0;
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      for ( i = 0; i < 8; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v2, v1, 0, NULL, 256);
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v5;
    *(_DWORD *)(result + 4) = v5[1];
    *(_DWORD *)(result + 8) = v5[2];
    *(_DWORD *)(result + 12) = v5[3];
  }
  else
  {
    v3 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  return result;
}

//----- (0043C8E0) --------------------------------------------------------
int __cdecl NPC110(int a1)
{
  int *v1; // ecx@54
  int v2; // edx@54
  int result; // eax@54
  int *v4; // ecx@55
  int v5; // edx@55
  signed int v6; // [sp+4h] [bp-64h]@32
  int v7; // [sp+8h] [bp-60h]@1
  int v8; // [sp+Ch] [bp-5Ch]@1
  int v9; // [sp+10h] [bp-58h]@1
  int v10; // [sp+14h] [bp-54h]@1
  int v11; // [sp+18h] [bp-50h]@1
  int v12; // [sp+1Ch] [bp-4Ch]@1
  int v13; // [sp+20h] [bp-48h]@1
  int v14; // [sp+24h] [bp-44h]@1
  int v15; // [sp+28h] [bp-40h]@1
  int v16; // [sp+2Ch] [bp-3Ch]@1
  int v17; // [sp+30h] [bp-38h]@1
  int v18; // [sp+34h] [bp-34h]@1
  int v19; // [sp+38h] [bp-30h]@1
  int v20; // [sp+3Ch] [bp-2Ch]@1
  int v21; // [sp+40h] [bp-28h]@1
  int v22; // [sp+44h] [bp-24h]@1
  int v23; // [sp+48h] [bp-20h]@1
  int v24; // [sp+4Ch] [bp-1Ch]@1
  int v25; // [sp+50h] [bp-18h]@1
  int v26; // [sp+54h] [bp-14h]@1
  int v27; // [sp+58h] [bp-10h]@1
  int v28; // [sp+5Ch] [bp-Ch]@1
  int v29; // [sp+60h] [bp-8h]@1
  int v30; // [sp+64h] [bp-4h]@1

  v19 = 96;
  v20 = 128;
  v21 = 112;
  v22 = 144;
  v23 = 112;
  v24 = 128;
  v25 = 128;
  v26 = 144;
  v27 = 128;
  v28 = 128;
  v29 = 144;
  v30 = 144;
  v7 = 96;
  v8 = 144;
  v9 = 112;
  v10 = 160;
  v11 = 112;
  v12 = 144;
  v13 = 128;
  v14 = 160;
  v15 = 128;
  v16 = 144;
  v17 = 144;
  v18 = 160;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 76) != 4 )
      {
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
        goto LABEL_8;
      }
      if ( Random(0, 1) )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      *(_WORD *)(a1 + 80) |= 8u;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 116) = 3;
      break;
    case 1:
LABEL_8:
      ++*(_DWORD *)(a1 + 120);
      if ( Random(0, 50) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
      }
      break;
    case 2:
      ++*(_DWORD *)(a1 + 120);
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 120) > 18 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 116) = 1;
      }
      break;
    case 3:
      if ( ++*(_DWORD *)(a1 + 120) > 40 )
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      goto LABEL_24;
    case 0xB:
LABEL_24:
      if ( *(_DWORD *)(a1 + 4) & 1 && *(_DWORD *)(a1 + 16) < 0 )
      {
        *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 4) & 4 && *(_DWORD *)(a1 + 16) > 0 )
      {
        *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 76) = 0;
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    default:
      break;
  }
  v6 = 0;
  if ( *(_DWORD *)(a1 + 116) < 10 && *(_DWORD *)(a1 + 116) != 3 && *(_DWORD *)(a1 + 120) > 10 )
  {
    if ( *(_BYTE *)(a1 + 156) )
      v6 = 1;
    if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos - 81920
      && *(_DWORD *)(a1 + 8) <= Quote.X_Pos + 81920
      && *(_DWORD *)(a1 + 12) >= Quote.Y_Pos - 0x8000
      && *(_DWORD *)(a1 + 12) <= Quote.Y_Pos + 0x8000
      && Random(0, 50) == 2 )
    {
      v6 = 1;
    }
  }
  if ( v6 )
  {
    if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 0;
    else
      *(_DWORD *)(a1 + 76) = 2;
    *(_DWORD *)(a1 + 116) = 10;
    *(_DWORD *)(a1 + 104) = 2;
    *(_DWORD *)(a1 + 20) = -767;
    Play_Sound_Effect(Sfx_High_Pitch_Critter_Hop, 1);
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 16) = 256;
    else
      *(_DWORD *)(a1 + 16) = -256;
  }
  *(_DWORD *)(a1 + 20) += 128;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v19 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (0043CDE0) --------------------------------------------------------
int __cdecl NPC111(int a1)
{
  int *v1; // eax@17
  int v2; // ecx@17
  int result; // eax@17
  int *v4; // eax@18
  int v5; // ecx@18
  int v6; // [sp+4h] [bp-40h]@1
  int v7; // [sp+8h] [bp-3Ch]@1
  int v8; // [sp+Ch] [bp-38h]@1
  int v9; // [sp+10h] [bp-34h]@1
  int v10; // [sp+14h] [bp-30h]@1
  int v11; // [sp+18h] [bp-2Ch]@1
  int v12; // [sp+1Ch] [bp-28h]@1
  int v13; // [sp+20h] [bp-24h]@1
  int v14; // [sp+24h] [bp-20h]@1
  int v15; // [sp+28h] [bp-1Ch]@1
  int v16; // [sp+2Ch] [bp-18h]@1
  int v17; // [sp+30h] [bp-14h]@1
  int v18; // [sp+34h] [bp-10h]@1
  int v19; // [sp+38h] [bp-Ch]@1
  int v20; // [sp+3Ch] [bp-8h]@1
  int v21; // [sp+40h] [bp-4h]@1

  v14 = 0;
  v15 = 0;
  v16 = 16;
  v17 = 16;
  v18 = 16;
  v19 = 0;
  v20 = 32;
  v21 = 16;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 32;
  v10 = 16;
  v11 = 16;
  v12 = 32;
  v13 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 12) -= 0x2000;
      break;
    case 1:
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 20) = -767;
      }
      break;
    case 2:
      if ( *(_DWORD *)(a1 + 20) > 0 )
        *(_DWORD *)(a1 + 136) = 0x2000;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 3:
      if ( ++*(_DWORD *)(a1 + 120) > 40 )
      {
        *(_DWORD *)(a1 + 116) = 4;
        *(_DWORD *)(a1 + 120) = 64;
        Play_Sound_Effect(Sfx_Teleport, 1);
      }
      break;
    case 4:
      --*(_DWORD *)(a1 + 120);
      *(_DWORD *)(a1 + 104) = 0;
      if ( !*(_DWORD *)(a1 + 120) )
        *(_BYTE *)a1 = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v14 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  if ( Quote.Equipped_Items & 0x40 )
  {
    *(_DWORD *)(a1 + 88) += 32;
    result = *(_DWORD *)(a1 + 96) + 32;
    *(_DWORD *)(a1 + 96) = result;
  }
  if ( *(_DWORD *)(a1 + 116) == 4 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 4;
    result = *(_DWORD *)(a1 + 120) / 2 % 2;
    if ( result )
    {
      result = a1;
      ++*(_DWORD *)(a1 + 84);
    }
  }
  return result;
}

//----- (0043D0A0) --------------------------------------------------------
int __cdecl NPC112(int a1)
{
  int *v1; // ecx@12
  int v2; // edx@12
  int *v3; // ecx@13
  int v4; // edx@13
  int result; // eax@16
  int v6; // [sp+4h] [bp-40h]@1
  int v7; // [sp+8h] [bp-3Ch]@1
  int v8; // [sp+Ch] [bp-38h]@1
  int v9; // [sp+10h] [bp-34h]@1
  int v10; // [sp+14h] [bp-30h]@1
  int v11; // [sp+18h] [bp-2Ch]@1
  int v12; // [sp+1Ch] [bp-28h]@1
  int v13; // [sp+20h] [bp-24h]@1
  int v14; // [sp+24h] [bp-20h]@1
  int v15; // [sp+28h] [bp-1Ch]@1
  int v16; // [sp+2Ch] [bp-18h]@1
  int v17; // [sp+30h] [bp-14h]@1
  int v18; // [sp+34h] [bp-10h]@1
  int v19; // [sp+38h] [bp-Ch]@1
  int v20; // [sp+3Ch] [bp-8h]@1
  int v21; // [sp+40h] [bp-4h]@1

  v14 = 0;
  v15 = 0;
  v16 = 16;
  v17 = 16;
  v18 = 16;
  v19 = 0;
  v20 = 32;
  v21 = 16;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 32;
  v10 = 16;
  v11 = 16;
  v12 = 32;
  v13 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 8) += 0x2000;
      *(_DWORD *)(a1 + 12) += 4096;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 120) == 64 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 136) = 4096;
      }
      break;
    case 3:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 4;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    *(_DWORD *)(v4 + 8) = v3[2];
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  else
  {
    v1 = &v14 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  if ( Quote.Equipped_Items & 0x40 )
  {
    *(_DWORD *)(a1 + 88) += 32;
    *(_DWORD *)(a1 + 96) += 32;
  }
  result = a1;
  if ( *(_DWORD *)(a1 + 116) == 1 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 4;
    result = *(_DWORD *)(a1 + 120) / 2 % 2;
    if ( result )
    {
      result = a1;
      ++*(_DWORD *)(a1 + 84);
    }
  }
  return result;
}

//----- (0043D320) --------------------------------------------------------
int __cdecl NPC113(int a1)
{
  int *v1; // eax@29
  int v2; // ecx@29
  int result; // eax@29
  int *v4; // eax@30
  int v5; // ecx@30
  int v6; // [sp+4h] [bp-E0h]@1
  int v7; // [sp+8h] [bp-DCh]@1
  int v8; // [sp+Ch] [bp-D8h]@1
  int v9; // [sp+10h] [bp-D4h]@1
  int v10; // [sp+14h] [bp-D0h]@1
  int v11; // [sp+18h] [bp-CCh]@1
  int v12; // [sp+1Ch] [bp-C8h]@1
  int v13; // [sp+20h] [bp-C4h]@1
  int v14; // [sp+24h] [bp-C0h]@1
  int v15; // [sp+28h] [bp-BCh]@1
  int v16; // [sp+2Ch] [bp-B8h]@1
  int v17; // [sp+30h] [bp-B4h]@1
  int v18; // [sp+34h] [bp-B0h]@1
  int v19; // [sp+38h] [bp-ACh]@1
  int v20; // [sp+3Ch] [bp-A8h]@1
  int v21; // [sp+40h] [bp-A4h]@1
  int v22; // [sp+44h] [bp-A0h]@1
  int v23; // [sp+48h] [bp-9Ch]@1
  int v24; // [sp+4Ch] [bp-98h]@1
  int v25; // [sp+50h] [bp-94h]@1
  int v26; // [sp+54h] [bp-90h]@1
  int v27; // [sp+58h] [bp-8Ch]@1
  int v28; // [sp+5Ch] [bp-88h]@1
  int v29; // [sp+60h] [bp-84h]@1
  int v30; // [sp+64h] [bp-80h]@1
  int v31; // [sp+68h] [bp-7Ch]@1
  int v32; // [sp+6Ch] [bp-78h]@1
  int v33; // [sp+70h] [bp-74h]@1
  int v34; // [sp+74h] [bp-70h]@1
  int v35; // [sp+78h] [bp-6Ch]@1
  int v36; // [sp+7Ch] [bp-68h]@1
  int v37; // [sp+80h] [bp-64h]@1
  int v38; // [sp+84h] [bp-60h]@1
  int v39; // [sp+88h] [bp-5Ch]@1
  int v40; // [sp+8Ch] [bp-58h]@1
  int v41; // [sp+90h] [bp-54h]@1
  int v42; // [sp+94h] [bp-50h]@1
  int v43; // [sp+98h] [bp-4Ch]@1
  int v44; // [sp+9Ch] [bp-48h]@1
  int v45; // [sp+A0h] [bp-44h]@1
  int v46; // [sp+A4h] [bp-40h]@1
  int v47; // [sp+A8h] [bp-3Ch]@1
  int v48; // [sp+ACh] [bp-38h]@1
  int v49; // [sp+B0h] [bp-34h]@1
  int v50; // [sp+B4h] [bp-30h]@1
  int v51; // [sp+B8h] [bp-2Ch]@1
  int v52; // [sp+BCh] [bp-28h]@1
  int v53; // [sp+C0h] [bp-24h]@1
  int v54; // [sp+C4h] [bp-20h]@1
  int v55; // [sp+C8h] [bp-1Ch]@1
  int v56; // [sp+CCh] [bp-18h]@1
  int v57; // [sp+D0h] [bp-14h]@1
  int v58; // [sp+D4h] [bp-10h]@1
  int v59; // [sp+D8h] [bp-Ch]@1
  int v60; // [sp+DCh] [bp-8h]@1
  int v61; // [sp+E0h] [bp-4h]@1

  v34 = 224;
  v35 = 0;
  v36 = 240;
  v37 = 16;
  v38 = 240;
  v39 = 0;
  v40 = 256;
  v41 = 16;
  v42 = 256;
  v43 = 0;
  v44 = 272;
  v45 = 16;
  v46 = 224;
  v47 = 0;
  v48 = 240;
  v49 = 16;
  v50 = 272;
  v51 = 0;
  v52 = 288;
  v53 = 16;
  v54 = 224;
  v55 = 0;
  v56 = 240;
  v57 = 16;
  v58 = 288;
  v59 = 0;
  v60 = 304;
  v61 = 16;
  v6 = 224;
  v7 = 16;
  v8 = 240;
  v9 = 32;
  v10 = 240;
  v11 = 16;
  v12 = 256;
  v13 = 32;
  v14 = 256;
  v15 = 16;
  v16 = 272;
  v17 = 32;
  v18 = 224;
  v19 = 16;
  v20 = 240;
  v21 = 32;
  v22 = 272;
  v23 = 16;
  v24 = 288;
  v25 = 32;
  v26 = 224;
  v27 = 16;
  v28 = 240;
  v29 = 32;
  v30 = 288;
  v31 = 16;
  v32 = 304;
  v33 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 3:
      *(_DWORD *)(a1 + 116) = 4;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_10;
    case 4:
LABEL_10:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) += 512;
      else
        *(_DWORD *)(a1 + 8) -= 512;
      break;
    case 5:
      *(_DWORD *)(a1 + 104) = 6;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 136) = 0x2000;
      *(_DWORD *)(a1 + 8) -= 0x2000;
      *(_DWORD *)(a1 + 12) += 4096;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_20;
    case 0x1F:
LABEL_20:
      if ( ++*(_DWORD *)(a1 + 120) == 64 )
      {
        *(_DWORD *)(a1 + 116) = 32;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x20:
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 116) = 33;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 136) = 4096;
      }
      break;
    case 0x21:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 34;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v34 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  if ( *(_DWORD *)(a1 + 116) == 31 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 4;
    result = *(_DWORD *)(a1 + 120) / 2 % 2;
    if ( result )
    {
      result = a1;
      ++*(_DWORD *)(a1 + 84);
    }
  }
  return result;
}

//----- (0043D860) --------------------------------------------------------
int __cdecl NPC114(int a1)
{
  int v1; // ST10_4@20
  int v2; // eax@20
  int *v3; // edx@25
  int result; // eax@25
  int v5; // [sp+0h] [bp-38h]@1
  signed int i; // [sp+4h] [bp-34h]@18
  int v7; // [sp+8h] [bp-30h]@1
  int v8; // [sp+Ch] [bp-2Ch]@1
  int v9; // [sp+10h] [bp-28h]@1
  int v10; // [sp+14h] [bp-24h]@1
  int v11; // [sp+18h] [bp-20h]@1
  int v12; // [sp+1Ch] [bp-1Ch]@1
  int v13; // [sp+20h] [bp-18h]@1
  int v14; // [sp+24h] [bp-14h]@1
  int v15; // [sp+28h] [bp-10h]@1
  int v16; // [sp+2Ch] [bp-Ch]@1
  int v17; // [sp+30h] [bp-8h]@1
  int v18; // [sp+34h] [bp-4h]@1

  v7 = 144;
  v8 = 112;
  v9 = 160;
  v10 = 136;
  v11 = 160;
  v12 = 112;
  v13 = 176;
  v14 = 136;
  v15 = 176;
  v16 = 112;
  v17 = 192;
  v18 = 136;
  v5 = *(_DWORD *)(a1 + 116);
  if ( v5 )
  {
    if ( v5 != 1 )
    {
      if ( v5 == 10 )
      {
        if ( ++*(_DWORD *)(a1 + 100) > 2 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 2 )
          *(_DWORD *)(a1 + 104) = 2;
        if ( Quote.Y_Pos <= *(_DWORD *)(a1 + 12) )
        {
          *(_WORD *)(a1 + 80) |= 0x40u;
          *(_DWORD *)(a1 + 164) = 0;
        }
        else
        {
          *(_WORD *)(a1 + 80) &= 0xFFBFu;
          *(_DWORD *)(a1 + 164) = 127;
        }
        if ( *(_DWORD *)(a1 + 4) & 8 )
        {
          if ( *(_DWORD *)(a1 + 104) > 1 )
          {
            for ( i = 0; i < 4; ++i )
            {
              v1 = Random(-1536, 0);
              v2 = Random(-341, 341);
              NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v2, v1, 0, NULL, 256);
            }
            Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
            Set_Quake(10);
          }
          *(_DWORD *)(a1 + 116) = 1;
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 164) = 0;
          *(_WORD *)(a1 + 80) |= 0x40u;
        }
      }
      goto LABEL_23;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) -= 2048;
  }
  if ( !(*(_DWORD *)(a1 + 4) & 8) )
  {
    *(_DWORD *)(a1 + 116) = 10;
    *(_DWORD *)(a1 + 100) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_23:
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v3 = &v7 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v3;
  *(_DWORD *)(result + 4) = v3[1];
  *(_DWORD *)(result + 8) = v3[2];
  *(_DWORD *)(result + 12) = v3[3];
  return result;
}

//----- (0043DAE0) --------------------------------------------------------
int __cdecl NPC115(int a1)
{
  int v1; // ST10_4@39
  int v2; // ST0C_4@39
  int v3; // ST08_4@39
  int v4; // eax@39
  int *v5; // ecx@50
  int v6; // edx@50
  int result; // eax@50
  int *v8; // ecx@51
  int v9; // edx@51
  int v10; // [sp+4h] [bp-C8h]@1
  int v11; // [sp+8h] [bp-C4h]@1
  int v12; // [sp+Ch] [bp-C0h]@1
  int v13; // [sp+10h] [bp-BCh]@1
  int v14; // [sp+14h] [bp-B8h]@1
  int v15; // [sp+18h] [bp-B4h]@1
  int v16; // [sp+1Ch] [bp-B0h]@1
  int v17; // [sp+20h] [bp-ACh]@1
  int v18; // [sp+24h] [bp-A8h]@1
  int v19; // [sp+28h] [bp-A4h]@1
  int v20; // [sp+2Ch] [bp-A0h]@1
  int v21; // [sp+30h] [bp-9Ch]@1
  int v22; // [sp+34h] [bp-98h]@1
  int v23; // [sp+38h] [bp-94h]@1
  int v24; // [sp+3Ch] [bp-90h]@1
  int v25; // [sp+40h] [bp-8Ch]@1
  int v26; // [sp+44h] [bp-88h]@1
  int v27; // [sp+48h] [bp-84h]@1
  int v28; // [sp+4Ch] [bp-80h]@1
  int v29; // [sp+50h] [bp-7Ch]@1
  int v30; // [sp+54h] [bp-78h]@1
  int v31; // [sp+58h] [bp-74h]@1
  int v32; // [sp+5Ch] [bp-70h]@1
  int v33; // [sp+60h] [bp-6Ch]@1
  int i; // [sp+68h] [bp-64h]@37
  int v35; // [sp+6Ch] [bp-60h]@1
  int v36; // [sp+70h] [bp-5Ch]@1
  int v37; // [sp+74h] [bp-58h]@1
  int v38; // [sp+78h] [bp-54h]@1
  int v39; // [sp+7Ch] [bp-50h]@1
  int v40; // [sp+80h] [bp-4Ch]@1
  int v41; // [sp+84h] [bp-48h]@1
  int v42; // [sp+88h] [bp-44h]@1
  int v43; // [sp+8Ch] [bp-40h]@1
  int v44; // [sp+90h] [bp-3Ch]@1
  int v45; // [sp+94h] [bp-38h]@1
  int v46; // [sp+98h] [bp-34h]@1
  int v47; // [sp+9Ch] [bp-30h]@1
  int v48; // [sp+A0h] [bp-2Ch]@1
  int v49; // [sp+A4h] [bp-28h]@1
  int v50; // [sp+A8h] [bp-24h]@1
  int v51; // [sp+ACh] [bp-20h]@1
  int v52; // [sp+B0h] [bp-1Ch]@1
  int v53; // [sp+B4h] [bp-18h]@1
  int v54; // [sp+B8h] [bp-14h]@1
  int v55; // [sp+BCh] [bp-10h]@1
  int v56; // [sp+C0h] [bp-Ch]@1
  int v57; // [sp+C4h] [bp-8h]@1
  int v58; // [sp+C8h] [bp-4h]@1

  v35 = 0;
  v36 = 120;
  v37 = 24;
  v38 = 144;
  v39 = 24;
  v40 = 120;
  v41 = 48;
  v42 = 144;
  v43 = 48;
  v44 = 120;
  v45 = 72;
  v46 = 144;
  v47 = 72;
  v48 = 120;
  v49 = 96;
  v50 = 144;
  v51 = 96;
  v52 = 120;
  v53 = 120;
  v54 = 144;
  v55 = 120;
  v56 = 120;
  v57 = 144;
  v58 = 144;
  v10 = 0;
  v11 = 144;
  v12 = 24;
  v13 = 168;
  v14 = 24;
  v15 = 144;
  v16 = 48;
  v17 = 168;
  v18 = 48;
  v19 = 144;
  v20 = 72;
  v21 = 168;
  v22 = 72;
  v23 = 144;
  v24 = 96;
  v25 = 168;
  v26 = 96;
  v27 = 144;
  v28 = 120;
  v29 = 168;
  v30 = 120;
  v31 = 144;
  v32 = 144;
  v33 = 168;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 49152
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 49152
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x4000
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 49152 )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      if ( *(_BYTE *)(a1 + 156) )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 104) = 1;
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 20;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 164) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = 512;
        else
          *(_DWORD *)(a1 + 16) = -512;
        if ( ++*(_DWORD *)(a1 + 108) <= 2 )
        {
          *(_DWORD *)(a1 + 116) = 21;
          *(_DWORD *)(a1 + 20) = -1024;
          Play_Sound_Effect(Sfx_Critter_Hop, 1);
        }
        else
        {
          *(_DWORD *)(a1 + 108) = 0;
          *(_DWORD *)(a1 + 104) = 4;
          *(_DWORD *)(a1 + 116) = 21;
          *(_DWORD *)(a1 + 20) = -1024;
          *(_DWORD *)(a1 + 16) *= 2;
          *(_DWORD *)(a1 + 164) = 5;
          Play_Sound_Effect(Sfx_Sand_Croc, 1);
        }
      }
      break;
    case 0x15:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 164) = 0;
        if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) + 73728
          || Quote.X_Pos < *(_DWORD *)(a1 + 8) - 73728
          || Quote.Y_Pos > *(_DWORD *)(a1 + 12) + 24576
          || Quote.Y_Pos < *(_DWORD *)(a1 + 12) - 73728 )
        {
          *(_DWORD *)(a1 + 116) = 0;
        }
      }
      break;
    case 0x1E:
      for ( i = 0; i < 8; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = *(_DWORD *)(a1 + 12) + (Random(-12, 12) << 9);
        v4 = Random(-12, 12);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 116) = 0;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 104) = 4;
      *(_DWORD *)(a1 + 164) = 0;
      *(_DWORD *)(a1 + 20) = -512;
      *(_WORD *)(a1 + 80) &= 0xFFDEu;
      Play_Sound_Effect(Sfx_Critter_Small_Hurt, 1);
      goto LABEL_42;
    case 0x33:
LABEL_42:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
        *(_DWORD *)(a1 + 116) = 52;
        *(_DWORD *)(a1 + 104) = 5;
        *(_DWORD *)(a1 + 16) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) <= 50 )
    *(_DWORD *)(a1 + 20) += 64;
  else
    *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v8 = &v10 + 4 * *(_DWORD *)(a1 + 104);
    v9 = a1 + 84;
    *(_DWORD *)v9 = *v8;
    *(_DWORD *)(v9 + 4) = v8[1];
    result = v8[2];
    *(_DWORD *)(v9 + 8) = result;
    *(_DWORD *)(v9 + 12) = v8[3];
  }
  else
  {
    v5 = &v35 + 4 * *(_DWORD *)(a1 + 104);
    v6 = a1 + 84;
    *(_DWORD *)v6 = *v5;
    *(_DWORD *)(v6 + 4) = v5[1];
    result = v5[2];
    *(_DWORD *)(v6 + 8) = result;
    *(_DWORD *)(v6 + 12) = v5[3];
  }
  return result;
}

//----- (0043E190) --------------------------------------------------------
int __cdecl NPC116(int a1)
{
  int result; // eax@1

  result = a1 + 84;
  *(_DWORD *)result = 272;
  *(_DWORD *)(result + 4) = 184;
  *(_DWORD *)(result + 8) = 320;
  *(_DWORD *)(result + 12) = 200;
  return result;
}

//----- (0043E1E0) --------------------------------------------------------
int __cdecl NPC117(int a1)
{
  int v1; // ecx@39
  int *v2; // eax@55
  int v3; // ecx@55
  int result; // eax@55
  int *v5; // eax@56
  int v6; // ecx@56
  int v7; // [sp+4h] [bp-140h]@1
  int v8; // [sp+8h] [bp-13Ch]@1
  int v9; // [sp+Ch] [bp-138h]@1
  int v10; // [sp+10h] [bp-134h]@1
  int v11; // [sp+14h] [bp-130h]@1
  int v12; // [sp+18h] [bp-12Ch]@1
  int v13; // [sp+1Ch] [bp-128h]@1
  int v14; // [sp+20h] [bp-124h]@1
  int v15; // [sp+24h] [bp-120h]@1
  int v16; // [sp+28h] [bp-11Ch]@1
  int v17; // [sp+2Ch] [bp-118h]@1
  int v18; // [sp+30h] [bp-114h]@1
  int v19; // [sp+34h] [bp-110h]@1
  int v20; // [sp+38h] [bp-10Ch]@1
  int v21; // [sp+3Ch] [bp-108h]@1
  int v22; // [sp+40h] [bp-104h]@1
  int v23; // [sp+44h] [bp-100h]@1
  int v24; // [sp+48h] [bp-FCh]@1
  int v25; // [sp+4Ch] [bp-F8h]@1
  int v26; // [sp+50h] [bp-F4h]@1
  int v27; // [sp+54h] [bp-F0h]@1
  int v28; // [sp+58h] [bp-ECh]@1
  int v29; // [sp+5Ch] [bp-E8h]@1
  int v30; // [sp+60h] [bp-E4h]@1
  int v31; // [sp+64h] [bp-E0h]@1
  int v32; // [sp+68h] [bp-DCh]@1
  int v33; // [sp+6Ch] [bp-D8h]@1
  int v34; // [sp+70h] [bp-D4h]@1
  int v35; // [sp+74h] [bp-D0h]@1
  int v36; // [sp+78h] [bp-CCh]@1
  int v37; // [sp+7Ch] [bp-C8h]@1
  int v38; // [sp+80h] [bp-C4h]@1
  int v39; // [sp+84h] [bp-C0h]@1
  int v40; // [sp+88h] [bp-BCh]@1
  int v41; // [sp+8Ch] [bp-B8h]@1
  int v42; // [sp+90h] [bp-B4h]@1
  int v43; // [sp+94h] [bp-B0h]@1
  int v44; // [sp+98h] [bp-ACh]@1
  int v45; // [sp+9Ch] [bp-A8h]@1
  int v46; // [sp+A0h] [bp-A4h]@1
  int v47; // [sp+A4h] [bp-A0h]@1
  int v48; // [sp+A8h] [bp-9Ch]@1
  int v49; // [sp+ACh] [bp-98h]@1
  int v50; // [sp+B0h] [bp-94h]@1
  int v51; // [sp+B4h] [bp-90h]@1
  int v52; // [sp+B8h] [bp-8Ch]@1
  int v53; // [sp+BCh] [bp-88h]@1
  int v54; // [sp+C0h] [bp-84h]@1
  int v55; // [sp+C4h] [bp-80h]@1
  int v56; // [sp+C8h] [bp-7Ch]@1
  int v57; // [sp+CCh] [bp-78h]@1
  int v58; // [sp+D0h] [bp-74h]@1
  int v59; // [sp+D4h] [bp-70h]@1
  int v60; // [sp+D8h] [bp-6Ch]@1
  int v61; // [sp+DCh] [bp-68h]@1
  int v62; // [sp+E0h] [bp-64h]@1
  int v63; // [sp+E4h] [bp-60h]@1
  int v64; // [sp+E8h] [bp-5Ch]@1
  int v65; // [sp+ECh] [bp-58h]@1
  int v66; // [sp+F0h] [bp-54h]@1
  int v67; // [sp+F4h] [bp-50h]@1
  int v68; // [sp+F8h] [bp-4Ch]@1
  int v69; // [sp+FCh] [bp-48h]@1
  int v70; // [sp+100h] [bp-44h]@1
  int v71; // [sp+104h] [bp-40h]@1
  int v72; // [sp+108h] [bp-3Ch]@1
  int v73; // [sp+10Ch] [bp-38h]@1
  int v74; // [sp+110h] [bp-34h]@1
  int v75; // [sp+114h] [bp-30h]@1
  int v76; // [sp+118h] [bp-2Ch]@1
  int v77; // [sp+11Ch] [bp-28h]@1
  int v78; // [sp+120h] [bp-24h]@1
  int v79; // [sp+124h] [bp-20h]@1
  int v80; // [sp+128h] [bp-1Ch]@1
  int v81; // [sp+12Ch] [bp-18h]@1
  int v82; // [sp+130h] [bp-14h]@1
  int v83; // [sp+134h] [bp-10h]@1
  int v84; // [sp+138h] [bp-Ch]@1
  int v85; // [sp+13Ch] [bp-8h]@1
  int v86; // [sp+140h] [bp-4h]@1

  v47 = 0;
  v48 = 96;
  v49 = 16;
  v50 = 112;
  v51 = 16;
  v52 = 96;
  v53 = 32;
  v54 = 112;
  v55 = 0;
  v56 = 96;
  v57 = 16;
  v58 = 112;
  v59 = 32;
  v60 = 96;
  v61 = 48;
  v62 = 112;
  v63 = 0;
  v64 = 96;
  v65 = 16;
  v66 = 112;
  v67 = 176;
  v68 = 96;
  v69 = 192;
  v70 = 112;
  v71 = 112;
  v72 = 96;
  v73 = 128;
  v74 = 112;
  v75 = 160;
  v76 = 96;
  v77 = 176;
  v78 = 112;
  v79 = 144;
  v80 = 96;
  v81 = 160;
  v82 = 112;
  v83 = 48;
  v84 = 96;
  v85 = 64;
  v86 = 112;
  v7 = 0;
  v8 = 112;
  v9 = 16;
  v10 = 128;
  v11 = 16;
  v12 = 112;
  v13 = 32;
  v14 = 128;
  v15 = 0;
  v16 = 112;
  v17 = 16;
  v18 = 128;
  v19 = 32;
  v20 = 112;
  v21 = 48;
  v22 = 128;
  v23 = 0;
  v24 = 112;
  v25 = 16;
  v26 = 128;
  v27 = 176;
  v28 = 112;
  v29 = 192;
  v30 = 128;
  v31 = 112;
  v32 = 112;
  v33 = 128;
  v34 = 128;
  v35 = 160;
  v36 = 112;
  v37 = 176;
  v38 = 128;
  v39 = 144;
  v40 = 112;
  v41 = 160;
  v42 = 128;
  v43 = 48;
  v44 = 112;
  v45 = 64;
  v46 = 128;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      if ( *(_DWORD *)(a1 + 76) == 4 )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_7;
    case 1:
LABEL_7:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) += 64;
      break;
    case 3:
      *(_DWORD *)(a1 + 116) = 4;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_9;
    case 4:
LABEL_9:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 20) += 64;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 512;
      else
        *(_DWORD *)(a1 + 16) = -512;
      break;
    case 5:
      *(_DWORD *)(a1 + 116) = 6;
      *(_DWORD *)(a1 + 104) = 5;
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 8);
      break;
    case 6:
      *(_DWORD *)(a1 + 104) = 5;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 100) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_22;
    case 0xB:
LABEL_22:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) += 512;
      else
        *(_DWORD *)(a1 + 8) -= 512;
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 10240 && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 10240 )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 104) = 6;
      break;
    case 0x15:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 104) = 9;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 20) = -1024;
      goto LABEL_36;
    case 0x1F:
LABEL_36:
      *(_DWORD *)(a1 + 104) = 7;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = -512;
      else
        *(_DWORD *)(a1 + 16) = 512;
      *(_DWORD *)(a1 + 20) += 64;
      v1 = (*(_DWORD *)(a1 + 120))++;
      if ( v1 && *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 116) = 32;
      break;
    case 0x20:
      *(_DWORD *)(a1 + 20) += 64;
      *(_DWORD *)(a1 + 104) = 8;
      *(_DWORD *)(a1 + 16) = 0;
      break;
    case 0x46:
      *(_DWORD *)(a1 + 116) = 71;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_45;
    case 0x47:
LABEL_45:
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) -= 256;
      else
        *(_DWORD *)(a1 + 8) += 256;
      if ( ++*(_DWORD *)(a1 + 100) > 8 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 1;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v6 = a1 + 84;
    *(_DWORD *)v6 = *v5;
    *(_DWORD *)(v6 + 4) = v5[1];
    *(_DWORD *)(v6 + 8) = v5[2];
    result = v5[3];
    *(_DWORD *)(v6 + 12) = result;
  }
  else
  {
    v2 = &v47 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
  }
  return result;
}

//----- (0043E9B0) --------------------------------------------------------
int __cdecl NPC118(int a1)
{
  int *v1; // ecx@66
  int v2; // edx@66
  int result; // eax@66
  int *v4; // ecx@67
  int v5; // edx@67
  signed int v6; // [sp+4h] [bp-124h]@1
  int v7; // [sp+8h] [bp-120h]@1
  int v8; // [sp+Ch] [bp-11Ch]@1
  int v9; // [sp+10h] [bp-118h]@1
  int v10; // [sp+14h] [bp-114h]@1
  int v11; // [sp+18h] [bp-110h]@1
  int v12; // [sp+1Ch] [bp-10Ch]@1
  int v13; // [sp+20h] [bp-108h]@1
  int v14; // [sp+24h] [bp-104h]@1
  int v15; // [sp+28h] [bp-100h]@1
  int v16; // [sp+2Ch] [bp-FCh]@1
  int v17; // [sp+30h] [bp-F8h]@1
  int v18; // [sp+34h] [bp-F4h]@1
  int v19; // [sp+38h] [bp-F0h]@1
  int v20; // [sp+3Ch] [bp-ECh]@1
  int v21; // [sp+40h] [bp-E8h]@1
  int v22; // [sp+44h] [bp-E4h]@1
  int v23; // [sp+48h] [bp-E0h]@1
  int v24; // [sp+4Ch] [bp-DCh]@1
  int v25; // [sp+50h] [bp-D8h]@1
  int v26; // [sp+54h] [bp-D4h]@1
  int v27; // [sp+58h] [bp-D0h]@1
  int v28; // [sp+5Ch] [bp-CCh]@1
  int v29; // [sp+60h] [bp-C8h]@1
  int v30; // [sp+64h] [bp-C4h]@1
  int v31; // [sp+68h] [bp-C0h]@1
  int v32; // [sp+6Ch] [bp-BCh]@1
  int v33; // [sp+70h] [bp-B8h]@1
  int v34; // [sp+74h] [bp-B4h]@1
  int v35; // [sp+78h] [bp-B0h]@1
  int v36; // [sp+7Ch] [bp-ACh]@1
  int v37; // [sp+80h] [bp-A8h]@1
  int v38; // [sp+84h] [bp-A4h]@1
  int v39; // [sp+88h] [bp-A0h]@1
  int v40; // [sp+8Ch] [bp-9Ch]@1
  int v41; // [sp+90h] [bp-98h]@1
  int v42; // [sp+94h] [bp-94h]@1
  int v43; // [sp+98h] [bp-90h]@1
  int v44; // [sp+9Ch] [bp-8Ch]@1
  int v45; // [sp+A0h] [bp-88h]@1
  int v46; // [sp+A4h] [bp-84h]@1
  int v47; // [sp+A8h] [bp-80h]@1
  int v48; // [sp+ACh] [bp-7Ch]@1
  int v49; // [sp+B0h] [bp-78h]@1
  int v50; // [sp+B4h] [bp-74h]@1
  int v51; // [sp+B8h] [bp-70h]@1
  int v52; // [sp+BCh] [bp-6Ch]@1
  int v53; // [sp+C0h] [bp-68h]@1
  int v54; // [sp+C4h] [bp-64h]@1
  int v55; // [sp+C8h] [bp-60h]@1
  int v56; // [sp+CCh] [bp-5Ch]@1
  int v57; // [sp+D0h] [bp-58h]@1
  int v58; // [sp+D4h] [bp-54h]@1
  int v59; // [sp+D8h] [bp-50h]@1
  int v60; // [sp+DCh] [bp-4Ch]@1
  int v61; // [sp+E0h] [bp-48h]@1
  int v62; // [sp+E4h] [bp-44h]@1
  int v63; // [sp+E8h] [bp-40h]@1
  int v64; // [sp+ECh] [bp-3Ch]@1
  int v65; // [sp+F0h] [bp-38h]@1
  int v66; // [sp+F4h] [bp-34h]@1
  int v67; // [sp+F8h] [bp-30h]@1
  int v68; // [sp+FCh] [bp-2Ch]@1
  int v69; // [sp+100h] [bp-28h]@1
  int v70; // [sp+104h] [bp-24h]@1
  int v71; // [sp+108h] [bp-20h]@1
  int v72; // [sp+10Ch] [bp-1Ch]@1
  int v73; // [sp+110h] [bp-18h]@1
  int v74; // [sp+114h] [bp-14h]@1
  int v75; // [sp+118h] [bp-10h]@1
  int v76; // [sp+11Ch] [bp-Ch]@1
  int v77; // [sp+120h] [bp-8h]@1
  int v78; // [sp+124h] [bp-4h]@1

  v43 = 0;
  v44 = 32;
  v45 = 32;
  v46 = 56;
  v47 = 32;
  v48 = 32;
  v49 = 64;
  v50 = 56;
  v51 = 64;
  v52 = 32;
  v53 = 96;
  v54 = 56;
  v55 = 96;
  v56 = 32;
  v57 = 128;
  v58 = 56;
  v59 = 0;
  v60 = 32;
  v61 = 32;
  v62 = 56;
  v63 = 128;
  v64 = 32;
  v65 = 160;
  v66 = 56;
  v67 = 0;
  v68 = 32;
  v69 = 32;
  v70 = 56;
  v71 = 0;
  v72 = 32;
  v73 = 32;
  v74 = 56;
  v75 = 160;
  v76 = 32;
  v77 = 192;
  v78 = 56;
  v7 = 0;
  v8 = 56;
  v9 = 32;
  v10 = 80;
  v11 = 32;
  v12 = 56;
  v13 = 64;
  v14 = 80;
  v15 = 64;
  v16 = 56;
  v17 = 96;
  v18 = 80;
  v19 = 96;
  v20 = 56;
  v21 = 128;
  v22 = 80;
  v23 = 0;
  v24 = 56;
  v25 = 32;
  v26 = 80;
  v27 = 128;
  v28 = 56;
  v29 = 160;
  v30 = 80;
  v31 = 0;
  v32 = 56;
  v33 = 32;
  v34 = 80;
  v35 = 0;
  v36 = 56;
  v37 = 32;
  v38 = 80;
  v39 = 160;
  v40 = 56;
  v41 = 192;
  v42 = 80;
  v6 = 0;
  if ( !*(_DWORD *)(a1 + 76) && *(_DWORD *)(a1 + 8) < Quote.X_Pos )
    v6 = 1;
  if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 8) > Quote.X_Pos )
    v6 = 1;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = Random(50, 100);
      *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
      goto LABEL_13;
    case 0xB:
LABEL_13:
      if ( *(_DWORD *)(a1 + 120) )
        --*(_DWORD *)(a1 + 120);
      else
        *(_DWORD *)(a1 + 116) = 13;
      break;
    case 0xD:
      *(_DWORD *)(a1 + 116) = 14;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 120) = Random(50, 100);
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_20;
    case 0xE:
LABEL_20:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 3;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) += 64;
      else
        *(_DWORD *)(a1 + 16) -= 64;
      if ( *(_DWORD *)(a1 + 120) )
      {
        --*(_DWORD *)(a1 + 120);
      }
      else
      {
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        Play_Sound_Effect(Sfx_Ballos_Ball_etc_Charge_Curly_charging_her_gun, 1);
      }
      break;
    case 0x14:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 16) = 8 * *(_DWORD *)(a1 + 16) / 9;
      if ( ++*(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x15:
      if ( ++*(_DWORD *)(a1 + 120) % 4 == 1 )
      {
        if ( *(_DWORD *)(a1 + 76) )
        {
          if ( v6 )
          {
            *(_DWORD *)(a1 + 104) = 2;
            NPC_Create((NPC_Names)123, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) - 4096, 0, 0, Up, NULL, 256);
          }
          else
          {
            *(_DWORD *)(a1 + 104) = 0;
            NPC_Create((NPC_Names)123, *(_DWORD *)(a1 + 8) + 4096, *(_DWORD *)(a1 + 12) + 2048, 0, 0, Right, NULL, 256);
            *(_DWORD *)(a1 + 8) -= 512;
          }
        }
        else if ( v6 )
        {
          *(_DWORD *)(a1 + 104) = 2;
          NPC_Create((NPC_Names)123, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) - 4096, 0, 0, Up, NULL, 256);
        }
        else
        {
          *(_DWORD *)(a1 + 104) = 0;
          NPC_Create((NPC_Names)123, *(_DWORD *)(a1 + 8) - 4096, *(_DWORD *)(a1 + 12) + 2048, 0, 0, 0, NULL, 256);
          *(_DWORD *)(a1 + 8) += 512;
        }
      }
      if ( *(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0x1E:
      if ( ++*(_DWORD *)(a1 + 104) > 8 )
        *(_DWORD *)(a1 + 104) = 7;
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) > 10 && *(_DWORD *)(a1 + 116) < 30 && Count_Weapon_Bullets(6) )
  {
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 116) = 30;
    *(_DWORD *)(a1 + 104) = 7;
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_WORD *)(a1 + 80) |= 4u;
    *(_DWORD *)(a1 + 16) = 0;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 16) > 511 )
    *(_DWORD *)(a1 + 16) = 511;
  if ( *(_DWORD *)(a1 + 16) < -511 )
    *(_DWORD *)(a1 + 16) = -511;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v43 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (0043F230) --------------------------------------------------------
int __cdecl NPC119(int a1)
{
  int result; // eax@1

  result = a1 + 84;
  *(_DWORD *)result = 248;
  *(_DWORD *)(result + 4) = 184;
  *(_DWORD *)(result + 8) = 272;
  *(_DWORD *)(result + 12) = 200;
  return result;
}

//----- (0043F280) --------------------------------------------------------
signed int __cdecl NPC120(int a1)
{
  int v1; // ecx@2
  signed int result; // eax@2
  int v3; // ecx@3

  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 64;
    *(_DWORD *)(v3 + 4) = 16;
    *(_DWORD *)(v3 + 8) = 80;
    result = 32;
    *(_DWORD *)(v3 + 12) = 32;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 64;
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 80;
    result = 16;
    *(_DWORD *)(v1 + 12) = 16;
  }
  return result;
}

//----- (0043F310) --------------------------------------------------------
void __cdecl NPC121(int a1)
{
  int *v1; // edx@12
  int v2; // eax@12
  int v3; // eax@13
  int v4; // [sp+0h] [bp-34h]@2
  int v5; // [sp+4h] [bp-30h]@1
  int v6; // [sp+8h] [bp-2Ch]@1
  int v7; // [sp+Ch] [bp-28h]@1
  int v8; // [sp+10h] [bp-24h]@1
  int v9; // [sp+14h] [bp-20h]@1
  int v10; // [sp+18h] [bp-1Ch]@1
  int v11; // [sp+1Ch] [bp-18h]@1
  int v12; // [sp+20h] [bp-14h]@1
  int v13; // [sp+24h] [bp-10h]@1
  int v14; // [sp+28h] [bp-Ch]@1
  int v15; // [sp+2Ch] [bp-8h]@1
  int v16; // [sp+30h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 16;
  v10 = 0;
  v11 = 32;
  v12 = 16;
  v13 = 112;
  v14 = 0;
  v15 = 128;
  v16 = 16;
  if ( !*(_DWORD *)(a1 + 76) )
  {
    v4 = *(_DWORD *)(a1 + 116);
    if ( v4 )
    {
      if ( v4 != 1 )
      {
        if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
        {
          *(_DWORD *)(a1 + 116) = 1;
          *(_DWORD *)(a1 + 104) = 0;
        }
LABEL_12:
        v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
        v2 = a1 + 84;
        *(_DWORD *)v2 = *v1;
        *(_DWORD *)(v2 + 4) = v1[1];
        *(_DWORD *)(v2 + 8) = v1[2];
        *(_DWORD *)(v2 + 12) = v1[3];
        return;
      }
    }
    else
    {
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
    }
    if ( Random(0, 120) == 10 )
    {
      *(_DWORD *)(a1 + 116) = 2;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 1;
    }
    goto LABEL_12;
  }
  v3 = a1 + 84;
  *(_DWORD *)v3 = v13;
  *(_DWORD *)(v3 + 4) = v14;
  *(_DWORD *)(v3 + 8) = v15;
  *(_DWORD *)(v3 + 12) = v16;
  if ( ++*(_DWORD *)(a1 + 120) > 100 )
  {
    *(_DWORD *)(a1 + 120) = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 5, 0);
  }
}

//----- (0043F4A0) --------------------------------------------------------
int __cdecl NPC122(int a1)
{
  int *v1; // edx@58
  int result; // eax@58
  int *v3; // edx@59
  int v4; // [sp+4h] [bp-140h]@1
  int v5; // [sp+8h] [bp-13Ch]@1
  int v6; // [sp+Ch] [bp-138h]@1
  int v7; // [sp+10h] [bp-134h]@1
  int v8; // [sp+14h] [bp-130h]@1
  int v9; // [sp+18h] [bp-12Ch]@1
  int v10; // [sp+1Ch] [bp-128h]@1
  int v11; // [sp+20h] [bp-124h]@1
  int v12; // [sp+24h] [bp-120h]@1
  int v13; // [sp+28h] [bp-11Ch]@1
  int v14; // [sp+2Ch] [bp-118h]@1
  int v15; // [sp+30h] [bp-114h]@1
  int v16; // [sp+34h] [bp-110h]@1
  int v17; // [sp+38h] [bp-10Ch]@1
  int v18; // [sp+3Ch] [bp-108h]@1
  int v19; // [sp+40h] [bp-104h]@1
  int v20; // [sp+44h] [bp-100h]@1
  int v21; // [sp+48h] [bp-FCh]@1
  int v22; // [sp+4Ch] [bp-F8h]@1
  int v23; // [sp+50h] [bp-F4h]@1
  int v24; // [sp+54h] [bp-F0h]@1
  int v25; // [sp+58h] [bp-ECh]@1
  int v26; // [sp+5Ch] [bp-E8h]@1
  int v27; // [sp+60h] [bp-E4h]@1
  int v28; // [sp+64h] [bp-E0h]@1
  int v29; // [sp+68h] [bp-DCh]@1
  int v30; // [sp+6Ch] [bp-D8h]@1
  int v31; // [sp+70h] [bp-D4h]@1
  int v32; // [sp+74h] [bp-D0h]@1
  int v33; // [sp+78h] [bp-CCh]@1
  int v34; // [sp+7Ch] [bp-C8h]@1
  int v35; // [sp+80h] [bp-C4h]@1
  int v36; // [sp+84h] [bp-C0h]@1
  int v37; // [sp+88h] [bp-BCh]@1
  int v38; // [sp+8Ch] [bp-B8h]@1
  int v39; // [sp+90h] [bp-B4h]@1
  int v40; // [sp+94h] [bp-B0h]@1
  int v41; // [sp+98h] [bp-ACh]@1
  int v42; // [sp+9Ch] [bp-A8h]@1
  int v43; // [sp+A0h] [bp-A4h]@1
  int v44; // [sp+A4h] [bp-A0h]@1
  int v45; // [sp+A8h] [bp-9Ch]@1
  int v46; // [sp+ACh] [bp-98h]@1
  int v47; // [sp+B0h] [bp-94h]@1
  int v48; // [sp+B4h] [bp-90h]@1
  int v49; // [sp+B8h] [bp-8Ch]@1
  int v50; // [sp+BCh] [bp-88h]@1
  int v51; // [sp+C0h] [bp-84h]@1
  int v52; // [sp+C4h] [bp-80h]@1
  int v53; // [sp+C8h] [bp-7Ch]@1
  int v54; // [sp+CCh] [bp-78h]@1
  int v55; // [sp+D0h] [bp-74h]@1
  int v56; // [sp+D4h] [bp-70h]@1
  int v57; // [sp+D8h] [bp-6Ch]@1
  int v58; // [sp+DCh] [bp-68h]@1
  int v59; // [sp+E0h] [bp-64h]@1
  int v60; // [sp+E4h] [bp-60h]@1
  int v61; // [sp+E8h] [bp-5Ch]@1
  int v62; // [sp+ECh] [bp-58h]@1
  int v63; // [sp+F0h] [bp-54h]@1
  int v64; // [sp+F4h] [bp-50h]@1
  int v65; // [sp+F8h] [bp-4Ch]@1
  int v66; // [sp+FCh] [bp-48h]@1
  int v67; // [sp+100h] [bp-44h]@1
  int v68; // [sp+104h] [bp-40h]@1
  int v69; // [sp+108h] [bp-3Ch]@1
  int v70; // [sp+10Ch] [bp-38h]@1
  int v71; // [sp+110h] [bp-34h]@1
  int v72; // [sp+114h] [bp-30h]@1
  int v73; // [sp+118h] [bp-2Ch]@1
  int v74; // [sp+11Ch] [bp-28h]@1
  int v75; // [sp+120h] [bp-24h]@1
  int v76; // [sp+124h] [bp-20h]@1
  int v77; // [sp+128h] [bp-1Ch]@1
  int v78; // [sp+12Ch] [bp-18h]@1
  int v79; // [sp+130h] [bp-14h]@1
  int v80; // [sp+134h] [bp-10h]@1
  int v81; // [sp+138h] [bp-Ch]@1
  int v82; // [sp+13Ch] [bp-8h]@1
  int v83; // [sp+140h] [bp-4h]@1

  v44 = 0;
  v45 = 0;
  v46 = 16;
  v47 = 16;
  v48 = 16;
  v49 = 0;
  v50 = 32;
  v51 = 16;
  v52 = 32;
  v53 = 0;
  v54 = 48;
  v55 = 16;
  v56 = 0;
  v57 = 0;
  v58 = 16;
  v59 = 16;
  v60 = 48;
  v61 = 0;
  v62 = 64;
  v63 = 16;
  v64 = 0;
  v65 = 0;
  v66 = 16;
  v67 = 16;
  v68 = 80;
  v69 = 0;
  v70 = 96;
  v71 = 16;
  v72 = 96;
  v73 = 0;
  v74 = 112;
  v75 = 16;
  v76 = 112;
  v77 = 0;
  v78 = 128;
  v79 = 16;
  v80 = 128;
  v81 = 0;
  v82 = 144;
  v83 = 16;
  v4 = 0;
  v5 = 16;
  v6 = 16;
  v7 = 32;
  v8 = 16;
  v9 = 16;
  v10 = 32;
  v11 = 32;
  v12 = 32;
  v13 = 16;
  v14 = 48;
  v15 = 32;
  v16 = 0;
  v17 = 16;
  v18 = 16;
  v19 = 32;
  v20 = 48;
  v21 = 16;
  v22 = 64;
  v23 = 32;
  v24 = 0;
  v25 = 16;
  v26 = 16;
  v27 = 32;
  v28 = 80;
  v29 = 16;
  v30 = 96;
  v31 = 32;
  v32 = 96;
  v33 = 16;
  v34 = 112;
  v35 = 32;
  v36 = 112;
  v37 = 16;
  v38 = 128;
  v39 = 32;
  v40 = 128;
  v41 = 16;
  v42 = 144;
  v43 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_DWORD *)(a1 + 8) - 0x4000 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 0x4000 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 64) = 1000;
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = Random(0, 50);
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 164) = 0;
      goto LABEL_17;
    case 0xB:
LABEL_17:
      if ( *(_DWORD *)(a1 + 120) )
        --*(_DWORD *)(a1 + 120);
      else
        *(_DWORD *)(a1 + 116) = 13;
      break;
    case 0xD:
      *(_DWORD *)(a1 + 116) = 14;
      *(_DWORD *)(a1 + 120) = Random(0, 50);
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_24;
    case 0xE:
LABEL_24:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) += 64;
      else
        *(_DWORD *)(a1 + 16) -= 64;
      if ( *(_DWORD *)(a1 + 120) )
      {
        --*(_DWORD *)(a1 + 120);
      }
      else
      {
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 116) = 15;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 20) = -512;
        *(_DWORD *)(a1 + 164) = 2;
      }
      break;
    case 0xF:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 164) = 0;
      }
      break;
    case 0x14:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 164) = 0;
        if ( *(_DWORD *)(a1 + 104) == 6 )
          *(_DWORD *)(a1 + 104) = 8;
        else
          *(_DWORD *)(a1 + 104) = 9;
        *(_DWORD *)(a1 + 120) = Random(300, 400);
      }
      break;
    case 0x15:
      if ( *(_DWORD *)(a1 + 120) )
      {
        --*(_DWORD *)(a1 + 120);
      }
      else
      {
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 64) = 1000;
        *(_DWORD *)(a1 + 116) = 11;
        *(_DWORD *)(a1 + 120) = Random(0, 50);
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) > 10 && *(_DWORD *)(a1 + 116) < 20 && *(_DWORD *)(a1 + 64) != 1000 )
  {
    *(_DWORD *)(a1 + 116) = 20;
    *(_DWORD *)(a1 + 20) = -512;
    *(_DWORD *)(a1 + 104) = Random(6, 7);
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 16) > 511 )
    *(_DWORD *)(a1 + 16) = 511;
  if ( *(_DWORD *)(a1 + 16) < -511 )
    *(_DWORD *)(a1 + 16) = -511;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v44 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (0043FC70) --------------------------------------------------------
int __cdecl NPC123(int a1)
{
  int *v1; // ecx@25
  int v2; // edx@25
  int result; // eax@25
  int v4; // [sp+8h] [bp-4Ch]@1
  int v5; // [sp+Ch] [bp-48h]@1
  int v6; // [sp+10h] [bp-44h]@1
  int v7; // [sp+14h] [bp-40h]@1
  int v8; // [sp+18h] [bp-3Ch]@1
  int v9; // [sp+1Ch] [bp-38h]@1
  int v10; // [sp+20h] [bp-34h]@1
  int v11; // [sp+24h] [bp-30h]@1
  int v12; // [sp+28h] [bp-2Ch]@1
  int v13; // [sp+2Ch] [bp-28h]@1
  int v14; // [sp+30h] [bp-24h]@1
  int v15; // [sp+34h] [bp-20h]@1
  int v16; // [sp+38h] [bp-1Ch]@1
  int v17; // [sp+3Ch] [bp-18h]@1
  int v18; // [sp+40h] [bp-14h]@1
  int v19; // [sp+44h] [bp-10h]@1
  int v20; // [sp+48h] [bp-Ch]@1
  int v21; // [sp+50h] [bp-4h]@1

  v5 = 192;
  v6 = 0;
  v7 = 208;
  v8 = 16;
  v9 = 208;
  v10 = 0;
  v11 = 224;
  v12 = 16;
  v13 = 224;
  v14 = 0;
  v15 = 240;
  v16 = 16;
  v17 = 240;
  v18 = 0;
  v19 = 256;
  v20 = 16;
  v21 = 0;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 == 1 )
    {
      switch ( *(_DWORD *)(a1 + 76) )
      {
        case 0:
          if ( *(_DWORD *)(a1 + 4) & 1 )
            v21 = 1;
          break;
        case 1:
          if ( *(_DWORD *)(a1 + 4) & 2 )
            v21 = 1;
          break;
        case 2:
          if ( *(_DWORD *)(a1 + 4) & 4 )
            v21 = 1;
          break;
        case 3:
          if ( *(_DWORD *)(a1 + 4) & 8 )
            v21 = 1;
          break;
        default:
          break;
      }
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 3, 0);
    Play_Sound_Effect(Sfx_Polar_Star_Shoot_Level_1_2, 1);
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        *(_DWORD *)(a1 + 16) = -4096;
        *(_DWORD *)(a1 + 20) = Random(-128, 128);
        break;
      case 1:
        *(_DWORD *)(a1 + 20) = -4096;
        *(_DWORD *)(a1 + 16) = Random(-128, 128);
        break;
      case 2:
        *(_DWORD *)(a1 + 16) = 4096;
        *(_DWORD *)(a1 + 20) = Random(-128, 128);
        break;
      case 3:
        *(_DWORD *)(a1 + 20) = 4096;
        *(_DWORD *)(a1 + 16) = Random(-128, 128);
        break;
      default:
        break;
    }
  }
  if ( v21 )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 2);
    Play_Sound_Effect(Sfx_Shot_Hit_Wall, 1);
    *(_BYTE *)a1 = 0;
  }
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 76);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0043FEF0) --------------------------------------------------------
int __cdecl NPC124(int a1)
{
  int *v1; // ecx@13
  int v2; // edx@13
  int result; // eax@13
  int v4; // [sp+8h] [bp-20h]@1
  int v5; // [sp+Ch] [bp-1Ch]@1
  int v6; // [sp+10h] [bp-18h]@1
  int v7; // [sp+14h] [bp-14h]@1
  int v8; // [sp+18h] [bp-10h]@1
  int v9; // [sp+1Ch] [bp-Ch]@1
  int v10; // [sp+20h] [bp-8h]@1
  int v11; // [sp+24h] [bp-4h]@1

  v4 = 160;
  v5 = 0;
  v6 = 192;
  v7 = 32;
  v8 = 192;
  v9 = 0;
  v10 = 224;
  v11 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 8) += 4096;
      *(_DWORD *)(a1 + 12) += 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) |= 8u;
      goto LABEL_5;
    case 0xB:
LABEL_5:
      switch ( *(_DWORD *)(a1 + 76) )
      {
        case 0:
          *(_DWORD *)(a1 + 8) -= 128;
          break;
        case 1:
          *(_DWORD *)(a1 + 12) -= 128;
          break;
        case 2:
          *(_DWORD *)(a1 + 8) += 128;
          break;
        case 3:
          *(_DWORD *)(a1 + 12) += 128;
          break;
        default:
          break;
      }
      if ( !(++*(_DWORD *)(a1 + 120) % 8) )
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      Set_Quake(20);
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (004400D0) --------------------------------------------------------
int __cdecl NPC125(int a1)
{
  int result; // eax@7

  if ( *(_DWORD *)(a1 + 64) < 990 )
  {
    Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 8);
    Play_Sound_Effect(Sfx_Enemy_Smoke_Poof, 1);
    if ( *(_DWORD *)(a1 + 76) )
      NPC_Create((NPC_Names)86, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, Right, NULL, 0);
    else
      NPC_Create(Enemy_Basil|0x50, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, Right, NULL, 0);
    *(_BYTE *)a1 = 0;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    result = a1 + 84;
    *(_DWORD *)result = 16;
    *(_DWORD *)(result + 4) = 96;
    *(_DWORD *)(result + 8) = 32;
    *(_DWORD *)(result + 12) = 112;
  }
  else
  {
    result = a1 + 84;
    *(_DWORD *)result = 0;
    *(_DWORD *)(result + 4) = 96;
    *(_DWORD *)(result + 8) = 16;
    *(_DWORD *)(result + 12) = 112;
  }
  return result;
}

//----- (004401F0) --------------------------------------------------------
int __cdecl NPC126(int a1)
{
  int *v1; // edx@51
  int result; // eax@51
  int *v3; // edx@52
  int v4; // [sp+4h] [bp-C0h]@1
  int v5; // [sp+8h] [bp-BCh]@1
  int v6; // [sp+Ch] [bp-B8h]@1
  int v7; // [sp+10h] [bp-B4h]@1
  int v8; // [sp+14h] [bp-B0h]@1
  int v9; // [sp+18h] [bp-ACh]@1
  int v10; // [sp+1Ch] [bp-A8h]@1
  int v11; // [sp+20h] [bp-A4h]@1
  int v12; // [sp+24h] [bp-A0h]@1
  int v13; // [sp+28h] [bp-9Ch]@1
  int v14; // [sp+2Ch] [bp-98h]@1
  int v15; // [sp+30h] [bp-94h]@1
  int v16; // [sp+34h] [bp-90h]@1
  int v17; // [sp+38h] [bp-8Ch]@1
  int v18; // [sp+3Ch] [bp-88h]@1
  int v19; // [sp+40h] [bp-84h]@1
  int v20; // [sp+44h] [bp-80h]@1
  int v21; // [sp+48h] [bp-7Ch]@1
  int v22; // [sp+4Ch] [bp-78h]@1
  int v23; // [sp+50h] [bp-74h]@1
  int v24; // [sp+54h] [bp-70h]@1
  int v25; // [sp+58h] [bp-6Ch]@1
  int v26; // [sp+5Ch] [bp-68h]@1
  int v27; // [sp+60h] [bp-64h]@1
  int v28; // [sp+64h] [bp-60h]@1
  int v29; // [sp+68h] [bp-5Ch]@1
  int v30; // [sp+6Ch] [bp-58h]@1
  int v31; // [sp+70h] [bp-54h]@1
  int v32; // [sp+74h] [bp-50h]@1
  int v33; // [sp+78h] [bp-4Ch]@1
  int v34; // [sp+7Ch] [bp-48h]@1
  int v35; // [sp+80h] [bp-44h]@1
  int v36; // [sp+84h] [bp-40h]@1
  int v37; // [sp+88h] [bp-3Ch]@1
  int v38; // [sp+8Ch] [bp-38h]@1
  int v39; // [sp+90h] [bp-34h]@1
  int v40; // [sp+94h] [bp-30h]@1
  int v41; // [sp+98h] [bp-2Ch]@1
  int v42; // [sp+9Ch] [bp-28h]@1
  int v43; // [sp+A0h] [bp-24h]@1
  int v44; // [sp+A4h] [bp-20h]@1
  int v45; // [sp+A8h] [bp-1Ch]@1
  int v46; // [sp+ACh] [bp-18h]@1
  int v47; // [sp+B0h] [bp-14h]@1
  int v48; // [sp+B4h] [bp-10h]@1
  int v49; // [sp+B8h] [bp-Ch]@1
  int v50; // [sp+BCh] [bp-8h]@1
  int v51; // [sp+C0h] [bp-4h]@1

  v28 = 48;
  v29 = 144;
  v30 = 64;
  v31 = 160;
  v32 = 64;
  v33 = 144;
  v34 = 80;
  v35 = 160;
  v36 = 48;
  v37 = 144;
  v38 = 64;
  v39 = 160;
  v40 = 80;
  v41 = 144;
  v42 = 96;
  v43 = 160;
  v44 = 96;
  v45 = 144;
  v46 = 112;
  v47 = 160;
  v48 = 112;
  v49 = 144;
  v50 = 128;
  v51 = 160;
  v4 = 48;
  v5 = 160;
  v6 = 64;
  v7 = 176;
  v8 = 64;
  v9 = 160;
  v10 = 80;
  v11 = 176;
  v12 = 48;
  v13 = 160;
  v14 = 64;
  v15 = 176;
  v16 = 80;
  v17 = 160;
  v18 = 96;
  v19 = 176;
  v20 = 96;
  v21 = 160;
  v22 = 112;
  v23 = 176;
  v24 = 112;
  v25 = 160;
  v26 = 128;
  v27 = 176;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_DWORD *)(a1 + 8) - 49152 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 49152 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      if ( *(_DWORD *)(a1 + 8) - 0x4000 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 0x4000 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 0;
        else
          *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 116) = 10;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 4;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_25;
    case 0xB:
LABEL_25:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        if ( ++*(_DWORD *)(a1 + 100) > 2 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 5 )
          *(_DWORD *)(a1 + 104) = 4;
      }
      else
      {
        *(_DWORD *)(a1 + 104) = 5;
        *(_DWORD *)(a1 + 100) = 0;
      }
      if ( *(_DWORD *)(a1 + 16) < 0 && *(_DWORD *)(a1 + 4) & 1 )
      {
        *(_DWORD *)(a1 + 16) /= -2;
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 16) > 0 && *(_DWORD *)(a1 + 4) & 4 )
      {
        *(_DWORD *)(a1 + 16) /= -2;
        *(_DWORD *)(a1 + 76) = 0;
      }
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) += 64;
      else
        *(_DWORD *)(a1 + 16) -= 64;
      if ( *(_DWORD *)(a1 + 16) > 1535 )
        *(_DWORD *)(a1 + 16) = 1024;
      if ( *(_DWORD *)(a1 + 16) < -1535 )
        *(_DWORD *)(a1 + 16) = -1024;
      break;
    default:
      break;
  }
  if ( Key_Down & Key_Pressed )
    *(_WORD *)(a1 + 80) |= 0x2000u;
  else
    *(_WORD *)(a1 + 80) &= 0xDFFFu;
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v28 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}
// 49363C: using guessed type int Key_Down;
// 49E214: using guessed type int Key_Pressed;

//----- (00440760) --------------------------------------------------------
int __cdecl NPC127(int a1)
{
  int *v1; // ecx@5
  int v2; // edx@5
  int result; // eax@5
  int *v4; // ecx@6
  int v5; // edx@6
  int v6; // [sp+0h] [bp-60h]@1
  int v7; // [sp+4h] [bp-5Ch]@1
  int v8; // [sp+8h] [bp-58h]@1
  int v9; // [sp+Ch] [bp-54h]@1
  int v10; // [sp+10h] [bp-50h]@1
  int v11; // [sp+14h] [bp-4Ch]@1
  int v12; // [sp+18h] [bp-48h]@1
  int v13; // [sp+1Ch] [bp-44h]@1
  int v14; // [sp+20h] [bp-40h]@1
  int v15; // [sp+24h] [bp-3Ch]@1
  int v16; // [sp+28h] [bp-38h]@1
  int v17; // [sp+2Ch] [bp-34h]@1
  int v18; // [sp+30h] [bp-30h]@1
  int v19; // [sp+34h] [bp-2Ch]@1
  int v20; // [sp+38h] [bp-28h]@1
  int v21; // [sp+3Ch] [bp-24h]@1
  int v22; // [sp+40h] [bp-20h]@1
  int v23; // [sp+44h] [bp-1Ch]@1
  int v24; // [sp+48h] [bp-18h]@1
  int v25; // [sp+4Ch] [bp-14h]@1
  int v26; // [sp+50h] [bp-10h]@1
  int v27; // [sp+54h] [bp-Ch]@1
  int v28; // [sp+58h] [bp-8h]@1
  int v29; // [sp+5Ch] [bp-4h]@1

  v6 = 112;
  v7 = 48;
  v8 = 128;
  v9 = 64;
  v10 = 112;
  v11 = 64;
  v12 = 128;
  v13 = 80;
  v14 = 112;
  v15 = 80;
  v16 = 128;
  v17 = 96;
  v18 = 64;
  v19 = 80;
  v20 = 80;
  v21 = 96;
  v22 = 80;
  v23 = 80;
  v24 = 96;
  v25 = 96;
  v26 = 96;
  v27 = 80;
  v28 = 112;
  v29 = 96;
  if ( ++*(_DWORD *)(a1 + 100) > 0 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    if ( ++*(_DWORD *)(a1 + 104) > 2 )
      *(_BYTE *)a1 = 0;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v18 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (004408B0) --------------------------------------------------------
int __cdecl NPC128(int a1)
{
  int result; // eax@8
  int *v2; // eax@9
  int v3; // ecx@9
  int *v4; // eax@10
  int v5; // ecx@10
  int *v6; // eax@11
  int v7; // ecx@11
  int *v8; // eax@12
  int v9; // ecx@12
  int v10; // [sp+4h] [bp-140h]@1
  int v11; // [sp+8h] [bp-13Ch]@1
  int v12; // [sp+Ch] [bp-138h]@1
  int v13; // [sp+10h] [bp-134h]@1
  int v14; // [sp+14h] [bp-130h]@1
  int v15; // [sp+18h] [bp-12Ch]@1
  int v16; // [sp+1Ch] [bp-128h]@1
  int v17; // [sp+20h] [bp-124h]@1
  int v18; // [sp+24h] [bp-120h]@1
  int v19; // [sp+28h] [bp-11Ch]@1
  int v20; // [sp+2Ch] [bp-118h]@1
  int v21; // [sp+30h] [bp-114h]@1
  int v22; // [sp+34h] [bp-110h]@1
  int v23; // [sp+38h] [bp-10Ch]@1
  int v24; // [sp+3Ch] [bp-108h]@1
  int v25; // [sp+40h] [bp-104h]@1
  int v26; // [sp+44h] [bp-100h]@1
  int v27; // [sp+48h] [bp-FCh]@1
  int v28; // [sp+4Ch] [bp-F8h]@1
  int v29; // [sp+50h] [bp-F4h]@1
  int v30; // [sp+54h] [bp-F0h]@1
  int v31; // [sp+58h] [bp-ECh]@1
  int v32; // [sp+5Ch] [bp-E8h]@1
  int v33; // [sp+60h] [bp-E4h]@1
  int v34; // [sp+64h] [bp-E0h]@1
  int v35; // [sp+68h] [bp-DCh]@1
  int v36; // [sp+6Ch] [bp-D8h]@1
  int v37; // [sp+70h] [bp-D4h]@1
  int v38; // [sp+74h] [bp-D0h]@1
  int v39; // [sp+78h] [bp-CCh]@1
  int v40; // [sp+7Ch] [bp-C8h]@1
  int v41; // [sp+80h] [bp-C4h]@1
  int v42; // [sp+84h] [bp-C0h]@1
  int v43; // [sp+88h] [bp-BCh]@1
  int v44; // [sp+8Ch] [bp-B8h]@1
  int v45; // [sp+90h] [bp-B4h]@1
  int v46; // [sp+94h] [bp-B0h]@1
  int v47; // [sp+98h] [bp-ACh]@1
  int v48; // [sp+9Ch] [bp-A8h]@1
  int v49; // [sp+A0h] [bp-A4h]@1
  int v50; // [sp+A4h] [bp-A0h]@1
  int v51; // [sp+A8h] [bp-9Ch]@1
  int v52; // [sp+ACh] [bp-98h]@1
  int v53; // [sp+B0h] [bp-94h]@1
  int v54; // [sp+B4h] [bp-90h]@1
  int v55; // [sp+B8h] [bp-8Ch]@1
  int v56; // [sp+BCh] [bp-88h]@1
  int v57; // [sp+C0h] [bp-84h]@1
  int v58; // [sp+C4h] [bp-80h]@1
  int v59; // [sp+C8h] [bp-7Ch]@1
  int v60; // [sp+CCh] [bp-78h]@1
  int v61; // [sp+D0h] [bp-74h]@1
  int v62; // [sp+D4h] [bp-70h]@1
  int v63; // [sp+D8h] [bp-6Ch]@1
  int v64; // [sp+DCh] [bp-68h]@1
  int v65; // [sp+E0h] [bp-64h]@1
  int v66; // [sp+E4h] [bp-60h]@1
  int v67; // [sp+E8h] [bp-5Ch]@1
  int v68; // [sp+ECh] [bp-58h]@1
  int v69; // [sp+F0h] [bp-54h]@1
  int v70; // [sp+F4h] [bp-50h]@1
  int v71; // [sp+F8h] [bp-4Ch]@1
  int v72; // [sp+FCh] [bp-48h]@1
  int v73; // [sp+100h] [bp-44h]@1
  int v74; // [sp+104h] [bp-40h]@1
  int v75; // [sp+108h] [bp-3Ch]@1
  int v76; // [sp+10Ch] [bp-38h]@1
  int v77; // [sp+110h] [bp-34h]@1
  int v78; // [sp+114h] [bp-30h]@1
  int v79; // [sp+118h] [bp-2Ch]@1
  int v80; // [sp+11Ch] [bp-28h]@1
  int v81; // [sp+120h] [bp-24h]@1
  int v82; // [sp+124h] [bp-20h]@1
  int v83; // [sp+128h] [bp-1Ch]@1
  int v84; // [sp+12Ch] [bp-18h]@1
  int v85; // [sp+130h] [bp-14h]@1
  int v86; // [sp+134h] [bp-10h]@1
  int v87; // [sp+138h] [bp-Ch]@1
  int v88; // [sp+13Ch] [bp-8h]@1
  int v89; // [sp+140h] [bp-4h]@1

  v50 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 176;
  v55 = 16;
  v56 = 184;
  v57 = 32;
  v58 = 184;
  v59 = 16;
  v60 = 192;
  v61 = 32;
  v62 = 192;
  v63 = 16;
  v64 = 200;
  v65 = 32;
  v66 = 200;
  v67 = 16;
  v68 = 208;
  v69 = 32;
  v30 = 0;
  v31 = 0;
  v32 = 0;
  v33 = 0;
  v34 = 232;
  v35 = 16;
  v36 = 240;
  v37 = 32;
  v38 = 224;
  v39 = 16;
  v40 = 232;
  v41 = 32;
  v42 = 216;
  v43 = 16;
  v44 = 224;
  v45 = 32;
  v46 = 208;
  v47 = 16;
  v48 = 216;
  v49 = 32;
  v70 = 0;
  v71 = 0;
  v72 = 0;
  v73 = 0;
  v74 = 176;
  v75 = 32;
  v76 = 192;
  v77 = 40;
  v78 = 176;
  v79 = 40;
  v80 = 192;
  v81 = 48;
  v82 = 192;
  v83 = 32;
  v84 = 208;
  v85 = 40;
  v86 = 192;
  v87 = 40;
  v88 = 208;
  v89 = 48;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 208;
  v15 = 32;
  v16 = 224;
  v17 = 40;
  v18 = 208;
  v19 = 40;
  v20 = 224;
  v21 = 48;
  v22 = 224;
  v23 = 32;
  v24 = 232;
  v25 = 40;
  v26 = 224;
  v27 = 40;
  v28 = 232;
  v29 = 48;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) && *(_DWORD *)(a1 + 76) != 2 )
    {
      *(_DWORD *)(a1 + 140) = 4096;
      *(_DWORD *)(a1 + 144) = 2048;
    }
    else
    {
      *(_DWORD *)(a1 + 140) = 2048;
      *(_DWORD *)(a1 + 144) = 4096;
    }
  }
  if ( ++*(_DWORD *)(a1 + 104) > 4 )
    *(_BYTE *)a1 = 0;
  result = *(_DWORD *)(a1 + 76);
  switch ( result )
  {
    case 0:
      v2 = &v50 + 4 * *(_DWORD *)(a1 + 104);
      v3 = a1 + 84;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      result = v2[3];
      *(_DWORD *)(v3 + 12) = result;
      break;
    case 1:
      v4 = &v70 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      result = v4[3];
      *(_DWORD *)(v5 + 12) = result;
      break;
    case 2:
      v6 = &v30 + 4 * *(_DWORD *)(a1 + 104);
      v7 = a1 + 84;
      *(_DWORD *)v7 = *v6;
      *(_DWORD *)(v7 + 4) = v6[1];
      *(_DWORD *)(v7 + 8) = v6[2];
      result = v6[3];
      *(_DWORD *)(v7 + 12) = result;
      break;
    case 3:
      v8 = &v10 + 4 * *(_DWORD *)(a1 + 104);
      v9 = a1 + 84;
      *(_DWORD *)v9 = *v8;
      *(_DWORD *)(v9 + 4) = v8[1];
      *(_DWORD *)(v9 + 8) = v8[2];
      result = v8[3];
      *(_DWORD *)(v9 + 12) = result;
      break;
    default:
      return result;
  }
  return result;
}

//----- (00440CF0) --------------------------------------------------------
int __cdecl NPC129(int a1)
{
  int *v1; // edx@4
  int result; // eax@4
  int v3; // [sp+0h] [bp-120h]@1
  int v4; // [sp+4h] [bp-11Ch]@1
  int v5; // [sp+8h] [bp-118h]@1
  int v6; // [sp+Ch] [bp-114h]@1
  int v7; // [sp+10h] [bp-110h]@1
  int v8; // [sp+14h] [bp-10Ch]@1
  int v9; // [sp+18h] [bp-108h]@1
  int v10; // [sp+1Ch] [bp-104h]@1
  int v11; // [sp+20h] [bp-100h]@1
  int v12; // [sp+24h] [bp-FCh]@1
  int v13; // [sp+28h] [bp-F8h]@1
  int v14; // [sp+2Ch] [bp-F4h]@1
  int v15; // [sp+30h] [bp-F0h]@1
  int v16; // [sp+34h] [bp-ECh]@1
  int v17; // [sp+38h] [bp-E8h]@1
  int v18; // [sp+3Ch] [bp-E4h]@1
  int v19; // [sp+40h] [bp-E0h]@1
  int v20; // [sp+44h] [bp-DCh]@1
  int v21; // [sp+48h] [bp-D8h]@1
  int v22; // [sp+4Ch] [bp-D4h]@1
  int v23; // [sp+50h] [bp-D0h]@1
  int v24; // [sp+54h] [bp-CCh]@1
  int v25; // [sp+58h] [bp-C8h]@1
  int v26; // [sp+5Ch] [bp-C4h]@1
  int v27; // [sp+60h] [bp-C0h]@1
  int v28; // [sp+64h] [bp-BCh]@1
  int v29; // [sp+68h] [bp-B8h]@1
  int v30; // [sp+6Ch] [bp-B4h]@1
  int v31; // [sp+70h] [bp-B0h]@1
  int v32; // [sp+74h] [bp-ACh]@1
  int v33; // [sp+78h] [bp-A8h]@1
  int v34; // [sp+7Ch] [bp-A4h]@1
  int v35; // [sp+80h] [bp-A0h]@1
  int v36; // [sp+84h] [bp-9Ch]@1
  int v37; // [sp+88h] [bp-98h]@1
  int v38; // [sp+8Ch] [bp-94h]@1
  int v39; // [sp+90h] [bp-90h]@1
  int v40; // [sp+94h] [bp-8Ch]@1
  int v41; // [sp+98h] [bp-88h]@1
  int v42; // [sp+9Ch] [bp-84h]@1
  int v43; // [sp+A0h] [bp-80h]@1
  int v44; // [sp+A4h] [bp-7Ch]@1
  int v45; // [sp+A8h] [bp-78h]@1
  int v46; // [sp+ACh] [bp-74h]@1
  int v47; // [sp+B0h] [bp-70h]@1
  int v48; // [sp+B4h] [bp-6Ch]@1
  int v49; // [sp+B8h] [bp-68h]@1
  int v50; // [sp+BCh] [bp-64h]@1
  int v51; // [sp+C0h] [bp-60h]@1
  int v52; // [sp+C4h] [bp-5Ch]@1
  int v53; // [sp+C8h] [bp-58h]@1
  int v54; // [sp+CCh] [bp-54h]@1
  int v55; // [sp+D0h] [bp-50h]@1
  int v56; // [sp+D4h] [bp-4Ch]@1
  int v57; // [sp+D8h] [bp-48h]@1
  int v58; // [sp+DCh] [bp-44h]@1
  int v59; // [sp+E0h] [bp-40h]@1
  int v60; // [sp+E4h] [bp-3Ch]@1
  int v61; // [sp+E8h] [bp-38h]@1
  int v62; // [sp+ECh] [bp-34h]@1
  int v63; // [sp+F0h] [bp-30h]@1
  int v64; // [sp+F4h] [bp-2Ch]@1
  int v65; // [sp+F8h] [bp-28h]@1
  int v66; // [sp+FCh] [bp-24h]@1
  int v67; // [sp+100h] [bp-20h]@1
  int v68; // [sp+104h] [bp-1Ch]@1
  int v69; // [sp+108h] [bp-18h]@1
  int v70; // [sp+10Ch] [bp-14h]@1
  int v71; // [sp+110h] [bp-10h]@1
  int v72; // [sp+114h] [bp-Ch]@1
  int v73; // [sp+118h] [bp-8h]@1
  int v74; // [sp+11Ch] [bp-4h]@1

  v3 = 128;
  v4 = 48;
  v5 = 144;
  v6 = 64;
  v7 = 144;
  v8 = 48;
  v9 = 160;
  v10 = 64;
  v11 = 160;
  v12 = 48;
  v13 = 176;
  v14 = 64;
  v15 = 128;
  v16 = 64;
  v17 = 144;
  v18 = 80;
  v19 = 144;
  v20 = 64;
  v21 = 160;
  v22 = 80;
  v23 = 160;
  v24 = 64;
  v25 = 176;
  v26 = 80;
  v27 = 128;
  v28 = 80;
  v29 = 144;
  v30 = 96;
  v31 = 144;
  v32 = 80;
  v33 = 160;
  v34 = 96;
  v35 = 160;
  v36 = 80;
  v37 = 176;
  v38 = 96;
  v39 = 176;
  v40 = 48;
  v41 = 192;
  v42 = 64;
  v43 = 192;
  v44 = 48;
  v45 = 208;
  v46 = 64;
  v47 = 208;
  v48 = 48;
  v49 = 224;
  v50 = 64;
  v51 = 176;
  v52 = 64;
  v53 = 192;
  v54 = 80;
  v55 = 192;
  v56 = 64;
  v57 = 208;
  v58 = 80;
  v59 = 208;
  v60 = 64;
  v61 = 224;
  v62 = 80;
  v63 = 176;
  v64 = 80;
  v65 = 192;
  v66 = 96;
  v67 = 192;
  v68 = 80;
  v69 = 208;
  v70 = 96;
  v71 = 208;
  v72 = 80;
  v73 = 224;
  v74 = 96;
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    if ( ++*(_DWORD *)(a1 + 104) > 2 )
      *(_BYTE *)a1 = 0;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * (*(_DWORD *)(a1 + 104) + 3 * *(_DWORD *)(a1 + 76));
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00441000) --------------------------------------------------------
int __cdecl NPC130(int a1)
{
  int *v1; // eax@29
  int v2; // ecx@29
  int result; // eax@29
  int *v4; // eax@30
  int v5; // ecx@30
  int v6; // [sp+0h] [bp-84h]@1
  int v7; // [sp+4h] [bp-80h]@1
  int v8; // [sp+8h] [bp-7Ch]@1
  int v9; // [sp+Ch] [bp-78h]@1
  int v10; // [sp+10h] [bp-74h]@1
  int v11; // [sp+14h] [bp-70h]@1
  int v12; // [sp+18h] [bp-6Ch]@1
  int v13; // [sp+1Ch] [bp-68h]@1
  int v14; // [sp+20h] [bp-64h]@1
  int v15; // [sp+24h] [bp-60h]@1
  int v16; // [sp+28h] [bp-5Ch]@1
  int v17; // [sp+2Ch] [bp-58h]@1
  int v18; // [sp+30h] [bp-54h]@1
  int v19; // [sp+34h] [bp-50h]@1
  int v20; // [sp+38h] [bp-4Ch]@1
  int v21; // [sp+3Ch] [bp-48h]@1
  int v22; // [sp+40h] [bp-44h]@1
  int v23; // [sp+44h] [bp-40h]@1
  int v24; // [sp+48h] [bp-3Ch]@1
  int v25; // [sp+4Ch] [bp-38h]@1
  int v26; // [sp+50h] [bp-34h]@1
  int v27; // [sp+54h] [bp-30h]@1
  int v28; // [sp+58h] [bp-2Ch]@1
  int v29; // [sp+5Ch] [bp-28h]@1
  int v30; // [sp+60h] [bp-24h]@1
  int v31; // [sp+64h] [bp-20h]@1
  int v32; // [sp+68h] [bp-1Ch]@1
  int v33; // [sp+6Ch] [bp-18h]@1
  int v34; // [sp+70h] [bp-14h]@1
  int v35; // [sp+74h] [bp-10h]@1
  int v36; // [sp+78h] [bp-Ch]@1
  int v37; // [sp+7Ch] [bp-8h]@1
  int v38; // [sp+80h] [bp-4h]@1

  v23 = 48;
  v24 = 144;
  v25 = 64;
  v26 = 160;
  v27 = 64;
  v28 = 144;
  v29 = 80;
  v30 = 160;
  v31 = 48;
  v32 = 144;
  v33 = 64;
  v34 = 160;
  v35 = 80;
  v36 = 144;
  v37 = 96;
  v38 = 160;
  v7 = 48;
  v8 = 160;
  v9 = 64;
  v10 = 176;
  v11 = 64;
  v12 = 160;
  v13 = 80;
  v14 = 176;
  v15 = 48;
  v16 = 160;
  v17 = 64;
  v18 = 176;
  v19 = 80;
  v20 = 160;
  v21 = 96;
  v22 = 176;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_26;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
    *(_WORD *)(a1 + 80) |= 0x2000u;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
  if ( *(_DWORD *)(a1 + 8) - 0x8000 < Quote.X_Pos
    && *(_DWORD *)(a1 + 8) + 0x8000 > Quote.X_Pos
    && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
    && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 3 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 3 )
      *(_DWORD *)(a1 + 104) = 2;
  }
  if ( *(_DWORD *)(a1 + 8) - 49152 < Quote.X_Pos
    && *(_DWORD *)(a1 + 8) + 49152 > Quote.X_Pos
    && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
    && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
  {
    if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
LABEL_26:
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v23 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00441360) --------------------------------------------------------
int __cdecl NPC131(int a1)
{
  int *v1; // eax@4
  int v2; // ecx@4
  int result; // eax@4
  int *v4; // eax@5
  int v5; // ecx@5
  int v6; // [sp+0h] [bp-20h]@1
  int v7; // [sp+4h] [bp-1Ch]@1
  int v8; // [sp+8h] [bp-18h]@1
  int v9; // [sp+Ch] [bp-14h]@1
  int v10; // [sp+10h] [bp-10h]@1
  int v11; // [sp+14h] [bp-Ch]@1
  int v12; // [sp+18h] [bp-8h]@1
  int v13; // [sp+1Ch] [bp-4h]@1

  v10 = 144;
  v11 = 144;
  v12 = 160;
  v13 = 160;
  v6 = 144;
  v7 = 160;
  v8 = 160;
  v9 = 176;
  if ( ++*(_DWORD *)(a1 + 120) > 100 )
  {
    *(_DWORD *)(a1 + 120) = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 5, 0);
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v10 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00441440) --------------------------------------------------------
int __cdecl NPC132(int a1)
{
  int *v1; // edx@49
  int result; // eax@49
  int *v3; // edx@50
  int v4; // [sp+4h] [bp-A0h]@1
  int v5; // [sp+8h] [bp-9Ch]@1
  int v6; // [sp+Ch] [bp-98h]@1
  int v7; // [sp+10h] [bp-94h]@1
  int v8; // [sp+14h] [bp-90h]@1
  int v9; // [sp+18h] [bp-8Ch]@1
  int v10; // [sp+1Ch] [bp-88h]@1
  int v11; // [sp+20h] [bp-84h]@1
  int v12; // [sp+24h] [bp-80h]@1
  int v13; // [sp+28h] [bp-7Ch]@1
  int v14; // [sp+2Ch] [bp-78h]@1
  int v15; // [sp+30h] [bp-74h]@1
  int v16; // [sp+34h] [bp-70h]@1
  int v17; // [sp+38h] [bp-6Ch]@1
  int v18; // [sp+3Ch] [bp-68h]@1
  int v19; // [sp+40h] [bp-64h]@1
  int v20; // [sp+44h] [bp-60h]@1
  int v21; // [sp+48h] [bp-5Ch]@1
  int v22; // [sp+4Ch] [bp-58h]@1
  int v23; // [sp+50h] [bp-54h]@1
  int v24; // [sp+54h] [bp-50h]@1
  int v25; // [sp+58h] [bp-4Ch]@1
  int v26; // [sp+5Ch] [bp-48h]@1
  int v27; // [sp+60h] [bp-44h]@1
  int v28; // [sp+64h] [bp-40h]@1
  int v29; // [sp+68h] [bp-3Ch]@1
  int v30; // [sp+6Ch] [bp-38h]@1
  int v31; // [sp+70h] [bp-34h]@1
  int v32; // [sp+74h] [bp-30h]@1
  int v33; // [sp+78h] [bp-2Ch]@1
  int v34; // [sp+7Ch] [bp-28h]@1
  int v35; // [sp+80h] [bp-24h]@1
  int v36; // [sp+84h] [bp-20h]@1
  int v37; // [sp+88h] [bp-1Ch]@1
  int v38; // [sp+8Ch] [bp-18h]@1
  int v39; // [sp+90h] [bp-14h]@1
  int v40; // [sp+94h] [bp-10h]@1
  int v41; // [sp+98h] [bp-Ch]@1
  int v42; // [sp+9Ch] [bp-8h]@1
  int v43; // [sp+A0h] [bp-4h]@1

  v24 = 48;
  v25 = 144;
  v26 = 64;
  v27 = 160;
  v28 = 64;
  v29 = 144;
  v30 = 80;
  v31 = 160;
  v32 = 96;
  v33 = 144;
  v34 = 112;
  v35 = 160;
  v36 = 96;
  v37 = 144;
  v38 = 112;
  v39 = 160;
  v40 = 128;
  v41 = 144;
  v42 = 144;
  v43 = 160;
  v4 = 48;
  v5 = 160;
  v6 = 64;
  v7 = 176;
  v8 = 64;
  v9 = 160;
  v10 = 80;
  v11 = 176;
  v12 = 96;
  v13 = 160;
  v14 = 112;
  v15 = 176;
  v16 = 96;
  v17 = 160;
  v18 = 112;
  v19 = 176;
  v20 = 128;
  v21 = 160;
  v22 = 144;
  v23 = 176;
  if ( *(_DWORD *)(a1 + 116) < 100 )
  {
    if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_7;
    case 1:
LABEL_7:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_DWORD *)(a1 + 8) - 0x8000 >= Quote.X_Pos
        || *(_DWORD *)(a1 + 8) + 0x8000 <= Quote.X_Pos
        || *(_DWORD *)(a1 + 12) - 0x2000 >= Quote.Y_Pos
        || *(_DWORD *)(a1 + 12) + 0x2000 <= Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 104) == 4 )
          *(_DWORD *)(a1 + 104) = 2;
      }
      else
      {
        if ( ++*(_DWORD *)(a1 + 100) > 4 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 4 )
          *(_DWORD *)(a1 + 104) = 2;
        if ( *(_DWORD *)(a1 + 104) == 4 && !*(_DWORD *)(a1 + 100) )
          Play_Sound_Effect(Sfx_Puppy_Bark, 1);
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_28;
    case 0xB:
LABEL_28:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 0xC:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 11;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_35;
    case 0x65:
LABEL_35:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
      {
        if ( *(_DWORD *)(a1 + 108) >= 3 )
        {
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 108) = 0;
        }
        else
        {
          *(_DWORD *)(a1 + 104) = 2;
          ++*(_DWORD *)(a1 + 108);
        }
      }
      if ( *(_DWORD *)(a1 + 104) == 4 && !*(_DWORD *)(a1 + 100) )
        Play_Sound_Effect(Sfx_Puppy_Bark, 1);
      break;
    case 0x78:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v24 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (004419B0) --------------------------------------------------------
int __cdecl NPC133(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int *v3; // edx@13
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 176;
  v14 = 32;
  v15 = 192;
  v16 = 48;
  v17 = 192;
  v18 = 32;
  v19 = 208;
  v20 = 48;
  v5 = 176;
  v6 = 48;
  v7 = 192;
  v8 = 64;
  v9 = 192;
  v10 = 48;
  v11 = 208;
  v12 = 64;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00441B20) --------------------------------------------------------
int __cdecl NPC134(int a1)
{
  int *v1; // edx@30
  int result; // eax@30
  int *v3; // edx@31
  int v4; // [sp+4h] [bp-60h]@1
  int v5; // [sp+8h] [bp-5Ch]@1
  int v6; // [sp+Ch] [bp-58h]@1
  int v7; // [sp+10h] [bp-54h]@1
  int v8; // [sp+14h] [bp-50h]@1
  int v9; // [sp+18h] [bp-4Ch]@1
  int v10; // [sp+1Ch] [bp-48h]@1
  int v11; // [sp+20h] [bp-44h]@1
  int v12; // [sp+24h] [bp-40h]@1
  int v13; // [sp+28h] [bp-3Ch]@1
  int v14; // [sp+2Ch] [bp-38h]@1
  int v15; // [sp+30h] [bp-34h]@1
  int v16; // [sp+34h] [bp-30h]@1
  int v17; // [sp+38h] [bp-2Ch]@1
  int v18; // [sp+3Ch] [bp-28h]@1
  int v19; // [sp+40h] [bp-24h]@1
  int v20; // [sp+44h] [bp-20h]@1
  int v21; // [sp+48h] [bp-1Ch]@1
  int v22; // [sp+4Ch] [bp-18h]@1
  int v23; // [sp+50h] [bp-14h]@1
  int v24; // [sp+54h] [bp-10h]@1
  int v25; // [sp+58h] [bp-Ch]@1
  int v26; // [sp+5Ch] [bp-8h]@1
  int v27; // [sp+60h] [bp-4h]@1

  v16 = 224;
  v17 = 0;
  v18 = 256;
  v19 = 16;
  v20 = 256;
  v21 = 0;
  v22 = 288;
  v23 = 16;
  v24 = 288;
  v25 = 0;
  v26 = 320;
  v27 = 16;
  v4 = 224;
  v5 = 16;
  v6 = 256;
  v7 = 32;
  v8 = 256;
  v9 = 16;
  v10 = 288;
  v11 = 32;
  v12 = 288;
  v13 = 16;
  v14 = 320;
  v15 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 2;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 4u;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 81920
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x8000 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_WORD *)(a1 + 80) &= 0xFFFBu;
      }
      break;
    case 0xA:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( !*(_DWORD *)(a1 + 76) && *(_DWORD *)(a1 + 4) & 1 )
        *(_DWORD *)(a1 + 76) = 2;
      if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 4) & 4 )
        *(_DWORD *)(a1 + 76) = 0;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) += 256;
      else
        *(_DWORD *)(a1 + 8) -= 256;
      if ( Count_Weapon_Bullets(6) )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        *(_WORD *)(a1 + 80) |= 4u;
      }
      break;
    case 0x14:
      if ( ++*(_DWORD *)(a1 + 120) > 100 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_WORD *)(a1 + 80) &= 0xFFFBu;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v16 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00441EC0) --------------------------------------------------------
int __cdecl NPC135(int a1)
{
  int Y_Vel; // ST24_4@30
  int *v2; // eax@44
  int v3; // ecx@44
  int result; // eax@44
  int *v5; // eax@45
  int v6; // ecx@45
  int v7; // [sp+8h] [bp-48h]@1
  int v8; // [sp+Ch] [bp-44h]@1
  int v9; // [sp+10h] [bp-40h]@1
  int v10; // [sp+14h] [bp-3Ch]@1
  int v11; // [sp+18h] [bp-38h]@1
  int v12; // [sp+1Ch] [bp-34h]@1
  int v13; // [sp+20h] [bp-30h]@1
  int v14; // [sp+24h] [bp-2Ch]@1
  int X_Vel; // [sp+28h] [bp-28h]@30
  int v16; // [sp+2Ch] [bp-24h]@1
  int v17; // [sp+30h] [bp-20h]@1
  int v18; // [sp+34h] [bp-1Ch]@1
  int v19; // [sp+38h] [bp-18h]@1
  int v20; // [sp+3Ch] [bp-14h]@1
  int v21; // [sp+40h] [bp-10h]@1
  int v22; // [sp+44h] [bp-Ch]@1
  int v23; // [sp+48h] [bp-8h]@1
  unsigned __int8 v24; // [sp+4Fh] [bp-1h]@30

  v16 = 256;
  v17 = 32;
  v18 = 288;
  v19 = 64;
  v20 = 288;
  v21 = 32;
  v22 = 320;
  v23 = 64;
  v7 = 256;
  v8 = 64;
  v9 = 288;
  v10 = 96;
  v11 = 288;
  v12 = 64;
  v13 = 320;
  v14 = 96;
  if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) - 180224
    || Quote.X_Pos > *(_DWORD *)(a1 + 8) + 180224
    || Quote.Y_Pos < *(_DWORD *)(a1 + 12) - 81920
    || Quote.Y_Pos > *(_DWORD *)(a1 + 12) + 0x8000 )
  {
    *(_DWORD *)(a1 + 116) = 0;
  }
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_8;
    case 1:
LABEL_8:
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 81920
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x8000 )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_17;
    case 0xB:
LABEL_17:
      if ( ++*(_DWORD *)(a1 + 120) >= 5 && *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 108) = 0;
        *(_DWORD *)(a1 + 20) = -512 * Random(1, 3);
        if ( *(_BYTE *)(a1 + 156) )
        {
          if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
            *(_DWORD *)(a1 + 16) += 256;
          else
            *(_DWORD *)(a1 + 16) -= 256;
        }
        else if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        {
          *(_DWORD *)(a1 + 16) -= 256;
        }
        else
        {
          *(_DWORD *)(a1 + 16) += 256;
        }
      }
      break;
    case 0x14:
      if ( *(_DWORD *)(a1 + 20) > 0 && !*(_DWORD *)(a1 + 108) )
      {
        ++*(_DWORD *)(a1 + 108);
        v24 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) + 2048 - Quote.Y_Pos);
        Y_Vel = 2 * GetSin(v24);
        X_Vel = 2 * GetCos(v24);
        NPC_Create((NPC_Names)50, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 384);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) >= 10 )
  {
    if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
  *(_DWORD *)(a1 + 20) += 51;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  if ( *(_DWORD *)(a1 + 16) > 1535 )
    *(_DWORD *)(a1 + 16) = 1535;
  if ( *(_DWORD *)(a1 + 16) < -1535 )
    *(_DWORD *)(a1 + 16) = -1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v6 = a1 + 84;
    *(_DWORD *)v6 = *v5;
    *(_DWORD *)(v6 + 4) = v5[1];
    *(_DWORD *)(v6 + 8) = v5[2];
    result = v5[3];
    *(_DWORD *)(v6 + 12) = result;
  }
  else
  {
    v2 = &v16 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
  }
  return result;
}

//----- (00442340) --------------------------------------------------------
int __cdecl NPC136(int a1)
{
  int *v1; // edx@15
  int result; // eax@15
  int *v3; // ecx@16
  int v4; // edx@16
  int v5; // [sp+0h] [bp-44h]@1
  int v6; // [sp+4h] [bp-40h]@1
  int v7; // [sp+8h] [bp-3Ch]@1
  int v8; // [sp+Ch] [bp-38h]@1
  int v9; // [sp+10h] [bp-34h]@1
  int v10; // [sp+14h] [bp-30h]@1
  int v11; // [sp+18h] [bp-2Ch]@1
  int v12; // [sp+1Ch] [bp-28h]@1
  int v13; // [sp+20h] [bp-24h]@1
  int v14; // [sp+24h] [bp-20h]@1
  int v15; // [sp+28h] [bp-1Ch]@1
  int v16; // [sp+2Ch] [bp-18h]@1
  int v17; // [sp+30h] [bp-14h]@1
  int v18; // [sp+34h] [bp-10h]@1
  int v19; // [sp+38h] [bp-Ch]@1
  int v20; // [sp+3Ch] [bp-8h]@1
  int v21; // [sp+40h] [bp-4h]@1

  v14 = 48;
  v15 = 144;
  v16 = 64;
  v17 = 160;
  v18 = 64;
  v19 = 144;
  v20 = 80;
  v21 = 160;
  v6 = 48;
  v7 = 160;
  v8 = 64;
  v9 = 176;
  v10 = 64;
  v11 = 160;
  v12 = 80;
  v13 = 176;
  v5 = *(_DWORD *)(a1 + 116);
  if ( v5 )
  {
    if ( v5 != 1 )
    {
      if ( v5 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_WORD *)(a1 + 80) &= 0xDFFFu;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( Quote.Direction )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  *(_DWORD *)(a1 + 12) = Quote.Y_Pos - 5120;
  if ( *(_DWORD *)(a1 + 76) )
  {
    *(_DWORD *)(a1 + 8) = Quote.X_Pos - 2048;
    v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    result = v3[2];
    *(_DWORD *)(v4 + 8) = result;
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  else
  {
    *(_DWORD *)(a1 + 8) = Quote.X_Pos + 2048;
    v1 = &v14 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  if ( Quote.Animation_Num % 2 )
  {
    result = a1;
    ++*(_DWORD *)(a1 + 88);
  }
  return result;
}

//----- (00442540) --------------------------------------------------------
int __cdecl NPC137(int a1)
{
  int result; // eax@1

  result = a1 + 84;
  *(_DWORD *)result = 96;
  *(_DWORD *)(result + 4) = 136;
  *(_DWORD *)(result + 8) = 128;
  *(_DWORD *)(result + 12) = 188;
  return result;
}

//----- (00442590) --------------------------------------------------------
int __cdecl NPC138(int a1)
{
  int result; // eax@1
  int v2; // ecx@6
  int v3; // ecx@7
  int v4; // ecx@13
  int v5; // eax@14
  int v6; // [sp+0h] [bp-24h]@1

  result = a1;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 == 10 )
    {
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) |= 8u;
    }
    else if ( v6 != 11 )
    {
      return result;
    }
    if ( !(++*(_DWORD *)(a1 + 120) % 8) )
      Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
    if ( *(_DWORD *)(a1 + 76) )
    {
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + (*(_DWORD *)(a1 + 120) / 8 << 9);
      v5 = a1 + 84;
      *(_DWORD *)v5 = 112;
      *(_DWORD *)(v5 + 4) = 112;
      *(_DWORD *)(v5 + 8) = 128;
      *(_DWORD *)(v5 + 12) = 136;
      result = a1;
      *(_DWORD *)(a1 + 92) -= *(_DWORD *)(a1 + 120) / 8;
    }
    else
    {
      v4 = a1 + 84;
      *(_DWORD *)v4 = 96;
      *(_DWORD *)(v4 + 4) = 112;
      *(_DWORD *)(v4 + 8) = 112;
      *(_DWORD *)(v4 + 12) = 136;
      result = *(_DWORD *)(a1 + 84) + *(_DWORD *)(a1 + 120) / 8;
      *(_DWORD *)(a1 + 84) = result;
    }
    if ( *(_DWORD *)(a1 + 120) == 104 )
      *(_BYTE *)a1 = 0;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) )
    {
      v3 = a1 + 84;
      *(_DWORD *)v3 = 112;
      *(_DWORD *)(v3 + 4) = 112;
      *(_DWORD *)(v3 + 8) = 128;
      *(_DWORD *)(v3 + 12) = 136;
      *(_DWORD *)(a1 + 8) -= 4096;
    }
    else
    {
      v2 = a1 + 84;
      *(_DWORD *)v2 = 96;
      *(_DWORD *)(v2 + 4) = 112;
      *(_DWORD *)(v2 + 8) = 112;
      *(_DWORD *)(v2 + 12) = 136;
      *(_DWORD *)(a1 + 8) += 4096;
    }
    result = *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 32) = result;
  }
  return result;
}

//----- (00442790) --------------------------------------------------------
int __cdecl NPC139(int a1)
{
  int *v1; // eax@32
  int v2; // ecx@32
  int result; // eax@32
  int *v4; // eax@33
  int v5; // ecx@33
  int v6; // [sp+4h] [bp-60h]@1
  int v7; // [sp+8h] [bp-5Ch]@1
  int v8; // [sp+Ch] [bp-58h]@1
  int v9; // [sp+10h] [bp-54h]@1
  int v10; // [sp+14h] [bp-50h]@1
  int v11; // [sp+18h] [bp-4Ch]@1
  int v12; // [sp+1Ch] [bp-48h]@1
  int v13; // [sp+20h] [bp-44h]@1
  int v14; // [sp+24h] [bp-40h]@1
  int v15; // [sp+28h] [bp-3Ch]@1
  int v16; // [sp+2Ch] [bp-38h]@1
  int v17; // [sp+30h] [bp-34h]@1
  int v18; // [sp+34h] [bp-30h]@1
  int v19; // [sp+38h] [bp-2Ch]@1
  int v20; // [sp+3Ch] [bp-28h]@1
  int v21; // [sp+40h] [bp-24h]@1
  int v22; // [sp+44h] [bp-20h]@1
  int v23; // [sp+48h] [bp-1Ch]@1
  int v24; // [sp+4Ch] [bp-18h]@1
  int v25; // [sp+50h] [bp-14h]@1
  int v26; // [sp+54h] [bp-10h]@1
  int v27; // [sp+58h] [bp-Ch]@1
  int v28; // [sp+5Ch] [bp-8h]@1
  int v29; // [sp+60h] [bp-4h]@1

  v18 = 0;
  v19 = 128;
  v20 = 24;
  v21 = 160;
  v22 = 24;
  v23 = 128;
  v24 = 48;
  v25 = 160;
  v26 = 48;
  v27 = 128;
  v28 = 72;
  v29 = 160;
  v6 = 0;
  v7 = 160;
  v8 = 24;
  v9 = 192;
  v10 = 24;
  v11 = 160;
  v12 = 48;
  v13 = 192;
  v14 = 48;
  v15 = 160;
  v16 = 72;
  v17 = 192;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_DWORD *)(a1 + 12) -= 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 104) = 0;
      else
        *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 20) += 64;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_8;
    case 0xB:
LABEL_8:
      if ( ++*(_DWORD *)(a1 + 100) > 6 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
      {
        *(_DWORD *)(a1 + 104) = 0;
        ++*(_DWORD *)(a1 + 108);
      }
      if ( *(_DWORD *)(a1 + 108) > 8 )
      {
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 1;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12) - 0x4000;
      goto LABEL_16;
    case 0x15:
LABEL_16:
      if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
        *(_DWORD *)(a1 + 20) -= 32;
      else
        *(_DWORD *)(a1 + 20) += 32;
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 20) = 512;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_DWORD *)(a1 + 120) = 2 * (*(_DWORD *)(a1 + 96) - *(_DWORD *)(a1 + 88));
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_25;
    case 0x1F:
LABEL_25:
      --*(_DWORD *)(a1 + 120);
      *(_DWORD *)(a1 + 104) = 0;
      if ( !*(_DWORD *)(a1 + 120) )
        *(_BYTE *)a1 = 0;
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_29;
    case 0x29:
LABEL_29:
      *(_DWORD *)(a1 + 104) = 2;
      if ( ++*(_DWORD *)(a1 + 120) >= 64 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v18 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  if ( *(_DWORD *)(a1 + 116) == 31 || *(_DWORD *)(a1 + 116) == 41 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 2;
    result = *(_DWORD *)(a1 + 120) / 2 % 2;
    if ( result )
    {
      result = a1;
      ++*(_DWORD *)(a1 + 84);
    }
  }
  return result;
}

//----- (00442BF0) --------------------------------------------------------
LONG *__cdecl NPC140(NPC_vars *a1)
{
  int v1; // ST10_4@67
  int v2; // ST0C_4@67
  int v3; // ST08_4@67
  int v4; // eax@67
  int v5; // ST10_4@97
  int v6; // ST0C_4@97
  int v7; // ST08_4@97
  int v8; // eax@97
  int v9; // ST10_4@102
  int v10; // ST0C_4@102
  int v11; // ST08_4@102
  int v12; // eax@102
  int *v13; // edx@108
  LONG *result; // eax@108
  int *v15; // edx@109
  int v16; // [sp+4h] [bp-1C8h]@1
  int v17; // [sp+8h] [bp-1C4h]@1
  int v18; // [sp+Ch] [bp-1C0h]@1
  int v19; // [sp+10h] [bp-1BCh]@1
  int v20; // [sp+14h] [bp-1B8h]@1
  int v21; // [sp+18h] [bp-1B4h]@1
  int v22; // [sp+1Ch] [bp-1B0h]@1
  int v23; // [sp+20h] [bp-1ACh]@1
  int v24; // [sp+24h] [bp-1A8h]@1
  int v25; // [sp+28h] [bp-1A4h]@1
  int v26; // [sp+2Ch] [bp-1A0h]@1
  int v27; // [sp+30h] [bp-19Ch]@1
  int v28; // [sp+34h] [bp-198h]@1
  int v29; // [sp+38h] [bp-194h]@1
  int v30; // [sp+3Ch] [bp-190h]@1
  int v31; // [sp+40h] [bp-18Ch]@1
  int v32; // [sp+44h] [bp-188h]@1
  int v33; // [sp+48h] [bp-184h]@1
  int v34; // [sp+4Ch] [bp-180h]@1
  int v35; // [sp+50h] [bp-17Ch]@1
  int v36; // [sp+54h] [bp-178h]@1
  int v37; // [sp+58h] [bp-174h]@1
  int v38; // [sp+5Ch] [bp-170h]@1
  int v39; // [sp+60h] [bp-16Ch]@1
  int v40; // [sp+64h] [bp-168h]@1
  int v41; // [sp+68h] [bp-164h]@1
  int v42; // [sp+6Ch] [bp-160h]@1
  int v43; // [sp+70h] [bp-15Ch]@1
  int v44; // [sp+74h] [bp-158h]@1
  int v45; // [sp+78h] [bp-154h]@1
  int v46; // [sp+7Ch] [bp-150h]@1
  int v47; // [sp+80h] [bp-14Ch]@1
  int v48; // [sp+84h] [bp-148h]@1
  int v49; // [sp+88h] [bp-144h]@1
  int v50; // [sp+8Ch] [bp-140h]@1
  int v51; // [sp+90h] [bp-13Ch]@1
  int v52; // [sp+94h] [bp-138h]@1
  int v53; // [sp+98h] [bp-134h]@1
  int v54; // [sp+9Ch] [bp-130h]@1
  int v55; // [sp+A0h] [bp-12Ch]@1
  int v56; // [sp+A4h] [bp-128h]@1
  int v57; // [sp+A8h] [bp-124h]@1
  int v58; // [sp+ACh] [bp-120h]@1
  int v59; // [sp+B0h] [bp-11Ch]@1
  int v60; // [sp+B4h] [bp-118h]@1
  int v61; // [sp+B8h] [bp-114h]@1
  int v62; // [sp+BCh] [bp-110h]@1
  int v63; // [sp+C0h] [bp-10Ch]@1
  int v64; // [sp+C4h] [bp-108h]@1
  int v65; // [sp+C8h] [bp-104h]@1
  int v66; // [sp+CCh] [bp-100h]@1
  int v67; // [sp+D0h] [bp-FCh]@1
  int v68; // [sp+D4h] [bp-F8h]@1
  int v69; // [sp+D8h] [bp-F4h]@1
  int v70; // [sp+DCh] [bp-F0h]@1
  int v71; // [sp+E0h] [bp-ECh]@1
  int i; // [sp+E8h] [bp-E4h]@65
  int v73; // [sp+ECh] [bp-E0h]@1
  int v74; // [sp+F0h] [bp-DCh]@1
  int v75; // [sp+F4h] [bp-D8h]@1
  int v76; // [sp+F8h] [bp-D4h]@1
  int v77; // [sp+FCh] [bp-D0h]@1
  int v78; // [sp+100h] [bp-CCh]@1
  int v79; // [sp+104h] [bp-C8h]@1
  int v80; // [sp+108h] [bp-C4h]@1
  int v81; // [sp+10Ch] [bp-C0h]@1
  int v82; // [sp+110h] [bp-BCh]@1
  int v83; // [sp+114h] [bp-B8h]@1
  int v84; // [sp+118h] [bp-B4h]@1
  int v85; // [sp+11Ch] [bp-B0h]@1
  int v86; // [sp+120h] [bp-ACh]@1
  int v87; // [sp+124h] [bp-A8h]@1
  int v88; // [sp+128h] [bp-A4h]@1
  int v89; // [sp+12Ch] [bp-A0h]@1
  int v90; // [sp+130h] [bp-9Ch]@1
  int v91; // [sp+134h] [bp-98h]@1
  int v92; // [sp+138h] [bp-94h]@1
  int v93; // [sp+13Ch] [bp-90h]@1
  int v94; // [sp+140h] [bp-8Ch]@1
  int v95; // [sp+144h] [bp-88h]@1
  int v96; // [sp+148h] [bp-84h]@1
  int v97; // [sp+14Ch] [bp-80h]@1
  int v98; // [sp+150h] [bp-7Ch]@1
  int v99; // [sp+154h] [bp-78h]@1
  int v100; // [sp+158h] [bp-74h]@1
  int v101; // [sp+15Ch] [bp-70h]@1
  int v102; // [sp+160h] [bp-6Ch]@1
  int v103; // [sp+164h] [bp-68h]@1
  int v104; // [sp+168h] [bp-64h]@1
  int v105; // [sp+16Ch] [bp-60h]@1
  int v106; // [sp+170h] [bp-5Ch]@1
  int v107; // [sp+174h] [bp-58h]@1
  int v108; // [sp+178h] [bp-54h]@1
  int v109; // [sp+17Ch] [bp-50h]@1
  int v110; // [sp+180h] [bp-4Ch]@1
  int v111; // [sp+184h] [bp-48h]@1
  int v112; // [sp+188h] [bp-44h]@1
  int v113; // [sp+18Ch] [bp-40h]@1
  int v114; // [sp+190h] [bp-3Ch]@1
  int v115; // [sp+194h] [bp-38h]@1
  int v116; // [sp+198h] [bp-34h]@1
  int v117; // [sp+19Ch] [bp-30h]@1
  int v118; // [sp+1A0h] [bp-2Ch]@1
  int v119; // [sp+1A4h] [bp-28h]@1
  int v120; // [sp+1A8h] [bp-24h]@1
  int v121; // [sp+1ACh] [bp-20h]@1
  int v122; // [sp+1B0h] [bp-1Ch]@1
  int v123; // [sp+1B4h] [bp-18h]@1
  int v124; // [sp+1B8h] [bp-14h]@1
  int v125; // [sp+1BCh] [bp-10h]@1
  int v126; // [sp+1C0h] [bp-Ch]@1
  int v127; // [sp+1C4h] [bp-8h]@1
  int v128; // [sp+1C8h] [bp-4h]@1

  v73 = 0;
  v74 = 0;
  v75 = 32;
  v76 = 32;
  v77 = 32;
  v78 = 0;
  v79 = 64;
  v80 = 32;
  v81 = 64;
  v82 = 0;
  v83 = 96;
  v84 = 32;
  v85 = 96;
  v86 = 0;
  v87 = 128;
  v88 = 32;
  v89 = 128;
  v90 = 0;
  v91 = 160;
  v92 = 32;
  v93 = 160;
  v94 = 0;
  v95 = 192;
  v96 = 32;
  v97 = 192;
  v98 = 0;
  v99 = 224;
  v100 = 32;
  v101 = 224;
  v102 = 0;
  v103 = 256;
  v104 = 32;
  v105 = 0;
  v106 = 64;
  v107 = 32;
  v108 = 96;
  v109 = 32;
  v110 = 64;
  v111 = 64;
  v112 = 96;
  v113 = 64;
  v114 = 64;
  v115 = 96;
  v116 = 96;
  v117 = 96;
  v118 = 64;
  v119 = 128;
  v120 = 96;
  v121 = 128;
  v122 = 64;
  v123 = 160;
  v124 = 96;
  v125 = 0;
  v126 = 0;
  v127 = 0;
  v128 = 0;
  v16 = 0;
  v17 = 32;
  v18 = 32;
  v19 = 64;
  v20 = 32;
  v21 = 32;
  v22 = 64;
  v23 = 64;
  v24 = 64;
  v25 = 32;
  v26 = 96;
  v27 = 64;
  v28 = 96;
  v29 = 32;
  v30 = 128;
  v31 = 64;
  v32 = 128;
  v33 = 32;
  v34 = 160;
  v35 = 64;
  v36 = 160;
  v37 = 32;
  v38 = 192;
  v39 = 64;
  v40 = 192;
  v41 = 32;
  v42 = 224;
  v43 = 64;
  v44 = 224;
  v45 = 32;
  v46 = 256;
  v47 = 64;
  v48 = 0;
  v49 = 96;
  v50 = 32;
  v51 = 128;
  v52 = 32;
  v53 = 96;
  v54 = 64;
  v55 = 128;
  v56 = 64;
  v57 = 96;
  v58 = 96;
  v59 = 128;
  v60 = 96;
  v61 = 96;
  v62 = 128;
  v63 = 128;
  v64 = 128;
  v65 = 96;
  v66 = 160;
  v67 = 128;
  v68 = 0;
  v69 = 0;
  v70 = 0;
  v71 = 0;
  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 1;
      a1->Ani_Num = 9;
      a1->Wait_Timer = 0;
      a1->Entity_Flags &= 0xDFFFu;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Current_State = 2;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 8;
      }
      break;
    case 2:
      if ( ++a1->Ani_Num > 10 )
        a1->Ani_Num = 9;
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Current_State = 3;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 0;
      }
      break;
    case 3:
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Current_State = 10;
        a1->Entity_Flags |= 0x20u;
      }
      break;
    case 0xA:
      a1->Entity_Flags = a1->Entity_Flags;
      a1->Current_State = 11;
      a1->Ani_Num = 0;
      a1->ani_wait = 0;
      a1->Wait_Timer = Random(20, 130);
      a1->X_vel = 0;
      goto LABEL_15;
    case 0xB:
LABEL_15:
      if ( a1->X_pos <= Quote.X_Pos )
        a1->Direction = 2;
      else
        a1->Direction = 0;
      if ( ++a1->ani_wait > 4 )
      {
        a1->ani_wait = 0;
        ++a1->Ani_Num;
      }
      if ( a1->Ani_Num > 1 )
        a1->Ani_Num = 0;
      if ( Count_Weapon_Bullets(6) || Count_Weapon_Bullets(3) > 3 )
        a1->Current_State = 20;
      if ( a1->Wait_Timer )
      {
        --a1->Wait_Timer;
      }
      else if ( Random(0, 99) % 2 )
      {
        a1->Current_State = 20;
      }
      else
      {
        a1->Current_State = 50;
      }
      break;
    case 0x14:
      a1->Current_State = 21;
      a1->Ani_Num = 2;
      a1->Wait_Timer = 0;
      goto LABEL_32;
    case 0x15:
LABEL_32:
      if ( ++a1->Wait_Timer > 10 )
      {
        a1->Current_State = 22;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 3;
        a1->Y_vel = -1535;
        if ( a1->Direction )
          a1->X_vel = 512;
        else
          a1->X_vel = -512;
      }
      break;
    case 0x16:
      if ( ++a1->Wait_Timer > 10 )
      {
        a1->Current_State = 23;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 6;
        NPC_Create(Forcefield|0x80, 0, 0, 0, 0, 0, a1, 0);
      }
      break;
    case 0x17:
      if ( ++a1->Wait_Timer > 30 )
      {
        a1->Current_State = 24;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 7;
      }
      if ( a1->X_pos <= Quote.X_Pos )
        a1->Direction = 2;
      else
        a1->Direction = 0;
      break;
    case 0x18:
      if ( ++a1->Wait_Timer > 3 )
      {
        a1->Current_State = 25;
        a1->Ani_Num = 3;
      }
      break;
    case 0x19:
      if ( a1->Collision_flags & 8 )
      {
        a1->Current_State = 26;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 2;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(20);
      }
      break;
    case 0x1A:
      a1->X_vel = 8 * a1->X_vel / 9;
      if ( ++a1->Wait_Timer > 20 )
      {
        a1->Current_State = 10;
        a1->Ani_Num = 0;
      }
      break;
    case 0x32:
      a1->Current_State = 51;
      a1->Wait_Timer = 0;
      a1->Ani_Num = 4;
      NPC_Create(Forcefield|0x80, 0, 0, 0, 0, 0, a1, 0);
      goto LABEL_56;
    case 0x33:
LABEL_56:
      if ( ++a1->Wait_Timer > 30 )
      {
        a1->Current_State = 52;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 5;
      }
      if ( a1->X_pos <= Quote.X_Pos )
        a1->Direction = 2;
      else
        a1->Direction = 0;
      break;
    case 0x34:
      if ( ++a1->Wait_Timer > 3 )
      {
        a1->Current_State = 10;
        a1->Ani_Num = 0;
      }
      break;
    case 0x64:
      a1->Ani_Num = 3;
      a1->Current_State = 101;
      a1->Entity_Flags &= 0xFFDFu;
      a1->Damage = 0;
      for ( i = 0; i < 8; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = a1->Y_pos + (Random(-12, 12) << 9);
        v4 = Random(-12, 12);
        NPC_Create(Smoke, a1->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
      break;
    case 0x65:
      if ( a1->Collision_flags & 8 )
      {
        a1->Current_State = 102;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 2;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(20);
      }
      break;
    case 0x66:
      a1->X_vel = 8 * a1->X_vel / 9;
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Current_State = 103;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 10;
      }
      break;
    case 0x67:
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Ani_Num = 9;
        a1->Current_State = 104;
        a1->Wait_Timer = 0;
      }
      break;
    case 0x68:
      if ( ++a1->Ani_Num > 10 )
        a1->Ani_Num = 9;
      if ( ++a1->Wait_Timer > 100 )
      {
        a1->Wait_Timer = 0;
        a1->Ani_Num = 9;
        a1->Current_State = 105;
      }
      break;
    case 0x69:
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->ani_wait = 0;
        a1->Current_State = 106;
        a1->Ani_Num = 11;
      }
      break;
    case 0x6A:
      if ( ++a1->ani_wait > 50 )
      {
        a1->ani_wait = 0;
        ++a1->Ani_Num;
      }
      if ( a1->Ani_Num > 12 )
        a1->Ani_Num = 12;
      break;
    case 0x8C:
      a1->Current_State = 141;
      a1->Wait_Timer = 0;
      a1->Ani_Num = 12;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_92;
    case 0x8D:
LABEL_92:
      if ( ++a1->Ani_Num > 13 )
        a1->Ani_Num = 12;
      if ( ++a1->Wait_Timer > 100 )
      {
        for ( i = 0; i < 4; ++i )
        {
          v5 = Random(-1536, 0);
          v6 = Random(-341, 341);
          v7 = a1->Y_pos + (Random(-12, 12) << 9);
          v8 = Random(-12, 12);
          NPC_Create(Smoke, a1->X_pos + (v8 << 9), v7, v6, v5, 0, NULL, 256);
        }
        a1->Is_Alive = 0;
      }
      break;
    default:
      break;
  }
  if ( a1->Current_State > 100 && a1->Current_State < 105 && !(a1->Wait_Timer % 9) )
  {
    v9 = Random(-1536, 0);
    v10 = Random(-341, 341);
    v11 = a1->Y_pos + (Random(-12, 12) << 9);
    v12 = Random(-12, 12);
    NPC_Create(Smoke, a1->X_pos + (v12 << 9), v11, v10, v9, 0, NULL, 256);
  }
  a1->Y_vel += 32;
  if ( a1->Y_vel > 1535 )
    a1->Y_vel = 1535;
  if ( a1->Y_vel < -1535 )
    a1->Y_vel = -1535;
  a1->X_pos += a1->X_vel;
  a1->Y_pos += a1->Y_vel;
  if ( a1->Direction )
  {
    v15 = &v16 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v15;
    result[1] = v15[1];
    result[2] = v15[2];
    result[3] = v15[3];
  }
  else
  {
    v13 = &v73 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v13;
    result[1] = v13[1];
    result[2] = v13[2];
    result[3] = v13[3];
  }
  return result;
}

//----- (00443AC0) --------------------------------------------------------
int __cdecl NPC141(int a1)
{
  int v1; // ST10_4@16
  int v2; // eax@16
  int v3; // ST10_4@22
  int v4; // eax@22
  int *v5; // ecx@26
  int v6; // edx@26
  int result; // eax@26
  signed int i; // [sp+4h] [bp-28h]@14
  signed int ia; // [sp+4h] [bp-28h]@20
  int v10; // [sp+8h] [bp-24h]@1
  int v11; // [sp+Ch] [bp-20h]@1
  int v12; // [sp+10h] [bp-1Ch]@1
  int v13; // [sp+14h] [bp-18h]@1
  int v14; // [sp+18h] [bp-14h]@1
  int v15; // [sp+1Ch] [bp-10h]@1
  int v16; // [sp+20h] [bp-Ch]@1
  int v17; // [sp+24h] [bp-8h]@1
  unsigned __int8 v18; // [sp+2Bh] [bp-1h]@11

  v10 = 288;
  v11 = 32;
  v12 = 304;
  v13 = 48;
  v14 = 304;
  v15 = 32;
  v16 = 320;
  v17 = 48;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 5120;
      else
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 5120;
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 4096;
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 24 || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 52 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
          *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 0x2000;
        else
          *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 0x2000;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
        v18 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
        *(_DWORD *)(a1 + 20) = 4 * GetSin(v18);
        *(_DWORD *)(a1 + 16) = 4 * GetCos(v18);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      break;
    case 0xA:
      if ( *(_DWORD *)(a1 + 4) & 0xF )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-512, 512);
          v2 = Random(-512, 512);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v2, v1, 0, NULL, 256);
        }
      }
      else
      {
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( ++*(_DWORD *)(a1 + 120) > 4 )
      {
        for ( ia = 0; ia < 4; ++ia )
        {
          v3 = Random(-512, 512);
          v4 = Random(-512, 512);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v4, v3, 0, NULL, 256);
        }
        *(_DWORD *)(a1 + 40) = 142;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 16) = 0;
        *(_WORD *)(a1 + 80) &= 0xFFFBu;
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 164) = 1;
      }
      break;
    default:
      break;
  }
  if ( ++*(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  v5 = &v10 + 4 * *(_DWORD *)(a1 + 104);
  v6 = a1 + 84;
  *(_DWORD *)v6 = *v5;
  *(_DWORD *)(v6 + 4) = v5[1];
  result = v5[2];
  *(_DWORD *)(v6 + 8) = result;
  *(_DWORD *)(v6 + 12) = v5[3];
  return result;
}

//----- (00443EC0) --------------------------------------------------------
int __cdecl NPC142(int a1)
{
  int *v1; // edx@25
  int result; // eax@25
  int v3; // [sp+4h] [bp-50h]@1
  int v4; // [sp+8h] [bp-4Ch]@1
  int v5; // [sp+Ch] [bp-48h]@1
  int v6; // [sp+10h] [bp-44h]@1
  int v7; // [sp+14h] [bp-40h]@1
  int v8; // [sp+18h] [bp-3Ch]@1
  int v9; // [sp+1Ch] [bp-38h]@1
  int v10; // [sp+20h] [bp-34h]@1
  int v11; // [sp+24h] [bp-30h]@1
  int v12; // [sp+28h] [bp-2Ch]@1
  int v13; // [sp+2Ch] [bp-28h]@1
  int v14; // [sp+30h] [bp-24h]@1
  int v15; // [sp+34h] [bp-20h]@1
  int v16; // [sp+38h] [bp-1Ch]@1
  int v17; // [sp+3Ch] [bp-18h]@1
  int v18; // [sp+40h] [bp-14h]@1
  int v19; // [sp+44h] [bp-10h]@1
  int v20; // [sp+48h] [bp-Ch]@1
  int v21; // [sp+4Ch] [bp-8h]@1
  int v22; // [sp+50h] [bp-4h]@1

  v3 = 0;
  v4 = 128;
  v5 = 16;
  v6 = 144;
  v7 = 16;
  v8 = 128;
  v9 = 32;
  v10 = 144;
  v11 = 32;
  v12 = 128;
  v13 = 48;
  v14 = 144;
  v15 = 48;
  v16 = 128;
  v17 = 64;
  v18 = 144;
  v19 = 64;
  v20 = 128;
  v21 = 80;
  v22 = 144;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_3;
    case 0xB:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 100) = 0;
      }
      break;
    case 0xC:
      if ( ++*(_DWORD *)(a1 + 100) > 8 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) == 3 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 20) = -512;
        if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
          *(_DWORD *)(a1 + 16) = 512;
        else
          *(_DWORD *)(a1 + 16) = -512;
      }
      break;
    case 0x14:
      if ( *(_DWORD *)(a1 + 20) <= -128 )
        *(_DWORD *)(a1 + 104) = 3;
      else
        *(_DWORD *)(a1 + 104) = 4;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 16) = 0;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    case 0x15:
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  if ( *(_DWORD *)(a1 + 20) < -1535 )
    *(_DWORD *)(a1 + 20) = -1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00444190) --------------------------------------------------------
int __cdecl NPC143(int a1)
{
  int *v1; // eax@2
  int v2; // ecx@2
  int result; // eax@2
  int *v4; // eax@3
  int v5; // ecx@3
  int v6; // [sp+0h] [bp-20h]@1
  int v7; // [sp+4h] [bp-1Ch]@1
  int v8; // [sp+8h] [bp-18h]@1
  int v9; // [sp+Ch] [bp-14h]@1
  int v10; // [sp+10h] [bp-10h]@1
  int v11; // [sp+14h] [bp-Ch]@1
  int v12; // [sp+18h] [bp-8h]@1
  int v13; // [sp+1Ch] [bp-4h]@1

  v10 = 208;
  v11 = 32;
  v12 = 224;
  v13 = 48;
  v6 = 208;
  v7 = 48;
  v8 = 224;
  v9 = 64;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v10 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00444230) --------------------------------------------------------
int __cdecl NPC144(int a1)
{
  int *v1; // edx@24
  int v2; // eax@24
  int *v3; // edx@25
  int v4; // eax@25
  int result; // eax@26
  int v6; // [sp+4h] [bp-A0h]@1
  int v7; // [sp+8h] [bp-9Ch]@1
  int v8; // [sp+Ch] [bp-98h]@1
  int v9; // [sp+10h] [bp-94h]@1
  int v10; // [sp+14h] [bp-90h]@1
  int v11; // [sp+18h] [bp-8Ch]@1
  int v12; // [sp+1Ch] [bp-88h]@1
  int v13; // [sp+20h] [bp-84h]@1
  int v14; // [sp+24h] [bp-80h]@1
  int v15; // [sp+28h] [bp-7Ch]@1
  int v16; // [sp+2Ch] [bp-78h]@1
  int v17; // [sp+30h] [bp-74h]@1
  int v18; // [sp+34h] [bp-70h]@1
  int v19; // [sp+38h] [bp-6Ch]@1
  int v20; // [sp+3Ch] [bp-68h]@1
  int v21; // [sp+40h] [bp-64h]@1
  int v22; // [sp+44h] [bp-60h]@1
  int v23; // [sp+48h] [bp-5Ch]@1
  int v24; // [sp+4Ch] [bp-58h]@1
  int v25; // [sp+50h] [bp-54h]@1
  int v26; // [sp+54h] [bp-50h]@1
  int v27; // [sp+58h] [bp-4Ch]@1
  int v28; // [sp+5Ch] [bp-48h]@1
  int v29; // [sp+60h] [bp-44h]@1
  int v30; // [sp+64h] [bp-40h]@1
  int v31; // [sp+68h] [bp-3Ch]@1
  int v32; // [sp+6Ch] [bp-38h]@1
  int v33; // [sp+70h] [bp-34h]@1
  int v34; // [sp+74h] [bp-30h]@1
  int v35; // [sp+78h] [bp-2Ch]@1
  int v36; // [sp+7Ch] [bp-28h]@1
  int v37; // [sp+80h] [bp-24h]@1
  int v38; // [sp+84h] [bp-20h]@1
  int v39; // [sp+88h] [bp-1Ch]@1
  int v40; // [sp+8Ch] [bp-18h]@1
  int v41; // [sp+90h] [bp-14h]@1
  int v42; // [sp+94h] [bp-10h]@1
  int v43; // [sp+98h] [bp-Ch]@1
  int v44; // [sp+9Ch] [bp-8h]@1
  int v45; // [sp+A0h] [bp-4h]@1

  v26 = 0;
  v27 = 64;
  v28 = 16;
  v29 = 80;
  v30 = 16;
  v31 = 64;
  v32 = 32;
  v33 = 80;
  v34 = 32;
  v35 = 64;
  v36 = 48;
  v37 = 80;
  v38 = 16;
  v39 = 64;
  v40 = 32;
  v41 = 80;
  v42 = 128;
  v43 = 64;
  v44 = 144;
  v45 = 80;
  v6 = 0;
  v7 = 80;
  v8 = 16;
  v9 = 96;
  v10 = 16;
  v11 = 80;
  v12 = 32;
  v13 = 96;
  v14 = 32;
  v15 = 80;
  v16 = 48;
  v17 = 96;
  v18 = 16;
  v19 = 80;
  v20 = 32;
  v21 = 96;
  v22 = 128;
  v23 = 80;
  v24 = 144;
  v25 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 120) == 64 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 4;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 4;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_14;
    case 0xB:
LABEL_14:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 0xC:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 11;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) > 1 )
  {
    *(_DWORD *)(a1 + 20) += 32;
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    *(_DWORD *)(v4 + 8) = v3[2];
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  else
  {
    v1 = &v26 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  result = a1;
  if ( *(_DWORD *)(a1 + 116) == 1 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 4;
    if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
    {
      result = a1;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
    }
    else
    {
      result = a1;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + 512;
    }
  }
  return result;
}

//----- (00444620) --------------------------------------------------------
int __cdecl NPC145(int NPC_Vars)
{
  int *v1; // ecx@15
  int v2; // edx@15
  int result; // eax@15
  int *v4; // ecx@16
  int v5; // edx@16
  int v6; // [sp+4h] [bp-20h]@1
  int v7; // [sp+8h] [bp-1Ch]@1
  int v8; // [sp+Ch] [bp-18h]@1
  int v9; // [sp+10h] [bp-14h]@1
  int v10; // [sp+14h] [bp-10h]@1
  int v11; // [sp+18h] [bp-Ch]@1
  int v12; // [sp+1Ch] [bp-8h]@1
  int v13; // [sp+20h] [bp-4h]@1

  v10 = 96;
  v11 = 32;
  v12 = 112;
  v13 = 48;
  v6 = 112;
  v7 = 32;
  v8 = 128;
  v9 = 48;
  if ( !*(_DWORD *)(NPC_Vars + 116) )
  {
    if ( *(_DWORD *)(*(_DWORD *)(NPC_Vars + 168) + 112) )
    {
      if ( *(_DWORD *)(*(_DWORD *)(NPC_Vars + 168) + 76) )
        *(_DWORD *)(NPC_Vars + 76) = 0;
      else
        *(_DWORD *)(NPC_Vars + 76) = 2;
    }
    else if ( *(_DWORD *)(*(_DWORD *)(NPC_Vars + 168) + 76) )
    {
      *(_DWORD *)(NPC_Vars + 76) = 2;
    }
    else
    {
      *(_DWORD *)(NPC_Vars + 76) = 0;
    }
    if ( *(_DWORD *)(NPC_Vars + 76) )
      *(_DWORD *)(NPC_Vars + 8) = *(_DWORD *)(*(_DWORD *)(NPC_Vars + 168) + 8) + 5120;
    else
      *(_DWORD *)(NPC_Vars + 8) = *(_DWORD *)(*(_DWORD *)(NPC_Vars + 168) + 8) - 5120;
    *(_DWORD *)(NPC_Vars + 12) = *(_DWORD *)(*(_DWORD *)(NPC_Vars + 168) + 12);
  }
  if ( *(_DWORD *)(NPC_Vars + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(NPC_Vars + 104);
    v5 = NPC_Vars + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v10 + 4 * *(_DWORD *)(NPC_Vars + 104);
    v2 = NPC_Vars + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (00444780) --------------------------------------------------------
int __cdecl NPC146(int a1)
{
  int *v1; // eax@16
  int v2; // ecx@16
  int result; // eax@16
  int v4; // [sp+0h] [bp-54h]@1
  int v5; // [sp+4h] [bp-50h]@1
  int v6; // [sp+8h] [bp-4Ch]@1
  int v7; // [sp+Ch] [bp-48h]@1
  int v8; // [sp+10h] [bp-44h]@1
  int v9; // [sp+14h] [bp-40h]@1
  int v10; // [sp+18h] [bp-3Ch]@1
  int v11; // [sp+1Ch] [bp-38h]@1
  int v12; // [sp+20h] [bp-34h]@1
  int v13; // [sp+24h] [bp-30h]@1
  int v14; // [sp+28h] [bp-2Ch]@1
  int v15; // [sp+2Ch] [bp-28h]@1
  int v16; // [sp+30h] [bp-24h]@1
  int v17; // [sp+34h] [bp-20h]@1
  int v18; // [sp+38h] [bp-1Ch]@1
  int v19; // [sp+3Ch] [bp-18h]@1
  int v20; // [sp+40h] [bp-14h]@1
  int v21; // [sp+44h] [bp-10h]@1
  int v22; // [sp+48h] [bp-Ch]@1
  int v23; // [sp+4Ch] [bp-8h]@1
  int v24; // [sp+50h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  v9 = 256;
  v10 = 0;
  v11 = 272;
  v12 = 240;
  v13 = 272;
  v14 = 0;
  v15 = 288;
  v16 = 240;
  v17 = 288;
  v18 = 0;
  v19 = 304;
  v20 = 240;
  v21 = 304;
  v22 = 0;
  v23 = 320;
  v24 = 240;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 )
      {
        if ( ++*(_DWORD *)(a1 + 100) > 2 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) == 2 )
          *(_DWORD *)(a1 + 164) = 10;
        if ( *(_DWORD *)(a1 + 104) > 4 )
        {
          Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 4096, 8);
          *(_BYTE *)a1 = 0;
        }
      }
      goto LABEL_16;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) == 2 )
      Start_Flash(0, 0, 2);
  }
  if ( ++*(_DWORD *)(a1 + 120) > 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    Play_Sound_Effect(Sfx_Lightning, 1);
  }
LABEL_16:
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00444930) --------------------------------------------------------
// Checks for starblock tile & if bullet can break it
int __cdecl NPC147(int a1)
{
  int Sin; // ST24_4@43
  int *v2; // ecx@67
  int v3; // edx@67
  int result; // eax@67
  int *v5; // ecx@68
  int v6; // edx@68
  int v7; // [sp+8h] [bp-D0h]@1
  int v8; // [sp+Ch] [bp-CCh]@1
  int v9; // [sp+10h] [bp-C8h]@1
  int v10; // [sp+14h] [bp-C4h]@1
  int v11; // [sp+18h] [bp-C0h]@1
  int v12; // [sp+1Ch] [bp-BCh]@1
  int v13; // [sp+20h] [bp-B8h]@1
  int v14; // [sp+24h] [bp-B4h]@1
  int v15; // [sp+28h] [bp-B0h]@1
  int v16; // [sp+2Ch] [bp-ACh]@1
  int v17; // [sp+30h] [bp-A8h]@1
  int v18; // [sp+34h] [bp-A4h]@1
  int v19; // [sp+38h] [bp-A0h]@1
  int v20; // [sp+3Ch] [bp-9Ch]@1
  int v21; // [sp+40h] [bp-98h]@1
  int v22; // [sp+44h] [bp-94h]@1
  int v23; // [sp+48h] [bp-90h]@1
  int v24; // [sp+4Ch] [bp-8Ch]@1
  int v25; // [sp+50h] [bp-88h]@1
  int v26; // [sp+54h] [bp-84h]@1
  int v27; // [sp+58h] [bp-80h]@1
  int v28; // [sp+5Ch] [bp-7Ch]@1
  int v29; // [sp+60h] [bp-78h]@1
  int v30; // [sp+64h] [bp-74h]@1
  int X_Vel; // [sp+6Ch] [bp-6Ch]@43
  int v32; // [sp+70h] [bp-68h]@1
  int v33; // [sp+74h] [bp-64h]@1
  int v34; // [sp+78h] [bp-60h]@1
  int v35; // [sp+7Ch] [bp-5Ch]@1
  int v36; // [sp+80h] [bp-58h]@1
  int v37; // [sp+84h] [bp-54h]@1
  int v38; // [sp+88h] [bp-50h]@1
  int v39; // [sp+8Ch] [bp-4Ch]@1
  int v40; // [sp+90h] [bp-48h]@1
  int v41; // [sp+94h] [bp-44h]@1
  int v42; // [sp+98h] [bp-40h]@1
  int v43; // [sp+9Ch] [bp-3Ch]@1
  int v44; // [sp+A0h] [bp-38h]@1
  int v45; // [sp+A4h] [bp-34h]@1
  int v46; // [sp+A8h] [bp-30h]@1
  int v47; // [sp+ACh] [bp-2Ch]@1
  int v48; // [sp+B0h] [bp-28h]@1
  int v49; // [sp+B4h] [bp-24h]@1
  int v50; // [sp+B8h] [bp-20h]@1
  int v51; // [sp+BCh] [bp-1Ch]@1
  int v52; // [sp+C0h] [bp-18h]@1
  int v53; // [sp+C4h] [bp-14h]@1
  int v54; // [sp+C8h] [bp-10h]@1
  int v55; // [sp+CCh] [bp-Ch]@1
  unsigned __int8 Angle; // [sp+D7h] [bp-1h]@43

  v32 = 0;
  v33 = 96;
  v34 = 16;
  v35 = 112;
  v36 = 16;
  v37 = 96;
  v38 = 32;
  v39 = 112;
  v40 = 32;
  v41 = 96;
  v42 = 48;
  v43 = 112;
  v44 = 48;
  v45 = 96;
  v46 = 64;
  v47 = 112;
  v48 = 64;
  v49 = 96;
  v50 = 80;
  v51 = 112;
  v52 = 80;
  v53 = 96;
  v54 = 96;
  v55 = 112;
  v7 = 0;
  v8 = 112;
  v9 = 16;
  v10 = 128;
  v11 = 16;
  v12 = 112;
  v13 = 32;
  v14 = 128;
  v15 = 32;
  v16 = 112;
  v17 = 48;
  v18 = 128;
  v19 = 48;
  v20 = 112;
  v21 = 64;
  v22 = 128;
  v23 = 64;
  v24 = 112;
  v25 = 80;
  v26 = 128;
  v27 = 80;
  v28 = 112;
  v29 = 96;
  v30 = 128;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 12) += 1536;
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 120) < 8
        || *(_DWORD *)(a1 + 8) - 49152 >= Quote.X_Pos
        || *(_DWORD *)(a1 + 8) + 49152 <= Quote.X_Pos
        || *(_DWORD *)(a1 + 12) - 49152 >= Quote.Y_Pos
        || *(_DWORD *)(a1 + 12) + 0x4000 <= Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 120) < 8 )
          ++*(_DWORD *)(a1 + 120);
        *(_DWORD *)(a1 + 104) = 0;
      }
      else
      {
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( *(_DWORD *)(a1 + 120) >= 8
        && *(_DWORD *)(a1 + 8) - 24576 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 24576 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 49152 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 0x4000 > Quote.Y_Pos )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 20) = -1535;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    case 3:
      if ( *(_DWORD *)(a1 + 20) > 256 )
      {
        *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
        *(_DWORD *)(a1 + 116) = 4;
        *(_DWORD *)(a1 + 104) = 3;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 4:
      if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      ++*(_DWORD *)(a1 + 120);
      if ( *(_DWORD *)(a1 + 4) & 7 || *(_DWORD *)(a1 + 120) > 60 )
      {
        *(_DWORD *)(a1 + 164) = 3;
        *(_DWORD *)(a1 + 116) = 5;
        *(_DWORD *)(a1 + 104) = 2;
      }
      else
      {
        if ( *(_DWORD *)(a1 + 120) % 4 == 1 )
          Play_Sound_Effect(Sfx_Critter_Fly, 1);
        if ( *(_DWORD *)(a1 + 4) & 8 )
          *(_DWORD *)(a1 + 20) = -512;
        if ( *(_DWORD *)(a1 + 120) % 30 == 6 )
        {
          Angle = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
          Angle += Random(-6, 6);
          Sin = 3 * GetSin(Angle);
          X_Vel = 3 * GetCos(Angle);
          NPC_Create((NPC_Names)148, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Sin, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        }
        if ( ++*(_DWORD *)(a1 + 100) > 0 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 5 )
          *(_DWORD *)(a1 + 104) = 3;
      }
      break;
    case 5:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 164) = 2;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 1;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) == 4 )
  {
    if ( *(_DWORD *)(a1 + 12) <= *(_DWORD *)(a1 + 36) )
      *(_DWORD *)(a1 + 20) += 16;
    else
      *(_DWORD *)(a1 + 20) -= 16;
    if ( *(_DWORD *)(a1 + 20) > 512 )
      *(_DWORD *)(a1 + 20) = 512;
    if ( *(_DWORD *)(a1 + 20) < -512 )
      *(_DWORD *)(a1 + 20) = -512;
    if ( *(_DWORD *)(a1 + 16) > 512 )
      *(_DWORD *)(a1 + 16) = 512;
    if ( *(_DWORD *)(a1 + 16) < -512 )
      *(_DWORD *)(a1 + 16) = -512;
  }
  else
  {
    *(_DWORD *)(a1 + 20) += 32;
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v6 = a1 + 84;
    *(_DWORD *)v6 = *v5;
    *(_DWORD *)(v6 + 4) = v5[1];
    result = v5[2];
    *(_DWORD *)(v6 + 8) = result;
    *(_DWORD *)(v6 + 12) = v5[3];
  }
  else
  {
    v2 = &v32 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    result = v2[2];
    *(_DWORD *)(v3 + 8) = result;
    *(_DWORD *)(v3 + 12) = v2[3];
  }
  return result;
}

//----- (00445050) --------------------------------------------------------
void __cdecl NPC148(int a1)
{
  int *v1; // ecx@5
  int v2; // edx@5
  int v3; // [sp+0h] [bp-20h]@3
  int v4; // [sp+4h] [bp-1Ch]@3
  int v5; // [sp+8h] [bp-18h]@3
  int v6; // [sp+Ch] [bp-14h]@3
  int v7; // [sp+10h] [bp-10h]@3
  int v8; // [sp+14h] [bp-Ch]@3
  int v9; // [sp+18h] [bp-8h]@3
  int v10; // [sp+1Ch] [bp-4h]@3

  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
    *(_BYTE *)a1 = 0;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v3 = 96;
  v4 = 96;
  v5 = 104;
  v6 = 104;
  v7 = 104;
  v8 = 96;
  v9 = 112;
  v10 = 104;
  if ( ++*(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( ++*(_DWORD *)(a1 + 108) > 300 )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
    *(_BYTE *)a1 = 0;
  }
}

//----- (00445170) --------------------------------------------------------
signed int __cdecl NPC149(int a1)
{
  int v1; // ST10_4@17
  int v2; // ST0C_4@17
  int v3; // eax@17
  int v4; // ST10_4@34
  int v5; // ST0C_4@34
  int v6; // eax@34
  int v7; // ecx@44
  signed int result; // eax@44
  signed int i; // [sp+4h] [bp-14h]@15
  signed int ia; // [sp+4h] [bp-14h]@32

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) += 4096;
      *(_DWORD *)(a1 + 12) += 4096;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 116) = 20;
      else
        *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_WORD *)(a1 + 80) |= 0x40u;
      break;
    case 0xA:
      *(_WORD *)(a1 + 80) &= 0xFF7Fu;
      *(_DWORD *)(a1 + 164) = 0;
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 12800
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 204800
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 12800
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 12800 )
      {
        *(_DWORD *)(a1 + 116) = 11;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xB:
      if ( ++*(_DWORD *)(a1 + 120) % 10 == 6 )
        Play_Sound_Effect(Sfx_Block_Move, 1);
      if ( *(_DWORD *)(a1 + 4) & 1 )
      {
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 116) = 20;
        Set_Quake(10);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) - 0x2000, *(_DWORD *)(a1 + 12) + (v3 << 9), v2, v1, 0, NULL, 256);
        }
      }
      else
      {
        if ( Quote.Collision_Flags & 1 )
        {
          *(_WORD *)(a1 + 80) |= 0x80u;
          *(_DWORD *)(a1 + 164) = 100;
        }
        else
        {
          *(_WORD *)(a1 + 80) &= 0xFF7Fu;
          *(_DWORD *)(a1 + 164) = 0;
        }
        *(_DWORD *)(a1 + 16) -= 32;
      }
      break;
    case 0x14:
      *(_WORD *)(a1 + 80) &= 0xFF7Fu;
      *(_DWORD *)(a1 + 164) = 0;
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 12800
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 204800
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 12800
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 12800 )
      {
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x15:
      if ( ++*(_DWORD *)(a1 + 120) % 10 == 6 )
        Play_Sound_Effect(Sfx_Block_Move, 1);
      if ( *(_DWORD *)(a1 + 4) & 4 )
      {
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 116) = 10;
        Set_Quake(10);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        for ( ia = 0; ia < 4; ++ia )
        {
          v4 = Random(-1536, 0);
          v5 = Random(-341, 341);
          v6 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + 0x2000, *(_DWORD *)(a1 + 12) + (v6 << 9), v5, v4, 0, NULL, 256);
        }
      }
      else
      {
        if ( Quote.Collision_Flags & 4 )
        {
          *(_WORD *)(a1 + 80) |= 0x80u;
          *(_DWORD *)(a1 + 164) = 100;
        }
        else
        {
          *(_WORD *)(a1 + 80) &= 0xFF7Fu;
          *(_DWORD *)(a1 + 164) = 0;
        }
        *(_DWORD *)(a1 + 16) += 32;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 16) > 512 )
    *(_DWORD *)(a1 + 16) = 512;
  if ( *(_DWORD *)(a1 + 16) < -512 )
    *(_DWORD *)(a1 + 16) = -512;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v7 = a1 + 84;
  *(_DWORD *)v7 = 16;
  *(_DWORD *)(v7 + 4) = 0;
  *(_DWORD *)(v7 + 8) = 48;
  result = 32;
  *(_DWORD *)(v7 + 12) = 32;
  return result;
}

//----- (00445660) --------------------------------------------------------
// Solid tile -> Two stage filter for blocks that bullets are s'posta collide with
int __cdecl NPC150(int a1)
{
  int v1; // ST10_4@8
  int v2; // eax@8
  int *v3; // eax@47
  int v4; // ecx@47
  int result; // eax@47
  int *v6; // eax@48
  int v7; // ecx@48
  int v8; // [sp+4h] [bp-128h]@1
  int v9; // [sp+8h] [bp-124h]@1
  int v10; // [sp+Ch] [bp-120h]@1
  int v11; // [sp+10h] [bp-11Ch]@1
  int v12; // [sp+14h] [bp-118h]@1
  int v13; // [sp+18h] [bp-114h]@1
  int v14; // [sp+1Ch] [bp-110h]@1
  int v15; // [sp+20h] [bp-10Ch]@1
  int v16; // [sp+24h] [bp-108h]@1
  int v17; // [sp+28h] [bp-104h]@1
  int v18; // [sp+2Ch] [bp-100h]@1
  int v19; // [sp+30h] [bp-FCh]@1
  int v20; // [sp+34h] [bp-F8h]@1
  int v21; // [sp+38h] [bp-F4h]@1
  int v22; // [sp+3Ch] [bp-F0h]@1
  int v23; // [sp+40h] [bp-ECh]@1
  int v24; // [sp+44h] [bp-E8h]@1
  int v25; // [sp+48h] [bp-E4h]@1
  int v26; // [sp+4Ch] [bp-E0h]@1
  int v27; // [sp+50h] [bp-DCh]@1
  int v28; // [sp+54h] [bp-D8h]@1
  int v29; // [sp+58h] [bp-D4h]@1
  int v30; // [sp+5Ch] [bp-D0h]@1
  int v31; // [sp+60h] [bp-CCh]@1
  int v32; // [sp+64h] [bp-C8h]@1
  int v33; // [sp+68h] [bp-C4h]@1
  int v34; // [sp+6Ch] [bp-C0h]@1
  int v35; // [sp+70h] [bp-BCh]@1
  int v36; // [sp+74h] [bp-B8h]@1
  int v37; // [sp+78h] [bp-B4h]@1
  int v38; // [sp+7Ch] [bp-B0h]@1
  int v39; // [sp+80h] [bp-ACh]@1
  int v40; // [sp+84h] [bp-A8h]@1
  int v41; // [sp+88h] [bp-A4h]@1
  int v42; // [sp+8Ch] [bp-A0h]@1
  int v43; // [sp+90h] [bp-9Ch]@1
  int i; // [sp+98h] [bp-94h]@6
  int v45; // [sp+9Ch] [bp-90h]@1
  int v46; // [sp+A0h] [bp-8Ch]@1
  int v47; // [sp+A4h] [bp-88h]@1
  int v48; // [sp+A8h] [bp-84h]@1
  int v49; // [sp+ACh] [bp-80h]@1
  int v50; // [sp+B0h] [bp-7Ch]@1
  int v51; // [sp+B4h] [bp-78h]@1
  int v52; // [sp+B8h] [bp-74h]@1
  int v53; // [sp+BCh] [bp-70h]@1
  int v54; // [sp+C0h] [bp-6Ch]@1
  int v55; // [sp+C4h] [bp-68h]@1
  int v56; // [sp+C8h] [bp-64h]@1
  int v57; // [sp+CCh] [bp-60h]@1
  int v58; // [sp+D0h] [bp-5Ch]@1
  int v59; // [sp+D4h] [bp-58h]@1
  int v60; // [sp+D8h] [bp-54h]@1
  int v61; // [sp+DCh] [bp-50h]@1
  int v62; // [sp+E0h] [bp-4Ch]@1
  int v63; // [sp+E4h] [bp-48h]@1
  int v64; // [sp+E8h] [bp-44h]@1
  int v65; // [sp+ECh] [bp-40h]@1
  int v66; // [sp+F0h] [bp-3Ch]@1
  int v67; // [sp+F4h] [bp-38h]@1
  int v68; // [sp+F8h] [bp-34h]@1
  int v69; // [sp+FCh] [bp-30h]@1
  int v70; // [sp+100h] [bp-2Ch]@1
  int v71; // [sp+104h] [bp-28h]@1
  int v72; // [sp+108h] [bp-24h]@1
  int v73; // [sp+10Ch] [bp-20h]@1
  int v74; // [sp+110h] [bp-1Ch]@1
  int v75; // [sp+114h] [bp-18h]@1
  int v76; // [sp+118h] [bp-14h]@1
  int v77; // [sp+11Ch] [bp-10h]@1
  int v78; // [sp+120h] [bp-Ch]@1
  int v79; // [sp+124h] [bp-8h]@1
  int v80; // [sp+128h] [bp-4h]@1

  v45 = 0;
  v46 = 0;
  v47 = 16;
  v48 = 16;
  v49 = 48;
  v50 = 0;
  v51 = 64;
  v52 = 16;
  v53 = 144;
  v54 = 0;
  v55 = 160;
  v56 = 16;
  v57 = 16;
  v58 = 0;
  v59 = 32;
  v60 = 16;
  v61 = 0;
  v62 = 0;
  v63 = 16;
  v64 = 16;
  v65 = 32;
  v66 = 0;
  v67 = 48;
  v68 = 16;
  v69 = 0;
  v70 = 0;
  v71 = 16;
  v72 = 16;
  v73 = 160;
  v74 = 0;
  v75 = 176;
  v76 = 16;
  v77 = 112;
  v78 = 0;
  v79 = 128;
  v80 = 16;
  v8 = 0;
  v9 = 16;
  v10 = 16;
  v11 = 32;
  v12 = 48;
  v13 = 16;
  v14 = 64;
  v15 = 32;
  v16 = 144;
  v17 = 16;
  v18 = 160;
  v19 = 32;
  v20 = 16;
  v21 = 16;
  v22 = 32;
  v23 = 32;
  v24 = 0;
  v25 = 16;
  v26 = 16;
  v27 = 32;
  v28 = 32;
  v29 = 16;
  v30 = 48;
  v31 = 32;
  v32 = 0;
  v33 = 16;
  v34 = 16;
  v35 = 32;
  v36 = 160;
  v37 = 16;
  v38 = 176;
  v39 = 32;
  v40 = 112;
  v41 = 16;
  v42 = 128;
  v43 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 76) > 10 )
      {
        *(_DWORD *)(a1 + 8) = Quote.X_Pos;
        *(_DWORD *)(a1 + 12) = Quote.Y_Pos;
        *(_DWORD *)(a1 + 76) -= 10;
      }
      break;
    case 2:
      *(_DWORD *)(a1 + 104) = 1;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      for ( i = 0; i < 4; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v2, v1, 0, NULL, 256);
      }
      Play_Sound_Effect(Sfx_Quote_Smash_Into_Ground, 1);
      goto LABEL_10;
    case 0xB:
LABEL_10:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 64;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_12;
    case 0x15:
LABEL_12:
      if ( !--*(_DWORD *)(a1 + 120) )
        *(_BYTE *)a1 = 0;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_16;
    case 0x33:
LABEL_16:
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 3;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) += 512;
      else
        *(_DWORD *)(a1 + 8) -= 512;
      break;
    case 0x3C:
      *(_DWORD *)(a1 + 116) = 61;
      *(_DWORD *)(a1 + 104) = 7;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      goto LABEL_25;
    case 0x3D:
LABEL_25:
      *(_DWORD *)(a1 + 36) += 256;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + (Random(-1, 1) << 9);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36) + (Random(-1, 1) << 9);
      break;
    case 0x46:
      *(_DWORD *)(a1 + 116) = 71;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_27;
    case 0x47:
LABEL_27:
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) -= 256;
      else
        *(_DWORD *)(a1 + 8) += 256;
      if ( ++*(_DWORD *)(a1 + 100) > 8 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 3;
      break;
    case 0x50:
      *(_DWORD *)(a1 + 104) = 8;
      break;
    case 0x63:
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_37;
    case 0x65:
LABEL_37:
      *(_DWORD *)(a1 + 20) += 64;
      if ( *(_DWORD *)(a1 + 20) > 1535 )
        *(_DWORD *)(a1 + 20) = 1535;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 20) = 0;
        *(_DWORD *)(a1 + 116) = 102;
      }
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      break;
    case 0x66:
      if ( ++*(_DWORD *)(a1 + 100) > 8 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 3;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v6 = &v8 + 4 * *(_DWORD *)(a1 + 104);
    v7 = a1 + 84;
    *(_DWORD *)v7 = *v6;
    *(_DWORD *)(v7 + 4) = v6[1];
    *(_DWORD *)(v7 + 8) = v6[2];
    result = v6[3];
    *(_DWORD *)(v7 + 12) = result;
  }
  else
  {
    v3 = &v45 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    *(_DWORD *)(v4 + 8) = v3[2];
    result = v3[3];
    *(_DWORD *)(v4 + 12) = result;
  }
  if ( *(_DWORD *)(a1 + 116) == 21 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 4;
    result = *(_DWORD *)(a1 + 120) / 2 % 2;
    if ( result )
    {
      result = a1;
      ++*(_DWORD *)(a1 + 84);
    }
  }
  if ( Quote.Equipped_Items & 0x40 )
  {
    *(_DWORD *)(a1 + 88) += 32;
    result = *(_DWORD *)(a1 + 96) + 32;
    *(_DWORD *)(a1 + 96) = result;
  }
  return result;
}

//----- (00445E30) --------------------------------------------------------
int __cdecl NPC151(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int *v3; // edx@13
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 192;
  v14 = 0;
  v15 = 208;
  v16 = 16;
  v17 = 208;
  v18 = 0;
  v19 = 224;
  v20 = 16;
  v5 = 192;
  v6 = 16;
  v7 = 208;
  v8 = 32;
  v9 = 208;
  v10 = 16;
  v11 = 224;
  v12 = 32;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 16 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( !Random(0, 100) )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00445FA0) --------------------------------------------------------
// Backgrounds?
int __cdecl NPC152(int a1)
{
  int v1; // ecx@5
  int result; // eax@5

  if ( !*(_DWORD *)(a1 + 116) )
  {
    if ( *(_DWORD *)(a1 + 76) == 2 )
      *(_DWORD *)(a1 + 12) += 0x2000;
    *(_DWORD *)(a1 + 116) = 1;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 0;
  *(_DWORD *)(v1 + 8) = 0;
  result = 0;
  *(_DWORD *)(v1 + 12) = 0;
  return result;
}

//----- (00446020) --------------------------------------------------------
int __cdecl NPC153(int a1)
{
  int result; // eax@1
  char *v2; // eax@64
  int v3; // ecx@64
  char *v4; // edx@65
  int v5; // eax@65

  result = Quote.X_Pos + 163840;
  if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos + 163840 )
  {
    result = a1;
    if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos - 163840 && *(_DWORD *)(a1 + 12) <= Quote.Y_Pos + 122880 )
    {
      result = Quote.Y_Pos - 122880;
      if ( *(_DWORD *)(a1 + 12) >= Quote.Y_Pos - 122880 )
      {
        switch ( *(_DWORD *)(a1 + 116) )
        {
          case 0:
            *(_DWORD *)(a1 + 116) = 1;
            *(_DWORD *)(a1 + 16) = 0;
            *(_DWORD *)(a1 + 104) = 0;
            *(_DWORD *)(a1 + 12) += 1536;
            goto LABEL_8;
          case 1:
LABEL_8:
            if ( Random(0, 100) == 1 )
            {
              *(_DWORD *)(a1 + 116) = 2;
              *(_DWORD *)(a1 + 104) = 1;
              *(_DWORD *)(a1 + 120) = 0;
            }
            if ( Random(0, 100) == 1 )
            {
              if ( *(_DWORD *)(a1 + 76) )
                *(_DWORD *)(a1 + 76) = 0;
              else
                *(_DWORD *)(a1 + 76) = 2;
            }
            if ( Random(0, 100) == 1 )
              *(_DWORD *)(a1 + 116) = 10;
            break;
          case 2:
            if ( ++*(_DWORD *)(a1 + 120) > 20 )
            {
              *(_DWORD *)(a1 + 116) = 1;
              *(_DWORD *)(a1 + 104) = 0;
            }
            break;
          case 0xA:
            *(_DWORD *)(a1 + 116) = 11;
            *(_DWORD *)(a1 + 120) = Random(25, 100);
            *(_DWORD *)(a1 + 104) = 2;
            *(_DWORD *)(a1 + 100) = 0;
            goto LABEL_21;
          case 0xB:
LABEL_21:
            if ( ++*(_DWORD *)(a1 + 100) > 3 )
            {
              *(_DWORD *)(a1 + 100) = 0;
              ++*(_DWORD *)(a1 + 104);
            }
            if ( *(_DWORD *)(a1 + 104) > 5 )
              *(_DWORD *)(a1 + 104) = 2;
            if ( *(_DWORD *)(a1 + 76) )
              *(_DWORD *)(a1 + 16) = 512;
            else
              *(_DWORD *)(a1 + 16) = -512;
            if ( *(_DWORD *)(a1 + 120) )
            {
              --*(_DWORD *)(a1 + 120);
            }
            else
            {
              *(_DWORD *)(a1 + 116) = 1;
              *(_DWORD *)(a1 + 104) = 0;
              *(_DWORD *)(a1 + 16) = 0;
            }
            if ( *(_DWORD *)(a1 + 76) || !(*(_DWORD *)(a1 + 4) & 1) )
            {
              if ( *(_DWORD *)(a1 + 76) == 2 )
              {
                if ( *(_DWORD *)(a1 + 4) & 4 )
                {
                  *(_DWORD *)(a1 + 104) = 2;
                  *(_DWORD *)(a1 + 20) = -1535;
                  *(_DWORD *)(a1 + 116) = 20;
                  if ( !(Quote.Flags & 2) )
                    Play_Sound_Effect(Sfx_Critter_Hop, 1);
                }
              }
            }
            else
            {
              *(_DWORD *)(a1 + 104) = 2;
              *(_DWORD *)(a1 + 20) = -1535;
              *(_DWORD *)(a1 + 116) = 20;
              if ( !(Quote.Flags & 2) )
                Play_Sound_Effect(Sfx_Critter_Hop, 1);
            }
            break;
          case 0x14:
            if ( *(_DWORD *)(a1 + 76) || !(*(_DWORD *)(a1 + 4) & 1) )
            {
              if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 4) & 4 )
                ++*(_DWORD *)(a1 + 108);
              else
                *(_DWORD *)(a1 + 108) = 0;
            }
            else
            {
              ++*(_DWORD *)(a1 + 108);
            }
            if ( *(_DWORD *)(a1 + 108) > 10 )
            {
              if ( *(_DWORD *)(a1 + 76) )
                *(_DWORD *)(a1 + 76) = 0;
              else
                *(_DWORD *)(a1 + 76) = 2;
            }
            if ( *(_DWORD *)(a1 + 76) )
              *(_DWORD *)(a1 + 16) = 256;
            else
              *(_DWORD *)(a1 + 16) = -256;
            if ( *(_DWORD *)(a1 + 4) & 8 )
            {
              *(_DWORD *)(a1 + 116) = 21;
              *(_DWORD *)(a1 + 104) = 20;
              *(_DWORD *)(a1 + 120) = 0;
              *(_DWORD *)(a1 + 16) = 0;
              if ( !(Quote.Flags & 2) )
                Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
            }
            break;
          case 0x15:
            if ( ++*(_DWORD *)(a1 + 120) > 10 )
            {
              *(_DWORD *)(a1 + 116) = 1;
              *(_DWORD *)(a1 + 104) = 0;
            }
            break;
          default:
            break;
        }
        *(_DWORD *)(a1 + 20) += 64;
        if ( *(_DWORD *)(a1 + 20) > 1535 )
          *(_DWORD *)(a1 + 20) = 1535;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
        if ( *(_DWORD *)(a1 + 76) )
        {
          v4 = (char *)&unk_4983F0 + 16 * *(_DWORD *)(a1 + 104);
          v5 = a1 + 84;
          *(_DWORD *)v5 = *(_DWORD *)v4;
          *(_DWORD *)(v5 + 4) = *((_DWORD *)v4 + 1);
          *(_DWORD *)(v5 + 8) = *((_DWORD *)v4 + 2);
          *(_DWORD *)(v5 + 12) = *((_DWORD *)v4 + 3);
        }
        else
        {
          v2 = (char *)&unk_4982A0 + 16 * *(_DWORD *)(a1 + 104);
          v3 = a1 + 84;
          *(_DWORD *)v3 = *(_DWORD *)v2;
          *(_DWORD *)(v3 + 4) = *((_DWORD *)v2 + 1);
          *(_DWORD *)(v3 + 8) = *((_DWORD *)v2 + 2);
          *(_DWORD *)(v3 + 12) = *((_DWORD *)v2 + 3);
        }
        result = a1;
        if ( *(_DWORD *)(a1 + 64) <= 985 )
        {
          *(_DWORD *)(a1 + 40) = 154;
          *(_DWORD *)(a1 + 116) = 0;
        }
      }
    }
  }
  return result;
}

//----- (00446500) --------------------------------------------------------
int __cdecl NPC154(int NPC_Vars_Pointer)
{
  char *v1; // edx@21
  int result; // eax@21
  char *v3; // ecx@22
  int v4; // edx@22
  int v5; // [sp+0h] [bp-4h]@1

  v5 = *(_DWORD *)(NPC_Vars_Pointer + 116);
  if ( v5 )
  {
    if ( v5 == 1 )
    {
      if ( *(_DWORD *)(NPC_Vars_Pointer + 4) & 8 )
      {
        *(_DWORD *)(NPC_Vars_Pointer + 104) = 10;
        *(_DWORD *)(NPC_Vars_Pointer + 100) = 0;
        *(_DWORD *)(NPC_Vars_Pointer + 116) = 2;
        *(_DWORD *)(NPC_Vars_Pointer + 120) = 0;
      }
    }
    else if ( v5 == 2 )
    {
      *(_DWORD *)(NPC_Vars_Pointer + 16) = 8 * *(_DWORD *)(NPC_Vars_Pointer + 16) / 9;
      if ( ++*(_DWORD *)(NPC_Vars_Pointer + 100) > 3 )
      {
        *(_DWORD *)(NPC_Vars_Pointer + 100) = 0;
        ++*(_DWORD *)(NPC_Vars_Pointer + 104);
      }
      if ( *(_DWORD *)(NPC_Vars_Pointer + 104) > 11 )
        *(_DWORD *)(NPC_Vars_Pointer + 104) = 10;
      if ( ++*(_DWORD *)(NPC_Vars_Pointer + 120) > 50 )
        *(_BYTE *)NPC_Vars_Pointer |= 8u;
    }
  }
  else
  {
    *(_WORD *)(NPC_Vars_Pointer + 80) &= 0xFFDFu;
    *(_WORD *)(NPC_Vars_Pointer + 80) &= 0xFFF7u;
    *(_DWORD *)(NPC_Vars_Pointer + 164) = 0;
    *(_DWORD *)(NPC_Vars_Pointer + 116) = 1;
    *(_DWORD *)(NPC_Vars_Pointer + 104) = 9;
    *(_DWORD *)(NPC_Vars_Pointer + 20) = -512;
    if ( *(_DWORD *)(NPC_Vars_Pointer + 76) )
      *(_DWORD *)(NPC_Vars_Pointer + 16) = -256;
    else
      *(_DWORD *)(NPC_Vars_Pointer + 16) = 256;
    Play_Sound_Effect(Sfx_Gaudi_Die, 1);
  }
  *(_DWORD *)(NPC_Vars_Pointer + 20) += 32;
  if ( *(_DWORD *)(NPC_Vars_Pointer + 20) > 1535 )
    *(_DWORD *)(NPC_Vars_Pointer + 20) = 1535;
  *(_DWORD *)(NPC_Vars_Pointer + 8) += *(_DWORD *)(NPC_Vars_Pointer + 16);
  *(_DWORD *)(NPC_Vars_Pointer + 12) += *(_DWORD *)(NPC_Vars_Pointer + 20);
  if ( *(_DWORD *)(NPC_Vars_Pointer + 76) )
  {
    v3 = (char *)&unk_4983F0 + 16 * *(_DWORD *)(NPC_Vars_Pointer + 104);
    v4 = NPC_Vars_Pointer + 84;
    *(_DWORD *)v4 = *(_DWORD *)v3;
    *(_DWORD *)(v4 + 4) = *((_DWORD *)v3 + 1);
    result = *((_DWORD *)v3 + 2);
    *(_DWORD *)(v4 + 8) = result;
    *(_DWORD *)(v4 + 12) = *((_DWORD *)v3 + 3);
  }
  else
  {
    v1 = (char *)&unk_4982A0 + 16 * *(_DWORD *)(NPC_Vars_Pointer + 104);
    result = NPC_Vars_Pointer + 84;
    *(_DWORD *)result = *(_DWORD *)v1;
    *(_DWORD *)(result + 4) = *((_DWORD *)v1 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v1 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v1 + 3);
  }
  return result;
}

//----- (00446710) --------------------------------------------------------
// Remove Ammo From Weapon
int __cdecl NPC155(int a1)
{
  int result; // eax@1
  unsigned __int8 v2; // ST2F_1@10
  unsigned __int8 v3; // ST2F_1@10
  unsigned __int8 v4; // ST2F_1@20
  unsigned __int8 v5; // ST2F_1@20
  int Y_Vel; // ST24_4@20
  int X_Vel; // ST28_4@20
  char *v8; // edx@43
  char *v9; // ecx@44
  int v10; // edx@44
  int v11; // [sp+0h] [bp-10h]@6

  result = Quote.X_Pos + 163840;
  if ( *(_DWORD *)(a1 + 8) > Quote.X_Pos + 163840 )
    return result;
  result = a1;
  if ( *(_DWORD *)(a1 + 8) < Quote.X_Pos - 163840 )
    return result;
  if ( *(_DWORD *)(a1 + 12) > Quote.Y_Pos + 122880 )
    return result;
  result = Quote.Y_Pos - 122880;
  if ( *(_DWORD *)(a1 + 12) < Quote.Y_Pos - 122880 )
    return result;
  v11 = *(_DWORD *)(a1 + 116);
  if ( !v11 )
  {
    v2 = Random(0, 255);
    *(_DWORD *)(a1 + 16) = GetCos(v2);
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8) + 8 * GetCos(v2 + 64);
    v3 = Random(0, 255);
    *(_DWORD *)(a1 + 20) = GetSin(v3);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12) + 8 * GetSin(v3 + 64);
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 108) = 120;
    *(_DWORD *)(a1 + 120) = Random(70, 150);
    *(_DWORD *)(a1 + 104) = 14;
    goto LABEL_11;
  }
  if ( v11 == 1 )
  {
LABEL_11:
    if ( ++*(_DWORD *)(a1 + 104) > 15 )
      *(_DWORD *)(a1 + 104) = 14;
    if ( *(_DWORD *)(a1 + 120) )
    {
      --*(_DWORD *)(a1 + 120);
    }
    else
    {
      *(_DWORD *)(a1 + 116) = 2;
      *(_DWORD *)(a1 + 104) = 18;
    }
    goto LABEL_23;
  }
  if ( v11 == 2 )
  {
    if ( ++*(_DWORD *)(a1 + 104) > 19 )
      *(_DWORD *)(a1 + 104) = 18;
    if ( ++*(_DWORD *)(a1 + 120) > 30 )
    {
      v4 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
      v5 = Random(-6, 6) + v4;
      Y_Vel = 3 * GetSin(v5);
      X_Vel = 3 * GetCos(v5);
      NPC_Create((NPC_Names)156, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
      if ( !(Quote.Flags & 2) )
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = Random(70, 150);
      *(_DWORD *)(a1 + 104) = 14;
      *(_DWORD *)(a1 + 100) = 0;
    }
  }
LABEL_23:
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 32) < *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 16) -= 16;
  if ( *(_DWORD *)(a1 + 32) > *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 16) += 16;
  if ( *(_DWORD *)(a1 + 36) < *(_DWORD *)(a1 + 12) )
    *(_DWORD *)(a1 + 20) -= 16;
  if ( *(_DWORD *)(a1 + 36) > *(_DWORD *)(a1 + 12) )
    *(_DWORD *)(a1 + 20) += 16;
  if ( *(_DWORD *)(a1 + 16) > 512 )
    *(_DWORD *)(a1 + 16) = 512;
  if ( *(_DWORD *)(a1 + 16) < -512 )
    *(_DWORD *)(a1 + 16) = -512;
  if ( *(_DWORD *)(a1 + 20) > 512 )
    *(_DWORD *)(a1 + 20) = 512;
  if ( *(_DWORD *)(a1 + 20) < -512 )
    *(_DWORD *)(a1 + 20) = -512;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v9 = (char *)&unk_4983F0 + 16 * *(_DWORD *)(a1 + 104);
    v10 = a1 + 84;
    *(_DWORD *)v10 = *(_DWORD *)v9;
    *(_DWORD *)(v10 + 4) = *((_DWORD *)v9 + 1);
    result = *((_DWORD *)v9 + 2);
    *(_DWORD *)(v10 + 8) = result;
    *(_DWORD *)(v10 + 12) = *((_DWORD *)v9 + 3);
  }
  else
  {
    v8 = (char *)&unk_4982A0 + 16 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *(_DWORD *)v8;
    *(_DWORD *)(result + 4) = *((_DWORD *)v8 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v8 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v8 + 3);
  }
  if ( *(_DWORD *)(a1 + 64) <= 985 )
  {
    result = a1;
    *(_DWORD *)(a1 + 40) = 154;
    *(_DWORD *)(a1 + 116) = 0;
  }
  return result;
}

//----- (00446B60) --------------------------------------------------------
void __cdecl NPC156(int a1)
{
  int *v1; // ecx@5
  int v2; // edx@5
  int v3; // [sp+0h] [bp-30h]@3
  int v4; // [sp+4h] [bp-2Ch]@3
  int v5; // [sp+8h] [bp-28h]@3
  int v6; // [sp+Ch] [bp-24h]@3
  int v7; // [sp+10h] [bp-20h]@3
  int v8; // [sp+14h] [bp-1Ch]@3
  int v9; // [sp+18h] [bp-18h]@3
  int v10; // [sp+1Ch] [bp-14h]@3
  int v11; // [sp+20h] [bp-10h]@3
  int v12; // [sp+24h] [bp-Ch]@3
  int v13; // [sp+28h] [bp-8h]@3
  int v14; // [sp+2Ch] [bp-4h]@3

  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
    *(_BYTE *)a1 = 0;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v3 = 96;
  v4 = 112;
  v5 = 112;
  v6 = 128;
  v7 = 112;
  v8 = 112;
  v9 = 128;
  v10 = 128;
  v11 = 128;
  v12 = 112;
  v13 = 144;
  v14 = 128;
  if ( ++*(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( ++*(_DWORD *)(a1 + 108) > 300 )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
    *(_BYTE *)a1 = 0;
  }
}

//----- (00446CA0) --------------------------------------------------------
signed int __cdecl NPC157(int a1)
{
  int v1; // ST10_4@17
  int v2; // ST0C_4@17
  int v3; // ST08_4@17
  int v4; // eax@17
  int v5; // ST10_4@34
  int v6; // ST0C_4@34
  int v7; // ST08_4@34
  int v8; // eax@34
  int v9; // ecx@44
  signed int result; // eax@44
  signed int i; // [sp+4h] [bp-14h]@15
  signed int ia; // [sp+4h] [bp-14h]@32

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) += 4096;
      *(_DWORD *)(a1 + 12) += 4096;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 116) = 20;
      else
        *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_WORD *)(a1 + 80) |= 0x40u;
      break;
    case 0xA:
      *(_WORD *)(a1 + 80) &= 0xFF7Fu;
      *(_DWORD *)(a1 + 164) = 0;
      if ( Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 12800
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 204800
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 12800
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 12800 )
      {
        *(_DWORD *)(a1 + 116) = 11;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xB:
      if ( ++*(_DWORD *)(a1 + 120) % 10 == 6 )
        Play_Sound_Effect(Sfx_Block_Move, 1);
      if ( *(_DWORD *)(a1 + 4) & 2 )
      {
        *(_DWORD *)(a1 + 20) = 0;
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 116) = 20;
        Set_Quake(10);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = *(_DWORD *)(a1 + 12) - 0x2000;
          v4 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
      }
      else
      {
        if ( Quote.Collision_Flags & 2 )
        {
          *(_WORD *)(a1 + 80) |= 0x80u;
          *(_DWORD *)(a1 + 164) = 100;
        }
        else
        {
          *(_WORD *)(a1 + 80) &= 0xFF7Fu;
          *(_DWORD *)(a1 + 164) = 0;
        }
        *(_DWORD *)(a1 + 20) -= 32;
      }
      break;
    case 0x14:
      *(_WORD *)(a1 + 80) &= 0xFF7Fu;
      *(_DWORD *)(a1 + 164) = 0;
      if ( Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 12800
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 204800
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 12800
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 12800 )
      {
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x15:
      if ( ++*(_DWORD *)(a1 + 120) % 10 == 6 )
        Play_Sound_Effect(Sfx_Block_Move, 1);
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 20) = 0;
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 116) = 10;
        Set_Quake(10);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        for ( ia = 0; ia < 4; ++ia )
        {
          v5 = Random(-1536, 0);
          v6 = Random(-341, 341);
          v7 = *(_DWORD *)(a1 + 12) + 0x2000;
          v8 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v8 << 9), v7, v6, v5, 0, NULL, 256);
        }
      }
      else
      {
        if ( Quote.Collision_Flags & 8 )
        {
          *(_WORD *)(a1 + 80) |= 0x80u;
          *(_DWORD *)(a1 + 164) = 100;
        }
        else
        {
          *(_WORD *)(a1 + 80) &= 0xFF7Fu;
          *(_DWORD *)(a1 + 164) = 0;
        }
        *(_DWORD *)(a1 + 20) += 32;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 20) > 512 )
    *(_DWORD *)(a1 + 20) = 512;
  if ( *(_DWORD *)(a1 + 20) < -512 )
    *(_DWORD *)(a1 + 20) = -512;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v9 = a1 + 84;
  *(_DWORD *)v9 = 16;
  *(_DWORD *)(v9 + 4) = 0;
  *(_DWORD *)(v9 + 8) = 48;
  result = 32;
  *(_DWORD *)(v9 + 12) = 32;
  return result;
}

//----- (00447180) --------------------------------------------------------
int __cdecl NPC158(int a1)
{
  int *v1; // eax@25
  int v2; // ecx@25
  int result; // eax@25
  int v4; // [sp+4h] [bp-88h]@1
  int v5; // [sp+8h] [bp-84h]@9
  int v6; // [sp+Ch] [bp-80h]@1
  int v7; // [sp+10h] [bp-7Ch]@1
  int v8; // [sp+14h] [bp-78h]@1
  int v9; // [sp+18h] [bp-74h]@1
  int v10; // [sp+1Ch] [bp-70h]@1
  int v11; // [sp+20h] [bp-6Ch]@1
  int v12; // [sp+24h] [bp-68h]@1
  int v13; // [sp+28h] [bp-64h]@1
  int v14; // [sp+2Ch] [bp-60h]@1
  int v15; // [sp+30h] [bp-5Ch]@1
  int v16; // [sp+34h] [bp-58h]@1
  int v17; // [sp+38h] [bp-54h]@1
  int v18; // [sp+3Ch] [bp-50h]@1
  int v19; // [sp+40h] [bp-4Ch]@1
  int v20; // [sp+44h] [bp-48h]@1
  int v21; // [sp+48h] [bp-44h]@1
  int v22; // [sp+4Ch] [bp-40h]@1
  int v23; // [sp+50h] [bp-3Ch]@1
  int v24; // [sp+54h] [bp-38h]@1
  int v25; // [sp+58h] [bp-34h]@1
  int v26; // [sp+5Ch] [bp-30h]@1
  int v27; // [sp+60h] [bp-2Ch]@1
  int v28; // [sp+64h] [bp-28h]@1
  int v29; // [sp+68h] [bp-24h]@1
  int v30; // [sp+6Ch] [bp-20h]@1
  int v31; // [sp+70h] [bp-1Ch]@1
  int v32; // [sp+74h] [bp-18h]@1
  int v33; // [sp+78h] [bp-14h]@1
  int v34; // [sp+7Ch] [bp-10h]@1
  int v35; // [sp+80h] [bp-Ch]@1
  int v36; // [sp+84h] [bp-8h]@1
  int v37; // [sp+88h] [bp-4h]@1

  v6 = 0;
  v7 = 224;
  v8 = 16;
  v9 = 240;
  v10 = 16;
  v11 = 224;
  v12 = 32;
  v13 = 240;
  v14 = 32;
  v15 = 224;
  v16 = 48;
  v17 = 240;
  v18 = 48;
  v19 = 224;
  v20 = 64;
  v21 = 240;
  v22 = 64;
  v23 = 224;
  v24 = 80;
  v25 = 240;
  v26 = 80;
  v27 = 224;
  v28 = 96;
  v29 = 240;
  v30 = 96;
  v31 = 224;
  v32 = 112;
  v33 = 240;
  v34 = 112;
  v35 = 224;
  v36 = 128;
  v37 = 240;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_21;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        *(_DWORD *)(a1 + 108) = 160;
        break;
      case 1:
        *(_DWORD *)(a1 + 108) = 224;
        break;
      case 2:
        *(_DWORD *)(a1 + 108) = 32;
        break;
      case 3:
        *(_DWORD *)(a1 + 108) = 96;
        break;
      default:
        break;
    }
  }
  *(_DWORD *)(a1 + 16) = 2 * GetCos(*(_BYTE *)(a1 + 108));
  *(_DWORD *)(a1 + 20) = 2 * GetSin(*(_BYTE *)(a1 + 108));
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v5 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
  if ( v5 >= *(_DWORD *)(a1 + 108) )
  {
    if ( v5 - *(_DWORD *)(a1 + 108) >= 128 )
      --*(_DWORD *)(a1 + 108);
    else
      ++*(_DWORD *)(a1 + 108);
  }
  else if ( *(_DWORD *)(a1 + 108) - v5 >= 128 )
  {
    ++*(_DWORD *)(a1 + 108);
  }
  else
  {
    --*(_DWORD *)(a1 + 108);
  }
  if ( *(_DWORD *)(a1 + 108) > 255 )
    *(_DWORD *)(a1 + 108) -= 256;
  if ( *(_DWORD *)(a1 + 108) < 0 )
    *(_DWORD *)(a1 + 108) += 256;
LABEL_21:
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 7, 4);
  }
  *(_DWORD *)(a1 + 104) = (*(_DWORD *)(a1 + 108) + 16) / 32;
  if ( *(_DWORD *)(a1 + 104) > 7 )
    *(_DWORD *)(a1 + 104) = 7;
  v1 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (004474C0) --------------------------------------------------------
void __cdecl NPC159(int a1)
{
  int v1; // ST10_4@7
  int v2; // ST0C_4@7
  int v3; // ST08_4@7
  int v4; // eax@7
  int v5; // edx@16
  int v6; // ST10_4@17
  int v7; // ST0C_4@17
  int v8; // ST08_4@17
  int v9; // eax@17
  int v10; // [sp+0h] [bp-18h]@1
  signed int i; // [sp+4h] [bp-14h]@5

  v10 = *(_DWORD *)(a1 + 116);
  if ( v10 )
  {
    if ( v10 != 1 )
    {
      if ( v10 == 2 )
      {
        ++*(_DWORD *)(a1 + 120);
        *(_DWORD *)(a1 + 20) += 64;
        if ( *(_DWORD *)(a1 + 12) > 327680 )
          *(_BYTE *)a1 = 0;
      }
      goto LABEL_16;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    for ( i = 0; i < 8; ++i )
    {
      v1 = Random(-341, 341);
      v2 = Random(-341, 341);
      v3 = *(_DWORD *)(a1 + 12) + (Random(-16, 16) << 9);
      v4 = Random(-16, 16);
      NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
    }
  }
  if ( ++*(_DWORD *)(a1 + 120) > 50 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 16) = -256;
  }
  if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
    *(_DWORD *)(a1 + 8) += 512;
  else
    *(_DWORD *)(a1 + 8) -= 512;
LABEL_16:
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v5 = a1 + 84;
  *(_DWORD *)v5 = 144;
  *(_DWORD *)(v5 + 4) = 128;
  *(_DWORD *)(v5 + 8) = 192;
  *(_DWORD *)(v5 + 12) = 200;
  if ( *(_DWORD *)(a1 + 120) % 8 == 1 )
  {
    v6 = Random(-341, 341);
    v7 = Random(-341, 341);
    v8 = *(_DWORD *)(a1 + 12) + (Random(-16, 16) << 9);
    v9 = Random(-16, 16);
    NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v9 << 9), v8, v7, v6, 0, NULL, 256);
  }
}

//----- (00447700) --------------------------------------------------------
int __cdecl NPC160(int a1)
{
  int v1; // ST10_4@13
  int v2; // ST0C_4@13
  int v3; // ST08_4@13
  int v4; // eax@13
  int v5; // ST10_4@24
  int v6; // ST0C_4@24
  int v7; // ST08_4@24
  int v8; // eax@24
  int *v9; // edx@40
  int result; // eax@40
  int *v11; // edx@41
  int v12; // [sp+8h] [bp-88h]@39
  int v13; // [sp+Ch] [bp-84h]@39
  int v14; // [sp+10h] [bp-80h]@39
  int v15; // [sp+14h] [bp-7Ch]@39
  int v16; // [sp+18h] [bp-78h]@39
  int v17; // [sp+1Ch] [bp-74h]@39
  int v18; // [sp+20h] [bp-70h]@39
  int v19; // [sp+24h] [bp-6Ch]@39
  int v20; // [sp+28h] [bp-68h]@39
  int v21; // [sp+2Ch] [bp-64h]@39
  int v22; // [sp+30h] [bp-60h]@39
  int v23; // [sp+34h] [bp-5Ch]@39
  int v24; // [sp+38h] [bp-58h]@39
  int v25; // [sp+3Ch] [bp-54h]@39
  int v26; // [sp+40h] [bp-50h]@39
  int v27; // [sp+44h] [bp-4Ch]@39
  int v28; // [sp+48h] [bp-48h]@39
  int v29; // [sp+4Ch] [bp-44h]@39
  int v30; // [sp+50h] [bp-40h]@39
  int v31; // [sp+54h] [bp-3Ch]@39
  int v32; // [sp+58h] [bp-38h]@39
  int v33; // [sp+5Ch] [bp-34h]@39
  int v34; // [sp+60h] [bp-30h]@39
  int v35; // [sp+64h] [bp-2Ch]@39
  int v36; // [sp+68h] [bp-28h]@39
  int v37; // [sp+6Ch] [bp-24h]@39
  int v38; // [sp+70h] [bp-20h]@39
  int v39; // [sp+74h] [bp-1Ch]@39
  int v40; // [sp+78h] [bp-18h]@39
  int v41; // [sp+7Ch] [bp-14h]@39
  int v42; // [sp+80h] [bp-10h]@39
  int v43; // [sp+84h] [bp-Ch]@39
  int i; // [sp+8Ch] [bp-4h]@11

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_WORD *)(a1 + 80) &= 0xFFFEu;
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      *(_DWORD *)(a1 + 20) = 2560;
      if ( *(_DWORD *)(a1 + 12) >= 0x10000 )
      {
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
        *(_DWORD *)(a1 + 116) = 2;
      }
      else
      {
        ++*(_DWORD *)(a1 + 108);
      }
      break;
    case 2:
      *(_DWORD *)(a1 + 20) = 2560;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        Kill_NPC(161, 1);
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = *(_DWORD *)(a1 + 12) + (Random(-12, 12) << 9);
          v4 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 120) = 0;
        Set_Quake(30);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Play_Sound_Effect(Sfx_Explosion, 1);
      }
      if ( *(_DWORD *)(a1 + 12) < Quote.Y_Pos && Quote.Collision_Flags & 8 )
        *(_DWORD *)(a1 + 164) = 20;
      else
        *(_DWORD *)(a1 + 164) = 0;
      break;
    case 3:
      *(_DWORD *)(a1 + 164) = 20;
      *(_DWORD *)(a1 + 164) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 24 )
      {
        *(_DWORD *)(a1 + 116) = 4;
        *(_DWORD *)(a1 + 108) = 0;
        *(_DWORD *)(a1 + 112) = 0;
      }
      break;
    case 4:
      Super_Y_Pos = *(_DWORD *)(a1 + 8);
      Curly_Shoot_Y = *(_DWORD *)(a1 + 12);
      if ( *(_BYTE *)(a1 + 156) % 2 == 1 )
      {
        v5 = Random(-1536, 1536);
        v6 = Random(-1536, 1536);
        v7 = *(_DWORD *)(a1 + 12) + (Random(-12, 12) << 9);
        v8 = Random(-12, 12);
        NPC_Create((NPC_Names)161, *(_DWORD *)(a1 + 8) + (v8 << 9), v7, v6, v5, 0, NULL, 256);
        if ( ++*(_DWORD *)(a1 + 108) > 30 )
        {
          *(_DWORD *)(a1 + 108) = 0;
          *(_DWORD *)(a1 + 116) = 5;
          *(_DWORD *)(a1 + 20) = -3072;
          *(_WORD *)(a1 + 80) |= 8u;
        }
      }
      break;
    case 5:
      Super_Y_Pos = *(_DWORD *)(a1 + 8);
      Curly_Shoot_Y = *(_DWORD *)(a1 + 12);
      if ( ++*(_DWORD *)(a1 + 108) > 60 )
      {
        *(_DWORD *)(a1 + 108) = 0;
        *(_DWORD *)(a1 + 116) = 6;
      }
      break;
    case 6:
      Super_Y_Pos = Quote.X_Pos;
      Curly_Shoot_Y = 3276800;
      if ( ++*(_DWORD *)(a1 + 108) > 110 )
      {
        *(_DWORD *)(a1 + 108) = 10;
        *(_DWORD *)(a1 + 8) = Quote.X_Pos;
        *(_DWORD *)(a1 + 12) = 0;
        *(_DWORD *)(a1 + 20) = 1535;
        *(_DWORD *)(a1 + 116) = 1;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
    case 1:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    case 2:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    case 3:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    case 4:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 5:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    case 6:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    default:
      break;
  }
  v28 = 0;
  v29 = 0;
  v30 = 40;
  v31 = 24;
  v32 = 40;
  v33 = 0;
  v34 = 80;
  v35 = 24;
  v36 = 80;
  v37 = 0;
  v38 = 120;
  v39 = 24;
  v40 = 120;
  v41 = 0;
  v42 = 160;
  v43 = 24;
  v12 = 0;
  v13 = 24;
  v14 = 40;
  v15 = 48;
  v16 = 40;
  v17 = 24;
  v18 = 80;
  v19 = 48;
  v20 = 80;
  v21 = 24;
  v22 = 120;
  v23 = 48;
  v24 = 120;
  v25 = 24;
  v26 = 160;
  v27 = 48;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v11 = &v12 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v11;
    *(_DWORD *)(result + 4) = v11[1];
    *(_DWORD *)(result + 8) = v11[2];
    *(_DWORD *)(result + 12) = v11[3];
  }
  else
  {
    v9 = &v28 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v9;
    *(_DWORD *)(result + 4) = v9[1];
    *(_DWORD *)(result + 8) = v9[2];
    *(_DWORD *)(result + 12) = v9[3];
  }
  return result;
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (00447CB0) --------------------------------------------------------
int __cdecl NPC161(int a1)
{
  int *v1; // edx@21
  int result; // eax@21
  int v3; // [sp+0h] [bp-30h]@21
  int v4; // [sp+4h] [bp-2Ch]@21
  int v5; // [sp+8h] [bp-28h]@21
  int v6; // [sp+Ch] [bp-24h]@21
  int v7; // [sp+10h] [bp-20h]@21
  int v8; // [sp+14h] [bp-1Ch]@21
  int v9; // [sp+18h] [bp-18h]@21
  int v10; // [sp+1Ch] [bp-14h]@21
  int v11; // [sp+20h] [bp-10h]@21
  int v12; // [sp+24h] [bp-Ch]@21
  int v13; // [sp+28h] [bp-8h]@21
  int v14; // [sp+2Ch] [bp-4h]@21

  *(_DWORD *)(a1 + 68) = 0;
  if ( *(_DWORD *)(a1 + 8) >= Super_Y_Pos )
    *(_DWORD *)(a1 + 16) -= 64;
  else
    *(_DWORD *)(a1 + 16) += 64;
  if ( *(_DWORD *)(a1 + 12) >= Curly_Shoot_Y )
    *(_DWORD *)(a1 + 20) -= 64;
  else
    *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 16) < -4605 )
    *(_DWORD *)(a1 + 16) = -4605;
  if ( *(_DWORD *)(a1 + 16) > 4605 )
    *(_DWORD *)(a1 + 16) = 4605;
  if ( *(_DWORD *)(a1 + 20) < -4605 )
    *(_DWORD *)(a1 + 20) = -4605;
  if ( *(_DWORD *)(a1 + 20) > 4605 )
    *(_DWORD *)(a1 + 20) = 4605;
  if ( *(_DWORD *)(a1 + 64) < 100 )
  {
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_WORD *)(a1 + 80) &= 0xFFFBu;
    *(_DWORD *)(a1 + 164) = 0;
    *(_DWORD *)(a1 + 104) = 2;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 104) < 2 )
    *(_DWORD *)(a1 + 104) = Random(0, 10) != 2;
  v3 = 0;
  v4 = 48;
  v5 = 16;
  v6 = 64;
  v7 = 16;
  v8 = 48;
  v9 = 32;
  v10 = 64;
  v11 = 32;
  v12 = 48;
  v13 = 48;
  v14 = 64;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (00447E90) --------------------------------------------------------
int __cdecl NPC162(int a1)
{
  int v1; // ST10_4@4
  int v2; // ST0C_4@4
  int v3; // ST08_4@4
  int v4; // eax@4
  int v5; // edx@9
  int v6; // edx@10
  int v7; // ST08_4@13
  int v8; // eax@13
  int v9; // edx@19
  int v10; // edx@20
  int v11; // ecx@22
  int v12; // ST0C_4@24
  int v13; // ST08_4@24
  int v14; // eax@24
  int result; // eax@30
  signed int i; // [sp+34h] [bp-4h]@2

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      Kill_NPC(161, 1);
      Play_Sound_Effect(Sfx_Explosion, 1);
      for ( i = 0; i < 10; ++i )
      {
        v1 = Random(-1536, 1536);
        v2 = Random(-1536, 1536);
        v3 = *(_DWORD *)(a1 + 12) + (Random(-12, 12) << 9);
        v4 = Random(-12, 12);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( *(_DWORD *)(a1 + 76) )
      {
        v6 = a1 + 84;
        *(_DWORD *)v6 = 40;
        *(_DWORD *)(v6 + 4) = 24;
        *(_DWORD *)(v6 + 8) = 80;
        *(_DWORD *)(v6 + 12) = 48;
      }
      else
      {
        v5 = a1 + 84;
        *(_DWORD *)v5 = 40;
        *(_DWORD *)(v5 + 4) = 0;
        *(_DWORD *)(v5 + 8) = 80;
        *(_DWORD *)(v5 + 12) = 24;
      }
      *(_DWORD *)(a1 + 108) = 0;
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_12;
    case 1:
LABEL_12:
      if ( !(++*(_DWORD *)(a1 + 108) % 4) )
      {
        v7 = *(_DWORD *)(a1 + 12) + (Random(-12, 12) << 9);
        v8 = Random(-12, 12);
        NPC_Create((NPC_Names)161, *(_DWORD *)(a1 + 8) + (v8 << 9), v7, 0, 0, 0, NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 108) > 160 )
      {
        *(_DWORD *)(a1 + 108) = 0;
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      }
      break;
    case 2:
      Set_Quake(2);
      if ( ++*(_DWORD *)(a1 + 108) > 240 )
      {
        v11 = a1 + 84;
        *(_DWORD *)v11 = 0;
        *(_DWORD *)(v11 + 4) = 0;
        *(_DWORD *)(v11 + 8) = 0;
        *(_DWORD *)(v11 + 12) = 0;
        *(_DWORD *)(a1 + 108) = 0;
        *(_DWORD *)(a1 + 116) = 3;
      }
      else
      {
        if ( *(_DWORD *)(a1 + 76) )
        {
          v10 = a1 + 84;
          *(_DWORD *)v10 = 40;
          *(_DWORD *)(v10 + 4) = 24;
          *(_DWORD *)(v10 + 8) = 80;
          *(_DWORD *)(v10 + 12) = 48;
        }
        else
        {
          v9 = a1 + 84;
          *(_DWORD *)v9 = 40;
          *(_DWORD *)(v9 + 4) = 0;
          *(_DWORD *)(v9 + 8) = 80;
          *(_DWORD *)(v9 + 12) = 24;
        }
        *(_DWORD *)(a1 + 88) += *(_DWORD *)(a1 + 108) / 8;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36) + (*(_DWORD *)(a1 + 108) / 8 << 9);
        *(_DWORD *)(a1 + 84) -= *(_DWORD *)(a1 + 108) / 2 % 2;
      }
      if ( *(_DWORD *)(a1 + 108) % 3 == 2 )
      {
        v12 = Random(-512, 512);
        v13 = *(_DWORD *)(a1 + 12) - 6144;
        v14 = Random(-12, 12);
        NPC_Create((NPC_Names)161, *(_DWORD *)(a1 + 8) + (v14 << 9), v13, v12, 256, 0, NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 108) % 4 == 2 )
        Play_Sound_Effect(Sfx_Bubble, 1);
      break;
    case 3:
      if ( ++*(_DWORD *)(a1 + 108) >= 60 )
      {
        Kill_NPC(161, 1);
        *(_BYTE *)a1 = 0;
      }
      break;
    default:
      break;
  }
  result = a1;
  Super_Y_Pos = *(_DWORD *)(a1 + 8);
  Curly_Shoot_Y = -512000;
  return result;
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (004482A0) --------------------------------------------------------
int __cdecl NPC163(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int *v3; // edx@13
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 192;
  v14 = 0;
  v15 = 208;
  v16 = 16;
  v17 = 208;
  v18 = 0;
  v19 = 224;
  v20 = 16;
  v5 = 192;
  v6 = 16;
  v7 = 208;
  v8 = 32;
  v9 = 208;
  v10 = 16;
  v11 = 224;
  v12 = 32;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00448410) --------------------------------------------------------
int __cdecl NPC164(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int *v3; // edx@13
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 224;
  v14 = 0;
  v15 = 240;
  v16 = 16;
  v17 = 240;
  v18 = 0;
  v19 = 256;
  v20 = 16;
  v5 = 224;
  v6 = 16;
  v7 = 240;
  v8 = 32;
  v9 = 240;
  v10 = 16;
  v11 = 256;
  v12 = 32;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00448580) --------------------------------------------------------
int __cdecl NPC165(int a1)
{
  int result; // eax@13
  int *v2; // edx@14
  int v3; // [sp+0h] [bp-34h]@1
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 192;
  v5 = 96;
  v6 = 208;
  v7 = 112;
  v8 = 208;
  v9 = 96;
  v10 = 224;
  v11 = 112;
  v12 = 144;
  v13 = 96;
  v14 = 160;
  v15 = 112;
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
      goto LABEL_12;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) += 5120;
  }
  *(_DWORD *)(a1 + 104) = *(_DWORD *)(a1 + 76) == 2
                       && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 0x4000
                       && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 0x4000
                       && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 0x2000
                       && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x2000;
LABEL_12:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v2 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v2;
    *(_DWORD *)(result + 4) = v2[1];
    *(_DWORD *)(result + 8) = v2[2];
    *(_DWORD *)(result + 12) = v2[3];
  }
  else
  {
    result = a1 + 84;
    *(_DWORD *)result = v12;
    *(_DWORD *)(result + 4) = v13;
    *(_DWORD *)(result + 8) = v14;
    *(_DWORD *)(result + 12) = v15;
  }
  return result;
}

//----- (004486E0) --------------------------------------------------------
int __cdecl NPC166(int a1)
{
  int *v1; // ecx@11
  int v2; // edx@11
  int result; // eax@11
  int v4; // [sp+0h] [bp-24h]@1
  int v5; // [sp+4h] [bp-20h]@1
  int v6; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+Ch] [bp-18h]@1
  int v8; // [sp+10h] [bp-14h]@1
  int v9; // [sp+14h] [bp-10h]@1
  int v10; // [sp+18h] [bp-Ch]@1
  int v11; // [sp+1Ch] [bp-8h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v5 = 144;
  v6 = 104;
  v7 = 184;
  v8 = 128;
  v9 = 184;
  v10 = 104;
  v11 = 224;
  v12 = 128;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (004487F0) --------------------------------------------------------
int __cdecl NPC167(int a1)
{
  int v1; // ST10_4@12
  int v2; // ST0C_4@12
  int v3; // ST08_4@12
  int v4; // eax@12
  int *v5; // edx@14
  int result; // eax@14
  signed int i; // [sp+4h] [bp-34h]@10
  int v8; // [sp+8h] [bp-30h]@1
  int v9; // [sp+Ch] [bp-2Ch]@1
  int v10; // [sp+10h] [bp-28h]@1
  int v11; // [sp+14h] [bp-24h]@1
  int v12; // [sp+18h] [bp-20h]@1
  int v13; // [sp+1Ch] [bp-1Ch]@1
  int v14; // [sp+20h] [bp-18h]@1
  int v15; // [sp+24h] [bp-14h]@1
  int v16; // [sp+28h] [bp-10h]@1
  int v17; // [sp+2Ch] [bp-Ch]@1
  int v18; // [sp+30h] [bp-8h]@1
  int v19; // [sp+34h] [bp-4h]@1

  v8 = 304;
  v9 = 0;
  v10 = 320;
  v11 = 16;
  v12 = 304;
  v13 = 16;
  v14 = 320;
  v15 = 32;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 1;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 20) += 64;
      if ( *(_DWORD *)(a1 + 20) > 1535 )
        *(_DWORD *)(a1 + 20) = 1535;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_7;
    case 0x15:
LABEL_7:
      if ( ++*(_DWORD *)(a1 + 104) > 2 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( ++*(_DWORD *)(a1 + 120) > 100 )
      {
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = *(_DWORD *)(a1 + 12) + (Random(-12, 12) << 9);
          v4 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
        *(_BYTE *)a1 = 0;
      }
      break;
    default:
      break;
  }
  v5 = &v8 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v5;
  *(_DWORD *)(result + 4) = v5[1];
  *(_DWORD *)(result + 8) = v5[2];
  *(_DWORD *)(result + 12) = v5[3];
  return result;
}

//----- (00448A10) --------------------------------------------------------
signed int __cdecl NPC168(int a1)
{
  int v1; // ecx@13
  signed int result; // eax@13

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      goto LABEL_4;
    case 0xB:
LABEL_4:
      ++*(_DWORD *)(a1 + 120);
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
      if ( *(_DWORD *)(a1 + 120) / 3 % 2 )
        *(_DWORD *)(a1 + 8) += 512;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 20) = -1024;
      *(_DWORD *)(a1 + 16) = 256;
      Play_Sound_Effect(Sfx_Silly_Explosion, 1);
      goto LABEL_8;
    case 0x15:
LABEL_8:
      *(_DWORD *)(a1 + 20) += 16;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 120) && *(_DWORD *)(a1 + 4) & 8 )
      {
        Play_Sound_Effect(Sfx_large_Explosion, 1);
        Set_Quake(40);
        *(_DWORD *)(a1 + 116) = 0;
      }
      if ( !*(_DWORD *)(a1 + 120) )
        ++*(_DWORD *)(a1 + 120);
      break;
    default:
      break;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 264;
  *(_DWORD *)(v1 + 4) = 56;
  *(_DWORD *)(v1 + 8) = 320;
  result = 96;
  *(_DWORD *)(v1 + 12) = 96;
  return result;
}

//----- (00448BE0) --------------------------------------------------------
int __cdecl NPC169(int a1)
{
  int *v1; // eax@74
  int v2; // ecx@74
  int result; // eax@74
  int *v4; // eax@75
  int v5; // ecx@75
  int v6; // [sp+4h] [bp-120h]@73
  int v7; // [sp+8h] [bp-11Ch]@73
  int v8; // [sp+Ch] [bp-118h]@73
  int v9; // [sp+10h] [bp-114h]@73
  int v10; // [sp+14h] [bp-110h]@73
  int v11; // [sp+18h] [bp-10Ch]@73
  int v12; // [sp+1Ch] [bp-108h]@73
  int v13; // [sp+20h] [bp-104h]@73
  int v14; // [sp+24h] [bp-100h]@73
  int v15; // [sp+28h] [bp-FCh]@73
  int v16; // [sp+2Ch] [bp-F8h]@73
  int v17; // [sp+30h] [bp-F4h]@73
  int v18; // [sp+34h] [bp-F0h]@73
  int v19; // [sp+38h] [bp-ECh]@73
  int v20; // [sp+3Ch] [bp-E8h]@73
  int v21; // [sp+40h] [bp-E4h]@73
  int v22; // [sp+44h] [bp-E0h]@73
  int v23; // [sp+48h] [bp-DCh]@73
  int v24; // [sp+4Ch] [bp-D8h]@73
  int v25; // [sp+50h] [bp-D4h]@73
  int v26; // [sp+54h] [bp-D0h]@73
  int v27; // [sp+58h] [bp-CCh]@73
  int v28; // [sp+5Ch] [bp-C8h]@73
  int v29; // [sp+60h] [bp-C4h]@73
  int v30; // [sp+64h] [bp-C0h]@73
  int v31; // [sp+68h] [bp-BCh]@73
  int v32; // [sp+6Ch] [bp-B8h]@73
  int v33; // [sp+70h] [bp-B4h]@73
  int v34; // [sp+74h] [bp-B0h]@73
  int v35; // [sp+78h] [bp-ACh]@73
  int v36; // [sp+7Ch] [bp-A8h]@73
  int v37; // [sp+80h] [bp-A4h]@73
  int v38; // [sp+84h] [bp-A0h]@73
  int v39; // [sp+88h] [bp-9Ch]@73
  int v40; // [sp+8Ch] [bp-98h]@73
  int v41; // [sp+90h] [bp-94h]@73
  int v42; // [sp+94h] [bp-90h]@73
  int v43; // [sp+98h] [bp-8Ch]@73
  int v44; // [sp+9Ch] [bp-88h]@73
  int v45; // [sp+A0h] [bp-84h]@73
  int v46; // [sp+A4h] [bp-80h]@73
  int v47; // [sp+A8h] [bp-7Ch]@73
  int v48; // [sp+ACh] [bp-78h]@73
  int v49; // [sp+B0h] [bp-74h]@73
  int v50; // [sp+B4h] [bp-70h]@73
  int v51; // [sp+B8h] [bp-6Ch]@73
  int v52; // [sp+BCh] [bp-68h]@73
  int v53; // [sp+C0h] [bp-64h]@73
  int v54; // [sp+C4h] [bp-60h]@73
  int v55; // [sp+C8h] [bp-5Ch]@73
  int v56; // [sp+CCh] [bp-58h]@73
  int v57; // [sp+D0h] [bp-54h]@73
  int v58; // [sp+D4h] [bp-50h]@73
  int v59; // [sp+D8h] [bp-4Ch]@73
  int v60; // [sp+DCh] [bp-48h]@73
  int v61; // [sp+E0h] [bp-44h]@73
  int v62; // [sp+E4h] [bp-40h]@73
  int v63; // [sp+E8h] [bp-3Ch]@73
  int v64; // [sp+ECh] [bp-38h]@73
  int v65; // [sp+F0h] [bp-34h]@73
  int v66; // [sp+F4h] [bp-30h]@73
  int v67; // [sp+F8h] [bp-2Ch]@73
  int v68; // [sp+FCh] [bp-28h]@73
  int v69; // [sp+100h] [bp-24h]@73
  int v70; // [sp+104h] [bp-20h]@73
  int v71; // [sp+108h] [bp-1Ch]@73
  int v72; // [sp+10Ch] [bp-18h]@73
  int v73; // [sp+110h] [bp-14h]@73
  int v74; // [sp+114h] [bp-10h]@73
  int v75; // [sp+118h] [bp-Ch]@73
  int v76; // [sp+11Ch] [bp-8h]@73
  int v77; // [sp+120h] [bp-4h]@73

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 120) = 30;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_5;
    case 1:
LABEL_5:
      if ( !--*(_DWORD *)(a1 + 120) )
      {
        *(_DWORD *)(a1 + 116) = 2;
        ++*(_DWORD *)(a1 + 108);
      }
      break;
    case 2:
      *(_DWORD *)(a1 + 116) = 3;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_8;
    case 3:
LABEL_8:
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        if ( ++*(_DWORD *)(a1 + 104) == 2 || *(_DWORD *)(a1 + 104) == 4 )
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) += 32;
      else
        *(_DWORD *)(a1 + 16) -= 32;
      if ( *(_DWORD *)(a1 + 120) < 8
        || *(_DWORD *)(a1 + 8) - 6144 >= Quote.X_Pos
        || *(_DWORD *)(a1 + 8) + 6144 <= Quote.X_Pos
        || *(_DWORD *)(a1 + 12) - 6144 >= Quote.Y_Pos
        || *(_DWORD *)(a1 + 12) + 4096 <= Quote.Y_Pos )
      {
        if ( ++*(_DWORD *)(a1 + 120) <= 75 )
        {
          if ( *(_DWORD *)(a1 + 4) & 5 )
          {
            if ( *(_DWORD *)(a1 + 112) >= 5 )
            {
              *(_DWORD *)(a1 + 116) = 4;
              *(_DWORD *)(a1 + 120) = 0;
              *(_DWORD *)(a1 + 104) = 7;
              *(_DWORD *)(a1 + 20) = -1535;
            }
            else
            {
              ++*(_DWORD *)(a1 + 112);
            }
          }
          else
          {
            *(_DWORD *)(a1 + 112) = 0;
          }
          if ( !(*(_DWORD *)(a1 + 108) % 2) && *(_DWORD *)(a1 + 120) > 25 )
          {
            *(_DWORD *)(a1 + 116) = 4;
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 104) = 7;
            *(_DWORD *)(a1 + 20) = -1535;
          }
        }
        else
        {
          *(_DWORD *)(a1 + 116) = 9;
          *(_DWORD *)(a1 + 104) = 0;
        }
      }
      else
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 5;
        Quote.Flags |= 2u;
        Damage_Player(5);
      }
      break;
    case 4:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( ++*(_DWORD *)(a1 + 120) < 30 && *(_DWORD *)(a1 + 120) % 6 == 1 )
      {
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        NPC_Create((NPC_Names)170, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, *(Directions *)(a1 + 76), NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 9;
        *(_DWORD *)(a1 + 104) = 8;
        Set_Quake(30);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      }
      if ( *(_DWORD *)(a1 + 120) >= 8
        && *(_DWORD *)(a1 + 8) - 6144 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 6144 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 6144 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 4096 > Quote.Y_Pos )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 5;
        Quote.Flags |= 2u;
        Damage_Player(10);
      }
      break;
    case 9:
      *(_DWORD *)(a1 + 16) = 4 * *(_DWORD *)(a1 + 16) / 5;
      if ( !*(_DWORD *)(a1 + 16) )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    case 0xA:
      Quote.X_Pos = *(_DWORD *)(a1 + 8);
      Quote.Y_Pos = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 16) = 4 * *(_DWORD *)(a1 + 16) / 5;
      if ( !*(_DWORD *)(a1 + 16) )
      {
        *(_DWORD *)(a1 + 116) = 11;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 5;
        *(_DWORD *)(a1 + 100) = 0;
      }
      break;
    case 0xB:
      Quote.X_Pos = *(_DWORD *)(a1 + 8);
      Quote.Y_Pos = *(_DWORD *)(a1 + 12);
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 5;
      if ( ++*(_DWORD *)(a1 + 120) > 100 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    case 0x14:
      Play_Sound_Effect(Sfx_Silly_Explosion, 1);
      Quote.Flags &= 0xFDu;
      if ( *(_DWORD *)(a1 + 76) )
      {
        Quote.X_Pos -= 2048;
        Quote.Y_Pos -= 4096;
        Quote.X_Vel = -1535;
        Quote.Y_Vel = -512;
        Quote.Direction = 0;
        *(_DWORD *)(a1 + 76) = 0;
      }
      else
      {
        Quote.X_Pos += 2048;
        Quote.Y_Pos -= 4096;
        Quote.X_Vel = 1535;
        Quote.Y_Vel = -512;
        Quote.Direction = 2;
        *(_DWORD *)(a1 + 76) = 2;
      }
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 7;
      goto LABEL_65;
    case 0x15:
LABEL_65:
      if ( ++*(_DWORD *)(a1 + 120) >= 50 )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 16) < -768 )
    *(_DWORD *)(a1 + 16) = -768;
  if ( *(_DWORD *)(a1 + 16) > 768 )
    *(_DWORD *)(a1 + 16) = 768;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v42 = 0;
  v43 = 0;
  v44 = 40;
  v45 = 24;
  v46 = 0;
  v47 = 48;
  v48 = 40;
  v49 = 72;
  v50 = 0;
  v51 = 0;
  v52 = 40;
  v53 = 24;
  v54 = 40;
  v55 = 48;
  v56 = 80;
  v57 = 72;
  v58 = 0;
  v59 = 0;
  v60 = 40;
  v61 = 24;
  v62 = 80;
  v63 = 48;
  v64 = 120;
  v65 = 72;
  v66 = 120;
  v67 = 48;
  v68 = 160;
  v69 = 72;
  v70 = 120;
  v71 = 0;
  v72 = 160;
  v73 = 24;
  v74 = 80;
  v75 = 0;
  v76 = 120;
  v77 = 24;
  v6 = 0;
  v7 = 24;
  v8 = 40;
  v9 = 48;
  v10 = 0;
  v11 = 72;
  v12 = 40;
  v13 = 96;
  v14 = 0;
  v15 = 24;
  v16 = 40;
  v17 = 48;
  v18 = 40;
  v19 = 72;
  v20 = 80;
  v21 = 96;
  v22 = 0;
  v23 = 24;
  v24 = 40;
  v25 = 48;
  v26 = 80;
  v27 = 72;
  v28 = 120;
  v29 = 96;
  v30 = 120;
  v31 = 72;
  v32 = 160;
  v33 = 96;
  v34 = 120;
  v35 = 24;
  v36 = 160;
  v37 = 48;
  v38 = 80;
  v39 = 24;
  v40 = 120;
  v41 = 48;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v42 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (004495A0) --------------------------------------------------------
void __cdecl NPC170(void *Frame_1_A_4)
{
  int *v1; // eax@35
  char *v2; // ecx@35
  int *v3; // eax@36
  char *v4; // ecx@36
  int v5; // [sp+0h] [bp-48h]@9
  int v6; // [sp+4h] [bp-44h]@1
  int v7; // [sp+8h] [bp-40h]@1
  int v8; // [sp+Ch] [bp-3Ch]@1
  int v9; // [sp+10h] [bp-38h]@1
  int v10; // [sp+14h] [bp-34h]@1
  int v11; // [sp+18h] [bp-30h]@1
  int v12; // [sp+1Ch] [bp-2Ch]@1
  int v13; // [sp+20h] [bp-28h]@1
  int v14; // [sp+24h] [bp-24h]@1
  int v15; // [sp+28h] [bp-20h]@1
  int v16; // [sp+2Ch] [bp-1Ch]@1
  int v17; // [sp+30h] [bp-18h]@1
  int v18; // [sp+34h] [bp-14h]@1
  int v19; // [sp+38h] [bp-10h]@1
  int v20; // [sp+3Ch] [bp-Ch]@1
  int v21; // [sp+40h] [bp-8h]@1
  int v22; // [sp+44h] [bp-4h]@1

  v15 = 112;
  v16 = 96;
  v17 = 128;
  v18 = 104;
  v19 = 128;
  v20 = 96;
  v21 = 144;
  v22 = 104;
  v6 = 112;
  v7 = 104;
  v8 = 128;
  v9 = 112;
  v10 = 128;
  v11 = 104;
  v12 = 144;
  v13 = 112;
  v14 = 0;
  if ( !*((_DWORD *)Frame_1_A_4 + 19) && *((_DWORD *)Frame_1_A_4 + 1) & 1 )
    v14 = 1;
  if ( *((_DWORD *)Frame_1_A_4 + 19) == 2 && *((_DWORD *)Frame_1_A_4 + 1) & 4 )
    v14 = 1;
  if ( v14 )
  {
    Play_Sound_Effect(Sfx_Missile_Impact, 1);
    Create_Dust_Clouds(*((_DWORD *)Frame_1_A_4 + 2), *((_DWORD *)Frame_1_A_4 + 3), 0, 3);
    Vanish_NPC((NPC_vars *)Frame_1_A_4);
    return;
  }
  v5 = *((_DWORD *)Frame_1_A_4 + 29);
  if ( !v5 )
  {
    *((_DWORD *)Frame_1_A_4 + 29) = 1;
    if ( *((_DWORD *)Frame_1_A_4 + 19) )
      *((_DWORD *)Frame_1_A_4 + 4) = Random(-2, -1) << 9;
    else
      *((_DWORD *)Frame_1_A_4 + 4) = Random(1, 2) << 9;
    *((_DWORD *)Frame_1_A_4 + 5) = Random(-2, 0) << 9;
    goto LABEL_16;
  }
  if ( v5 == 1 )
  {
LABEL_16:
    ++*((_DWORD *)Frame_1_A_4 + 27);
    if ( *((_DWORD *)Frame_1_A_4 + 19) )
    {
      *((_DWORD *)Frame_1_A_4 + 4) += 32;
      if ( *((_DWORD *)Frame_1_A_4 + 27) % 3 == 1 )
        Create_Effect(*((_DWORD *)Frame_1_A_4 + 2) - 4096, *((_DWORD *)Frame_1_A_4 + 3), 7, 0);
    }
    else
    {
      *((_DWORD *)Frame_1_A_4 + 4) -= 32;
      if ( *((_DWORD *)Frame_1_A_4 + 27) % 3 == 1 )
        Create_Effect(*((_DWORD *)Frame_1_A_4 + 2) + 4096, *((_DWORD *)Frame_1_A_4 + 3), 7, 2);
    }
    if ( *((_DWORD *)Frame_1_A_4 + 27) >= 50 )
    {
      *((_DWORD *)Frame_1_A_4 + 5) = 0;
    }
    else if ( *((_DWORD *)Frame_1_A_4 + 3) >= Quote.Y_Pos )
    {
      *((_DWORD *)Frame_1_A_4 + 5) -= 32;
    }
    else
    {
      *((_DWORD *)Frame_1_A_4 + 5) += 32;
    }
    if ( ++*((_DWORD *)Frame_1_A_4 + 26) > 1 )
      *((_DWORD *)Frame_1_A_4 + 26) = 0;
  }
  if ( *((_DWORD *)Frame_1_A_4 + 4) < -1024 )
    *((_DWORD *)Frame_1_A_4 + 4) = -1536;
  if ( *((_DWORD *)Frame_1_A_4 + 4) > 1024 )
    *((_DWORD *)Frame_1_A_4 + 4) = 1536;
  *((_DWORD *)Frame_1_A_4 + 2) += *((_DWORD *)Frame_1_A_4 + 4);
  *((_DWORD *)Frame_1_A_4 + 3) += *((_DWORD *)Frame_1_A_4 + 5);
  if ( *((_DWORD *)Frame_1_A_4 + 19) )
  {
    v3 = &v6 + 4 * *((_DWORD *)Frame_1_A_4 + 26);
    v4 = (char *)Frame_1_A_4 + 84;
    *(_DWORD *)v4 = *v3;
    *((_DWORD *)v4 + 1) = v3[1];
    *((_DWORD *)v4 + 2) = v3[2];
    *((_DWORD *)v4 + 3) = v3[3];
  }
  else
  {
    v1 = &v15 + 4 * *((_DWORD *)Frame_1_A_4 + 26);
    v2 = (char *)Frame_1_A_4 + 84;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    *((_DWORD *)v2 + 2) = v1[2];
    *((_DWORD *)v2 + 3) = v1[3];
  }
}

//----- (004498C0) --------------------------------------------------------
int __cdecl NPC171(int a1)
{
  int *v1; // ecx@38
  int v2; // edx@38
  int result; // eax@38
  int *v4; // ecx@39
  int v5; // edx@39
  int v6; // [sp+0h] [bp-44h]@4
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 120;
  v16 = 48;
  v17 = 152;
  v18 = 80;
  v19 = 152;
  v20 = 48;
  v21 = 184;
  v22 = 80;
  v7 = 184;
  v8 = 48;
  v9 = 216;
  v10 = 80;
  v11 = 216;
  v12 = 48;
  v13 = 248;
  v14 = 80;
  if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 != 10 )
        goto LABEL_37;
      goto LABEL_12;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 120) = Random(0, 50);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
  }
  if ( *(_DWORD *)(a1 + 120) )
  {
    --*(_DWORD *)(a1 + 120);
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 10;
    *(_DWORD *)(a1 + 20) = 512;
  }
LABEL_12:
  if ( ++*(_DWORD *)(a1 + 100) > 0 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
    *(_DWORD *)(a1 + 20) -= 16;
  else
    *(_DWORD *)(a1 + 20) += 16;
  if ( *(_DWORD *)(a1 + 20) > 512 )
    *(_DWORD *)(a1 + 20) = 512;
  if ( *(_DWORD *)(a1 + 20) < -512 )
    *(_DWORD *)(a1 + 20) = -512;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    if ( Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 40960
      && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 40960
      && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 81920
      && Quote.X_Pos > *(_DWORD *)(a1 + 8) )
    {
      ++*(_DWORD *)(a1 + 108);
    }
  }
  else if ( Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 40960
         && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 40960
         && Quote.X_Pos < *(_DWORD *)(a1 + 8)
         && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 81920 )
  {
    ++*(_DWORD *)(a1 + 108);
  }
  if ( *(_DWORD *)(a1 + 108) > 20 )
  {
    NPC_Create((NPC_Names)172, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, *(Directions *)(a1 + 76), NULL, 256);
    *(_DWORD *)(a1 + 108) = -100;
    Super_X_Pos = Random(80, 100);
    Curly_Shoot_Wait = *(_DWORD *)(a1 + 8);
    Curly_Shoot_X = *(_DWORD *)(a1 + 12);
  }
LABEL_37:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}
// 4BBA20: using guessed type int Curly_Shoot_Wait;
// 4BBA24: using guessed type int Curly_Shoot_X;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (00449C10) --------------------------------------------------------
void __cdecl NPC172(void *npc)
{
  int *v1; // ecx@15
  char *v2; // edx@15
  int v3; // [sp+0h] [bp-34h]@1
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 248;
  v5 = 48;
  v6 = 264;
  v7 = 80;
  v8 = 264;
  v9 = 48;
  v10 = 280;
  v11 = 80;
  v12 = 280;
  v13 = 48;
  v14 = 296;
  v15 = 80;
  v3 = *((_DWORD *)npc + 29);
  if ( v3 )
  {
    if ( v3 != 1 )
      goto LABEL_15;
  }
  else
  {
    *((_DWORD *)npc + 29) = 1;
  }
  if ( ++*((_DWORD *)npc + 25) > 1 )
  {
    *((_DWORD *)npc + 25) = 0;
    ++*((_DWORD *)npc + 26);
  }
  if ( *((_DWORD *)npc + 26) > 2 )
    *((_DWORD *)npc + 26) = 0;
  if ( *((_DWORD *)npc + 19) )
    *((_DWORD *)npc + 2) += 512;
  else
    *((_DWORD *)npc + 2) -= 512;
  if ( *((_DWORD *)npc + 1) & 1 || *((_DWORD *)npc + 1) & 4 )
  {
    Create_Effect(*((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 2, 0);
    Vanish_NPC((NPC_vars *)npc);
    return;
  }
LABEL_15:
  v1 = &v4 + 4 * *((_DWORD *)npc + 26);
  v2 = (char *)npc + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
}

//----- (00449D70) --------------------------------------------------------
void __cdecl NPC173(int a1)
{
  int Y_Vel; // ST24_4@31
  int *v2; // ecx@48
  int v3; // edx@48
  int *v4; // ecx@49
  int v5; // edx@49
  int v6; // [sp+8h] [bp-90h]@1
  int v7; // [sp+Ch] [bp-8Ch]@1
  int v8; // [sp+10h] [bp-88h]@1
  int v9; // [sp+14h] [bp-84h]@1
  int v10; // [sp+18h] [bp-80h]@1
  int v11; // [sp+1Ch] [bp-7Ch]@1
  int v12; // [sp+20h] [bp-78h]@1
  int v13; // [sp+24h] [bp-74h]@1
  int v14; // [sp+28h] [bp-70h]@1
  int v15; // [sp+2Ch] [bp-6Ch]@1
  int v16; // [sp+30h] [bp-68h]@1
  int v17; // [sp+34h] [bp-64h]@1
  int v18; // [sp+38h] [bp-60h]@1
  int v19; // [sp+3Ch] [bp-5Ch]@1
  int v20; // [sp+40h] [bp-58h]@1
  int v21; // [sp+44h] [bp-54h]@1
  int X_Vel; // [sp+4Ch] [bp-4Ch]@31
  int v23; // [sp+50h] [bp-48h]@1
  int v24; // [sp+54h] [bp-44h]@1
  int v25; // [sp+58h] [bp-40h]@1
  int v26; // [sp+5Ch] [bp-3Ch]@1
  int v27; // [sp+60h] [bp-38h]@1
  int v28; // [sp+64h] [bp-34h]@1
  int v29; // [sp+68h] [bp-30h]@1
  int v30; // [sp+6Ch] [bp-2Ch]@1
  int v31; // [sp+70h] [bp-28h]@1
  int v32; // [sp+74h] [bp-24h]@1
  int v33; // [sp+78h] [bp-20h]@1
  int v34; // [sp+7Ch] [bp-1Ch]@1
  int v35; // [sp+80h] [bp-18h]@1
  int v36; // [sp+84h] [bp-14h]@1
  int v37; // [sp+88h] [bp-10h]@1
  int v38; // [sp+8Ch] [bp-Ch]@1
  unsigned __int8 v39; // [sp+97h] [bp-1h]@31

  v23 = 0;
  v24 = 128;
  v25 = 24;
  v26 = 152;
  v27 = 24;
  v28 = 128;
  v29 = 48;
  v30 = 152;
  v31 = 48;
  v32 = 128;
  v33 = 72;
  v34 = 152;
  v35 = 72;
  v36 = 128;
  v37 = 96;
  v38 = 152;
  v6 = 0;
  v7 = 152;
  v8 = 24;
  v9 = 176;
  v10 = 24;
  v11 = 152;
  v12 = 48;
  v13 = 176;
  v14 = 48;
  v15 = 152;
  v16 = 72;
  v17 = 176;
  v18 = 72;
  v19 = 152;
  v20 = 96;
  v21 = 176;
  if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos + 163840
    && *(_DWORD *)(a1 + 8) >= Quote.X_Pos - 163840
    && *(_DWORD *)(a1 + 12) <= Quote.Y_Pos + 122880
    && *(_DWORD *)(a1 + 12) >= Quote.Y_Pos - 122880 )
  {
    switch ( *(_DWORD *)(a1 + 116) )
    {
      case 0:
        *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
        *(_DWORD *)(a1 + 116) = 1;
        goto LABEL_8;
      case 1:
LABEL_8:
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 16) = 0;
        if ( *(_DWORD *)(a1 + 120) >= 5 )
        {
          if ( *(_DWORD *)(a1 + 8) - 98304 < Quote.X_Pos
            && *(_DWORD *)(a1 + 8) + 98304 > Quote.X_Pos
            && *(_DWORD *)(a1 + 12) - 81920 < Quote.Y_Pos
            && *(_DWORD *)(a1 + 12) + 81920 > Quote.Y_Pos )
          {
            *(_DWORD *)(a1 + 116) = 10;
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 104) = 1;
          }
        }
        else
        {
          ++*(_DWORD *)(a1 + 120);
        }
        break;
      case 0xA:
        if ( ++*(_DWORD *)(a1 + 120) > 3 )
        {
          if ( ++*(_DWORD *)(a1 + 108) == 3 )
          {
            Play_Sound_Effect(Sfx_Critter_Hop, 1);
            *(_DWORD *)(a1 + 108) = 0;
            *(_DWORD *)(a1 + 116) = 25;
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 104) = 2;
            *(_DWORD *)(a1 + 20) = -1536;
            if ( *(_DWORD *)(a1 + 8) >= *(_DWORD *)(a1 + 32) )
              *(_DWORD *)(a1 + 16) = -128;
            else
              *(_DWORD *)(a1 + 16) = 128;
          }
          else
          {
            Play_Sound_Effect(Sfx_Critter_Hop, 1);
            *(_DWORD *)(a1 + 116) = 20;
            *(_DWORD *)(a1 + 104) = 2;
            *(_DWORD *)(a1 + 20) = -512;
            if ( *(_DWORD *)(a1 + 8) >= *(_DWORD *)(a1 + 32) )
              *(_DWORD *)(a1 + 16) = -512;
            else
              *(_DWORD *)(a1 + 16) = 512;
          }
        }
        break;
      case 0x14:
        ++*(_DWORD *)(a1 + 120);
        if ( *(_DWORD *)(a1 + 4) & 8 )
        {
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
          *(_DWORD *)(a1 + 104) = 1;
          *(_DWORD *)(a1 + 116) = 30;
          *(_DWORD *)(a1 + 120) = 0;
        }
        break;
      case 0x19:
        if ( ++*(_DWORD *)(a1 + 120) == 30 || *(_DWORD *)(a1 + 120) == 40 )
        {
          v39 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
          v39 += Random(-6, 6);
          Y_Vel = 3 * GetSin(v39);
          X_Vel = 3 * GetCos(v39);
          NPC_Create(Santas_Key|0xA0, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          *(_DWORD *)(a1 + 104) = 3;
          Super_X_Pos = Random(80, 100);
          Curly_Shoot_Wait = *(_DWORD *)(a1 + 8);
          Curly_Shoot_X = *(_DWORD *)(a1 + 12);
        }
        if ( *(_DWORD *)(a1 + 120) == 35 || *(_DWORD *)(a1 + 120) == 45 )
          *(_DWORD *)(a1 + 104) = 2;
        if ( *(_DWORD *)(a1 + 4) & 8 )
        {
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
          *(_DWORD *)(a1 + 104) = 1;
          *(_DWORD *)(a1 + 116) = 30;
          *(_DWORD *)(a1 + 120) = 0;
        }
        break;
      case 0x1E:
        *(_DWORD *)(a1 + 16) = 7 * *(_DWORD *)(a1 + 16) / 8;
        if ( ++*(_DWORD *)(a1 + 120) > 3 )
        {
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 116) = 1;
          *(_DWORD *)(a1 + 120) = 0;
        }
        break;
      default:
        break;
    }
    *(_DWORD *)(a1 + 20) += 51;
    if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    if ( *(_DWORD *)(a1 + 20) < -1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    if ( *(_DWORD *)(a1 + 76) )
    {
      v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      *(_DWORD *)(v5 + 12) = v4[3];
    }
    else
    {
      v2 = &v23 + 4 * *(_DWORD *)(a1 + 104);
      v3 = a1 + 84;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      *(_DWORD *)(v3 + 12) = v2[3];
    }
    if ( *(_DWORD *)(a1 + 64) <= 985 )
    {
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 2);
      *(_DWORD *)(a1 + 40) = 154;
      *(_DWORD *)(a1 + 116) = 0;
    }
  }
}
// 4BBA20: using guessed type int Curly_Shoot_Wait;
// 4BBA24: using guessed type int Curly_Shoot_X;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (0044A3C0) --------------------------------------------------------
int __cdecl NPC174(int a1)
{
  int *v1; // ecx@27
  int v2; // edx@27
  int result; // eax@27
  int v4; // [sp+0h] [bp-38h]@1
  int v5; // [sp+4h] [bp-34h]@25
  int v6; // [sp+8h] [bp-30h]@25
  int v7; // [sp+Ch] [bp-2Ch]@25
  int v8; // [sp+10h] [bp-28h]@25
  int v9; // [sp+14h] [bp-24h]@25
  int v10; // [sp+18h] [bp-20h]@25
  int v11; // [sp+1Ch] [bp-1Ch]@25
  int v12; // [sp+20h] [bp-18h]@25
  int v13; // [sp+24h] [bp-14h]@25
  int v14; // [sp+28h] [bp-10h]@25
  int v15; // [sp+2Ch] [bp-Ch]@25
  int v16; // [sp+30h] [bp-8h]@25
  int v17; // [sp+34h] [bp-4h]@7

  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 )
      {
        *(_DWORD *)(a1 + 20) += 64;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
        if ( *(_DWORD *)(a1 + 4) & 8 )
        {
          if ( ++*(_DWORD *)(a1 + 108) > 1 )
          {
            Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
            *(_BYTE *)a1 = 0;
          }
        }
      }
      goto LABEL_21;
    }
  }
  else if ( *(_DWORD *)(a1 + 76) == 2 )
  {
    *(_DWORD *)(a1 + 116) = 2;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v17 = 0;
  if ( *(_DWORD *)(a1 + 4) & 1 )
  {
    v17 = 1;
    *(_DWORD *)(a1 + 16) = 512;
  }
  if ( *(_DWORD *)(a1 + 4) & 4 )
  {
    v17 = 1;
    *(_DWORD *)(a1 + 16) = -512;
  }
  if ( *(_DWORD *)(a1 + 4) & 2 )
  {
    v17 = 1;
    *(_DWORD *)(a1 + 20) = 512;
  }
  if ( *(_DWORD *)(a1 + 4) & 8 )
  {
    v17 = 1;
    *(_DWORD *)(a1 + 20) = -512;
  }
  if ( v17 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    ++*(_DWORD *)(a1 + 108);
    Play_Sound_Effect(Sfx_Shot_Hit_Invulnerable_Entity, 1);
  }
LABEL_21:
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  if ( *(_DWORD *)(a1 + 20) < -1535 )
    *(_DWORD *)(a1 + 20) = -1535;
  v5 = 120;
  v6 = 80;
  v7 = 136;
  v8 = 96;
  v9 = 136;
  v10 = 80;
  v11 = 152;
  v12 = 96;
  v13 = 152;
  v14 = 80;
  v15 = 168;
  v16 = 96;
  if ( ++*(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0044A610) --------------------------------------------------------
int __cdecl NPC175(void *Is_NPC_Alive)
{
  int *v1; // ecx@14
  char *v2; // edx@14
  int result; // eax@14
  int *v4; // ecx@15
  char *v5; // edx@15
  int v6; // [sp+4h] [bp-40h]@1
  int v7; // [sp+8h] [bp-3Ch]@1
  int v8; // [sp+Ch] [bp-38h]@1
  int v9; // [sp+10h] [bp-34h]@1
  int v10; // [sp+14h] [bp-30h]@1
  int v11; // [sp+18h] [bp-2Ch]@1
  int v12; // [sp+1Ch] [bp-28h]@1
  int v13; // [sp+20h] [bp-24h]@1
  int v14; // [sp+24h] [bp-20h]@1
  int v15; // [sp+28h] [bp-1Ch]@1
  int v16; // [sp+2Ch] [bp-18h]@1
  int v17; // [sp+30h] [bp-14h]@1
  int v18; // [sp+34h] [bp-10h]@1
  int v19; // [sp+38h] [bp-Ch]@1
  int v20; // [sp+3Ch] [bp-8h]@1
  int v21; // [sp+40h] [bp-4h]@1

  v14 = 168;
  v15 = 80;
  v16 = 192;
  v17 = 104;
  v18 = 192;
  v19 = 80;
  v20 = 216;
  v21 = 104;
  v6 = 216;
  v7 = 80;
  v8 = 240;
  v9 = 104;
  v10 = 240;
  v11 = 80;
  v12 = 264;
  v13 = 104;
  if ( *((_DWORD *)Is_NPC_Alive + 29) < 3 && *((_DWORD *)Is_NPC_Alive + 16) < 90 )
  {
    NPC_Death_Maybe(Is_NPC_Alive, 0);
    *((_DWORD *)Is_NPC_Alive + 29) = 10;
    *((_DWORD *)Is_NPC_Alive + 26) = 1;
    *((_WORD *)Is_NPC_Alive + 40) &= 0xFFDFu;
    *((_DWORD *)Is_NPC_Alive + 41) = 0;
  }
  if ( !*((_DWORD *)Is_NPC_Alive + 29) )
  {
    *((_DWORD *)Is_NPC_Alive + 26) = 0;
    *((_DWORD *)Is_NPC_Alive + 29) = 1;
  }
  if ( *((_DWORD *)Is_NPC_Alive + 19) )
    *((_DWORD *)Is_NPC_Alive + 5) -= 32;
  else
    *((_DWORD *)Is_NPC_Alive + 5) += 32;
  if ( *((_DWORD *)Is_NPC_Alive + 5) < -1535 )
    *((_DWORD *)Is_NPC_Alive + 5) = -1535;
  if ( *((_DWORD *)Is_NPC_Alive + 5) > 1535 )
    *((_DWORD *)Is_NPC_Alive + 5) = 1535;
  *((_DWORD *)Is_NPC_Alive + 3) += *((_DWORD *)Is_NPC_Alive + 5);
  if ( *((_DWORD *)Is_NPC_Alive + 19) )
  {
    v4 = &v6 + 4 * *((_DWORD *)Is_NPC_Alive + 26);
    v5 = (char *)Is_NPC_Alive + 84;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    result = v4[2];
    *((_DWORD *)v5 + 2) = result;
    *((_DWORD *)v5 + 3) = v4[3];
  }
  else
  {
    v1 = &v14 + 4 * *((_DWORD *)Is_NPC_Alive + 26);
    v2 = (char *)Is_NPC_Alive + 84;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    result = v1[2];
    *((_DWORD *)v2 + 2) = result;
    *((_DWORD *)v2 + 3) = v1[3];
  }
  return result;
}

//----- (0044A7D0) --------------------------------------------------------
int __cdecl NPC176(void *Is_NPC_Alive)
{
  int *v1; // ecx@37
  char *v2; // edx@37
  int result; // eax@37
  int *v4; // ecx@38
  char *v5; // edx@38
  int v6; // [sp+0h] [bp-64h]@4
  int v7; // [sp+4h] [bp-60h]@1
  int v8; // [sp+8h] [bp-5Ch]@1
  int v9; // [sp+Ch] [bp-58h]@1
  int v10; // [sp+10h] [bp-54h]@1
  int v11; // [sp+14h] [bp-50h]@1
  int v12; // [sp+18h] [bp-4Ch]@1
  int v13; // [sp+1Ch] [bp-48h]@1
  int v14; // [sp+20h] [bp-44h]@1
  int v15; // [sp+24h] [bp-40h]@1
  int v16; // [sp+28h] [bp-3Ch]@1
  int v17; // [sp+2Ch] [bp-38h]@1
  int v18; // [sp+30h] [bp-34h]@1
  int v19; // [sp+34h] [bp-30h]@1
  int v20; // [sp+38h] [bp-2Ch]@1
  int v21; // [sp+3Ch] [bp-28h]@1
  int v22; // [sp+40h] [bp-24h]@1
  int v23; // [sp+44h] [bp-20h]@1
  int v24; // [sp+48h] [bp-1Ch]@1
  int v25; // [sp+4Ch] [bp-18h]@1
  int v26; // [sp+50h] [bp-14h]@1
  int v27; // [sp+54h] [bp-10h]@1
  int v28; // [sp+58h] [bp-Ch]@1
  int v29; // [sp+5Ch] [bp-8h]@1
  int v30; // [sp+60h] [bp-4h]@1

  v19 = 96;
  v20 = 128;
  v21 = 128;
  v22 = 144;
  v23 = 128;
  v24 = 128;
  v25 = 160;
  v26 = 144;
  v27 = 160;
  v28 = 128;
  v29 = 192;
  v30 = 144;
  v7 = 96;
  v8 = 144;
  v9 = 128;
  v10 = 160;
  v11 = 128;
  v12 = 144;
  v13 = 160;
  v14 = 160;
  v15 = 160;
  v16 = 144;
  v17 = 192;
  v18 = 160;
  if ( *((_DWORD *)Is_NPC_Alive + 29) < 3 && *((_DWORD *)Is_NPC_Alive + 16) < 940 )
  {
    NPC_Death_Maybe(Is_NPC_Alive, 0);
    *((_DWORD *)Is_NPC_Alive + 29) = 10;
    *((_DWORD *)Is_NPC_Alive + 26) = 2;
    *((_WORD *)Is_NPC_Alive + 40) &= 0xFFDFu;
    *((_DWORD *)Is_NPC_Alive + 41) = 0;
  }
  v6 = *((_DWORD *)Is_NPC_Alive + 29);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 == 2 )
      {
        if ( ++*((_DWORD *)Is_NPC_Alive + 25) > 3 )
        {
          *((_DWORD *)Is_NPC_Alive + 25) = 0;
          ++*((_DWORD *)Is_NPC_Alive + 26);
        }
        if ( *((_DWORD *)Is_NPC_Alive + 26) > 1 )
          *((_DWORD *)Is_NPC_Alive + 26) = 0;
        if ( ++*((_DWORD *)Is_NPC_Alive + 30) > 10 )
        {
          if ( ++*((_DWORD *)Is_NPC_Alive + 28) <= 2 )
          {
            *((_DWORD *)Is_NPC_Alive + 27) = -10;
          }
          else
          {
            *((_DWORD *)Is_NPC_Alive + 28) = 0;
            *((_DWORD *)Is_NPC_Alive + 27) = -90;
          }
          if ( *((_DWORD *)Is_NPC_Alive + 19) )
            NPC_Create(
              (NPC_Names)177,
              *((_DWORD *)Is_NPC_Alive + 2),
              *((_DWORD *)Is_NPC_Alive + 3) + 4096,
              0,
              0,
              Right,
              NULL,
              256);
          else
            NPC_Create(
              (NPC_Names)177,
              *((_DWORD *)Is_NPC_Alive + 2),
              *((_DWORD *)Is_NPC_Alive + 3) - 4096,
              0,
              0,
              0,
              NULL,
              256);
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          *((_DWORD *)Is_NPC_Alive + 29) = 0;
          *((_DWORD *)Is_NPC_Alive + 26) = 0;
          Super_X_Pos = Random(80, 100);
          Curly_Shoot_Wait = *((_DWORD *)Is_NPC_Alive + 2);
          Curly_Shoot_X = *((_DWORD *)Is_NPC_Alive + 3);
        }
      }
      goto LABEL_36;
    }
  }
  else
  {
    *((_DWORD *)Is_NPC_Alive + 29) = 1;
    *((_DWORD *)Is_NPC_Alive + 26) = 0;
    *((_DWORD *)Is_NPC_Alive + 25) = 0;
  }
  if ( *((_DWORD *)Is_NPC_Alive + 19) )
  {
    if ( *((_DWORD *)Is_NPC_Alive + 2) < Quote.X_Pos + 81920
      && *((_DWORD *)Is_NPC_Alive + 2) > Quote.X_Pos - 81920
      && *((_DWORD *)Is_NPC_Alive + 3) < Quote.Y_Pos + 0x2000
      && *((_DWORD *)Is_NPC_Alive + 3) > Quote.Y_Pos - 81920 )
    {
      ++*((_DWORD *)Is_NPC_Alive + 27);
    }
  }
  else if ( *((_DWORD *)Is_NPC_Alive + 2) < Quote.X_Pos + 81920
         && *((_DWORD *)Is_NPC_Alive + 2) > Quote.X_Pos - 81920
         && *((_DWORD *)Is_NPC_Alive + 3) < Quote.Y_Pos + 81920
         && *((_DWORD *)Is_NPC_Alive + 3) > Quote.Y_Pos - 0x2000 )
  {
    ++*((_DWORD *)Is_NPC_Alive + 27);
  }
  if ( *((_DWORD *)Is_NPC_Alive + 27) > 10 )
  {
    *((_DWORD *)Is_NPC_Alive + 29) = 2;
    *((_DWORD *)Is_NPC_Alive + 30) = 0;
  }
LABEL_36:
  if ( *((_DWORD *)Is_NPC_Alive + 19) )
  {
    v4 = &v7 + 4 * *((_DWORD *)Is_NPC_Alive + 26);
    v5 = (char *)Is_NPC_Alive + 84;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    result = v4[2];
    *((_DWORD *)v5 + 2) = result;
    *((_DWORD *)v5 + 3) = v4[3];
  }
  else
  {
    v1 = &v19 + 4 * *((_DWORD *)Is_NPC_Alive + 26);
    v2 = (char *)Is_NPC_Alive + 84;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    result = v1[2];
    *((_DWORD *)v2 + 2) = result;
    *((_DWORD *)v2 + 3) = v1[3];
  }
  return result;
}
// 4BBA20: using guessed type int Curly_Shoot_Wait;
// 4BBA24: using guessed type int Curly_Shoot_X;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (0044ABB0) --------------------------------------------------------
void __cdecl NPC177(int a1)
{
  int *v1; // ecx@40
  int v2; // edx@40
  int v3; // [sp+0h] [bp-24h]@3
  int v4; // [sp+4h] [bp-20h]@1
  int v5; // [sp+8h] [bp-1Ch]@1
  int v6; // [sp+Ch] [bp-18h]@1
  int v7; // [sp+10h] [bp-14h]@1
  int v8; // [sp+14h] [bp-10h]@1
  int v9; // [sp+18h] [bp-Ch]@1
  int v10; // [sp+1Ch] [bp-8h]@1
  int v11; // [sp+20h] [bp-4h]@1

  v4 = 192;
  v5 = 128;
  v6 = 208;
  v7 = 144;
  v8 = 208;
  v9 = 128;
  v10 = 224;
  v11 = 144;
  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 3, 0);
    *(_BYTE *)a1 = 0;
    return;
  }
  v3 = *(_DWORD *)(a1 + 116);
  if ( !v3 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 20) = 1536;
    else
      *(_DWORD *)(a1 + 20) = -1536;
LABEL_10:
    if ( *(_DWORD *)(a1 + 12) < Quote.Y_Pos + 0x2000 && *(_DWORD *)(a1 + 12) > Quote.Y_Pos - 0x2000 )
    {
      *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 16) = (Random(0, 1) << 10) - 512;
      *(_DWORD *)(a1 + 20) = (Random(0, 1) << 10) - 512;
    }
    goto LABEL_28;
  }
  if ( v3 == 1 )
    goto LABEL_10;
  if ( v3 == 10 )
  {
    if ( *(_DWORD *)(a1 + 8) >= *(_DWORD *)(a1 + 32) )
      *(_DWORD *)(a1 + 16) -= 32;
    else
      *(_DWORD *)(a1 + 16) += 32;
    if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
      *(_DWORD *)(a1 + 20) -= 32;
    else
      *(_DWORD *)(a1 + 20) += 32;
    if ( ++*(_DWORD *)(a1 + 120) > 300 )
    {
      Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 3, 0);
      *(_BYTE *)a1 = 0;
      return;
    }
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 32) += 512;
    else
      *(_DWORD *)(a1 + 32) -= 512;
  }
LABEL_28:
  if ( *(_DWORD *)(a1 + 16) > 1024 )
    *(_DWORD *)(a1 + 16) = 1024;
  if ( *(_DWORD *)(a1 + 16) < -1024 )
    *(_DWORD *)(a1 + 16) = -1024;
  if ( *(_DWORD *)(a1 + 20) > 1024 )
    *(_DWORD *)(a1 + 20) = 1024;
  if ( *(_DWORD *)(a1 + 20) < -1024 )
    *(_DWORD *)(a1 + 20) = -1024;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( ++*(_DWORD *)(a1 + 100) > 6 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
}

//----- (0044AEE0) --------------------------------------------------------
void __cdecl NPC178(void *a1)
{
  int *v1; // edx@10
  char *v2; // eax@10
  int v3; // [sp+0h] [bp-30h]@6
  int v4; // [sp+4h] [bp-2Ch]@6
  int v5; // [sp+8h] [bp-28h]@6
  int v6; // [sp+Ch] [bp-24h]@6
  int v7; // [sp+10h] [bp-20h]@6
  int v8; // [sp+14h] [bp-1Ch]@6
  int v9; // [sp+18h] [bp-18h]@6
  int v10; // [sp+1Ch] [bp-14h]@6
  int v11; // [sp+20h] [bp-10h]@6
  int v12; // [sp+24h] [bp-Ch]@6
  int v13; // [sp+28h] [bp-8h]@6
  int v14; // [sp+2Ch] [bp-4h]@6

  if ( *((_DWORD *)a1 + 1) & 0xFF )
  {
    Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 2, 0);
    *(_BYTE *)a1 = 0;
  }
  if ( *((_DWORD *)a1 + 1) & 0x100 )
  {
    *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5) / 2;
    *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4) / 2;
  }
  else
  {
    *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
    *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
  }
  v3 = 0;
  v4 = 224;
  v5 = 16;
  v6 = 240;
  v7 = 16;
  v8 = 224;
  v9 = 32;
  v10 = 240;
  v11 = 32;
  v12 = 224;
  v13 = 48;
  v14 = 240;
  if ( ++*((_DWORD *)a1 + 25) > 1 )
  {
    *((_DWORD *)a1 + 25) = 0;
    ++*((_DWORD *)a1 + 26);
  }
  if ( *((_DWORD *)a1 + 26) > 2 )
    *((_DWORD *)a1 + 26) = 0;
  v1 = &v3 + 4 * *((_DWORD *)a1 + 26);
  v2 = (char *)a1 + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
  if ( ++*((_DWORD *)a1 + 27) > 150 )
  {
    Vanish_NPC((NPC_vars *)a1);
    Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 2, 0);
  }
}

//----- (0044B080) --------------------------------------------------------
void __cdecl NPC179(void *a1)
{
  int *v1; // eax@9
  char *v2; // ecx@9
  int v3; // [sp+0h] [bp-30h]@5
  int v4; // [sp+4h] [bp-2Ch]@5
  int v5; // [sp+8h] [bp-28h]@5
  int v6; // [sp+Ch] [bp-24h]@5
  int v7; // [sp+10h] [bp-20h]@5
  int v8; // [sp+14h] [bp-1Ch]@5
  int v9; // [sp+18h] [bp-18h]@5
  int v10; // [sp+1Ch] [bp-14h]@5
  int v11; // [sp+20h] [bp-10h]@5
  int v12; // [sp+24h] [bp-Ch]@5
  int v13; // [sp+28h] [bp-8h]@5
  int v14; // [sp+2Ch] [bp-4h]@5

  if ( *((_DWORD *)a1 + 1) & 0xFF )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 2, 0);
  }
  *((_DWORD *)a1 + 4) -= 32;
  *((_DWORD *)a1 + 5) = 0;
  if ( *((_DWORD *)a1 + 4) < -1024 )
    *((_DWORD *)a1 + 4) = -1024;
  *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
  *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
  v3 = 48;
  v4 = 224;
  v5 = 72;
  v6 = 240;
  v7 = 72;
  v8 = 224;
  v9 = 96;
  v10 = 240;
  v11 = 96;
  v12 = 224;
  v13 = 120;
  v14 = 240;
  if ( ++*((_DWORD *)a1 + 25) > 1 )
  {
    *((_DWORD *)a1 + 25) = 0;
    ++*((_DWORD *)a1 + 26);
  }
  if ( *((_DWORD *)a1 + 26) > 2 )
    *((_DWORD *)a1 + 26) = 0;
  v1 = &v3 + 4 * *((_DWORD *)a1 + 26);
  v2 = (char *)a1 + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
  if ( ++*((_DWORD *)a1 + 27) > 300 )
  {
    Vanish_NPC((NPC_vars *)a1);
    Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 2, 0);
  }
}

//----- (0044B210) --------------------------------------------------------
LONG *__cdecl NPC180(NPC_vars *a1)
{
  int *v1; // edx@106
  LONG *result; // eax@106
  int *v3; // edx@107
  int v4; // [sp+4h] [bp-170h]@15
  int v5; // [sp+8h] [bp-16Ch]@62
  int v6; // [sp+Ch] [bp-168h]@1
  int v7; // [sp+10h] [bp-164h]@1
  int v8; // [sp+14h] [bp-160h]@1
  int v9; // [sp+18h] [bp-15Ch]@1
  int v10; // [sp+1Ch] [bp-158h]@1
  int v11; // [sp+20h] [bp-154h]@1
  int v12; // [sp+24h] [bp-150h]@1
  int v13; // [sp+28h] [bp-14Ch]@1
  int v14; // [sp+2Ch] [bp-148h]@1
  int v15; // [sp+30h] [bp-144h]@1
  int v16; // [sp+34h] [bp-140h]@1
  int v17; // [sp+38h] [bp-13Ch]@1
  int v18; // [sp+3Ch] [bp-138h]@1
  int v19; // [sp+40h] [bp-134h]@1
  int v20; // [sp+44h] [bp-130h]@1
  int v21; // [sp+48h] [bp-12Ch]@1
  int v22; // [sp+4Ch] [bp-128h]@1
  int v23; // [sp+50h] [bp-124h]@1
  int v24; // [sp+54h] [bp-120h]@1
  int v25; // [sp+58h] [bp-11Ch]@1
  int v26; // [sp+5Ch] [bp-118h]@1
  int v27; // [sp+60h] [bp-114h]@1
  int v28; // [sp+64h] [bp-110h]@1
  int v29; // [sp+68h] [bp-10Ch]@1
  int v30; // [sp+6Ch] [bp-108h]@1
  int v31; // [sp+70h] [bp-104h]@1
  int v32; // [sp+74h] [bp-100h]@1
  int v33; // [sp+78h] [bp-FCh]@1
  int v34; // [sp+7Ch] [bp-F8h]@1
  int v35; // [sp+80h] [bp-F4h]@1
  int v36; // [sp+84h] [bp-F0h]@1
  int v37; // [sp+88h] [bp-ECh]@1
  int v38; // [sp+8Ch] [bp-E8h]@1
  int v39; // [sp+90h] [bp-E4h]@1
  int v40; // [sp+94h] [bp-E0h]@1
  int v41; // [sp+98h] [bp-DCh]@1
  int v42; // [sp+9Ch] [bp-D8h]@1
  int v43; // [sp+A0h] [bp-D4h]@1
  int v44; // [sp+A4h] [bp-D0h]@1
  int v45; // [sp+A8h] [bp-CCh]@1
  int v46; // [sp+ACh] [bp-C8h]@1
  int v47; // [sp+B0h] [bp-C4h]@1
  int v48; // [sp+B4h] [bp-C0h]@1
  int v49; // [sp+B8h] [bp-BCh]@1
  int v50; // [sp+C0h] [bp-B4h]@62
  int v51; // [sp+C4h] [bp-B0h]@1
  int v52; // [sp+C8h] [bp-ACh]@1
  int v53; // [sp+CCh] [bp-A8h]@1
  int v54; // [sp+D0h] [bp-A4h]@1
  int v55; // [sp+D4h] [bp-A0h]@1
  int v56; // [sp+D8h] [bp-9Ch]@1
  int v57; // [sp+DCh] [bp-98h]@1
  int v58; // [sp+E0h] [bp-94h]@1
  int v59; // [sp+E4h] [bp-90h]@1
  int v60; // [sp+E8h] [bp-8Ch]@1
  int v61; // [sp+ECh] [bp-88h]@1
  int v62; // [sp+F0h] [bp-84h]@1
  int v63; // [sp+F4h] [bp-80h]@1
  int v64; // [sp+F8h] [bp-7Ch]@1
  int v65; // [sp+FCh] [bp-78h]@1
  int v66; // [sp+100h] [bp-74h]@1
  int v67; // [sp+104h] [bp-70h]@1
  int v68; // [sp+108h] [bp-6Ch]@1
  int v69; // [sp+10Ch] [bp-68h]@1
  int v70; // [sp+110h] [bp-64h]@1
  int v71; // [sp+114h] [bp-60h]@1
  int v72; // [sp+118h] [bp-5Ch]@1
  int v73; // [sp+11Ch] [bp-58h]@1
  int v74; // [sp+120h] [bp-54h]@1
  int v75; // [sp+124h] [bp-50h]@1
  int v76; // [sp+128h] [bp-4Ch]@1
  int v77; // [sp+12Ch] [bp-48h]@1
  int v78; // [sp+130h] [bp-44h]@1
  int v79; // [sp+134h] [bp-40h]@1
  int v80; // [sp+138h] [bp-3Ch]@1
  int v81; // [sp+13Ch] [bp-38h]@1
  int v82; // [sp+140h] [bp-34h]@1
  int v83; // [sp+144h] [bp-30h]@1
  int v84; // [sp+148h] [bp-2Ch]@1
  int v85; // [sp+14Ch] [bp-28h]@1
  int v86; // [sp+150h] [bp-24h]@1
  int v87; // [sp+154h] [bp-20h]@1
  int v88; // [sp+158h] [bp-1Ch]@1
  int v89; // [sp+15Ch] [bp-18h]@1
  int v90; // [sp+160h] [bp-14h]@1
  int v91; // [sp+164h] [bp-10h]@1
  int v92; // [sp+168h] [bp-Ch]@1
  int v93; // [sp+16Ch] [bp-8h]@1
  int v94; // [sp+170h] [bp-4h]@1

  v51 = 0;
  v52 = 96;
  v53 = 16;
  v54 = 112;
  v55 = 16;
  v56 = 96;
  v57 = 32;
  v58 = 112;
  v59 = 0;
  v60 = 96;
  v61 = 16;
  v62 = 112;
  v63 = 32;
  v64 = 96;
  v65 = 48;
  v66 = 112;
  v67 = 0;
  v68 = 96;
  v69 = 16;
  v70 = 112;
  v71 = 48;
  v72 = 96;
  v73 = 64;
  v74 = 112;
  v75 = 64;
  v76 = 96;
  v77 = 80;
  v78 = 112;
  v79 = 48;
  v80 = 96;
  v81 = 64;
  v82 = 112;
  v83 = 80;
  v84 = 96;
  v85 = 96;
  v86 = 112;
  v87 = 48;
  v88 = 96;
  v89 = 64;
  v90 = 112;
  v91 = 144;
  v92 = 96;
  v93 = 160;
  v94 = 112;
  v6 = 0;
  v7 = 112;
  v8 = 16;
  v9 = 128;
  v10 = 16;
  v11 = 112;
  v12 = 32;
  v13 = 128;
  v14 = 0;
  v15 = 112;
  v16 = 16;
  v17 = 128;
  v18 = 32;
  v19 = 112;
  v20 = 48;
  v21 = 128;
  v22 = 0;
  v23 = 112;
  v24 = 16;
  v25 = 128;
  v26 = 48;
  v27 = 112;
  v28 = 64;
  v29 = 128;
  v30 = 64;
  v31 = 112;
  v32 = 80;
  v33 = 128;
  v34 = 48;
  v35 = 112;
  v36 = 64;
  v37 = 128;
  v38 = 80;
  v39 = 112;
  v40 = 96;
  v41 = 128;
  v42 = 48;
  v43 = 112;
  v44 = 64;
  v45 = 128;
  v46 = 144;
  v47 = 112;
  v48 = 160;
  v49 = 128;
  if ( a1->Y_pos >= Quote.Y_Pos - 81920 )
  {
    if ( Super_X_Pos )
    {
      a1->Curly_Target_X = Curly_Shoot_Wait;
      a1->Curly_Target_Y = Curly_Shoot_X;
    }
    else
    {
      a1->Curly_Target_X = Quote.X_Pos;
      a1->Curly_Target_Y = Quote.Y_Pos;
    }
  }
  else if ( a1->Y_pos >= 0x20000 )
  {
    a1->Curly_Target_X = 0;
    a1->Curly_Target_Y = a1->Y_pos;
  }
  else
  {
    a1->Curly_Target_X = 2621440;
    a1->Curly_Target_Y = a1->Y_pos;
  }
  if ( a1->X_vel < 0 && a1->Collision_flags & 1 )
    a1->X_vel = 0;
  if ( a1->X_vel > 0 && a1->Collision_flags & 4 )
    a1->X_vel = 0;
  v4 = a1->Current_State;
  if ( v4 > 200 )
  {
    switch ( v4 )
    {
      case 210:
        a1->X_vel -= 32;
        a1->Direction = 0;
        if ( a1->Collision_flags & 8 )
          a1->Current_State = 100;
        break;
      case 300:
        a1->X_vel += 32;
        a1->Direction = 2;
        if ( a1->Collision_flags & 4 )
          ++a1->count1;
        else
          a1->count1 = 0;
        break;
      case 310:
        a1->X_vel += 32;
        a1->Direction = 2;
        if ( a1->Collision_flags & 8 )
          a1->Current_State = 100;
        break;
    }
  }
  else if ( v4 == 200 )
  {
    a1->X_vel -= 32;
    a1->Direction = 0;
    if ( a1->Collision_flags & 1 )
      ++a1->count1;
    else
      a1->count1 = 0;
  }
  else
  {
    switch ( v4 )
    {
      case 20:
        a1->X_pos = Quote.X_Pos;
        a1->Y_pos = Quote.Y_Pos;
        a1->Current_State = 100;
        a1->Ani_Num = 0;
        NPC_Create((NPC_Names)183, 0, 0, 0, 0, 0, a1, 256);
        if ( Get_NPC_Flag(563) )
          NPC_Create((NPC_Names)182, 0, 0, 0, 0, 0, a1, 256);
        else
          NPC_Create((NPC_Names)181, 0, 0, 0, 0, 0, a1, 256);
        break;
      case 40:
        a1->Current_State = 41;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 10;
        goto LABEL_27;
      case 41:
LABEL_27:
        if ( ++a1->Wait_Timer == 750 )
        {
          a1->Entity_Flags &= 0xDFFFu;
          a1->Ani_Num = 0;
        }
        if ( a1->Wait_Timer > 1000 )
        {
          a1->Current_State = 100;
          a1->Ani_Num = 0;
          NPC_Create((NPC_Names)183, 0, 0, 0, 0, 0, a1, 256);
          if ( Get_NPC_Flag(563) )
            NPC_Create((NPC_Names)182, 0, 0, 0, 0, 0, a1, 256);
          else
            NPC_Create((NPC_Names)181, 0, 0, 0, 0, 0, a1, 256);
        }
        break;
      case 100:
        a1->Ani_Num = 0;
        a1->X_vel = 7 * a1->X_vel / 8;
        a1->count1 = 0;
        if ( a1->X_pos <= a1->Curly_Target_X + 0x2000 )
        {
          if ( a1->X_pos < a1->Curly_Target_X - 0x2000 )
          {
            a1->Current_State = 300;
            a1->Ani_Num = 1;
            a1->Direction = 2;
            a1->Wait_Timer = Random(20, 60);
          }
        }
        else
        {
          a1->Current_State = 200;
          a1->Ani_Num = 1;
          a1->Direction = 0;
          a1->Wait_Timer = Random(20, 60);
        }
        break;
      default:
        break;
    }
  }
  if ( Super_X_Pos )
    --Super_X_Pos;
  if ( Super_X_Pos == 70 )
    a1->count2 = 10;
  if ( Super_X_Pos == 60 && a1->Collision_flags & 8 && Random(0, 2) )
  {
    a1->count1 = 0;
    a1->Y_vel = -1536;
    a1->Ani_Num = 1;
    Play_Sound_Effect(Sfx_Quote_Jump, 1);
    if ( a1->X_pos <= a1->Curly_Target_X )
      a1->Current_State = 310;
    else
      a1->Current_State = 210;
  }
  v50 = a1->X_pos - a1->Curly_Target_X;
  v5 = a1->Y_pos - a1->Curly_Target_Y;
  if ( v50 < 0 )
    v50 = -v50;
  if ( a1->Current_State == 100 )
  {
    if ( v50 + 1024 >= v5 )
      a1->Ani_Num = 0;
    else
      a1->Ani_Num = 5;
  }
  if ( a1->Current_State == 210 || a1->Current_State == 310 )
  {
    if ( v50 + 1024 >= v5 )
      a1->Ani_Num = 1;
    else
      a1->Ani_Num = 6;
  }
  if ( a1->Current_State == 200 || a1->Current_State == 300 )
  {
    ++a1->ani_wait;
    if ( v50 + 1024 >= v5 )
      a1->Ani_Num = a1->ani_wait / 4 % 4 + 1;
    else
      a1->Ani_Num = a1->ani_wait / 4 % 4 + 6;
    if ( a1->Wait_Timer )
    {
      --a1->Wait_Timer;
      if ( a1->Collision_flags && a1->count1 > 10 )
      {
        a1->count1 = 0;
        a1->Y_vel = -1536;
        a1->Current_State += 10;
        a1->Ani_Num = 1;
        Play_Sound_Effect(Sfx_Quote_Jump, 1);
      }
    }
    else
    {
      a1->Current_State = 100;
      a1->Ani_Num = 0;
    }
  }
  if ( a1->Current_State >= 100 && a1->Current_State < 500 )
  {
    if ( a1->X_pos >= Quote.X_Pos - 40960 && a1->X_pos <= Quote.X_Pos + 40960 )
    {
      a1->Y_vel += 51;
    }
    else if ( a1->Collision_flags )
    {
      a1->Y_vel += 16;
    }
    else
    {
      a1->Y_vel += 51;
    }
  }
  if ( a1->X_vel > 768 )
    a1->X_vel = 768;
  if ( a1->X_vel < -768 )
    a1->X_vel = -768;
  if ( a1->Y_vel > 1535 )
    a1->Y_vel = 1535;
  a1->X_pos += a1->X_vel;
  a1->Y_pos += a1->Y_vel;
  if ( a1->Current_State >= 100 && !(a1->Collision_flags & 8) && a1->Ani_Num != 1000 )
  {
    if ( v50 + 1024 >= v5 )
      a1->Ani_Num = 1;
    else
      a1->Ani_Num = 6;
  }
  if ( a1->Direction )
  {
    v3 = &v6 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v3;
    result[1] = v3[1];
    result[2] = v3[2];
    result[3] = v3[3];
  }
  else
  {
    v1 = &v51 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v1;
    result[1] = v1[1];
    result[2] = v1[2];
    result[3] = v1[3];
  }
  return result;
}
// 4BBA20: using guessed type int Curly_Shoot_Wait;
// 4BBA24: using guessed type int Curly_Shoot_X;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (0044BE10) --------------------------------------------------------
int __cdecl NPC181(int a1)
{
  int result; // eax@1
  int *v2; // eax@34
  int v3; // ecx@34
  int *v4; // eax@35
  int v5; // ecx@35
  int v6; // [sp+0h] [bp-44h]@16
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 216;
  v16 = 152;
  v17 = 232;
  v18 = 168;
  v19 = 232;
  v20 = 152;
  v21 = 248;
  v22 = 168;
  v7 = 216;
  v8 = 168;
  v9 = 232;
  v10 = 184;
  v11 = 232;
  v12 = 168;
  v13 = 248;
  v14 = 184;
  result = a1;
  if ( *(_DWORD *)(a1 + 168) )
  {
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) >= 5 )
    {
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
      {
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
      }
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 5120;
      *(_DWORD *)(a1 + 104) = 1;
    }
    else
    {
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
      {
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 4096;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 4096;
      }
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
      *(_DWORD *)(a1 + 104) = 0;
    }
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 1
      || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 3
      || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 6
      || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 8 )
    {
      *(_DWORD *)(a1 + 12) -= 512;
    }
    v6 = *(_DWORD *)(a1 + 116);
    if ( v6 )
    {
      if ( v6 == 10 )
      {
        if ( ++*(_DWORD *)(a1 + 120) % 6 == 1 )
        {
          if ( *(_DWORD *)(a1 + 104) )
          {
            if ( *(_DWORD *)(a1 + 76) )
            {
              Create_Bullet(Machine_Gun_Lvl_3, *(_DWORD *)(a1 + 8) + 1024, *(_DWORD *)(a1 + 12) - 2048, Up);
              Create_Effect(*(_DWORD *)(a1 + 8) + 1024, *(_DWORD *)(a1 + 12) - 2048, 3, 0);
            }
            else
            {
              Create_Bullet(Machine_Gun_Lvl_3, *(_DWORD *)(a1 + 8) - 1024, *(_DWORD *)(a1 + 12) - 2048, Up);
              Create_Effect(*(_DWORD *)(a1 + 8) - 1024, *(_DWORD *)(a1 + 12) - 2048, 3, 0);
            }
          }
          else if ( *(_DWORD *)(a1 + 76) )
          {
            Create_Bullet(Machine_Gun_Lvl_3, *(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12) + 1536, Right);
            Create_Effect(*(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12) + 1536, 3, 0);
          }
          else
          {
            Create_Bullet(Machine_Gun_Lvl_3, *(_DWORD *)(a1 + 8) - 2048, *(_DWORD *)(a1 + 12) + 1536, 0);
            Create_Effect(*(_DWORD *)(a1 + 8) - 2048, *(_DWORD *)(a1 + 12) + 1536, 3, 0);
          }
        }
        if ( *(_DWORD *)(a1 + 120) == 60 )
          *(_DWORD *)(a1 + 116) = 0;
      }
    }
    else if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 112) == 10 )
    {
      *(_DWORD *)(*(_DWORD *)(a1 + 168) + 112) = 0;
      *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 120) = 0;
    }
    if ( *(_DWORD *)(a1 + 76) )
    {
      v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      result = v4[3];
      *(_DWORD *)(v5 + 12) = result;
    }
    else
    {
      v2 = &v15 + 4 * *(_DWORD *)(a1 + 104);
      v3 = a1 + 84;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      result = v2[3];
      *(_DWORD *)(v3 + 12) = result;
    }
  }
  return result;
}

//----- (0044C220) --------------------------------------------------------
int __cdecl NPC182(int a1)
{
  int result; // eax@1
  int *v2; // eax@34
  int v3; // ecx@34
  int *v4; // eax@35
  int v5; // ecx@35
  int v6; // [sp+0h] [bp-44h]@16
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 184;
  v16 = 152;
  v17 = 200;
  v18 = 168;
  v19 = 200;
  v20 = 152;
  v21 = 216;
  v22 = 168;
  v7 = 184;
  v8 = 168;
  v9 = 200;
  v10 = 184;
  v11 = 200;
  v12 = 168;
  v13 = 216;
  v14 = 184;
  result = a1;
  if ( *(_DWORD *)(a1 + 168) )
  {
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) >= 5 )
    {
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
      {
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
      }
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 5120;
      *(_DWORD *)(a1 + 104) = 1;
    }
    else
    {
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
      {
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 4096;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 4096;
      }
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
      *(_DWORD *)(a1 + 104) = 0;
    }
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 1
      || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 3
      || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 6
      || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 8 )
    {
      *(_DWORD *)(a1 + 12) -= 512;
    }
    v6 = *(_DWORD *)(a1 + 116);
    if ( v6 )
    {
      if ( v6 == 10 )
      {
        if ( ++*(_DWORD *)(a1 + 120) % 12 == 1 )
        {
          if ( *(_DWORD *)(a1 + 104) )
          {
            if ( *(_DWORD *)(a1 + 76) )
            {
              Create_Bullet(Polar_Star_Lvl_3, *(_DWORD *)(a1 + 8) + 1024, *(_DWORD *)(a1 + 12) - 2048, Up);
              Create_Effect(*(_DWORD *)(a1 + 8) + 1024, *(_DWORD *)(a1 + 12) - 2048, 3, 0);
            }
            else
            {
              Create_Bullet(Polar_Star_Lvl_3, *(_DWORD *)(a1 + 8) - 1024, *(_DWORD *)(a1 + 12) - 2048, Up);
              Create_Effect(*(_DWORD *)(a1 + 8) - 1024, *(_DWORD *)(a1 + 12) - 2048, 3, 0);
            }
          }
          else if ( *(_DWORD *)(a1 + 76) )
          {
            Create_Bullet(Polar_Star_Lvl_3, *(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12) + 1536, Right);
            Create_Effect(*(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12) + 1536, 3, 0);
          }
          else
          {
            Create_Bullet(Polar_Star_Lvl_3, *(_DWORD *)(a1 + 8) - 2048, *(_DWORD *)(a1 + 12) + 1536, 0);
            Create_Effect(*(_DWORD *)(a1 + 8) - 2048, *(_DWORD *)(a1 + 12) + 1536, 3, 0);
          }
        }
        if ( *(_DWORD *)(a1 + 120) == 60 )
          *(_DWORD *)(a1 + 116) = 0;
      }
    }
    else if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 112) == 10 )
    {
      *(_DWORD *)(*(_DWORD *)(a1 + 168) + 112) = 0;
      *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 120) = 0;
    }
    if ( *(_DWORD *)(a1 + 76) )
    {
      v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      result = v4[3];
      *(_DWORD *)(v5 + 12) = result;
    }
    else
    {
      v2 = &v15 + 4 * *(_DWORD *)(a1 + 104);
      v3 = a1 + 84;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      result = v2[3];
      *(_DWORD *)(v3 + 12) = result;
    }
  }
  return result;
}

//----- (0044C630) --------------------------------------------------------
int __cdecl NPC183(int a1)
{
  int result; // eax@1
  __int64 v2; // rax@4
  __int64 v3; // rax@4
  int *v4; // eax@9
  int v5; // ecx@9
  int v6; // [sp+4h] [bp-20h]@1
  int v7; // [sp+8h] [bp-1Ch]@1
  int v8; // [sp+Ch] [bp-18h]@1
  int v9; // [sp+10h] [bp-14h]@1
  int v10; // [sp+14h] [bp-10h]@1
  int v11; // [sp+18h] [bp-Ch]@1
  int v12; // [sp+1Ch] [bp-8h]@1
  int v13; // [sp+20h] [bp-4h]@1

  v6 = 56;
  v7 = 96;
  v8 = 80;
  v9 = 120;
  v10 = 80;
  v11 = 96;
  v12 = 104;
  v13 = 120;
  result = a1;
  if ( *(_DWORD *)(a1 + 168) )
  {
    if ( !*(_DWORD *)(a1 + 116) )
    {
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
      *(_DWORD *)(a1 + 116) = 1;
    }
    v2 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 8) += ((signed int)v2 - HIDWORD(v2)) >> 1;
    v3 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 12) += ((signed int)v3 - HIDWORD(v3)) >> 1;
    if ( ++*(_DWORD *)(a1 + 100) > 1 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 1 )
      *(_DWORD *)(a1 + 104) = 0;
    result = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 4) & 0x100;
    if ( result )
    {
      v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      *(_DWORD *)(v5 + 8) = v4[2];
      result = v4[3];
      *(_DWORD *)(v5 + 12) = result;
    }
    else
    {
      *(_DWORD *)(a1 + 92) = 0;
    }
  }
  return result;
}

//----- (0044C7A0) --------------------------------------------------------
int __cdecl NPC184(int a1)
{
  int v1; // ST10_4@14
  int v2; // ST0C_4@14
  int v3; // ST08_4@14
  int v4; // eax@14
  int *v5; // eax@20
  int v6; // ecx@20
  int result; // eax@20
  signed int i; // [sp+8h] [bp-44h]@12
  int v9; // [sp+Ch] [bp-40h]@1
  int v10; // [sp+10h] [bp-3Ch]@1
  int v11; // [sp+14h] [bp-38h]@1
  int v12; // [sp+18h] [bp-34h]@1
  int v13; // [sp+1Ch] [bp-30h]@1
  int v14; // [sp+20h] [bp-2Ch]@1
  int v15; // [sp+24h] [bp-28h]@1
  int v16; // [sp+28h] [bp-24h]@1
  int v17; // [sp+2Ch] [bp-20h]@1
  int v18; // [sp+30h] [bp-1Ch]@1
  int v19; // [sp+34h] [bp-18h]@1
  int v20; // [sp+38h] [bp-14h]@1
  int v21; // [sp+3Ch] [bp-10h]@1
  int v22; // [sp+40h] [bp-Ch]@1
  int v23; // [sp+44h] [bp-8h]@1
  int v24; // [sp+48h] [bp-4h]@1

  v9 = 0;
  v10 = 64;
  v11 = 32;
  v12 = 96;
  v13 = 32;
  v14 = 64;
  v15 = 64;
  v16 = 96;
  v17 = 64;
  v18 = 64;
  v19 = 96;
  v20 = 96;
  v21 = 32;
  v22 = 64;
  v23 = 64;
  v24 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 8) += 4096;
      *(_DWORD *)(a1 + 12) += 4096;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) |= 8u;
      goto LABEL_4;
    case 0xB:
LABEL_4:
      switch ( *(_DWORD *)(a1 + 76) )
      {
        case 0:
          *(_DWORD *)(a1 + 8) -= 128;
          break;
        case 1:
          *(_DWORD *)(a1 + 12) -= 128;
          break;
        case 2:
          *(_DWORD *)(a1 + 8) += 128;
          break;
        case 3:
          *(_DWORD *)(a1 + 12) += 128;
          break;
        default:
          break;
      }
      if ( !(++*(_DWORD *)(a1 + 120) % 8) )
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      Set_Quake(20);
      break;
    case 0x14:
      for ( i = 0; i < 4; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = *(_DWORD *)(a1 + 12) + 0x2000;
        v4 = Random(-12, 12);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
      *(_DWORD *)(a1 + 116) = 1;
      break;
    default:
      break;
  }
  if ( ++*(_DWORD *)(a1 + 100) > 10 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 3 )
    *(_DWORD *)(a1 + 104) = 0;
  v5 = &v9 + 4 * *(_DWORD *)(a1 + 104);
  v6 = a1 + 84;
  *(_DWORD *)v6 = *v5;
  *(_DWORD *)(v6 + 4) = v5[1];
  *(_DWORD *)(v6 + 8) = v5[2];
  result = v5[3];
  *(_DWORD *)(v6 + 12) = result;
  return result;
}

//----- (0044CA60) --------------------------------------------------------
int __cdecl NPC185(int a1)
{
  int result; // eax@11

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) += 4096;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) |= 8u;
      goto LABEL_4;
    case 0xB:
LABEL_4:
      switch ( *(_DWORD *)(a1 + 76) )
      {
        case 0:
          *(_DWORD *)(a1 + 8) -= 128;
          break;
        case 1:
          *(_DWORD *)(a1 + 12) -= 128;
          break;
        case 2:
          *(_DWORD *)(a1 + 8) += 128;
          break;
        case 3:
          *(_DWORD *)(a1 + 12) += 128;
          break;
        default:
          break;
      }
      ++*(_DWORD *)(a1 + 120);
      break;
    case 0x14:
      *(_DWORD *)(a1 + 12) -= 12288;
      *(_DWORD *)(a1 + 116) = 1;
      break;
    default:
      break;
  }
  result = a1 + 84;
  *(_DWORD *)result = 96;
  *(_DWORD *)(result + 4) = 64;
  *(_DWORD *)(result + 8) = 112;
  *(_DWORD *)(result + 12) = 96;
  return result;
}

//----- (0044CBE0) --------------------------------------------------------
int __cdecl NPC186(int a1)
{
  int *v1; // eax@17
  int v2; // ecx@17
  int result; // eax@17
  int v4; // [sp+4h] [bp-44h]@1
  int v5; // [sp+8h] [bp-40h]@1
  int v6; // [sp+Ch] [bp-3Ch]@1
  int v7; // [sp+10h] [bp-38h]@1
  int v8; // [sp+14h] [bp-34h]@1
  int v9; // [sp+18h] [bp-30h]@1
  int v10; // [sp+1Ch] [bp-2Ch]@1
  int v11; // [sp+20h] [bp-28h]@1
  int v12; // [sp+24h] [bp-24h]@1
  int v13; // [sp+28h] [bp-20h]@1
  int v14; // [sp+2Ch] [bp-1Ch]@1
  int v15; // [sp+30h] [bp-18h]@1
  int v16; // [sp+34h] [bp-14h]@1
  int v17; // [sp+38h] [bp-10h]@1
  int v18; // [sp+3Ch] [bp-Ch]@1
  int v19; // [sp+40h] [bp-8h]@1
  int v20; // [sp+44h] [bp-4h]@1

  v5 = 48;
  v6 = 48;
  v7 = 64;
  v8 = 64;
  v9 = 64;
  v10 = 48;
  v11 = 80;
  v12 = 64;
  v13 = 80;
  v14 = 48;
  v15 = 96;
  v16 = 64;
  v17 = 64;
  v18 = 48;
  v19 = 80;
  v20 = 64;
  v4 = *(_DWORD *)(a1 + 116);
  if ( !v4 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    goto LABEL_13;
  }
  if ( v4 == 10 )
  {
    *(_DWORD *)(a1 + 116) = 11;
    *(_DWORD *)(a1 + 104) = 1;
    *(_DWORD *)(a1 + 120) = 0;
    *(_WORD *)(a1 + 80) |= 8u;
  }
  else if ( v4 != 11 )
  {
    goto LABEL_13;
  }
  switch ( *(_DWORD *)(a1 + 76) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) -= 128;
      break;
    case 1:
      *(_DWORD *)(a1 + 12) -= 128;
      break;
    case 2:
      *(_DWORD *)(a1 + 8) += 128;
      break;
    case 3:
      *(_DWORD *)(a1 + 12) += 128;
      break;
    default:
      break;
  }
  ++*(_DWORD *)(a1 + 120);
LABEL_13:
  if ( ++*(_DWORD *)(a1 + 100) > 10 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 3 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0044CDB0) --------------------------------------------------------
LONG *__cdecl NPC187(NPC_vars *a1)
{
  int *v1; // edx@26
  LONG *result; // eax@26
  int *v3; // edx@27
  int v4; // [sp+0h] [bp-48h]@1
  int v5; // [sp+4h] [bp-44h]@21
  int v6; // [sp+8h] [bp-40h]@21
  int v7; // [sp+Ch] [bp-3Ch]@21
  int v8; // [sp+10h] [bp-38h]@21
  int v9; // [sp+14h] [bp-34h]@21
  int v10; // [sp+18h] [bp-30h]@21
  int v11; // [sp+1Ch] [bp-2Ch]@21
  int v12; // [sp+20h] [bp-28h]@21
  int v13; // [sp+24h] [bp-24h]@21
  int v14; // [sp+28h] [bp-20h]@21
  int v15; // [sp+2Ch] [bp-1Ch]@21
  int v16; // [sp+30h] [bp-18h]@21
  int v17; // [sp+34h] [bp-14h]@21
  int v18; // [sp+38h] [bp-10h]@21
  int v19; // [sp+3Ch] [bp-Ch]@21
  int v20; // [sp+40h] [bp-8h]@21
  int i; // [sp+44h] [bp-4h]@5

  v4 = a1->Current_State;
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 )
      {
        a1->count1 += 4;
        if ( Quote.X_Pos >= a1->X_pos )
          a1->Direction = 2;
        else
          a1->Direction = 0;
        if ( a1->Curly_Target_Y < a1->Y_pos )
          a1->Y_vel -= 16;
        if ( a1->Curly_Target_Y > a1->Y_pos )
          a1->Y_vel += 16;
        if ( a1->Y_vel > 853 )
          a1->Y_vel = 853;
        if ( a1->Y_vel < -853 )
          a1->Y_vel = -853;
      }
      goto LABEL_21;
    }
  }
  else
  {
    a1->Current_State = 1;
    a1->Curly_Target_X = a1->X_pos;
    a1->Curly_Target_Y = a1->Y_pos;
    a1->count1 = 120;
    a1->Wait_Timer = Random(0, 50);
    for ( i = 0; i < 5; ++i )
      NPC_Create((NPC_Names)188, 0, 0, 0, 0, (Directions)(51 * i), a1, 256);
  }
  if ( ++a1->Wait_Timer >= 50 )
  {
    a1->Wait_Timer = 0;
    a1->Current_State = 2;
    a1->Y_vel = 768;
  }
LABEL_21:
  a1->X_pos += a1->X_vel;
  a1->Y_pos += a1->Y_vel;
  v13 = 224;
  v14 = 104;
  v15 = 256;
  v16 = 136;
  v17 = 256;
  v18 = 104;
  v19 = 288;
  v20 = 136;
  v5 = 224;
  v6 = 136;
  v7 = 256;
  v8 = 168;
  v9 = 256;
  v10 = 136;
  v11 = 288;
  v12 = 168;
  if ( ++a1->ani_wait > 2 )
  {
    a1->ani_wait = 0;
    ++a1->Ani_Num;
  }
  if ( a1->Ani_Num > 1 )
    a1->Ani_Num = 0;
  if ( a1->Direction )
  {
    v3 = &v5 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v3;
    result[1] = v3[1];
    result[2] = v3[2];
    result[3] = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v1;
    result[1] = v1[1];
    result[2] = v1[2];
    result[3] = v1[3];
  }
  return result;
}

//----- (0044D070) --------------------------------------------------------
int __cdecl NPC188(int a1)
{
  int v1; // esi@8
  int v2; // esi@8
  int *v3; // edx@34
  int result; // eax@34
  int *v5; // edx@35
  int v6; // [sp+0h] [bp-48h]@1
  int v7; // [sp+4h] [bp-44h]@33
  int v8; // [sp+8h] [bp-40h]@33
  int v9; // [sp+Ch] [bp-3Ch]@33
  int v10; // [sp+10h] [bp-38h]@33
  int v11; // [sp+14h] [bp-34h]@33
  int v12; // [sp+18h] [bp-30h]@33
  int v13; // [sp+1Ch] [bp-2Ch]@33
  int v14; // [sp+20h] [bp-28h]@33
  int v15; // [sp+24h] [bp-24h]@33
  int v16; // [sp+28h] [bp-20h]@33
  int v17; // [sp+2Ch] [bp-1Ch]@33
  int v18; // [sp+30h] [bp-18h]@33
  int v19; // [sp+34h] [bp-14h]@33
  int v20; // [sp+38h] [bp-10h]@33
  int v21; // [sp+3Ch] [bp-Ch]@33
  int v22; // [sp+40h] [bp-8h]@33
  unsigned __int8 v23; // [sp+47h] [bp-1h]@8

  v6 = *(_DWORD *)(a1 + 116);
  if ( !v6 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 108) = *(_DWORD *)(a1 + 76);
    goto LABEL_6;
  }
  if ( v6 == 1 )
  {
LABEL_6:
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 40) == 187 && **(_BYTE **)(a1 + 168) & 0x80 )
    {
      v23 = *(_BYTE *)(a1 + 108) + *(_BYTE *)(*(_DWORD *)(a1 + 168) + 108);
      v1 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v1 + 8) + 20 * GetSin(v23);
      v2 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(v2 + 12) + 32 * GetCos(v23);
    }
    else
    {
      *(_DWORD *)(a1 + 16) = Random(-512, 512);
      *(_DWORD *)(a1 + 20) = Random(-512, 512);
      *(_DWORD *)(a1 + 116) = 10;
    }
    goto LABEL_26;
  }
  if ( v6 == 10 )
  {
    if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 16) += 32;
    else
      *(_DWORD *)(a1 + 16) -= 32;
    if ( Quote.Y_Pos >= *(_DWORD *)(a1 + 12) )
      *(_DWORD *)(a1 + 20) += 32;
    else
      *(_DWORD *)(a1 + 20) -= 32;
    if ( *(_DWORD *)(a1 + 16) > 2048 )
      *(_DWORD *)(a1 + 16) = 2048;
    if ( *(_DWORD *)(a1 + 16) < -2048 )
      *(_DWORD *)(a1 + 16) = -2048;
    if ( *(_DWORD *)(a1 + 20) > 512 )
      *(_DWORD *)(a1 + 20) = 512;
    if ( *(_DWORD *)(a1 + 20) < -512 )
      *(_DWORD *)(a1 + 20) = -512;
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  }
LABEL_26:
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  v15 = 288;
  v16 = 104;
  v17 = 304;
  v18 = 120;
  v19 = 304;
  v20 = 104;
  v21 = 320;
  v22 = 120;
  v7 = 288;
  v8 = 120;
  v9 = 304;
  v10 = 136;
  v11 = 304;
  v12 = 120;
  v13 = 320;
  v14 = 136;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v5;
    *(_DWORD *)(result + 4) = v5[1];
    *(_DWORD *)(result + 8) = v5[2];
    *(_DWORD *)(result + 12) = v5[3];
  }
  else
  {
    v3 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  return result;
}

//----- (0044D3A0) --------------------------------------------------------
int __cdecl NPC189(int a1)
{
  int *v1; // ecx@31
  int v2; // edx@31
  int result; // eax@31
  int v4; // [sp+0h] [bp-34h]@1
  int v5; // [sp+4h] [bp-30h]@31
  int v6; // [sp+8h] [bp-2Ch]@31
  int v7; // [sp+Ch] [bp-28h]@31
  int v8; // [sp+10h] [bp-24h]@31
  int v9; // [sp+14h] [bp-20h]@31
  int v10; // [sp+18h] [bp-1Ch]@31
  int v11; // [sp+1Ch] [bp-18h]@31
  int v12; // [sp+20h] [bp-14h]@31
  int v13; // [sp+24h] [bp-10h]@31
  int v14; // [sp+28h] [bp-Ch]@31
  int v15; // [sp+2Ch] [bp-8h]@31
  int v16; // [sp+30h] [bp-4h]@31

  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 10 )
      {
        if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
          *(_DWORD *)(a1 + 16) += 8;
        else
          *(_DWORD *)(a1 + 16) -= 8;
        if ( Quote.Y_Pos >= *(_DWORD *)(a1 + 12) )
          *(_DWORD *)(a1 + 20) += 8;
        else
          *(_DWORD *)(a1 + 20) -= 8;
        if ( *(_DWORD *)(a1 + 16) > 1024 )
          *(_DWORD *)(a1 + 16) = 1024;
        if ( *(_DWORD *)(a1 + 16) < -1024 )
          *(_DWORD *)(a1 + 16) = -1024;
        if ( *(_DWORD *)(a1 + 20) > 1024 )
          *(_DWORD *)(a1 + 20) = 1024;
        if ( *(_DWORD *)(a1 + 20) < -1024 )
          *(_DWORD *)(a1 + 20) = -1024;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      }
      goto LABEL_24;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 16) = -64;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( ++*(_DWORD *)(a1 + 120) > 256 )
    *(_DWORD *)(a1 + 116) = 10;
LABEL_24:
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v5 = 224;
  v6 = 184;
  v7 = 232;
  v8 = 200;
  v9 = 232;
  v10 = 184;
  v11 = 240;
  v12 = 200;
  v13 = 240;
  v14 = 184;
  v15 = 248;
  v16 = 200;
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0044D5E0) --------------------------------------------------------
int __cdecl NPC190(int a1)
{
  int v1; // ST10_4@8
  int v2; // ST0C_4@8
  int v3; // eax@8
  int *v4; // edx@14
  int result; // eax@14
  int v6; // [sp+0h] [bp-28h]@1
  signed int i; // [sp+4h] [bp-24h]@6
  int v8; // [sp+8h] [bp-20h]@1
  int v9; // [sp+Ch] [bp-1Ch]@1
  int v10; // [sp+10h] [bp-18h]@1
  int v11; // [sp+14h] [bp-14h]@1
  int v12; // [sp+18h] [bp-10h]@1
  int v13; // [sp+1Ch] [bp-Ch]@1
  int v14; // [sp+20h] [bp-8h]@1
  int v15; // [sp+24h] [bp-4h]@1

  v8 = 192;
  v9 = 32;
  v10 = 208;
  v11 = 48;
  v12 = 208;
  v13 = 32;
  v14 = 224;
  v15 = 48;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 == 10 )
    {
      Play_Sound_Effect(Sfx_Explosion, 1);
      for ( i = 0; i < 8; ++i )
      {
        v1 = Random(-3, 3) << 9;
        v2 = Random(-8, -2) << 9;
        v3 = Random(-8, 8);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v3 << 9), v2, v1, 0, NULL, 256);
      }
      *(_BYTE *)a1 = 0;
    }
    else if ( v6 == 20 )
    {
      if ( ++*(_DWORD *)(a1 + 100) > 10 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 104) = 0;
  }
  v4 = &v8 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v4;
  *(_DWORD *)(result + 4) = v4[1];
  *(_DWORD *)(result + 8) = v4[2];
  *(_DWORD *)(result + 12) = v4[3];
  return result;
}

//----- (0044D740) --------------------------------------------------------
int __cdecl NPC191(int a1, int a2, int a3, int a4)
{
  int result; // eax@41

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 20) = 512;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
        *(_DWORD *)(a1 + 20) -= 4;
      else
        *(_DWORD *)(a1 + 20) += 4;
      if ( *(_DWORD *)(a1 + 20) < -256 )
        *(_DWORD *)(a1 + 20) = -256;
      if ( *(_DWORD *)(a1 + 20) > 256 )
        *(_DWORD *)(a1 + 20) = 256;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_12;
    case 0x15:
LABEL_12:
      if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
        *(_DWORD *)(a1 + 20) -= 4;
      else
        *(_DWORD *)(a1 + 20) += 4;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 20) = 512;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( ++*(_DWORD *)(a1 + 120) > 1000 )
        *(_DWORD *)(a1 + 116) = 22;
      break;
    case 0x16:
      if ( *(_DWORD *)(a1 + 12) >= 0 )
        *(_DWORD *)(a1 + 20) -= 4;
      else
        *(_DWORD *)(a1 + 20) += 4;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 20) = 512;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 12) < 0x8000 || Curly_Shoot_Y )
      {
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x1E:
      if ( *(_DWORD *)(a1 + 12) >= 0 )
        *(_DWORD *)(a1 + 20) -= 4;
      else
        *(_DWORD *)(a1 + 20) += 4;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      if ( *(_DWORD *)(a1 + 20) > 256 )
        *(_DWORD *)(a1 + 20) = 256;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      break;
    default:
      break;
  }
  result = *(_DWORD *)(a1 + 12);
  GlobalWaterDepth = *(_DWORD *)(a1 + 12);
  *(_DWORD *)(a1 + 92) = 0;
  *(_DWORD *)(a1 + 96) = 0;
  return result;
}
// 499C90: using guessed type int GlobalWaterDepth;
// 4BBA28: using guessed type int Curly_Shoot_Y;

//----- (0044DA00) --------------------------------------------------------
int __cdecl NPC192(int a1)
{
  int *v1; // eax@23
  int v2; // ecx@23
  int result; // eax@23
  int *v4; // eax@24
  int v5; // ecx@24
  int v6; // [sp+4h] [bp-40h]@22
  int v7; // [sp+8h] [bp-3Ch]@22
  int v8; // [sp+Ch] [bp-38h]@22
  int v9; // [sp+10h] [bp-34h]@22
  int v10; // [sp+14h] [bp-30h]@22
  int v11; // [sp+18h] [bp-2Ch]@22
  int v12; // [sp+1Ch] [bp-28h]@22
  int v13; // [sp+20h] [bp-24h]@22
  int v14; // [sp+24h] [bp-20h]@22
  int v15; // [sp+28h] [bp-1Ch]@22
  int v16; // [sp+2Ch] [bp-18h]@22
  int v17; // [sp+30h] [bp-14h]@22
  int v18; // [sp+34h] [bp-10h]@22
  int v19; // [sp+38h] [bp-Ch]@22
  int v20; // [sp+3Ch] [bp-8h]@22
  int v21; // [sp+40h] [bp-4h]@22

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 148) = 0x2000;
      *(_DWORD *)(a1 + 140) = 0x2000;
      *(_DWORD *)(a1 + 144) = 4096;
      *(_DWORD *)(a1 + 152) = 4096;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 144) = 0x2000;
      *(_DWORD *)(a1 + 152) = 0x2000;
      *(_DWORD *)(a1 + 12) -= 2560;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 1;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      goto LABEL_5;
    case 0x15:
LABEL_5:
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + (Random(-1, 1) << 9);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36) + (Random(-1, 1) << 9);
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 30;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 1;
      *(_DWORD *)(a1 + 16) = -2048;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36);
      Play_Sound_Effect(Sfx_Missile_Impact, 1);
      goto LABEL_9;
    case 0x1F:
LABEL_9:
      *(_DWORD *)(a1 + 16) += 32;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      ++*(_DWORD *)(a1 + 120);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36) + (Random(-1, 1) << 9);
      if ( *(_DWORD *)(a1 + 120) > 10 )
        *(_DWORD *)(a1 + 76) = 2;
      if ( *(_DWORD *)(a1 + 120) > 200 )
        *(_DWORD *)(a1 + 116) = 40;
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      *(_DWORD *)(a1 + 120) = 2;
      *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 12) -= 24576;
      *(_DWORD *)(a1 + 16) = -4096;
      goto LABEL_15;
    case 0x29:
LABEL_15:
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      *(_DWORD *)(a1 + 120) += 2;
      if ( *(_DWORD *)(a1 + 120) > 1200 )
        *(_BYTE *)a1 = 0;
      break;
    default:
      break;
  }
  if ( !(*(_DWORD *)(a1 + 120) % 4) && *(_DWORD *)(a1 + 116) >= 20 )
  {
    Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
    if ( *(_DWORD *)(a1 + 76) )
      Create_Effect(*(_DWORD *)(a1 + 8) - 5120, *(_DWORD *)(a1 + 12) + 5120, 7, 0);
    else
      Create_Effect(*(_DWORD *)(a1 + 8) + 5120, *(_DWORD *)(a1 + 12) + 5120, 7, 2);
  }
  v14 = 224;
  v15 = 64;
  v16 = 256;
  v17 = 80;
  v18 = 256;
  v19 = 64;
  v20 = 288;
  v21 = 96;
  v6 = 224;
  v7 = 80;
  v8 = 256;
  v9 = 96;
  v10 = 288;
  v11 = 64;
  v12 = 320;
  v13 = 96;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v14 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (0044DE20) --------------------------------------------------------
int __cdecl NPC193(int a1)
{
  int result; // eax@3

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 8) += 12288;
  }
  result = a1 + 84;
  *(_DWORD *)result = 256;
  *(_DWORD *)(result + 4) = 96;
  *(_DWORD *)(result + 8) = 320;
  *(_DWORD *)(result + 12) = 112;
  return result;
}

//----- (0044DEA0) --------------------------------------------------------
signed int __cdecl NPC194(int a1)
{
  int v1; // edx@3
  signed int result; // eax@3

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) += 2048;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 192;
  *(_DWORD *)(v1 + 4) = 120;
  result = 224;
  *(_DWORD *)(v1 + 8) = 224;
  *(_DWORD *)(v1 + 12) = 128;
  return result;
}

//----- (0044DF10) --------------------------------------------------------
int __cdecl NPC195(int a1)
{
  int result; // eax@1

  result = a1 + 84;
  *(_DWORD *)result = 112;
  *(_DWORD *)(result + 4) = 64;
  *(_DWORD *)(result + 8) = 128;
  *(_DWORD *)(result + 12) = 80;
  return result;
}

//----- (0044DF60) --------------------------------------------------------
signed int __cdecl NPC196(int a1)
{
  int v1; // edx@4
  signed int result; // eax@4
  int v3; // edx@5

  *(_DWORD *)(a1 + 8) -= 3072;
  if ( *(_DWORD *)(a1 + 8) <= 155648 )
    *(_DWORD *)(a1 + 8) += 180224;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 112;
    *(_DWORD *)(v3 + 4) = 80;
    result = 144;
    *(_DWORD *)(v3 + 8) = 144;
    *(_DWORD *)(v3 + 12) = 96;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 112;
    *(_DWORD *)(v1 + 4) = 64;
    result = 144;
    *(_DWORD *)(v1 + 8) = 144;
    *(_DWORD *)(v1 + 12) = 80;
  }
  return result;
}

//----- (0044E020) --------------------------------------------------------
int __cdecl NPC197(void *Is_NPC_Alive)
{
  int *v1; // ecx@23
  char *v2; // edx@23
  int result; // eax@23
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 16;
  v10 = 0;
  v11 = 32;
  v12 = 16;
  v13 = 32;
  v14 = 0;
  v15 = 48;
  v16 = 16;
  v17 = 48;
  v18 = 0;
  v19 = 64;
  v20 = 16;
  v4 = *((_DWORD *)Is_NPC_Alive + 29);
  if ( v4 )
  {
    if ( v4 != 10 )
    {
      if ( v4 == 20 )
      {
        *((_DWORD *)Is_NPC_Alive + 41) = 3;
        if ( ++*((_DWORD *)Is_NPC_Alive + 25) > 0 )
        {
          *((_DWORD *)Is_NPC_Alive + 25) = 0;
          ++*((_DWORD *)Is_NPC_Alive + 26);
        }
        if ( *((_DWORD *)Is_NPC_Alive + 26) > 3 )
          *((_DWORD *)Is_NPC_Alive + 26) = 2;
        if ( *((_DWORD *)Is_NPC_Alive + 2) < 24576 )
        {
          *((_DWORD *)Is_NPC_Alive + 15) = 0;
          NPC_Death_Maybe(Is_NPC_Alive, 1);
        }
      }
      goto LABEL_19;
    }
  }
  else
  {
    *((_DWORD *)Is_NPC_Alive + 29) = 10;
    *((_DWORD *)Is_NPC_Alive + 25) = 0;
    *((_DWORD *)Is_NPC_Alive + 5) = Random(-512, 512);
    *((_DWORD *)Is_NPC_Alive + 4) = 2048;
  }
  if ( ++*((_DWORD *)Is_NPC_Alive + 25) > 2 )
  {
    *((_DWORD *)Is_NPC_Alive + 25) = 0;
    ++*((_DWORD *)Is_NPC_Alive + 26);
  }
  if ( *((_DWORD *)Is_NPC_Alive + 26) > 1 )
    *((_DWORD *)Is_NPC_Alive + 26) = 0;
  if ( *((_DWORD *)Is_NPC_Alive + 4) < 0 )
  {
    *((_DWORD *)Is_NPC_Alive + 41) = 3;
    *((_DWORD *)Is_NPC_Alive + 29) = 20;
  }
LABEL_19:
  if ( *((_DWORD *)Is_NPC_Alive + 1) & 2 )
    *((_DWORD *)Is_NPC_Alive + 5) = 512;
  if ( *((_DWORD *)Is_NPC_Alive + 1) & 8 )
    *((_DWORD *)Is_NPC_Alive + 5) = -512;
  *((_DWORD *)Is_NPC_Alive + 4) -= 12;
  *((_DWORD *)Is_NPC_Alive + 2) += *((_DWORD *)Is_NPC_Alive + 4);
  *((_DWORD *)Is_NPC_Alive + 3) += *((_DWORD *)Is_NPC_Alive + 5);
  v1 = &v5 + 4 * *((_DWORD *)Is_NPC_Alive + 26);
  v2 = (char *)Is_NPC_Alive + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  return result;
}

//----- (0044E260) --------------------------------------------------------
void __cdecl NPC198(int a1)
{
  int *v1; // eax@12
  int v2; // ecx@12
  int v3; // [sp+0h] [bp-34h]@1
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 208;
  v5 = 48;
  v6 = 224;
  v7 = 72;
  v8 = 224;
  v9 = 48;
  v10 = 240;
  v11 = 72;
  v12 = 240;
  v13 = 48;
  v14 = 256;
  v15 = 72;
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 == 1 )
      *(_DWORD *)(a1 + 16) += 32;
  }
  else if ( ++*(_DWORD *)(a1 + 120) > 20 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 16) = 0;
    *(_DWORD *)(a1 + 20) = 0;
    *(_DWORD *)(a1 + 108) = 0;
  }
  if ( ++*(_DWORD *)(a1 + 100) > 0 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( ++*(_DWORD *)(a1 + 108) > 100 )
    *(_BYTE *)a1 = 0;
  if ( *(_DWORD *)(a1 + 108) % 4 == 1 )
    Play_Sound_Effect(Sfx_Iron_Head_Shot, 1);
}

//----- (0044E400) --------------------------------------------------------
int __cdecl NPC199(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int v3; // [sp+8h] [bp-50h]@1
  int v4; // [sp+Ch] [bp-4Ch]@1
  int v5; // [sp+10h] [bp-48h]@1
  int v6; // [sp+14h] [bp-44h]@1
  int v7; // [sp+18h] [bp-40h]@1
  int v8; // [sp+1Ch] [bp-3Ch]@1
  int v9; // [sp+20h] [bp-38h]@1
  int v10; // [sp+24h] [bp-34h]@1
  int v11; // [sp+28h] [bp-30h]@1
  int v12; // [sp+2Ch] [bp-2Ch]@1
  int v13; // [sp+30h] [bp-28h]@1
  int v14; // [sp+34h] [bp-24h]@1
  int v15; // [sp+38h] [bp-20h]@1
  int v16; // [sp+3Ch] [bp-1Ch]@1
  int v17; // [sp+40h] [bp-18h]@1
  int v18; // [sp+44h] [bp-14h]@1
  int v19; // [sp+48h] [bp-10h]@1
  int v20; // [sp+4Ch] [bp-Ch]@1
  int v21; // [sp+50h] [bp-8h]@1
  int v22; // [sp+54h] [bp-4h]@1

  v3 = 72;
  v4 = 16;
  v5 = 74;
  v6 = 18;
  v7 = 74;
  v8 = 16;
  v9 = 76;
  v10 = 18;
  v11 = 76;
  v12 = 16;
  v13 = 78;
  v14 = 18;
  v15 = 78;
  v16 = 16;
  v17 = 80;
  v18 = 18;
  v19 = 80;
  v20 = 16;
  v21 = 82;
  v22 = 18;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = Random(0, 2);
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        *(_DWORD *)(a1 + 16) = -1;
        break;
      case 1:
        *(_DWORD *)(a1 + 20) = -1;
        break;
      case 2:
        *(_DWORD *)(a1 + 16) = 1;
        break;
      case 3:
        *(_DWORD *)(a1 + 20) = 1;
        break;
      default:
        break;
    }
    *(_DWORD *)(a1 + 16) *= (Random(4, 8) << 9) / 2;
    *(_DWORD *)(a1 + 20) *= (Random(4, 8) << 9) / 2;
  }
  if ( ++*(_DWORD *)(a1 + 100) > 6 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 4 )
    *(_BYTE *)a1 = 0;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0044E5F0) --------------------------------------------------------
int __cdecl NPC200(int a1)
{
  int *v1; // ecx@43
  int v2; // edx@43
  int result; // eax@43
  int *v4; // ecx@44
  int v5; // edx@44
  int Y_Vel; // [sp+4h] [bp-D4h]@33
  int v7; // [sp+8h] [bp-D0h]@1
  int v8; // [sp+Ch] [bp-CCh]@1
  int v9; // [sp+10h] [bp-C8h]@1
  int v10; // [sp+14h] [bp-C4h]@1
  int v11; // [sp+18h] [bp-C0h]@1
  int v12; // [sp+1Ch] [bp-BCh]@1
  int v13; // [sp+20h] [bp-B8h]@1
  int v14; // [sp+24h] [bp-B4h]@1
  int v15; // [sp+28h] [bp-B0h]@1
  int v16; // [sp+2Ch] [bp-ACh]@1
  int v17; // [sp+30h] [bp-A8h]@1
  int v18; // [sp+34h] [bp-A4h]@1
  int v19; // [sp+38h] [bp-A0h]@1
  int v20; // [sp+3Ch] [bp-9Ch]@1
  int v21; // [sp+40h] [bp-98h]@1
  int v22; // [sp+44h] [bp-94h]@1
  int v23; // [sp+48h] [bp-90h]@1
  int v24; // [sp+4Ch] [bp-8Ch]@1
  int v25; // [sp+50h] [bp-88h]@1
  int v26; // [sp+54h] [bp-84h]@1
  int v27; // [sp+58h] [bp-80h]@1
  int v28; // [sp+5Ch] [bp-7Ch]@1
  int v29; // [sp+60h] [bp-78h]@1
  int v30; // [sp+64h] [bp-74h]@1
  int X_Vel; // [sp+6Ch] [bp-6Ch]@33
  int v32; // [sp+70h] [bp-68h]@1
  int v33; // [sp+74h] [bp-64h]@1
  int v34; // [sp+78h] [bp-60h]@1
  int v35; // [sp+7Ch] [bp-5Ch]@1
  int v36; // [sp+80h] [bp-58h]@1
  int v37; // [sp+84h] [bp-54h]@1
  int v38; // [sp+88h] [bp-50h]@1
  int v39; // [sp+8Ch] [bp-4Ch]@1
  int v40; // [sp+90h] [bp-48h]@1
  int v41; // [sp+94h] [bp-44h]@1
  int v42; // [sp+98h] [bp-40h]@1
  int v43; // [sp+9Ch] [bp-3Ch]@1
  int v44; // [sp+A0h] [bp-38h]@1
  int v45; // [sp+A4h] [bp-34h]@1
  int v46; // [sp+A8h] [bp-30h]@1
  int v47; // [sp+ACh] [bp-2Ch]@1
  int v48; // [sp+B0h] [bp-28h]@1
  int v49; // [sp+B4h] [bp-24h]@1
  int v50; // [sp+B8h] [bp-20h]@1
  int v51; // [sp+BCh] [bp-1Ch]@1
  int v52; // [sp+C0h] [bp-18h]@1
  int v53; // [sp+C4h] [bp-14h]@1
  int v54; // [sp+C8h] [bp-10h]@1
  int v55; // [sp+CCh] [bp-Ch]@1
  unsigned __int8 v56; // [sp+D7h] [bp-1h]@31

  v32 = 0;
  v33 = 0;
  v34 = 40;
  v35 = 40;
  v36 = 40;
  v37 = 0;
  v38 = 80;
  v39 = 40;
  v40 = 80;
  v41 = 0;
  v42 = 120;
  v43 = 40;
  v44 = 120;
  v45 = 0;
  v46 = 160;
  v47 = 40;
  v48 = 160;
  v49 = 0;
  v50 = 200;
  v51 = 40;
  v52 = 200;
  v53 = 0;
  v54 = 240;
  v55 = 40;
  v7 = 0;
  v8 = 40;
  v9 = 40;
  v10 = 80;
  v11 = 40;
  v12 = 40;
  v13 = 80;
  v14 = 80;
  v15 = 80;
  v16 = 40;
  v17 = 120;
  v18 = 80;
  v19 = 120;
  v20 = 40;
  v21 = 160;
  v22 = 80;
  v23 = 160;
  v24 = 40;
  v25 = 200;
  v26 = 80;
  v27 = 200;
  v28 = 40;
  v29 = 240;
  v30 = 80;
  if ( *(_DWORD *)(a1 + 116) < 100 && *(_DWORD *)(a1 + 64) < 950 )
  {
    Play_Sound_Effect(Sfx_Explosion, 1);
    Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 8);
    Spawn_Exp(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 68));
    *(_DWORD *)(a1 + 116) = 100;
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_DWORD *)(a1 + 164) = 0;
  }
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( ++*(_DWORD *)(a1 + 100) > 30 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 108) )
        --*(_DWORD *)(a1 + 108);
      if ( !*(_DWORD *)(a1 + 108)
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 57344
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 57344 )
      {
        *(_DWORD *)(a1 + 116) = 20;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_18;
    case 0x15:
LABEL_18:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 2;
      else
        *(_DWORD *)(a1 + 104) = 3;
      if ( *(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 30;
      if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 4;
      *(_DWORD *)(a1 + 32) = Quote.X_Pos;
      *(_DWORD *)(a1 + 36) = Quote.Y_Pos;
      goto LABEL_28;
    case 0x1F:
LABEL_28:
      if ( ++*(_DWORD *)(a1 + 120) < 40 && *(_DWORD *)(a1 + 120) % 8 == 1 )
      {
        v56 = *(_DWORD *)(a1 + 76) ? GetArcTan(
                                       *(_DWORD *)(a1 + 8) + 7168 - *(_DWORD *)(a1 + 32),
                                       *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 36)) : GetArcTan(
                                                                                        *(_DWORD *)(a1 + 8)
                                                                                      - 7168
                                                                                      - *(_DWORD *)(a1 + 32),
                                                                                        *(_DWORD *)(a1 + 12)
                                                                                      - *(_DWORD *)(a1 + 36));
        v56 += Random(-6, 6);
        Y_Vel = 3 * GetSin(v56);
        X_Vel = 3 * GetCos(v56);
        if ( *(_DWORD *)(a1 + 76) )
          NPC_Create((NPC_Names)202, *(_DWORD *)(a1 + 8) + 7168, *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
        else
          NPC_Create((NPC_Names)202, *(_DWORD *)(a1 + 8) - 7168, *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
        if ( !(Quote.Flags & 2) )
          Play_Sound_Effect(Sfx_Fireball_Shoot, 1);
      }
      if ( *(_DWORD *)(a1 + 120) > 60 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 108) = Random(100, 200);
        *(_DWORD *)(a1 + 100) = 0;
      }
      break;
    case 0x64:
      *(_DWORD *)(a1 + 104) = 5;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v32 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (0044EC40) --------------------------------------------------------
int __cdecl NPC201(int a1)
{
  int *v1; // eax@2
  int v2; // ecx@2
  int result; // eax@2
  int *v4; // eax@3
  int v5; // ecx@3
  int v6; // [sp+0h] [bp-20h]@1
  int v7; // [sp+4h] [bp-1Ch]@1
  int v8; // [sp+8h] [bp-18h]@1
  int v9; // [sp+Ch] [bp-14h]@1
  int v10; // [sp+10h] [bp-10h]@1
  int v11; // [sp+14h] [bp-Ch]@1
  int v12; // [sp+18h] [bp-8h]@1
  int v13; // [sp+1Ch] [bp-4h]@1

  v10 = 200;
  v11 = 0;
  v12 = 240;
  v13 = 40;
  v6 = 200;
  v7 = 40;
  v8 = 240;
  v9 = 80;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v10 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (0044ECE0) --------------------------------------------------------
void __cdecl NPC202(int a1)
{
  int *v1; // eax@7
  int v2; // ecx@7
  int v3; // [sp+0h] [bp-30h]@3
  int v4; // [sp+4h] [bp-2Ch]@3
  int v5; // [sp+8h] [bp-28h]@3
  int v6; // [sp+Ch] [bp-24h]@3
  int v7; // [sp+10h] [bp-20h]@3
  int v8; // [sp+14h] [bp-1Ch]@3
  int v9; // [sp+18h] [bp-18h]@3
  int v10; // [sp+1Ch] [bp-14h]@3
  int v11; // [sp+20h] [bp-10h]@3
  int v12; // [sp+24h] [bp-Ch]@3
  int v13; // [sp+28h] [bp-8h]@3
  int v14; // [sp+2Ch] [bp-4h]@3

  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v3 = 184;
  v4 = 216;
  v5 = 200;
  v6 = 240;
  v7 = 200;
  v8 = 216;
  v9 = 216;
  v10 = 240;
  v11 = 216;
  v12 = 216;
  v13 = 232;
  v14 = 240;
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( ++*(_DWORD *)(a1 + 108) > 300 )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
  }
}

//----- (0044EE40) --------------------------------------------------------
int __cdecl NPC203(int a1)
{
  int *v1; // edx@37
  int result; // eax@37
  int *v3; // edx@38
  int v4; // [sp+4h] [bp-60h]@1
  int v5; // [sp+8h] [bp-5Ch]@1
  int v6; // [sp+Ch] [bp-58h]@1
  int v7; // [sp+10h] [bp-54h]@1
  int v8; // [sp+14h] [bp-50h]@1
  int v9; // [sp+18h] [bp-4Ch]@1
  int v10; // [sp+1Ch] [bp-48h]@1
  int v11; // [sp+20h] [bp-44h]@1
  int v12; // [sp+24h] [bp-40h]@1
  int v13; // [sp+28h] [bp-3Ch]@1
  int v14; // [sp+2Ch] [bp-38h]@1
  int v15; // [sp+30h] [bp-34h]@1
  int v16; // [sp+34h] [bp-30h]@1
  int v17; // [sp+38h] [bp-2Ch]@1
  int v18; // [sp+3Ch] [bp-28h]@1
  int v19; // [sp+40h] [bp-24h]@1
  int v20; // [sp+44h] [bp-20h]@1
  int v21; // [sp+48h] [bp-1Ch]@1
  int v22; // [sp+4Ch] [bp-18h]@1
  int v23; // [sp+50h] [bp-14h]@1
  int v24; // [sp+54h] [bp-10h]@1
  int v25; // [sp+58h] [bp-Ch]@1
  int v26; // [sp+5Ch] [bp-8h]@1
  int v27; // [sp+60h] [bp-4h]@1

  v16 = 0;
  v17 = 80;
  v18 = 16;
  v19 = 96;
  v20 = 16;
  v21 = 80;
  v22 = 32;
  v23 = 96;
  v24 = 32;
  v25 = 80;
  v26 = 48;
  v27 = 96;
  v4 = 0;
  v5 = 96;
  v6 = 16;
  v7 = 112;
  v8 = 16;
  v9 = 96;
  v10 = 32;
  v11 = 112;
  v12 = 32;
  v13 = 96;
  v14 = 48;
  v15 = 112;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 12) += 1536;
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( *(_DWORD *)(a1 + 120) < 8
        || *(_DWORD *)(a1 + 8) - 57344 >= Quote.X_Pos
        || *(_DWORD *)(a1 + 8) + 57344 <= Quote.X_Pos
        || *(_DWORD *)(a1 + 12) - 40960 >= Quote.Y_Pos
        || *(_DWORD *)(a1 + 12) + 40960 <= Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 120) < 8 )
          ++*(_DWORD *)(a1 + 120);
        *(_DWORD *)(a1 + 104) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( *(_DWORD *)(a1 + 120) >= 8
        && *(_DWORD *)(a1 + 8) - 24576 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 24576 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 40960 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 24576 > Quote.Y_Pos )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 20) = -1535;
        if ( !(Quote.Flags & 2) )
          Play_Sound_Effect(Sfx_Critter_Hop, 1);
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = 256;
        else
          *(_DWORD *)(a1 + 16) = -256;
      }
      break;
    case 3:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 1;
        if ( !(Quote.Flags & 2) )
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v16 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (0044F1F0) --------------------------------------------------------
int __cdecl NPC204(int a1)
{
  int result; // eax@17
  int *v2; // edx@20
  int v3; // [sp+4h] [bp-20h]@1
  int v4; // [sp+8h] [bp-1Ch]@1
  int v5; // [sp+Ch] [bp-18h]@1
  int v6; // [sp+10h] [bp-14h]@1
  int v7; // [sp+14h] [bp-10h]@1
  int v8; // [sp+18h] [bp-Ch]@1
  int v9; // [sp+1Ch] [bp-8h]@1
  int v10; // [sp+20h] [bp-4h]@1

  v3 = 240;
  v4 = 80;
  v5 = 256;
  v6 = 96;
  v7 = 240;
  v8 = 144;
  v9 = 256;
  v10 = 160;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 6144
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 6144
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) )
      {
        *(_DWORD *)(a1 + 116) = 2;
      }
      goto LABEL_18;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) / 6 % 2 )
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) - 512;
      else
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
      if ( *(_DWORD *)(a1 + 120) > 30 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 104) = 1;
      }
      goto LABEL_18;
    case 3:
      *(_DWORD *)(a1 + 20) += 32;
      if ( !(*(_DWORD *)(a1 + 4) & 0xFF) )
        goto LABEL_18;
      if ( !(Quote.Flags & 2) )
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 4);
      *(_BYTE *)a1 = 0;
      break;
    default:
LABEL_18:
      if ( *(_DWORD *)(a1 + 20) > 3072 )
        *(_DWORD *)(a1 + 20) = 3072;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      v2 = &v3 + 4 * *(_DWORD *)(a1 + 104);
      result = a1 + 84;
      *(_DWORD *)result = *v2;
      *(_DWORD *)(result + 4) = v2[1];
      *(_DWORD *)(result + 8) = v2[2];
      *(_DWORD *)(result + 12) = v2[3];
      break;
  }
  return result;
}

//----- (0044F3E0) --------------------------------------------------------
void __cdecl NPC205(int a1)
{
  int *v1; // ecx@25
  int v2; // edx@25
  int v3; // [sp+4h] [bp-20h]@1
  int v4; // [sp+8h] [bp-1Ch]@1
  int v5; // [sp+Ch] [bp-18h]@1
  int v6; // [sp+10h] [bp-14h]@1
  int v7; // [sp+14h] [bp-10h]@1
  int v8; // [sp+18h] [bp-Ch]@1
  int v9; // [sp+1Ch] [bp-8h]@1
  int v10; // [sp+20h] [bp-4h]@1

  v3 = 112;
  v4 = 80;
  v5 = 128;
  v6 = 112;
  v7 = 128;
  v8 = 80;
  v9 = 144;
  v10 = 112;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 12) += 2048;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 6144
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 6144
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) )
      {
        *(_DWORD *)(a1 + 116) = 2;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) / 6 % 2 )
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) - 512;
      else
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
      if ( *(_DWORD *)(a1 + 120) > 30 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 3:
      *(_DWORD *)(a1 + 20) += 32;
      if ( Quote.Y_Pos <= *(_DWORD *)(a1 + 12) )
      {
        *(_WORD *)(a1 + 80) |= 0x40u;
        *(_DWORD *)(a1 + 164) = 0;
      }
      else
      {
        *(_WORD *)(a1 + 80) &= 0xFFBFu;
        *(_DWORD *)(a1 + 164) = 127;
      }
      if ( ++*(_DWORD *)(a1 + 120) <= 8 || !(*(_DWORD *)(a1 + 4) & 0xFF) )
        break;
      *(_WORD *)(a1 + 80) |= 0x40u;
      *(_DWORD *)(a1 + 116) = 4;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_DWORD *)(a1 + 164) = 0;
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 4);
      Create_Bullet(Unused_Bullet, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0);
      return;
    case 4:
      if ( ++*(_DWORD *)(a1 + 120) > 4 )
      {
        *(_DWORD *)(a1 + 116) = 5;
        *(_WORD *)(a1 + 80) |= 0x20u;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 20) > 3072 )
    *(_DWORD *)(a1 + 20) = 3072;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
}

//----- (0044F6D0) --------------------------------------------------------
int __cdecl NPC206(int a1)
{
  int *v1; // ecx@40
  int v2; // edx@40
  int result; // eax@40
  signed int v4; // [sp+0h] [bp-38h]@11
  int v5; // [sp+8h] [bp-30h]@36
  int v6; // [sp+Ch] [bp-2Ch]@36
  int v7; // [sp+10h] [bp-28h]@36
  int v8; // [sp+14h] [bp-24h]@36
  int v9; // [sp+18h] [bp-20h]@36
  int v10; // [sp+1Ch] [bp-1Ch]@36
  int v11; // [sp+20h] [bp-18h]@36
  int v12; // [sp+24h] [bp-14h]@36
  int v13; // [sp+28h] [bp-10h]@36
  int v14; // [sp+2Ch] [bp-Ch]@36
  int v15; // [sp+30h] [bp-8h]@36
  int v16; // [sp+34h] [bp-4h]@36

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 108) = 120;
      *(_DWORD *)(a1 + 120) = Random(0, 50);
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 120) >= 50 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 20) = 768;
      }
      break;
    case 2:
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 40960 && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 40960 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 3;
      }
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 3;
      }
      break;
    case 3:
      v4 = *(_DWORD *)(a1 + 120);
      if ( v4 > 180 )
      {
        if ( v4 == 240 )
        {
          NPC_Create(
            Treasure_Chest_Closed|0xC0,
            *(_DWORD *)(a1 + 8) + 0x2000,
            *(_DWORD *)(a1 + 12) + 2048,
            0,
            0,
            (Directions)4,
            NULL,
            256);
        }
        else if ( v4 == 300 )
        {
          *(_DWORD *)(a1 + 132) = 0x10000;
          *(_DWORD *)(a1 + 124) = 0x10000;
          *(_DWORD *)(a1 + 128) = 51200;
          *(_DWORD *)(a1 + 136) = 51200;
          *(_DWORD *)(a1 + 164) = 30;
          Play_Sound_Effect(Sfx_large_Explosion, 1);
          Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0x10000, 100);
          Set_Quake(20);
          *(_BYTE *)a1 |= 8u;
        }
      }
      else if ( v4 == 180 )
      {
        NPC_Create(
          Treasure_Chest_Closed|0xC0,
          *(_DWORD *)(a1 + 8) + 0x2000,
          *(_DWORD *)(a1 + 12) + 2048,
          0,
          0,
          Down,
          NULL,
          256);
      }
      else if ( v4 )
      {
        if ( v4 == 60 )
        {
          NPC_Create(
            Treasure_Chest_Closed|0xC0,
            *(_DWORD *)(a1 + 8) + 0x2000,
            *(_DWORD *)(a1 + 12) + 2048,
            0,
            0,
            Up,
            NULL,
            256);
        }
        else if ( v4 == 120 )
        {
          NPC_Create(
            Treasure_Chest_Closed|0xC0,
            *(_DWORD *)(a1 + 8) + 0x2000,
            *(_DWORD *)(a1 + 12) + 2048,
            0,
            0,
            Right,
            NULL,
            256);
        }
      }
      else
      {
        NPC_Create(
          Treasure_Chest_Closed|0xC0,
          *(_DWORD *)(a1 + 8) + 0x2000,
          *(_DWORD *)(a1 + 12) + 2048,
          0,
          0,
          0,
          NULL,
          256);
      }
      ++*(_DWORD *)(a1 + 120);
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) > 1 )
  {
    if ( *(_DWORD *)(a1 + 36) < *(_DWORD *)(a1 + 12) )
      *(_DWORD *)(a1 + 20) -= 16;
    if ( *(_DWORD *)(a1 + 36) > *(_DWORD *)(a1 + 12) )
      *(_DWORD *)(a1 + 20) += 16;
    if ( *(_DWORD *)(a1 + 20) > 256 )
      *(_DWORD *)(a1 + 20) = 256;
    if ( *(_DWORD *)(a1 + 20) < -256 )
      *(_DWORD *)(a1 + 20) = -256;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v5 = 80;
  v6 = 80;
  v7 = 120;
  v8 = 120;
  v9 = 120;
  v10 = 80;
  v11 = 160;
  v12 = 120;
  v13 = 160;
  v14 = 80;
  v15 = 200;
  v16 = 120;
  if ( ++*(_DWORD *)(a1 + 100) > 4 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0044FB40) --------------------------------------------------------
int __cdecl NPC207(int a1)
{
  int result; // eax@9
  int *v2; // ecx@11
  int v3; // edx@11
  int v4; // [sp+0h] [bp-54h]@1
  int v5; // [sp+4h] [bp-50h]@1
  int v6; // [sp+8h] [bp-4Ch]@1
  int v7; // [sp+Ch] [bp-48h]@1
  int v8; // [sp+10h] [bp-44h]@1
  int v9; // [sp+14h] [bp-40h]@1
  int v10; // [sp+18h] [bp-3Ch]@1
  int v11; // [sp+1Ch] [bp-38h]@1
  int v12; // [sp+20h] [bp-34h]@1
  int v13; // [sp+24h] [bp-30h]@1
  int v14; // [sp+28h] [bp-2Ch]@1
  int v15; // [sp+2Ch] [bp-28h]@1
  int v16; // [sp+30h] [bp-24h]@1
  int v17; // [sp+34h] [bp-20h]@1
  int v18; // [sp+38h] [bp-1Ch]@1
  int v19; // [sp+3Ch] [bp-18h]@1
  int v20; // [sp+40h] [bp-14h]@1
  int v21; // [sp+44h] [bp-10h]@1
  int v22; // [sp+48h] [bp-Ch]@1
  int v23; // [sp+4Ch] [bp-8h]@1
  int v24; // [sp+50h] [bp-4h]@1

  v5 = 0;
  v6 = 144;
  v7 = 16;
  v8 = 160;
  v9 = 16;
  v10 = 144;
  v11 = 32;
  v12 = 160;
  v13 = 32;
  v14 = 144;
  v15 = 48;
  v16 = 160;
  v17 = 48;
  v18 = 144;
  v19 = 64;
  v20 = 160;
  v21 = 64;
  v22 = 144;
  v23 = 80;
  v24 = 160;
  v4 = *(_DWORD *)(a1 + 116);
  if ( !v4 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = *(_DWORD *)(a1 + 76);
    Play_Sound_Effect(Sfx_Computer_Screen_On, 1);
LABEL_6:
    *(_DWORD *)(a1 + 8) += 512;
    if ( ++*(_DWORD *)(a1 + 120) > 8 )
    {
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 116) = 2;
    }
    goto LABEL_11;
  }
  if ( v4 == 1 )
    goto LABEL_6;
  if ( v4 == 2 )
  {
    ++*(_DWORD *)(a1 + 120);
    result = a1;
    if ( *(_DWORD *)(a1 + 120) > 30 )
    {
      *(_BYTE *)a1 = 0;
      return result;
    }
  }
LABEL_11:
  v2 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v3 = a1 + 84;
  *(_DWORD *)v3 = *v2;
  *(_DWORD *)(v3 + 4) = v2[1];
  result = v2[2];
  *(_DWORD *)(v3 + 8) = result;
  *(_DWORD *)(v3 + 12) = v2[3];
  return result;
}

//----- (0044FCB0) --------------------------------------------------------
int __cdecl NPC208(int a1)
{
  int result; // eax@7
  unsigned __int8 v2; // ST2F_1@42
  unsigned __int8 v3; // ST2F_1@42
  int Y_Vel; // ST24_4@42
  int X_Vel; // ST28_4@42
  int *v6; // edx@54
  int *v7; // edx@55
  int v8; // [sp+0h] [bp-70h]@1
  int v9; // [sp+10h] [bp-60h]@1
  int v10; // [sp+14h] [bp-5Ch]@1
  int v11; // [sp+18h] [bp-58h]@1
  int v12; // [sp+1Ch] [bp-54h]@1
  int v13; // [sp+20h] [bp-50h]@1
  int v14; // [sp+24h] [bp-4Ch]@1
  int v15; // [sp+28h] [bp-48h]@1
  int v16; // [sp+2Ch] [bp-44h]@1
  int v17; // [sp+30h] [bp-40h]@1
  int v18; // [sp+34h] [bp-3Ch]@1
  int v19; // [sp+38h] [bp-38h]@1
  int v20; // [sp+3Ch] [bp-34h]@1
  int v21; // [sp+40h] [bp-30h]@1
  int v22; // [sp+44h] [bp-2Ch]@1
  int v23; // [sp+48h] [bp-28h]@1
  int v24; // [sp+4Ch] [bp-24h]@1
  int v25; // [sp+50h] [bp-20h]@1
  int v26; // [sp+54h] [bp-1Ch]@1
  int v27; // [sp+58h] [bp-18h]@1
  int v28; // [sp+5Ch] [bp-14h]@1
  int v29; // [sp+60h] [bp-10h]@1
  int v30; // [sp+64h] [bp-Ch]@1
  int v31; // [sp+68h] [bp-8h]@1
  int v32; // [sp+6Ch] [bp-4h]@1

  v21 = 248;
  v22 = 80;
  v23 = 272;
  v24 = 104;
  v25 = 272;
  v26 = 80;
  v27 = 296;
  v28 = 104;
  v29 = 296;
  v30 = 80;
  v31 = 320;
  v32 = 104;
  v9 = 248;
  v10 = 104;
  v11 = 272;
  v12 = 128;
  v13 = 272;
  v14 = 104;
  v15 = 296;
  v16 = 128;
  v17 = 296;
  v18 = 104;
  v19 = 320;
  v20 = 128;
  v8 = *(_DWORD *)(a1 + 116);
  if ( v8 )
  {
    if ( v8 != 1 )
      goto LABEL_58;
    if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
    {
      *(_DWORD *)(a1 + 76) = 2;
      *(_DWORD *)(a1 + 16) += 16;
    }
    else
    {
      *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 16) -= 16;
    }
    if ( *(_DWORD *)(a1 + 4) & 1 )
      *(_DWORD *)(a1 + 16) = 512;
    if ( *(_DWORD *)(a1 + 4) & 4 )
      *(_DWORD *)(a1 + 16) = -512;
    if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
      *(_DWORD *)(a1 + 20) -= 8;
    else
      *(_DWORD *)(a1 + 20) += 8;
    if ( *(_DWORD *)(a1 + 16) > 767 )
      *(_DWORD *)(a1 + 16) = 767;
    if ( *(_DWORD *)(a1 + 16) < -767 )
      *(_DWORD *)(a1 + 16) = -767;
    if ( *(_DWORD *)(a1 + 20) > 512 )
      *(_DWORD *)(a1 + 20) = 512;
    if ( *(_DWORD *)(a1 + 20) < -512 )
      *(_DWORD *)(a1 + 20) = -512;
    if ( *(_BYTE *)(a1 + 156) )
    {
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16) / 2;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20) / 2;
    }
    else
    {
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    }
    if ( Quote.X_Pos <= *(_DWORD *)(a1 + 8) + 204800 && Quote.X_Pos >= *(_DWORD *)(a1 + 8) - 204800 )
    {
LABEL_58:
      if ( *(_DWORD *)(a1 + 116) )
      {
        if ( *(_DWORD *)(a1 + 120) < 150 )
          ++*(_DWORD *)(a1 + 120);
        if ( *(_DWORD *)(a1 + 120) == 150 )
        {
          if ( !(++*(_DWORD *)(a1 + 112) % 8)
            && *(_DWORD *)(a1 + 8) < Quote.X_Pos + 81920
            && *(_DWORD *)(a1 + 8) > Quote.X_Pos - 81920 )
          {
            v2 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
            v3 = Random(-6, 6) + v2;
            Y_Vel = 3 * GetSin(v3);
            X_Vel = 3 * GetCos(v3);
            NPC_Create((NPC_Names)209, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
            Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          }
          if ( *(_DWORD *)(a1 + 112) > 16 )
          {
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 112) = 0;
          }
        }
      }
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 120) > 120 && *(_DWORD *)(a1 + 120) / 2 % 2 == 1 && *(_DWORD *)(a1 + 104) == 1 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 76) )
      {
        v7 = &v9 + 4 * *(_DWORD *)(a1 + 104);
        result = a1 + 84;
        *(_DWORD *)result = *v7;
        *(_DWORD *)(result + 4) = v7[1];
        *(_DWORD *)(result + 8) = v7[2];
        *(_DWORD *)(result + 12) = v7[3];
      }
      else
      {
        v6 = &v21 + 4 * *(_DWORD *)(a1 + 104);
        result = a1 + 84;
        *(_DWORD *)result = *v6;
        *(_DWORD *)(result + 4) = v6[1];
        *(_DWORD *)(result + 8) = v6[2];
        *(_DWORD *)(result + 12) = v6[3];
      }
    }
    else
    {
      *(_DWORD *)(a1 + 116) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 76) = *(_DWORD *)(a1 + 108);
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
      *(_DWORD *)(a1 + 92) = 0;
      result = a1;
      *(_DWORD *)(a1 + 164) = 0;
    }
  }
  else if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) + 0x2000 || Quote.X_Pos <= *(_DWORD *)(a1 + 8) - 0x2000 )
  {
    *(_DWORD *)(a1 + 92) = 0;
    *(_DWORD *)(a1 + 164) = 0;
    *(_DWORD *)(a1 + 16) = 0;
    *(_DWORD *)(a1 + 20) = 0;
    result = a1;
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
  }
  else
  {
    *(_WORD *)(a1 + 80) |= 0x20u;
    *(_DWORD *)(a1 + 20) = -512;
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 108) = *(_DWORD *)(a1 + 76);
    *(_DWORD *)(a1 + 112) = 0;
    *(_DWORD *)(a1 + 164) = 6;
    if ( *(_DWORD *)(a1 + 76) )
    {
      result = Quote.X_Pos - 0x20000;
      *(_DWORD *)(a1 + 8) = Quote.X_Pos - 0x20000;
      *(_DWORD *)(a1 + 16) = 767;
    }
    else
    {
      result = Quote.X_Pos + 0x20000;
      *(_DWORD *)(a1 + 8) = Quote.X_Pos + 0x20000;
      *(_DWORD *)(a1 + 16) = -767;
    }
  }
  return result;
}

//----- (00450280) --------------------------------------------------------
void __cdecl NPC209(int a1)
{
  int *v1; // eax@7
  int v2; // ecx@7
  int v3; // [sp+0h] [bp-40h]@3
  int v4; // [sp+4h] [bp-3Ch]@3
  int v5; // [sp+8h] [bp-38h]@3
  int v6; // [sp+Ch] [bp-34h]@3
  int v7; // [sp+10h] [bp-30h]@3
  int v8; // [sp+14h] [bp-2Ch]@3
  int v9; // [sp+18h] [bp-28h]@3
  int v10; // [sp+1Ch] [bp-24h]@3
  int v11; // [sp+20h] [bp-20h]@3
  int v12; // [sp+24h] [bp-1Ch]@3
  int v13; // [sp+28h] [bp-18h]@3
  int v14; // [sp+2Ch] [bp-14h]@3
  int v15; // [sp+30h] [bp-10h]@3
  int v16; // [sp+34h] [bp-Ch]@3
  int v17; // [sp+38h] [bp-8h]@3
  int v18; // [sp+3Ch] [bp-4h]@3

  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v3 = 232;
  v4 = 96;
  v5 = 248;
  v6 = 112;
  v7 = 200;
  v8 = 112;
  v9 = 216;
  v10 = 128;
  v11 = 216;
  v12 = 112;
  v13 = 232;
  v14 = 128;
  v15 = 232;
  v16 = 112;
  v17 = 248;
  v18 = 128;
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 3 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( ++*(_DWORD *)(a1 + 108) > 300 )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
  }
}

//----- (00450400) --------------------------------------------------------
int __cdecl NPC210(int a1)
{
  int result; // eax@10
  int *v2; // eax@33
  int v3; // ecx@33
  int *v4; // eax@34
  int v5; // ecx@34
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 0;
  v16 = 112;
  v17 = 16;
  v18 = 128;
  v19 = 16;
  v20 = 112;
  v21 = 32;
  v22 = 128;
  v7 = 32;
  v8 = 112;
  v9 = 48;
  v10 = 128;
  v11 = 48;
  v12 = 112;
  v13 = 64;
  v14 = 128;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
      {
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 16) += 16;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 16) -= 16;
      }
      if ( *(_DWORD *)(a1 + 16) > 767 )
        *(_DWORD *)(a1 + 16) = 767;
      if ( *(_DWORD *)(a1 + 16) < -767 )
        *(_DWORD *)(a1 + 16) = -767;
      if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
        *(_DWORD *)(a1 + 20) -= 8;
      else
        *(_DWORD *)(a1 + 20) += 8;
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 20) = 512;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16) / 2;
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20) / 2;
      }
      else
      {
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      }
    }
  }
  else
  {
    if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) + 0x2000 || Quote.X_Pos <= *(_DWORD *)(a1 + 8) - 0x2000 )
    {
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_DWORD *)(a1 + 92) = 0;
      *(_DWORD *)(a1 + 164) = 0;
      result = a1;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      return result;
    }
    *(_WORD *)(a1 + 80) |= 0x20u;
    *(_DWORD *)(a1 + 20) = -512;
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 164) = 2;
    if ( *(_DWORD *)(a1 + 76) )
    {
      *(_DWORD *)(a1 + 8) = Quote.X_Pos - 0x20000;
      *(_DWORD *)(a1 + 16) = 767;
    }
    else
    {
      *(_DWORD *)(a1 + 8) = Quote.X_Pos + 0x20000;
      *(_DWORD *)(a1 + 16) = -767;
    }
  }
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v2 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
  }
  return result;
}

//----- (00450760) --------------------------------------------------------
int __cdecl NPC211(int a1)
{
  int *v1; // edx@1
  int result; // eax@1
  int v3; // [sp+0h] [bp-40h]@1
  int v4; // [sp+4h] [bp-3Ch]@1
  int v5; // [sp+8h] [bp-38h]@1
  int v6; // [sp+Ch] [bp-34h]@1
  int v7; // [sp+10h] [bp-30h]@1
  int v8; // [sp+14h] [bp-2Ch]@1
  int v9; // [sp+18h] [bp-28h]@1
  int v10; // [sp+1Ch] [bp-24h]@1
  int v11; // [sp+20h] [bp-20h]@1
  int v12; // [sp+24h] [bp-1Ch]@1
  int v13; // [sp+28h] [bp-18h]@1
  int v14; // [sp+2Ch] [bp-14h]@1
  int v15; // [sp+30h] [bp-10h]@1
  int v16; // [sp+34h] [bp-Ch]@1
  int v17; // [sp+38h] [bp-8h]@1
  int v18; // [sp+3Ch] [bp-4h]@1

  v3 = 256;
  v4 = 200;
  v5 = 272;
  v6 = 216;
  v7 = 272;
  v8 = 200;
  v9 = 288;
  v10 = 216;
  v11 = 288;
  v12 = 200;
  v13 = 304;
  v14 = 216;
  v15 = 304;
  v16 = 200;
  v17 = 320;
  v18 = 216;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 48);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00450810) --------------------------------------------------------
NPC_vars *__cdecl NPC212(NPC_vars *a1)
{
  int *v1; // ecx@34
  char *v2; // edx@34
  NPC_vars *result; // eax@34
  int v4; // [sp+4h] [bp-40h]@1
  int v5; // [sp+8h] [bp-3Ch]@1
  int v6; // [sp+Ch] [bp-38h]@1
  int v7; // [sp+10h] [bp-34h]@1
  int v8; // [sp+14h] [bp-30h]@1
  int v9; // [sp+18h] [bp-2Ch]@1
  int v10; // [sp+1Ch] [bp-28h]@1
  int v11; // [sp+20h] [bp-24h]@1
  int v12; // [sp+24h] [bp-20h]@1
  int v13; // [sp+28h] [bp-1Ch]@1
  int v14; // [sp+2Ch] [bp-18h]@1
  int v15; // [sp+30h] [bp-14h]@1
  int v16; // [sp+34h] [bp-10h]@1
  int v17; // [sp+38h] [bp-Ch]@1
  int v18; // [sp+3Ch] [bp-8h]@1
  int v19; // [sp+40h] [bp-4h]@1

  v4 = 160;
  v5 = 152;
  v6 = 200;
  v7 = 192;
  v8 = 200;
  v9 = 152;
  v10 = 240;
  v11 = 192;
  v12 = 240;
  v13 = 112;
  v14 = 280;
  v15 = 152;
  v16 = 280;
  v17 = 112;
  v18 = 320;
  v19 = 152;
  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 1;
      a1->Y_pos -= 2048;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++a1->ani_wait > 30 )
      {
        a1->ani_wait = 0;
        ++a1->Ani_Num;
      }
      if ( a1->Ani_Num > 1 )
        a1->Ani_Num = 0;
      break;
    case 0xA:
      a1->Current_State = 11;
      a1->Ani_Num = 2;
      a1->ani_wait = 0;
      a1->Curly_Target_Y = a1->Y_pos - 0x2000;
      a1->Curly_Target_X = a1->X_pos - 3072;
      a1->Y_vel = 0;
      a1->Entity_Flags |= 8u;
      goto LABEL_9;
    case 0xB:
LABEL_9:
      if ( a1->X_pos >= a1->Curly_Target_X )
        a1->X_vel -= 8;
      else
        a1->X_vel += 8;
      if ( a1->Y_pos >= a1->Curly_Target_Y )
        a1->Y_vel -= 8;
      else
        a1->Y_vel += 8;
      a1->X_pos += a1->X_vel;
      a1->Y_pos += a1->Y_vel;
      if ( ++a1->ani_wait > 5 )
      {
        a1->ani_wait = 0;
        ++a1->Ani_Num;
      }
      if ( a1->Ani_Num > 3 )
        a1->Ani_Num = 2;
      break;
    case 0x14:
      a1->Current_State = 21;
      a1->Entity_Flags |= 8u;
      goto LABEL_21;
    case 0x15:
LABEL_21:
      if ( a1->Y_pos >= a1->Curly_Target_Y )
        a1->Y_vel -= 16;
      else
        a1->Y_vel += 16;
      a1->X_vel += 32;
      if ( a1->X_vel > 1536 )
        a1->X_vel = 1536;
      if ( a1->X_vel < -1536 )
        a1->X_vel = -1536;
      a1->X_pos += a1->X_vel;
      a1->Y_pos += a1->Y_vel;
      if ( ++a1->ani_wait > 2 )
      {
        a1->ani_wait = 0;
        ++a1->Ani_Num;
      }
      if ( a1->Ani_Num > 3 )
        a1->Ani_Num = 2;
      break;
    case 0x1E:
      a1->Current_State = 31;
      NPC_Create((NPC_Names)297, 0, 0, 0, 0, 0, a1, 256);
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * a1->Ani_Num;
  v2 = (char *)&a1->Rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = (NPC_vars *)v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  if ( Quote.Equipped_Items & 0x40 )
  {
    result = a1;
    if ( a1->Ani_Num > 1 )
    {
      a1->Rect.top += 40;
      result = a1;
      a1->Rect.bottom += 40;
    }
  }
  return result;
}

//----- (00450BF0) --------------------------------------------------------
int __cdecl NPC213(int a1)
{
  int v1; // ST10_4@29
  int v2; // eax@29
  int *v3; // edx@69
  int result; // eax@69
  int v5; // [sp+4h] [bp-A0h]@1
  int v6; // [sp+8h] [bp-9Ch]@1
  int v7; // [sp+Ch] [bp-98h]@1
  int v8; // [sp+10h] [bp-94h]@1
  int v9; // [sp+14h] [bp-90h]@1
  int v10; // [sp+18h] [bp-8Ch]@1
  int v11; // [sp+1Ch] [bp-88h]@1
  int v12; // [sp+20h] [bp-84h]@1
  int v13; // [sp+24h] [bp-80h]@1
  int v14; // [sp+28h] [bp-7Ch]@1
  int v15; // [sp+2Ch] [bp-78h]@1
  int v16; // [sp+30h] [bp-74h]@1
  int v17; // [sp+34h] [bp-70h]@1
  int v18; // [sp+38h] [bp-6Ch]@1
  int v19; // [sp+3Ch] [bp-68h]@1
  int v20; // [sp+40h] [bp-64h]@1
  int v21; // [sp+44h] [bp-60h]@1
  int v22; // [sp+48h] [bp-5Ch]@1
  int v23; // [sp+4Ch] [bp-58h]@1
  int v24; // [sp+50h] [bp-54h]@1
  int v25; // [sp+54h] [bp-50h]@1
  int v26; // [sp+58h] [bp-4Ch]@1
  int v27; // [sp+5Ch] [bp-48h]@1
  int v28; // [sp+60h] [bp-44h]@1
  int v29; // [sp+64h] [bp-40h]@1
  int v30; // [sp+68h] [bp-3Ch]@1
  int v31; // [sp+6Ch] [bp-38h]@1
  int v32; // [sp+70h] [bp-34h]@1
  int v33; // [sp+74h] [bp-30h]@1
  int v34; // [sp+78h] [bp-2Ch]@1
  int v35; // [sp+7Ch] [bp-28h]@1
  int v36; // [sp+80h] [bp-24h]@1
  int v37; // [sp+84h] [bp-20h]@1
  int v38; // [sp+88h] [bp-1Ch]@1
  int v39; // [sp+8Ch] [bp-18h]@1
  int v40; // [sp+90h] [bp-14h]@1
  int v41; // [sp+94h] [bp-10h]@1
  int v42; // [sp+98h] [bp-Ch]@1
  int v43; // [sp+9Ch] [bp-8h]@1
  int v44; // [sp+A0h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v11 = 48;
  v12 = 48;
  v13 = 48;
  v14 = 0;
  v15 = 96;
  v16 = 48;
  v17 = 96;
  v18 = 0;
  v19 = 144;
  v20 = 48;
  v21 = 144;
  v22 = 0;
  v23 = 192;
  v24 = 48;
  v25 = 192;
  v26 = 0;
  v27 = 240;
  v28 = 48;
  v29 = 240;
  v30 = 0;
  v31 = 288;
  v32 = 48;
  v33 = 0;
  v34 = 48;
  v35 = 48;
  v36 = 96;
  v37 = 48;
  v38 = 48;
  v39 = 96;
  v40 = 96;
  v41 = 96;
  v42 = 48;
  v43 = 144;
  v44 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 4096 && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 4096 )
      {
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 12) += 122880;
        else
          *(_DWORD *)(a1 + 12) -= 122880;
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 20) = 0;
        *(_WORD *)(a1 + 80) |= 0x20u;
      }
      break;
    case 0xA:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( ++*(_DWORD *)(a1 + 120) > 200 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 4;
      }
      break;
    case 0x14:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 4;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 116) = 30;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 7;
      }
      break;
    case 0x1E:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 9 )
        *(_DWORD *)(a1 + 104) = 7;
      if ( ++*(_DWORD *)(a1 + 120) % 5 == 1 )
      {
        v1 = Random(-512, 512);
        v2 = Random(2, 12);
        NPC_Create((NPC_Names)214, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), (v2 << 9) / 4, v1, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Bubble, 1);
      }
      if ( *(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 0x28:
      if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
        *(_DWORD *)(a1 + 20) -= 64;
      else
        *(_DWORD *)(a1 + 20) += 64;
      if ( *(_DWORD *)(a1 + 20) < -1024 )
        *(_DWORD *)(a1 + 20) = -1024;
      if ( *(_DWORD *)(a1 + 20) > 1024 )
        *(_DWORD *)(a1 + 20) = 1024;
      if ( *(_BYTE *)(a1 + 156) )
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20) / 2;
      else
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 6 )
        *(_DWORD *)(a1 + 104) = 4;
      if ( Quote.Y_Pos < *(_DWORD *)(a1 + 36) + 122880 && Quote.Y_Pos > *(_DWORD *)(a1 + 36) - 122880 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 4;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) >= 10 && *(_DWORD *)(a1 + 116) <= 30 )
  {
    if ( *(_DWORD *)(a1 + 12) >= Quote.Y_Pos )
      *(_DWORD *)(a1 + 20) -= 25;
    else
      *(_DWORD *)(a1 + 20) += 25;
    if ( *(_DWORD *)(a1 + 20) < -1024 )
      *(_DWORD *)(a1 + 20) = -1024;
    if ( *(_DWORD *)(a1 + 20) > 1024 )
      *(_DWORD *)(a1 + 20) = 1024;
    if ( *(_DWORD *)(a1 + 4) & 2 )
      *(_DWORD *)(a1 + 20) = 512;
    if ( *(_DWORD *)(a1 + 4) & 8 )
      *(_DWORD *)(a1 + 20) = -512;
    if ( *(_BYTE *)(a1 + 156) )
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20) / 2;
    else
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    if ( Quote.Y_Pos > *(_DWORD *)(a1 + 36) + 122880 || Quote.Y_Pos < *(_DWORD *)(a1 + 36) - 122880 )
      *(_DWORD *)(a1 + 116) = 40;
  }
  v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v3;
  *(_DWORD *)(result + 4) = v3[1];
  *(_DWORD *)(result + 8) = v3[2];
  *(_DWORD *)(result + 12) = v3[3];
  return result;
}

//----- (004512A0) --------------------------------------------------------
int __cdecl NPC214(int Entity_Vars)
{
  int *v1; // eax@13
  int v2; // ecx@13
  int result; // eax@13
  int v4; // [sp+0h] [bp-34h]@1
  int v5; // [sp+4h] [bp-30h]@1
  int v6; // [sp+8h] [bp-2Ch]@1
  int v7; // [sp+Ch] [bp-28h]@1
  int v8; // [sp+10h] [bp-24h]@1
  int v9; // [sp+14h] [bp-20h]@1
  int v10; // [sp+18h] [bp-1Ch]@1
  int v11; // [sp+1Ch] [bp-18h]@1
  int v12; // [sp+20h] [bp-14h]@1
  int v13; // [sp+24h] [bp-10h]@1
  int v14; // [sp+28h] [bp-Ch]@1
  int v15; // [sp+2Ch] [bp-8h]@1
  int v16; // [sp+30h] [bp-4h]@1

  v5 = 144;
  v6 = 48;
  v7 = 176;
  v8 = 64;
  v9 = 176;
  v10 = 48;
  v11 = 208;
  v12 = 64;
  v13 = 208;
  v14 = 48;
  v15 = 240;
  v16 = 64;
  v4 = *(_DWORD *)(Entity_Vars + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_13;
  }
  else
  {
    *(_DWORD *)(Entity_Vars + 116) = 1;
    *(_WORD *)(Entity_Vars + 80) |= 8u;
  }
  if ( ++*(_DWORD *)(Entity_Vars + 100) > 2 )
  {
    *(_DWORD *)(Entity_Vars + 100) = 0;
    ++*(_DWORD *)(Entity_Vars + 104);
  }
  if ( *(_DWORD *)(Entity_Vars + 104) > 2 )
    *(_DWORD *)(Entity_Vars + 104) = 0;
  *(_DWORD *)(Entity_Vars + 0x10) -= 25;
  *(_DWORD *)(Entity_Vars + 8) += *(_DWORD *)(Entity_Vars + 16);
  *(_DWORD *)(Entity_Vars + 0xC) += *(_DWORD *)(Entity_Vars + 20);
  if ( *(_DWORD *)(Entity_Vars + 16) < 0 )
    *(_WORD *)(Entity_Vars + 80) &= 0xFFF7u;
  if ( *(_DWORD *)(Entity_Vars + 4) & 0xFF )
  {
    Create_Dust_Clouds(*(_DWORD *)(Entity_Vars + 8), *(_DWORD *)(Entity_Vars + 12), *(_DWORD *)(Entity_Vars + 148), 4);
    Play_Sound_Effect(Sfx_Shot_Hit_Wall, 1);
    *(_BYTE *)Entity_Vars = 0;
  }
LABEL_13:
  v1 = &v5 + 4 * *(_DWORD *)(Entity_Vars + 104);
  v2 = Entity_Vars + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00451430) --------------------------------------------------------
int __cdecl NPC215(int a1)
{
  int *v1; // eax@28
  int v2; // ecx@28
  int result; // eax@28
  int v4; // [sp+4h] [bp-50h]@28
  int v5; // [sp+8h] [bp-4Ch]@28
  int v6; // [sp+Ch] [bp-48h]@28
  int v7; // [sp+10h] [bp-44h]@28
  int v8; // [sp+14h] [bp-40h]@28
  int v9; // [sp+18h] [bp-3Ch]@28
  int v10; // [sp+1Ch] [bp-38h]@28
  int v11; // [sp+20h] [bp-34h]@28
  int v12; // [sp+24h] [bp-30h]@28
  int v13; // [sp+28h] [bp-2Ch]@28
  int v14; // [sp+2Ch] [bp-28h]@28
  int v15; // [sp+30h] [bp-24h]@28
  int v16; // [sp+34h] [bp-20h]@28
  int v17; // [sp+38h] [bp-1Ch]@28
  int v18; // [sp+3Ch] [bp-18h]@28
  int v19; // [sp+40h] [bp-14h]@28
  int v20; // [sp+44h] [bp-10h]@28
  int v21; // [sp+48h] [bp-Ch]@28
  int v22; // [sp+4Ch] [bp-8h]@28
  int v23; // [sp+50h] [bp-4h]@28

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
      *(_WORD *)(a1 + 80) &= 0xFFFEu;
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 6144
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 6144
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12)
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 4096 )
      {
        *(_DWORD *)(a1 + 116) = 15;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xF:
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
      {
        Play_Sound_Effect(Sfx_Sand_Croc, 1);
        *(_DWORD *)(a1 + 116) = 20;
      }
      break;
    case 0x14:
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        ++*(_DWORD *)(a1 + 104);
        *(_DWORD *)(a1 + 100) = 0;
      }
      if ( *(_DWORD *)(a1 + 104) == 3 )
        *(_DWORD *)(a1 + 164) = 15;
      if ( *(_DWORD *)(a1 + 104) == 4 )
      {
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 116) = 30;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x1E:
      *(_WORD *)(a1 + 80) |= 1u;
      *(_DWORD *)(a1 + 164) = 0;
      ++*(_DWORD *)(a1 + 120);
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 116) = 40;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x28:
      *(_WORD *)(a1 + 80) |= 8u;
      *(_DWORD *)(a1 + 12) += 512;
      if ( ++*(_DWORD *)(a1 + 120) == 32 )
      {
        *(_WORD *)(a1 + 80) &= 0xFFFEu;
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        *(_DWORD *)(a1 + 116) = 50;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0x32:
      if ( *(_DWORD *)(a1 + 120) >= 100 )
      {
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36);
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 0;
      }
      else
      {
        ++*(_DWORD *)(a1 + 120);
      }
      break;
    default:
      break;
  }
  v4 = 0;
  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  v9 = 96;
  v10 = 48;
  v11 = 128;
  v12 = 48;
  v13 = 96;
  v14 = 96;
  v15 = 128;
  v16 = 96;
  v17 = 96;
  v18 = 144;
  v19 = 128;
  v20 = 144;
  v21 = 96;
  v22 = 192;
  v23 = 128;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (004517F0) --------------------------------------------------------
void __cdecl NPC216_Debug_Cat(NPC_vars *npc)
{
  RECT *npc_Rect; // eax@1

  // Render
  npc_Rect = &npc->Rect;
  npc_Rect->left = 256;
  npc_Rect->top = 192;
  npc_Rect->right = 272;
  npc_Rect->bottom = 216;
}

//----- (00451840) --------------------------------------------------------
int __cdecl NPC217(int a1)
{
  int *v1; // edx@32
  int result; // eax@32
  int v3; // [sp+4h] [bp-80h]@1
  int v4; // [sp+8h] [bp-7Ch]@1
  int v5; // [sp+Ch] [bp-78h]@1
  int v6; // [sp+10h] [bp-74h]@1
  int v7; // [sp+14h] [bp-70h]@1
  int v8; // [sp+18h] [bp-6Ch]@1
  int v9; // [sp+1Ch] [bp-68h]@1
  int v10; // [sp+20h] [bp-64h]@1
  int v11; // [sp+24h] [bp-60h]@1
  int v12; // [sp+28h] [bp-5Ch]@1
  int v13; // [sp+2Ch] [bp-58h]@1
  int v14; // [sp+30h] [bp-54h]@1
  int v15; // [sp+34h] [bp-50h]@1
  int v16; // [sp+38h] [bp-4Ch]@1
  int v17; // [sp+3Ch] [bp-48h]@1
  int v18; // [sp+40h] [bp-44h]@1
  int v19; // [sp+44h] [bp-40h]@1
  int v20; // [sp+48h] [bp-3Ch]@1
  int v21; // [sp+4Ch] [bp-38h]@1
  int v22; // [sp+50h] [bp-34h]@1
  int v23; // [sp+54h] [bp-30h]@1
  int v24; // [sp+58h] [bp-2Ch]@1
  int v25; // [sp+5Ch] [bp-28h]@1
  int v26; // [sp+60h] [bp-24h]@1
  int v27; // [sp+64h] [bp-20h]@1
  int v28; // [sp+68h] [bp-1Ch]@1
  int v29; // [sp+6Ch] [bp-18h]@1
  int v30; // [sp+70h] [bp-14h]@1
  int v31; // [sp+74h] [bp-10h]@1
  int v32; // [sp+78h] [bp-Ch]@1
  int v33; // [sp+7Ch] [bp-8h]@1
  int v34; // [sp+80h] [bp-4h]@1

  v3 = 144;
  v4 = 64;
  v5 = 160;
  v6 = 80;
  v7 = 160;
  v8 = 64;
  v9 = 176;
  v10 = 80;
  v11 = 176;
  v12 = 64;
  v13 = 192;
  v14 = 80;
  v15 = 192;
  v16 = 64;
  v17 = 208;
  v18 = 80;
  v19 = 144;
  v20 = 80;
  v21 = 160;
  v22 = 96;
  v23 = 160;
  v24 = 80;
  v25 = 176;
  v26 = 96;
  v27 = 144;
  v28 = 80;
  v29 = 160;
  v30 = 96;
  v31 = 176;
  v32 = 80;
  v33 = 192;
  v34 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 120) == 10 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 16) = 0;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 16) += 512;
      *(_DWORD *)(a1 + 20) -= 1024;
      break;
    case 0x15:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 104) = 3;
        *(_DWORD *)(a1 + 116) = 30;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      }
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 104) = 3;
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + 512;
      else
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      *(_DWORD *)(a1 + 20) = -512;
      *(_DWORD *)(a1 + 104) = 2;
      goto LABEL_19;
    case 0x29:
LABEL_19:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 42;
        *(_DWORD *)(a1 + 104) = 4;
      }
      break;
    case 0x2A:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 104) = 4;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_24;
    case 0x33:
LABEL_24:
      if ( ++*(_DWORD *)(a1 + 120) > 32 )
        *(_DWORD *)(a1 + 116) = 42;
      *(_DWORD *)(a1 + 16) = 512;
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 7 )
        *(_DWORD *)(a1 + 104) = 4;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00451CA0) --------------------------------------------------------
int __cdecl NPC218(int a1)
{
  int *v1; // ecx@7
  int v2; // edx@7
  int result; // eax@7
  int v4; // [sp+0h] [bp-20h]@1
  int v5; // [sp+4h] [bp-1Ch]@1
  int v6; // [sp+8h] [bp-18h]@1
  int v7; // [sp+Ch] [bp-14h]@1
  int v8; // [sp+10h] [bp-10h]@1
  int v9; // [sp+14h] [bp-Ch]@1
  int v10; // [sp+18h] [bp-8h]@1
  int v11; // [sp+1Ch] [bp-4h]@1

  v4 = 256;
  v5 = 120;
  v6 = 288;
  v7 = 152;
  v8 = 288;
  v9 = 120;
  v10 = 320;
  v11 = 152;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( ++*(_DWORD *)(a1 + 120) > 200 )
    *(_BYTE *)a1 = 0;
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00451DA0) --------------------------------------------------------
int __cdecl NPC219(int a1)
{
  int v1; // ST08_4@3
  int v2; // eax@3
  int v3; // ST08_4@5
  int v4; // eax@5
  int v5; // edx@6
  int result; // eax@6

  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = *(_DWORD *)(a1 + 12) + (Random(-128, 128) << 9);
    v4 = Random(-160, 160);
    NPC_Create(Enemy_Basil|0xC0, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, 0, 0, Right, NULL, 256);
  }
  else if ( Random(0, 40) == 1 )
  {
    v1 = *(_DWORD *)(a1 + 12);
    v2 = Random(-20, 20);
    NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v2 << 9), v1, 0, -512, 0, NULL, 256);
  }
  v5 = a1 + 84;
  *(_DWORD *)v5 = 0;
  *(_DWORD *)(v5 + 4) = 0;
  result = 0;
  *(_DWORD *)(v5 + 8) = 0;
  *(_DWORD *)(v5 + 12) = 0;
  return result;
}

//----- (00451E90) --------------------------------------------------------
void __cdecl NPC220(NPC_vars *npc)
{
  int npc_Current_State; // [sp+0h] [bp-44h]@1
  RECT Rects_Right[2]; // [sp+4h] [bp-40h]@1
  RECT Rects_Left[2]; // [sp+24h] [bp-20h]@1

  // ==============================
  // ====<///FRAMARECTS\\\>========
  // ==============================

  // ===sprite 0 (stand still face left do nothing)===
  Rects_Left[0].left = 0;
  Rects_Left[0].top = 0x40;
  Rects_Left[0].right = 0x10;
  Rects_Left[0].bottom = 0x50;

  // ===sprite 1 (stand still face left blink)===
  Rects_Left[1].left = 0x10;
  Rects_Left[1].top = 0x40;
  Rects_Left[1].right = 0x20;
  Rects_Left[1].bottom = 0x50;

  // ===sprite 2 (stand still face left do nothing)===
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 0x50;
  Rects_Right[0].right = 0x10;
  Rects_Right[0].bottom = 0x60;

  // ===sprite 3 (stand still face left blink)===
  Rects_Right[1].left = 0x10;
  Rects_Right[1].top = 0x50;
  Rects_Right[1].right = 0x20;
  Rects_Right[1].bottom = 0x60;
  // ================================
  // =======<///BEHAVIOUR\\\>========
  // ================================
  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    npc->Current_State = 1;
    npc->Ani_Num = 0;
    npc->ani_wait = 0;
  }
  else if ( npc_Current_State != 1 )
  {
    if ( npc_Current_State == 2 && ++npc->Wait_Timer > 8 )
    {
      npc->Current_State = 1;
      npc->Ani_Num = 0;
    }
    goto if_not_any;
  }
  // npc_Current_State == 1
  if ( Random(0, 120) == 10 )
  {
    npc->Current_State = 2;
    npc->Wait_Timer = 0;
    npc->Ani_Num = 1;
  }
if_not_any:
  if ( !npc->Direction )
    npc->Rect = Rects_Left[npc->Ani_Num];
  else
    npc->Rect = Rects_Right[npc->Ani_Num];
}

//----- (00452000) --------------------------------------------------------
int __cdecl NPC221(int a1)
{
  int *v1; // eax@32
  int v2; // ecx@32
  int result; // eax@32
  int *v4; // eax@33
  int v5; // ecx@33
  int v6; // [sp+4h] [bp-C0h]@1
  int v7; // [sp+8h] [bp-BCh]@1
  int v8; // [sp+Ch] [bp-B8h]@1
  int v9; // [sp+10h] [bp-B4h]@1
  int v10; // [sp+14h] [bp-B0h]@1
  int v11; // [sp+18h] [bp-ACh]@1
  int v12; // [sp+1Ch] [bp-A8h]@1
  int v13; // [sp+20h] [bp-A4h]@1
  int v14; // [sp+24h] [bp-A0h]@1
  int v15; // [sp+28h] [bp-9Ch]@1
  int v16; // [sp+2Ch] [bp-98h]@1
  int v17; // [sp+30h] [bp-94h]@1
  int v18; // [sp+34h] [bp-90h]@1
  int v19; // [sp+38h] [bp-8Ch]@1
  int v20; // [sp+3Ch] [bp-88h]@1
  int v21; // [sp+40h] [bp-84h]@1
  int v22; // [sp+44h] [bp-80h]@1
  int v23; // [sp+48h] [bp-7Ch]@1
  int v24; // [sp+4Ch] [bp-78h]@1
  int v25; // [sp+50h] [bp-74h]@1
  int v26; // [sp+54h] [bp-70h]@1
  int v27; // [sp+58h] [bp-6Ch]@1
  int v28; // [sp+5Ch] [bp-68h]@1
  int v29; // [sp+60h] [bp-64h]@1
  int v30; // [sp+64h] [bp-60h]@1
  int v31; // [sp+68h] [bp-5Ch]@1
  int v32; // [sp+6Ch] [bp-58h]@1
  int v33; // [sp+70h] [bp-54h]@1
  int v34; // [sp+74h] [bp-50h]@1
  int v35; // [sp+78h] [bp-4Ch]@1
  int v36; // [sp+7Ch] [bp-48h]@1
  int v37; // [sp+80h] [bp-44h]@1
  int v38; // [sp+84h] [bp-40h]@1
  int v39; // [sp+88h] [bp-3Ch]@1
  int v40; // [sp+8Ch] [bp-38h]@1
  int v41; // [sp+90h] [bp-34h]@1
  int v42; // [sp+94h] [bp-30h]@1
  int v43; // [sp+98h] [bp-2Ch]@1
  int v44; // [sp+9Ch] [bp-28h]@1
  int v45; // [sp+A0h] [bp-24h]@1
  int v46; // [sp+A4h] [bp-20h]@1
  int v47; // [sp+A8h] [bp-1Ch]@1
  int v48; // [sp+ACh] [bp-18h]@1
  int v49; // [sp+B0h] [bp-14h]@1
  int v50; // [sp+B4h] [bp-10h]@1
  int v51; // [sp+B8h] [bp-Ch]@1
  int v52; // [sp+BCh] [bp-8h]@1
  int v53; // [sp+C0h] [bp-4h]@1

  v30 = 0;
  v31 = 64;
  v32 = 16;
  v33 = 80;
  v34 = 16;
  v35 = 64;
  v36 = 32;
  v37 = 80;
  v38 = 32;
  v39 = 64;
  v40 = 48;
  v41 = 80;
  v42 = 0;
  v43 = 64;
  v44 = 16;
  v45 = 80;
  v46 = 48;
  v47 = 64;
  v48 = 64;
  v49 = 80;
  v50 = 0;
  v51 = 64;
  v52 = 16;
  v53 = 80;
  v6 = 0;
  v7 = 80;
  v8 = 16;
  v9 = 96;
  v10 = 16;
  v11 = 80;
  v12 = 32;
  v13 = 96;
  v14 = 32;
  v15 = 80;
  v16 = 48;
  v17 = 96;
  v18 = 0;
  v19 = 80;
  v20 = 16;
  v21 = 96;
  v22 = 48;
  v23 = 80;
  v24 = 64;
  v25 = 96;
  v26 = 0;
  v27 = 80;
  v28 = 16;
  v29 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = Random(0, 16);
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      if ( Random(0, 9) % 2 )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      goto LABEL_14;
    case 0xB:
LABEL_14:
      if ( *(_DWORD *)(a1 + 76) || !(*(_DWORD *)(a1 + 4) & 1) )
      {
        if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 4) & 4 )
          *(_DWORD *)(a1 + 76) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 512;
      else
        *(_DWORD *)(a1 + 16) = -512;
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( ++*(_DWORD *)(a1 + 120) > 32 )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v30 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00452470) --------------------------------------------------------
signed int __cdecl NPC222(int a1)
{
  int v1; // ecx@3
  signed int result; // eax@3

  if ( !*(_DWORD *)(a1 + 116) )
  {
    ++*(_DWORD *)(a1 + 116);
    *(_DWORD *)(a1 + 12) -= 4096;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 96;
  *(_DWORD *)(v1 + 4) = 168;
  *(_DWORD *)(v1 + 8) = 112;
  result = 200;
  *(_DWORD *)(v1 + 12) = 200;
  return result;
}

//----- (004524E0) --------------------------------------------------------
int __cdecl NPC223(int a1)
{
  int *v1; // ecx@17
  int v2; // edx@17
  int result; // eax@17
  int *v4; // ecx@18
  int v5; // edx@18
  int v6; // [sp+4h] [bp-60h]@1
  int v7; // [sp+8h] [bp-5Ch]@1
  int v8; // [sp+Ch] [bp-58h]@1
  int v9; // [sp+10h] [bp-54h]@1
  int v10; // [sp+14h] [bp-50h]@1
  int v11; // [sp+18h] [bp-4Ch]@1
  int v12; // [sp+1Ch] [bp-48h]@1
  int v13; // [sp+20h] [bp-44h]@1
  int v14; // [sp+24h] [bp-40h]@1
  int v15; // [sp+28h] [bp-3Ch]@1
  int v16; // [sp+2Ch] [bp-38h]@1
  int v17; // [sp+30h] [bp-34h]@1
  int v18; // [sp+34h] [bp-30h]@1
  int v19; // [sp+38h] [bp-2Ch]@1
  int v20; // [sp+3Ch] [bp-28h]@1
  int v21; // [sp+40h] [bp-24h]@1
  int v22; // [sp+44h] [bp-20h]@1
  int v23; // [sp+48h] [bp-1Ch]@1
  int v24; // [sp+4Ch] [bp-18h]@1
  int v25; // [sp+50h] [bp-14h]@1
  int v26; // [sp+54h] [bp-10h]@1
  int v27; // [sp+58h] [bp-Ch]@1
  int v28; // [sp+5Ch] [bp-8h]@1
  int v29; // [sp+60h] [bp-4h]@1

  v18 = 80;
  v19 = 192;
  v20 = 96;
  v21 = 216;
  v22 = 96;
  v23 = 192;
  v24 = 112;
  v25 = 216;
  v26 = 112;
  v27 = 192;
  v28 = 128;
  v29 = 216;
  v6 = 80;
  v7 = 216;
  v8 = 96;
  v9 = 240;
  v10 = 96;
  v11 = 216;
  v12 = 112;
  v13 = 240;
  v14 = 112;
  v15 = 216;
  v16 = 128;
  v17 = 240;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 160) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 3:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) < 2
    && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x2000
    && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 0x2000 )
  {
    if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v18 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (00452700) --------------------------------------------------------
int __cdecl NPC224(int a1)
{
  int *v1; // edx@18
  int result; // eax@18
  int *v3; // edx@19
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 112;
  v14 = 32;
  v15 = 128;
  v16 = 48;
  v17 = 128;
  v18 = 32;
  v19 = 144;
  v20 = 48;
  v5 = 112;
  v6 = 48;
  v7 = 128;
  v8 = 64;
  v9 = 128;
  v10 = 48;
  v11 = 144;
  v12 = 64;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 160) == 1 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 116) < 2
    && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x2000
    && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 0x2000 )
  {
    if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (004528D0) --------------------------------------------------------
int __cdecl NPC225(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int *v3; // edx@13
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 64;
  v14 = 64;
  v15 = 80;
  v16 = 80;
  v17 = 80;
  v18 = 64;
  v19 = 96;
  v20 = 80;
  v5 = 64;
  v6 = 80;
  v7 = 80;
  v8 = 96;
  v9 = 80;
  v10 = 80;
  v11 = 96;
  v12 = 96;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 160) == 1 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00452A50) --------------------------------------------------------
int __cdecl NPC226(int a1)
{
  int *v1; // eax@18
  int v2; // ecx@18
  int result; // eax@18
  int v4; // [sp+4h] [bp-70h]@1
  int v5; // [sp+8h] [bp-6Ch]@1
  int v6; // [sp+Ch] [bp-68h]@1
  int v7; // [sp+10h] [bp-64h]@1
  int v8; // [sp+14h] [bp-60h]@1
  int v9; // [sp+18h] [bp-5Ch]@1
  int v10; // [sp+1Ch] [bp-58h]@1
  int v11; // [sp+20h] [bp-54h]@1
  int v12; // [sp+24h] [bp-50h]@1
  int v13; // [sp+28h] [bp-4Ch]@1
  int v14; // [sp+2Ch] [bp-48h]@1
  int v15; // [sp+30h] [bp-44h]@1
  int v16; // [sp+34h] [bp-40h]@1
  int v17; // [sp+38h] [bp-3Ch]@1
  int v18; // [sp+3Ch] [bp-38h]@1
  int v19; // [sp+40h] [bp-34h]@1
  int v20; // [sp+44h] [bp-30h]@1
  int v21; // [sp+48h] [bp-2Ch]@1
  int v22; // [sp+4Ch] [bp-28h]@1
  int v23; // [sp+50h] [bp-24h]@1
  int v24; // [sp+54h] [bp-20h]@1
  int v25; // [sp+58h] [bp-1Ch]@1
  int v26; // [sp+5Ch] [bp-18h]@1
  int v27; // [sp+60h] [bp-14h]@1
  int v28; // [sp+64h] [bp-10h]@1
  int v29; // [sp+68h] [bp-Ch]@1
  int v30; // [sp+6Ch] [bp-8h]@1
  int v31; // [sp+70h] [bp-4h]@1

  v4 = 256;
  v5 = 56;
  v6 = 272;
  v7 = 80;
  v8 = 272;
  v9 = 56;
  v10 = 288;
  v11 = 80;
  v12 = 288;
  v13 = 56;
  v14 = 304;
  v15 = 80;
  v16 = 256;
  v17 = 56;
  v18 = 272;
  v19 = 80;
  v20 = 304;
  v21 = 56;
  v22 = 320;
  v23 = 80;
  v24 = 256;
  v25 = 56;
  v26 = 272;
  v27 = 80;
  v28 = 240;
  v29 = 56;
  v30 = 256;
  v31 = 80;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_10;
    case 0xB:
LABEL_10:
      *(_DWORD *)(a1 + 16) = 512;
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      ++*(_DWORD *)(a1 + 120);
      break;
    case 0x14:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 104) = 6;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00452D10) --------------------------------------------------------
void __cdecl NPC227_Bucket(NPC_vars *npc)
{
  RECT *npc_Rect; // eax@1

  npc_Rect = &npc->Rect;
  npc_Rect->left = 208;
  npc_Rect->top = 32;
  npc_Rect->right = 224;
  npc_Rect->bottom = 48;
}

//----- (00452D60) --------------------------------------------------------
int __cdecl NPC228(int a1)
{
  int *v1; // eax@26
  int v2; // ecx@26
  int result; // eax@26
  int *v4; // eax@27
  int v5; // ecx@27
  int v6; // [sp+4h] [bp-80h]@1
  int v7; // [sp+8h] [bp-7Ch]@1
  int v8; // [sp+Ch] [bp-78h]@1
  int v9; // [sp+10h] [bp-74h]@1
  int v10; // [sp+14h] [bp-70h]@1
  int v11; // [sp+18h] [bp-6Ch]@1
  int v12; // [sp+1Ch] [bp-68h]@1
  int v13; // [sp+20h] [bp-64h]@1
  int v14; // [sp+24h] [bp-60h]@1
  int v15; // [sp+28h] [bp-5Ch]@1
  int v16; // [sp+2Ch] [bp-58h]@1
  int v17; // [sp+30h] [bp-54h]@1
  int v18; // [sp+34h] [bp-50h]@1
  int v19; // [sp+38h] [bp-4Ch]@1
  int v20; // [sp+3Ch] [bp-48h]@1
  int v21; // [sp+40h] [bp-44h]@1
  int v22; // [sp+44h] [bp-40h]@1
  int v23; // [sp+48h] [bp-3Ch]@1
  int v24; // [sp+4Ch] [bp-38h]@1
  int v25; // [sp+50h] [bp-34h]@1
  int v26; // [sp+54h] [bp-30h]@1
  int v27; // [sp+58h] [bp-2Ch]@1
  int v28; // [sp+5Ch] [bp-28h]@1
  int v29; // [sp+60h] [bp-24h]@1
  int v30; // [sp+64h] [bp-20h]@1
  int v31; // [sp+68h] [bp-1Ch]@1
  int v32; // [sp+6Ch] [bp-18h]@1
  int v33; // [sp+70h] [bp-14h]@1
  int v34; // [sp+74h] [bp-10h]@1
  int v35; // [sp+78h] [bp-Ch]@1
  int v36; // [sp+7Ch] [bp-8h]@1
  int v37; // [sp+80h] [bp-4h]@1

  v22 = 0;
  v23 = 0;
  v24 = 32;
  v25 = 40;
  v26 = 32;
  v27 = 0;
  v28 = 64;
  v29 = 40;
  v30 = 64;
  v31 = 0;
  v32 = 96;
  v33 = 40;
  v34 = 96;
  v35 = 0;
  v36 = 128;
  v37 = 40;
  v6 = 0;
  v7 = 40;
  v8 = 32;
  v9 = 80;
  v10 = 32;
  v11 = 40;
  v12 = 64;
  v13 = 80;
  v14 = 64;
  v15 = 40;
  v16 = 96;
  v17 = 80;
  v18 = 96;
  v19 = 40;
  v20 = 128;
  v21 = 80;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 116) = 2;
      *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_4;
    case 2:
LABEL_4:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( ++*(_DWORD *)(a1 + 100) > 50 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_13;
    case 0xB:
LABEL_13:
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 104) = 3;
        *(_DWORD *)(a1 + 20) = -1536;
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = 512;
        else
          *(_DWORD *)(a1 + 16) = -512;
      }
      break;
    case 0xC:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 116) = 13;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 0xD:
      *(_DWORD *)(a1 + 16) /= 2;
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
        *(_DWORD *)(a1 + 116) = 1;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v22 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (004530D0) --------------------------------------------------------
signed int __cdecl NPC229(int a1)
{
  int v1; // ecx@4
  signed int result; // eax@4
  int v3; // ecx@5

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) -= 0x2000;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 0;
    *(_DWORD *)(v3 + 4) = 112;
    *(_DWORD *)(v3 + 8) = 48;
    result = 128;
    *(_DWORD *)(v3 + 12) = 128;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 0;
    *(_DWORD *)(v1 + 4) = 96;
    *(_DWORD *)(v1 + 8) = 48;
    result = 112;
    *(_DWORD *)(v1 + 12) = 112;
  }
  return result;
}

//----- (00453190) --------------------------------------------------------
signed int __cdecl NPC230(int a1)
{
  int v1; // ecx@4
  signed int result; // eax@4
  int v3; // ecx@5

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 8) -= 0x2000;
    *(_DWORD *)(a1 + 12) -= 0x2000;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 96;
    *(_DWORD *)(v3 + 4) = 96;
    *(_DWORD *)(v3 + 8) = 144;
    result = 128;
    *(_DWORD *)(v3 + 12) = 128;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 48;
    *(_DWORD *)(v1 + 4) = 96;
    *(_DWORD *)(v1 + 8) = 96;
    result = 128;
    *(_DWORD *)(v1 + 12) = 128;
  }
  return result;
}

//----- (00453260) --------------------------------------------------------
int __cdecl NPC231(int a1)
{
  int v1; // ST08_4@12
  int v2; // eax@12
  int v3; // ST08_4@27
  int v4; // eax@27
  int *v5; // ecx@42
  int v6; // edx@42
  int result; // eax@42
  signed int i; // [sp+4h] [bp-24h]@10
  signed int j; // [sp+4h] [bp-24h]@25
  int v10; // [sp+8h] [bp-20h]@1
  int v11; // [sp+Ch] [bp-1Ch]@1
  int v12; // [sp+10h] [bp-18h]@1
  int v13; // [sp+14h] [bp-14h]@1
  int v14; // [sp+18h] [bp-10h]@1
  int v15; // [sp+1Ch] [bp-Ch]@1
  int v16; // [sp+20h] [bp-8h]@1
  int v17; // [sp+24h] [bp-4h]@1

  v10 = 176;
  v11 = 32;
  v12 = 208;
  v13 = 48;
  v14 = 176;
  v15 = 48;
  v16 = 208;
  v17 = 64;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_5;
    case 0xB:
LABEL_5:
      ++*(_DWORD *)(a1 + 120);
      *(_DWORD *)(a1 + 20) += 8;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        if ( *(_DWORD *)(a1 + 120) >= 10 )
          *(_DWORD *)(a1 + 116) = 1;
        else
          *(_DWORD *)(a1 + 116) = 12;
      }
      break;
    case 0xC:
      *(_WORD *)(a1 + 80) &= 0xDFFFu;
      *(_DWORD *)(a1 + 116) = 13;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 1;
      for ( i = 0; i < 10; ++i )
      {
        v1 = *(_DWORD *)(a1 + 12) + (Random(-8, 8) << 9);
        v2 = Random(-16, 16);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v2 << 9), v1, 0, 0, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      }
      goto LABEL_13;
    case 0xD:
LABEL_13:
      *(_DWORD *)(a1 + 20) -= 8;
      if ( !(++*(_DWORD *)(a1 + 120) % 2) )
        Create_Effect(*(_DWORD *)(a1 + 8) - 5120, *(_DWORD *)(a1 + 12) + 4096, 7, 3);
      if ( *(_DWORD *)(a1 + 120) % 2 == 1 )
        Create_Effect(*(_DWORD *)(a1 + 8) + 5120, *(_DWORD *)(a1 + 12) + 4096, 7, 3);
      if ( *(_DWORD *)(a1 + 120) % 4 == 1 )
        Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
      if ( *(_DWORD *)(a1 + 4) & 2 || Quote.Collision_Flags & 2 || *(_DWORD *)(a1 + 120) > 450 )
      {
        if ( *(_DWORD *)(a1 + 4) & 2 || Quote.Collision_Flags & 2 )
          *(_DWORD *)(a1 + 20) = 0;
        *(_DWORD *)(a1 + 116) = 15;
        for ( j = 0; j < 6; ++j )
        {
          v3 = *(_DWORD *)(a1 + 12) + (Random(-8, 8) << 9);
          v4 = Random(-16, 16);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        }
      }
      break;
    case 0xF:
      *(_DWORD *)(a1 + 20) += 8;
      ++*(_DWORD *)(a1 + 120);
      if ( *(_DWORD *)(a1 + 20) < 0 )
      {
        if ( !(*(_DWORD *)(a1 + 120) % 8) )
          Create_Effect(*(_DWORD *)(a1 + 8) - 5120, *(_DWORD *)(a1 + 12) + 4096, 7, 3);
        if ( *(_DWORD *)(a1 + 120) % 8 == 4 )
          Create_Effect(*(_DWORD *)(a1 + 8) + 5120, *(_DWORD *)(a1 + 12) + 4096, 7, 3);
        if ( *(_DWORD *)(a1 + 120) % 16 == 1 )
          Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_WORD *)(a1 + 80) |= 0x2000u;
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 20) < -1535 )
    *(_DWORD *)(a1 + 20) = -1535;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v5 = &v10 + 4 * *(_DWORD *)(a1 + 104);
  v6 = a1 + 84;
  *(_DWORD *)v6 = *v5;
  *(_DWORD *)(v6 + 4) = v5[1];
  result = v5[2];
  *(_DWORD *)(v6 + 8) = result;
  *(_DWORD *)(v6 + 12) = v5[3];
  return result;
}

//----- (004536F0) --------------------------------------------------------
int __cdecl NPC232(NPC_vars *a1)
{
  int *v1; // eax@28
  char *v2; // ecx@28
  int result; // eax@28
  int *v4; // eax@29
  char *v5; // ecx@29
  int v6; // [sp+0h] [bp-68h]@1
  int v7; // [sp+4h] [bp-64h]@27
  int v8; // [sp+8h] [bp-60h]@27
  int v9; // [sp+Ch] [bp-5Ch]@27
  int v10; // [sp+10h] [bp-58h]@27
  int v11; // [sp+14h] [bp-54h]@27
  int v12; // [sp+18h] [bp-50h]@27
  int v13; // [sp+1Ch] [bp-4Ch]@27
  int v14; // [sp+20h] [bp-48h]@27
  int v15; // [sp+24h] [bp-44h]@27
  int v16; // [sp+28h] [bp-40h]@27
  int v17; // [sp+2Ch] [bp-3Ch]@27
  int v18; // [sp+30h] [bp-38h]@27
  int i; // [sp+34h] [bp-34h]@4
  int v20; // [sp+38h] [bp-30h]@27
  int v21; // [sp+3Ch] [bp-2Ch]@27
  int v22; // [sp+40h] [bp-28h]@27
  int v23; // [sp+44h] [bp-24h]@27
  int v24; // [sp+48h] [bp-20h]@27
  int v25; // [sp+4Ch] [bp-1Ch]@27
  int v26; // [sp+50h] [bp-18h]@27
  int v27; // [sp+54h] [bp-14h]@27
  int v28; // [sp+58h] [bp-10h]@27
  int v29; // [sp+5Ch] [bp-Ch]@27
  int v30; // [sp+60h] [bp-8h]@27
  int v31; // [sp+64h] [bp-4h]@27

  v6 = a1->Current_State;
  if ( v6 )
  {
    if ( v6 != 1 )
      goto LABEL_27;
  }
  else
  {
    a1->Current_State = 1;
    a1->Curly_Target_X = a1->X_pos;
    a1->Curly_Target_Y = a1->Y_pos;
    a1->Y_vel = 512;
    for ( i = 0; i < 8; ++i )
      NPC_Create((NPC_Names)233, a1->X_pos, a1->Y_pos, 0, 0, (Directions)a1->Direction, a1, 256);
  }
  if ( a1->X_vel < 0 && a1->Collision_flags & 1 )
    a1->Direction = 2;
  if ( a1->X_vel > 0 && a1->Collision_flags & 4 )
    a1->Direction = 0;
  if ( a1->Direction )
    a1->X_vel = 256;
  else
    a1->X_vel = -256;
  if ( a1->Y_pos >= a1->Curly_Target_Y )
    a1->Y_vel -= 8;
  else
    a1->Y_vel += 8;
  if ( a1->Y_vel > 512 )
    a1->Y_vel = 512;
  if ( a1->Y_vel < -512 )
    a1->Y_vel = -512;
  if ( ++a1->ani_wait > 5 )
  {
    a1->ani_wait = 0;
    ++a1->Ani_Num;
  }
  if ( a1->Ani_Num > 2 )
    a1->Ani_Num = 0;
LABEL_27:
  a1->Y_pos += a1->Y_vel;
  a1->X_pos += a1->X_vel;
  v20 = 128;
  v21 = 0;
  v22 = 160;
  v23 = 32;
  v24 = 160;
  v25 = 0;
  v26 = 192;
  v27 = 32;
  v28 = 192;
  v29 = 0;
  v30 = 224;
  v31 = 32;
  v7 = 128;
  v8 = 32;
  v9 = 160;
  v10 = 64;
  v11 = 160;
  v12 = 32;
  v13 = 192;
  v14 = 64;
  v15 = 192;
  v16 = 32;
  v17 = 224;
  v18 = 64;
  if ( a1->Direction )
  {
    v4 = &v7 + 4 * a1->Ani_Num;
    v5 = (char *)&a1->Rect;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    *((_DWORD *)v5 + 2) = v4[2];
    result = v4[3];
    *((_DWORD *)v5 + 3) = result;
  }
  else
  {
    v1 = &v20 + 4 * a1->Ani_Num;
    v2 = (char *)&a1->Rect;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    *((_DWORD *)v2 + 2) = v1[2];
    result = v1[3];
    *((_DWORD *)v2 + 3) = result;
  }
  return result;
}

//----- (004539B0) --------------------------------------------------------
void __cdecl NPC233(NPC_vars *npc)
{
  unsigned __int8 v1; // al@5
  int *v2; // ecx@43
  char *v3; // edx@43
  int *v4; // ecx@44
  char *v5; // edx@44
  int npc_Current_State; // [sp+0h] [bp-8Ch]@1
  int v7; // [sp+4h] [bp-88h]@36
  int v8; // [sp+8h] [bp-84h]@36
  int v9; // [sp+Ch] [bp-80h]@36
  int v10; // [sp+10h] [bp-7Ch]@36
  int v11; // [sp+14h] [bp-78h]@36
  int v12; // [sp+18h] [bp-74h]@36
  int v13; // [sp+1Ch] [bp-70h]@36
  int v14; // [sp+20h] [bp-6Ch]@36
  int v15; // [sp+24h] [bp-68h]@36
  int v16; // [sp+28h] [bp-64h]@36
  int v17; // [sp+2Ch] [bp-60h]@36
  int v18; // [sp+30h] [bp-5Ch]@36
  int v19; // [sp+34h] [bp-58h]@36
  int v20; // [sp+38h] [bp-54h]@36
  int v21; // [sp+3Ch] [bp-50h]@36
  int v22; // [sp+40h] [bp-4Ch]@36
  int v23; // [sp+44h] [bp-48h]@36
  int v24; // [sp+48h] [bp-44h]@36
  int v25; // [sp+4Ch] [bp-40h]@36
  int v26; // [sp+50h] [bp-3Ch]@36
  int v27; // [sp+54h] [bp-38h]@36
  int v28; // [sp+58h] [bp-34h]@36
  int v29; // [sp+5Ch] [bp-30h]@36
  int v30; // [sp+60h] [bp-2Ch]@36
  int v31; // [sp+64h] [bp-28h]@36
  int v32; // [sp+68h] [bp-24h]@36
  int v33; // [sp+6Ch] [bp-20h]@36
  int v34; // [sp+70h] [bp-1Ch]@36
  int v35; // [sp+74h] [bp-18h]@36
  int v36; // [sp+78h] [bp-14h]@36
  int v37; // [sp+7Ch] [bp-10h]@36
  int v38; // [sp+80h] [bp-Ch]@36
  unsigned __int8 v39; // [sp+8Bh] [bp-1h]@5

  npc_Current_State = npc->Current_State;
  if ( !npc_Current_State )
  {
    npc->Current_State = 1;
    v1 = Random(0, 255);
    npc->X_vel = GetCos(v1);
    v39 = Random(0, 255);
    npc->Y_vel = GetSin(v39);
    npc->count1 = 120;
    npc->count2 = Random(-32, 32) << 9;
  }
  else if ( npc_Current_State != 1 )
  {
    if ( npc_Current_State == 3 )
    {
      npc->Y_vel += 64;
      if ( npc->Y_vel > 1535 )
        npc->Y_vel = 1535;
      if ( npc->Collision_flags & 8 )
      {
        npc->Y_vel = 0;
        npc->X_vel *= 2;
        npc->count1 = 0;
        npc->Current_State = 1;
        npc->Entity_Flags |= 8u;
      }
    }
    goto LABEL_36;
  }
  if ( npc->Parent_NPC->Entity_Type == 232 )
  {
    npc->Curly_Target_X = npc->Parent_NPC->X_pos;
    npc->Curly_Target_Y = npc->Parent_NPC->Y_pos;
    npc->Direction = npc->Parent_NPC->Direction;
  }
  if ( npc->Curly_Target_X < npc->X_pos )
    npc->X_vel -= 8;
  if ( npc->Curly_Target_X > npc->X_pos )
    npc->X_vel += 8;
  if ( npc->count2 + npc->Curly_Target_Y < npc->Y_pos )
    npc->Y_vel -= 32;
  if ( npc->count2 + npc->Curly_Target_Y > npc->Y_pos )
    npc->Y_vel += 32;
  if ( npc->X_vel > 1024 )
    npc->X_vel = 1024;
  if ( npc->X_vel < -1024 )
    npc->X_vel = -1024;
  if ( npc->Y_vel > 1024 )
    npc->Y_vel = 1024;
  if ( npc->Y_vel < -1024 )
    npc->Y_vel = -1024;
  if ( npc->count1 >= 120 )
  {
    if ( npc->X_pos - 4096 < Quote.X_Pos
      && npc->X_pos + 4096 > Quote.X_Pos
      && npc->Y_pos < Quote.Y_Pos
      && npc->Y_pos + 90112 > Quote.Y_Pos )
    {
      npc->X_vel /= 4;
      npc->Y_vel = 0;
      npc->Current_State = 3;
      npc->Entity_Flags &= 0xFFF7u;
    }
  }
  else
  {
    ++npc->count1;
  }
LABEL_36:
  npc->X_pos += npc->X_vel;
  npc->Y_pos += npc->Y_vel;
  v23 = 256;
  v24 = 0;
  v25 = 272;
  v26 = 16;
  v27 = 272;
  v28 = 0;
  v29 = 288;
  v30 = 16;
  v31 = 288;
  v32 = 0;
  v33 = 304;
  v34 = 16;
  v35 = 304;
  v36 = 0;
  v37 = 320;
  v38 = 16;
  v7 = 256;
  v8 = 16;
  v9 = 272;
  v10 = 32;
  v11 = 272;
  v12 = 16;
  v13 = 288;
  v14 = 32;
  v15 = 288;
  v16 = 16;
  v17 = 304;
  v18 = 32;
  v19 = 304;
  v20 = 16;
  v21 = 320;
  v22 = 32;
  if ( npc->Current_State == 3 )
  {
    npc->Ani_Num = 3;
  }
  else
  {
    if ( ++npc->ani_wait > 1 )
    {
      npc->ani_wait = 0;
      ++npc->Ani_Num;
    }
    if ( npc->Ani_Num > 2 )
      npc->Ani_Num = 0;
  }
  if ( npc->Direction )
  {
    v4 = &v7 + 4 * npc->Ani_Num;
    v5 = (char *)&npc->Rect;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    *((_DWORD *)v5 + 2) = v4[2];
    *((_DWORD *)v5 + 3) = v4[3];
  }
  else
  {
    v2 = &v23 + 4 * npc->Ani_Num;
    v3 = (char *)&npc->Rect;
    *(_DWORD *)v3 = *v2;
    *((_DWORD *)v3 + 1) = v2[1];
    *((_DWORD *)v3 + 2) = v2[2];
    *((_DWORD *)v3 + 3) = v2[3];
  }
}

//----- (00453E60) --------------------------------------------------------
signed int __cdecl NPC234(int a1)
{
  int v1; // ecx@4
  signed int result; // eax@4
  int v3; // ecx@5

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) += 0x2000;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 144;
    *(_DWORD *)(v3 + 4) = 112;
    *(_DWORD *)(v3 + 8) = 192;
    result = 128;
    *(_DWORD *)(v3 + 12) = 128;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 144;
    *(_DWORD *)(v1 + 4) = 96;
    *(_DWORD *)(v1 + 8) = 192;
    result = 112;
    *(_DWORD *)(v1 + 12) = 112;
  }
  return result;
}

//----- (00453F20) --------------------------------------------------------
int __cdecl NPC235(int a1)
{
  int *v1; // eax@35
  int v2; // ecx@35
  int result; // eax@35
  int *v4; // eax@36
  int v5; // ecx@36
  int v6; // [sp+4h] [bp-80h]@1
  int v7; // [sp+8h] [bp-7Ch]@1
  int v8; // [sp+Ch] [bp-78h]@1
  int v9; // [sp+10h] [bp-74h]@1
  int v10; // [sp+14h] [bp-70h]@1
  int v11; // [sp+18h] [bp-6Ch]@1
  int v12; // [sp+1Ch] [bp-68h]@1
  int v13; // [sp+20h] [bp-64h]@1
  int v14; // [sp+24h] [bp-60h]@1
  int v15; // [sp+28h] [bp-5Ch]@1
  int v16; // [sp+2Ch] [bp-58h]@1
  int v17; // [sp+30h] [bp-54h]@1
  int v18; // [sp+34h] [bp-50h]@1
  int v19; // [sp+38h] [bp-4Ch]@1
  int v20; // [sp+3Ch] [bp-48h]@1
  int v21; // [sp+40h] [bp-44h]@1
  int v22; // [sp+44h] [bp-40h]@1
  int v23; // [sp+48h] [bp-3Ch]@1
  int v24; // [sp+4Ch] [bp-38h]@1
  int v25; // [sp+50h] [bp-34h]@1
  int v26; // [sp+54h] [bp-30h]@1
  int v27; // [sp+58h] [bp-2Ch]@1
  int v28; // [sp+5Ch] [bp-28h]@1
  int v29; // [sp+60h] [bp-24h]@1
  int v30; // [sp+64h] [bp-20h]@1
  int v31; // [sp+68h] [bp-1Ch]@1
  int v32; // [sp+6Ch] [bp-18h]@1
  int v33; // [sp+70h] [bp-14h]@1
  int v34; // [sp+74h] [bp-10h]@1
  int v35; // [sp+78h] [bp-Ch]@1
  int v36; // [sp+7Ch] [bp-8h]@1
  int v37; // [sp+80h] [bp-4h]@1

  v22 = 192;
  v23 = 96;
  v24 = 208;
  v25 = 112;
  v26 = 208;
  v27 = 96;
  v28 = 224;
  v29 = 112;
  v30 = 224;
  v31 = 96;
  v32 = 240;
  v33 = 112;
  v34 = 192;
  v35 = 96;
  v36 = 208;
  v37 = 112;
  v6 = 192;
  v7 = 112;
  v8 = 208;
  v9 = 128;
  v10 = 208;
  v11 = 112;
  v12 = 224;
  v13 = 128;
  v14 = 224;
  v15 = 112;
  v16 = 240;
  v17 = 128;
  v18 = 192;
  v19 = 112;
  v20 = 208;
  v21 = 128;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 30) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( Random(0, 30) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = Random(0, 16);
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      if ( Random(0, 9) % 2 )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      goto LABEL_14;
    case 0xB:
LABEL_14:
      if ( *(_DWORD *)(a1 + 76) || !(*(_DWORD *)(a1 + 4) & 1) )
      {
        if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 4) & 4 )
          *(_DWORD *)(a1 + 76) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 1024;
      else
        *(_DWORD *)(a1 + 16) = -1024;
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( ++*(_DWORD *)(a1 + 120) > 64 )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 104) == 2 )
    *(_DWORD *)(a1 + 128) = 2560;
  else
    *(_DWORD *)(a1 + 128) = 2048;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v22 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00454310) --------------------------------------------------------
int __cdecl NPC236(int a1)
{
  int *v1; // edx@47
  int result; // eax@47
  int *v3; // edx@48
  int v4; // [sp+4h] [bp-C0h]@1
  int v5; // [sp+8h] [bp-BCh]@1
  int v6; // [sp+Ch] [bp-B8h]@1
  int v7; // [sp+10h] [bp-B4h]@1
  int v8; // [sp+14h] [bp-B0h]@1
  int v9; // [sp+18h] [bp-ACh]@1
  int v10; // [sp+1Ch] [bp-A8h]@1
  int v11; // [sp+20h] [bp-A4h]@1
  int v12; // [sp+24h] [bp-A0h]@1
  int v13; // [sp+28h] [bp-9Ch]@1
  int v14; // [sp+2Ch] [bp-98h]@1
  int v15; // [sp+30h] [bp-94h]@1
  int v16; // [sp+34h] [bp-90h]@1
  int v17; // [sp+38h] [bp-8Ch]@1
  int v18; // [sp+3Ch] [bp-88h]@1
  int v19; // [sp+40h] [bp-84h]@1
  int v20; // [sp+44h] [bp-80h]@1
  int v21; // [sp+48h] [bp-7Ch]@1
  int v22; // [sp+4Ch] [bp-78h]@1
  int v23; // [sp+50h] [bp-74h]@1
  int v24; // [sp+54h] [bp-70h]@1
  int v25; // [sp+58h] [bp-6Ch]@1
  int v26; // [sp+5Ch] [bp-68h]@1
  int v27; // [sp+60h] [bp-64h]@1
  int v28; // [sp+64h] [bp-60h]@1
  int v29; // [sp+68h] [bp-5Ch]@1
  int v30; // [sp+6Ch] [bp-58h]@1
  int v31; // [sp+70h] [bp-54h]@1
  int v32; // [sp+74h] [bp-50h]@1
  int v33; // [sp+78h] [bp-4Ch]@1
  int v34; // [sp+7Ch] [bp-48h]@1
  int v35; // [sp+80h] [bp-44h]@1
  int v36; // [sp+84h] [bp-40h]@1
  int v37; // [sp+88h] [bp-3Ch]@1
  int v38; // [sp+8Ch] [bp-38h]@1
  int v39; // [sp+90h] [bp-34h]@1
  int v40; // [sp+94h] [bp-30h]@1
  int v41; // [sp+98h] [bp-2Ch]@1
  int v42; // [sp+9Ch] [bp-28h]@1
  int v43; // [sp+A0h] [bp-24h]@1
  int v44; // [sp+A4h] [bp-20h]@1
  int v45; // [sp+A8h] [bp-1Ch]@1
  int v46; // [sp+ACh] [bp-18h]@1
  int v47; // [sp+B0h] [bp-14h]@1
  int v48; // [sp+B4h] [bp-10h]@1
  int v49; // [sp+B8h] [bp-Ch]@1
  int v50; // [sp+BCh] [bp-8h]@1
  int v51; // [sp+C0h] [bp-4h]@1

  v28 = 128;
  v29 = 64;
  v30 = 152;
  v31 = 88;
  v32 = 152;
  v33 = 64;
  v34 = 176;
  v35 = 88;
  v36 = 176;
  v37 = 64;
  v38 = 200;
  v39 = 88;
  v40 = 200;
  v41 = 64;
  v42 = 224;
  v43 = 88;
  v44 = 224;
  v45 = 64;
  v46 = 248;
  v47 = 88;
  v48 = 248;
  v49 = 64;
  v50 = 272;
  v51 = 88;
  v4 = 128;
  v5 = 88;
  v6 = 152;
  v7 = 112;
  v8 = 152;
  v9 = 88;
  v10 = 176;
  v11 = 112;
  v12 = 176;
  v13 = 88;
  v14 = 200;
  v15 = 112;
  v16 = 200;
  v17 = 88;
  v18 = 224;
  v19 = 112;
  v20 = 224;
  v21 = 88;
  v22 = 248;
  v23 = 112;
  v24 = 248;
  v25 = 88;
  v26 = 272;
  v27 = 112;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = Random(0, 50);
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 20) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 120) )
      {
        --*(_DWORD *)(a1 + 120);
      }
      else
      {
        *(_DWORD *)(a1 + 20) = 512;
        *(_DWORD *)(a1 + 116) = 2;
      }
      break;
    case 2:
      if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 0x10000
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 0x10000
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x4000
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 81920 )
      {
        ++*(_DWORD *)(a1 + 120);
      }
      if ( *(_DWORD *)(a1 + 120) > 80 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 20;
      }
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 2;
      break;
    case 0x14:
      if ( ++*(_DWORD *)(a1 + 120) > 60 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 2;
      }
      if ( *(_DWORD *)(a1 + 120) % 10 == 3 )
      {
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        if ( *(_DWORD *)(a1 + 76) )
          NPC_Create((NPC_Names)237, *(_DWORD *)(a1 + 8) + 4096, *(_DWORD *)(a1 + 12) - 4096, 1024, -1024, 0, NULL, 256);
        else
          NPC_Create(
            (NPC_Names)237,
            *(_DWORD *)(a1 + 8) - 4096,
            *(_DWORD *)(a1 + 12) - 4096,
            -1024,
            -1024,
            0,
            NULL,
            256);
      }
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 4;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
    *(_DWORD *)(a1 + 20) -= 16;
  else
    *(_DWORD *)(a1 + 20) += 16;
  if ( *(_DWORD *)(a1 + 20) > 256 )
    *(_DWORD *)(a1 + 20) = 256;
  if ( *(_DWORD *)(a1 + 20) < -256 )
    *(_DWORD *)(a1 + 20) = -256;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v28 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (004548B0) --------------------------------------------------------
void __cdecl NPC237(int a1)
{
  int v1; // eax@17
  int v2; // [sp+0h] [bp-1Ch]@1
  signed int v3; // [sp+4h] [bp-18h]@5
  signed int i; // [sp+8h] [bp-14h]@11

  v2 = *(_DWORD *)(a1 + 116);
  if ( v2 )
  {
    if ( v2 != 1 )
      goto LABEL_15;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  v3 = 0;
  ++*(_DWORD *)(a1 + 120);
  if ( *(_DWORD *)(a1 + 4) & 0xFF )
    v3 = 1;
  if ( *(_DWORD *)(a1 + 120) > 10 && *(_DWORD *)(a1 + 4) & 0x100 )
    v3 = 1;
  if ( v3 )
  {
    for ( i = 0; i < 5; ++i )
      Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 1, 0);
    Play_Sound_Effect(Sfx_Bubble, 1);
    *(_BYTE *)a1 = 0;
    return;
  }
LABEL_15:
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = a1 + 84;
  *(_DWORD *)v1 = 312;
  *(_DWORD *)(v1 + 4) = 32;
  *(_DWORD *)(v1 + 8) = 320;
  *(_DWORD *)(v1 + 12) = 40;
}

//----- (00454A00) --------------------------------------------------------
int __cdecl NPC238(int a1)
{
  int v1; // ST08_4@22
  int v2; // eax@22
  int *v3; // ecx@39
  int v4; // edx@39
  int result; // eax@39
  signed int i; // [sp+4h] [bp-34h]@20
  int v7; // [sp+8h] [bp-30h]@1
  int v8; // [sp+Ch] [bp-2Ch]@1
  int v9; // [sp+10h] [bp-28h]@1
  int v10; // [sp+14h] [bp-24h]@1
  int v11; // [sp+18h] [bp-20h]@1
  int v12; // [sp+1Ch] [bp-1Ch]@1
  int v13; // [sp+20h] [bp-18h]@1
  int v14; // [sp+24h] [bp-14h]@1
  int v15; // [sp+28h] [bp-10h]@1
  int v16; // [sp+2Ch] [bp-Ch]@1
  int v17; // [sp+30h] [bp-8h]@1
  int v18; // [sp+34h] [bp-4h]@1

  v7 = 184;
  v8 = 200;
  v9 = 208;
  v10 = 216;
  v11 = 208;
  v12 = 200;
  v13 = 232;
  v14 = 216;
  v15 = 232;
  v16 = 200;
  v17 = 256;
  v18 = 216;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 140) = 0x2000;
      *(_DWORD *)(a1 + 148) = 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( !*(_DWORD *)(a1 + 76)
        && Quote.X_Pos < *(_DWORD *)(a1 + 8)
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 98304
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 2048
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 4096 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
      }
      if ( *(_DWORD *)(a1 + 76) == 2
        && Quote.X_Pos > *(_DWORD *)(a1 + 8)
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 98304
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 2048
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 4096 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 164) = 127;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) += 3072;
      else
        *(_DWORD *)(a1 + 8) -= 3072;
      if ( ++*(_DWORD *)(a1 + 120) == 8 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        for ( i = 0; i < 4; ++i )
        {
          v1 = *(_DWORD *)(a1 + 12) + (Random(-8, 8) << 9);
          v2 = Random(-16, 16);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v2 << 9), v1, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        }
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 164) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 116) = 30;
      }
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 164) = 0;
      *(_DWORD *)(a1 + 104) = 1;
      if ( ++*(_DWORD *)(a1 + 120) == 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
      }
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 8) -= 2048;
      else
        *(_DWORD *)(a1 + 8) += 2048;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) || Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
  {
    if ( *(_DWORD *)(a1 + 76) != 2 || Quote.X_Pos <= *(_DWORD *)(a1 + 8) )
      *(_DWORD *)(a1 + 132) = 4096;
    else
      *(_DWORD *)(a1 + 132) = 0x2000;
  }
  else
  {
    *(_DWORD *)(a1 + 132) = 0x2000;
  }
  v3 = &v7 + 4 * *(_DWORD *)(a1 + 104);
  v4 = a1 + 84;
  *(_DWORD *)v4 = *v3;
  *(_DWORD *)(v4 + 4) = v3[1];
  result = v3[2];
  *(_DWORD *)(v4 + 8) = result;
  *(_DWORD *)(v4 + 12) = v3[3];
  return result;
}

//----- (00454DF0) --------------------------------------------------------
int __cdecl NPC239(int a1)
{
  int result; // eax@6

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) )
    {
      *(_DWORD *)(a1 + 140) = 12288;
      *(_DWORD *)(a1 + 148) = 12288;
      *(_DWORD *)(a1 + 144) = 4096;
      *(_DWORD *)(a1 + 148) = 12288;
    }
    else
    {
      *(_DWORD *)(a1 + 8) += 4096;
      *(_DWORD *)(a1 + 12) += 0x2000;
    }
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    result = a1 + 84;
    *(_DWORD *)result = 96;
    *(_DWORD *)(result + 4) = 112;
    *(_DWORD *)(result + 8) = 144;
    *(_DWORD *)(result + 12) = 144;
  }
  else
  {
    result = a1 + 84;
    *(_DWORD *)result = 192;
    *(_DWORD *)(result + 4) = 48;
    *(_DWORD *)(result + 8) = 256;
    *(_DWORD *)(result + 12) = 80;
  }
  return result;
}

//----- (00454F00) --------------------------------------------------------
int __cdecl NPC240(int a1)
{
  int *v1; // eax@32
  int v2; // ecx@32
  int result; // eax@32
  int *v4; // eax@33
  int v5; // ecx@33
  int v6; // [sp+4h] [bp-C0h]@1
  int v7; // [sp+8h] [bp-BCh]@1
  int v8; // [sp+Ch] [bp-B8h]@1
  int v9; // [sp+10h] [bp-B4h]@1
  int v10; // [sp+14h] [bp-B0h]@1
  int v11; // [sp+18h] [bp-ACh]@1
  int v12; // [sp+1Ch] [bp-A8h]@1
  int v13; // [sp+20h] [bp-A4h]@1
  int v14; // [sp+24h] [bp-A0h]@1
  int v15; // [sp+28h] [bp-9Ch]@1
  int v16; // [sp+2Ch] [bp-98h]@1
  int v17; // [sp+30h] [bp-94h]@1
  int v18; // [sp+34h] [bp-90h]@1
  int v19; // [sp+38h] [bp-8Ch]@1
  int v20; // [sp+3Ch] [bp-88h]@1
  int v21; // [sp+40h] [bp-84h]@1
  int v22; // [sp+44h] [bp-80h]@1
  int v23; // [sp+48h] [bp-7Ch]@1
  int v24; // [sp+4Ch] [bp-78h]@1
  int v25; // [sp+50h] [bp-74h]@1
  int v26; // [sp+54h] [bp-70h]@1
  int v27; // [sp+58h] [bp-6Ch]@1
  int v28; // [sp+5Ch] [bp-68h]@1
  int v29; // [sp+60h] [bp-64h]@1
  int v30; // [sp+64h] [bp-60h]@1
  int v31; // [sp+68h] [bp-5Ch]@1
  int v32; // [sp+6Ch] [bp-58h]@1
  int v33; // [sp+70h] [bp-54h]@1
  int v34; // [sp+74h] [bp-50h]@1
  int v35; // [sp+78h] [bp-4Ch]@1
  int v36; // [sp+7Ch] [bp-48h]@1
  int v37; // [sp+80h] [bp-44h]@1
  int v38; // [sp+84h] [bp-40h]@1
  int v39; // [sp+88h] [bp-3Ch]@1
  int v40; // [sp+8Ch] [bp-38h]@1
  int v41; // [sp+90h] [bp-34h]@1
  int v42; // [sp+94h] [bp-30h]@1
  int v43; // [sp+98h] [bp-2Ch]@1
  int v44; // [sp+9Ch] [bp-28h]@1
  int v45; // [sp+A0h] [bp-24h]@1
  int v46; // [sp+A4h] [bp-20h]@1
  int v47; // [sp+A8h] [bp-1Ch]@1
  int v48; // [sp+ACh] [bp-18h]@1
  int v49; // [sp+B0h] [bp-14h]@1
  int v50; // [sp+B4h] [bp-10h]@1
  int v51; // [sp+B8h] [bp-Ch]@1
  int v52; // [sp+BCh] [bp-8h]@1
  int v53; // [sp+C0h] [bp-4h]@1

  v30 = 160;
  v31 = 64;
  v32 = 176;
  v33 = 80;
  v34 = 176;
  v35 = 64;
  v36 = 192;
  v37 = 80;
  v38 = 192;
  v39 = 64;
  v40 = 208;
  v41 = 80;
  v42 = 160;
  v43 = 64;
  v44 = 176;
  v45 = 80;
  v46 = 208;
  v47 = 64;
  v48 = 224;
  v49 = 80;
  v50 = 160;
  v51 = 64;
  v52 = 176;
  v53 = 80;
  v6 = 160;
  v7 = 80;
  v8 = 176;
  v9 = 96;
  v10 = 176;
  v11 = 80;
  v12 = 192;
  v13 = 96;
  v14 = 192;
  v15 = 80;
  v16 = 208;
  v17 = 96;
  v18 = 160;
  v19 = 80;
  v20 = 176;
  v21 = 96;
  v22 = 208;
  v23 = 80;
  v24 = 224;
  v25 = 96;
  v26 = 160;
  v27 = 80;
  v28 = 176;
  v29 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = Random(0, 16);
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      if ( Random(0, 9) % 2 )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      goto LABEL_14;
    case 0xB:
LABEL_14:
      if ( *(_DWORD *)(a1 + 76) || !(*(_DWORD *)(a1 + 4) & 1) )
      {
        if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 4) & 4 )
          *(_DWORD *)(a1 + 76) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 512;
      else
        *(_DWORD *)(a1 + 16) = -512;
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( ++*(_DWORD *)(a1 + 120) > 32 )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v30 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00455370) --------------------------------------------------------
int __cdecl NPC241(int a1)
{
  int *v1; // eax@34
  int v2; // ecx@34
  int result; // eax@34
  int *v4; // eax@35
  int v5; // ecx@35
  int v6; // [sp+4h] [bp-60h]@1
  int v7; // [sp+8h] [bp-5Ch]@1
  int v8; // [sp+Ch] [bp-58h]@1
  int v9; // [sp+10h] [bp-54h]@1
  int v10; // [sp+14h] [bp-50h]@1
  int v11; // [sp+18h] [bp-4Ch]@1
  int v12; // [sp+1Ch] [bp-48h]@1
  int v13; // [sp+20h] [bp-44h]@1
  int v14; // [sp+24h] [bp-40h]@1
  int v15; // [sp+28h] [bp-3Ch]@1
  int v16; // [sp+2Ch] [bp-38h]@1
  int v17; // [sp+30h] [bp-34h]@1
  int v18; // [sp+34h] [bp-30h]@1
  int v19; // [sp+38h] [bp-2Ch]@1
  int v20; // [sp+3Ch] [bp-28h]@1
  int v21; // [sp+40h] [bp-24h]@1
  int v22; // [sp+44h] [bp-20h]@1
  int v23; // [sp+48h] [bp-1Ch]@1
  int v24; // [sp+4Ch] [bp-18h]@1
  int v25; // [sp+50h] [bp-14h]@1
  int v26; // [sp+54h] [bp-10h]@1
  int v27; // [sp+58h] [bp-Ch]@1
  int v28; // [sp+5Ch] [bp-8h]@1
  int v29; // [sp+60h] [bp-4h]@1

  v18 = 0;
  v19 = 0;
  v20 = 16;
  v21 = 16;
  v22 = 16;
  v23 = 0;
  v24 = 32;
  v25 = 16;
  v26 = 32;
  v27 = 0;
  v28 = 48;
  v29 = 16;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 32;
  v10 = 16;
  v11 = 16;
  v12 = 32;
  v13 = 32;
  v14 = 32;
  v15 = 16;
  v16 = 48;
  v17 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 12) += 1536;
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( *(_DWORD *)(a1 + 120) < 8
        || *(_DWORD *)(a1 + 8) - 73728 >= Quote.X_Pos
        || *(_DWORD *)(a1 + 8) + 73728 <= Quote.X_Pos
        || *(_DWORD *)(a1 + 12) - 40960 >= Quote.Y_Pos
        || *(_DWORD *)(a1 + 12) + 40960 <= Quote.Y_Pos )
      {
        if ( *(_DWORD *)(a1 + 120) < 8 )
          ++*(_DWORD *)(a1 + 120);
        *(_DWORD *)(a1 + 104) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( *(_DWORD *)(a1 + 120) >= 8
        && *(_DWORD *)(a1 + 8) - 49152 < Quote.X_Pos
        && *(_DWORD *)(a1 + 8) + 49152 > Quote.X_Pos
        && *(_DWORD *)(a1 + 12) - 40960 < Quote.Y_Pos
        && *(_DWORD *)(a1 + 12) + 49152 > Quote.Y_Pos )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 20) = -1535;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = 512;
        else
          *(_DWORD *)(a1 + 16) = -512;
      }
      break;
    case 3:
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 116) = 1;
        Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 85;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v18 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00455710) --------------------------------------------------------
void __cdecl NPC242(void *npc)
{
  int *v1; // eax@28
  char *v2; // ecx@28
  int *v3; // eax@29
  char *v4; // ecx@29
  int v5; // [sp+0h] [bp-84h]@4
  int v6; // [sp+4h] [bp-80h]@23
  int v7; // [sp+8h] [bp-7Ch]@23
  int v8; // [sp+Ch] [bp-78h]@23
  int v9; // [sp+10h] [bp-74h]@23
  int v10; // [sp+14h] [bp-70h]@23
  int v11; // [sp+18h] [bp-6Ch]@23
  int v12; // [sp+1Ch] [bp-68h]@23
  int v13; // [sp+20h] [bp-64h]@23
  int v14; // [sp+24h] [bp-60h]@23
  int v15; // [sp+28h] [bp-5Ch]@23
  int v16; // [sp+2Ch] [bp-58h]@23
  int v17; // [sp+30h] [bp-54h]@23
  int v18; // [sp+34h] [bp-50h]@23
  int v19; // [sp+38h] [bp-4Ch]@23
  int v20; // [sp+3Ch] [bp-48h]@23
  int v21; // [sp+40h] [bp-44h]@23
  int v22; // [sp+44h] [bp-40h]@23
  int v23; // [sp+48h] [bp-3Ch]@23
  int v24; // [sp+4Ch] [bp-38h]@23
  int v25; // [sp+50h] [bp-34h]@23
  int v26; // [sp+54h] [bp-30h]@23
  int v27; // [sp+58h] [bp-2Ch]@23
  int v28; // [sp+5Ch] [bp-28h]@23
  int v29; // [sp+60h] [bp-24h]@23
  int v30; // [sp+64h] [bp-20h]@23
  int v31; // [sp+68h] [bp-1Ch]@23
  int v32; // [sp+6Ch] [bp-18h]@23
  int v33; // [sp+70h] [bp-14h]@23
  int v34; // [sp+74h] [bp-10h]@23
  int v35; // [sp+78h] [bp-Ch]@23
  int v36; // [sp+7Ch] [bp-8h]@23
  int v37; // [sp+80h] [bp-4h]@23

  if ( *((_DWORD *)npc + 2) < 0 || *((_DWORD *)npc + 2) > Current_Map.Width << 13 )
  {
    Vanish_NPC((NPC_vars *)npc);
    return;
  }
  v5 = *((_DWORD *)npc + 29);
  if ( v5 )
  {
    if ( v5 != 1 )
    {
      if ( v5 != 2 )
        goto LABEL_23;
LABEL_12:
      if ( *((_DWORD *)npc + 19) )
        *((_DWORD *)npc + 4) = 256;
      else
        *((_DWORD *)npc + 4) = -256;
      if ( *((_DWORD *)npc + 9) < *((_DWORD *)npc + 3) )
        *((_DWORD *)npc + 5) -= 16;
      if ( *((_DWORD *)npc + 9) > *((_DWORD *)npc + 3) )
        *((_DWORD *)npc + 5) += 16;
      if ( *((_DWORD *)npc + 5) > 768 )
        *((_DWORD *)npc + 5) = 768;
      if ( *((_DWORD *)npc + 5) < -768 )
        *((_DWORD *)npc + 5) = -768;
      goto LABEL_23;
    }
  }
  else
  {
    *((_DWORD *)npc + 29) = 1;
    *((_DWORD *)npc + 8) = *((_DWORD *)npc + 2);
    *((_DWORD *)npc + 9) = *((_DWORD *)npc + 3);
    *((_DWORD *)npc + 30) = Random(0, 50);
  }
  if ( !*((_DWORD *)npc + 30) )
  {
    *((_DWORD *)npc + 29) = 2;
    *((_DWORD *)npc + 5) = 1024;
    goto LABEL_12;
  }
  --*((_DWORD *)npc + 30);
LABEL_23:
  *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
  *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
  v22 = 32;
  v23 = 32;
  v24 = 48;
  v25 = 48;
  v26 = 48;
  v27 = 32;
  v28 = 64;
  v29 = 48;
  v30 = 64;
  v31 = 32;
  v32 = 80;
  v33 = 48;
  v34 = 80;
  v35 = 32;
  v36 = 96;
  v37 = 48;
  v6 = 32;
  v7 = 48;
  v8 = 48;
  v9 = 64;
  v10 = 48;
  v11 = 48;
  v12 = 64;
  v13 = 64;
  v14 = 64;
  v15 = 48;
  v16 = 80;
  v17 = 64;
  v18 = 80;
  v19 = 48;
  v20 = 96;
  v21 = 64;
  if ( ++*((_DWORD *)npc + 25) > 1 )
  {
    *((_DWORD *)npc + 25) = 0;
    ++*((_DWORD *)npc + 26);
  }
  if ( *((_DWORD *)npc + 26) > 2 )
    *((_DWORD *)npc + 26) = 0;
  if ( *((_DWORD *)npc + 19) )
  {
    v3 = &v6 + 4 * *((_DWORD *)npc + 26);
    v4 = (char *)npc + 84;
    *(_DWORD *)v4 = *v3;
    *((_DWORD *)v4 + 1) = v3[1];
    *((_DWORD *)v4 + 2) = v3[2];
    *((_DWORD *)v4 + 3) = v3[3];
  }
  else
  {
    v1 = &v22 + 4 * *((_DWORD *)npc + 26);
    v2 = (char *)npc + 84;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    *((_DWORD *)v2 + 2) = v1[2];
    *((_DWORD *)v2 + 3) = v1[3];
  }
}

//----- (00455A10) --------------------------------------------------------
void __cdecl NPC243(int a1)
{
  Directions v1; // ST14_4@7
  int v2; // eax@7
  int v3; // [sp+0h] [bp-4h]@1

  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
      return;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 120) = Random(0, 500);
  }
  if ( *(_DWORD *)(a1 + 120) )
  {
    --*(_DWORD *)(a1 + 120);
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 0;
    v1 = *(_DWORD *)(a1 + 76);
    v2 = Random(-32, 32);
    NPC_Create((NPC_Names)242, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v2 << 9), 0, 0, v1, NULL, 256);
  }
}

//----- (00455AB0) --------------------------------------------------------
signed int __cdecl NPC244(signed int a1)
{
  signed int result; // eax@15
  int v2; // ecx@18
  signed int v3; // [sp+0h] [bp-18h]@1
  signed int i; // [sp+4h] [bp-14h]@7

  *(_DWORD *)(a1 + 20) += 64;
  v3 = 0;
  if ( *(_DWORD *)(a1 + 4) & 0xFF )
    v3 = 1;
  if ( *(_DWORD *)(a1 + 120) > 10 && *(_DWORD *)(a1 + 4) & 0x100 )
    v3 = 1;
  if ( v3 )
  {
    for ( i = 0; i < 3; ++i )
      Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + 2048, 1, 2);
    if ( *(_DWORD *)(a1 + 8) > Quote.X_Pos - 0x20000
      && *(_DWORD *)(a1 + 8) < Quote.X_Pos + 0x20000
      && *(_DWORD *)(a1 + 12) > Quote.Y_Pos - 81920
      && *(_DWORD *)(a1 + 12) < Quote.Y_Pos + 81920 )
    {
      Play_Sound_Effect(Sfx_Bubble, 1);
    }
    result = a1;
    *(_BYTE *)a1 = 0;
  }
  else
  {
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    v2 = a1 + 84;
    *(_DWORD *)v2 = 96;
    *(_DWORD *)(v2 + 4) = 0;
    *(_DWORD *)(v2 + 8) = 104;
    result = 16;
    *(_DWORD *)(v2 + 12) = 16;
  }
  return result;
}

//----- (00455C10) --------------------------------------------------------
int __cdecl NPC245(int a1)
{
  int result; // eax@7
  int *v2; // ecx@16
  int v3; // edx@16
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  v9 = 104;
  v10 = 0;
  v11 = 112;
  v12 = 16;
  v13 = 112;
  v14 = 0;
  v15 = 120;
  v16 = 16;
  v17 = 120;
  v18 = 0;
  v19 = 128;
  v20 = 16;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 10 )
      {
        if ( ++*(_DWORD *)(a1 + 100) > 10 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 3 )
        {
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 116) = 1;
          *(_DWORD *)(a1 + 120) = *(_DWORD *)(a1 + 44);
          NPC_Create((NPC_Names)244, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 256);
        }
      }
      goto LABEL_13;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 120) = *(_DWORD *)(a1 + 48);
  }
  *(_DWORD *)(a1 + 104) = 0;
  if ( *(_DWORD *)(a1 + 120) )
  {
    result = *(_DWORD *)(a1 + 120) - 1;
    *(_DWORD *)(a1 + 120) = result;
    return result;
  }
  *(_DWORD *)(a1 + 116) = 10;
  *(_DWORD *)(a1 + 100) = 0;
LABEL_13:
  if ( *(_DWORD *)(a1 + 100) / 2 % 2 )
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
  else
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + 512;
  v2 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v3 = a1 + 84;
  *(_DWORD *)v3 = *v2;
  *(_DWORD *)(v3 + 4) = v2[1];
  result = v2[2];
  *(_DWORD *)(v3 + 8) = result;
  *(_DWORD *)(v3 + 12) = v2[3];
  return result;
}

//----- (00455E00) --------------------------------------------------------
int __cdecl NPC246(int a1)
{
  int v1; // ST10_4@23
  int v2; // eax@23
  int *v3; // eax@30
  int v4; // ecx@30
  int result; // eax@30
  signed int i; // [sp+4h] [bp-34h]@21
  int v7; // [sp+8h] [bp-30h]@1
  int v8; // [sp+Ch] [bp-2Ch]@1
  int v9; // [sp+10h] [bp-28h]@1
  int v10; // [sp+14h] [bp-24h]@1
  int v11; // [sp+18h] [bp-20h]@1
  int v12; // [sp+1Ch] [bp-1Ch]@1
  int v13; // [sp+20h] [bp-18h]@1
  int v14; // [sp+24h] [bp-14h]@1
  int v15; // [sp+28h] [bp-10h]@1
  int v16; // [sp+2Ch] [bp-Ch]@1
  int v17; // [sp+30h] [bp-8h]@1
  int v18; // [sp+34h] [bp-4h]@1

  v7 = 144;
  v8 = 112;
  v9 = 160;
  v10 = 136;
  v11 = 160;
  v12 = 112;
  v13 = 176;
  v14 = 136;
  v15 = 176;
  v16 = 112;
  v17 = 192;
  v18 = 136;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 2048;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 4096
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 4096
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) + 4096
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x10000 )
      {
        *(_DWORD *)(a1 + 116) = 5;
      }
      break;
    case 5:
      if ( !(*(_DWORD *)(a1 + 4) & 8) )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 0xA:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( Quote.Y_Pos <= *(_DWORD *)(a1 + 12) )
      {
        *(_WORD *)(a1 + 80) |= 0x40u;
        *(_DWORD *)(a1 + 164) = 0;
      }
      else
      {
        *(_WORD *)(a1 + 80) &= 0xFFBFu;
        *(_DWORD *)(a1 + 164) = 127;
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        if ( *(_DWORD *)(a1 + 104) > 1 )
        {
          for ( i = 0; i < 4; ++i )
          {
            v1 = Random(-1536, 0);
            v2 = Random(-341, 341);
            NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), v2, v1, 0, NULL, 256);
          }
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
          Set_Quake(10);
        }
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        *(_WORD *)(a1 + 80) |= 0x40u;
        *(_DWORD *)(a1 + 164) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 116) >= 5 )
  {
    *(_DWORD *)(a1 + 20) += 128;
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  }
  v3 = &v7 + 4 * *(_DWORD *)(a1 + 104);
  v4 = a1 + 84;
  *(_DWORD *)v4 = *v3;
  *(_DWORD *)(v4 + 4) = v3[1];
  *(_DWORD *)(v4 + 8) = v3[2];
  result = v3[3];
  *(_DWORD *)(v4 + 12) = result;
  return result;
}

//----- (00456110) --------------------------------------------------------
LONG *__cdecl NPC247(NPC_vars *a1)
{
  int Y_Vel; // ST24_4@56
  int *v2; // edx@109
  LONG *result; // eax@109
  int *v4; // edx@110
  int v5; // [sp+0h] [bp-138h]@1
  int v6; // [sp+8h] [bp-130h]@1
  int v7; // [sp+Ch] [bp-12Ch]@1
  int v8; // [sp+10h] [bp-128h]@1
  int v9; // [sp+14h] [bp-124h]@1
  int v10; // [sp+18h] [bp-120h]@1
  int v11; // [sp+1Ch] [bp-11Ch]@1
  int v12; // [sp+20h] [bp-118h]@1
  int v13; // [sp+24h] [bp-114h]@1
  int v14; // [sp+28h] [bp-110h]@1
  int v15; // [sp+2Ch] [bp-10Ch]@1
  int v16; // [sp+30h] [bp-108h]@1
  int v17; // [sp+34h] [bp-104h]@1
  int v18; // [sp+38h] [bp-100h]@1
  int v19; // [sp+3Ch] [bp-FCh]@1
  int v20; // [sp+40h] [bp-F8h]@1
  int v21; // [sp+44h] [bp-F4h]@1
  int v22; // [sp+48h] [bp-F0h]@1
  int v23; // [sp+4Ch] [bp-ECh]@1
  int v24; // [sp+50h] [bp-E8h]@1
  int v25; // [sp+54h] [bp-E4h]@1
  int v26; // [sp+58h] [bp-E0h]@1
  int v27; // [sp+5Ch] [bp-DCh]@1
  int v28; // [sp+60h] [bp-D8h]@1
  int v29; // [sp+64h] [bp-D4h]@1
  int v30; // [sp+68h] [bp-D0h]@1
  int v31; // [sp+6Ch] [bp-CCh]@1
  int v32; // [sp+70h] [bp-C8h]@1
  int v33; // [sp+74h] [bp-C4h]@1
  int v34; // [sp+78h] [bp-C0h]@1
  int v35; // [sp+7Ch] [bp-BCh]@1
  int v36; // [sp+80h] [bp-B8h]@1
  int v37; // [sp+84h] [bp-B4h]@1
  int v38; // [sp+88h] [bp-B0h]@1
  int v39; // [sp+8Ch] [bp-ACh]@1
  int v40; // [sp+90h] [bp-A8h]@1
  int v41; // [sp+94h] [bp-A4h]@1
  int X_Vel; // [sp+9Ch] [bp-9Ch]@56
  int v43; // [sp+A0h] [bp-98h]@1
  int v44; // [sp+A4h] [bp-94h]@1
  int v45; // [sp+A8h] [bp-90h]@1
  int v46; // [sp+ACh] [bp-8Ch]@1
  int v47; // [sp+B0h] [bp-88h]@1
  int v48; // [sp+B4h] [bp-84h]@1
  int v49; // [sp+B8h] [bp-80h]@1
  int v50; // [sp+BCh] [bp-7Ch]@1
  int v51; // [sp+C0h] [bp-78h]@1
  int v52; // [sp+C4h] [bp-74h]@1
  int v53; // [sp+C8h] [bp-70h]@1
  int v54; // [sp+CCh] [bp-6Ch]@1
  int v55; // [sp+D0h] [bp-68h]@1
  int v56; // [sp+D4h] [bp-64h]@1
  int v57; // [sp+D8h] [bp-60h]@1
  int v58; // [sp+DCh] [bp-5Ch]@1
  int v59; // [sp+E0h] [bp-58h]@1
  int v60; // [sp+E4h] [bp-54h]@1
  int v61; // [sp+E8h] [bp-50h]@1
  int v62; // [sp+ECh] [bp-4Ch]@1
  int v63; // [sp+F0h] [bp-48h]@1
  int v64; // [sp+F4h] [bp-44h]@1
  int v65; // [sp+F8h] [bp-40h]@1
  int v66; // [sp+FCh] [bp-3Ch]@1
  int v67; // [sp+100h] [bp-38h]@1
  int v68; // [sp+104h] [bp-34h]@1
  int v69; // [sp+108h] [bp-30h]@1
  int v70; // [sp+10Ch] [bp-2Ch]@1
  int v71; // [sp+110h] [bp-28h]@1
  int v72; // [sp+114h] [bp-24h]@1
  int v73; // [sp+118h] [bp-20h]@1
  int v74; // [sp+11Ch] [bp-1Ch]@1
  int v75; // [sp+120h] [bp-18h]@1
  int v76; // [sp+124h] [bp-14h]@1
  int v77; // [sp+128h] [bp-10h]@1
  int v78; // [sp+12Ch] [bp-Ch]@1
  unsigned __int8 v79; // [sp+137h] [bp-1h]@56

  v43 = 0;
  v44 = 0;
  v45 = 16;
  v46 = 16;
  v47 = 16;
  v48 = 0;
  v49 = 32;
  v50 = 16;
  v51 = 32;
  v52 = 0;
  v53 = 48;
  v54 = 16;
  v55 = 48;
  v56 = 0;
  v57 = 64;
  v58 = 16;
  v59 = 64;
  v60 = 0;
  v61 = 80;
  v62 = 16;
  v63 = 80;
  v64 = 0;
  v65 = 96;
  v66 = 16;
  v67 = 96;
  v68 = 0;
  v69 = 112;
  v70 = 16;
  v71 = 0;
  v72 = 0;
  v73 = 0;
  v74 = 0;
  v75 = 112;
  v76 = 0;
  v77 = 128;
  v78 = 16;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 32;
  v10 = 16;
  v11 = 16;
  v12 = 32;
  v13 = 32;
  v14 = 32;
  v15 = 16;
  v16 = 48;
  v17 = 32;
  v18 = 48;
  v19 = 16;
  v20 = 64;
  v21 = 32;
  v22 = 64;
  v23 = 16;
  v24 = 80;
  v25 = 32;
  v26 = 80;
  v27 = 16;
  v28 = 96;
  v29 = 32;
  v30 = 96;
  v31 = 16;
  v32 = 112;
  v33 = 32;
  v34 = 0;
  v35 = 0;
  v36 = 0;
  v37 = 0;
  v38 = 112;
  v39 = 16;
  v40 = 128;
  v41 = 32;
  v5 = a1->Current_State;
  if ( v5 <= 111 )
  {
    if ( v5 == 111 )
    {
LABEL_46:
      if ( ++a1->Wait_Timer % 2 )
        a1->Ani_Num = 5;
      else
        a1->Ani_Num = 6;
      if ( a1->Wait_Timer > 30 )
      {
        a1->Wait_Timer = 0;
        if ( ++a1->count1 % 3 )
          a1->Current_State = 112;
        else
          a1->Current_State = 113;
        a1->Ani_Num = 4;
      }
    }
    else
    {
      switch ( v5 )
      {
        case 0:
          a1->Current_State = 1;
          a1->Y_pos += 3072;
          a1->Curly_Target_Y = 0x8000;
          goto LABEL_15;
        case 1:
LABEL_15:
          if ( Random(0, 120) == 10 )
          {
            a1->Current_State = 2;
            a1->Wait_Timer = 0;
            a1->Ani_Num = 1;
          }
          goto LABEL_100;
        case 2:
          if ( ++a1->Wait_Timer > 8 )
          {
            a1->Current_State = 1;
            a1->Ani_Num = 0;
          }
          goto LABEL_100;
        case 20:
          a1->X_vel = 0;
          a1->Y_vel += 64;
          if ( a1->Collision_flags & 8 )
          {
            a1->Current_State = 21;
            a1->Ani_Num = 2;
          }
          goto LABEL_100;
        case 21:
          if ( Random(0, 120) == 10 )
          {
            a1->Current_State = 22;
            a1->Wait_Timer = 0;
            a1->Ani_Num = 3;
          }
          goto LABEL_100;
        case 22:
          if ( ++a1->Wait_Timer > 8 )
          {
            a1->Current_State = 21;
            a1->Ani_Num = 2;
          }
          goto LABEL_100;
        case 100:
          a1->Current_State = 101;
          a1->Wait_Timer = 0;
          a1->Ani_Num = 0;
          a1->X_vel = 0;
          a1->Entity_Flags |= 0x20u;
          a1->count2 = a1->Life;
          goto LABEL_31;
        case 101:
LABEL_31:
          if ( Quote.X_Pos >= a1->X_pos )
            a1->Direction = 2;
          else
            a1->Direction = 0;
          if ( a1->Y_pos >= a1->Curly_Target_Y )
            a1->Y_vel -= 32;
          else
            a1->Y_vel += 32;
          if ( a1->Y_vel < -512 )
            a1->Y_vel = -512;
          if ( a1->Y_vel > 512 )
            a1->Y_vel = 512;
          if ( ++a1->Wait_Timer > 200 || a1->Life <= a1->count2 - 80 )
          {
            a1->Wait_Timer = 0;
            a1->Current_State = 110;
          }
          break;
        case 110:
          a1->Current_State = 111;
          a1->Wait_Timer = 0;
          a1->X_vel = 0;
          a1->Y_vel = 0;
          a1->Entity_Flags &= 0xFFDFu;
          goto LABEL_46;
        default:
          goto LABEL_100;
      }
    }
    goto LABEL_100;
  }
  if ( v5 <= 160 )
  {
    if ( v5 != 160 )
    {
      switch ( v5 )
      {
        case 112:
          if ( !(++a1->Wait_Timer % 6) )
          {
            v79 = GetArcTan(a1->X_pos - Quote.X_Pos, a1->Y_pos - Quote.Y_Pos);
            v79 += Random(-4, 4);
            Y_Vel = 4 * GetSin(v79);
            X_Vel = 4 * GetCos(v79);
            NPC_Create((NPC_Names)248, a1->X_pos, a1->Y_pos + 2048, X_Vel, Y_Vel, 0, NULL, 256);
            Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
          }
          if ( a1->Wait_Timer > 30 )
          {
            a1->Wait_Timer = 0;
            a1->Current_State = 150;
          }
          break;
        case 113:
          if ( ++a1->Wait_Timer == 10 )
            NPC_Create(Enemy_Basil|0x110, Quote.X_Pos, Quote.Y_Pos - 0x8000, 0, 0, Up, NULL, 256);
          if ( a1->Wait_Timer > 30 )
          {
            a1->Wait_Timer = 0;
            a1->Current_State = 150;
          }
          break;
        case 150:
          a1->Current_State = 151;
          a1->Wait_Timer = 0;
          a1->Ani_Num = 7;
          NPC_Create((NPC_Names)249, a1->X_pos, a1->Y_pos, 0, 0, 0, NULL, 256);
          NPC_Create((NPC_Names)249, a1->X_pos, a1->Y_pos, 0, 0, Right, NULL, 256);
          a1->Curly_Target_X = Random(9, 31) << 13;
          a1->Curly_Target_Y = Random(5, 7) << 13;
          Play_Sound_Effect(Sfx_Teleport, 1);
          goto LABEL_66;
        case 151:
LABEL_66:
          if ( ++a1->Wait_Timer == 42 )
          {
            NPC_Create((NPC_Names)249, a1->Curly_Target_X + 0x2000, a1->Curly_Target_Y, 0, 0, 0, NULL, 256);
            NPC_Create((NPC_Names)249, a1->Curly_Target_X - 0x2000, a1->Curly_Target_Y, 0, 0, Right, NULL, 256);
          }
          if ( a1->Wait_Timer > 50 )
          {
            a1->Wait_Timer = 0;
            a1->Y_vel = -512;
            a1->Entity_Flags |= 0x20u;
            a1->X_pos = a1->Curly_Target_X;
            a1->Y_pos = a1->Curly_Target_Y;
            if ( a1->Life < 340 )
            {
              NPC_Create((NPC_Names)252, 0, 0, 0, 0, 0, a1, 256);
              NPC_Create((NPC_Names)252, 0, 0, 0, 0, (Directions)128, a1, 256);
            }
            if ( a1->Life < 180 )
            {
              NPC_Create((NPC_Names)252, 0, 0, 0, 0, (Directions)64, a1, 256);
              NPC_Create((NPC_Names)252, 0, 0, 0, 0, (Directions)192, a1, 256);
            }
            if ( Quote.X_Pos >= a1->X_pos - 57344 && Quote.X_Pos <= a1->X_pos + 57344 )
              a1->Current_State = 100;
            else
              a1->Current_State = 160;
          }
          break;
        default:
          goto LABEL_100;
      }
      goto LABEL_100;
    }
    a1->Current_State = 161;
    a1->Wait_Timer = 0;
    a1->Ani_Num = 4;
    if ( Quote.X_Pos >= a1->X_pos )
      a1->Direction = 2;
    else
      a1->Direction = 0;
    goto LABEL_81;
  }
  if ( v5 <= 1001 )
  {
    if ( v5 != 1001 )
    {
      if ( v5 == 161 )
      {
LABEL_81:
        if ( a1->Y_pos >= a1->Curly_Target_Y )
          a1->Y_vel -= 32;
        else
          a1->Y_vel += 32;
        if ( a1->Y_vel < -512 )
          a1->Y_vel = -512;
        if ( a1->Y_vel > 512 )
          a1->Y_vel = 512;
        if ( !(++a1->Wait_Timer % 24) )
        {
          NPC_Create((NPC_Names)250, a1->X_pos, a1->Y_pos + 2048, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Fireball_Bounce, 1);
        }
        if ( a1->Wait_Timer > 72 )
        {
          a1->Wait_Timer = 0;
          a1->Current_State = 100;
        }
        goto LABEL_100;
      }
      if ( v5 != 1000 )
        goto LABEL_100;
      a1->Entity_Flags &= 0xFFDFu;
      a1->Current_State = 1001;
      a1->Wait_Timer = 0;
      a1->Ani_Num = 4;
      a1->Curly_Target_X = a1->X_pos;
      a1->Curly_Target_Y = a1->Y_pos;
      a1->X_vel = 0;
      a1->Y_vel = 0;
      Kill_NPC(252, 1);
      NPC_Create(Smoke, a1->X_pos, a1->Y_pos, 0, 0, 0, NULL, 256);
      NPC_Create(Smoke, a1->X_pos, a1->Y_pos, 0, 0, 0, NULL, 256);
      NPC_Create(Smoke, a1->X_pos, a1->Y_pos, 0, 0, 0, NULL, 256);
    }
    if ( ++a1->Wait_Timer / 2 % 2 )
      a1->X_pos = a1->Curly_Target_X + 512;
    else
      a1->X_pos = a1->Curly_Target_X;
    goto LABEL_100;
  }
  if ( v5 == 1010 )
  {
    a1->Y_vel += 16;
    if ( a1->Collision_flags & 8 )
    {
      a1->Current_State = 1020;
      a1->Ani_Num = 8;
    }
  }
LABEL_100:
  if ( a1->X_vel < -512 )
    a1->X_vel = -512;
  if ( a1->X_vel > 512 )
    a1->X_vel = 512;
  if ( a1->Y_vel < -1024 )
    a1->Y_vel = -1024;
  if ( a1->Y_vel > 1024 )
    a1->Y_vel = 1024;
  a1->X_pos += a1->X_vel;
  a1->Y_pos += a1->Y_vel;
  if ( a1->Direction )
  {
    v4 = &v6 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v4;
    result[1] = v4[1];
    result[2] = v4[2];
    result[3] = v4[3];
  }
  else
  {
    v2 = &v43 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v2;
    result[1] = v2[1];
    result[2] = v2[2];
    result[3] = v2[3];
  }
  return result;
}

//----- (00456F50) --------------------------------------------------------
void __cdecl NPC248(int a1)
{
  int *v1; // eax@6
  int v2; // ecx@6
  int v3; // [sp+0h] [bp-30h]@3
  int v4; // [sp+4h] [bp-2Ch]@3
  int v5; // [sp+8h] [bp-28h]@3
  int v6; // [sp+Ch] [bp-24h]@3
  int v7; // [sp+10h] [bp-20h]@3
  int v8; // [sp+14h] [bp-1Ch]@3
  int v9; // [sp+18h] [bp-18h]@3
  int v10; // [sp+1Ch] [bp-14h]@3
  int v11; // [sp+20h] [bp-10h]@3
  int v12; // [sp+24h] [bp-Ch]@3
  int v13; // [sp+28h] [bp-8h]@3
  int v14; // [sp+2Ch] [bp-4h]@3

  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v3 = 0;
  v4 = 48;
  v5 = 16;
  v6 = 64;
  v7 = 16;
  v8 = 48;
  v9 = 32;
  v10 = 64;
  v11 = 32;
  v12 = 48;
  v13 = 48;
  v14 = 64;
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    if ( ++*(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
  }
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( ++*(_DWORD *)(a1 + 108) > 300 )
  {
    *(_BYTE *)a1 = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
  }
}

//----- (004570B0) --------------------------------------------------------
int __cdecl NPC249(int a1)
{
  int v1; // eax@4
  int result; // eax@4
  int v3; // eax@5

  if ( ++*(_DWORD *)(a1 + 120) > 8 )
    *(_BYTE *)a1 = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 64;
    *(_DWORD *)(v3 + 4) = 48;
    *(_DWORD *)(v3 + 8) = 80;
    *(_DWORD *)(v3 + 12) = 64;
    result = a1;
    *(_DWORD *)(a1 + 8) += 1024;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 48;
    *(_DWORD *)(v1 + 4) = 48;
    *(_DWORD *)(v1 + 8) = 64;
    *(_DWORD *)(v1 + 12) = 64;
    result = a1;
    *(_DWORD *)(a1 + 8) -= 1024;
  }
  return result;
}

//----- (00457180) --------------------------------------------------------
void __cdecl NPC250(int a1)
{
  int *v1; // ecx@32
  int v2; // edx@32
  int v3; // [sp+4h] [bp-30h]@1
  int v4; // [sp+8h] [bp-2Ch]@1
  int v5; // [sp+Ch] [bp-28h]@1
  int v6; // [sp+10h] [bp-24h]@1
  int v7; // [sp+14h] [bp-20h]@1
  int v8; // [sp+18h] [bp-1Ch]@1
  int v9; // [sp+1Ch] [bp-18h]@1
  int v10; // [sp+20h] [bp-14h]@1
  int v11; // [sp+24h] [bp-10h]@1
  int v12; // [sp+28h] [bp-Ch]@1
  int v13; // [sp+2Ch] [bp-8h]@1
  int v14; // [sp+30h] [bp-4h]@1

  v3 = 0;
  v4 = 32;
  v5 = 16;
  v6 = 48;
  v7 = 16;
  v8 = 32;
  v9 = 32;
  v10 = 48;
  v11 = 32;
  v12 = 32;
  v13 = 48;
  v14 = 48;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = -512;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        *(_DWORD *)(a1 + 16) -= 16;
      else
        *(_DWORD *)(a1 + 16) += 16;
      if ( *(_DWORD *)(a1 + 12) >= *(_DWORD *)(a1 + 36) )
        *(_DWORD *)(a1 + 20) -= 32;
      else
        *(_DWORD *)(a1 + 20) += 32;
      if ( *(_DWORD *)(a1 + 16) > 512 )
        *(_DWORD *)(a1 + 16) = 512;
      if ( *(_DWORD *)(a1 + 16) < -512 )
        *(_DWORD *)(a1 + 16) = -512;
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 20) = 512;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 4096
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 4096
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      goto LABEL_32;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_27;
    case 0xB:
LABEL_27:
      if ( ++*(_DWORD *)(a1 + 120) <= 10 )
      {
        if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
          *(_DWORD *)(a1 + 104) = 2;
        else
          *(_DWORD *)(a1 + 104) = 1;
LABEL_32:
        v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
        v2 = a1 + 84;
        *(_DWORD *)v2 = *v1;
        *(_DWORD *)(v2 + 4) = v1[1];
        *(_DWORD *)(v2 + 8) = v1[2];
        *(_DWORD *)(v2 + 12) = v1[3];
      }
      else
      {
        NPC_Create((NPC_Names)251, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Lightning, 1);
        *(_BYTE *)a1 = 0;
      }
      return;
    default:
      goto LABEL_32;
  }
}

//----- (00457470) --------------------------------------------------------
int __cdecl NPC251(int a1)
{
  int *v1; // ecx@9
  int v2; // edx@9
  int result; // eax@9
  int v4; // [sp+0h] [bp-24h]@1
  int v5; // [sp+4h] [bp-20h]@1
  int v6; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+Ch] [bp-18h]@1
  int v8; // [sp+10h] [bp-14h]@1
  int v9; // [sp+14h] [bp-10h]@1
  int v10; // [sp+18h] [bp-Ch]@1
  int v11; // [sp+1Ch] [bp-8h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v5 = 80;
  v6 = 32;
  v7 = 96;
  v8 = 64;
  v9 = 96;
  v10 = 32;
  v11 = 112;
  v12 = 64;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_9;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( ++*(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  *(_DWORD *)(a1 + 12) += 4096;
  if ( *(_DWORD *)(a1 + 4) & 0xFF )
  {
    Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 3);
    *(_BYTE *)a1 = 0;
  }
LABEL_9:
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00457570) --------------------------------------------------------
int __cdecl NPC252(int a1)
{
  int v1; // esi@5
  int v2; // esi@5
  int *v3; // edx@18
  int result; // eax@18
  int *v5; // edx@19
  int v6; // [sp+4h] [bp-88h]@1
  int v7; // [sp+8h] [bp-84h]@1
  int v8; // [sp+Ch] [bp-80h]@1
  int v9; // [sp+10h] [bp-7Ch]@1
  int v10; // [sp+14h] [bp-78h]@1
  int v11; // [sp+18h] [bp-74h]@1
  int v12; // [sp+1Ch] [bp-70h]@1
  int v13; // [sp+20h] [bp-6Ch]@1
  int v14; // [sp+24h] [bp-68h]@1
  int v15; // [sp+28h] [bp-64h]@1
  int v16; // [sp+2Ch] [bp-60h]@1
  int v17; // [sp+30h] [bp-5Ch]@1
  int v18; // [sp+34h] [bp-58h]@1
  int v19; // [sp+38h] [bp-54h]@1
  int v20; // [sp+3Ch] [bp-50h]@1
  int v21; // [sp+40h] [bp-4Ch]@1
  int v22; // [sp+44h] [bp-48h]@1
  int v23; // [sp+48h] [bp-44h]@1
  int v24; // [sp+4Ch] [bp-40h]@1
  int v25; // [sp+50h] [bp-3Ch]@1
  int v26; // [sp+54h] [bp-38h]@1
  int v27; // [sp+58h] [bp-34h]@1
  int v28; // [sp+5Ch] [bp-30h]@1
  int v29; // [sp+60h] [bp-2Ch]@1
  int v30; // [sp+64h] [bp-28h]@1
  int v31; // [sp+68h] [bp-24h]@1
  int v32; // [sp+6Ch] [bp-20h]@1
  int v33; // [sp+70h] [bp-1Ch]@1
  int v34; // [sp+74h] [bp-18h]@1
  int v35; // [sp+78h] [bp-14h]@1
  int v36; // [sp+7Ch] [bp-10h]@1
  int v37; // [sp+80h] [bp-Ch]@1
  unsigned __int8 v38; // [sp+8Bh] [bp-1h]@3

  v22 = 48;
  v23 = 32;
  v24 = 64;
  v25 = 48;
  v26 = 112;
  v27 = 32;
  v28 = 128;
  v29 = 48;
  v30 = 128;
  v31 = 32;
  v32 = 144;
  v33 = 48;
  v34 = 144;
  v35 = 32;
  v36 = 160;
  v37 = 48;
  v6 = 48;
  v7 = 32;
  v8 = 64;
  v9 = 48;
  v10 = 112;
  v11 = 48;
  v12 = 128;
  v13 = 64;
  v14 = 128;
  v15 = 48;
  v16 = 144;
  v17 = 64;
  v18 = 144;
  v19 = 48;
  v20 = 160;
  v21 = 64;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 108) = *(_DWORD *)(a1 + 76);
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 108) += 2;
      *(_DWORD *)(a1 + 108) %= 256;
      v38 = *(_BYTE *)(a1 + 108);
      if ( *(_DWORD *)(a1 + 120) < 192 )
        ++*(_DWORD *)(a1 + 120);
      v1 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v1 + 8) + *(_DWORD *)(a1 + 120) * GetCos(v38) / 4;
      v2 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(v2 + 12) + *(_DWORD *)(a1 + 120) * GetSin(v38) / 4;
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 151 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      v38 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
      v38 += Random(-3, 3);
      *(_DWORD *)(a1 + 16) = GetCos(v38);
      *(_DWORD *)(a1 + 20) = GetSin(v38);
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 100) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_11;
    case 0xB:
LABEL_11:
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 4) & 0xFF )
      {
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 256);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 256);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 256);
        *(_BYTE *)a1 = 0;
      }
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 1;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v5;
    *(_DWORD *)(result + 4) = v5[1];
    *(_DWORD *)(result + 8) = v5[2];
    *(_DWORD *)(result + 12) = v5[3];
  }
  else
  {
    v3 = &v22 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  return result;
}

//----- (004579D0) --------------------------------------------------------
int __cdecl NPC253(int a1)
{
  int *v1; // edx@11
  int result; // eax@11
  int v3; // [sp+0h] [bp-24h]@1
  int v4; // [sp+4h] [bp-20h]@11
  int v5; // [sp+8h] [bp-1Ch]@11
  int v6; // [sp+Ch] [bp-18h]@11
  int v7; // [sp+10h] [bp-14h]@11
  int v8; // [sp+14h] [bp-10h]@11
  int v9; // [sp+18h] [bp-Ch]@11
  int v10; // [sp+1Ch] [bp-8h]@11
  int v11; // [sp+20h] [bp-4h]@11

  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
      goto LABEL_9;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( ++*(_DWORD *)(a1 + 100) > 4 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
LABEL_9:
  if ( *(_DWORD *)(a1 + 64) <= 100 )
  {
    Spawn_Exp(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 44));
    Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 8);
    Play_Sound_Effect(Sfx_Silly_Explosion, 1);
    *(_BYTE *)a1 = 0;
  }
  v4 = 0;
  v5 = 64;
  v6 = 16;
  v7 = 80;
  v8 = 16;
  v9 = 64;
  v10 = 32;
  v11 = 80;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00457B00) --------------------------------------------------------
signed int __cdecl NPC254(NPC_vars *a1)
{
  char *v1; // ecx@7
  signed int result; // eax@7
  char *v3; // ecx@8

  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 1;
      NPC_Create((NPC_Names)255, a1->X_pos + 9216, a1->Y_pos - 29184, 0, 0, 0, a1, 256);
      NPC_Create((NPC_Names)255, a1->X_pos - 0x4000, a1->Y_pos - 26624, 0, 0, Right, a1, 256);
      break;
    case 0x14:
      a1->Wait_Timer = 0;
      a1->count1 = 60;
      a1->Current_State = 21;
      break;
    case 0x1E:
      a1->Current_State = 21;
      NPC_Create(Treasure_Chest_Closed|0xD0, a1->X_pos - 5632, a1->Y_pos - 7168, 0, 0, 0, NULL, 256);
      break;
    case 0x28:
      a1->Current_State = 21;
      NPC_Create(Treasure_Chest_Closed|0xD0, a1->X_pos - 4608, a1->Y_pos - 7168, 0, 0, 0, NULL, 256);
      NPC_Create((NPC_Names)40, a1->X_pos - 11264, a1->Y_pos - 7168, 0, 0, 0, NULL, 256);
      NPC_Create(Forcefield|0x50, a1->X_pos - 17920, a1->Y_pos - 7168, 0, 0, 0, NULL, 256);
      break;
    default:
      break;
  }
  if ( a1->Direction )
  {
    v3 = (char *)&a1->Rect;
    *(_DWORD *)v3 = 0;
    *((_DWORD *)v3 + 1) = 64;
    *((_DWORD *)v3 + 2) = 128;
    result = 128;
    *((_DWORD *)v3 + 3) = 128;
  }
  else
  {
    v1 = (char *)&a1->Rect;
    *(_DWORD *)v1 = 0;
    *((_DWORD *)v1 + 1) = 0;
    *((_DWORD *)v1 + 2) = 128;
    result = 64;
    *((_DWORD *)v1 + 3) = 64;
  }
  return result;
}

//----- (00457D70) --------------------------------------------------------
int __cdecl NPC255(int a1)
{
  int *v1; // eax@15
  int v2; // ecx@15
  int result; // eax@15
  int *v4; // eax@16
  int v5; // ecx@16
  int v6; // [sp+4h] [bp-80h]@1
  int v7; // [sp+8h] [bp-7Ch]@1
  int v8; // [sp+Ch] [bp-78h]@1
  int v9; // [sp+10h] [bp-74h]@1
  int v10; // [sp+14h] [bp-70h]@1
  int v11; // [sp+18h] [bp-6Ch]@1
  int v12; // [sp+1Ch] [bp-68h]@1
  int v13; // [sp+20h] [bp-64h]@1
  int v14; // [sp+24h] [bp-60h]@1
  int v15; // [sp+28h] [bp-5Ch]@1
  int v16; // [sp+2Ch] [bp-58h]@1
  int v17; // [sp+30h] [bp-54h]@1
  int v18; // [sp+34h] [bp-50h]@1
  int v19; // [sp+38h] [bp-4Ch]@1
  int v20; // [sp+3Ch] [bp-48h]@1
  int v21; // [sp+40h] [bp-44h]@1
  int v22; // [sp+44h] [bp-40h]@1
  int v23; // [sp+48h] [bp-3Ch]@1
  int v24; // [sp+4Ch] [bp-38h]@1
  int v25; // [sp+50h] [bp-34h]@1
  int v26; // [sp+54h] [bp-30h]@1
  int v27; // [sp+58h] [bp-2Ch]@1
  int v28; // [sp+5Ch] [bp-28h]@1
  int v29; // [sp+60h] [bp-24h]@1
  int v30; // [sp+64h] [bp-20h]@1
  int v31; // [sp+68h] [bp-1Ch]@1
  int v32; // [sp+6Ch] [bp-18h]@1
  int v33; // [sp+70h] [bp-14h]@1
  int v34; // [sp+74h] [bp-10h]@1
  int v35; // [sp+78h] [bp-Ch]@1
  int v36; // [sp+7Ch] [bp-8h]@1
  int v37; // [sp+80h] [bp-4h]@1

  v22 = 128;
  v23 = 0;
  v24 = 240;
  v25 = 16;
  v26 = 128;
  v27 = 16;
  v28 = 240;
  v29 = 32;
  v30 = 128;
  v31 = 32;
  v32 = 240;
  v33 = 48;
  v34 = 128;
  v35 = 16;
  v36 = 240;
  v37 = 32;
  v6 = 240;
  v7 = 0;
  v8 = 320;
  v9 = 16;
  v10 = 240;
  v11 = 16;
  v12 = 320;
  v13 = 32;
  v14 = 240;
  v15 = 32;
  v16 = 320;
  v17 = 48;
  v18 = 240;
  v19 = 16;
  v20 = 320;
  v21 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      if ( *(_DWORD *)(a1 + 76) )
      {
        *(_DWORD *)(a1 + 140) = 20480;
        *(_DWORD *)(a1 + 148) = 20480;
      }
      else
      {
        *(_DWORD *)(a1 + 140) = 28672;
        *(_DWORD *)(a1 + 148) = 28672;
      }
      goto LABEL_5;
    case 1:
LABEL_5:
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) >= 20 )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      goto LABEL_9;
    case 0xB:
LABEL_9:
      if ( ++*(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 0x4000;
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 26624;
  }
  else
  {
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 9216;
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 29184;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v22 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00458010) --------------------------------------------------------
int __cdecl NPC256(int a1)
{
  int *v1; // ecx@23
  int v2; // edx@23
  int result; // eax@23
  int v4; // [sp+4h] [bp-60h]@1
  int v5; // [sp+8h] [bp-5Ch]@1
  int v6; // [sp+Ch] [bp-58h]@1
  int v7; // [sp+10h] [bp-54h]@1
  int v8; // [sp+14h] [bp-50h]@1
  int v9; // [sp+18h] [bp-4Ch]@1
  int v10; // [sp+1Ch] [bp-48h]@1
  int v11; // [sp+20h] [bp-44h]@1
  int v12; // [sp+24h] [bp-40h]@1
  int v13; // [sp+28h] [bp-3Ch]@1
  int v14; // [sp+2Ch] [bp-38h]@1
  int v15; // [sp+30h] [bp-34h]@1
  int v16; // [sp+34h] [bp-30h]@1
  int v17; // [sp+38h] [bp-2Ch]@1
  int v18; // [sp+3Ch] [bp-28h]@1
  int v19; // [sp+40h] [bp-24h]@1
  int v20; // [sp+44h] [bp-20h]@1
  int v21; // [sp+48h] [bp-1Ch]@1
  int v22; // [sp+4Ch] [bp-18h]@1
  int v23; // [sp+50h] [bp-14h]@1
  int v24; // [sp+54h] [bp-10h]@1
  int v25; // [sp+58h] [bp-Ch]@1
  int v26; // [sp+5Ch] [bp-8h]@1
  int v27; // [sp+60h] [bp-4h]@1

  v4 = 48;
  v5 = 160;
  v6 = 72;
  v7 = 192;
  v8 = 72;
  v9 = 160;
  v10 = 96;
  v11 = 192;
  v12 = 0;
  v13 = 128;
  v14 = 24;
  v15 = 160;
  v16 = 24;
  v17 = 128;
  v18 = 48;
  v19 = 160;
  v20 = 0;
  v21 = 160;
  v22 = 24;
  v23 = 192;
  v24 = 24;
  v25 = 160;
  v26 = 48;
  v27 = 192;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      Super_Y_Pos = 0;
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_5;
    case 0xB:
LABEL_5:
      if ( ++*(_DWORD *)(a1 + 100) > 5 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
      {
        *(_DWORD *)(a1 + 104) = 0;
        ++*(_DWORD *)(a1 + 108);
      }
      if ( *(_DWORD *)(a1 + 108) > 5 )
        *(_DWORD *)(a1 + 116) = 1;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      goto LABEL_13;
    case 0x15:
LABEL_13:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      NPC_Create((NPC_Names)257, *(_DWORD *)(a1 + 8) - 7168, *(_DWORD *)(a1 + 12) - 0x2000, 0, 0, 0, NULL, 256);
      NPC_Create((NPC_Names)257, *(_DWORD *)(a1 + 8) - 7168, *(_DWORD *)(a1 + 12) - 0x2000, 0, 0, Right, NULL, 170);
      goto LABEL_15;
    case 0x29:
LABEL_15:
      *(_DWORD *)(a1 + 104) = 4;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 104) = 4;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_17;
    case 0x33:
LABEL_17:
      if ( ++*(_DWORD *)(a1 + 100) > 5 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
      {
        *(_DWORD *)(a1 + 104) = 4;
        ++*(_DWORD *)(a1 + 108);
      }
      if ( *(_DWORD *)(a1 + 108) > 5 )
        *(_DWORD *)(a1 + 116) = 41;
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (00458360) --------------------------------------------------------
int __cdecl NPC257(int a1)
{
  int *v1; // ecx@36
  int v2; // edx@36
  int result; // eax@36
  int v4; // [sp+0h] [bp-34h]@1
  int v5; // [sp+4h] [bp-30h]@1
  int v6; // [sp+8h] [bp-2Ch]@1
  int v7; // [sp+Ch] [bp-28h]@1
  int v8; // [sp+10h] [bp-24h]@1
  int v9; // [sp+14h] [bp-20h]@1
  int v10; // [sp+18h] [bp-1Ch]@1
  int v11; // [sp+1Ch] [bp-18h]@1
  int v12; // [sp+20h] [bp-14h]@1
  int v13; // [sp+24h] [bp-10h]@1
  int v14; // [sp+28h] [bp-Ch]@1
  int v15; // [sp+2Ch] [bp-8h]@1
  int v16; // [sp+30h] [bp-4h]@1

  v5 = 176;
  v6 = 32;
  v7 = 184;
  v8 = 48;
  v9 = 184;
  v10 = 32;
  v11 = 192;
  v12 = 48;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v16 = 0;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 10 )
      {
        if ( *(_DWORD *)(a1 + 8) < Super_Y_Pos )
          *(_DWORD *)(a1 + 16) += 85;
        if ( *(_DWORD *)(a1 + 8) > Super_Y_Pos )
          *(_DWORD *)(a1 + 16) -= 85;
        if ( *(_DWORD *)(a1 + 12) < Curly_Shoot_Y )
          *(_DWORD *)(a1 + 20) += 85;
        if ( *(_DWORD *)(a1 + 12) > Curly_Shoot_Y )
          *(_DWORD *)(a1 + 20) -= 85;
        if ( *(_DWORD *)(a1 + 16) > 1024 )
          *(_DWORD *)(a1 + 16) = 1024;
        if ( *(_DWORD *)(a1 + 16) < -1024 )
          *(_DWORD *)(a1 + 16) = -1024;
        if ( *(_DWORD *)(a1 + 20) > 1024 )
          *(_DWORD *)(a1 + 20) = 1024;
        if ( *(_DWORD *)(a1 + 20) < -1024 )
          *(_DWORD *)(a1 + 20) = -1024;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      }
      goto LABEL_26;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( Super_Y_Pos )
    *(_DWORD *)(a1 + 116) = 10;
LABEL_26:
  if ( ++*(_DWORD *)(a1 + 100) > 3 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  if ( !*(_DWORD *)(a1 + 76) && *(_DWORD *)(a1 + 16) > 0 )
    *(_DWORD *)(a1 + 104) = 2;
  if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 16) < 0 )
    *(_DWORD *)(a1 + 104) = 2;
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (004585A0) --------------------------------------------------------
int __cdecl NPC258(int a1)
{
  int result; // eax@1

  result = a1 + 84;
  *(_DWORD *)result = 48;
  *(_DWORD *)(result + 4) = 32;
  *(_DWORD *)(result + 8) = 64;
  *(_DWORD *)(result + 12) = 48;
  return result;
}

//----- (004585F0) --------------------------------------------------------
void __cdecl NPC259(void *a1)
{
  char *v1; // eax@7
  char *v2; // edx@8
  char *v3; // eax@12

  switch ( *((_DWORD *)a1 + 29) )
  {
    case 0:
      *((_WORD *)a1 + 40) &= 0xDFFFu;
      *((_DWORD *)a1 + 29) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.Direction )
        *((_DWORD *)a1 + 19) = 2;
      else
        *((_DWORD *)a1 + 19) = 0;
      *((_DWORD *)a1 + 3) = Quote.Y_Pos - 2048;
      if ( *((_DWORD *)a1 + 19) )
      {
        *((_DWORD *)a1 + 2) = Quote.X_Pos - 1536;
        v2 = (char *)a1 + 84;
        *(_DWORD *)v2 = 224;
        *((_DWORD *)v2 + 1) = 112;
        *((_DWORD *)v2 + 2) = 240;
        *((_DWORD *)v2 + 3) = 128;
      }
      else
      {
        *((_DWORD *)a1 + 2) = Quote.X_Pos + 1536;
        v1 = (char *)a1 + 84;
        *(_DWORD *)v1 = 224;
        *((_DWORD *)v1 + 1) = 96;
        *((_DWORD *)v1 + 2) = 240;
        *((_DWORD *)v1 + 3) = 112;
      }
      if ( Quote.Animation_Num % 2 )
        ++*((_DWORD *)a1 + 22);
      break;
    case 0xA:
      *((_DWORD *)a1 + 29) = 11;
      *((_DWORD *)a1 + 4) = 64;
      *((_DWORD *)a1 + 5) = -32;
      v3 = (char *)a1 + 84;
      *(_DWORD *)v3 = 224;
      *((_DWORD *)v3 + 1) = 96;
      *((_DWORD *)v3 + 2) = 240;
      *((_DWORD *)v3 + 3) = 112;
      break;
    case 0xB:
      if ( *((_DWORD *)a1 + 3) < 0x8000 )
        *((_DWORD *)a1 + 5) = 32;
      *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
      *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
      break;
    case 0x14:
      Vanish_NPC((NPC_vars *)a1);
      Create_Dust_Clouds_Up(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 0x2000, 64);
      break;
    default:
      return;
  }
}

//----- (00458810) --------------------------------------------------------
int __cdecl NPC260(int a1)
{
  int *v1; // edx@14
  int result; // eax@14
  int *v3; // edx@15
  int v4; // [sp+4h] [bp-60h]@1
  int v5; // [sp+8h] [bp-5Ch]@1
  int v6; // [sp+Ch] [bp-58h]@1
  int v7; // [sp+10h] [bp-54h]@1
  int v8; // [sp+14h] [bp-50h]@1
  int v9; // [sp+18h] [bp-4Ch]@1
  int v10; // [sp+1Ch] [bp-48h]@1
  int v11; // [sp+20h] [bp-44h]@1
  int v12; // [sp+24h] [bp-40h]@1
  int v13; // [sp+28h] [bp-3Ch]@1
  int v14; // [sp+2Ch] [bp-38h]@1
  int v15; // [sp+30h] [bp-34h]@1
  int v16; // [sp+34h] [bp-30h]@1
  int v17; // [sp+38h] [bp-2Ch]@1
  int v18; // [sp+3Ch] [bp-28h]@1
  int v19; // [sp+40h] [bp-24h]@1
  int v20; // [sp+44h] [bp-20h]@1
  int v21; // [sp+48h] [bp-1Ch]@1
  int v22; // [sp+4Ch] [bp-18h]@1
  int v23; // [sp+50h] [bp-14h]@1
  int v24; // [sp+54h] [bp-10h]@1
  int v25; // [sp+58h] [bp-Ch]@1
  int v26; // [sp+5Ch] [bp-8h]@1
  int v27; // [sp+60h] [bp-4h]@1

  v16 = 128;
  v17 = 64;
  v18 = 144;
  v19 = 80;
  v20 = 144;
  v21 = 64;
  v22 = 160;
  v23 = 80;
  v24 = 224;
  v25 = 64;
  v26 = 240;
  v27 = 80;
  v4 = 128;
  v5 = 80;
  v6 = 144;
  v7 = 96;
  v8 = 144;
  v9 = 80;
  v10 = 160;
  v11 = 96;
  v12 = 224;
  v13 = 80;
  v14 = 240;
  v15 = 96;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) += 512;
      *(_DWORD *)(a1 + 12) -= 1024;
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 160) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 2;
      NPC_Create(Enemy_Basil|0x50, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) - 0x2000, 0, 0, 0, NULL, 256);
      break;
    default:
      break;
  }
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v16 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00458A70) --------------------------------------------------------
int __cdecl NPC261(int a1)
{
  int *v1; // eax@15
  int v2; // ecx@15
  int result; // eax@15
  int *v4; // eax@16
  int v5; // ecx@16
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 112;
  v16 = 32;
  v17 = 128;
  v18 = 48;
  v19 = 128;
  v20 = 32;
  v21 = 144;
  v22 = 48;
  v7 = 112;
  v8 = 48;
  v9 = 128;
  v10 = 64;
  v11 = 128;
  v12 = 48;
  v13 = 144;
  v14 = 64;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 == 2 && ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 8) -= 512;
    *(_DWORD *)(a1 + 12) -= 1024;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 160) == 1 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00458C30) --------------------------------------------------------
int __cdecl NPC262(int a1)
{
  int *v1; // eax@15
  int v2; // ecx@15
  int result; // eax@15
  int *v4; // eax@16
  int v5; // ecx@16
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 128;
  v16 = 0;
  v17 = 144;
  v18 = 16;
  v19 = 144;
  v20 = 0;
  v21 = 160;
  v22 = 16;
  v7 = 128;
  v8 = 16;
  v9 = 144;
  v10 = 32;
  v11 = 144;
  v12 = 16;
  v13 = 160;
  v14 = 32;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 == 2 && ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 8) -= 512;
    *(_DWORD *)(a1 + 12) -= 1024;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 160) == 1 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00458DF0) --------------------------------------------------------
void __cdecl NPC263(NPC_vars *NPC)
{
  int Y_Vel; // ST24_4@52
  int *v2; // edx@89
  char *v3; // eax@89
  int *v4; // edx@90
  char *v5; // eax@90
  int NPC_Current_State; // [sp+0h] [bp-138h]@1
  int v7; // [sp+8h] [bp-130h]@1
  int v8; // [sp+Ch] [bp-12Ch]@1
  int v9; // [sp+10h] [bp-128h]@1
  int v10; // [sp+14h] [bp-124h]@1
  int v11; // [sp+18h] [bp-120h]@1
  int v12; // [sp+1Ch] [bp-11Ch]@1
  int v13; // [sp+20h] [bp-118h]@1
  int v14; // [sp+24h] [bp-114h]@1
  int v15; // [sp+28h] [bp-110h]@1
  int v16; // [sp+2Ch] [bp-10Ch]@1
  int v17; // [sp+30h] [bp-108h]@1
  int v18; // [sp+34h] [bp-104h]@1
  int v19; // [sp+38h] [bp-100h]@1
  int v20; // [sp+3Ch] [bp-FCh]@1
  int v21; // [sp+40h] [bp-F8h]@1
  int v22; // [sp+44h] [bp-F4h]@1
  int v23; // [sp+48h] [bp-F0h]@1
  int v24; // [sp+4Ch] [bp-ECh]@1
  int v25; // [sp+50h] [bp-E8h]@1
  int v26; // [sp+54h] [bp-E4h]@1
  int v27; // [sp+58h] [bp-E0h]@1
  int v28; // [sp+5Ch] [bp-DCh]@1
  int v29; // [sp+60h] [bp-D8h]@1
  int v30; // [sp+64h] [bp-D4h]@1
  int v31; // [sp+68h] [bp-D0h]@1
  int v32; // [sp+6Ch] [bp-CCh]@1
  int v33; // [sp+70h] [bp-C8h]@1
  int v34; // [sp+74h] [bp-C4h]@1
  int v35; // [sp+78h] [bp-C0h]@1
  int v36; // [sp+7Ch] [bp-BCh]@1
  int v37; // [sp+80h] [bp-B8h]@1
  int v38; // [sp+84h] [bp-B4h]@1
  int v39; // [sp+88h] [bp-B0h]@1
  int v40; // [sp+8Ch] [bp-ACh]@1
  int v41; // [sp+90h] [bp-A8h]@1
  int v42; // [sp+94h] [bp-A4h]@1
  int X_Vel; // [sp+9Ch] [bp-9Ch]@52
  int v44; // [sp+A0h] [bp-98h]@1
  int v45; // [sp+A4h] [bp-94h]@1
  int v46; // [sp+A8h] [bp-90h]@1
  int v47; // [sp+ACh] [bp-8Ch]@1
  int v48; // [sp+B0h] [bp-88h]@1
  int v49; // [sp+B4h] [bp-84h]@1
  int v50; // [sp+B8h] [bp-80h]@1
  int v51; // [sp+BCh] [bp-7Ch]@1
  int v52; // [sp+C0h] [bp-78h]@1
  int v53; // [sp+C4h] [bp-74h]@1
  int v54; // [sp+C8h] [bp-70h]@1
  int v55; // [sp+CCh] [bp-6Ch]@1
  int v56; // [sp+D0h] [bp-68h]@1
  int v57; // [sp+D4h] [bp-64h]@1
  int v58; // [sp+D8h] [bp-60h]@1
  int v59; // [sp+DCh] [bp-5Ch]@1
  int v60; // [sp+E0h] [bp-58h]@1
  int v61; // [sp+E4h] [bp-54h]@1
  int v62; // [sp+E8h] [bp-50h]@1
  int v63; // [sp+ECh] [bp-4Ch]@1
  int v64; // [sp+F0h] [bp-48h]@1
  int v65; // [sp+F4h] [bp-44h]@1
  int v66; // [sp+F8h] [bp-40h]@1
  int v67; // [sp+FCh] [bp-3Ch]@1
  int v68; // [sp+100h] [bp-38h]@1
  int v69; // [sp+104h] [bp-34h]@1
  int v70; // [sp+108h] [bp-30h]@1
  int v71; // [sp+10Ch] [bp-2Ch]@1
  int v72; // [sp+110h] [bp-28h]@1
  int v73; // [sp+114h] [bp-24h]@1
  int v74; // [sp+118h] [bp-20h]@1
  int v75; // [sp+11Ch] [bp-1Ch]@1
  int v76; // [sp+120h] [bp-18h]@1
  int v77; // [sp+124h] [bp-14h]@1
  int v78; // [sp+128h] [bp-10h]@1
  int v79; // [sp+12Ch] [bp-Ch]@1
  int i; // [sp+134h] [bp-4h]@50

  v44 = 0;
  v45 = 0;
  v46 = 24;
  v47 = 32;
  v48 = 24;
  v49 = 0;
  v50 = 48;
  v51 = 32;
  v52 = 48;
  v53 = 0;
  v54 = 72;
  v55 = 32;
  v56 = 0;
  v57 = 0;
  v58 = 0;
  v59 = 0;
  v60 = 72;
  v61 = 0;
  v62 = 96;
  v63 = 32;
  v64 = 96;
  v65 = 0;
  v66 = 120;
  v67 = 32;
  v68 = 120;
  v69 = 0;
  v70 = 144;
  v71 = 32;
  v72 = 144;
  v73 = 0;
  v74 = 168;
  v75 = 32;
  v76 = 264;
  v77 = 0;
  v78 = 288;
  v79 = 32;
  v7 = 0;
  v8 = 32;
  v9 = 24;
  v10 = 64;
  v11 = 24;
  v12 = 32;
  v13 = 48;
  v14 = 64;
  v15 = 48;
  v16 = 32;
  v17 = 72;
  v18 = 64;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  v22 = 0;
  v23 = 72;
  v24 = 32;
  v25 = 96;
  v26 = 64;
  v27 = 96;
  v28 = 32;
  v29 = 120;
  v30 = 64;
  v31 = 120;
  v32 = 32;
  v33 = 144;
  v34 = 64;
  v35 = 144;
  v36 = 32;
  v37 = 168;
  v38 = 64;
  v39 = 264;
  v40 = 32;
  v41 = 288;
  v42 = 64;
  NPC_Current_State = NPC->Current_State;
  if ( NPC_Current_State <= 32 )
  {
    if ( NPC_Current_State == 32 )
    {
      if ( ++NPC->Wait_Timer > 50 )
        NPC->Current_State = 100;
    }
    else
    {
      switch ( NPC_Current_State )
      {
        case 0:
          NPC->Current_State = 1;
          NPC->Y_pos += 4096;
          NPC->Ani_Num = 3;
          break;
        case 2:
          if ( ++NPC->Wait_Timer / 2 % 2 )
            NPC->Ani_Num = 0;
          else
            NPC->Ani_Num = 3;
          if ( NPC->Wait_Timer > 50 )
            NPC->Current_State = 10;
          break;
        case 10:
          NPC->Y_vel += 128;
          NPC->Entity_Flags |= 0x20u;
          NPC->Damage = 3;
          if ( NPC->Collision_flags & 8 )
          {
            NPC->Current_State = 20;
            NPC->Wait_Timer = 0;
            NPC->Ani_Num = 0;
            NPC->count2 = NPC->Life;
            if ( NPC->X_pos <= Quote.X_Pos )
              NPC->Direction = 2;
            else
              NPC->Direction = 0;
          }
          break;
        case 20:
          if ( ++NPC->Wait_Timer < 50 && NPC->Life < NPC->count2 - 20 )
            NPC->Wait_Timer = 50;
          if ( NPC->Wait_Timer == 50 )
          {
            if ( NPC->X_pos <= Quote.X_Pos )
              NPC->Direction = 2;
            else
              NPC->Direction = 0;
            NPC->Ani_Num = 4;
          }
          if ( NPC->Wait_Timer == 80 )
          {
            NPC->Ani_Num = 5;
            Play_Sound_Effect(Sfx_Silly_Explosion, 1);
            if ( NPC->Direction )
            {
              NPC_Create((NPC_Names)264, NPC->X_pos + 0x2000, NPC->Y_pos, 0, 0, Right, NULL, 256);
              NPC_Create((NPC_Names)264, NPC->X_pos + 0x2000, NPC->Y_pos, 0, 0, (Directions)1026, NULL, 256);
            }
            else
            {
              NPC_Create((NPC_Names)264, NPC->X_pos - 0x2000, NPC->Y_pos, 0, 0, 0, NULL, 256);
              NPC_Create((NPC_Names)264, NPC->X_pos - 0x2000, NPC->Y_pos, 0, 0, (Directions)1024, NULL, 256);
            }
          }
          if ( NPC->Wait_Timer == 120 )
            NPC->Ani_Num = 0;
          if ( NPC->Wait_Timer > 130 && NPC->Life < NPC->count2 - 50 )
            NPC->Wait_Timer = 161;
          if ( NPC->Wait_Timer > 160 )
          {
            NPC->Current_State = 100;
            NPC->Ani_Num = 0;
          }
          break;
        case 30:
          NPC->Current_State = 31;
          NPC->Wait_Timer = 0;
          NPC->Ani_Num = 6;
          NPC->Curly_Target_X = NPC->X_pos;
          NPC->Entity_Flags |= 0x20u;
          goto LABEL_46;
        case 31:
LABEL_46:
          if ( ++NPC->Wait_Timer / 2 % 2 )
            NPC->X_pos = NPC->Curly_Target_X;
          else
            NPC->X_pos = NPC->Curly_Target_X + 512;
          if ( NPC->Wait_Timer > 50 )
          {
            NPC->Current_State = 32;
            NPC->Wait_Timer = 0;
            NPC->Ani_Num = 7;
            Play_Sound_Effect(Sfx_Lightning, 1);
            for ( i = 8; i < 256; i += 16 )
            {
              X_Vel = 2 * GetCos(i);
              Y_Vel = 2 * GetSin(i);
              NPC_Create(Boss_Balrog_Shooting|0x100, NPC->X_pos, NPC->Y_pos, X_Vel, Y_Vel, 0, NULL, 256);
            }
          }
          break;
        default:
          goto LABEL_82;
      }
    }
    goto LABEL_82;
  }
  if ( NPC_Current_State > 103 )
  {
    if ( NPC_Current_State == 500 )
    {
      NPC->Entity_Flags &= 0xFFDFu;
      NPC->Ani_Num = 6;
      NPC->Y_vel += 16;
      if ( NPC->Collision_flags & 8 )
      {
        NPC->Current_State = 501;
        NPC->Wait_Timer = 0;
        NPC->Curly_Target_X = NPC->X_pos;
        if ( NPC->X_pos <= Quote.X_Pos )
          NPC->Direction = 2;
        else
          NPC->Direction = 0;
      }
    }
    else if ( NPC_Current_State == 501 )
    {
      if ( NPC->X_pos <= Quote.X_Pos )
        NPC->Direction = 2;
      else
        NPC->Direction = 0;
      NPC->Ani_Num = 8;
      if ( ++NPC->Wait_Timer / 2 % 2 )
        NPC->X_pos = NPC->Curly_Target_X;
      else
        NPC->X_pos = NPC->Curly_Target_X + 512;
    }
  }
  else if ( NPC_Current_State == 103 )
  {
    NPC->Wait_Timer -= 2;
    if ( NPC->Wait_Timer <= 0 )
    {
      NPC->Entity_Flags |= 0x20u;
      NPC->Damage = 3;
      if ( NPC->count1 >= 3 )
      {
        NPC->count1 = 0;
        NPC->Current_State = 30;
      }
      else
      {
        ++NPC->count1;
        NPC->Current_State = 10;
      }
    }
  }
  else
  {
    if ( NPC_Current_State == 100 )
    {
      NPC->Current_State = 101;
      NPC->Entity_Flags &= 0xFFDFu;
      NPC->Damage = 0;
      NPC->Wait_Timer = 0;
      Play_Sound_Effect(Sfx_Teleport, 1);
    }
    else if ( NPC_Current_State != 101 )
    {
      if ( NPC_Current_State == 102 && ++NPC->Wait_Timer > 40 )
      {
        NPC->Current_State = 103;
        NPC->Wait_Timer = 16;
        NPC->Ani_Num = 2;
        NPC->Y_vel = 0;
        NPC->X_pos = NPC->Curly_Target_X;
        NPC->Y_pos = NPC->Curly_Target_Y;
        if ( NPC->X_pos <= Quote.X_Pos )
          NPC->Direction = 2;
        else
          NPC->Direction = 0;
      }
      goto LABEL_82;
    }
    NPC->Wait_Timer += 2;
    if ( NPC->Wait_Timer > 16 )
    {
      NPC->Current_State = 102;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 3;
      NPC->Curly_Target_X = Random(5, 35) << 13;
      NPC->Curly_Target_Y = Random(5, 7) << 13;
    }
  }
LABEL_82:
  if ( NPC->Current_State >= 10 )
  {
    if ( NPC->Current_State == 102 )
    {
      Super_Y_Pos = NPC->Curly_Target_X;
      Curly_Shoot_Y = NPC->Curly_Target_Y;
    }
    else
    {
      Super_Y_Pos = NPC->X_pos;
      Curly_Shoot_Y = NPC->Y_pos;
    }
  }
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( NPC->Direction )
  {
    v4 = &v7 + 4 * NPC->Ani_Num;
    v5 = (char *)&NPC->Rect;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    *((_DWORD *)v5 + 2) = v4[2];
    *((_DWORD *)v5 + 3) = v4[3];
  }
  else
  {
    v2 = &v44 + 4 * NPC->Ani_Num;
    v3 = (char *)&NPC->Rect;
    *(_DWORD *)v3 = *v2;
    *((_DWORD *)v3 + 1) = v2[1];
    *((_DWORD *)v3 + 2) = v2[2];
    *((_DWORD *)v3 + 3) = v2[3];
  }
  if ( NPC->Current_State != 101 && NPC->Current_State != 103 )
  {
    NPC->view.top = 0x2000;
  }
  else
  {
    NPC->Rect.top += NPC->Wait_Timer;
    NPC->Rect.bottom -= NPC->Wait_Timer;
    NPC->view.top = (16 - NPC->Wait_Timer) << 9;
  }
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (00459950) --------------------------------------------------------
void __cdecl NPC264(void *a1)
{
  __int64 v1; // rax@13
  char *v2; // eax@14
  int v3; // [sp+0h] [bp-18h]@4
  unsigned __int8 v4; // [sp+17h] [bp-1h]@8

  if ( *((_DWORD *)a1 + 2) < 0 || *((_DWORD *)a1 + 2) > Current_Map.Width << 13 )
  {
    Vanish_NPC((NPC_vars *)a1);
    return;
  }
  v3 = *((_DWORD *)a1 + 29);
  if ( !v3 )
  {
    *((_DWORD *)a1 + 29) = 1;
    *((_DWORD *)a1 + 8) = *((_DWORD *)a1 + 2);
    *((_DWORD *)a1 + 9) = *((_DWORD *)a1 + 3);
    *((_DWORD *)a1 + 27) = *((_DWORD *)a1 + 19) / 8;
    *((_DWORD *)a1 + 19) %= 8;
    goto LABEL_8;
  }
  if ( v3 == 1 )
  {
LABEL_8:
    *((_DWORD *)a1 + 27) += 6;
    *((_DWORD *)a1 + 27) %= 256;
    v4 = *((_BYTE *)a1 + 108);
    if ( *((_DWORD *)a1 + 30) < 128 )
      ++*((_DWORD *)a1 + 30);
    if ( *((_DWORD *)a1 + 19) )
      *((_DWORD *)a1 + 4) += 21;
    else
      *((_DWORD *)a1 + 4) -= 21;
    *((_DWORD *)a1 + 8) += *((_DWORD *)a1 + 4);
    v1 = *((_DWORD *)a1 + 30) * GetCos(v4) / 2;
    *((_DWORD *)a1 + 2) = *((_DWORD *)a1 + 8) + (((BYTE4(v1) & 3) + (signed int)v1) >> 2);
    *((_DWORD *)a1 + 3) = *((_DWORD *)a1 + 9) + *((_DWORD *)a1 + 30) * GetSin(v4) / 2;
    NPC_Create(Balrog_Drop_In|0x100, *((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 0, 0, 0, NULL, 256);
  }
  v2 = (char *)a1 + 84;
  *(_DWORD *)v2 = 288;
  *((_DWORD *)v2 + 1) = 0;
  *((_DWORD *)v2 + 2) = 304;
  *((_DWORD *)v2 + 3) = 16;
}

//----- (00459B30) --------------------------------------------------------
int __cdecl NPC265(int a1)
{
  int result; // eax@4
  int *v2; // eax@5
  int v3; // ecx@5
  int v4; // [sp+0h] [bp-30h]@1
  int v5; // [sp+4h] [bp-2Ch]@1
  int v6; // [sp+8h] [bp-28h]@1
  int v7; // [sp+Ch] [bp-24h]@1
  int v8; // [sp+10h] [bp-20h]@1
  int v9; // [sp+14h] [bp-1Ch]@1
  int v10; // [sp+18h] [bp-18h]@1
  int v11; // [sp+1Ch] [bp-14h]@1
  int v12; // [sp+20h] [bp-10h]@1
  int v13; // [sp+24h] [bp-Ch]@1
  int v14; // [sp+28h] [bp-8h]@1
  int v15; // [sp+2Ch] [bp-4h]@1

  v4 = 288;
  v5 = 16;
  v6 = 304;
  v7 = 32;
  v8 = 288;
  v9 = 32;
  v10 = 304;
  v11 = 48;
  v12 = 288;
  v13 = 48;
  v14 = 304;
  v15 = 64;
  if ( ++*(_DWORD *)(a1 + 100) > 3 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) <= 2 )
  {
    v2 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
  }
  else
  {
    result = a1;
    *(_BYTE *)a1 = 0;
  }
  return result;
}

//----- (00459C00) --------------------------------------------------------
void __cdecl NPC266(void *a1)
{
  int *v1; // ecx@11
  char *v2; // edx@11
  int v3; // [sp+0h] [bp-20h]@1
  int v4; // [sp+4h] [bp-1Ch]@1
  int v5; // [sp+8h] [bp-18h]@1
  int v6; // [sp+Ch] [bp-14h]@1
  int v7; // [sp+10h] [bp-10h]@1
  int v8; // [sp+14h] [bp-Ch]@1
  int v9; // [sp+18h] [bp-8h]@1
  int v10; // [sp+1Ch] [bp-4h]@1

  v3 = 304;
  v4 = 16;
  v5 = 320;
  v6 = 32;
  v7 = 304;
  v8 = 32;
  v9 = 320;
  v10 = 48;
  if ( *((_DWORD *)a1 + 1) & 1 )
    *((_DWORD *)a1 + 4) = -*((_DWORD *)a1 + 4);
  if ( *((_DWORD *)a1 + 1) & 4 )
    *((_DWORD *)a1 + 4) = -*((_DWORD *)a1 + 4);
  if ( *((_DWORD *)a1 + 1) & 2 )
    *((_DWORD *)a1 + 5) = 512;
  if ( *((_DWORD *)a1 + 1) & 8 )
    *((_DWORD *)a1 + 5) = -512;
  *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
  *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
  if ( ++*((_DWORD *)a1 + 26) > 1 )
    *((_DWORD *)a1 + 26) = 0;
  v1 = &v3 + 4 * *((_DWORD *)a1 + 26);
  v2 = (char *)a1 + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
  if ( ++*((_DWORD *)a1 + 30) % 4 == 1 )
    NPC_Create(Balrog_Drop_In|0x100, *((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 0, 0, 0, NULL, 256);
  if ( *((_DWORD *)a1 + 30) > 250 )
    Vanish_NPC((NPC_vars *)a1);
}

//----- (00459D80) --------------------------------------------------------
void __cdecl NPC267(NPC_vars *NPC)
{
  int v1; // ST10_4@54
  int v2; // ST0C_4@54
  int v3; // ST08_4@54
  int v4; // eax@54
  int v5; // ST0C_4@188
  int v6; // ST08_4@188
  int v7; // eax@188
  int v8; // ST10_4@190
  int v9; // ST0C_4@190
  int v10; // ST08_4@190
  int v11; // eax@190
  int v12; // ST10_4@190
  int v13; // ST0C_4@190
  int v14; // ST08_4@190
  int v15; // eax@190
  int v16; // ST10_4@190
  int v17; // ST08_4@190
  int v18; // eax@190
  int v19; // ST10_4@190
  int v20; // ST08_4@190
  int v21; // eax@190
  int *v22; // eax@192
  char *v23; // ecx@192
  int *v24; // eax@193
  char *v25; // ecx@193
  int v26; // [sp+4h] [bp-154h]@1
  int v27; // [sp+8h] [bp-150h]@1
  int v28; // [sp+Ch] [bp-14Ch]@1
  int v29; // [sp+10h] [bp-148h]@1
  int v30; // [sp+14h] [bp-144h]@1
  int v31; // [sp+18h] [bp-140h]@1
  int v32; // [sp+1Ch] [bp-13Ch]@1
  int v33; // [sp+20h] [bp-138h]@1
  int v34; // [sp+24h] [bp-134h]@1
  int v35; // [sp+28h] [bp-130h]@1
  int v36; // [sp+2Ch] [bp-12Ch]@1
  int v37; // [sp+30h] [bp-128h]@1
  int v38; // [sp+34h] [bp-124h]@1
  int v39; // [sp+38h] [bp-120h]@1
  int v40; // [sp+3Ch] [bp-11Ch]@1
  int v41; // [sp+40h] [bp-118h]@1
  int v42; // [sp+44h] [bp-114h]@1
  int v43; // [sp+48h] [bp-110h]@1
  int v44; // [sp+4Ch] [bp-10Ch]@1
  int v45; // [sp+50h] [bp-108h]@1
  int v46; // [sp+54h] [bp-104h]@1
  int v47; // [sp+58h] [bp-100h]@1
  int v48; // [sp+5Ch] [bp-FCh]@1
  int v49; // [sp+60h] [bp-F8h]@1
  int v50; // [sp+64h] [bp-F4h]@1
  int v51; // [sp+68h] [bp-F0h]@1
  int v52; // [sp+6Ch] [bp-ECh]@1
  int v53; // [sp+70h] [bp-E8h]@1
  int v54; // [sp+74h] [bp-E4h]@1
  int v55; // [sp+78h] [bp-E0h]@1
  int v56; // [sp+7Ch] [bp-DCh]@1
  int v57; // [sp+80h] [bp-D8h]@1
  int v58; // [sp+84h] [bp-D4h]@1
  int v59; // [sp+88h] [bp-D0h]@1
  int v60; // [sp+8Ch] [bp-CCh]@1
  int v61; // [sp+90h] [bp-C8h]@1
  int v62; // [sp+94h] [bp-C4h]@1
  int v63; // [sp+98h] [bp-C0h]@1
  int v64; // [sp+9Ch] [bp-BCh]@1
  int v65; // [sp+A0h] [bp-B8h]@1
  int v66; // [sp+A4h] [bp-B4h]@1
  int Y_Vel; // [sp+ACh] [bp-ACh]@98
  int X_Vel; // [sp+B0h] [bp-A8h]@98
  int i; // [sp+B4h] [bp-A4h]@52
  int v70; // [sp+B8h] [bp-A0h]@1
  int v71; // [sp+BCh] [bp-9Ch]@1
  int v72; // [sp+C0h] [bp-98h]@1
  int v73; // [sp+C4h] [bp-94h]@1
  int v74; // [sp+C8h] [bp-90h]@1
  int v75; // [sp+CCh] [bp-8Ch]@1
  int v76; // [sp+D0h] [bp-88h]@1
  int v77; // [sp+D4h] [bp-84h]@1
  int v78; // [sp+D8h] [bp-80h]@1
  int v79; // [sp+DCh] [bp-7Ch]@1
  int v80; // [sp+E0h] [bp-78h]@1
  int v81; // [sp+E4h] [bp-74h]@1
  int v82; // [sp+E8h] [bp-70h]@1
  int v83; // [sp+ECh] [bp-6Ch]@1
  int v84; // [sp+F0h] [bp-68h]@1
  int v85; // [sp+F4h] [bp-64h]@1
  int v86; // [sp+F8h] [bp-60h]@1
  int v87; // [sp+FCh] [bp-5Ch]@1
  int v88; // [sp+100h] [bp-58h]@1
  int v89; // [sp+104h] [bp-54h]@1
  int v90; // [sp+108h] [bp-50h]@1
  int v91; // [sp+10Ch] [bp-4Ch]@1
  int v92; // [sp+110h] [bp-48h]@1
  int v93; // [sp+114h] [bp-44h]@1
  int v94; // [sp+118h] [bp-40h]@1
  int v95; // [sp+11Ch] [bp-3Ch]@1
  int v96; // [sp+120h] [bp-38h]@1
  int v97; // [sp+124h] [bp-34h]@1
  int v98; // [sp+128h] [bp-30h]@1
  int v99; // [sp+12Ch] [bp-2Ch]@1
  int v100; // [sp+130h] [bp-28h]@1
  int v101; // [sp+134h] [bp-24h]@1
  int v102; // [sp+138h] [bp-20h]@1
  int v103; // [sp+13Ch] [bp-1Ch]@1
  int v104; // [sp+140h] [bp-18h]@1
  int v105; // [sp+144h] [bp-14h]@1
  int v106; // [sp+148h] [bp-10h]@1
  int v107; // [sp+14Ch] [bp-Ch]@1
  int v108; // [sp+150h] [bp-8h]@1
  int v109; // [sp+154h] [bp-4h]@1

  v70 = 0;
  v71 = 0;
  v72 = 0;
  v73 = 0;
  v74 = 0;
  v75 = 64;
  v76 = 40;
  v77 = 112;
  v78 = 40;
  v79 = 64;
  v80 = 80;
  v81 = 112;
  v82 = 80;
  v83 = 64;
  v84 = 120;
  v85 = 112;
  v86 = 120;
  v87 = 64;
  v88 = 160;
  v89 = 112;
  v90 = 160;
  v91 = 64;
  v92 = 200;
  v93 = 112;
  v94 = 200;
  v95 = 64;
  v96 = 240;
  v97 = 112;
  v98 = 240;
  v99 = 64;
  v100 = 280;
  v101 = 112;
  v102 = 280;
  v103 = 64;
  v104 = 320;
  v105 = 112;
  v106 = 0;
  v107 = 160;
  v108 = 40;
  v109 = 208;
  v27 = 0;
  v28 = 0;
  v29 = 0;
  v30 = 0;
  v31 = 0;
  v32 = 112;
  v33 = 40;
  v34 = 160;
  v35 = 40;
  v36 = 112;
  v37 = 80;
  v38 = 160;
  v39 = 80;
  v40 = 112;
  v41 = 120;
  v42 = 160;
  v43 = 120;
  v44 = 112;
  v45 = 160;
  v46 = 160;
  v47 = 160;
  v48 = 112;
  v49 = 200;
  v50 = 160;
  v51 = 200;
  v52 = 112;
  v53 = 240;
  v54 = 160;
  v55 = 240;
  v56 = 112;
  v57 = 280;
  v58 = 160;
  v59 = 280;
  v60 = 112;
  v61 = 320;
  v62 = 160;
  v63 = 40;
  v64 = 160;
  v65 = 80;
  v66 = 208;
  v26 = NPC->Current_State;
  if ( v26 <= 100 )
  {
    if ( v26 != 100 )
    {
      switch ( v26 )
      {
        case 0:
          if ( Super_Y_Pos <= Quote.X_Pos )
            NPC->Direction = 2;
          else
            NPC->Direction = 0;
          if ( NPC->Direction )
            NPC->X_pos = Super_Y_Pos + 3072;
          else
            NPC->X_pos = Super_Y_Pos - 3072;
          NPC->Y_pos = Curly_Shoot_Y;
          goto LABEL_24;
        case 1:
LABEL_24:
          NPC->Current_State = 2;
          goto LABEL_25;
        case 2:
LABEL_25:
          NPC->Y_vel += 128;
          if ( ++NPC->Wait_Timer / 2 % 2 )
            NPC->Ani_Num = 0;
          else
            NPC->Ani_Num = 3;
          goto LABEL_176;
        case 5:
          NPC->Current_State = 6;
          NPC->Ani_Num = 1;
          NPC->ani_wait = 0;
          goto LABEL_30;
        case 6:
LABEL_30:
          NPC->Y_vel += 128;
          if ( ++NPC->ani_wait > 40 )
          {
            NPC->ani_wait = 0;
            ++NPC->Ani_Num;
          }
          if ( NPC->Ani_Num > 2 )
            NPC->Ani_Num = 1;
          goto LABEL_176;
        case 7:
          NPC->Current_State = 8;
          NPC->Wait_Timer = 0;
          NPC->Ani_Num = 3;
          goto LABEL_36;
        case 8:
LABEL_36:
          NPC->Y_vel += 64;
          if ( ++NPC->Wait_Timer > 40 )
            NPC->Current_State = 10;
          goto LABEL_176;
        case 10:
          NPC->Entity_Flags |= 4u;
          NPC->X_vel = 0;
          NPC->Current_State = 11;
          NPC->Wait_Timer = 0;
          NPC->Ani_Num = 1;
          NPC->ani_wait = 0;
          NPC->count2 = NPC->Life;
          goto LABEL_40;
        case 11:
LABEL_40:
          NPC->Y_vel += 128;
          if ( NPC->X_pos <= Quote.X_Pos )
            NPC->Direction = 2;
          else
            NPC->Direction = 0;
          if ( NPC->Collision_flags & 8 )
          {
            if ( NPC->Life >= NPC->count2 - 20 )
            {
              if ( ++NPC->ani_wait > 10 )
              {
                NPC->ani_wait = 0;
                if ( ++NPC->Ani_Num > 2 )
                  NPC->Ani_Num = 1;
              }
            }
            else if ( Quote.Collision_Flags & 8
                   && Quote.X_Pos > NPC->X_pos - 24576
                   && Quote.X_Pos < NPC->X_pos + 24576
                   && NPC->Ani_Num != 6 )
            {
              NPC->Ani_Num = 6;
              Damage_Player(5);
              Set_Quake(10);
              Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
              Quote.Y_Vel = -1024;
              if ( NPC->X_pos <= Quote.X_Pos )
                Quote.X_Vel = 1535;
              else
                Quote.X_Vel = -1535;
              for ( i = 0; i < 100; ++i )
              {
                v1 = 3 * Random(-512, 512);
                v2 = 3 * Random(-512, 512);
                v3 = NPC->Y_pos + (Random(-16, 16) << 9);
                v4 = Random(-16, 16);
                NPC_Create(Santas_Key|0x100, NPC->X_pos + (v4 << 9), v3, v2, v1, Down, NULL, 170);
              }
            }
          }
          else
          {
            NPC->Ani_Num = 4;
          }
          if ( ++NPC->Wait_Timer > 30 || NPC->Life < NPC->count2 - 20 )
          {
            if ( ++NPC->count1 > 10 )
              NPC->count1 = 0;
            switch ( NPC->count1 )
            {
              case 8:
                NPC->Current_State = 20;
                break;
              case 2:
              case 7:
                NPC->Current_State = 100;
                break;
              case 3:
              case 6:
                NPC->Current_State = 30;
                break;
              case 1:
              case 9:
                NPC->Current_State = 40;
                break;
              default:
                NPC->Current_State = 15;
                NPC->Wait_Timer = 0;
                break;
            }
          }
          goto LABEL_176;
        case 15:
          NPC->Ani_Num = 3;
          ++NPC->Wait_Timer;
          if ( NPC->X_pos <= Quote.X_Pos )
            NPC->Direction = 2;
          else
            NPC->Direction = 0;
          if ( NPC->Wait_Timer > 20 )
          {
            NPC->Current_State = 16;
            NPC->Ani_Num = 4;
            NPC->ani_wait = 0;
            NPC->Y_vel = -1536;
            if ( NPC->Direction )
              NPC->X_vel = 1024;
            else
              NPC->X_vel = -1024;
          }
          goto LABEL_176;
        case 16:
          NPC->Y_vel += 64;
          if ( ++NPC->ani_wait > 1 )
          {
            NPC->ani_wait = 0;
            ++NPC->Ani_Num;
          }
          if ( NPC->Ani_Num > 5 )
            NPC->Ani_Num = 4;
          if ( NPC->X_pos <= Quote.X_Pos )
            NPC->Direction = 2;
          else
            NPC->Direction = 0;
          if ( NPC->Y_vel > 0 && NPC->Collision_flags & 8 )
            NPC->Current_State = 17;
          goto LABEL_176;
        case 17:
          NPC->Current_State = 18;
          NPC->Wait_Timer = 0;
          Set_Quake(10);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
          goto LABEL_92;
        case 18:
LABEL_92:
          NPC->Ani_Num = 3;
          ++NPC->Wait_Timer;
          NPC->X_vel = 7 * NPC->X_vel / 8;
          NPC->Y_vel += 128;
          if ( NPC->Wait_Timer > 10 )
            NPC->Current_State = 10;
          goto LABEL_176;
        case 20:
          NPC->Current_State = 21;
          NPC->Wait_Timer = 0;
          goto LABEL_96;
        case 21:
LABEL_96:
          ++NPC->Wait_Timer;
          NPC->Ani_Num = 6;
          if ( NPC->Wait_Timer > 20 && NPC->Wait_Timer % 3 == 1 )
          {
            Y_Vel = Random(-512, 512);
            X_Vel = 4 * Random(256, 512);
            if ( NPC->Direction )
              NPC_Create(Forcefield|0x100, NPC->X_pos + 4096, NPC->Y_pos - 2048, X_Vel, Y_Vel, Right, NULL, 256);
            else
              NPC_Create(Forcefield|0x100, NPC->X_pos - 4096, NPC->Y_pos - 2048, -X_Vel, Y_Vel, 0, NULL, 256);
            Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          }
          if ( NPC->Wait_Timer > 90 )
            NPC->Current_State = 10;
          goto LABEL_176;
        case 30:
          NPC->Current_State = 31;
          NPC->Wait_Timer = 0;
          NPC->Entity_Flags |= 1u;
          NPC->Entity_Flags &= 0xFFDFu;
          goto LABEL_106;
        case 31:
LABEL_106:
          NPC->Ani_Num = 3;
          if ( ++NPC->Wait_Timer > 20 )
          {
            NPC->Current_State = 32;
            NPC->Wait_Timer = 0;
            NPC->Ani_Num = 7;
            NPC->Entity_Flags |= 0x80u;
            NPC->Damage = 10;
            Play_Sound_Effect(Sfx_Silly_Explosion, 1);
            if ( NPC->Direction )
              NPC->X_vel = 1535;
            else
              NPC->X_vel = -1535;
          }
          break;
        case 32:
          ++NPC->Wait_Timer;
          NPC->Y_vel = 0;
          if ( NPC->Wait_Timer / 2 % 2 )
            NPC->Ani_Num = 7;
          else
            NPC->Ani_Num = 8;
          if ( NPC->Wait_Timer > 30 )
          {
            NPC->Wait_Timer = 0;
            NPC->Current_State = 18;
            NPC->Damage = 5;
            NPC->Entity_Flags &= 0xFF7Eu;
            NPC->Entity_Flags |= 0x20u;
          }
          if ( NPC->Collision_flags & 1 || NPC->Collision_flags & 4 )
          {
            NPC->Current_State = 15;
            NPC->Wait_Timer = 0;
            NPC->Damage = 5;
            NPC->Entity_Flags &= 0xFF7Eu;
            NPC->Entity_Flags |= 0x20u;
          }
          break;
        case 40:
          NPC->Ani_Num = 3;
          ++NPC->Wait_Timer;
          if ( NPC->X_pos <= Quote.X_Pos )
            NPC->Direction = 2;
          else
            NPC->Direction = 0;
          if ( NPC->Wait_Timer > 20 )
          {
            NPC->Current_State = 41;
            NPC->Ani_Num = 4;
            NPC->ani_wait = 0;
            NPC->Y_vel = -2048;
            if ( NPC->Direction )
              NPC->X_vel = 1024;
            else
              NPC->X_vel = -1024;
          }
          break;
        case 41:
          NPC->Y_vel += 64;
          if ( ++NPC->ani_wait > 1 )
          {
            NPC->ani_wait = 0;
            ++NPC->Ani_Num;
          }
          if ( NPC->Ani_Num > 5 )
            NPC->Ani_Num = 4;
          if ( Quote.Y_Pos > NPC->Y_pos && Quote.X_Pos > NPC->X_pos - 4096 && Quote.X_Pos < NPC->X_pos + 4096 )
          {
            NPC->Current_State = 16;
            NPC->Y_vel = 1535;
            NPC->X_vel = 0;
          }
          if ( NPC->Y_vel > 0 && NPC->Collision_flags & 8 )
            NPC->Current_State = 17;
          break;
        default:
          goto LABEL_176;
      }
      goto LABEL_176;
    }
    NPC->Current_State = 101;
    NPC->Wait_Timer = 0;
    NPC->Entity_Flags &= 0xFFDBu;
    NPC->Damage = 0;
    Play_Sound_Effect(Sfx_Teleport, 1);
    goto LABEL_141;
  }
  if ( v26 > 501 )
  {
    if ( v26 == 510 )
    {
      NPC->Current_State = 511;
      NPC->Wait_Timer = 0;
      NPC->Ani_Num = 9;
      NPC->Curly_Target_X = NPC->X_pos;
      NPC->Y_pos += 0x2000;
      NPC->Entity_Flags |= 8u;
    }
    else if ( v26 != 511 )
    {
      if ( v26 == 520 )
      {
        NPC->Damage = 0;
        Curly_Shoot_Y = -16384;
      }
      goto LABEL_176;
    }
    Set_Quake(2);
    if ( ++NPC->Wait_Timer % 6 == 3 )
      Play_Sound_Effect(Sfx_Silly_Explosion, 1);
    if ( NPC->Wait_Timer / 2 % 2 )
      NPC->X_pos = NPC->Curly_Target_X;
    else
      NPC->X_pos = NPC->Curly_Target_X + 512;
    if ( NPC->Wait_Timer > 352 )
    {
      NPC->Ani_Num = 0;
      NPC->Current_State = 512;
    }
  }
  else
  {
    if ( v26 == 501 )
    {
      NPC->Ani_Num = 9;
      if ( ++NPC->Wait_Timer / 2 % 2 )
        NPC->X_pos = NPC->Curly_Target_X;
      else
        NPC->X_pos = NPC->Curly_Target_X + 512;
      goto LABEL_176;
    }
    if ( v26 > 103 )
    {
      if ( v26 == 500 )
      {
        Kill_NPC(269, 1);
        NPC->Entity_Flags &= 0xFFDFu;
        NPC->Ani_Num = 4;
        NPC->Y_vel += 32;
        NPC->X_vel = 0;
        if ( NPC->Collision_flags & 8 )
        {
          NPC->Current_State = 501;
          NPC->Wait_Timer = 0;
          NPC->Curly_Target_X = NPC->X_pos;
          if ( NPC->X_pos <= Quote.X_Pos )
            NPC->Direction = 2;
          else
            NPC->Direction = 0;
        }
      }
    }
    else if ( v26 == 103 )
    {
      NPC->Wait_Timer -= 2;
      if ( NPC->Wait_Timer <= 0 )
      {
        NPC->Entity_Flags |= 0x24u;
        NPC->Damage = 5;
        NPC->Current_State = 16;
        NPC->Y_vel = -512;
        NPC->X_vel = 0;
      }
    }
    else
    {
      if ( v26 == 101 )
      {
LABEL_141:
        NPC->Wait_Timer += 2;
        if ( NPC->Wait_Timer > 28 )
        {
          NPC->Current_State = 102;
          NPC->Wait_Timer = 0;
          NPC->Ani_Num = 0;
          NPC->Curly_Target_X = Quote.X_Pos;
          NPC->Curly_Target_Y = Quote.Y_Pos - 0x4000;
          if ( NPC->Curly_Target_Y < 0x8000 )
            NPC->Curly_Target_Y = 0x8000;
          if ( NPC->Curly_Target_X < 0x8000 )
            NPC->Curly_Target_X = 0x8000;
          if ( NPC->Curly_Target_X > 294912 )
            NPC->Curly_Target_X = 294912;
        }
        goto LABEL_176;
      }
      if ( v26 == 102 && ++NPC->Wait_Timer > 40 )
      {
        NPC->Current_State = 103;
        NPC->Wait_Timer = 28;
        NPC->Ani_Num = 4;
        NPC->Y_vel = 0;
        NPC->X_pos = NPC->Curly_Target_X;
        NPC->Y_pos = NPC->Curly_Target_Y;
        if ( NPC->X_pos <= Quote.X_Pos )
          NPC->Direction = 2;
        else
          NPC->Direction = 0;
      }
    }
  }
LABEL_176:
  if ( NPC->Current_State >= 11 && NPC->Current_State < 501 )
  {
    if ( NPC->Current_State == 102 )
    {
      Super_Y_Pos = NPC->Curly_Target_X;
      Curly_Shoot_Y = NPC->Curly_Target_Y;
    }
    else
    {
      Super_Y_Pos = NPC->X_pos;
      Curly_Shoot_Y = NPC->Y_pos;
    }
  }
  if ( NPC->Y_vel > 1535 )
    NPC->Y_vel = 1535;
  NPC->X_pos += NPC->X_vel;
  NPC->Y_pos += NPC->Y_vel;
  if ( NPC->Current_State < 512 )
  {
    if ( NPC->Current_State >= 510 )
    {
      v8 = 2 * Random(-512, 0);
      v9 = Random(-512, 512);
      v10 = NPC->Y_pos - ((336 - NPC->Wait_Timer) / 8 << 9);
      v11 = Random(-16, 16);
      NPC_Create(Santas_Key|0x100, NPC->X_pos + (v11 << 9), v10, v9, v8, Down, NULL, 170);
      v12 = 2 * Random(-512, 0);
      v13 = Random(-512, 512);
      v14 = NPC->Y_pos - ((336 - NPC->Wait_Timer) / 8 << 9);
      v15 = Random(-16, 16);
      NPC_Create(Santas_Key|0x100, NPC->X_pos + (v15 << 9), v14, v13, v12, Down, NULL, 170);
      v16 = 2 * Random(-512, 0);
      v17 = NPC->Y_pos - ((336 - NPC->Wait_Timer) / 8 << 9);
      v18 = Random(-16, 16);
      NPC_Create(Santas_Key|0x100, NPC->X_pos + (v18 << 9), v17, 0, v16, Down, NULL, 170);
      v19 = 2 * Random(-512, 0);
      v20 = NPC->Y_pos - ((336 - NPC->Wait_Timer) / 8 << 9);
      v21 = Random(-16, 16);
      NPC_Create(Santas_Key|0x100, NPC->X_pos + (v21 << 9), v20, 0, v19, Down, NULL, 170);
    }
    else if ( NPC->Current_State != 102 && NPC->Current_State != 103 && Random(0, 3) == 2 )
    {
      v5 = NPC->X_vel;
      v6 = NPC->Y_pos + (Random(-8, 4) << 9);
      v7 = Random(-16, 16);
      NPC_Create(Santas_Key|0x100, NPC->X_pos + (v7 << 9), v6, v5, 0, Down, NULL, 256);
    }
  }
  if ( NPC->Direction )
  {
    v24 = &v27 + 4 * NPC->Ani_Num;
    v25 = (char *)&NPC->Rect;
    *(_DWORD *)v25 = *v24;
    *((_DWORD *)v25 + 1) = v24[1];
    *((_DWORD *)v25 + 2) = v24[2];
    *((_DWORD *)v25 + 3) = v24[3];
  }
  else
  {
    v22 = &v70 + 4 * NPC->Ani_Num;
    v23 = (char *)&NPC->Rect;
    *(_DWORD *)v23 = *v22;
    *((_DWORD *)v23 + 1) = v22[1];
    *((_DWORD *)v23 + 2) = v22[2];
    *((_DWORD *)v23 + 3) = v22[3];
  }
  if ( NPC->Current_State == 511 )
  {
    NPC->Rect.top += NPC->Wait_Timer / 8;
    NPC->view.top = (44 - NPC->Wait_Timer / 8) << 9;
    NPC->view.bottom = 2048;
  }
  else if ( NPC->Current_State != 101 && NPC->Current_State != 103 )
  {
    NPC->view.top = 14336;
  }
  else
  {
    NPC->Rect.top += NPC->Wait_Timer;
    NPC->Rect.bottom -= NPC->Wait_Timer;
    NPC->view.top = (28 - NPC->Wait_Timer) << 9;
  }
}
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (0045B3D0) --------------------------------------------------------
int __cdecl NPC268(int a1)
{
  int Y_Vel; // ST24_4@60
  int *v2; // ecx@72
  int v3; // edx@72
  int result; // eax@72
  int *v5; // ecx@73
  int v6; // edx@73
  int v7; // [sp+8h] [bp-150h]@1
  int v8; // [sp+Ch] [bp-14Ch]@1
  int v9; // [sp+10h] [bp-148h]@1
  int v10; // [sp+14h] [bp-144h]@1
  int v11; // [sp+18h] [bp-140h]@1
  int v12; // [sp+1Ch] [bp-13Ch]@1
  int v13; // [sp+20h] [bp-138h]@1
  int v14; // [sp+24h] [bp-134h]@1
  int v15; // [sp+28h] [bp-130h]@1
  int v16; // [sp+2Ch] [bp-12Ch]@1
  int v17; // [sp+30h] [bp-128h]@1
  int v18; // [sp+34h] [bp-124h]@1
  int v19; // [sp+38h] [bp-120h]@1
  int v20; // [sp+3Ch] [bp-11Ch]@1
  int v21; // [sp+40h] [bp-118h]@1
  int v22; // [sp+44h] [bp-114h]@1
  int v23; // [sp+48h] [bp-110h]@1
  int v24; // [sp+4Ch] [bp-10Ch]@1
  int v25; // [sp+50h] [bp-108h]@1
  int v26; // [sp+54h] [bp-104h]@1
  int v27; // [sp+58h] [bp-100h]@1
  int v28; // [sp+5Ch] [bp-FCh]@1
  int v29; // [sp+60h] [bp-F8h]@1
  int v30; // [sp+64h] [bp-F4h]@1
  int v31; // [sp+68h] [bp-F0h]@1
  int v32; // [sp+6Ch] [bp-ECh]@1
  int v33; // [sp+70h] [bp-E8h]@1
  int v34; // [sp+74h] [bp-E4h]@1
  int v35; // [sp+78h] [bp-E0h]@1
  int v36; // [sp+7Ch] [bp-DCh]@1
  int v37; // [sp+80h] [bp-D8h]@1
  int v38; // [sp+84h] [bp-D4h]@1
  int v39; // [sp+88h] [bp-D0h]@1
  int v40; // [sp+8Ch] [bp-CCh]@1
  int v41; // [sp+90h] [bp-C8h]@1
  int v42; // [sp+94h] [bp-C4h]@1
  int v43; // [sp+98h] [bp-C0h]@1
  int v44; // [sp+9Ch] [bp-BCh]@1
  int v45; // [sp+A0h] [bp-B8h]@1
  int v46; // [sp+A4h] [bp-B4h]@1
  int X_Vel; // [sp+ACh] [bp-ACh]@60
  int v48; // [sp+B0h] [bp-A8h]@1
  int v49; // [sp+B4h] [bp-A4h]@1
  int v50; // [sp+B8h] [bp-A0h]@1
  int v51; // [sp+BCh] [bp-9Ch]@1
  int v52; // [sp+C0h] [bp-98h]@1
  int v53; // [sp+C4h] [bp-94h]@1
  int v54; // [sp+C8h] [bp-90h]@1
  int v55; // [sp+CCh] [bp-8Ch]@1
  int v56; // [sp+D0h] [bp-88h]@1
  int v57; // [sp+D4h] [bp-84h]@1
  int v58; // [sp+D8h] [bp-80h]@1
  int v59; // [sp+DCh] [bp-7Ch]@1
  int v60; // [sp+E0h] [bp-78h]@1
  int v61; // [sp+E4h] [bp-74h]@1
  int v62; // [sp+E8h] [bp-70h]@1
  int v63; // [sp+ECh] [bp-6Ch]@1
  int v64; // [sp+F0h] [bp-68h]@1
  int v65; // [sp+F4h] [bp-64h]@1
  int v66; // [sp+F8h] [bp-60h]@1
  int v67; // [sp+FCh] [bp-5Ch]@1
  int v68; // [sp+100h] [bp-58h]@1
  int v69; // [sp+104h] [bp-54h]@1
  int v70; // [sp+108h] [bp-50h]@1
  int v71; // [sp+10Ch] [bp-4Ch]@1
  int v72; // [sp+110h] [bp-48h]@1
  int v73; // [sp+114h] [bp-44h]@1
  int v74; // [sp+118h] [bp-40h]@1
  int v75; // [sp+11Ch] [bp-3Ch]@1
  int v76; // [sp+120h] [bp-38h]@1
  int v77; // [sp+124h] [bp-34h]@1
  int v78; // [sp+128h] [bp-30h]@1
  int v79; // [sp+12Ch] [bp-2Ch]@1
  int v80; // [sp+130h] [bp-28h]@1
  int v81; // [sp+134h] [bp-24h]@1
  int v82; // [sp+138h] [bp-20h]@1
  int v83; // [sp+13Ch] [bp-1Ch]@1
  int v84; // [sp+140h] [bp-18h]@1
  int v85; // [sp+144h] [bp-14h]@1
  int v86; // [sp+148h] [bp-10h]@1
  int v87; // [sp+14Ch] [bp-Ch]@1
  unsigned __int8 v88; // [sp+157h] [bp-1h]@58

  v48 = 0;
  v49 = 0;
  v50 = 40;
  v51 = 40;
  v52 = 40;
  v53 = 0;
  v54 = 80;
  v55 = 40;
  v56 = 80;
  v57 = 0;
  v58 = 120;
  v59 = 40;
  v60 = 0;
  v61 = 0;
  v62 = 40;
  v63 = 40;
  v64 = 120;
  v65 = 0;
  v66 = 160;
  v67 = 40;
  v68 = 0;
  v69 = 0;
  v70 = 40;
  v71 = 40;
  v72 = 40;
  v73 = 80;
  v74 = 80;
  v75 = 120;
  v76 = 0;
  v77 = 80;
  v78 = 40;
  v79 = 120;
  v80 = 240;
  v81 = 0;
  v82 = 280;
  v83 = 40;
  v84 = 280;
  v85 = 0;
  v86 = 320;
  v87 = 40;
  v7 = 0;
  v8 = 40;
  v9 = 40;
  v10 = 80;
  v11 = 40;
  v12 = 40;
  v13 = 80;
  v14 = 80;
  v15 = 80;
  v16 = 40;
  v17 = 120;
  v18 = 80;
  v19 = 0;
  v20 = 40;
  v21 = 40;
  v22 = 80;
  v23 = 120;
  v24 = 40;
  v25 = 160;
  v26 = 80;
  v27 = 0;
  v28 = 40;
  v29 = 40;
  v30 = 80;
  v31 = 160;
  v32 = 80;
  v33 = 200;
  v34 = 120;
  v35 = 120;
  v36 = 80;
  v37 = 160;
  v38 = 120;
  v39 = 240;
  v40 = 40;
  v41 = 280;
  v42 = 80;
  v43 = 280;
  v44 = 40;
  v45 = 320;
  v46 = 80;
  if ( *(_DWORD *)(a1 + 8) < Quote.X_Pos - 163840
    || *(_DWORD *)(a1 + 8) > Quote.X_Pos + 163840
    || *(_DWORD *)(a1 + 12) < Quote.Y_Pos - 122880
    || *(_DWORD *)(a1 + 12) > Quote.Y_Pos + 122880 )
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) += 4096;
      goto LABEL_8;
    case 1:
LABEL_8:
      if ( ++*(_DWORD *)(a1 + 100) > 20 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 8) < Quote.X_Pos + 57344
        && *(_DWORD *)(a1 + 8) > Quote.X_Pos - 57344
        && *(_DWORD *)(a1 + 8) < Quote.X_Pos + 24576
        && *(_DWORD *)(a1 + 8) > Quote.X_Pos - 57344 )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      if ( *(_BYTE *)(a1 + 156) )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_23;
    case 0xB:
LABEL_23:
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 512;
      else
        *(_DWORD *)(a1 + 16) = -512;
      if ( *(_DWORD *)(a1 + 8) < Quote.X_Pos + 0x8000 && *(_DWORD *)(a1 + 8) > Quote.X_Pos - 0x8000 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( *(_DWORD *)(a1 + 16) < 0 && *(_DWORD *)(a1 + 4) & 1 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( *(_DWORD *)(a1 + 16) > 0 && *(_DWORD *)(a1 + 4) & 4 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
      }
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 104) = 6;
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
      {
        *(_DWORD *)(a1 + 116) = 30;
        *(_DWORD *)(a1 + 20) = -1535;
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = 512;
        else
          *(_DWORD *)(a1 + 16) = -512;
        Play_Sound_Effect(Sfx_Power_Critter_Large_Enemy_Jump, 1);
      }
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 104) = 7;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 40;
        *(_DWORD *)(a1 + 120) = 0;
        Set_Quake(20);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      }
      break;
    case 0x28:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 104) = 6;
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 50;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 0;
      if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_55;
    case 0x33:
LABEL_55:
      if ( ++*(_DWORD *)(a1 + 120) > 30 && *(_DWORD *)(a1 + 120) % 4 == 1 )
      {
        if ( *(_DWORD *)(a1 + 76) )
          v88 = -8;
        else
          v88 = -120;
        v88 += Random(-16, 16);
        Y_Vel = 5 * GetSin(v88);
        X_Vel = 5 * GetCos(v88);
        NPC_Create(
          Projectile_Balrog_Energy_Bounce,
          *(_DWORD *)(a1 + 8),
          *(_DWORD *)(a1 + 12) + 2048,
          X_Vel,
          Y_Vel,
          0,
          NULL,
          256);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      }
      if ( *(_DWORD *)(a1 + 120) < 50 && *(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 9;
      else
        *(_DWORD *)(a1 + 104) = 8;
      if ( *(_DWORD *)(a1 + 120) > 82 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 51;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v6 = a1 + 84;
    *(_DWORD *)v6 = *v5;
    *(_DWORD *)(v6 + 4) = v5[1];
    result = v5[2];
    *(_DWORD *)(v6 + 8) = result;
    *(_DWORD *)(v6 + 12) = v5[3];
  }
  else
  {
    v2 = &v48 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    result = v2[2];
    *(_DWORD *)(v3 + 8) = result;
    *(_DWORD *)(v3 + 12) = v2[3];
  }
  return result;
}

//----- (0045BCB0) --------------------------------------------------------
int __cdecl NPC269(int a1)
{
  int *v1; // edx@22
  int result; // eax@22
  int *v3; // edx@23
  int v4; // [sp+0h] [bp-64h]@1
  int v5; // [sp+4h] [bp-60h]@1
  int v6; // [sp+8h] [bp-5Ch]@1
  int v7; // [sp+Ch] [bp-58h]@1
  int v8; // [sp+10h] [bp-54h]@1
  int v9; // [sp+14h] [bp-50h]@1
  int v10; // [sp+18h] [bp-4Ch]@1
  int v11; // [sp+1Ch] [bp-48h]@1
  int v12; // [sp+20h] [bp-44h]@1
  int v13; // [sp+24h] [bp-40h]@1
  int v14; // [sp+28h] [bp-3Ch]@1
  int v15; // [sp+2Ch] [bp-38h]@1
  int v16; // [sp+30h] [bp-34h]@1
  int v17; // [sp+34h] [bp-30h]@1
  int v18; // [sp+38h] [bp-2Ch]@1
  int v19; // [sp+3Ch] [bp-28h]@1
  int v20; // [sp+40h] [bp-24h]@1
  int v21; // [sp+44h] [bp-20h]@1
  int v22; // [sp+48h] [bp-1Ch]@1
  int v23; // [sp+4Ch] [bp-18h]@1
  int v24; // [sp+50h] [bp-14h]@1
  int v25; // [sp+54h] [bp-10h]@1
  int v26; // [sp+58h] [bp-Ch]@1
  int v27; // [sp+5Ch] [bp-8h]@1
  int v28; // [sp+60h] [bp-4h]@1

  v17 = 232;
  v18 = 0;
  v19 = 248;
  v20 = 16;
  v21 = 248;
  v22 = 0;
  v23 = 264;
  v24 = 16;
  v25 = 248;
  v26 = 16;
  v27 = 264;
  v28 = 32;
  v5 = 232;
  v6 = 32;
  v7 = 248;
  v8 = 48;
  v9 = 248;
  v10 = 32;
  v11 = 264;
  v12 = 48;
  v13 = 248;
  v14 = 48;
  v15 = 264;
  v16 = 64;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_21;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 24) = *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 28) = *(_DWORD *)(a1 + 20);
  }
  if ( *(_DWORD *)(a1 + 24) < 0 && *(_DWORD *)(a1 + 4) & 1 )
  {
    *(_DWORD *)(a1 + 76) = 2;
    *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
  }
  else if ( *(_DWORD *)(a1 + 24) > 0 && *(_DWORD *)(a1 + 4) & 4 )
  {
    *(_DWORD *)(a1 + 76) = 0;
    *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
  }
  else if ( *(_DWORD *)(a1 + 28) < 0 && *(_DWORD *)(a1 + 4) & 2 )
  {
    *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
  }
  else if ( *(_DWORD *)(a1 + 28) > 0 && *(_DWORD *)(a1 + 4) & 8 )
  {
    *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 24);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 28);
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
LABEL_21:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v17 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (0045BF10) --------------------------------------------------------
int __cdecl NPC270(int a1)
{
  int *v1; // edx@34
  int result; // eax@34
  int v3; // [sp+4h] [bp-20h]@1
  int v4; // [sp+8h] [bp-1Ch]@1
  int v5; // [sp+Ch] [bp-18h]@1
  int v6; // [sp+10h] [bp-14h]@1
  int v7; // [sp+14h] [bp-10h]@1
  int v8; // [sp+18h] [bp-Ch]@1
  int v9; // [sp+1Ch] [bp-8h]@1
  int v10; // [sp+20h] [bp-4h]@1

  v3 = 170;
  v4 = 34;
  v5 = 174;
  v6 = 38;
  v7 = 170;
  v8 = 42;
  v9 = 174;
  v10 = 46;
  if ( *(_DWORD *)(a1 + 76) != 3 && *(_DWORD *)(a1 + 76) != 1 )
  {
    if ( *(_DWORD *)(a1 + 76) == 2 )
    {
      if ( !*(_DWORD *)(a1 + 116) )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_WORD *)(a1 + 80) |= 8u;
        *(_DWORD *)(a1 + 16) = 3 * Random(-512, 512);
        *(_DWORD *)(a1 + 20) = 3 * Random(-512, 512);
        *(_DWORD *)(a1 + 108) = Random(16, 51);
        *(_DWORD *)(a1 + 112) = Random(128, 256);
      }
      if ( *(_DWORD *)(a1 + 8) < *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) )
        *(_DWORD *)(a1 + 16) += 512 / *(_DWORD *)(a1 + 108);
      if ( *(_DWORD *)(a1 + 8) > *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) )
        *(_DWORD *)(a1 + 16) -= 512 / *(_DWORD *)(a1 + 108);
      if ( *(_DWORD *)(a1 + 12) < *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) )
        *(_DWORD *)(a1 + 20) += 512 / *(_DWORD *)(a1 + 108);
      if ( *(_DWORD *)(a1 + 12) > *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) )
        *(_DWORD *)(a1 + 20) -= 512 / *(_DWORD *)(a1 + 108);
      if ( *(_DWORD *)(a1 + 16) > 2 * *(_DWORD *)(a1 + 112) )
        *(_DWORD *)(a1 + 16) = 2 * *(_DWORD *)(a1 + 112);
      if ( *(_DWORD *)(a1 + 16) < -2 * *(_DWORD *)(a1 + 112) )
        *(_DWORD *)(a1 + 16) = -2 * *(_DWORD *)(a1 + 112);
      if ( *(_DWORD *)(a1 + 20) > 3 * *(_DWORD *)(a1 + 112) )
        *(_DWORD *)(a1 + 20) = 3 * *(_DWORD *)(a1 + 112);
      if ( *(_DWORD *)(a1 + 20) < -3 * *(_DWORD *)(a1 + 112) )
        *(_DWORD *)(a1 + 20) = -3 * *(_DWORD *)(a1 + 112);
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    }
  }
  else
  {
    if ( *(_DWORD *)(a1 + 76) == 3 )
      *(_DWORD *)(a1 + 20) += 64;
    if ( *(_DWORD *)(a1 + 76) == 1 )
      *(_DWORD *)(a1 + 20) -= 64;
    ++*(_DWORD *)(a1 + 120);
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
    if ( *(_DWORD *)(a1 + 120) > 50 )
      *(_BYTE *)a1 = 0;
    if ( *(_DWORD *)(a1 + 4) & 0xFF )
      *(_BYTE *)a1 = 0;
  }
  v1 = &v3 + 4 * Random(0, 1);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0045C230) --------------------------------------------------------
void __cdecl NPC271(void *a1)
{
  signed int v1; // [sp+0h] [bp-4h]@8

  if ( *((_DWORD *)a1 + 4) >= 0 || *((_DWORD *)a1 + 2) >= -8192 )
  {
    if ( *((_DWORD *)a1 + 4) <= 0 || *((_DWORD *)a1 + 2) <= (Current_Map.Width << 13) + 0x2000 )
    {
      if ( !*((_DWORD *)a1 + 29) )
      {
        *((_DWORD *)a1 + 29) = 1;
        v1 = Random(0, 9);
        if ( v1 == 9 )
        {
          *((_DWORD *)a1 + 21) = 0;
          *((_DWORD *)a1 + 23) = 32;
          *((_DWORD *)a1 + 22) = 64;
          *((_DWORD *)a1 + 24) = 96;
          *((_DWORD *)a1 + 35) = 0x2000;
          *((_DWORD *)a1 + 37) = 0x2000;
          *((_DWORD *)a1 + 36) = 0x2000;
          *((_DWORD *)a1 + 38) = 0x2000;
          *((_DWORD *)a1 + 31) = 6144;
          *((_DWORD *)a1 + 33) = 6144;
          *((_DWORD *)a1 + 32) = 6144;
          *((_DWORD *)a1 + 34) = 6144;
        }
        else
        {
          *((_DWORD *)a1 + 21) = 16 * (v1 % 3) + 112;
          *((_DWORD *)a1 + 22) = 16 * (v1 / 3);
          *((_DWORD *)a1 + 23) = *((_DWORD *)a1 + 21) + 16;
          *((_DWORD *)a1 + 24) = *((_DWORD *)a1 + 22) + 16;
        }
        if ( *((_DWORD *)a1 + 19) )
          *((_DWORD *)a1 + 4) = 2 * Random(256, 512);
        else
          *((_DWORD *)a1 + 4) = -2 * Random(256, 512);
        *((_DWORD *)a1 + 5) = Random(-512, 512);
      }
      if ( *((_DWORD *)a1 + 5) < 0 && *((_DWORD *)a1 + 3) - *((_DWORD *)a1 + 32) < 4096 )
      {
        *((_DWORD *)a1 + 5) = -*((_DWORD *)a1 + 5);
        Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3) - 4096, 13, 0);
        Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3) - 4096, 13, 0);
      }
      if ( *((_DWORD *)a1 + 5) > 0 && *((_DWORD *)a1 + 34) + *((_DWORD *)a1 + 3) > 118784 )
      {
        *((_DWORD *)a1 + 5) = -*((_DWORD *)a1 + 5);
        Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3) + 4096, 13, 0);
        Create_Effect(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3) + 4096, 13, 0);
      }
      *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
      *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
    }
    else
    {
      Vanish_NPC((NPC_vars *)a1);
    }
  }
  else
  {
    Vanish_NPC((NPC_vars *)a1);
  }
}

//----- (0045C500) --------------------------------------------------------
void __cdecl NPC272(int a1)
{
  Directions v1; // ST14_4@7
  int v2; // eax@7
  int v3; // [sp+0h] [bp-4h]@1

  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
      return;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 120) = Random(0, 200);
  }
  if ( *(_DWORD *)(a1 + 120) )
  {
    --*(_DWORD *)(a1 + 120);
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 0;
    v1 = *(_DWORD *)(a1 + 76);
    v2 = Random(-32, 32);
    NPC_Create(Treasure_Chest_Closed|0x100, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v2 << 9), 0, 0, v1, NULL, 256);
  }
}

//----- (0045C5A0) --------------------------------------------------------
void __cdecl NPC273(void *npc)
{
  int *v1; // eax@11
  char *v2; // ecx@11
  int v3; // [sp+0h] [bp-34h]@1
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 248;
  v5 = 40;
  v6 = 272;
  v7 = 64;
  v8 = 272;
  v9 = 40;
  v10 = 296;
  v11 = 64;
  v12 = 296;
  v13 = 40;
  v14 = 320;
  v15 = 64;
  v3 = *((_DWORD *)npc + 29);
  if ( v3 )
  {
    if ( v3 != 1 )
      goto LABEL_11;
  }
  else
  {
    *((_DWORD *)npc + 29) = 1;
  }
  *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
  *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
  if ( *((_DWORD *)npc + 1) & 0xFF )
  {
    NPC_Create(Smoke, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
    NPC_Create(Smoke, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
    NPC_Create(Smoke, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
    Vanish_NPC((NPC_vars *)npc);
    return;
  }
  if ( !(++*((_DWORD *)npc + 30) % 5) )
    Play_Sound_Effect(Sfx_Power_Critter_Flys, 1);
  if ( ++*((_DWORD *)npc + 26) > 2 )
    *((_DWORD *)npc + 26) = 0;
LABEL_11:
  v1 = &v4 + 4 * *((_DWORD *)npc + 26);
  v2 = (char *)npc + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
}

//----- (0045C750) --------------------------------------------------------
int __cdecl NPC274(int a1)
{
  int *v1; // eax@33
  int v2; // ecx@33
  int result; // eax@33
  int *v4; // eax@34
  int v5; // ecx@34
  int v6; // [sp+4h] [bp-D0h]@1
  int v7; // [sp+8h] [bp-CCh]@1
  int v8; // [sp+Ch] [bp-C8h]@1
  int v9; // [sp+10h] [bp-C4h]@1
  int v10; // [sp+14h] [bp-C0h]@1
  int v11; // [sp+18h] [bp-BCh]@1
  int v12; // [sp+1Ch] [bp-B8h]@1
  int v13; // [sp+20h] [bp-B4h]@1
  int v14; // [sp+24h] [bp-B0h]@1
  int v15; // [sp+28h] [bp-ACh]@1
  int v16; // [sp+2Ch] [bp-A8h]@1
  int v17; // [sp+30h] [bp-A4h]@1
  int v18; // [sp+34h] [bp-A0h]@1
  int v19; // [sp+38h] [bp-9Ch]@1
  int v20; // [sp+3Ch] [bp-98h]@1
  int v21; // [sp+40h] [bp-94h]@1
  int v22; // [sp+44h] [bp-90h]@1
  int v23; // [sp+48h] [bp-8Ch]@1
  int v24; // [sp+4Ch] [bp-88h]@1
  int v25; // [sp+50h] [bp-84h]@1
  int v26; // [sp+54h] [bp-80h]@1
  int v27; // [sp+58h] [bp-7Ch]@1
  int v28; // [sp+5Ch] [bp-78h]@1
  int v29; // [sp+60h] [bp-74h]@1
  int Y_Vel; // [sp+64h] [bp-70h]@22
  int X_Vel; // [sp+68h] [bp-6Ch]@22
  int v32; // [sp+6Ch] [bp-68h]@1
  int v33; // [sp+70h] [bp-64h]@1
  int v34; // [sp+74h] [bp-60h]@1
  int v35; // [sp+78h] [bp-5Ch]@1
  int v36; // [sp+7Ch] [bp-58h]@1
  int v37; // [sp+80h] [bp-54h]@1
  int v38; // [sp+84h] [bp-50h]@1
  int v39; // [sp+88h] [bp-4Ch]@1
  int v40; // [sp+8Ch] [bp-48h]@1
  int v41; // [sp+90h] [bp-44h]@1
  int v42; // [sp+94h] [bp-40h]@1
  int v43; // [sp+98h] [bp-3Ch]@1
  int v44; // [sp+9Ch] [bp-38h]@1
  int v45; // [sp+A0h] [bp-34h]@1
  int v46; // [sp+A4h] [bp-30h]@1
  int v47; // [sp+A8h] [bp-2Ch]@1
  int v48; // [sp+ACh] [bp-28h]@1
  int v49; // [sp+B0h] [bp-24h]@1
  int v50; // [sp+B4h] [bp-20h]@1
  int v51; // [sp+B8h] [bp-1Ch]@1
  int v52; // [sp+BCh] [bp-18h]@1
  int v53; // [sp+C0h] [bp-14h]@1
  int v54; // [sp+C4h] [bp-10h]@1
  int v55; // [sp+C8h] [bp-Ch]@1
  unsigned __int8 v56; // [sp+D3h] [bp-1h]@22

  v32 = 0;
  v33 = 0;
  v34 = 32;
  v35 = 40;
  v36 = 32;
  v37 = 0;
  v38 = 64;
  v39 = 40;
  v40 = 64;
  v41 = 0;
  v42 = 96;
  v43 = 40;
  v44 = 64;
  v45 = 80;
  v46 = 96;
  v47 = 120;
  v48 = 96;
  v49 = 80;
  v50 = 128;
  v51 = 120;
  v52 = 96;
  v53 = 0;
  v54 = 128;
  v55 = 40;
  v6 = 0;
  v7 = 40;
  v8 = 32;
  v9 = 80;
  v10 = 32;
  v11 = 40;
  v12 = 64;
  v13 = 80;
  v14 = 64;
  v15 = 40;
  v16 = 96;
  v17 = 80;
  v18 = 64;
  v19 = 120;
  v20 = 96;
  v21 = 160;
  v22 = 96;
  v23 = 120;
  v24 = 128;
  v25 = 160;
  v26 = 96;
  v27 = 40;
  v28 = 128;
  v29 = 80;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 4096;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 116) = 2;
      *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_4;
    case 2:
LABEL_4:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( ++*(_DWORD *)(a1 + 100) > 40 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_BYTE *)(a1 + 156) )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_15;
    case 0xB:
LABEL_15:
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 104) = 3;
        *(_DWORD *)(a1 + 20) = -1536;
        *(_DWORD *)(a1 + 108) = 0;
        if ( *(_DWORD *)(a1 + 32) <= *(_DWORD *)(a1 + 8) )
          *(_DWORD *)(a1 + 16) = -512;
        else
          *(_DWORD *)(a1 + 16) = 512;
      }
      break;
    case 0xC:
      if ( *(_DWORD *)(a1 + 20) > 0 )
      {
        *(_DWORD *)(a1 + 104) = 4;
        if ( !*(_DWORD *)(a1 + 108) )
        {
          ++*(_DWORD *)(a1 + 108);
          v56 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - 5120 - Quote.Y_Pos);
          Y_Vel = 4 * GetSin(v56);
          X_Vel = 4 * GetCos(v56);
          NPC_Create((NPC_Names)273, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) - 5120, X_Vel, Y_Vel, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        }
      }
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 104) = 5;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 116) = 13;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 16) = 0;
      }
      break;
    case 0xD:
      *(_DWORD *)(a1 + 16) /= 2;
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
        *(_DWORD *)(a1 + 116) = 1;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 85;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v32 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (0045CC80) --------------------------------------------------------
int __cdecl NPC275(int a1)
{
  int *v1; // edx@21
  int result; // eax@21
  int v3; // [sp+0h] [bp-44h]@1
  int v4; // [sp+4h] [bp-40h]@1
  int v5; // [sp+8h] [bp-3Ch]@1
  int v6; // [sp+Ch] [bp-38h]@1
  int v7; // [sp+10h] [bp-34h]@1
  int v8; // [sp+14h] [bp-30h]@1
  int v9; // [sp+18h] [bp-2Ch]@1
  int v10; // [sp+1Ch] [bp-28h]@1
  int v11; // [sp+20h] [bp-24h]@1
  int v12; // [sp+24h] [bp-20h]@1
  int v13; // [sp+28h] [bp-1Ch]@1
  int v14; // [sp+2Ch] [bp-18h]@1
  int v15; // [sp+30h] [bp-14h]@1
  int v16; // [sp+34h] [bp-10h]@1
  int v17; // [sp+38h] [bp-Ch]@1
  int v18; // [sp+3Ch] [bp-8h]@1
  int v19; // [sp+40h] [bp-4h]@1

  v4 = 272;
  v5 = 80;
  v6 = 288;
  v7 = 96;
  v8 = 288;
  v9 = 80;
  v10 = 304;
  v11 = 96;
  v12 = 272;
  v13 = 80;
  v14 = 288;
  v15 = 96;
  v16 = 304;
  v17 = 80;
  v18 = 320;
  v19 = 96;
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
    {
      if ( v3 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_19;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
  if ( *(_DWORD *)(a1 + 8) - 0x8000 < Quote.X_Pos
    && *(_DWORD *)(a1 + 8) + 0x8000 > Quote.X_Pos
    && *(_DWORD *)(a1 + 12) - 0x4000 < Quote.Y_Pos
    && *(_DWORD *)(a1 + 12) + 0x2000 > Quote.Y_Pos )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 3 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 3 )
      *(_DWORD *)(a1 + 104) = 2;
  }
LABEL_19:
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0045CEA0) --------------------------------------------------------
int __cdecl NPC276(int a1)
{
  int *v1; // ecx@48
  int v2; // edx@48
  int result; // eax@48
  int *v4; // ecx@49
  int v5; // edx@49
  int v6; // [sp+Ch] [bp-130h]@1
  int v7; // [sp+10h] [bp-12Ch]@1
  int v8; // [sp+14h] [bp-128h]@1
  int v9; // [sp+18h] [bp-124h]@1
  int v10; // [sp+1Ch] [bp-120h]@1
  int v11; // [sp+20h] [bp-11Ch]@1
  int v12; // [sp+24h] [bp-118h]@1
  int v13; // [sp+28h] [bp-114h]@1
  int v14; // [sp+2Ch] [bp-110h]@1
  int v15; // [sp+30h] [bp-10Ch]@1
  int v16; // [sp+34h] [bp-108h]@1
  int v17; // [sp+38h] [bp-104h]@1
  int v18; // [sp+3Ch] [bp-100h]@1
  int v19; // [sp+40h] [bp-FCh]@1
  int v20; // [sp+44h] [bp-F8h]@1
  int v21; // [sp+48h] [bp-F4h]@1
  int v22; // [sp+4Ch] [bp-F0h]@1
  int v23; // [sp+50h] [bp-ECh]@1
  int v24; // [sp+54h] [bp-E8h]@1
  int v25; // [sp+58h] [bp-E4h]@1
  int v26; // [sp+5Ch] [bp-E0h]@1
  int v27; // [sp+60h] [bp-DCh]@1
  int v28; // [sp+64h] [bp-D8h]@1
  int v29; // [sp+68h] [bp-D4h]@1
  int v30; // [sp+6Ch] [bp-D0h]@1
  int v31; // [sp+70h] [bp-CCh]@1
  int v32; // [sp+74h] [bp-C8h]@1
  int v33; // [sp+78h] [bp-C4h]@1
  int v34; // [sp+7Ch] [bp-C0h]@1
  int v35; // [sp+80h] [bp-BCh]@1
  int v36; // [sp+84h] [bp-B8h]@1
  int v37; // [sp+88h] [bp-B4h]@1
  int v38; // [sp+8Ch] [bp-B0h]@1
  int v39; // [sp+90h] [bp-ACh]@1
  int v40; // [sp+94h] [bp-A8h]@1
  int v41; // [sp+98h] [bp-A4h]@1
  int Y_Vel; // [sp+9Ch] [bp-A0h]@16
  int X_Vel; // [sp+A0h] [bp-9Ch]@16
  int v44; // [sp+A4h] [bp-98h]@1
  int v45; // [sp+A8h] [bp-94h]@1
  int v46; // [sp+ACh] [bp-90h]@1
  int v47; // [sp+B0h] [bp-8Ch]@1
  int v48; // [sp+B4h] [bp-88h]@1
  int v49; // [sp+B8h] [bp-84h]@1
  int v50; // [sp+BCh] [bp-80h]@1
  int v51; // [sp+C0h] [bp-7Ch]@1
  int v52; // [sp+C4h] [bp-78h]@1
  int v53; // [sp+C8h] [bp-74h]@1
  int v54; // [sp+CCh] [bp-70h]@1
  int v55; // [sp+D0h] [bp-6Ch]@1
  int v56; // [sp+D4h] [bp-68h]@1
  int v57; // [sp+D8h] [bp-64h]@1
  int v58; // [sp+DCh] [bp-60h]@1
  int v59; // [sp+E0h] [bp-5Ch]@1
  int v60; // [sp+E4h] [bp-58h]@1
  int v61; // [sp+E8h] [bp-54h]@1
  int v62; // [sp+ECh] [bp-50h]@1
  int v63; // [sp+F0h] [bp-4Ch]@1
  int v64; // [sp+F4h] [bp-48h]@1
  int v65; // [sp+F8h] [bp-44h]@1
  int v66; // [sp+FCh] [bp-40h]@1
  int v67; // [sp+100h] [bp-3Ch]@1
  int v68; // [sp+104h] [bp-38h]@1
  int v69; // [sp+108h] [bp-34h]@1
  int v70; // [sp+10Ch] [bp-30h]@1
  int v71; // [sp+110h] [bp-2Ch]@1
  int v72; // [sp+114h] [bp-28h]@1
  int v73; // [sp+118h] [bp-24h]@1
  int v74; // [sp+11Ch] [bp-20h]@1
  int v75; // [sp+120h] [bp-1Ch]@1
  int v76; // [sp+124h] [bp-18h]@1
  int v77; // [sp+128h] [bp-14h]@1
  int v78; // [sp+12Ch] [bp-10h]@1
  int v79; // [sp+130h] [bp-Ch]@1
  unsigned __int8 v80; // [sp+13Bh] [bp-1h]@16

  v44 = 0;
  v45 = 64;
  v46 = 32;
  v47 = 104;
  v48 = 32;
  v49 = 64;
  v50 = 64;
  v51 = 104;
  v52 = 64;
  v53 = 64;
  v54 = 96;
  v55 = 104;
  v56 = 96;
  v57 = 64;
  v58 = 128;
  v59 = 104;
  v60 = 128;
  v61 = 64;
  v62 = 160;
  v63 = 104;
  v64 = 160;
  v65 = 64;
  v66 = 192;
  v67 = 104;
  v68 = 192;
  v69 = 64;
  v70 = 224;
  v71 = 104;
  v72 = 224;
  v73 = 64;
  v74 = 256;
  v75 = 104;
  v76 = 256;
  v77 = 64;
  v78 = 288;
  v79 = 104;
  v6 = 0;
  v7 = 104;
  v8 = 32;
  v9 = 144;
  v10 = 32;
  v11 = 104;
  v12 = 64;
  v13 = 144;
  v14 = 64;
  v15 = 104;
  v16 = 96;
  v17 = 144;
  v18 = 96;
  v19 = 104;
  v20 = 128;
  v21 = 144;
  v22 = 128;
  v23 = 104;
  v24 = 160;
  v25 = 144;
  v26 = 160;
  v27 = 104;
  v28 = 192;
  v29 = 144;
  v30 = 192;
  v31 = 104;
  v32 = 224;
  v33 = 144;
  v34 = 224;
  v35 = 104;
  v36 = 256;
  v37 = 144;
  v38 = 256;
  v39 = 104;
  v40 = 288;
  v41 = 144;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 116) = 2;
      *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_4;
    case 2:
LABEL_4:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( ++*(_DWORD *)(a1 + 100) > 20 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_BYTE *)(a1 + 156) )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 3;
      *(_WORD *)(a1 + 80) |= 0x20u;
      goto LABEL_15;
    case 0xB:
LABEL_15:
      switch ( ++*(_DWORD *)(a1 + 120) )
      {
        case 0x1E:
        case 0x28:
        case 0x32:
          *(_DWORD *)(a1 + 104) = 4;
          v80 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
          Y_Vel = 4 * GetSin(v80);
          X_Vel = 4 * GetCos(v80);
          NPC_Create((NPC_Names)277, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          break;
        case 0x22:
        case 0x2C:
        case 0x36:
          *(_DWORD *)(a1 + 104) = 3;
          break;
        default:
          break;
      }
      if ( *(_DWORD *)(a1 + 120) > 60 )
      {
        *(_DWORD *)(a1 + 116) = 20;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
      }
      break;
    case 0x14:
      if ( ++*(_DWORD *)(a1 + 120) > 20 )
      {
        *(_DWORD *)(a1 + 116) = 21;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 5;
        *(_DWORD *)(a1 + 20) = -1535;
        if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
          *(_DWORD *)(a1 + 16) = -256;
        else
          *(_DWORD *)(a1 + 16) = 256;
      }
      break;
    case 0x15:
      switch ( ++*(_DWORD *)(a1 + 120) )
      {
        case 0x1E:
        case 0x28:
        case 0x32:
          *(_DWORD *)(a1 + 104) = 6;
          v80 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - 5120 - Quote.Y_Pos);
          Y_Vel = 4 * GetSin(v80);
          X_Vel = 4 * GetCos(v80);
          NPC_Create((NPC_Names)277, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) - 5120, X_Vel, Y_Vel, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          break;
        case 0x22:
        case 0x2C:
          *(_DWORD *)(a1 + 104) = 5;
          break;
        default:
          break;
      }
      if ( *(_DWORD *)(a1 + 120) > 53 )
        *(_DWORD *)(a1 + 104) = 7;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 22;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
        Set_Quake(10);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      }
      break;
    case 0x16:
      *(_DWORD *)(a1 + 16) /= 2;
      if ( ++*(_DWORD *)(a1 + 120) > 22 )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0x32:
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_DWORD *)(a1 + 164) = 0;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 51;
        *(_DWORD *)(a1 + 104) = 2;
        Set_Quake(10);
        Spawn_Exp(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 19);
        Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 8);
        Play_Sound_Effect(Sfx_Explosion, 1);
      }
      break;
    case 0x33:
      *(_DWORD *)(a1 + 16) = 7 * *(_DWORD *)(a1 + 16) / 8;
      *(_DWORD *)(a1 + 104) = 8;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 116) < 50 )
  {
    if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 0;
    else
      *(_DWORD *)(a1 + 76) = 2;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v44 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (0045D780) --------------------------------------------------------
void __cdecl NPC277(void *npc)
{
  int *v1; // eax@11
  char *v2; // ecx@11
  int v3; // [sp+0h] [bp-34h]@1
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 128;
  v5 = 0;
  v6 = 152;
  v7 = 24;
  v8 = 152;
  v9 = 0;
  v10 = 176;
  v11 = 24;
  v12 = 176;
  v13 = 0;
  v14 = 200;
  v15 = 24;
  v3 = *((_DWORD *)npc + 29);
  if ( v3 )
  {
    if ( v3 != 1 )
      goto LABEL_11;
  }
  else
  {
    *((_DWORD *)npc + 29) = 1;
  }
  *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
  *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
  if ( *((_DWORD *)npc + 1) & 0xFF )
  {
    NPC_Create(Smoke, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
    NPC_Create(Smoke, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
    NPC_Create(Smoke, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
    Vanish_NPC((NPC_vars *)npc);
    return;
  }
  if ( !(++*((_DWORD *)npc + 30) % 5) )
    Play_Sound_Effect(Sfx_Power_Critter_Flys, 1);
  if ( ++*((_DWORD *)npc + 26) > 2 )
    *((_DWORD *)npc + 26) = 0;
LABEL_11:
  v1 = &v4 + 4 * *((_DWORD *)npc + 26);
  v2 = (char *)npc + 84;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
}

//----- (0045D930) --------------------------------------------------------
int __cdecl NPC278(int a1)
{
  int *v1; // ecx@34
  int v2; // edx@34
  int *v3; // ecx@35
  int v4; // edx@35
  int *v5; // ecx@33
  int v6; // edx@33
  int result; // eax@33
  int v8; // [sp+0h] [bp-68h]@31
  int v9; // [sp+8h] [bp-60h]@1
  int v10; // [sp+Ch] [bp-5Ch]@1
  int v11; // [sp+10h] [bp-58h]@1
  int v12; // [sp+14h] [bp-54h]@1
  int v13; // [sp+18h] [bp-50h]@1
  int v14; // [sp+1Ch] [bp-4Ch]@1
  int v15; // [sp+20h] [bp-48h]@1
  int v16; // [sp+24h] [bp-44h]@1
  int v17; // [sp+28h] [bp-40h]@1
  int v18; // [sp+2Ch] [bp-3Ch]@1
  int v19; // [sp+30h] [bp-38h]@1
  int v20; // [sp+34h] [bp-34h]@1
  int v21; // [sp+38h] [bp-30h]@1
  int v22; // [sp+3Ch] [bp-2Ch]@1
  int v23; // [sp+40h] [bp-28h]@1
  int v24; // [sp+44h] [bp-24h]@1
  int v25; // [sp+48h] [bp-20h]@1
  int v26; // [sp+4Ch] [bp-1Ch]@1
  int v27; // [sp+50h] [bp-18h]@1
  int v28; // [sp+54h] [bp-14h]@1
  int v29; // [sp+58h] [bp-10h]@1
  int v30; // [sp+5Ch] [bp-Ch]@1
  int v31; // [sp+60h] [bp-8h]@1
  int v32; // [sp+64h] [bp-4h]@1

  v17 = 0;
  v18 = 120;
  v19 = 8;
  v20 = 128;
  v21 = 8;
  v22 = 120;
  v23 = 16;
  v24 = 128;
  v9 = 16;
  v10 = 120;
  v11 = 24;
  v12 = 128;
  v13 = 24;
  v14 = 120;
  v15 = 32;
  v16 = 128;
  v25 = 32;
  v26 = 120;
  v27 = 40;
  v28 = 128;
  v29 = 40;
  v30 = 120;
  v31 = 48;
  v32 = 128;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( Random(0, 60) == 1 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 2:
      if ( ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = Random(0, 16);
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      if ( Random(0, 9) % 2 )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      goto LABEL_14;
    case 0xB:
LABEL_14:
      if ( *(_DWORD *)(a1 + 76) || !(*(_DWORD *)(a1 + 4) & 1) )
      {
        if ( *(_DWORD *)(a1 + 76) == 2 && *(_DWORD *)(a1 + 4) & 4 )
          *(_DWORD *)(a1 + 76) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 76) = 2;
      }
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 256;
      else
        *(_DWORD *)(a1 + 16) = -256;
      if ( ++*(_DWORD *)(a1 + 100) > 4 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 32 )
        *(_DWORD *)(a1 + 116) = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v8 = *(_DWORD *)(a1 + 48);
  if ( v8 == 200 )
  {
    v1 = &v17 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  else if ( v8 == 210 )
  {
    v3 = &v9 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    result = v3[2];
    *(_DWORD *)(v4 + 8) = result;
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  else
  {
    v5 = &v25 + 4 * *(_DWORD *)(a1 + 104);
    v6 = a1 + 84;
    *(_DWORD *)v6 = *v5;
    *(_DWORD *)(v6 + 4) = v5[1];
    result = v5[2];
    *(_DWORD *)(v6 + 8) = result;
    *(_DWORD *)(v6 + 12) = v5[3];
  }
  return result;
}

//----- (0045DCF0) --------------------------------------------------------
int __cdecl NPC279(int a1)
{
  int v1; // ST10_4@21
  int v2; // ST0C_4@21
  int v3; // ST08_4@21
  int v4; // eax@21
  int result; // eax@23
  int *v6; // ecx@28
  int v7; // edx@28
  int v8; // [sp+0h] [bp-2Ch]@2
  signed int i; // [sp+8h] [bp-24h]@19
  int v10; // [sp+Ch] [bp-20h]@1
  int v11; // [sp+10h] [bp-1Ch]@1
  int v12; // [sp+14h] [bp-18h]@1
  int v13; // [sp+18h] [bp-14h]@1
  int v14; // [sp+1Ch] [bp-10h]@1
  int v15; // [sp+20h] [bp-Ch]@1
  int v16; // [sp+24h] [bp-8h]@1
  int v17; // [sp+28h] [bp-4h]@1

  v10 = 0;
  v11 = 16;
  v12 = 32;
  v13 = 48;
  v14 = 16;
  v15 = 0;
  v16 = 32;
  v17 = 16;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      v8 = *(_DWORD *)(a1 + 76);
      if ( v8 )
      {
        if ( v8 == 1 )
        {
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 116) = 10;
        }
        else if ( v8 == 2 )
        {
          *(_DWORD *)(a1 + 116) = 100;
          *(_WORD *)(a1 + 80) |= 4u;
          *(_DWORD *)(a1 + 104) = 1;
          *(_DWORD *)(a1 + 148) = 4096;
          *(_DWORD *)(a1 + 140) = 4096;
          *(_DWORD *)(a1 + 144) = 4096;
          *(_DWORD *)(a1 + 152) = 4096;
          *(_DWORD *)(a1 + 132) = 4096;
          *(_DWORD *)(a1 + 124) = 4096;
          *(_DWORD *)(a1 + 128) = 4096;
          *(_DWORD *)(a1 + 136) = 4096;
        }
      }
      else
      {
        *(_DWORD *)(a1 + 116) = 100;
        *(_WORD *)(a1 + 80) |= 4u;
        *(_DWORD *)(a1 + 104) = 0;
      }
      if ( *(_DWORD *)(a1 + 76) != 1 )
        goto LABEL_25;
      goto LABEL_10;
    case 0xA:
LABEL_10:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 16;
      goto LABEL_11;
    case 0xB:
LABEL_11:
      *(_DWORD *)(a1 + 120) -= 2;
      if ( *(_DWORD *)(a1 + 120) <= 0 )
      {
        *(_DWORD *)(a1 + 116) = 100;
        *(_WORD *)(a1 + 80) |= 4u;
      }
      goto LABEL_25;
    case 0x64:
      *(_DWORD *)(a1 + 20) += 64;
      if ( *(_DWORD *)(a1 + 20) > 1792 )
        *(_DWORD *)(a1 + 20) = 1792;
      if ( *(_DWORD *)(a1 + 12) > 0x10000 )
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 20) = -512;
        *(_DWORD *)(a1 + 116) = 110;
        *(_WORD *)(a1 + 80) |= 8u;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(10);
        for ( i = 0; i < 4; ++i )
        {
          v1 = Random(-1536, 0);
          v2 = Random(-341, 341);
          v3 = *(_DWORD *)(a1 + 12) + 0x2000;
          v4 = Random(-12, 12);
          NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
        }
      }
      goto LABEL_25;
    case 0x6E:
      *(_DWORD *)(a1 + 20) += 64;
      result = (Current_Map.Length << 13) + 0x4000;
      if ( *(_DWORD *)(a1 + 12) <= result )
        goto LABEL_25;
      *(_BYTE *)a1 = 0;
      break;
    default:
LABEL_25:
      if ( Quote.Y_Pos <= *(_DWORD *)(a1 + 12) )
        *(_DWORD *)(a1 + 164) = 0;
      else
        *(_DWORD *)(a1 + 164) = 10;
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      v6 = &v10 + 4 * *(_DWORD *)(a1 + 104);
      v7 = a1 + 84;
      *(_DWORD *)v7 = *v6;
      *(_DWORD *)(v7 + 4) = v6[1];
      result = v6[2];
      *(_DWORD *)(v7 + 8) = result;
      *(_DWORD *)(v7 + 12) = v6[3];
      if ( *(_DWORD *)(a1 + 116) == 11 )
      {
        *(_DWORD *)(a1 + 88) += *(_DWORD *)(a1 + 120);
        *(_DWORD *)(a1 + 96) -= *(_DWORD *)(a1 + 120);
        result = (16 - *(_DWORD *)(a1 + 120)) << 9;
        *(_DWORD *)(a1 + 144) = result;
      }
      break;
  }
  return result;
}

//----- (0045E110) --------------------------------------------------------
int __cdecl NPC280(int a1)
{
  int *v1; // eax@16
  int v2; // ecx@16
  int result; // eax@16
  int *v4; // eax@17
  int v5; // ecx@17
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 112;
  v16 = 32;
  v17 = 128;
  v18 = 48;
  v19 = 144;
  v20 = 32;
  v21 = 160;
  v22 = 48;
  v7 = 112;
  v8 = 48;
  v9 = 128;
  v10 = 64;
  v11 = 144;
  v12 = 48;
  v13 = 160;
  v14 = 64;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 == 2 )
      {
        *(_DWORD *)(a1 + 104) = 0;
        if ( *(_DWORD *)(a1 + 4) & 8 )
        {
          *(_DWORD *)(a1 + 116) = 4;
          *(_DWORD *)(a1 + 120) = 0;
          *(_DWORD *)(a1 + 104) = 1;
          Play_Sound_Effect(Sfx_Quote_Hit_Ground, 1);
        }
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
    *(_DWORD *)(a1 + 8) += 3072;
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
    Play_Sound_Effect(Sfx_Teleport, 1);
  }
  if ( ++*(_DWORD *)(a1 + 120) == 64 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 116) > 1 )
  {
    *(_DWORD *)(a1 + 20) += 32;
    if ( *(_DWORD *)(a1 + 20) > 1535 )
      *(_DWORD *)(a1 + 20) = 1535;
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  if ( *(_DWORD *)(a1 + 116) == 1 )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 88) + *(_DWORD *)(a1 + 120) / 4;
    if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
    {
      result = *(_DWORD *)(a1 + 32);
      *(_DWORD *)(a1 + 8) = result;
    }
    else
    {
      result = a1;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + 512;
    }
  }
  return result;
}

//----- (0045E360) --------------------------------------------------------
LONG *__cdecl NPC281(NPC_vars *a1)
{
  LONG *result; // eax@10

  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 1;
      break;
    case 0xA:
      a1->Current_State = 11;
      a1->Wait_Timer = 0;
      goto LABEL_4;
    case 0xB:
LABEL_4:
      ++a1->Wait_Timer;
      NPC_Create(Santas_Key|0x100, a1->X_pos, a1->Y_pos + 0x10000, 0, 0, Right, a1, 256);
      if ( a1->Wait_Timer > 150 )
        a1->Current_State = 12;
      break;
    case 0x14:
      a1->Current_State = 21;
      a1->Wait_Timer = 0;
      goto LABEL_8;
    case 0x15:
LABEL_8:
      if ( ++a1->Wait_Timer > 250 )
      {
        Kill_NPC(270, 0);
        a1->Current_State = 22;
      }
      break;
    default:
      break;
  }
  result = &a1->Rect.left;
  *result = 0;
  result[1] = 0;
  result[2] = 0;
  result[3] = 0;
  return result;
}

//----- (0045E4C0) --------------------------------------------------------
int __cdecl NPC282(int a1)
{
  int *v1; // ecx@48
  int v2; // edx@48
  int result; // eax@48
  int v4; // [sp+0h] [bp-34h]@1
  int v5; // [sp+4h] [bp-30h]@1
  int v6; // [sp+8h] [bp-2Ch]@1
  int v7; // [sp+Ch] [bp-28h]@1
  int v8; // [sp+10h] [bp-24h]@1
  int v9; // [sp+14h] [bp-20h]@1
  int v10; // [sp+18h] [bp-1Ch]@1
  int v11; // [sp+1Ch] [bp-18h]@1
  int v12; // [sp+20h] [bp-14h]@1
  int v13; // [sp+24h] [bp-10h]@1
  int v14; // [sp+28h] [bp-Ch]@1
  int v15; // [sp+2Ch] [bp-8h]@1
  int v16; // [sp+30h] [bp-4h]@1

  v5 = 256;
  v6 = 80;
  v7 = 320;
  v8 = 120;
  v9 = 256;
  v10 = 0;
  v11 = 320;
  v12 = 40;
  v13 = 256;
  v14 = 120;
  v15 = 320;
  v16 = 160;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 20 )
      goto LABEL_48;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 20;
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
    if ( Random(0, 100) % 2 )
      *(_DWORD *)(a1 + 20) = -256;
    else
      *(_DWORD *)(a1 + 20) = 256;
  }
  *(_DWORD *)(a1 + 16) = -512;
  if ( *(_DWORD *)(a1 + 8) < -32768 )
    *(_BYTE *)a1 = 0;
  if ( *(_DWORD *)(a1 + 36) < *(_DWORD *)(a1 + 12) )
    *(_DWORD *)(a1 + 20) -= 16;
  if ( *(_DWORD *)(a1 + 36) > *(_DWORD *)(a1 + 12) )
    *(_DWORD *)(a1 + 20) += 16;
  if ( *(_DWORD *)(a1 + 20) > 256 )
    *(_DWORD *)(a1 + 20) = 256;
  if ( *(_DWORD *)(a1 + 20) < -256 )
    *(_DWORD *)(a1 + 20) = -256;
  if ( Quote.Collision_Flags & 8
    && Quote.Y_Pos < *(_DWORD *)(a1 + 12) - 2048
    && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 12288
    && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 12288 )
  {
    *(_DWORD *)(a1 + 36) = 73728;
    *(_DWORD *)(a1 + 104) = 2;
  }
  else if ( *(_DWORD *)(a1 + 104) != 1 )
  {
    *(_DWORD *)(a1 + 104) = 0;
  }
  if ( Quote.Collision_Flags & 1
    && Quote.X_Pos < *(_DWORD *)(a1 + 8) - *(_DWORD *)(a1 + 132)
    && Quote.X_Pos > *(_DWORD *)(a1 + 8) - *(_DWORD *)(a1 + 132) - 4096
    && Quote.Hitbox.bottom + Quote.Y_Pos > *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 128)
    && Quote.Y_Pos - Quote.Hitbox.top < *(_DWORD *)(a1 + 136) + *(_DWORD *)(a1 + 12) )
  {
    *(_WORD *)(a1 + 80) &= 0xFFBFu;
    *(_DWORD *)(a1 + 104) = 1;
  }
  else if ( Quote.Collision_Flags & 4
         && Quote.X_Pos > *(_DWORD *)(a1 + 132) + *(_DWORD *)(a1 + 8)
         && Quote.X_Pos < *(_DWORD *)(a1 + 8) + *(_DWORD *)(a1 + 132) + 4096
         && Quote.Hitbox.bottom + Quote.Y_Pos > *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 128)
         && Quote.Y_Pos - Quote.Hitbox.top < *(_DWORD *)(a1 + 136) + *(_DWORD *)(a1 + 12) )
  {
    *(_WORD *)(a1 + 80) &= 0xFFBFu;
    *(_DWORD *)(a1 + 104) = 1;
  }
  else if ( Quote.Collision_Flags & 2
         && Quote.Y_Pos < *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 128)
         && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 128) - 4096
         && Quote.Hitbox.front + Quote.X_Pos > *(_DWORD *)(a1 + 8) - *(_DWORD *)(a1 + 132)
         && Quote.X_Pos - Quote.Hitbox.back < *(_DWORD *)(a1 + 124) + *(_DWORD *)(a1 + 8) )
  {
    *(_WORD *)(a1 + 80) &= 0xFFBFu;
    *(_DWORD *)(a1 + 104) = 1;
  }
  else if ( Quote.Collision_Flags & 8
         && Quote.Y_Pos > *(_DWORD *)(a1 + 12) + *(_DWORD *)(a1 + 136) - 2048
         && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + *(_DWORD *)(a1 + 136) + 6144
         && Quote.Hitbox.front + Quote.X_Pos > *(_DWORD *)(a1 + 8) - *(_DWORD *)(a1 + 132) - 2048
         && Quote.X_Pos - Quote.Hitbox.back < *(_DWORD *)(a1 + 8) + *(_DWORD *)(a1 + 124) + 2048 )
  {
    *(_WORD *)(a1 + 80) &= 0xFFBFu;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_48:
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (0045E950) --------------------------------------------------------
int __cdecl NPC283(int a1)
{
  int *v1; // ecx@138
  int v2; // edx@138
  int result; // eax@138
  int *v4; // ecx@139
  int v5; // edx@139
  int Direction; // [sp+14h] [bp-16Ch]@0
  int v7; // [sp+18h] [bp-168h]@1
  int v8; // [sp+1Ch] [bp-164h]@1
  int v9; // [sp+20h] [bp-160h]@1
  int v10; // [sp+24h] [bp-15Ch]@1
  int v11; // [sp+28h] [bp-158h]@1
  int v12; // [sp+2Ch] [bp-154h]@1
  int v13; // [sp+30h] [bp-150h]@1
  int v14; // [sp+34h] [bp-14Ch]@1
  int v15; // [sp+38h] [bp-148h]@1
  int v16; // [sp+3Ch] [bp-144h]@1
  int v17; // [sp+40h] [bp-140h]@1
  int v18; // [sp+44h] [bp-13Ch]@1
  int v19; // [sp+48h] [bp-138h]@1
  int v20; // [sp+4Ch] [bp-134h]@1
  int v21; // [sp+50h] [bp-130h]@1
  int v22; // [sp+54h] [bp-12Ch]@1
  int v23; // [sp+58h] [bp-128h]@1
  int v24; // [sp+5Ch] [bp-124h]@1
  int v25; // [sp+60h] [bp-120h]@1
  int v26; // [sp+64h] [bp-11Ch]@1
  int v27; // [sp+68h] [bp-118h]@1
  int v28; // [sp+6Ch] [bp-114h]@1
  int v29; // [sp+70h] [bp-110h]@1
  int v30; // [sp+74h] [bp-10Ch]@1
  int v31; // [sp+78h] [bp-108h]@1
  int v32; // [sp+7Ch] [bp-104h]@1
  int v33; // [sp+80h] [bp-100h]@1
  int v34; // [sp+84h] [bp-FCh]@1
  int v35; // [sp+88h] [bp-F8h]@1
  int v36; // [sp+8Ch] [bp-F4h]@1
  int v37; // [sp+90h] [bp-F0h]@1
  int v38; // [sp+94h] [bp-ECh]@1
  int v39; // [sp+98h] [bp-E8h]@1
  int v40; // [sp+9Ch] [bp-E4h]@1
  int v41; // [sp+A0h] [bp-E0h]@1
  int v42; // [sp+A4h] [bp-DCh]@1
  int v43; // [sp+A8h] [bp-D8h]@1
  int v44; // [sp+ACh] [bp-D4h]@1
  int v45; // [sp+B0h] [bp-D0h]@1
  int v46; // [sp+B4h] [bp-CCh]@1
  int v47; // [sp+B8h] [bp-C8h]@1
  int v48; // [sp+BCh] [bp-C4h]@1
  int v49; // [sp+C0h] [bp-C0h]@1
  int v50; // [sp+C4h] [bp-BCh]@1
  int X_Pos; // [sp+C8h] [bp-B8h]@66
  int Y_Pos; // [sp+CCh] [bp-B4h]@66
  int v53; // [sp+D0h] [bp-B0h]@1
  int v54; // [sp+D4h] [bp-ACh]@1
  int v55; // [sp+D8h] [bp-A8h]@1
  int v56; // [sp+DCh] [bp-A4h]@1
  int v57; // [sp+E0h] [bp-A0h]@1
  int v58; // [sp+E4h] [bp-9Ch]@1
  int v59; // [sp+E8h] [bp-98h]@1
  int v60; // [sp+ECh] [bp-94h]@1
  int v61; // [sp+F0h] [bp-90h]@1
  int v62; // [sp+F4h] [bp-8Ch]@1
  int v63; // [sp+F8h] [bp-88h]@1
  int v64; // [sp+FCh] [bp-84h]@1
  int v65; // [sp+100h] [bp-80h]@1
  int v66; // [sp+104h] [bp-7Ch]@1
  int v67; // [sp+108h] [bp-78h]@1
  int v68; // [sp+10Ch] [bp-74h]@1
  int v69; // [sp+110h] [bp-70h]@1
  int v70; // [sp+114h] [bp-6Ch]@1
  int v71; // [sp+118h] [bp-68h]@1
  int v72; // [sp+11Ch] [bp-64h]@1
  int v73; // [sp+120h] [bp-60h]@1
  int v74; // [sp+124h] [bp-5Ch]@1
  int v75; // [sp+128h] [bp-58h]@1
  int v76; // [sp+12Ch] [bp-54h]@1
  int v77; // [sp+130h] [bp-50h]@1
  int v78; // [sp+134h] [bp-4Ch]@1
  int v79; // [sp+138h] [bp-48h]@1
  int v80; // [sp+13Ch] [bp-44h]@1
  int v81; // [sp+140h] [bp-40h]@1
  int v82; // [sp+144h] [bp-3Ch]@1
  int v83; // [sp+148h] [bp-38h]@1
  int v84; // [sp+14Ch] [bp-34h]@1
  int v85; // [sp+150h] [bp-30h]@1
  int v86; // [sp+154h] [bp-2Ch]@1
  int v87; // [sp+158h] [bp-28h]@1
  int v88; // [sp+15Ch] [bp-24h]@1
  int v89; // [sp+160h] [bp-20h]@1
  int v90; // [sp+164h] [bp-1Ch]@1
  int v91; // [sp+168h] [bp-18h]@1
  int v92; // [sp+16Ch] [bp-14h]@1
  int v93; // [sp+170h] [bp-10h]@1
  int v94; // [sp+174h] [bp-Ch]@1
  int v95; // [sp+178h] [bp-8h]@1
  int v96; // [sp+17Ch] [bp-4h]@1

  v53 = 0;
  v54 = 64;
  v55 = 32;
  v56 = 96;
  v57 = 32;
  v58 = 64;
  v59 = 64;
  v60 = 96;
  v61 = 64;
  v62 = 64;
  v63 = 96;
  v64 = 96;
  v65 = 96;
  v66 = 64;
  v67 = 128;
  v68 = 96;
  v69 = 128;
  v70 = 64;
  v71 = 160;
  v72 = 96;
  v73 = 160;
  v74 = 64;
  v75 = 192;
  v76 = 96;
  v77 = 192;
  v78 = 64;
  v79 = 224;
  v80 = 96;
  v81 = 224;
  v82 = 64;
  v83 = 256;
  v84 = 96;
  v85 = 0;
  v86 = 0;
  v87 = 0;
  v88 = 0;
  v89 = 256;
  v90 = 64;
  v91 = 288;
  v92 = 96;
  v93 = 288;
  v94 = 64;
  v95 = 320;
  v96 = 96;
  v7 = 0;
  v8 = 96;
  v9 = 32;
  v10 = 128;
  v11 = 32;
  v12 = 96;
  v13 = 64;
  v14 = 128;
  v15 = 64;
  v16 = 96;
  v17 = 96;
  v18 = 128;
  v19 = 96;
  v20 = 96;
  v21 = 128;
  v22 = 128;
  v23 = 128;
  v24 = 96;
  v25 = 160;
  v26 = 128;
  v27 = 160;
  v28 = 96;
  v29 = 192;
  v30 = 128;
  v31 = 192;
  v32 = 96;
  v33 = 224;
  v34 = 128;
  v35 = 224;
  v36 = 96;
  v37 = 256;
  v38 = 128;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
  v43 = 256;
  v44 = 96;
  v45 = 288;
  v46 = 128;
  v47 = 288;
  v48 = 96;
  v49 = 320;
  v50 = 128;
  if ( *(_DWORD *)(a1 + 116) < 100 && (!Boss_Objects[0].Is_Alive || *(_DWORD *)(a1 + 64) < 400) )
    *(_DWORD *)(a1 + 116) = 100;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 4096;
      Play_Sound_Effect(Sfx_Teleport, 1);
      goto LABEL_7;
    case 1:
LABEL_7:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 9;
      else
        *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 9;
      break;
    case 0x14:
      Super_Y_Pos = 0;
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_13;
    case 0x15:
LABEL_13:
      *(_DWORD *)(a1 + 16) = 7 * *(_DWORD *)(a1 + 16) / 8;
      *(_DWORD *)(a1 + 20) = 7 * *(_DWORD *)(a1 + 20) / 8;
      if ( ++*(_DWORD *)(a1 + 100) > 20 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 100 )
        *(_DWORD *)(a1 + 116) = 30;
      if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 112) = *(_DWORD *)(a1 + 64);
      goto LABEL_24;
    case 0x1F:
LABEL_24:
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 20) = -512;
      if ( *(_DWORD *)(a1 + 8) <= Boss_Objects[0].X_pos )
        *(_DWORD *)(a1 + 16) += 32;
      else
        *(_DWORD *)(a1 + 16) -= 32;
      if ( *(_DWORD *)(a1 + 12) <= Quote.Y_Pos )
        *(_DWORD *)(a1 + 20) += 16;
      else
        *(_DWORD *)(a1 + 20) -= 16;
      if ( *(_DWORD *)(a1 + 16) > 512 )
        *(_DWORD *)(a1 + 16) = 512;
      if ( *(_DWORD *)(a1 + 16) < -512 )
        *(_DWORD *)(a1 + 16) = -512;
      if ( *(_DWORD *)(a1 + 20) > 512 )
        *(_DWORD *)(a1 + 20) = 512;
      if ( *(_DWORD *)(a1 + 20) < -512 )
        *(_DWORD *)(a1 + 20) = -512;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 150 && (*(_DWORD *)(a1 + 64) < *(_DWORD *)(a1 + 112) - 20 || Super_Y_Pos) )
      {
        Super_Y_Pos = 0;
        *(_DWORD *)(a1 + 116) = 40;
      }
      if ( Boss_Objects[0].Ani_Num && *(_DWORD *)(a1 + 120) > 250 )
        *(_DWORD *)(a1 + 116) = 50;
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      Play_Sound_Effect(Sfx_Ballos_Ball_etc_Charge_Curly_charging_her_gun, 1);
      if ( Quote.Y_Pos >= 81920 )
        *(_DWORD *)(a1 + 112) = 289;
      else
        *(_DWORD *)(a1 + 112) = 290;
      goto LABEL_61;
    case 0x29:
LABEL_61:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 4;
      else
        *(_DWORD *)(a1 + 104) = 5;
      if ( *(_DWORD *)(a1 + 120) % 6 == 1 )
      {
        if ( *(_DWORD *)(a1 + 112) == 289 )
        {
          X_Pos = *(_DWORD *)(a1 + 8) + (Random(-64, 64) << 9);
          Y_Pos = *(_DWORD *)(a1 + 12) + (Random(-32, 32) << 9);
        }
        else
        {
          X_Pos = *(_DWORD *)(a1 + 8) + (Random(-32, 32) << 9);
          Y_Pos = *(_DWORD *)(a1 + 12) + (Random(-64, 64) << 9);
        }
        if ( X_Pos < 0x4000 )
          X_Pos = 0x4000;
        if ( X_Pos > (Current_Map.Width - 2) << 13 )
          X_Pos = (Current_Map.Width - 2) << 13;
        if ( Y_Pos < 0x4000 )
          Y_Pos = 0x4000;
        if ( Y_Pos > (Current_Map.Length - 2) << 13 )
          Y_Pos = (Current_Map.Length - 2) << 13;
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        NPC_Create(*(NPC_Names *)(a1 + 112), X_Pos, Y_Pos, 0, 0, 0, NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 116) = 42;
        *(_DWORD *)(a1 + 120) = 0;
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    case 0x2A:
      ++*(_DWORD *)(a1 + 120);
      *(_DWORD *)(a1 + 104) = 6;
      if ( *(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 20) = -512;
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = -512;
        else
          *(_DWORD *)(a1 + 16) = 512;
        *(_DWORD *)(a1 + 116) = 30;
      }
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      Play_Sound_Effect(Sfx_Ballos_Ball_etc_Charge_Curly_charging_her_gun, 1);
      goto LABEL_92;
    case 0x33:
LABEL_92:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 4;
      else
        *(_DWORD *)(a1 + 104) = 5;
      if ( Quote.Equipped_Items & 0x20 )
      {
        if ( *(_DWORD *)(a1 + 120) % 10 == 1 )
        {
          if ( *(_DWORD *)(a1 + 76) )
          {
            X_Pos = *(_DWORD *)(a1 + 8) - 5120;
            Y_Pos = *(_DWORD *)(a1 + 12);
            switch ( *(_DWORD *)(a1 + 120) / 6 % 4 )
            {
              case 0:
                Direction = 88;
                break;
              case 1:
                Direction = 108;
                break;
              case 2:
                Direction = 148;
                break;
              case 3:
                Direction = 168;
                break;
              default:
                break;
            }
          }
          else
          {
            X_Pos = *(_DWORD *)(a1 + 8) + 5120;
            Y_Pos = *(_DWORD *)(a1 + 12);
            switch ( *(_DWORD *)(a1 + 120) / 6 % 4 )
            {
              case 0:
                Direction = 216;
                break;
              case 1:
                Direction = 236;
                break;
              case 2:
                Direction = 20;
                break;
              case 3:
                Direction = 40;
                break;
              default:
                break;
            }
          }
          Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
          NPC_Create(Forcefield|0x120, X_Pos, Y_Pos, 0, 0, (Directions)Direction, NULL, 256);
        }
      }
      else if ( *(_DWORD *)(a1 + 120) % 24 == 1 )
      {
        if ( *(_DWORD *)(a1 + 76) )
        {
          X_Pos = *(_DWORD *)(a1 + 8) - 5120;
          Y_Pos = *(_DWORD *)(a1 + 12);
          switch ( *(_DWORD *)(a1 + 120) / 6 % 4 )
          {
            case 0:
              Direction = 88;
              break;
            case 1:
              Direction = 108;
              break;
            case 2:
              Direction = 148;
              break;
            case 3:
              Direction = 168;
              break;
            default:
              break;
          }
        }
        else
        {
          X_Pos = *(_DWORD *)(a1 + 8) + 5120;
          Y_Pos = *(_DWORD *)(a1 + 12);
          switch ( *(_DWORD *)(a1 + 120) / 6 % 4 )
          {
            case 0:
              Direction = 216;
              break;
            case 1:
              Direction = 236;
              break;
            case 2:
              Direction = 20;
              break;
            case 3:
              Direction = 40;
              break;
            default:
              break;
          }
        }
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        NPC_Create(Forcefield|0x120, X_Pos, Y_Pos, 0, 0, (Directions)Direction, NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 116) = 42;
        *(_DWORD *)(a1 + 120) = 0;
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
      }
      break;
    case 0x63:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_DWORD *)(a1 + 104) = 9;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      break;
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 104) = 9;
      *(_DWORD *)(a1 + 164) = 0;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 8u;
      *(_DWORD *)(a1 + 20) = -512;
      *(_BYTE *)(a1 + 156) += 50;
      *(_DWORD *)(a1 + 136) = 6144;
      ++Boss_Objects[0].Ani_Num;
      goto LABEL_132;
    case 0x65:
LABEL_132:
      *(_DWORD *)(a1 + 20) += 32;
      if ( *(_DWORD *)(a1 + 12) > 110592 - *(_DWORD *)(a1 + 136) )
      {
        *(_DWORD *)(a1 + 12) = 110592 - *(_DWORD *)(a1 + 136);
        *(_DWORD *)(a1 + 116) = 102;
        *(_DWORD *)(a1 + 104) = 10;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 20) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_BYTE *)(a1 + 156) )
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16) / 2;
  else
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v53 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (0045F910) --------------------------------------------------------
int __cdecl NPC284(int a1)
{
  int *v1; // ecx@119
  int v2; // edx@119
  int result; // eax@119
  int *v4; // ecx@120
  int v5; // edx@120
  int v6; // [sp+8h] [bp-1A8h]@1
  int v7; // [sp+Ch] [bp-1A4h]@1
  int v8; // [sp+10h] [bp-1A0h]@1
  int v9; // [sp+14h] [bp-19Ch]@1
  int v10; // [sp+18h] [bp-198h]@1
  int v11; // [sp+1Ch] [bp-194h]@1
  int v12; // [sp+20h] [bp-190h]@1
  int v13; // [sp+24h] [bp-18Ch]@1
  int v14; // [sp+28h] [bp-188h]@1
  int v15; // [sp+2Ch] [bp-184h]@1
  int v16; // [sp+30h] [bp-180h]@1
  int v17; // [sp+34h] [bp-17Ch]@1
  int v18; // [sp+38h] [bp-178h]@1
  int v19; // [sp+3Ch] [bp-174h]@1
  int v20; // [sp+40h] [bp-170h]@1
  int v21; // [sp+44h] [bp-16Ch]@1
  int v22; // [sp+48h] [bp-168h]@1
  int v23; // [sp+4Ch] [bp-164h]@1
  int v24; // [sp+50h] [bp-160h]@1
  int v25; // [sp+54h] [bp-15Ch]@1
  int v26; // [sp+58h] [bp-158h]@1
  int v27; // [sp+5Ch] [bp-154h]@1
  int v28; // [sp+60h] [bp-150h]@1
  int v29; // [sp+64h] [bp-14Ch]@1
  int v30; // [sp+68h] [bp-148h]@1
  int v31; // [sp+6Ch] [bp-144h]@1
  int v32; // [sp+70h] [bp-140h]@1
  int v33; // [sp+74h] [bp-13Ch]@1
  int v34; // [sp+78h] [bp-138h]@1
  int v35; // [sp+7Ch] [bp-134h]@1
  int v36; // [sp+80h] [bp-130h]@1
  int v37; // [sp+84h] [bp-12Ch]@1
  int v38; // [sp+88h] [bp-128h]@1
  int v39; // [sp+8Ch] [bp-124h]@1
  int v40; // [sp+90h] [bp-120h]@1
  int v41; // [sp+94h] [bp-11Ch]@1
  int v42; // [sp+98h] [bp-118h]@1
  int v43; // [sp+9Ch] [bp-114h]@1
  int v44; // [sp+A0h] [bp-110h]@1
  int v45; // [sp+A4h] [bp-10Ch]@1
  int v46; // [sp+A8h] [bp-108h]@1
  int v47; // [sp+ACh] [bp-104h]@1
  int v48; // [sp+B0h] [bp-100h]@1
  int v49; // [sp+B4h] [bp-FCh]@1
  int v50; // [sp+B8h] [bp-F8h]@1
  int v51; // [sp+BCh] [bp-F4h]@1
  int v52; // [sp+C0h] [bp-F0h]@1
  int v53; // [sp+C4h] [bp-ECh]@1
  int v54; // [sp+C8h] [bp-E8h]@1
  int v55; // [sp+CCh] [bp-E4h]@1
  int v56; // [sp+D0h] [bp-E0h]@1
  int v57; // [sp+D4h] [bp-DCh]@1
  int v58; // [sp+D8h] [bp-D8h]@1
  int v59; // [sp+DCh] [bp-D4h]@1
  int v60; // [sp+E0h] [bp-D0h]@1
  int v61; // [sp+E4h] [bp-CCh]@1
  int v62; // [sp+E8h] [bp-C8h]@1
  int v63; // [sp+ECh] [bp-C4h]@1
  int v64; // [sp+F0h] [bp-C0h]@1
  int v65; // [sp+F4h] [bp-BCh]@1
  int v66; // [sp+F8h] [bp-B8h]@1
  int v67; // [sp+FCh] [bp-B4h]@1
  int v68; // [sp+100h] [bp-B0h]@1
  int v69; // [sp+104h] [bp-ACh]@1
  int v70; // [sp+108h] [bp-A8h]@1
  int v71; // [sp+10Ch] [bp-A4h]@1
  int v72; // [sp+110h] [bp-A0h]@1
  int v73; // [sp+114h] [bp-9Ch]@1
  int v74; // [sp+118h] [bp-98h]@1
  int v75; // [sp+11Ch] [bp-94h]@1
  int v76; // [sp+120h] [bp-90h]@1
  int v77; // [sp+124h] [bp-8Ch]@1
  int v78; // [sp+128h] [bp-88h]@1
  int v79; // [sp+12Ch] [bp-84h]@1
  int v80; // [sp+130h] [bp-80h]@1
  int v81; // [sp+134h] [bp-7Ch]@1
  int v82; // [sp+138h] [bp-78h]@1
  int v83; // [sp+13Ch] [bp-74h]@1
  int v84; // [sp+140h] [bp-70h]@1
  int v85; // [sp+144h] [bp-6Ch]@1
  int v86; // [sp+148h] [bp-68h]@1
  int v87; // [sp+14Ch] [bp-64h]@1
  int v88; // [sp+150h] [bp-60h]@1
  int v89; // [sp+154h] [bp-5Ch]@1
  int v90; // [sp+158h] [bp-58h]@1
  int v91; // [sp+15Ch] [bp-54h]@1
  int v92; // [sp+160h] [bp-50h]@1
  int v93; // [sp+164h] [bp-4Ch]@1
  int v94; // [sp+168h] [bp-48h]@1
  int v95; // [sp+16Ch] [bp-44h]@1
  int v96; // [sp+170h] [bp-40h]@1
  int v97; // [sp+174h] [bp-3Ch]@1
  int v98; // [sp+178h] [bp-38h]@1
  int v99; // [sp+17Ch] [bp-34h]@1
  int v100; // [sp+180h] [bp-30h]@1
  int v101; // [sp+184h] [bp-2Ch]@1
  int v102; // [sp+188h] [bp-28h]@1
  int v103; // [sp+18Ch] [bp-24h]@1
  int v104; // [sp+190h] [bp-20h]@1
  int v105; // [sp+194h] [bp-1Ch]@1
  int v106; // [sp+198h] [bp-18h]@1
  int v107; // [sp+19Ch] [bp-14h]@1
  int v108; // [sp+1A0h] [bp-10h]@1
  int v109; // [sp+1A4h] [bp-Ch]@1
  unsigned __int8 v110; // [sp+1AFh] [bp-1h]@37

  v58 = 0;
  v59 = 128;
  v60 = 32;
  v61 = 160;
  v62 = 32;
  v63 = 128;
  v64 = 64;
  v65 = 160;
  v66 = 64;
  v67 = 128;
  v68 = 96;
  v69 = 160;
  v70 = 96;
  v71 = 128;
  v72 = 128;
  v73 = 160;
  v74 = 128;
  v75 = 128;
  v76 = 160;
  v77 = 160;
  v78 = 160;
  v79 = 128;
  v80 = 192;
  v81 = 160;
  v82 = 192;
  v83 = 128;
  v84 = 224;
  v85 = 160;
  v86 = 224;
  v87 = 128;
  v88 = 256;
  v89 = 160;
  v90 = 0;
  v91 = 0;
  v92 = 0;
  v93 = 0;
  v94 = 256;
  v95 = 128;
  v96 = 288;
  v97 = 160;
  v98 = 288;
  v99 = 128;
  v100 = 320;
  v101 = 160;
  v102 = 224;
  v103 = 64;
  v104 = 256;
  v105 = 96;
  v106 = 208;
  v107 = 32;
  v108 = 224;
  v109 = 48;
  v6 = 0;
  v7 = 160;
  v8 = 32;
  v9 = 192;
  v10 = 32;
  v11 = 160;
  v12 = 64;
  v13 = 192;
  v14 = 64;
  v15 = 160;
  v16 = 96;
  v17 = 192;
  v18 = 96;
  v19 = 160;
  v20 = 128;
  v21 = 192;
  v22 = 128;
  v23 = 160;
  v24 = 160;
  v25 = 192;
  v26 = 160;
  v27 = 160;
  v28 = 192;
  v29 = 192;
  v30 = 192;
  v31 = 160;
  v32 = 224;
  v33 = 192;
  v34 = 224;
  v35 = 160;
  v36 = 256;
  v37 = 192;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 256;
  v43 = 160;
  v44 = 288;
  v45 = 192;
  v46 = 288;
  v47 = 160;
  v48 = 320;
  v49 = 192;
  v50 = 224;
  v51 = 96;
  v52 = 256;
  v53 = 128;
  v54 = 208;
  v55 = 48;
  v56 = 224;
  v57 = 64;
  if ( *(_DWORD *)(a1 + 116) < 100 && (!Boss_Objects[0].Is_Alive || *(_DWORD *)(a1 + 64) < 500) )
    *(_DWORD *)(a1 + 116) = 100;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 2048;
      Play_Sound_Effect(Sfx_Teleport, 1);
      *(_DWORD *)(a1 + 112) = *(_DWORD *)(a1 + 64);
      goto LABEL_7;
    case 1:
LABEL_7:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
      {
        *(_DWORD *)(a1 + 144) = 0x2000;
        *(_DWORD *)(a1 + 148) = 0x2000;
        *(_DWORD *)(a1 + 140) = 0x2000;
        *(_DWORD *)(a1 + 104) = 11;
      }
      else
      {
        *(_DWORD *)(a1 + 144) = 1536;
        *(_DWORD *)(a1 + 148) = 4096;
        *(_DWORD *)(a1 + 140) = 4096;
        *(_DWORD *)(a1 + 104) = 12;
      }
      if ( *(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 11;
      *(_DWORD *)(a1 + 144) = 0x2000;
      *(_DWORD *)(a1 + 148) = 0x2000;
      *(_DWORD *)(a1 + 140) = 0x2000;
      Kill_NPC(257, 1);
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 164) = 0;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      goto LABEL_15;
    case 0x15:
LABEL_15:
      *(_DWORD *)(a1 + 16) = 7 * *(_DWORD *)(a1 + 16) / 8;
      *(_DWORD *)(a1 + 20) = 7 * *(_DWORD *)(a1 + 20) / 8;
      if ( ++*(_DWORD *)(a1 + 100) > 20 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 80 )
        *(_DWORD *)(a1 + 116) = 30;
      if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      if ( *(_DWORD *)(a1 + 64) < *(_DWORD *)(a1 + 112) - 50 )
      {
        *(_DWORD *)(a1 + 112) = *(_DWORD *)(a1 + 64);
        Super_Y_Pos = 10;
      }
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      goto LABEL_28;
    case 0x1F:
LABEL_28:
      if ( ++*(_DWORD *)(a1 + 120) > 16 )
      {
        ++*(_DWORD *)(a1 + 108);
        *(_DWORD *)(a1 + 108) %= 4;
        switch ( *(_DWORD *)(a1 + 108) )
        {
          case 1:
          case 3:
            *(_DWORD *)(a1 + 116) = 34;
            break;
          case 0:
            *(_DWORD *)(a1 + 116) = 32;
            break;
          case 2:
            *(_DWORD *)(a1 + 116) = 32;
            break;
          default:
            goto LABEL_115;
        }
      }
      break;
    case 0x20:
      *(_DWORD *)(a1 + 116) = 33;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
        *(_DWORD *)(a1 + 32) = Quote.X_Pos + 81920;
      else
        *(_DWORD *)(a1 + 32) = Quote.X_Pos - 81920;
      *(_DWORD *)(a1 + 36) = Quote.Y_Pos;
      v110 = GetArcTan(*(_DWORD *)(a1 + 8) - *(_DWORD *)(a1 + 32), *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 36));
      *(_DWORD *)(a1 + 16) = 3 * GetCos(v110);
      *(_DWORD *)(a1 + 20) = 3 * GetSin(v110);
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      if ( *(_DWORD *)(a1 + 8) < (Current_Map.Width << 13) / 2 && *(_DWORD *)(a1 + 16) > 0 )
      {
        if ( *(_DWORD *)(a1 + 12) < (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) > 0 )
          *(_WORD *)(a1 + 80) |= 8u;
        if ( *(_DWORD *)(a1 + 12) > (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) < 0 )
          *(_WORD *)(a1 + 80) |= 8u;
      }
      if ( *(_DWORD *)(a1 + 8) > (Current_Map.Width << 13) / 2 && *(_DWORD *)(a1 + 16) < 0 )
      {
        if ( *(_DWORD *)(a1 + 12) < (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) > 0 )
          *(_WORD *)(a1 + 80) |= 8u;
        if ( *(_DWORD *)(a1 + 12) > (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) < 0 )
          *(_WORD *)(a1 + 80) |= 8u;
      }
      if ( *(_DWORD *)(a1 + 16) <= 0 )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      goto LABEL_56;
    case 0x21:
LABEL_56:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 3;
      else
        *(_DWORD *)(a1 + 104) = 8;
      if ( *(_DWORD *)(a1 + 120) > 50 || *(_DWORD *)(a1 + 4) & 5 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    case 0x22:
      *(_DWORD *)(a1 + 116) = 35;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 164) = 4;
      *(_DWORD *)(a1 + 32) = Quote.X_Pos;
      *(_DWORD *)(a1 + 36) = Quote.Y_Pos;
      v110 = GetArcTan(*(_DWORD *)(a1 + 8) - *(_DWORD *)(a1 + 32), *(_DWORD *)(a1 + 12) - *(_DWORD *)(a1 + 36));
      *(_DWORD *)(a1 + 20) = 3 * GetSin(v110);
      *(_DWORD *)(a1 + 16) = 3 * GetCos(v110);
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      if ( *(_DWORD *)(a1 + 8) < (Current_Map.Width << 13) / 2 && *(_DWORD *)(a1 + 16) > 0 )
      {
        if ( *(_DWORD *)(a1 + 12) < (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) > 0 )
          *(_WORD *)(a1 + 80) |= 8u;
        if ( *(_DWORD *)(a1 + 12) > (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) < 0 )
          *(_WORD *)(a1 + 80) |= 8u;
      }
      if ( *(_DWORD *)(a1 + 8) > (Current_Map.Width << 13) / 2 && *(_DWORD *)(a1 + 16) < 0 )
      {
        if ( *(_DWORD *)(a1 + 12) < (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) > 0 )
          *(_WORD *)(a1 + 80) |= 8u;
        if ( *(_DWORD *)(a1 + 12) > (Current_Map.Length << 13) / 2 && *(_DWORD *)(a1 + 20) < 0 )
          *(_WORD *)(a1 + 80) |= 8u;
      }
      if ( *(_DWORD *)(a1 + 16) <= 0 )
        *(_DWORD *)(a1 + 76) = 0;
      else
        *(_DWORD *)(a1 + 76) = 2;
      goto LABEL_82;
    case 0x23:
LABEL_82:
      if ( ++*(_DWORD *)(a1 + 120) > 20 && *(_BYTE *)(a1 + 156) )
      {
        *(_DWORD *)(a1 + 116) = 40;
      }
      else if ( *(_DWORD *)(a1 + 120) > 50 || *(_DWORD *)(a1 + 4) & 5 )
      {
        *(_DWORD *)(a1 + 116) = 20;
      }
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 7 )
        *(_DWORD *)(a1 + 104) = 4;
      if ( *(_DWORD *)(a1 + 120) % 5 == 1 )
        Play_Sound_Effect(Sfx_Critter_Fly, 1);
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 164) = 0;
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      goto LABEL_96;
    case 0x29:
LABEL_96:
      *(_DWORD *)(a1 + 16) = 7 * *(_DWORD *)(a1 + 16) / 8;
      *(_DWORD *)(a1 + 20) = 7 * *(_DWORD *)(a1 + 20) / 8;
      if ( ++*(_DWORD *)(a1 + 120) > 6 )
      {
        *(_DWORD *)(a1 + 116) = 42;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 20) = -512;
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 16) = -512;
        else
          *(_DWORD *)(a1 + 16) = 512;
      }
      break;
    case 0x2A:
      *(_DWORD *)(a1 + 104) = 9;
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 43;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
        if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 0;
        else
          *(_DWORD *)(a1 + 76) = 2;
      }
      *(_DWORD *)(a1 + 20) += 32;
      if ( *(_DWORD *)(a1 + 20) > 1535 )
        *(_DWORD *)(a1 + 20) = 1535;
      break;
    case 0x2B:
      if ( ++*(_DWORD *)(a1 + 120) > 16 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    case 0x63:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_DWORD *)(a1 + 104) = 9;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      break;
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 104) = 9;
      *(_DWORD *)(a1 + 164) = 0;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 8u;
      *(_DWORD *)(a1 + 20) = -512;
      *(_BYTE *)(a1 + 156) += 50;
      ++Boss_Objects[0].Ani_Num;
      goto LABEL_113;
    case 0x65:
LABEL_113:
      *(_DWORD *)(a1 + 20) += 32;
      if ( *(_DWORD *)(a1 + 12) > 110592 - *(_DWORD *)(a1 + 136) )
      {
        *(_DWORD *)(a1 + 12) = 110592 - *(_DWORD *)(a1 + 136);
        *(_DWORD *)(a1 + 116) = 102;
        *(_DWORD *)(a1 + 104) = 10;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 20) = 0;
      }
      break;
    default:
      break;
  }
LABEL_115:
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_BYTE *)(a1 + 156) )
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16) / 2;
  else
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v58 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (00460910) --------------------------------------------------------
void __cdecl NPC285(void *npc)
{
  char *v1; // ecx@14
  int v2; // [sp+0h] [bp-18h]@4
  unsigned __int8 v3; // [sp+17h] [bp-1h]@8

  if ( *((_DWORD *)npc + 2) < 0 || *((_DWORD *)npc + 2) > Current_Map.Width << 13 )
  {
    Vanish_NPC((NPC_vars *)npc);
    return;
  }
  v2 = *((_DWORD *)npc + 29);
  if ( !v2 )
  {
    *((_DWORD *)npc + 29) = 1;
    *((_DWORD *)npc + 8) = *((_DWORD *)npc + 2);
    *((_DWORD *)npc + 9) = *((_DWORD *)npc + 3);
    *((_DWORD *)npc + 27) = *((_DWORD *)npc + 19) / 8;
    *((_DWORD *)npc + 19) %= 8;
    goto LABEL_8;
  }
  if ( v2 == 1 )
  {
LABEL_8:
    *((_DWORD *)npc + 27) += 24;
    *((_DWORD *)npc + 27) %= 256;
    v3 = *((_BYTE *)npc + 108);
    if ( *((_DWORD *)npc + 30) < 128 )
      ++*((_DWORD *)npc + 30);
    if ( *((_DWORD *)npc + 19) )
      *((_DWORD *)npc + 4) += 21;
    else
      *((_DWORD *)npc + 4) -= 21;
    *((_DWORD *)npc + 8) += *((_DWORD *)npc + 4);
    *((_DWORD *)npc + 2) = *((_DWORD *)npc + 8) + 4 * GetCos(v3);
    *((_DWORD *)npc + 3) = *((_DWORD *)npc + 9) + 6 * GetSin(v3);
    NPC_Create(Santas_Key|0x110, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 0, 0, 0, NULL, 256);
  }
  v1 = (char *)npc + 84;
  *(_DWORD *)v1 = 232;
  *((_DWORD *)v1 + 1) = 104;
  *((_DWORD *)v1 + 2) = 248;
  *((_DWORD *)v1 + 3) = 120;
}

//----- (00460AE0) --------------------------------------------------------
int __cdecl NPC286(int a1)
{
  int result; // eax@4
  int *v2; // eax@5
  int v3; // ecx@5
  int v4; // [sp+0h] [bp-30h]@1
  int v5; // [sp+4h] [bp-2Ch]@1
  int v6; // [sp+8h] [bp-28h]@1
  int v7; // [sp+Ch] [bp-24h]@1
  int v8; // [sp+10h] [bp-20h]@1
  int v9; // [sp+14h] [bp-1Ch]@1
  int v10; // [sp+18h] [bp-18h]@1
  int v11; // [sp+1Ch] [bp-14h]@1
  int v12; // [sp+20h] [bp-10h]@1
  int v13; // [sp+24h] [bp-Ch]@1
  int v14; // [sp+28h] [bp-8h]@1
  int v15; // [sp+2Ch] [bp-4h]@1

  v4 = 232;
  v5 = 120;
  v6 = 248;
  v7 = 136;
  v8 = 232;
  v9 = 136;
  v10 = 248;
  v11 = 152;
  v12 = 232;
  v13 = 152;
  v14 = 248;
  v15 = 168;
  if ( ++*(_DWORD *)(a1 + 100) > 0 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) <= 2 )
  {
    v2 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
  }
  else
  {
    result = a1;
    *(_BYTE *)a1 = 0;
  }
  return result;
}

//----- (00460BB0) --------------------------------------------------------
int __cdecl NPC287(int a1)
{
  int result; // eax@4
  int *v2; // edx@8
  int v3; // [sp+0h] [bp-70h]@1
  int v4; // [sp+4h] [bp-6Ch]@1
  int v5; // [sp+8h] [bp-68h]@1
  int v6; // [sp+Ch] [bp-64h]@1
  int v7; // [sp+10h] [bp-60h]@1
  int v8; // [sp+14h] [bp-5Ch]@1
  int v9; // [sp+18h] [bp-58h]@1
  int v10; // [sp+1Ch] [bp-54h]@1
  int v11; // [sp+20h] [bp-50h]@1
  int v12; // [sp+24h] [bp-4Ch]@1
  int v13; // [sp+28h] [bp-48h]@1
  int v14; // [sp+2Ch] [bp-44h]@1
  int v15; // [sp+30h] [bp-40h]@1
  int v16; // [sp+34h] [bp-3Ch]@1
  int v17; // [sp+38h] [bp-38h]@1
  int v18; // [sp+3Ch] [bp-34h]@1
  int v19; // [sp+40h] [bp-30h]@1
  int v20; // [sp+44h] [bp-2Ch]@1
  int v21; // [sp+48h] [bp-28h]@1
  int v22; // [sp+4Ch] [bp-24h]@1
  int v23; // [sp+50h] [bp-20h]@1
  int v24; // [sp+54h] [bp-1Ch]@1
  int v25; // [sp+58h] [bp-18h]@1
  int v26; // [sp+5Ch] [bp-14h]@1
  int v27; // [sp+60h] [bp-10h]@1
  int v28; // [sp+64h] [bp-Ch]@1
  int v29; // [sp+68h] [bp-8h]@1
  int v30; // [sp+6Ch] [bp-4h]@1

  v3 = 0;
  v4 = 224;
  v5 = 16;
  v6 = 240;
  v7 = 16;
  v8 = 224;
  v9 = 32;
  v10 = 240;
  v11 = 32;
  v12 = 224;
  v13 = 48;
  v14 = 240;
  v15 = 48;
  v16 = 224;
  v17 = 64;
  v18 = 240;
  v19 = 64;
  v20 = 224;
  v21 = 80;
  v22 = 240;
  v23 = 80;
  v24 = 224;
  v25 = 96;
  v26 = 240;
  v27 = 96;
  v28 = 224;
  v29 = 112;
  v30 = 240;
  if ( *(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 16) = 20 * *(_DWORD *)(a1 + 16) / 21;
    *(_DWORD *)(a1 + 20) = 20 * *(_DWORD *)(a1 + 20) / 21;
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  }
  else
  {
    *(_DWORD *)(a1 + 16) = Random(-4, 4) << 9;
    *(_DWORD *)(a1 + 116) = 1;
  }
  result = *(_DWORD *)(a1 + 100) + 1;
  *(_DWORD *)(a1 + 100) = result;
  if ( *(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    result = a1;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) <= 6 )
  {
    v2 = &v3 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v2;
    *(_DWORD *)(result + 4) = v2[1];
    *(_DWORD *)(result + 8) = v2[2];
    *(_DWORD *)(result + 12) = v2[3];
  }
  else
  {
    *(_BYTE *)a1 = 0;
  }
  return result;
}

//----- (00460D70) --------------------------------------------------------
int __cdecl NPC288(int a1)
{
  int *v1; // edx@32
  int result; // eax@32
  int v3; // [sp+4h] [bp-50h]@1
  int v4; // [sp+8h] [bp-4Ch]@1
  int v5; // [sp+Ch] [bp-48h]@1
  int v6; // [sp+10h] [bp-44h]@1
  int v7; // [sp+14h] [bp-40h]@1
  int v8; // [sp+18h] [bp-3Ch]@1
  int v9; // [sp+1Ch] [bp-38h]@1
  int v10; // [sp+20h] [bp-34h]@1
  int v11; // [sp+24h] [bp-30h]@1
  int v12; // [sp+28h] [bp-2Ch]@1
  int v13; // [sp+2Ch] [bp-28h]@1
  int v14; // [sp+30h] [bp-24h]@1
  int v15; // [sp+34h] [bp-20h]@1
  int v16; // [sp+38h] [bp-1Ch]@1
  int v17; // [sp+3Ch] [bp-18h]@1
  int v18; // [sp+40h] [bp-14h]@1
  int v19; // [sp+44h] [bp-10h]@1
  int v20; // [sp+48h] [bp-Ch]@1
  int v21; // [sp+4Ch] [bp-8h]@1
  int v22; // [sp+50h] [bp-4h]@1

  v3 = 232;
  v4 = 72;
  v5 = 248;
  v6 = 88;
  v7 = 232;
  v8 = 88;
  v9 = 248;
  v10 = 104;
  v11 = 232;
  v12 = 0;
  v13 = 256;
  v14 = 24;
  v15 = 232;
  v16 = 24;
  v17 = 256;
  v18 = 48;
  v19 = 232;
  v20 = 48;
  v21 = 256;
  v22 = 72;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 16) = -512;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 76) == 1 )
      {
        *(_DWORD *)(a1 + 20) -= 32;
        if ( *(_DWORD *)(a1 + 20) < -1535 )
          *(_DWORD *)(a1 + 20) = -1535;
        if ( *(_DWORD *)(a1 + 4) & 2 )
          *(_DWORD *)(a1 + 116) = 2;
      }
      else if ( *(_DWORD *)(a1 + 76) == 3 )
      {
        *(_DWORD *)(a1 + 20) += 32;
        if ( *(_DWORD *)(a1 + 20) > 1535 )
          *(_DWORD *)(a1 + 20) = 1535;
        if ( *(_DWORD *)(a1 + 4) & 8 )
          *(_DWORD *)(a1 + 116) = 2;
      }
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    case 2:
      Play_Sound_Effect(Sfx_Missile_Impact, 1);
      *(_DWORD *)(a1 + 116) = 3;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) |= 8u;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 16) = 1024;
      else
        *(_DWORD *)(a1 + 16) = -1024;
      *(_DWORD *)(a1 + 148) = 6144;
      *(_DWORD *)(a1 + 140) = 6144;
      *(_DWORD *)(a1 + 144) = 6144;
      *(_DWORD *)(a1 + 152) = 6144;
      goto LABEL_23;
    case 3:
LABEL_23:
      if ( ++*(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( ++*(_DWORD *)(a1 + 120) % 4 == 1 )
      {
        if ( *(_DWORD *)(a1 + 76) == 1 )
          NPC_Create(Treasure_Chest_Closed|0x110, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 1024, 0, NULL, 256);
        else
          NPC_Create(Treasure_Chest_Closed|0x110, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, -1024, 0, NULL, 256);
      }
      if ( *(_DWORD *)(a1 + 8) < 0x2000 || *(_DWORD *)(a1 + 8) > (Current_Map.Width << 13) - 0x2000 )
        *(_BYTE *)a1 = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (004610D0) --------------------------------------------------------
void __cdecl NPC289(void *npc)
{
  int *v1; // eax@29
  char *v2; // ecx@29
  int *v3; // eax@30
  char *v4; // ecx@30
  int v5; // [sp+4h] [bp-60h]@1
  int v6; // [sp+8h] [bp-5Ch]@1
  int v7; // [sp+Ch] [bp-58h]@1
  int v8; // [sp+10h] [bp-54h]@1
  int v9; // [sp+14h] [bp-50h]@1
  int v10; // [sp+18h] [bp-4Ch]@1
  int v11; // [sp+1Ch] [bp-48h]@1
  int v12; // [sp+20h] [bp-44h]@1
  int v13; // [sp+24h] [bp-40h]@1
  int v14; // [sp+28h] [bp-3Ch]@1
  int v15; // [sp+2Ch] [bp-38h]@1
  int v16; // [sp+30h] [bp-34h]@1
  int v17; // [sp+34h] [bp-30h]@1
  int v18; // [sp+38h] [bp-2Ch]@1
  int v19; // [sp+3Ch] [bp-28h]@1
  int v20; // [sp+40h] [bp-24h]@1
  int v21; // [sp+44h] [bp-20h]@1
  int v22; // [sp+48h] [bp-1Ch]@1
  int v23; // [sp+4Ch] [bp-18h]@1
  int v24; // [sp+50h] [bp-14h]@1
  int v25; // [sp+54h] [bp-10h]@1
  int v26; // [sp+58h] [bp-Ch]@1
  int v27; // [sp+5Ch] [bp-8h]@1
  int v28; // [sp+60h] [bp-4h]@1

  v17 = 160;
  v18 = 32;
  v19 = 176;
  v20 = 48;
  v21 = 176;
  v22 = 32;
  v23 = 192;
  v24 = 48;
  v25 = 192;
  v26 = 32;
  v27 = 208;
  v28 = 48;
  v5 = 160;
  v6 = 48;
  v7 = 176;
  v8 = 64;
  v9 = 176;
  v10 = 48;
  v11 = 192;
  v12 = 64;
  v13 = 192;
  v14 = 48;
  v15 = 208;
  v16 = 64;
  switch ( *((_DWORD *)npc + 29) )
  {
    case 0:
      *((_DWORD *)npc + 29) = 1;
      *((_DWORD *)npc + 26) = 2;
      if ( *((_DWORD *)npc + 2) <= Quote.X_Pos )
        *((_DWORD *)npc + 19) = 2;
      else
        *((_DWORD *)npc + 19) = 0;
      goto LABEL_5;
    case 1:
LABEL_5:
      if ( ++*((_DWORD *)npc + 30) > 16 )
      {
        *((_DWORD *)npc + 29) = 10;
        *((_DWORD *)npc + 36) = 4096;
        *((_DWORD *)npc + 38) = 4096;
        *((_DWORD *)npc + 41) = 2;
        *((_WORD *)npc + 40) |= 0x20u;
      }
      goto LABEL_24;
    case 0xA:
      if ( *((_DWORD *)npc + 1) & 8 )
      {
        *((_DWORD *)npc + 29) = 11;
        *((_DWORD *)npc + 26) = 0;
        *((_DWORD *)npc + 30) = 0;
        *((_DWORD *)npc + 4) = 0;
        if ( *((_DWORD *)npc + 2) <= Quote.X_Pos )
          *((_DWORD *)npc + 19) = 2;
        else
          *((_DWORD *)npc + 19) = 0;
      }
      goto LABEL_24;
    case 0xB:
      if ( ++*((_DWORD *)npc + 30) > 10 )
      {
        if ( ++*((_DWORD *)npc + 27) <= 4 )
          *((_DWORD *)npc + 29) = 10;
        else
          *((_DWORD *)npc + 29) = 12;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
        *((_DWORD *)npc + 5) = -1536;
        if ( *((_DWORD *)npc + 19) )
          *((_DWORD *)npc + 4) = 512;
        else
          *((_DWORD *)npc + 4) = -512;
        *((_DWORD *)npc + 26) = 2;
      }
      goto LABEL_24;
    case 0xC:
      *((_WORD *)npc + 40) |= 8u;
      if ( *((_DWORD *)npc + 3) <= Current_Map.Length << 13 )
        goto LABEL_24;
      Vanish_NPC((NPC_vars *)npc);
      break;
    default:
LABEL_24:
      if ( *((_DWORD *)npc + 29) >= 10 )
        *((_DWORD *)npc + 5) += 64;
      if ( *((_DWORD *)npc + 5) > 1535 )
        *((_DWORD *)npc + 5) = 1535;
      *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
      *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
      if ( *((_DWORD *)npc + 19) )
      {
        v3 = &v5 + 4 * *((_DWORD *)npc + 26);
        v4 = (char *)npc + 84;
        *(_DWORD *)v4 = *v3;
        *((_DWORD *)v4 + 1) = v3[1];
        *((_DWORD *)v4 + 2) = v3[2];
        *((_DWORD *)v4 + 3) = v3[3];
      }
      else
      {
        v1 = &v17 + 4 * *((_DWORD *)npc + 26);
        v2 = (char *)npc + 84;
        *(_DWORD *)v2 = *v1;
        *((_DWORD *)v2 + 1) = v1[1];
        *((_DWORD *)v2 + 2) = v1[2];
        *((_DWORD *)v2 + 3) = v1[3];
      }
      if ( *((_DWORD *)npc + 29) == 1 )
      {
        *((_DWORD *)npc + 22) += 8 - *((_DWORD *)npc + 30) / 2;
        *((_DWORD *)npc + 24) -= *((_DWORD *)npc + 30) / 2 + 8;
        *((_DWORD *)npc + 36) = (*((_DWORD *)npc + 30) << 9) / 2;
        *((_DWORD *)npc + 38) = (*((_DWORD *)npc + 30) << 9) / 2;
      }
      break;
  }
}

//----- (004614A0) --------------------------------------------------------
void __cdecl NPC290(void *npc)
{
  int *v1; // ecx@27
  char *v2; // edx@27
  int *v3; // ecx@28
  char *v4; // edx@28
  int v5; // [sp+0h] [bp-64h]@1
  int v6; // [sp+4h] [bp-60h]@1
  int v7; // [sp+8h] [bp-5Ch]@1
  int v8; // [sp+Ch] [bp-58h]@1
  int v9; // [sp+10h] [bp-54h]@1
  int v10; // [sp+14h] [bp-50h]@1
  int v11; // [sp+18h] [bp-4Ch]@1
  int v12; // [sp+1Ch] [bp-48h]@1
  int v13; // [sp+20h] [bp-44h]@1
  int v14; // [sp+24h] [bp-40h]@1
  int v15; // [sp+28h] [bp-3Ch]@1
  int v16; // [sp+2Ch] [bp-38h]@1
  int v17; // [sp+30h] [bp-34h]@1
  int v18; // [sp+34h] [bp-30h]@1
  int v19; // [sp+38h] [bp-2Ch]@1
  int v20; // [sp+3Ch] [bp-28h]@1
  int v21; // [sp+40h] [bp-24h]@1
  int v22; // [sp+44h] [bp-20h]@1
  int v23; // [sp+48h] [bp-1Ch]@1
  int v24; // [sp+4Ch] [bp-18h]@1
  int v25; // [sp+50h] [bp-14h]@1
  int v26; // [sp+54h] [bp-10h]@1
  int v27; // [sp+58h] [bp-Ch]@1
  int v28; // [sp+5Ch] [bp-8h]@1
  int v29; // [sp+60h] [bp-4h]@1

  v18 = 112;
  v19 = 32;
  v20 = 128;
  v21 = 48;
  v22 = 128;
  v23 = 32;
  v24 = 144;
  v25 = 48;
  v26 = 144;
  v27 = 32;
  v28 = 160;
  v29 = 48;
  v6 = 112;
  v7 = 48;
  v8 = 128;
  v9 = 64;
  v10 = 128;
  v11 = 48;
  v12 = 144;
  v13 = 64;
  v14 = 144;
  v15 = 48;
  v16 = 160;
  v17 = 64;
  v5 = *((_DWORD *)npc + 29);
  if ( !v5 )
  {
    *((_DWORD *)npc + 29) = 1;
    *((_DWORD *)npc + 26) = 2;
    if ( *((_DWORD *)npc + 2) <= Quote.X_Pos )
      *((_DWORD *)npc + 19) = 2;
    else
      *((_DWORD *)npc + 19) = 0;
LABEL_8:
    if ( ++*((_DWORD *)npc + 30) > 16 )
    {
      *((_DWORD *)npc + 29) = 10;
      *((_DWORD *)npc + 36) = 4096;
      *((_DWORD *)npc + 38) = 4096;
      *((_DWORD *)npc + 41) = 2;
      *((_WORD *)npc + 40) |= 0x20u;
      *((_DWORD *)npc + 9) = *((_DWORD *)npc + 3);
      *((_DWORD *)npc + 5) = 1024;
    }
    goto LABEL_26;
  }
  if ( v5 == 1 )
    goto LABEL_8;
  if ( v5 == 10 )
  {
    if ( ++*((_DWORD *)npc + 25) > 2 )
    {
      *((_DWORD *)npc + 25) = 0;
      ++*((_DWORD *)npc + 26);
    }
    if ( *((_DWORD *)npc + 26) > 2 )
      *((_DWORD *)npc + 26) = 0;
    if ( *((_DWORD *)npc + 3) >= *((_DWORD *)npc + 9) )
      *((_DWORD *)npc + 5) -= 64;
    else
      *((_DWORD *)npc + 5) += 64;
    if ( *((_DWORD *)npc + 19) )
      *((_DWORD *)npc + 4) += 16;
    else
      *((_DWORD *)npc + 4) -= 16;
    if ( *((_DWORD *)npc + 2) < 0
      || *((_DWORD *)npc + 3) < 0
      || *((_DWORD *)npc + 2) > Current_Map.Width << 13
      || *((_DWORD *)npc + 3) > Current_Map.Length << 13 )
    {
      Vanish_NPC((NPC_vars *)npc);
      return;
    }
  }
LABEL_26:
  *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
  *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
  if ( *((_DWORD *)npc + 19) )
  {
    v3 = &v6 + 4 * *((_DWORD *)npc + 26);
    v4 = (char *)npc + 84;
    *(_DWORD *)v4 = *v3;
    *((_DWORD *)v4 + 1) = v3[1];
    *((_DWORD *)v4 + 2) = v3[2];
    *((_DWORD *)v4 + 3) = v3[3];
  }
  else
  {
    v1 = &v18 + 4 * *((_DWORD *)npc + 26);
    v2 = (char *)npc + 84;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    *((_DWORD *)v2 + 2) = v1[2];
    *((_DWORD *)v2 + 3) = v1[3];
  }
  if ( *((_DWORD *)npc + 29) == 1 )
  {
    *((_DWORD *)npc + 22) += 8 - *((_DWORD *)npc + 30) / 2;
    *((_DWORD *)npc + 24) -= *((_DWORD *)npc + 30) / 2 + 8;
    *((_DWORD *)npc + 36) = (*((_DWORD *)npc + 30) << 9) / 2;
    *((_DWORD *)npc + 38) = (*((_DWORD *)npc + 30) << 9) / 2;
  }
}

//----- (00461800) --------------------------------------------------------
int __cdecl NPC291(int a1)
{
  int *v1; // ecx@4
  int v2; // edx@4
  int result; // eax@4
  int v4; // [sp+4h] [bp-20h]@1
  int v5; // [sp+8h] [bp-1Ch]@1
  int v6; // [sp+Ch] [bp-18h]@1
  int v7; // [sp+10h] [bp-14h]@1
  int v8; // [sp+14h] [bp-10h]@1
  int v9; // [sp+18h] [bp-Ch]@1
  int v10; // [sp+1Ch] [bp-8h]@1
  int v11; // [sp+20h] [bp-4h]@1

  v4 = 256;
  v5 = 80;
  v6 = 320;
  v7 = 120;
  v8 = 256;
  v9 = 0;
  v10 = 320;
  v11 = 40;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 20;
    if ( *(_DWORD *)(a1 + 76) == 2 )
    {
      *(_WORD *)(a1 + 80) &= 0xFFBFu;
      *(_DWORD *)(a1 + 104) = 1;
    }
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (004618B0) --------------------------------------------------------
void NPC292()
{
  Set_Quake(10);
}

//----- (004618C0) --------------------------------------------------------
int __cdecl NPC293(int a1)
{
  int v1; // ST08_4@7
  int v2; // eax@7
  int *v3; // eax@9
  int v4; // ecx@9
  int result; // eax@9
  int v6; // [sp+0h] [bp-24h]@1
  int v7; // [sp+4h] [bp-20h]@1
  int v8; // [sp+8h] [bp-1Ch]@1
  int v9; // [sp+Ch] [bp-18h]@1
  int v10; // [sp+10h] [bp-14h]@1
  int v11; // [sp+14h] [bp-10h]@1
  int v12; // [sp+18h] [bp-Ch]@1
  int v13; // [sp+1Ch] [bp-8h]@1
  int v14; // [sp+20h] [bp-4h]@1

  v7 = 240;
  v8 = 200;
  v9 = 280;
  v10 = 240;
  v11 = 280;
  v12 = 200;
  v13 = 320;
  v14 = 240;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
      goto LABEL_9;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( ++*(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = *(_DWORD *)(a1 + 12) + (Random(-16, 16) << 9);
  v2 = Random(0, 16);
  NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v2 << 9), v1, 0, 0, 0, NULL, 256);
  *(_DWORD *)(a1 + 8) -= 4096;
  if ( *(_DWORD *)(a1 + 8) < -16384 )
    *(_BYTE *)a1 = 0;
LABEL_9:
  v3 = &v7 + 4 * *(_DWORD *)(a1 + 104);
  v4 = a1 + 84;
  *(_DWORD *)v4 = *v3;
  *(_DWORD *)(v4 + 4) = v3[1];
  *(_DWORD *)(v4 + 8) = v3[2];
  result = v3[3];
  *(_DWORD *)(v4 + 12) = result;
  return result;
}

//----- (004619E0) --------------------------------------------------------
int __cdecl NPC294(int a1)
{
  int result; // eax@1
  int v2; // [sp+0h] [bp-10h]@1
  int X_Pos; // [sp+8h] [bp-8h]@17
  int Y_Pos; // [sp+Ch] [bp-4h]@19

  result = a1;
  v2 = *(_DWORD *)(a1 + 116);
  if ( v2 )
  {
    if ( v2 == 1 )
    {
      ++*(_DWORD *)(a1 + 120);
      if ( Quote.Equipped_Items & 0x20 )
      {
        *(_DWORD *)(a1 + 8) = Quote.X_Pos + 0x8000;
        if ( *(_DWORD *)(a1 + 8) < 212992 )
          *(_DWORD *)(a1 + 8) = 212992;
      }
      else
      {
        *(_DWORD *)(a1 + 8) = Quote.X_Pos + 49152;
        if ( *(_DWORD *)(a1 + 8) < 188416 )
          *(_DWORD *)(a1 + 8) = 188416;
      }
      if ( *(_DWORD *)(a1 + 8) > (Current_Map.Width - 10) << 13 )
        *(_DWORD *)(a1 + 8) = (Current_Map.Width - 10) << 13;
      result = a1;
      if ( *(_DWORD *)(a1 + 120) > 24 )
      {
        if ( Quote.Equipped_Items & 0x20 )
          X_Pos = *(_DWORD *)(a1 + 8) + (Random(-14, 14) << 13);
        else
          X_Pos = *(_DWORD *)(a1 + 8) + (Random(-11, 11) << 13);
        Y_Pos = Quote.Y_Pos - 114688;
        if ( Random(0, 10) % 2 )
          NPC_Create(Enemy_Basil|0x110, X_Pos, Y_Pos, 0, 0, 0, NULL, 256);
        else
          NPC_Create(Enemy_Basil|0x110, X_Pos, Y_Pos, 0, 0, Right, NULL, 256);
        result = Random(0, 15);
        *(_DWORD *)(a1 + 120) = result;
      }
    }
  }
  else if ( Quote.X_Pos < (Current_Map.Width - 6) << 13 )
  {
    result = a1;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 120) = 0;
  }
  return result;
}

//----- (00461B90) --------------------------------------------------------
int __cdecl NPC295(int a1)
{
  int *v1; // edx@18
  int result; // eax@18
  int v3; // [sp+4h] [bp-44h]@1
  int v4; // [sp+8h] [bp-40h]@1
  int v5; // [sp+Ch] [bp-3Ch]@1
  int v6; // [sp+10h] [bp-38h]@1
  int v7; // [sp+14h] [bp-34h]@1
  int v8; // [sp+18h] [bp-30h]@1
  int v9; // [sp+1Ch] [bp-2Ch]@1
  int v10; // [sp+20h] [bp-28h]@1
  int v11; // [sp+24h] [bp-24h]@1
  int v12; // [sp+28h] [bp-20h]@1
  int v13; // [sp+2Ch] [bp-1Ch]@1
  int v14; // [sp+30h] [bp-18h]@1
  int v15; // [sp+34h] [bp-14h]@1
  int v16; // [sp+38h] [bp-10h]@1
  int v17; // [sp+3Ch] [bp-Ch]@1
  int v18; // [sp+40h] [bp-8h]@1
  int v19; // [sp+44h] [bp-4h]@1

  v4 = 0;
  v5 = 0;
  v6 = 208;
  v7 = 64;
  v8 = 32;
  v9 = 64;
  v10 = 144;
  v11 = 96;
  v12 = 32;
  v13 = 96;
  v14 = 104;
  v15 = 128;
  v16 = 104;
  v17 = 96;
  v18 = 144;
  v19 = 128;
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 == 1 )
    {
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 8) < -32768 )
        *(_BYTE *)a1 = 0;
      if ( *(_DWORD *)(a1 + 12) < -16384 )
        *(_BYTE *)a1 = 0;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = *(_DWORD *)(a1 + 76) % 4;
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        *(_DWORD *)(a1 + 20) = -4096;
        *(_DWORD *)(a1 + 148) = 53248;
        *(_DWORD *)(a1 + 140) = 53248;
        break;
      case 1:
        *(_DWORD *)(a1 + 20) = -2048;
        *(_DWORD *)(a1 + 148) = 28672;
        *(_DWORD *)(a1 + 140) = 28672;
        break;
      case 2:
        *(_DWORD *)(a1 + 20) = -1024;
        *(_DWORD *)(a1 + 148) = 0x4000;
        *(_DWORD *)(a1 + 140) = 0x4000;
        break;
      case 3:
        *(_DWORD *)(a1 + 20) = -512;
        *(_DWORD *)(a1 + 148) = 10240;
        *(_DWORD *)(a1 + 140) = 10240;
        break;
      case 4:
        *(_DWORD *)(a1 + 16) = -1024;
        *(_DWORD *)(a1 + 148) = 53248;
        *(_DWORD *)(a1 + 140) = 53248;
        break;
      case 5:
        *(_DWORD *)(a1 + 16) = -512;
        *(_DWORD *)(a1 + 148) = 28672;
        *(_DWORD *)(a1 + 140) = 28672;
        break;
      case 6:
        *(_DWORD *)(a1 + 16) = -256;
        *(_DWORD *)(a1 + 148) = 0x4000;
        *(_DWORD *)(a1 + 140) = 0x4000;
        break;
      case 7:
        *(_DWORD *)(a1 + 16) = -128;
        *(_DWORD *)(a1 + 148) = 10240;
        *(_DWORD *)(a1 + 140) = 10240;
        break;
      default:
        break;
    }
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00461E40) --------------------------------------------------------
void __cdecl NPC296(int a1)
{
  int v1; // eax@2
  int v2; // eax@8
  int X_Pos; // ST30_4@14
  int v4; // eax@14
  signed int Start_Index; // [sp+8h] [bp-10h]@0
  int Direction; // [sp+Ch] [bp-Ch]@2

  if ( ++*(_DWORD *)(a1 + 120) > 16 )
  {
    *(_DWORD *)(a1 + 120) = Random(0, 16);
    v1 = Random(0, 100) % 4;
    Direction = v1;
    if ( *(_DWORD *)(a1 + 76) )
    {
      switch ( v1 )
      {
        case 0:
          Start_Index = 128;
          break;
        case 1:
          Start_Index = 85;
          break;
        case 2:
          Start_Index = 64;
          break;
        case 3:
          Start_Index = 0;
          break;
        default:
          break;
      }
      X_Pos = *(_DWORD *)(a1 + 8);
      v4 = Random(-7, 7);
      NPC_Create(
        Enemy_Basil|0x120,
        X_Pos,
        *(_DWORD *)(a1 + 12) + (v4 << 13),
        0,
        0,
        (Directions)(Direction + 4),
        NULL,
        Start_Index);
    }
    else
    {
      switch ( v1 )
      {
        case 0:
          Start_Index = 384;
          break;
        case 1:
          Start_Index = 128;
          break;
        case 2:
          Start_Index = 64;
          break;
        case 3:
          Start_Index = 0;
          break;
        default:
          break;
      }
      v2 = Random(-10, 10);
      NPC_Create(
        Enemy_Basil|0x120,
        *(_DWORD *)(a1 + 8) + (v2 << 13),
        *(_DWORD *)(a1 + 12),
        0,
        0,
        (Directions)Direction,
        NULL,
        Start_Index);
    }
  }
}

//----- (00461FD0) --------------------------------------------------------
signed int __cdecl NPC297(int a1)
{
  int v1; // edx@1
  signed int result; // eax@1

  *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 0x2000;
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) + 4096;
  v1 = a1 + 84;
  *(_DWORD *)v1 = 112;
  *(_DWORD *)(v1 + 4) = 48;
  result = 128;
  *(_DWORD *)(v1 + 8) = 128;
  *(_DWORD *)(v1 + 12) = 64;
  return result;
}

//----- (00462050) --------------------------------------------------------
int __cdecl NPC298(int a1)
{
  int *v1; // edx@24
  int result; // eax@24
  int v3; // [sp+4h] [bp-80h]@1
  int v4; // [sp+8h] [bp-7Ch]@1
  int v5; // [sp+Ch] [bp-78h]@1
  int v6; // [sp+10h] [bp-74h]@1
  int v7; // [sp+14h] [bp-70h]@1
  int v8; // [sp+18h] [bp-6Ch]@1
  int v9; // [sp+1Ch] [bp-68h]@1
  int v10; // [sp+20h] [bp-64h]@1
  int v11; // [sp+24h] [bp-60h]@1
  int v12; // [sp+28h] [bp-5Ch]@1
  int v13; // [sp+2Ch] [bp-58h]@1
  int v14; // [sp+30h] [bp-54h]@1
  int v15; // [sp+34h] [bp-50h]@1
  int v16; // [sp+38h] [bp-4Ch]@1
  int v17; // [sp+3Ch] [bp-48h]@1
  int v18; // [sp+40h] [bp-44h]@1
  int v19; // [sp+44h] [bp-40h]@1
  int v20; // [sp+48h] [bp-3Ch]@1
  int v21; // [sp+4Ch] [bp-38h]@1
  int v22; // [sp+50h] [bp-34h]@1
  int v23; // [sp+54h] [bp-30h]@1
  int v24; // [sp+58h] [bp-2Ch]@1
  int v25; // [sp+5Ch] [bp-28h]@1
  int v26; // [sp+60h] [bp-24h]@1
  int v27; // [sp+64h] [bp-20h]@1
  int v28; // [sp+68h] [bp-1Ch]@1
  int v29; // [sp+6Ch] [bp-18h]@1
  int v30; // [sp+70h] [bp-14h]@1
  int v31; // [sp+74h] [bp-10h]@1
  int v32; // [sp+78h] [bp-Ch]@1
  int v33; // [sp+7Ch] [bp-8h]@1
  int v34; // [sp+80h] [bp-4h]@1

  v3 = 72;
  v4 = 128;
  v5 = 88;
  v6 = 160;
  v7 = 88;
  v8 = 128;
  v9 = 104;
  v10 = 160;
  v11 = 104;
  v12 = 128;
  v13 = 120;
  v14 = 160;
  v15 = 72;
  v16 = 128;
  v17 = 88;
  v18 = 160;
  v19 = 120;
  v20 = 128;
  v21 = 136;
  v22 = 160;
  v23 = 72;
  v24 = 128;
  v25 = 88;
  v26 = 160;
  v27 = 104;
  v28 = 160;
  v29 = 120;
  v30 = 192;
  v31 = 120;
  v32 = 160;
  v33 = 136;
  v34 = 192;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) -= 4096;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_5;
    case 0xB:
LABEL_5:
      if ( ++*(_DWORD *)(a1 + 100) > 6 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
      {
        *(_DWORD *)(a1 + 104) = 0;
        if ( ++*(_DWORD *)(a1 + 108) > 7 )
        {
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 116) = 1;
        }
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_12;
    case 0x15:
LABEL_12:
      if ( ++*(_DWORD *)(a1 + 100) > 10 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 5 )
        *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 8) += 256;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 104) = 6;
      break;
    case 0x28:
      *(_DWORD *)(a1 + 116) = 41;
      *(_DWORD *)(a1 + 104) = 6;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 108) = 0;
      goto LABEL_19;
    case 0x29:
LABEL_19:
      if ( ++*(_DWORD *)(a1 + 100) > 6 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 7 )
      {
        *(_DWORD *)(a1 + 104) = 6;
        if ( ++*(_DWORD *)(a1 + 108) > 7 )
        {
          *(_DWORD *)(a1 + 104) = 6;
          *(_DWORD *)(a1 + 116) = 30;
        }
      }
      break;
    default:
      break;
  }
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (004623D0) --------------------------------------------------------
int __cdecl NPC299(int a1)
{
  int *v1; // ecx@8
  int v2; // edx@8
  int result; // eax@8
  int v4; // [sp+0h] [bp-20h]@1
  int v5; // [sp+4h] [bp-1Ch]@1
  int v6; // [sp+8h] [bp-18h]@1
  int v7; // [sp+Ch] [bp-14h]@1
  int v8; // [sp+10h] [bp-10h]@1
  int v9; // [sp+14h] [bp-Ch]@1
  int v10; // [sp+18h] [bp-8h]@1
  int v11; // [sp+1Ch] [bp-4h]@1

  v4 = 0;
  v5 = 0;
  v6 = 48;
  v7 = 48;
  v8 = 48;
  v9 = 0;
  v10 = 96;
  v11 = 48;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) )
    {
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 120) = 0;
    }
    else
    {
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 120) = 25;
      *(_DWORD *)(a1 + 12) -= 1600;
    }
  }
  if ( ++*(_DWORD *)(a1 + 120) / 50 % 2 )
    *(_DWORD *)(a1 + 12) += 64;
  else
    *(_DWORD *)(a1 + 12) -= 64;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (004624E0) --------------------------------------------------------
signed int __cdecl NPC300(int a1)
{
  int v1; // ST08_4@4
  int v2; // eax@4
  int v3; // edx@5
  signed int result; // eax@5

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) += 3072;
  }
  if ( ++*(_DWORD *)(a1 + 100) % 8 == 1 )
  {
    v1 = *(_DWORD *)(a1 + 12) + 4096;
    v2 = Random(-8, 8);
    Create_Effect(*(_DWORD *)(a1 + 8) + (v2 << 9), v1, 13, 1);
  }
  v3 = a1 + 84;
  *(_DWORD *)v3 = 192;
  *(_DWORD *)(v3 + 4) = 80;
  result = 208;
  *(_DWORD *)(v3 + 8) = 208;
  *(_DWORD *)(v3 + 12) = 96;
  return result;
}

//----- (004625A0) --------------------------------------------------------
int __cdecl NPC301(int a1)
{
  int *v1; // eax@21
  int v2; // ecx@21
  int result; // eax@21
  int v4; // [sp+0h] [bp-88h]@1
  int v5; // [sp+4h] [bp-84h]@5
  int v6; // [sp+8h] [bp-80h]@1
  int v7; // [sp+Ch] [bp-7Ch]@1
  int v8; // [sp+10h] [bp-78h]@1
  int v9; // [sp+14h] [bp-74h]@1
  int v10; // [sp+18h] [bp-70h]@1
  int v11; // [sp+1Ch] [bp-6Ch]@1
  int v12; // [sp+20h] [bp-68h]@1
  int v13; // [sp+24h] [bp-64h]@1
  int v14; // [sp+28h] [bp-60h]@1
  int v15; // [sp+2Ch] [bp-5Ch]@1
  int v16; // [sp+30h] [bp-58h]@1
  int v17; // [sp+34h] [bp-54h]@1
  int v18; // [sp+38h] [bp-50h]@1
  int v19; // [sp+3Ch] [bp-4Ch]@1
  int v20; // [sp+40h] [bp-48h]@1
  int v21; // [sp+44h] [bp-44h]@1
  int v22; // [sp+48h] [bp-40h]@1
  int v23; // [sp+4Ch] [bp-3Ch]@1
  int v24; // [sp+50h] [bp-38h]@1
  int v25; // [sp+54h] [bp-34h]@1
  int v26; // [sp+58h] [bp-30h]@1
  int v27; // [sp+5Ch] [bp-2Ch]@1
  int v28; // [sp+60h] [bp-28h]@1
  int v29; // [sp+64h] [bp-24h]@1
  int v30; // [sp+68h] [bp-20h]@1
  int v31; // [sp+6Ch] [bp-1Ch]@1
  int v32; // [sp+70h] [bp-18h]@1
  int v33; // [sp+74h] [bp-14h]@1
  int v34; // [sp+78h] [bp-10h]@1
  int v35; // [sp+7Ch] [bp-Ch]@1
  int v36; // [sp+80h] [bp-8h]@1
  int v37; // [sp+84h] [bp-4h]@1

  v6 = 144;
  v7 = 0;
  v8 = 160;
  v9 = 16;
  v10 = 160;
  v11 = 0;
  v12 = 176;
  v13 = 16;
  v14 = 176;
  v15 = 0;
  v16 = 192;
  v17 = 16;
  v18 = 192;
  v19 = 0;
  v20 = 208;
  v21 = 16;
  v22 = 144;
  v23 = 16;
  v24 = 160;
  v25 = 32;
  v26 = 160;
  v27 = 16;
  v28 = 176;
  v29 = 32;
  v30 = 176;
  v31 = 16;
  v32 = 192;
  v33 = 32;
  v34 = 192;
  v35 = 16;
  v36 = 208;
  v37 = 32;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_17;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 108) = *(_DWORD *)(a1 + 76);
  }
  *(_DWORD *)(a1 + 16) = 2 * GetCos(*(_BYTE *)(a1 + 108));
  *(_DWORD *)(a1 + 20) = 2 * GetSin(*(_BYTE *)(a1 + 108));
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v5 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
  if ( v5 >= *(_DWORD *)(a1 + 108) )
  {
    if ( v5 - *(_DWORD *)(a1 + 108) >= 128 )
      --*(_DWORD *)(a1 + 108);
    else
      ++*(_DWORD *)(a1 + 108);
  }
  else if ( *(_DWORD *)(a1 + 108) - v5 >= 128 )
  {
    ++*(_DWORD *)(a1 + 108);
  }
  else
  {
    --*(_DWORD *)(a1 + 108);
  }
  if ( *(_DWORD *)(a1 + 108) > 255 )
    *(_DWORD *)(a1 + 108) -= 256;
  if ( *(_DWORD *)(a1 + 108) < 0 )
    *(_DWORD *)(a1 + 108) += 256;
LABEL_17:
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 7, 4);
  }
  *(_DWORD *)(a1 + 104) = (*(_DWORD *)(a1 + 108) + 16) / 32;
  if ( *(_DWORD *)(a1 + 104) > 7 )
    *(_DWORD *)(a1 + 104) = 7;
  v1 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00462890) --------------------------------------------------------
int __cdecl NPC302(int a1)
{
  int Switch_case; // ST04_4@1
  int result; // eax@1
  __int64 v3; // rax@21
  signed int i; // [sp+8h] [bp-4h]@11

  Switch_case = *(_DWORD *)(a1 + 116);
  result = Switch_case - 10;
  switch ( Switch_case )
  {
    case 10:
      result = Quote.X_Pos;
      *(_DWORD *)(a1 + 8) = Quote.X_Pos;
      *(_DWORD *)(a1 + 12) = Quote.Y_Pos - 0x4000;
      break;
    case 20:
      switch ( *(_DWORD *)(a1 + 76) )
      {
        case 0:
          *(_DWORD *)(a1 + 8) -= 1024;
          break;
        case 1:
          *(_DWORD *)(a1 + 12) -= 1024;
          break;
        case 2:
          *(_DWORD *)(a1 + 8) += 1024;
          break;
        case 3:
          *(_DWORD *)(a1 + 12) += 1024;
          break;
        default:
          break;
      }
      Quote.X_Pos = *(_DWORD *)(a1 + 8);
      result = *(_DWORD *)(a1 + 12);
      Quote.Y_Pos = *(_DWORD *)(a1 + 12);
      break;
    case 30:
      *(_DWORD *)(a1 + 8) = Quote.X_Pos;
      result = Quote.Y_Pos + 40960;
      *(_DWORD *)(a1 + 12) = Quote.Y_Pos + 40960;
      break;
    case 100:
      *(_DWORD *)(a1 + 116) = 101;
      if ( !*(_DWORD *)(a1 + 76) )
      {
        *(_DWORD *)(a1 + 168) = Boss_Objects;
        goto LABEL_21;
      }
      for ( i = 170; i < 512; ++i )
      {
        if ( NPC_Objects[i].Is_Alive & 0x80 && NPC_Objects[i].Entity_Eve_Num == *(_DWORD *)(a1 + 76) )
        {
          *(_DWORD *)(a1 + 168) = &NPC_Objects[i];
          break;
        }
      }
      if ( i != 512 )
        goto LABEL_21;
      result = a1;
      *(_BYTE *)a1 = 0;
      break;
    case 101:
LABEL_21:
      v3 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + Quote.X_Pos;
      *(_DWORD *)(a1 + 8) = ((signed int)v3 - HIDWORD(v3)) >> 1;
      result = (*(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) + Quote.Y_Pos) / 2;
      *(_DWORD *)(a1 + 12) = result;
      break;
    default:
      return result;
  }
  return result;
}

//----- (00462AF0) --------------------------------------------------------
int __cdecl NPC303(int a1)
{
  int result; // eax@1
  int *v2; // ecx@9
  int v3; // edx@9
  int *v4; // ecx@10
  int v5; // edx@10
  int v6; // [sp+0h] [bp-40h]@1
  int v7; // [sp+4h] [bp-3Ch]@1
  int v8; // [sp+8h] [bp-38h]@1
  int v9; // [sp+Ch] [bp-34h]@1
  int v10; // [sp+10h] [bp-30h]@1
  int v11; // [sp+14h] [bp-2Ch]@1
  int v12; // [sp+18h] [bp-28h]@1
  int v13; // [sp+1Ch] [bp-24h]@1
  int v14; // [sp+20h] [bp-20h]@1
  int v15; // [sp+24h] [bp-1Ch]@1
  int v16; // [sp+28h] [bp-18h]@1
  int v17; // [sp+2Ch] [bp-14h]@1
  int v18; // [sp+30h] [bp-10h]@1
  int v19; // [sp+34h] [bp-Ch]@1
  int v20; // [sp+38h] [bp-8h]@1
  int v21; // [sp+3Ch] [bp-4h]@1

  v14 = 216;
  v15 = 152;
  v16 = 232;
  v17 = 168;
  v18 = 232;
  v19 = 152;
  v20 = 248;
  v21 = 168;
  v6 = 216;
  v7 = 168;
  v8 = 232;
  v9 = 184;
  v10 = 232;
  v11 = 168;
  v12 = 248;
  v13 = 184;
  result = a1;
  if ( *(_DWORD *)(a1 + 168) )
  {
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
    {
      *(_DWORD *)(a1 + 76) = 2;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 4096;
    }
    else
    {
      *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 4096;
    }
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
    *(_DWORD *)(a1 + 104) = 0;
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 3 || *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 5 )
      *(_DWORD *)(a1 + 12) -= 512;
    if ( *(_DWORD *)(a1 + 76) )
    {
      v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      result = v4[2];
      *(_DWORD *)(v5 + 8) = result;
      *(_DWORD *)(v5 + 12) = v4[3];
    }
    else
    {
      v2 = &v14 + 4 * *(_DWORD *)(a1 + 104);
      v3 = a1 + 84;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      result = v2[2];
      *(_DWORD *)(v3 + 8) = result;
      *(_DWORD *)(v3 + 12) = v2[3];
    }
  }
  return result;
}

//----- (00462C80) --------------------------------------------------------
int __cdecl NPC304(int a1)
{
  int *v1; // eax@10
  int v2; // ecx@10
  int result; // eax@10
  int v4; // [sp+4h] [bp-40h]@1
  int v5; // [sp+8h] [bp-3Ch]@1
  int v6; // [sp+Ch] [bp-38h]@1
  int v7; // [sp+10h] [bp-34h]@1
  int v8; // [sp+14h] [bp-30h]@1
  int v9; // [sp+18h] [bp-2Ch]@1
  int v10; // [sp+1Ch] [bp-28h]@1
  int v11; // [sp+20h] [bp-24h]@1
  int v12; // [sp+24h] [bp-20h]@1
  int v13; // [sp+28h] [bp-1Ch]@1
  int v14; // [sp+2Ch] [bp-18h]@1
  int v15; // [sp+30h] [bp-14h]@1
  int v16; // [sp+34h] [bp-10h]@1
  int v17; // [sp+38h] [bp-Ch]@1
  int v18; // [sp+3Ch] [bp-8h]@1
  int v19; // [sp+40h] [bp-4h]@1

  v4 = 0;
  v5 = 176;
  v6 = 24;
  v7 = 192;
  v8 = 24;
  v9 = 176;
  v10 = 48;
  v11 = 192;
  v12 = 48;
  v13 = 176;
  v14 = 72;
  v15 = 192;
  v16 = 72;
  v17 = 176;
  v18 = 96;
  v19 = 192;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 12) += 5120;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 104) = 1;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 104) = 2;
      goto LABEL_6;
    case 0x15:
LABEL_6:
      if ( ++*(_DWORD *)(a1 + 100) > 10 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 3 )
        *(_DWORD *)(a1 + 104) = 2;
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00462E00) --------------------------------------------------------
int __cdecl NPC305(int a1)
{
  int *v1; // eax@10
  int v2; // ecx@10
  int result; // eax@10
  int *v4; // eax@11
  int v5; // ecx@11
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 160;
  v16 = 144;
  v17 = 176;
  v18 = 160;
  v19 = 176;
  v20 = 144;
  v21 = 192;
  v22 = 160;
  v7 = 160;
  v8 = 160;
  v9 = 176;
  v10 = 176;
  v11 = 176;
  v12 = 160;
  v13 = 192;
  v14 = 176;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
      goto LABEL_9;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) -= 0x2000;
    *(_DWORD *)(a1 + 100) = Random(0, 6);
  }
  if ( ++*(_DWORD *)(a1 + 100) > 6 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
LABEL_9:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00462F60) --------------------------------------------------------
int __cdecl NPC306(int a1)
{
  int *v1; // edx@12
  int result; // eax@12
  int *v3; // edx@13
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v13 = 240;
  v14 = 96;
  v15 = 280;
  v16 = 128;
  v17 = 280;
  v18 = 96;
  v19 = 320;
  v20 = 128;
  v5 = 160;
  v6 = 152;
  v7 = 200;
  v8 = 184;
  v9 = 200;
  v10 = 152;
  v11 = 240;
  v12 = 184;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 && ++*(_DWORD *)(a1 + 120) > 8 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
    *(_DWORD *)(a1 + 12) += 2048;
  }
  if ( Random(0, 120) == 10 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v5 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v13 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (004630F0) --------------------------------------------------------
int __cdecl NPC307(int a1)
{
  int *v1; // eax@15
  int v2; // ecx@15
  int result; // eax@15
  int *v4; // eax@16
  int v5; // ecx@16
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 0;
  v16 = 32;
  v17 = 16;
  v18 = 48;
  v19 = 16;
  v20 = 32;
  v21 = 32;
  v22 = 48;
  v7 = 0;
  v8 = 48;
  v9 = 16;
  v10 = 64;
  v11 = 16;
  v12 = 48;
  v13 = 32;
  v14 = 64;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      if ( v6 == 2 && ++*(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 8) += 512;
    *(_DWORD *)(a1 + 12) -= 1024;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 100) = 0;
  }
  if ( Random(0, 160) == 1 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 104) = 1;
  }
LABEL_11:
  if ( Quote.X_Pos >= *(_DWORD *)(a1 + 8) )
    *(_DWORD *)(a1 + 76) = 2;
  else
    *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (004632B0) --------------------------------------------------------
int __cdecl NPC308(int a1)
{
  int *v1; // ecx@45
  int v2; // edx@45
  int result; // eax@45
  int *v4; // ecx@46
  int v5; // edx@46
  int v6; // [sp+4h] [bp-44h]@1
  int v7; // [sp+8h] [bp-40h]@1
  int v8; // [sp+Ch] [bp-3Ch]@1
  int v9; // [sp+10h] [bp-38h]@1
  int v10; // [sp+14h] [bp-34h]@1
  int v11; // [sp+18h] [bp-30h]@1
  int v12; // [sp+1Ch] [bp-2Ch]@1
  int v13; // [sp+20h] [bp-28h]@1
  int v14; // [sp+24h] [bp-24h]@1
  int v15; // [sp+28h] [bp-20h]@1
  int v16; // [sp+2Ch] [bp-1Ch]@1
  int v17; // [sp+30h] [bp-18h]@1
  int v18; // [sp+34h] [bp-14h]@1
  int v19; // [sp+38h] [bp-10h]@1
  int v20; // [sp+3Ch] [bp-Ch]@1
  int v21; // [sp+40h] [bp-8h]@1
  unsigned __int8 v22; // [sp+47h] [bp-1h]@23

  v14 = 128;
  v15 = 112;
  v16 = 144;
  v17 = 128;
  v18 = 144;
  v19 = 112;
  v20 = 160;
  v21 = 128;
  v6 = 128;
  v7 = 128;
  v8 = 144;
  v9 = 144;
  v10 = 144;
  v11 = 128;
  v12 = 160;
  v13 = 144;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 122880
        && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 122880
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 98304
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 98304 )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 24) = 0;
      *(_DWORD *)(a1 + 28) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_12;
    case 0xB:
LABEL_12:
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 20;
      ++*(_DWORD *)(a1 + 100);
      if ( *(_DWORD *)(a1 + 120) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        if ( ++*(_DWORD *)(a1 + 104) > 1 )
          *(_DWORD *)(a1 + 104) = 0;
      }
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) + 163840
        || Quote.X_Pos < *(_DWORD *)(a1 + 8) - 163840
        || Quote.Y_Pos > *(_DWORD *)(a1 + 12) + 122880
        || Quote.Y_Pos < *(_DWORD *)(a1 + 12) - 122880 )
      {
        *(_DWORD *)(a1 + 116) = 0;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      v22 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
      v22 += Random(-3, 3);
      *(_DWORD *)(a1 + 28) = 2 * GetSin(v22);
      *(_DWORD *)(a1 + 24) = 2 * GetCos(v22);
      if ( *(_DWORD *)(a1 + 24) >= 0 )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_26;
    case 0x15:
LABEL_26:
      if ( *(_DWORD *)(a1 + 24) < 0 && *(_DWORD *)(a1 + 4) & 1 )
      {
        *(_DWORD *)(a1 + 76) = 2;
        *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
      }
      if ( *(_DWORD *)(a1 + 24) > 0 && *(_DWORD *)(a1 + 4) & 4 )
      {
        *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
      }
      if ( *(_DWORD *)(a1 + 28) < 0 && *(_DWORD *)(a1 + 4) & 2 )
        *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
      if ( *(_DWORD *)(a1 + 28) > 0 && *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
      if ( *(_DWORD *)(a1 + 4) & 0x100 )
        *(_DWORD *)(a1 + 28) = -512;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 28);
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 10;
      if ( ++*(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v14 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (00463710) --------------------------------------------------------
int __cdecl NPC309(int a1)
{
  int result; // eax@4
  int *v2; // eax@47
  int v3; // ecx@47
  int *v4; // eax@48
  int v5; // ecx@48
  int v6; // [sp+4h] [bp-40h]@1
  int v7; // [sp+8h] [bp-3Ch]@1
  int v8; // [sp+Ch] [bp-38h]@1
  int v9; // [sp+10h] [bp-34h]@1
  int v10; // [sp+14h] [bp-30h]@1
  int v11; // [sp+18h] [bp-2Ch]@1
  int v12; // [sp+1Ch] [bp-28h]@1
  int v13; // [sp+20h] [bp-24h]@1
  int v14; // [sp+24h] [bp-20h]@1
  int v15; // [sp+28h] [bp-1Ch]@1
  int v16; // [sp+2Ch] [bp-18h]@1
  int v17; // [sp+30h] [bp-14h]@1
  int v18; // [sp+34h] [bp-10h]@1
  int v19; // [sp+38h] [bp-Ch]@1
  int v20; // [sp+3Ch] [bp-8h]@1
  int v21; // [sp+40h] [bp-4h]@1

  v14 = 0;
  v15 = 0;
  v16 = 16;
  v17 = 16;
  v18 = 16;
  v19 = 0;
  v20 = 32;
  v21 = 16;
  v6 = 0;
  v7 = 16;
  v8 = 16;
  v9 = 32;
  v10 = 16;
  v11 = 16;
  v12 = 32;
  v13 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 76) )
      {
        result = *(_DWORD *)(a1 + 8) + 147456;
        if ( Quote.X_Pos >= result || Quote.X_Pos <= *(_DWORD *)(a1 + 8) + 139264 )
          return result;
        *(_DWORD *)(a1 + 116) = 10;
      }
      else
      {
        result = a1;
        if ( Quote.X_Pos <= *(_DWORD *)(a1 + 8) - 147456 )
          return result;
        result = *(_DWORD *)(a1 + 8) - 139264;
        if ( Quote.X_Pos >= result )
          return result;
        *(_DWORD *)(a1 + 116) = 10;
      }
LABEL_46:
      if ( *(_DWORD *)(a1 + 76) )
      {
        v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
        v5 = a1 + 84;
        *(_DWORD *)v5 = *v4;
        *(_DWORD *)(v5 + 4) = v4[1];
        *(_DWORD *)(v5 + 8) = v4[2];
        result = v4[3];
        *(_DWORD *)(v5 + 12) = result;
      }
      else
      {
        v2 = &v14 + 4 * *(_DWORD *)(a1 + 104);
        v3 = a1 + 84;
        *(_DWORD *)v3 = *v2;
        *(_DWORD *)(v3 + 4) = v2[1];
        *(_DWORD *)(v3 + 8) = v2[2];
        result = v2[3];
        *(_DWORD *)(v3 + 12) = result;
      }
      if ( *(_DWORD *)(a1 + 64) <= 996 )
      {
        *(_DWORD *)(a1 + 40) = 316;
        result = a1;
        *(_DWORD *)(a1 + 116) = 0;
      }
      return result;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_DWORD *)(a1 + 164) = 5;
      goto LABEL_13;
    case 0xB:
LABEL_13:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 24) += 16;
      else
        *(_DWORD *)(a1 + 24) -= 16;
      if ( *(_DWORD *)(a1 + 12) <= Quote.Y_Pos )
        *(_DWORD *)(a1 + 28) += 16;
      else
        *(_DWORD *)(a1 + 28) -= 16;
      if ( *(_DWORD *)(a1 + 24) < 0 && *(_DWORD *)(a1 + 4) & 1 )
        *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
      if ( *(_DWORD *)(a1 + 24) > 0 && *(_DWORD *)(a1 + 4) & 4 )
        *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
      if ( *(_DWORD *)(a1 + 28) < 0 && *(_DWORD *)(a1 + 4) & 2 )
        *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
      if ( *(_DWORD *)(a1 + 28) > 0 && *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
      if ( *(_DWORD *)(a1 + 24) < -1535 )
        *(_DWORD *)(a1 + 24) = -1535;
      if ( *(_DWORD *)(a1 + 24) > 1535 )
        *(_DWORD *)(a1 + 24) = 1535;
      if ( *(_DWORD *)(a1 + 28) < -1535 )
        *(_DWORD *)(a1 + 28) = -1535;
      if ( *(_DWORD *)(a1 + 28) > 1535 )
        *(_DWORD *)(a1 + 28) = 1535;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 28);
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_46;
    default:
      goto LABEL_46;
  }
}

//----- (00463AC0) --------------------------------------------------------
int __cdecl NPC310(int a1)
{
  int *v1; // edx@43
  int v2; // eax@43
  int *v3; // edx@44
  int v4; // eax@44
  int result; // eax@45
  int v6; // [sp+4h] [bp-A0h]@1
  int v7; // [sp+8h] [bp-9Ch]@1
  int v8; // [sp+Ch] [bp-98h]@1
  int v9; // [sp+10h] [bp-94h]@1
  int v10; // [sp+14h] [bp-90h]@1
  int v11; // [sp+18h] [bp-8Ch]@1
  int v12; // [sp+1Ch] [bp-88h]@1
  int v13; // [sp+20h] [bp-84h]@1
  int v14; // [sp+24h] [bp-80h]@1
  int v15; // [sp+28h] [bp-7Ch]@1
  int v16; // [sp+2Ch] [bp-78h]@1
  int v17; // [sp+30h] [bp-74h]@1
  int v18; // [sp+34h] [bp-70h]@1
  int v19; // [sp+38h] [bp-6Ch]@1
  int v20; // [sp+3Ch] [bp-68h]@1
  int v21; // [sp+40h] [bp-64h]@1
  int v22; // [sp+44h] [bp-60h]@1
  int v23; // [sp+48h] [bp-5Ch]@1
  int v24; // [sp+4Ch] [bp-58h]@1
  int v25; // [sp+50h] [bp-54h]@1
  int v26; // [sp+54h] [bp-50h]@1
  int v27; // [sp+58h] [bp-4Ch]@1
  int v28; // [sp+5Ch] [bp-48h]@1
  int v29; // [sp+60h] [bp-44h]@1
  int v30; // [sp+64h] [bp-40h]@1
  int v31; // [sp+68h] [bp-3Ch]@1
  int v32; // [sp+6Ch] [bp-38h]@1
  int v33; // [sp+70h] [bp-34h]@1
  int v34; // [sp+74h] [bp-30h]@1
  int v35; // [sp+78h] [bp-2Ch]@1
  int v36; // [sp+7Ch] [bp-28h]@1
  int v37; // [sp+80h] [bp-24h]@1
  int v38; // [sp+84h] [bp-20h]@1
  int v39; // [sp+88h] [bp-1Ch]@1
  int v40; // [sp+8Ch] [bp-18h]@1
  int v41; // [sp+90h] [bp-14h]@1
  int v42; // [sp+94h] [bp-10h]@1
  int v43; // [sp+98h] [bp-Ch]@1
  int v44; // [sp+9Ch] [bp-8h]@1
  int v45; // [sp+A0h] [bp-4h]@1

  v26 = 32;
  v27 = 0;
  v28 = 56;
  v29 = 16;
  v30 = 56;
  v31 = 0;
  v32 = 80;
  v33 = 16;
  v34 = 80;
  v35 = 0;
  v36 = 104;
  v37 = 16;
  v38 = 104;
  v39 = 0;
  v40 = 128;
  v41 = 16;
  v42 = 128;
  v43 = 0;
  v44 = 152;
  v45 = 16;
  v6 = 32;
  v7 = 16;
  v8 = 56;
  v9 = 32;
  v10 = 56;
  v11 = 16;
  v12 = 80;
  v13 = 32;
  v14 = 80;
  v15 = 16;
  v16 = 104;
  v17 = 32;
  v18 = 104;
  v19 = 16;
  v20 = 128;
  v21 = 32;
  v22 = 128;
  v23 = 16;
  v24 = 152;
  v25 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 4u;
      *(_DWORD *)(a1 + 164) = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 0x10000
        && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 0x10000
        && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 0x10000
        && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x2000 )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 4u;
      *(_DWORD *)(a1 + 164) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_13;
    case 0xB:
LABEL_13:
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_DWORD *)(a1 + 164) = 0;
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      goto LABEL_19;
    case 0x15:
LABEL_19:
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 16) = 1024;
      else
        *(_DWORD *)(a1 + 16) = -1024;
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 1 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 10;
      if ( *(_DWORD *)(a1 + 8) < Quote.X_Pos + 20480 && *(_DWORD *)(a1 + 8) > Quote.X_Pos - 20480 )
      {
        *(_DWORD *)(a1 + 20) = -768;
        *(_DWORD *)(a1 + 16) /= 2;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 116) = 30;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
      }
      break;
    case 0x1E:
      if ( *(_DWORD *)(a1 + 20) > -128 )
      {
        *(_DWORD *)(a1 + 116) = 31;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 104) = 3;
        *(_DWORD *)(a1 + 164) = 9;
      }
      break;
    case 0x1F:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 104) = 4;
      }
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 116) = 32;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 164) = 3;
      }
      break;
    case 0x20:
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 164) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 20) += 32;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v4 = a1 + 84;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    *(_DWORD *)(v4 + 8) = v3[2];
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  else
  {
    v1 = &v26 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  result = a1;
  if ( *(_DWORD *)(a1 + 64) <= 996 )
  {
    *(_DWORD *)(a1 + 40) = 316;
    *(_DWORD *)(a1 + 116) = 0;
  }
  return result;
}

//----- (00464090) --------------------------------------------------------
int __cdecl NPC311(int a1)
{
  int *v1; // eax@58
  int v2; // ecx@58
  int result; // eax@58
  int *v4; // eax@59
  int v5; // ecx@59
  int v6; // [sp+4h] [bp-E0h]@1
  int v7; // [sp+8h] [bp-DCh]@1
  int v8; // [sp+Ch] [bp-D8h]@1
  int v9; // [sp+10h] [bp-D4h]@1
  int v10; // [sp+14h] [bp-D0h]@1
  int v11; // [sp+18h] [bp-CCh]@1
  int v12; // [sp+1Ch] [bp-C8h]@1
  int v13; // [sp+20h] [bp-C4h]@1
  int v14; // [sp+24h] [bp-C0h]@1
  int v15; // [sp+28h] [bp-BCh]@1
  int v16; // [sp+2Ch] [bp-B8h]@1
  int v17; // [sp+30h] [bp-B4h]@1
  int v18; // [sp+34h] [bp-B0h]@1
  int v19; // [sp+38h] [bp-ACh]@1
  int v20; // [sp+3Ch] [bp-A8h]@1
  int v21; // [sp+40h] [bp-A4h]@1
  int v22; // [sp+44h] [bp-A0h]@1
  int v23; // [sp+48h] [bp-9Ch]@1
  int v24; // [sp+4Ch] [bp-98h]@1
  int v25; // [sp+50h] [bp-94h]@1
  int v26; // [sp+54h] [bp-90h]@1
  int v27; // [sp+58h] [bp-8Ch]@1
  int v28; // [sp+5Ch] [bp-88h]@1
  int v29; // [sp+60h] [bp-84h]@1
  int v30; // [sp+64h] [bp-80h]@1
  int v31; // [sp+68h] [bp-7Ch]@1
  int v32; // [sp+6Ch] [bp-78h]@1
  int v33; // [sp+70h] [bp-74h]@1
  int v34; // [sp+74h] [bp-70h]@1
  int v35; // [sp+78h] [bp-6Ch]@1
  int v36; // [sp+7Ch] [bp-68h]@1
  int v37; // [sp+80h] [bp-64h]@1
  int v38; // [sp+84h] [bp-60h]@1
  int v39; // [sp+88h] [bp-5Ch]@1
  int v40; // [sp+8Ch] [bp-58h]@1
  int v41; // [sp+90h] [bp-54h]@1
  int v42; // [sp+94h] [bp-50h]@1
  int v43; // [sp+98h] [bp-4Ch]@1
  int v44; // [sp+9Ch] [bp-48h]@1
  int v45; // [sp+A0h] [bp-44h]@1
  int v46; // [sp+A4h] [bp-40h]@1
  int v47; // [sp+A8h] [bp-3Ch]@1
  int v48; // [sp+ACh] [bp-38h]@1
  int v49; // [sp+B0h] [bp-34h]@1
  int v50; // [sp+B4h] [bp-30h]@1
  int v51; // [sp+B8h] [bp-2Ch]@1
  int v52; // [sp+BCh] [bp-28h]@1
  int v53; // [sp+C0h] [bp-24h]@1
  int v54; // [sp+C4h] [bp-20h]@1
  int v55; // [sp+C8h] [bp-1Ch]@1
  int v56; // [sp+CCh] [bp-18h]@1
  int v57; // [sp+D0h] [bp-14h]@1
  int v58; // [sp+D4h] [bp-10h]@1
  int v59; // [sp+D8h] [bp-Ch]@1
  int v60; // [sp+DCh] [bp-8h]@1
  int v61; // [sp+E0h] [bp-4h]@1

  v34 = 0;
  v35 = 32;
  v36 = 24;
  v37 = 56;
  v38 = 24;
  v39 = 32;
  v40 = 48;
  v41 = 56;
  v42 = 48;
  v43 = 32;
  v44 = 72;
  v45 = 56;
  v46 = 72;
  v47 = 32;
  v48 = 96;
  v49 = 56;
  v50 = 96;
  v51 = 32;
  v52 = 120;
  v53 = 56;
  v54 = 120;
  v55 = 32;
  v56 = 144;
  v57 = 56;
  v58 = 144;
  v59 = 32;
  v60 = 168;
  v61 = 56;
  v6 = 0;
  v7 = 56;
  v8 = 24;
  v9 = 80;
  v10 = 24;
  v11 = 56;
  v12 = 48;
  v13 = 80;
  v14 = 48;
  v15 = 56;
  v16 = 72;
  v17 = 80;
  v18 = 72;
  v19 = 56;
  v20 = 96;
  v21 = 80;
  v22 = 96;
  v23 = 56;
  v24 = 120;
  v25 = 80;
  v26 = 120;
  v27 = 56;
  v28 = 144;
  v29 = 80;
  v30 = 144;
  v31 = 56;
  v32 = 168;
  v33 = 80;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( *(_DWORD *)(a1 + 76) )
      {
        if ( Quote.X_Pos > *(_DWORD *)(a1 + 8)
          && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
          && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 81920
          && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 81920 )
        {
          *(_DWORD *)(a1 + 116) = 10;
        }
      }
      else if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
             && Quote.X_Pos < *(_DWORD *)(a1 + 8)
             && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 81920
             && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 81920 )
      {
        *(_DWORD *)(a1 + 116) = 10;
      }
      break;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      goto LABEL_17;
    case 0xB:
LABEL_17:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( Quote.X_Pos <= *(_DWORD *)(a1 + 8) - 114688
        || Quote.X_Pos >= *(_DWORD *)(a1 + 8) + 114688
        || Quote.Y_Pos <= *(_DWORD *)(a1 + 12) - 4096 )
      {
        *(_DWORD *)(a1 + 104) = 4;
        *(_DWORD *)(a1 + 108) = 1;
      }
      else
      {
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 108) = 0;
      }
      if ( ++*(_DWORD *)(a1 + 120) > 10 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_29;
    case 0x15:
LABEL_29:
      if ( *(_DWORD *)(a1 + 108) )
      {
        if ( ++*(_DWORD *)(a1 + 104) > 5 )
          *(_DWORD *)(a1 + 104) = 4;
      }
      else if ( ++*(_DWORD *)(a1 + 104) > 2 )
      {
        *(_DWORD *)(a1 + 104) = 1;
      }
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 30;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 0;
      if ( *(_DWORD *)(a1 + 108) )
      {
        if ( *(_DWORD *)(a1 + 76) )
          NPC_Create((NPC_Names)312, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 1536, -1536, Right, NULL, 256);
        else
          NPC_Create((NPC_Names)312, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), -1536, -1536, 0, NULL, 256);
        *(_DWORD *)(a1 + 104) = 6;
      }
      else
      {
        if ( *(_DWORD *)(a1 + 76) )
          NPC_Create((NPC_Names)312, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 1536, 0, Right, NULL, 256);
        else
          NPC_Create((NPC_Names)312, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), -1536, 0, 0, NULL, 256);
        *(_DWORD *)(a1 + 104) = 3;
      }
      goto LABEL_47;
    case 0x1F:
LABEL_47:
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
      {
        *(_DWORD *)(a1 + 116) = 40;
        *(_DWORD *)(a1 + 120) = Random(0, 100);
      }
      break;
    case 0x28:
      *(_DWORD *)(a1 + 104) = 0;
      if ( ++*(_DWORD *)(a1 + 120) > 150 )
        *(_DWORD *)(a1 + 116) = 10;
      if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) - 180224
        || Quote.X_Pos > *(_DWORD *)(a1 + 8) + 180224
        || Quote.Y_Pos < *(_DWORD *)(a1 + 12) - 122880
        || Quote.Y_Pos > *(_DWORD *)(a1 + 12) + 122880 )
      {
        *(_DWORD *)(a1 + 116) = 40;
        *(_DWORD *)(a1 + 120) = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v34 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  if ( *(_DWORD *)(a1 + 64) <= 992 )
  {
    *(_DWORD *)(a1 + 40) = 316;
    result = a1;
    *(_DWORD *)(a1 + 116) = 0;
  }
  return result;
}

//----- (00464740) --------------------------------------------------------
int __cdecl NPC312(int a1)
{
  int result; // eax@28
  int *v2; // eax@33
  int v3; // ecx@33
  int *v4; // eax@34
  int v5; // ecx@34
  int v6; // [sp+4h] [bp-A0h]@1
  int v7; // [sp+8h] [bp-9Ch]@1
  int v8; // [sp+Ch] [bp-98h]@1
  int v9; // [sp+10h] [bp-94h]@1
  int v10; // [sp+14h] [bp-90h]@1
  int v11; // [sp+18h] [bp-8Ch]@1
  int v12; // [sp+1Ch] [bp-88h]@1
  int v13; // [sp+20h] [bp-84h]@1
  int v14; // [sp+24h] [bp-80h]@1
  int v15; // [sp+28h] [bp-7Ch]@1
  int v16; // [sp+2Ch] [bp-78h]@1
  int v17; // [sp+30h] [bp-74h]@1
  int v18; // [sp+34h] [bp-70h]@1
  int v19; // [sp+38h] [bp-6Ch]@1
  int v20; // [sp+3Ch] [bp-68h]@1
  int v21; // [sp+40h] [bp-64h]@1
  int v22; // [sp+44h] [bp-60h]@1
  int v23; // [sp+48h] [bp-5Ch]@1
  int v24; // [sp+4Ch] [bp-58h]@1
  int v25; // [sp+50h] [bp-54h]@1
  int v26; // [sp+54h] [bp-50h]@1
  int v27; // [sp+58h] [bp-4Ch]@1
  int v28; // [sp+5Ch] [bp-48h]@1
  int v29; // [sp+60h] [bp-44h]@1
  int v30; // [sp+64h] [bp-40h]@1
  int v31; // [sp+68h] [bp-3Ch]@1
  int v32; // [sp+6Ch] [bp-38h]@1
  int v33; // [sp+70h] [bp-34h]@1
  int v34; // [sp+74h] [bp-30h]@1
  int v35; // [sp+78h] [bp-2Ch]@1
  int v36; // [sp+7Ch] [bp-28h]@1
  int v37; // [sp+80h] [bp-24h]@1
  int v38; // [sp+84h] [bp-20h]@1
  int v39; // [sp+88h] [bp-1Ch]@1
  int v40; // [sp+8Ch] [bp-18h]@1
  int v41; // [sp+90h] [bp-14h]@1
  int v42; // [sp+94h] [bp-10h]@1
  int v43; // [sp+98h] [bp-Ch]@1
  int v44; // [sp+9Ch] [bp-8h]@1
  int v45; // [sp+A0h] [bp-4h]@1

  v26 = 0;
  v27 = 160;
  v28 = 16;
  v29 = 176;
  v30 = 16;
  v31 = 160;
  v32 = 32;
  v33 = 176;
  v34 = 32;
  v35 = 160;
  v36 = 48;
  v37 = 176;
  v38 = 48;
  v39 = 160;
  v40 = 64;
  v41 = 176;
  v42 = 64;
  v43 = 160;
  v44 = 80;
  v45 = 176;
  v6 = 0;
  v7 = 176;
  v8 = 16;
  v9 = 192;
  v10 = 16;
  v11 = 176;
  v12 = 32;
  v13 = 192;
  v14 = 32;
  v15 = 176;
  v16 = 48;
  v17 = 192;
  v18 = 48;
  v19 = 176;
  v20 = 64;
  v21 = 192;
  v22 = 64;
  v23 = 176;
  v24 = 80;
  v25 = 192;
  if ( *(_DWORD *)(a1 + 116) > 0 && *(_DWORD *)(a1 + 116) < 20 && *(_DWORD *)(a1 + 4) & 0xFF )
    *(_DWORD *)(a1 + 116) = 20;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = 0;
      if ( *(_DWORD *)(a1 + 16) >= 0 )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( *(_DWORD *)(a1 + 20) >= 0 )
        *(_DWORD *)(a1 + 104) = 2;
      else
        *(_DWORD *)(a1 + 104) = 0;
      goto LABEL_12;
    case 1:
LABEL_12:
      if ( ++*(_DWORD *)(a1 + 120) == 4 )
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
      if ( *(_DWORD *)(a1 + 120) > 10 )
        *(_DWORD *)(a1 + 116) = 10;
      goto LABEL_30;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 16) = 3 * *(_DWORD *)(a1 + 16) / 4;
      *(_DWORD *)(a1 + 20) = 3 * *(_DWORD *)(a1 + 20) / 4;
      goto LABEL_18;
    case 0xB:
LABEL_18:
      *(_DWORD *)(a1 + 20) += 32;
      if ( ++*(_DWORD *)(a1 + 100) > 10 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 4;
      goto LABEL_30;
    case 0x14:
      *(_DWORD *)(a1 + 116) = 21;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      *(_DWORD *)(a1 + 164) = 0;
      goto LABEL_24;
    case 0x15:
LABEL_24:
      if ( ++*(_DWORD *)(a1 + 120) > 30 )
        *(_DWORD *)(a1 + 116) = 30;
      goto LABEL_30;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_28;
    case 0x1F:
LABEL_28:
      ++*(_DWORD *)(a1 + 120);
      result = a1;
      if ( *(_DWORD *)(a1 + 120) <= 30 )
        goto LABEL_30;
      *(_BYTE *)a1 = 0;
      break;
    default:
LABEL_30:
      if ( *(_DWORD *)(a1 + 20) > 1535 )
        *(_DWORD *)(a1 + 20) = 1535;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 76) )
      {
        v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
        v5 = a1 + 84;
        *(_DWORD *)v5 = *v4;
        *(_DWORD *)(v5 + 4) = v4[1];
        *(_DWORD *)(v5 + 8) = v4[2];
        result = v4[3];
        *(_DWORD *)(v5 + 12) = result;
      }
      else
      {
        v2 = &v26 + 4 * *(_DWORD *)(a1 + 104);
        v3 = a1 + 84;
        *(_DWORD *)v3 = *v2;
        *(_DWORD *)(v3 + 4) = v2[1];
        *(_DWORD *)(v3 + 8) = v2[2];
        result = v2[3];
        *(_DWORD *)(v3 + 12) = result;
      }
      if ( *(_DWORD *)(a1 + 116) == 31 )
      {
        result = *(_DWORD *)(a1 + 120) / 2 % 2;
        if ( result )
        {
          result = a1;
          *(_DWORD *)(a1 + 84) = 0;
          *(_DWORD *)(a1 + 92) = 0;
        }
      }
      break;
  }
  return result;
}

//----- (00464BB0) --------------------------------------------------------
int __cdecl NPC313(int a1)
{
  int v1; // eax@75
  int v2; // eax@103
  int *v3; // edx@121
  int result; // eax@121
  int *v5; // edx@122
  signed int v6; // [sp+0h] [bp-1C4h]@1
  int v7; // [sp+4h] [bp-1C0h]@1
  int v8; // [sp+8h] [bp-1BCh]@1
  int v9; // [sp+Ch] [bp-1B8h]@1
  int v10; // [sp+10h] [bp-1B4h]@1
  int v11; // [sp+14h] [bp-1B0h]@1
  int v12; // [sp+18h] [bp-1ACh]@1
  int v13; // [sp+1Ch] [bp-1A8h]@1
  int v14; // [sp+20h] [bp-1A4h]@1
  int v15; // [sp+24h] [bp-1A0h]@1
  int v16; // [sp+28h] [bp-19Ch]@1
  int v17; // [sp+2Ch] [bp-198h]@1
  int v18; // [sp+30h] [bp-194h]@1
  int v19; // [sp+34h] [bp-190h]@1
  int v20; // [sp+38h] [bp-18Ch]@1
  int v21; // [sp+3Ch] [bp-188h]@1
  int v22; // [sp+40h] [bp-184h]@1
  int v23; // [sp+44h] [bp-180h]@1
  int v24; // [sp+48h] [bp-17Ch]@1
  int v25; // [sp+4Ch] [bp-178h]@1
  int v26; // [sp+50h] [bp-174h]@1
  int v27; // [sp+54h] [bp-170h]@1
  int v28; // [sp+58h] [bp-16Ch]@1
  int v29; // [sp+5Ch] [bp-168h]@1
  int v30; // [sp+60h] [bp-164h]@1
  int v31; // [sp+64h] [bp-160h]@1
  int v32; // [sp+68h] [bp-15Ch]@1
  int v33; // [sp+6Ch] [bp-158h]@1
  int v34; // [sp+70h] [bp-154h]@1
  int v35; // [sp+74h] [bp-150h]@1
  int v36; // [sp+78h] [bp-14Ch]@1
  int v37; // [sp+7Ch] [bp-148h]@1
  int v38; // [sp+80h] [bp-144h]@1
  int v39; // [sp+84h] [bp-140h]@1
  int v40; // [sp+88h] [bp-13Ch]@1
  int v41; // [sp+8Ch] [bp-138h]@1
  int v42; // [sp+90h] [bp-134h]@1
  int v43; // [sp+94h] [bp-130h]@1
  int v44; // [sp+98h] [bp-12Ch]@1
  int v45; // [sp+9Ch] [bp-128h]@1
  int v46; // [sp+A0h] [bp-124h]@1
  int v47; // [sp+A4h] [bp-120h]@1
  int v48; // [sp+A8h] [bp-11Ch]@1
  int v49; // [sp+ACh] [bp-118h]@1
  int v50; // [sp+B0h] [bp-114h]@1
  int v51; // [sp+B4h] [bp-110h]@1
  int v52; // [sp+B8h] [bp-10Ch]@1
  int v53; // [sp+BCh] [bp-108h]@1
  int v54; // [sp+C0h] [bp-104h]@1
  int v55; // [sp+C4h] [bp-100h]@1
  int v56; // [sp+C8h] [bp-FCh]@1
  int v57; // [sp+CCh] [bp-F8h]@1
  int v58; // [sp+D0h] [bp-F4h]@1
  int v59; // [sp+D4h] [bp-F0h]@1
  int v60; // [sp+D8h] [bp-ECh]@1
  int v61; // [sp+DCh] [bp-E8h]@1
  int v62; // [sp+E0h] [bp-E4h]@1
  int v63; // [sp+E4h] [bp-E0h]@1
  int v64; // [sp+E8h] [bp-DCh]@1
  int v65; // [sp+ECh] [bp-D8h]@1
  int v66; // [sp+F0h] [bp-D4h]@1
  int v67; // [sp+F4h] [bp-D0h]@1
  int v68; // [sp+F8h] [bp-CCh]@1
  int v69; // [sp+FCh] [bp-C8h]@1
  int v70; // [sp+100h] [bp-C4h]@1
  int v71; // [sp+104h] [bp-C0h]@1
  int v72; // [sp+108h] [bp-BCh]@1
  int v73; // [sp+10Ch] [bp-B8h]@1
  int v74; // [sp+110h] [bp-B4h]@1
  int v75; // [sp+114h] [bp-B0h]@1
  int v76; // [sp+118h] [bp-ACh]@1
  int v77; // [sp+11Ch] [bp-A8h]@1
  int v78; // [sp+120h] [bp-A4h]@1
  int v79; // [sp+124h] [bp-A0h]@1
  int v80; // [sp+128h] [bp-9Ch]@1
  int v81; // [sp+12Ch] [bp-98h]@1
  int v82; // [sp+130h] [bp-94h]@1
  int v83; // [sp+134h] [bp-90h]@1
  int v84; // [sp+138h] [bp-8Ch]@1
  int v85; // [sp+13Ch] [bp-88h]@1
  int v86; // [sp+140h] [bp-84h]@1
  int v87; // [sp+144h] [bp-80h]@1
  int v88; // [sp+148h] [bp-7Ch]@1
  int v89; // [sp+14Ch] [bp-78h]@1
  int v90; // [sp+150h] [bp-74h]@1
  int v91; // [sp+154h] [bp-70h]@1
  int v92; // [sp+158h] [bp-6Ch]@1
  int v93; // [sp+15Ch] [bp-68h]@1
  int v94; // [sp+160h] [bp-64h]@1
  int v95; // [sp+164h] [bp-60h]@1
  int v96; // [sp+168h] [bp-5Ch]@1
  int v97; // [sp+16Ch] [bp-58h]@1
  int v98; // [sp+170h] [bp-54h]@1
  int v99; // [sp+174h] [bp-50h]@1
  int v100; // [sp+178h] [bp-4Ch]@1
  int v101; // [sp+17Ch] [bp-48h]@1
  int v102; // [sp+180h] [bp-44h]@1
  int v103; // [sp+184h] [bp-40h]@1
  int v104; // [sp+188h] [bp-3Ch]@1
  int v105; // [sp+18Ch] [bp-38h]@1
  int v106; // [sp+190h] [bp-34h]@1
  int v107; // [sp+194h] [bp-30h]@1
  int v108; // [sp+198h] [bp-2Ch]@1
  int v109; // [sp+19Ch] [bp-28h]@1
  int v110; // [sp+1A0h] [bp-24h]@1
  int v111; // [sp+1A4h] [bp-20h]@1
  int v112; // [sp+1A8h] [bp-1Ch]@1
  int v113; // [sp+1ACh] [bp-18h]@1
  int v114; // [sp+1B0h] [bp-14h]@1
  int v115; // [sp+1B4h] [bp-10h]@1
  int v116; // [sp+1B8h] [bp-Ch]@1
  int v117; // [sp+1BCh] [bp-8h]@1
  int v118; // [sp+1C0h] [bp-4h]@1

  v63 = 128;
  v64 = 0;
  v65 = 144;
  v66 = 16;
  v67 = 144;
  v68 = 0;
  v69 = 160;
  v70 = 16;
  v71 = 160;
  v72 = 0;
  v73 = 176;
  v74 = 16;
  v75 = 176;
  v76 = 0;
  v77 = 192;
  v78 = 16;
  v79 = 192;
  v80 = 0;
  v81 = 208;
  v82 = 16;
  v83 = 208;
  v84 = 0;
  v85 = 224;
  v86 = 16;
  v87 = 224;
  v88 = 0;
  v89 = 240;
  v90 = 16;
  v91 = 240;
  v92 = 0;
  v93 = 256;
  v94 = 16;
  v95 = 256;
  v96 = 0;
  v97 = 272;
  v98 = 16;
  v99 = 272;
  v100 = 0;
  v101 = 288;
  v102 = 16;
  v103 = 288;
  v104 = 0;
  v105 = 304;
  v106 = 16;
  v107 = 128;
  v108 = 0;
  v109 = 144;
  v110 = 16;
  v111 = 176;
  v112 = 0;
  v113 = 192;
  v114 = 16;
  v115 = 304;
  v116 = 0;
  v117 = 320;
  v118 = 16;
  v7 = 128;
  v8 = 16;
  v9 = 144;
  v10 = 32;
  v11 = 144;
  v12 = 16;
  v13 = 160;
  v14 = 32;
  v15 = 160;
  v16 = 16;
  v17 = 176;
  v18 = 32;
  v19 = 176;
  v20 = 16;
  v21 = 192;
  v22 = 32;
  v23 = 192;
  v24 = 16;
  v25 = 208;
  v26 = 32;
  v27 = 208;
  v28 = 16;
  v29 = 224;
  v30 = 32;
  v31 = 224;
  v32 = 16;
  v33 = 240;
  v34 = 32;
  v35 = 240;
  v36 = 16;
  v37 = 256;
  v38 = 32;
  v39 = 256;
  v40 = 16;
  v41 = 272;
  v42 = 32;
  v43 = 272;
  v44 = 16;
  v45 = 288;
  v46 = 32;
  v47 = 288;
  v48 = 16;
  v49 = 304;
  v50 = 32;
  v51 = 128;
  v52 = 16;
  v53 = 144;
  v54 = 32;
  v55 = 176;
  v56 = 16;
  v57 = 192;
  v58 = 32;
  v59 = 304;
  v60 = 16;
  v61 = 320;
  v62 = 32;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 > 220 )
  {
    if ( v6 > 320 )
    {
      switch ( v6 )
      {
        case 330:
          *(_DWORD *)(a1 + 20) = 0;
          *(_DWORD *)(a1 + 116) = 331;
          *(_DWORD *)(a1 + 120) = 0;
          Set_Quake(16);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
          goto LABEL_100;
        case 331:
LABEL_100:
          if ( ++*(_DWORD *)(a1 + 104) > 13 )
            *(_DWORD *)(a1 + 104) = 12;
          if ( !(++*(_DWORD *)(a1 + 120) % 6) )
          {
            v2 = Random(4, 16);
            NPC_Create((NPC_Names)315, v2 << 13, 0, 0, 0, 0, NULL, 256);
          }
          if ( *(_DWORD *)(a1 + 120) > 30 )
          {
            *(_DWORD *)(a1 + 108) = 0;
            *(_DWORD *)(a1 + 116) = 130;
            *(_WORD *)(a1 + 80) |= 0x20u;
            *(_WORD *)(a1 + 80) &= 0xFFFBu;
            *(_DWORD *)(a1 + 164) = 3;
          }
          break;
        case 500:
          *(_WORD *)(a1 + 80) &= 0xFFDFu;
          *(_DWORD *)(a1 + 116) = 501;
          *(_DWORD *)(a1 + 120) = 0;
          *(_DWORD *)(a1 + 104) = 8;
          *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
          *(_DWORD *)(a1 + 164) = 0;
          Kill_NPC(315, 1);
          goto LABEL_108;
        case 501:
LABEL_108:
          *(_DWORD *)(a1 + 20) += 32;
          if ( ++*(_DWORD *)(a1 + 120) % 2 )
            *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
          else
            *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + 512;
          break;
        default:
          break;
      }
    }
    else if ( v6 == 320 )
    {
      if ( ++*(_DWORD *)(a1 + 104) > 13 )
        *(_DWORD *)(a1 + 104) = 12;
      if ( *(_DWORD *)(a1 + 12) < 0x2000 )
        *(_DWORD *)(a1 + 116) = 330;
    }
    else
    {
      switch ( v6 )
      {
        case 221:
          goto LABEL_72;
        case 300:
          *(_DWORD *)(a1 + 116) = 301;
          *(_DWORD *)(a1 + 104) = 9;
          if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
            *(_DWORD *)(a1 + 76) = 2;
          else
            *(_DWORD *)(a1 + 76) = 0;
          goto LABEL_82;
        case 301:
LABEL_82:
          if ( ++*(_DWORD *)(a1 + 104) > 11 )
            *(_DWORD *)(a1 + 104) = 9;
          if ( *(_DWORD *)(a1 + 76) )
            *(_DWORD *)(a1 + 16) = 1024;
          else
            *(_DWORD *)(a1 + 16) = -1024;
          if ( Quote.X_Pos > *(_DWORD *)(a1 + 8) - 2048 && Quote.X_Pos < *(_DWORD *)(a1 + 8) + 2048 )
          {
            *(_DWORD *)(a1 + 116) = 310;
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 104) = 2;
            *(_DWORD *)(a1 + 16) = 0;
          }
          break;
        case 310:
          *(_DWORD *)(a1 + 104) = 2;
          if ( ++*(_DWORD *)(a1 + 120) > 4 )
          {
            *(_DWORD *)(a1 + 116) = 320;
            *(_DWORD *)(a1 + 104) = 12;
            *(_DWORD *)(a1 + 20) = -2048;
            Play_Sound_Effect(Sfx_Silly_Explosion, 1);
            *(_WORD *)(a1 + 80) |= 8u;
            *(_WORD *)(a1 + 80) &= 0xFFDFu;
            *(_WORD *)(a1 + 80) |= 4u;
            *(_DWORD *)(a1 + 164) = 10;
          }
          break;
        default:
          break;
      }
    }
  }
  else if ( v6 == 220 )
  {
    *(_DWORD *)(a1 + 116) = 221;
    *(_DWORD *)(a1 + 120) = 0;
    Set_Quake(16);
    Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
    *(_DWORD *)(a1 + 164) = 4;
LABEL_72:
    if ( ++*(_DWORD *)(a1 + 104) > 7 )
      *(_DWORD *)(a1 + 104) = 6;
    if ( !(++*(_DWORD *)(a1 + 120) % 6) )
    {
      v1 = Random(4, 16);
      NPC_Create((NPC_Names)314, v1 << 13, 0x2000, 0, 0, 0, NULL, 256);
    }
    if ( *(_DWORD *)(a1 + 120) > 30 )
    {
      *(_DWORD *)(a1 + 108) = 0;
      *(_DWORD *)(a1 + 116) = 130;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
      *(_DWORD *)(a1 + 164) = 3;
    }
  }
  else
  {
    switch ( v6 )
    {
      case 0:
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 12) += 2048;
        goto LABEL_9;
      case 1:
LABEL_9:
        *(_DWORD *)(a1 + 20) += 64;
        if ( Random(0, 120) == 10 )
        {
          *(_DWORD *)(a1 + 116) = 2;
          *(_DWORD *)(a1 + 120) = 0;
          *(_DWORD *)(a1 + 104) = 1;
        }
        if ( *(_DWORD *)(a1 + 8) - 0x4000 < Quote.X_Pos && *(_DWORD *)(a1 + 8) + 0x4000 > Quote.X_Pos )
        {
          if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
            *(_DWORD *)(a1 + 76) = 2;
          else
            *(_DWORD *)(a1 + 76) = 0;
        }
        break;
      case 2:
        if ( ++*(_DWORD *)(a1 + 120) > 8 )
        {
          *(_DWORD *)(a1 + 116) = 1;
          *(_DWORD *)(a1 + 104) = 0;
        }
        break;
      case 100:
        *(_DWORD *)(a1 + 116) = 110;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 108) = 0;
        *(_WORD *)(a1 + 80) |= 0x20u;
        goto LABEL_21;
      case 110:
LABEL_21:
        *(_DWORD *)(a1 + 164) = 1;
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
        *(_DWORD *)(a1 + 104) = 0;
        if ( ++*(_DWORD *)(a1 + 120) > 4 )
        {
          *(_DWORD *)(a1 + 120) = 0;
          *(_DWORD *)(a1 + 116) = 120;
          if ( ++*(_DWORD *)(a1 + 112) > 12 )
          {
            *(_DWORD *)(a1 + 112) = 0;
            *(_DWORD *)(a1 + 116) = 300;
          }
        }
        break;
      case 120:
        *(_DWORD *)(a1 + 104) = 2;
        if ( ++*(_DWORD *)(a1 + 120) > 4 )
        {
          *(_DWORD *)(a1 + 116) = 130;
          *(_DWORD *)(a1 + 104) = 3;
          *(_DWORD *)(a1 + 16) = 2 * Random(-512, 512);
          *(_DWORD *)(a1 + 20) = -2048;
          Play_Sound_Effect(Sfx_Critter_Hop, 1);
          ++*(_DWORD *)(a1 + 108);
        }
        break;
      case 130:
        *(_DWORD *)(a1 + 20) += 128;
        if ( *(_DWORD *)(a1 + 12) > 0x10000 )
          *(_WORD *)(a1 + 80) &= 0xFFF7u;
        if ( *(_DWORD *)(a1 + 16) < 0 && *(_DWORD *)(a1 + 4) & 1 )
          *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
        if ( *(_DWORD *)(a1 + 16) > 0 && *(_DWORD *)(a1 + 4) & 4 )
          *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
          *(_DWORD *)(a1 + 76) = 2;
        else
          *(_DWORD *)(a1 + 76) = 0;
        if ( *(_DWORD *)(a1 + 20) >= -512 )
        {
          if ( *(_DWORD *)(a1 + 20) <= 512 )
            *(_DWORD *)(a1 + 104) = 0;
          else
            *(_DWORD *)(a1 + 104) = 4;
        }
        else
        {
          *(_DWORD *)(a1 + 104) = 3;
        }
        if ( *(_DWORD *)(a1 + 4) & 8 )
        {
          *(_DWORD *)(a1 + 116) = 140;
          *(_DWORD *)(a1 + 120) = 0;
          *(_DWORD *)(a1 + 104) = 2;
          *(_DWORD *)(a1 + 16) = 0;
        }
        if ( *(_DWORD *)(a1 + 108) > 4 && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 2048 )
        {
          *(_DWORD *)(a1 + 116) = 200;
          *(_DWORD *)(a1 + 120) = 0;
          *(_DWORD *)(a1 + 16) = 0;
          *(_DWORD *)(a1 + 20) = 0;
        }
        break;
      case 140:
        *(_DWORD *)(a1 + 104) = 2;
        if ( ++*(_DWORD *)(a1 + 120) > 4 )
          *(_DWORD *)(a1 + 116) = 110;
        break;
      case 200:
        *(_DWORD *)(a1 + 104) = 5;
        if ( ++*(_DWORD *)(a1 + 120) > 10 )
        {
          *(_DWORD *)(a1 + 116) = 210;
          *(_DWORD *)(a1 + 104) = 6;
          if ( *(_DWORD *)(a1 + 76) )
            *(_DWORD *)(a1 + 16) = 1535;
          else
            *(_DWORD *)(a1 + 16) = -1535;
          Play_Sound_Effect(Sfx_Silly_Explosion, 1);
          *(_WORD *)(a1 + 80) &= 0xFFDFu;
          *(_WORD *)(a1 + 80) |= 4u;
          *(_DWORD *)(a1 + 164) = 10;
        }
        break;
      case 210:
        if ( ++*(_DWORD *)(a1 + 104) > 7 )
          *(_DWORD *)(a1 + 104) = 6;
        if ( *(_DWORD *)(a1 + 16) < 0 && *(_DWORD *)(a1 + 4) & 1 )
          *(_DWORD *)(a1 + 116) = 220;
        if ( *(_DWORD *)(a1 + 16) > 0 && *(_DWORD *)(a1 + 4) & 4 )
          *(_DWORD *)(a1 + 116) = 220;
        break;
      default:
        break;
    }
  }
  if ( *(_DWORD *)(a1 + 116) > 100
    && *(_DWORD *)(a1 + 116) < 500
    && *(_DWORD *)(a1 + 116) != 210
    && *(_DWORD *)(a1 + 116) != 320 )
  {
    if ( Is_some_bullet_active() )
    {
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_WORD *)(a1 + 80) |= 4u;
    }
    else
    {
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFFBu;
    }
  }
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v5;
    *(_DWORD *)(result + 4) = v5[1];
    *(_DWORD *)(result + 8) = v5[2];
    *(_DWORD *)(result + 12) = v5[3];
  }
  else
  {
    v3 = &v63 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  return result;
}

//----- (00465CC0) --------------------------------------------------------
int __cdecl NPC314(int a1)
{
  int v1; // ST10_4@13
  int v2; // ST0C_4@13
  int v3; // ST08_4@13
  int v4; // eax@13
  int result; // eax@15
  int *v6; // eax@24
  int v7; // ecx@24
  int v8; // [sp+0h] [bp-38h]@1
  signed int i; // [sp+4h] [bp-34h]@11
  int v10; // [sp+8h] [bp-30h]@1
  int v11; // [sp+Ch] [bp-2Ch]@1
  int v12; // [sp+10h] [bp-28h]@1
  int v13; // [sp+14h] [bp-24h]@1
  int v14; // [sp+18h] [bp-20h]@1
  int v15; // [sp+1Ch] [bp-1Ch]@1
  int v16; // [sp+20h] [bp-18h]@1
  int v17; // [sp+24h] [bp-14h]@1
  int v18; // [sp+28h] [bp-10h]@1
  int v19; // [sp+2Ch] [bp-Ch]@1
  int v20; // [sp+30h] [bp-8h]@1
  int v21; // [sp+34h] [bp-4h]@1

  v10 = 64;
  v11 = 64;
  v12 = 80;
  v13 = 80;
  v14 = 80;
  v15 = 64;
  v16 = 96;
  v17 = 80;
  v18 = 96;
  v19 = 64;
  v20 = 112;
  v21 = 80;
  v8 = *(_DWORD *)(a1 + 116);
  if ( !v8 )
  {
    *(_DWORD *)(a1 + 112) = 0;
    *(_DWORD *)(a1 + 116) = 100;
    *(_WORD *)(a1 + 80) |= 4u;
    *(_DWORD *)(a1 + 104) = Random(0, 2);
    goto LABEL_6;
  }
  if ( v8 == 100 )
  {
LABEL_6:
    *(_DWORD *)(a1 + 20) += 64;
    if ( *(_DWORD *)(a1 + 20) > 1792 )
      *(_DWORD *)(a1 + 20) = 1792;
    if ( *(_DWORD *)(a1 + 12) > 0x10000 )
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
    if ( *(_DWORD *)(a1 + 4) & 8 )
    {
      *(_DWORD *)(a1 + 20) = -512;
      *(_DWORD *)(a1 + 116) = 110;
      *(_WORD *)(a1 + 80) |= 8u;
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      Set_Quake(10);
      for ( i = 0; i < 2; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = *(_DWORD *)(a1 + 0xC) + 0x2000;
        v4 = Random(-12, 12);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
    }
    goto LABEL_17;
  }
  if ( v8 == 110 )
  {
    *(_DWORD *)(a1 + 20) += 64;
    result = a1;
    if ( *(_DWORD *)(a1 + 12) > (Current_Map.Length << 13) + 0x4000 )
    {
      *(_BYTE *)a1 = 0;
      return result;
    }
  }
LABEL_17:
  if ( ++*(_DWORD *)(a1 + 100) > 6 )
  {
    ++*(_DWORD *)(a1 + 100);
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  if ( Quote.Y_Pos <= *(_DWORD *)(a1 + 12) )
    *(_DWORD *)(a1 + 164) = 0;
  else
    *(_DWORD *)(a1 + 164) = 10;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v6 = &v10 + 4 * *(_DWORD *)(a1 + 104);
  v7 = a1 + 84;
  *(_DWORD *)v7 = *v6;
  *(_DWORD *)(v7 + 4) = v6[1];
  *(_DWORD *)(v7 + 8) = v6[2];
  result = v6[3];
  *(_DWORD *)(v7 + 12) = result;
  return result;
}

//----- (00465F60) --------------------------------------------------------
void __cdecl NPC315(void *npc)
{
  int *v1; // ecx@43
  char *v2; // edx@43
  int *v3; // ecx@44
  char *v4; // edx@44
  int v5; // [sp+4h] [bp-80h]@1
  int v6; // [sp+8h] [bp-7Ch]@1
  int v7; // [sp+Ch] [bp-78h]@1
  int v8; // [sp+10h] [bp-74h]@1
  int v9; // [sp+14h] [bp-70h]@1
  int v10; // [sp+18h] [bp-6Ch]@1
  int v11; // [sp+1Ch] [bp-68h]@1
  int v12; // [sp+20h] [bp-64h]@1
  int v13; // [sp+24h] [bp-60h]@1
  int v14; // [sp+28h] [bp-5Ch]@1
  int v15; // [sp+2Ch] [bp-58h]@1
  int v16; // [sp+30h] [bp-54h]@1
  int v17; // [sp+34h] [bp-50h]@1
  int v18; // [sp+38h] [bp-4Ch]@1
  int v19; // [sp+3Ch] [bp-48h]@1
  int v20; // [sp+40h] [bp-44h]@1
  int v21; // [sp+44h] [bp-40h]@1
  int v22; // [sp+48h] [bp-3Ch]@1
  int v23; // [sp+4Ch] [bp-38h]@1
  int v24; // [sp+50h] [bp-34h]@1
  int v25; // [sp+54h] [bp-30h]@1
  int v26; // [sp+58h] [bp-2Ch]@1
  int v27; // [sp+5Ch] [bp-28h]@1
  int v28; // [sp+60h] [bp-24h]@1
  int v29; // [sp+64h] [bp-20h]@1
  int v30; // [sp+68h] [bp-1Ch]@1
  int v31; // [sp+6Ch] [bp-18h]@1
  int v32; // [sp+70h] [bp-14h]@1
  int v33; // [sp+74h] [bp-10h]@1
  int v34; // [sp+78h] [bp-Ch]@1
  int v35; // [sp+7Ch] [bp-8h]@1
  int v36; // [sp+80h] [bp-4h]@1

  v21 = 128;
  v22 = 0;
  v23 = 144;
  v24 = 16;
  v25 = 160;
  v26 = 0;
  v27 = 176;
  v28 = 16;
  v29 = 176;
  v30 = 0;
  v31 = 192;
  v32 = 16;
  v33 = 192;
  v34 = 0;
  v35 = 208;
  v36 = 16;
  v5 = 128;
  v6 = 16;
  v7 = 144;
  v8 = 32;
  v9 = 160;
  v10 = 16;
  v11 = 176;
  v12 = 32;
  v13 = 176;
  v14 = 16;
  v15 = 192;
  v16 = 32;
  v17 = 192;
  v18 = 16;
  v19 = 208;
  v20 = 32;
  switch ( *((_DWORD *)npc + 29) )
  {
    case 0:
      *((_DWORD *)npc + 26) = 3;
      *((_DWORD *)npc + 5) += 128;
      if ( *((_DWORD *)npc + 3) > 0x10000 )
      {
        *((_DWORD *)npc + 29) = 130;
        *((_WORD *)npc + 40) &= 0xFFF7u;
      }
      break;
    case 0x64:
      *((_DWORD *)npc + 29) = 110;
      *((_DWORD *)npc + 30) = 0;
      *((_DWORD *)npc + 27) = 0;
      *((_WORD *)npc + 40) |= 0x20u;
      goto LABEL_6;
    case 0x6E:
LABEL_6:
      if ( *((_DWORD *)npc + 2) <= Quote.X_Pos )
        *((_DWORD *)npc + 19) = 2;
      else
        *((_DWORD *)npc + 19) = 0;
      *((_DWORD *)npc + 26) = 0;
      if ( ++*((_DWORD *)npc + 30) > 4 )
      {
        *((_DWORD *)npc + 30) = 0;
        *((_DWORD *)npc + 29) = 120;
      }
      break;
    case 0x78:
      *((_DWORD *)npc + 26) = 1;
      if ( ++*((_DWORD *)npc + 30) > 4 )
      {
        *((_DWORD *)npc + 29) = 130;
        *((_DWORD *)npc + 26) = 3;
        *((_DWORD *)npc + 4) = 2 * Random(-512, 512);
        *((_DWORD *)npc + 5) = -2048;
        Play_Sound_Effect(Sfx_Critter_Hop, 1);
      }
      break;
    case 0x82:
      *((_DWORD *)npc + 5) += 128;
      if ( *((_DWORD *)npc + 4) < 0 && *((_DWORD *)npc + 1) & 1 )
        *((_DWORD *)npc + 4) = -*((_DWORD *)npc + 4);
      if ( *((_DWORD *)npc + 4) > 0 && *((_DWORD *)npc + 1) & 4 )
        *((_DWORD *)npc + 4) = -*((_DWORD *)npc + 4);
      if ( *((_DWORD *)npc + 2) <= Quote.X_Pos )
        *((_DWORD *)npc + 19) = 2;
      else
        *((_DWORD *)npc + 19) = 0;
      if ( *((_DWORD *)npc + 5) >= -512 )
      {
        if ( *((_DWORD *)npc + 5) <= 512 )
          *((_DWORD *)npc + 26) = 3;
        else
          *((_DWORD *)npc + 26) = 0;
      }
      else
      {
        *((_DWORD *)npc + 26) = 2;
      }
      if ( *((_DWORD *)npc + 1) & 8 )
      {
        *((_DWORD *)npc + 29) = 140;
        *((_DWORD *)npc + 30) = 0;
        *((_DWORD *)npc + 26) = 1;
        *((_DWORD *)npc + 4) = 0;
      }
      break;
    case 0x8C:
      *((_DWORD *)npc + 26) = 1;
      if ( ++*((_DWORD *)npc + 30) > 4 )
      {
        *((_DWORD *)npc + 29) = 110;
        *((_WORD *)npc + 40) |= 0x20u;
      }
      break;
    default:
      break;
  }
  if ( *((_DWORD *)npc + 29) > 100 )
  {
    if ( Is_some_bullet_active() )
    {
      *((_WORD *)npc + 40) &= 0xFFDFu;
      *((_WORD *)npc + 40) |= 4u;
    }
    else
    {
      *((_WORD *)npc + 40) |= 0x20u;
      *((_WORD *)npc + 40) &= 0xFFFBu;
    }
  }
  if ( ++*((_DWORD *)npc + 28) <= 300 )
  {
    if ( *((_DWORD *)npc + 5) > 1535 )
      *((_DWORD *)npc + 5) = 1535;
    *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
    *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
    if ( *((_DWORD *)npc + 19) )
    {
      v3 = &v5 + 4 * *((_DWORD *)npc + 26);
      v4 = (char *)npc + 84;
      *(_DWORD *)v4 = *v3;
      *((_DWORD *)v4 + 1) = v3[1];
      *((_DWORD *)v4 + 2) = v3[2];
      *((_DWORD *)v4 + 3) = v3[3];
    }
    else
    {
      v1 = &v21 + 4 * *((_DWORD *)npc + 26);
      v2 = (char *)npc + 84;
      *(_DWORD *)v2 = *v1;
      *((_DWORD *)v2 + 1) = v1[1];
      *((_DWORD *)v2 + 2) = v1[2];
      *((_DWORD *)v2 + 3) = v1[3];
    }
  }
  else
  {
    Vanish_NPC((NPC_vars *)npc);
  }
}

//----- (004664B0) --------------------------------------------------------
int __cdecl NPC316(int a1)
{
  int *v1; // eax@21
  int v2; // ecx@21
  int result; // eax@21
  int *v4; // eax@22
  int v5; // ecx@22
  int v6; // [sp+0h] [bp-64h]@1
  int v7; // [sp+4h] [bp-60h]@1
  int v8; // [sp+8h] [bp-5Ch]@1
  int v9; // [sp+Ch] [bp-58h]@1
  int v10; // [sp+10h] [bp-54h]@1
  int v11; // [sp+14h] [bp-50h]@1
  int v12; // [sp+18h] [bp-4Ch]@1
  int v13; // [sp+1Ch] [bp-48h]@1
  int v14; // [sp+20h] [bp-44h]@1
  int v15; // [sp+24h] [bp-40h]@1
  int v16; // [sp+28h] [bp-3Ch]@1
  int v17; // [sp+2Ch] [bp-38h]@1
  int v18; // [sp+30h] [bp-34h]@1
  int v19; // [sp+34h] [bp-30h]@1
  int v20; // [sp+38h] [bp-2Ch]@1
  int v21; // [sp+3Ch] [bp-28h]@1
  int v22; // [sp+40h] [bp-24h]@1
  int v23; // [sp+44h] [bp-20h]@1
  int v24; // [sp+48h] [bp-1Ch]@1
  int v25; // [sp+4Ch] [bp-18h]@1
  int v26; // [sp+50h] [bp-14h]@1
  int v27; // [sp+54h] [bp-10h]@1
  int v28; // [sp+58h] [bp-Ch]@1
  int v29; // [sp+5Ch] [bp-8h]@1
  int v30; // [sp+60h] [bp-4h]@1

  v19 = 248;
  v20 = 32;
  v21 = 272;
  v22 = 56;
  v23 = 272;
  v24 = 32;
  v25 = 296;
  v26 = 56;
  v27 = 296;
  v28 = 32;
  v29 = 320;
  v30 = 56;
  v7 = 248;
  v8 = 56;
  v9 = 272;
  v10 = 80;
  v11 = 272;
  v12 = 56;
  v13 = 296;
  v14 = 80;
  v15 = 296;
  v16 = 56;
  v17 = 320;
  v18 = 80;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
      }
    }
    else if ( v6 == 2 )
    {
      *(_DWORD *)(a1 + 16) = 8 * *(_DWORD *)(a1 + 16) / 9;
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_BYTE *)a1 |= 8u;
    }
  }
  else
  {
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_WORD *)(a1 + 80) &= 0xFFF7u;
    *(_DWORD *)(a1 + 164) = 0;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 140) = 6144;
    *(_DWORD *)(a1 + 148) = 6144;
    *(_DWORD *)(a1 + 144) = 6144;
    *(_DWORD *)(a1 + 20) = -512;
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 16) = -256;
    else
      *(_DWORD *)(a1 + 16) = 256;
    Play_Sound_Effect(Sfx_Toroko_Enemy_Squeal, 1);
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v19 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00466790) --------------------------------------------------------
NPC_vars *__cdecl NPC317(NPC_vars *a1)
{
  int *v1; // eax@27
  char *v2; // ecx@27
  NPC_vars *result; // eax@27
  int *v4; // eax@28
  char *v5; // ecx@28
  int v6; // [sp+4h] [bp-80h]@1
  int v7; // [sp+8h] [bp-7Ch]@1
  int v8; // [sp+Ch] [bp-78h]@1
  int v9; // [sp+10h] [bp-74h]@1
  int v10; // [sp+14h] [bp-70h]@1
  int v11; // [sp+18h] [bp-6Ch]@1
  int v12; // [sp+1Ch] [bp-68h]@1
  int v13; // [sp+20h] [bp-64h]@1
  int v14; // [sp+24h] [bp-60h]@1
  int v15; // [sp+28h] [bp-5Ch]@1
  int v16; // [sp+2Ch] [bp-58h]@1
  int v17; // [sp+30h] [bp-54h]@1
  int v18; // [sp+34h] [bp-50h]@1
  int v19; // [sp+38h] [bp-4Ch]@1
  int v20; // [sp+3Ch] [bp-48h]@1
  int v21; // [sp+40h] [bp-44h]@1
  int v22; // [sp+44h] [bp-40h]@1
  int v23; // [sp+48h] [bp-3Ch]@1
  int v24; // [sp+4Ch] [bp-38h]@1
  int v25; // [sp+50h] [bp-34h]@1
  int v26; // [sp+54h] [bp-30h]@1
  int v27; // [sp+58h] [bp-2Ch]@1
  int v28; // [sp+5Ch] [bp-28h]@1
  int v29; // [sp+60h] [bp-24h]@1
  int v30; // [sp+64h] [bp-20h]@1
  int v31; // [sp+68h] [bp-1Ch]@1
  int v32; // [sp+6Ch] [bp-18h]@1
  int v33; // [sp+70h] [bp-14h]@1
  int v34; // [sp+74h] [bp-10h]@1
  int v35; // [sp+78h] [bp-Ch]@1
  int v36; // [sp+7Ch] [bp-8h]@1
  int v37; // [sp+80h] [bp-4h]@1

  v22 = 0;
  v23 = 80;
  v24 = 32;
  v25 = 120;
  v26 = 32;
  v27 = 80;
  v28 = 64;
  v29 = 120;
  v30 = 64;
  v31 = 80;
  v32 = 96;
  v33 = 120;
  v34 = 96;
  v35 = 80;
  v36 = 128;
  v37 = 120;
  v6 = 0;
  v7 = 120;
  v8 = 32;
  v9 = 160;
  v10 = 32;
  v11 = 120;
  v12 = 64;
  v13 = 160;
  v14 = 64;
  v15 = 120;
  v16 = 96;
  v17 = 160;
  v18 = 96;
  v19 = 120;
  v20 = 128;
  v21 = 160;
  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 1;
      a1->Y_pos -= 4096;
      a1->Curly_Target_X = a1->X_pos;
      goto LABEL_3;
    case 1:
LABEL_3:
      a1->X_vel = 0;
      a1->Current_State = 2;
      a1->Ani_Num = 0;
      a1->count1 = 0;
      goto LABEL_4;
    case 2:
LABEL_4:
      if ( a1->X_pos <= Quote.X_Pos )
        a1->Direction = 2;
      else
        a1->Direction = 0;
      if ( ++a1->ani_wait > 40 )
      {
        a1->ani_wait = 0;
        ++a1->Ani_Num;
      }
      if ( a1->Ani_Num > 1 )
        a1->Ani_Num = 0;
      if ( Quote.X_Pos > a1->X_pos - 163840
        && Quote.X_Pos < a1->X_pos + 163840
        && Quote.Y_Pos > a1->Y_pos - 81920
        && Quote.Y_Pos < a1->Y_pos + 81920
        && ++a1->count1 > 50 )
      {
        a1->Current_State = 10;
      }
      break;
    case 0xA:
      a1->Current_State = 11;
      a1->Wait_Timer = 0;
      a1->Ani_Num = 2;
      NPC_Create(Treasure_Chest_Closed|0x130, a1->X_pos, a1->Y_pos, 0, 0, 0, a1, 256);
      goto LABEL_19;
    case 0xB:
LABEL_19:
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Wait_Timer = 0;
        a1->Current_State = 12;
        a1->Ani_Num = 3;
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      break;
    case 0xC:
      if ( ++a1->Wait_Timer > 20 )
        a1->Current_State = 1;
      break;
    default:
      break;
  }
  a1->Y_vel += 85;
  if ( a1->Y_vel > 1535 )
    a1->Y_vel = 1535;
  a1->X_pos += a1->X_vel;
  a1->Y_pos += a1->Y_vel;
  if ( a1->Direction )
  {
    v4 = &v6 + 4 * a1->Ani_Num;
    v5 = (char *)&a1->Rect;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    *((_DWORD *)v5 + 2) = v4[2];
    result = (NPC_vars *)v4[3];
    *((_DWORD *)v5 + 3) = result;
  }
  else
  {
    v1 = &v22 + 4 * a1->Ani_Num;
    v2 = (char *)&a1->Rect;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    *((_DWORD *)v2 + 2) = v1[2];
    result = (NPC_vars *)v1[3];
    *((_DWORD *)v2 + 3) = result;
  }
  if ( a1->Life <= 936 )
  {
    a1->Entity_Type = 318;
    result = a1;
    a1->Current_State = 0;
  }
  return result;
}

//----- (00466B80) --------------------------------------------------------
int __cdecl NPC318(int a1)
{
  int *v1; // eax@21
  int v2; // ecx@21
  int result; // eax@21
  int *v4; // eax@22
  int v5; // ecx@22
  int v6; // [sp+0h] [bp-64h]@1
  int v7; // [sp+4h] [bp-60h]@1
  int v8; // [sp+8h] [bp-5Ch]@1
  int v9; // [sp+Ch] [bp-58h]@1
  int v10; // [sp+10h] [bp-54h]@1
  int v11; // [sp+14h] [bp-50h]@1
  int v12; // [sp+18h] [bp-4Ch]@1
  int v13; // [sp+1Ch] [bp-48h]@1
  int v14; // [sp+20h] [bp-44h]@1
  int v15; // [sp+24h] [bp-40h]@1
  int v16; // [sp+28h] [bp-3Ch]@1
  int v17; // [sp+2Ch] [bp-38h]@1
  int v18; // [sp+30h] [bp-34h]@1
  int v19; // [sp+34h] [bp-30h]@1
  int v20; // [sp+38h] [bp-2Ch]@1
  int v21; // [sp+3Ch] [bp-28h]@1
  int v22; // [sp+40h] [bp-24h]@1
  int v23; // [sp+44h] [bp-20h]@1
  int v24; // [sp+48h] [bp-1Ch]@1
  int v25; // [sp+4Ch] [bp-18h]@1
  int v26; // [sp+50h] [bp-14h]@1
  int v27; // [sp+54h] [bp-10h]@1
  int v28; // [sp+58h] [bp-Ch]@1
  int v29; // [sp+5Ch] [bp-8h]@1
  int v30; // [sp+60h] [bp-4h]@1

  v19 = 224;
  v20 = 80;
  v21 = 256;
  v22 = 120;
  v23 = 256;
  v24 = 80;
  v25 = 288;
  v26 = 120;
  v27 = 288;
  v28 = 80;
  v29 = 320;
  v30 = 120;
  v7 = 224;
  v8 = 120;
  v9 = 256;
  v10 = 160;
  v11 = 256;
  v12 = 120;
  v13 = 288;
  v14 = 160;
  v15 = 288;
  v16 = 120;
  v17 = 320;
  v18 = 160;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 100) = 0;
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = 0;
      }
    }
    else if ( v6 == 2 )
    {
      *(_DWORD *)(a1 + 16) = 8 * *(_DWORD *)(a1 + 16) / 9;
      if ( ++*(_DWORD *)(a1 + 100) > 3 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_BYTE *)a1 |= 8u;
    }
  }
  else
  {
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_WORD *)(a1 + 80) &= 0xFFF7u;
    *(_WORD *)(a1 + 80) &= 0xFFFEu;
    *(_DWORD *)(a1 + 164) = 0;
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 20) = -512;
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 16) = -64;
    else
      *(_DWORD *)(a1 + 16) = 64;
    Play_Sound_Effect(Sfx_Heavy_Press_Large_Object_Hurt, 1);
  }
  *(_DWORD *)(a1 + 20) += 32;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  else
  {
    v1 = &v19 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    *(_DWORD *)(v2 + 8) = v1[2];
    result = v1[3];
    *(_DWORD *)(v2 + 12) = result;
  }
  return result;
}

//----- (00466E50) --------------------------------------------------------
void __cdecl NPC319(int a1)
{
  int *v1; // ecx@22
  int v2; // edx@22
  int v3; // [sp+0h] [bp-34h]@1
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 16;
  v5 = 0;
  v6 = 32;
  v7 = 16;
  v8 = 16;
  v9 = 0;
  v10 = 32;
  v11 = 16;
  v12 = 96;
  v13 = 80;
  v14 = 112;
  v15 = 96;
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 == 2 )
    {
      if ( ++*(_DWORD *)(a1 + 120) == 4 )
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
      *(_DWORD *)(a1 + 20) += 42;
      if ( *(_DWORD *)(a1 + 20) > 1535 )
        *(_DWORD *)(a1 + 20) = 1535;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 4) & 8 )
      {
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 3);
        *(_BYTE *)a1 = 0;
      }
    }
  }
  else
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) + 5120;
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 3584;
    else
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 3584;
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 40) == 318 )
    {
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 3);
      *(_BYTE *)a1 = 0;
      return;
    }
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) != 2 )
    {
      *(_DWORD *)(a1 + 116) = 2;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 20) = -1024;
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 2048;
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76) )
        *(_DWORD *)(a1 + 16) = 1024;
      else
        *(_DWORD *)(a1 + 16) = -1024;
    }
  }
  if ( ++*(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
}

//----- (004670C0) --------------------------------------------------------
LONG *__cdecl NPC320(NPC_vars *a1)
{
  __int64 v1; // rax@17
  __int64 v2; // rax@17
  int *v3; // edx@20
  LONG *result; // eax@20
  int *v5; // edx@21
  int v6; // [sp+0h] [bp-60h]@1
  int v7; // [sp+4h] [bp-5Ch]@1
  int v8; // [sp+8h] [bp-58h]@1
  int v9; // [sp+Ch] [bp-54h]@1
  int v10; // [sp+10h] [bp-50h]@1
  int v11; // [sp+14h] [bp-4Ch]@1
  int v12; // [sp+18h] [bp-48h]@1
  int v13; // [sp+1Ch] [bp-44h]@1
  int v14; // [sp+20h] [bp-40h]@1
  int v15; // [sp+24h] [bp-3Ch]@1
  int v16; // [sp+28h] [bp-38h]@1
  int v17; // [sp+2Ch] [bp-34h]@1
  int v18; // [sp+30h] [bp-30h]@1
  int v19; // [sp+34h] [bp-2Ch]@1
  int v20; // [sp+38h] [bp-28h]@1
  int v21; // [sp+3Ch] [bp-24h]@1
  int v22; // [sp+40h] [bp-20h]@1
  int v23; // [sp+44h] [bp-1Ch]@1
  int v24; // [sp+48h] [bp-18h]@1
  int v25; // [sp+4Ch] [bp-14h]@1
  int v26; // [sp+50h] [bp-10h]@1
  int v27; // [sp+54h] [bp-Ch]@1
  int v28; // [sp+58h] [bp-8h]@1
  int v29; // [sp+5Ch] [bp-4h]@1

  v18 = 16;
  v19 = 96;
  v20 = 32;
  v21 = 112;
  v22 = 48;
  v23 = 96;
  v24 = 64;
  v25 = 112;
  v26 = 96;
  v27 = 96;
  v28 = 112;
  v29 = 112;
  v6 = 16;
  v7 = 112;
  v8 = 32;
  v9 = 128;
  v10 = 48;
  v11 = 112;
  v12 = 64;
  v13 = 128;
  v14 = 96;
  v15 = 112;
  v16 = 112;
  v17 = 128;
  if ( !a1->Current_State )
  {
    a1->Current_State = 1;
    a1->X_pos = Quote.X_Pos;
    a1->Y_pos = Quote.Y_Pos;
    NPC_Create((NPC_Names)321, 0, 0, 0, 0, 0, a1, 256);
  }
  if ( Quote.Collision_Flags & 8 )
  {
    if ( Quote.Is_Facing_Up )
    {
      a1->Curly_Target_X = Quote.X_Pos;
      a1->Curly_Target_Y = Quote.Y_Pos - 5120;
      a1->Ani_Num = 1;
    }
    else
    {
      a1->Ani_Num = 0;
      if ( Quote.Direction )
      {
        a1->Curly_Target_X = Quote.X_Pos - 3584;
        a1->Curly_Target_Y = Quote.Y_Pos - 1536;
      }
      else
      {
        a1->Curly_Target_X = Quote.X_Pos + 3584;
        a1->Curly_Target_Y = Quote.Y_Pos - 1536;
      }
    }
  }
  else if ( Quote.Is_Facing_Up )
  {
    a1->Curly_Target_X = Quote.X_Pos;
    a1->Curly_Target_Y = Quote.Y_Pos + 4096;
    a1->Ani_Num = 2;
  }
  else if ( Quote.Is_Facing_Down )
  {
    a1->Curly_Target_X = Quote.X_Pos;
    a1->Curly_Target_Y = Quote.Y_Pos - 4096;
    a1->Ani_Num = 1;
  }
  else
  {
    a1->Ani_Num = 0;
    if ( Quote.Direction )
    {
      a1->Curly_Target_X = Quote.X_Pos - 3584;
      a1->Curly_Target_Y = Quote.Y_Pos - 1536;
    }
    else
    {
      a1->Curly_Target_X = Quote.X_Pos + 3584;
      a1->Curly_Target_Y = Quote.Y_Pos - 1536;
    }
  }
  v1 = a1->Curly_Target_X - a1->X_pos;
  a1->X_pos += ((signed int)v1 - HIDWORD(v1)) >> 1;
  v2 = a1->Curly_Target_Y - a1->Y_pos;
  a1->Y_pos += ((signed int)v2 - HIDWORD(v2)) >> 1;
  if ( Quote.Animation_Num % 2 )
    a1->Y_pos -= 512;
  if ( Quote.Direction )
  {
    v5 = &v18 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v5;
    result[1] = v5[1];
    result[2] = v5[2];
    result[3] = v5[3];
  }
  else
  {
    v3 = &v6 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v3;
    result[1] = v3[1];
    result[2] = v3[2];
    result[3] = v3[3];
  }
  return result;
}

//----- (004673F0) --------------------------------------------------------
int __cdecl NPC321(int a1)
{
  int result; // eax@1
  int *v2; // ecx@17
  int v3; // edx@17
  int *v4; // ecx@18
  int v5; // edx@18
  int v6; // [sp+0h] [bp-68h]@2
  Directions Direction; // [sp+4h] [bp-64h]@0
  int v8; // [sp+8h] [bp-60h]@1
  int v9; // [sp+Ch] [bp-5Ch]@1
  int v10; // [sp+10h] [bp-58h]@1
  int v11; // [sp+14h] [bp-54h]@1
  int v12; // [sp+18h] [bp-50h]@1
  int v13; // [sp+1Ch] [bp-4Ch]@1
  int v14; // [sp+20h] [bp-48h]@1
  int v15; // [sp+24h] [bp-44h]@1
  int v16; // [sp+28h] [bp-40h]@1
  int v17; // [sp+2Ch] [bp-3Ch]@1
  int v18; // [sp+30h] [bp-38h]@1
  int v19; // [sp+34h] [bp-34h]@1
  int v20; // [sp+38h] [bp-30h]@1
  int v21; // [sp+3Ch] [bp-2Ch]@1
  int v22; // [sp+40h] [bp-28h]@1
  int v23; // [sp+44h] [bp-24h]@1
  int v24; // [sp+48h] [bp-20h]@1
  int v25; // [sp+4Ch] [bp-1Ch]@1
  int v26; // [sp+50h] [bp-18h]@1
  int v27; // [sp+54h] [bp-14h]@1
  int v28; // [sp+58h] [bp-10h]@1
  int v29; // [sp+5Ch] [bp-Ch]@1
  int v30; // [sp+60h] [bp-8h]@1
  int v31; // [sp+64h] [bp-4h]@1

  v20 = 136;
  v21 = 152;
  v22 = 152;
  v23 = 168;
  v24 = 152;
  v25 = 152;
  v26 = 168;
  v27 = 168;
  v28 = 168;
  v29 = 152;
  v30 = 184;
  v31 = 168;
  v8 = 136;
  v9 = 168;
  v10 = 152;
  v11 = 184;
  v12 = 152;
  v13 = 168;
  v14 = 168;
  v15 = 184;
  v16 = 168;
  v17 = 168;
  v18 = 184;
  v19 = 184;
  result = a1;
  if ( *(_DWORD *)(a1 + 168) )
  {
    v6 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104);
    if ( v6 )
    {
      if ( v6 == 1 )
      {
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
        Direction = 1;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 5120;
      }
      else if ( v6 == 2 )
      {
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
        Direction = 3;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) + 5120;
      }
    }
    else
    {
      if ( Quote.Direction )
      {
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 4096;
        Direction = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 4096;
        Direction = 2;
      }
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
    }
    *(_DWORD *)(a1 + 104) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104);
    if ( Game_Flags & 2 && Count_All_Slots_Using_Shot(43) < 2 && Key_Shoot & Key_Pressed )
    {
      Create_Bullet(
        Nemesis_Unkn,
        *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8),
        *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12),
        Direction);
      Create_Effect(*(_DWORD *)(*(_DWORD *)(a1 + 168) + 8), *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12), 3, 0);
      Play_Sound_Effect(Sfx_Nemesis_Shot, 1);
    }
    if ( Quote.Direction )
    {
      v4 = &v20 + 4 * *(_DWORD *)(a1 + 104);
      v5 = a1 + 84;
      *(_DWORD *)v5 = *v4;
      *(_DWORD *)(v5 + 4) = v4[1];
      result = v4[2];
      *(_DWORD *)(v5 + 8) = result;
      *(_DWORD *)(v5 + 12) = v4[3];
    }
    else
    {
      v2 = &v8 + 4 * *(_DWORD *)(a1 + 104);
      v3 = a1 + 84;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      result = v2[2];
      *(_DWORD *)(v3 + 8) = result;
      *(_DWORD *)(v3 + 12) = v2[3];
    }
  }
  return result;
}
// 493614: using guessed type int Key_Shoot;
// 49E1E8: using guessed type int Game_Flags;
// 49E214: using guessed type int Key_Pressed;

//----- (004676D0) --------------------------------------------------------
int __cdecl NPC322(int a1)
{
  int result; // eax@1
  int *v2; // eax@14
  int v3; // ecx@14
  __int64 v4; // rax@22
  __int64 v5; // rax@22
  __int64 v6; // rax@23
  __int64 v7; // rax@23
  int v8; // edx@25
  int v9; // [sp+4h] [bp-34h]@4
  int v10; // [sp+8h] [bp-30h]@1
  int v11; // [sp+Ch] [bp-2Ch]@1
  int v12; // [sp+10h] [bp-28h]@1
  int v13; // [sp+14h] [bp-24h]@1
  int v14; // [sp+18h] [bp-20h]@1
  int v15; // [sp+1Ch] [bp-1Ch]@1
  int v16; // [sp+20h] [bp-18h]@1
  int v17; // [sp+24h] [bp-14h]@1
  int v18; // [sp+28h] [bp-10h]@1
  int v19; // [sp+2Ch] [bp-Ch]@1
  int v20; // [sp+30h] [bp-8h]@1
  int v21; // [sp+34h] [bp-4h]@1

  v10 = 272;
  v11 = 216;
  v12 = 296;
  v13 = 240;
  v14 = 296;
  v15 = 216;
  v16 = 320;
  v17 = 240;
  v18 = 160;
  v19 = 216;
  v20 = 184;
  v21 = 240;
  result = a1;
  if ( *(_DWORD *)(a1 + 116) < 2 && *(_DWORD *)(a1 + 64) <= 968 )
  {
    *(_DWORD *)(a1 + 116) = 2;
    *(_DWORD *)(a1 + 120) = 0;
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_WORD *)(a1 + 80) |= 4u;
    Play_Sound_Effect(Sfx_Chest_Open, 1);
  }
  v9 = *(_DWORD *)(a1 + 116);
  if ( !v9 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 8) += 4096;
    else
      *(_DWORD *)(a1 + 12) += 4096;
LABEL_11:
    if ( *(_BYTE *)(a1 + 156) )
      ++*(_DWORD *)(a1 + 108);
    else
      *(_DWORD *)(a1 + 108) = 0;
    v2 = &v10 + 4 * (*(_DWORD *)(a1 + 108) / 2 % 2);
    v3 = a1 + 84;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    result = v2[3];
    *(_DWORD *)(v3 + 12) = result;
    return result;
  }
  if ( v9 == 1 )
    goto LABEL_11;
  if ( v9 == 2 )
  {
    *(_DWORD *)(a1 + 104) = 2;
    switch ( *(_DWORD *)(a1 + 120) )
    {
      case 0:
        NPC_Create(Treasure_Chest_Closed|0xC0, *(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 384);
        break;
      case 0x32:
        NPC_Create(Treasure_Chest_Closed|0xC0, *(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12), 0, 0, Up, NULL, 384);
        break;
      case 0x64:
        NPC_Create(Treasure_Chest_Closed|0xC0, *(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12), 0, 0, Right, NULL, 384);
        break;
      case 0x96:
        NPC_Create(Treasure_Chest_Closed|0xC0, *(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12), 0, 0, Down, NULL, 384);
        break;
      case 0xC8:
        NPC_Create(
          Treasure_Chest_Closed|0xC0,
          *(_DWORD *)(a1 + 8) + 2048,
          *(_DWORD *)(a1 + 12),
          0,
          0,
          (Directions)4,
          NULL,
          384);
        break;
      case 0xFA:
        *(_DWORD *)(a1 + 132) = 24576;
        *(_DWORD *)(a1 + 124) = 24576;
        *(_DWORD *)(a1 + 128) = 24576;
        *(_DWORD *)(a1 + 136) = 24576;
        *(_DWORD *)(a1 + 164) = 12;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 24576, 40);
        Set_Quake(10);
        if ( *(_DWORD *)(a1 + 76) )
        {
          v6 = (*(_DWORD *)(a1 + 8) - 4096) / 512;
          Delete_Tile(((BYTE4(v6) & 0xF) + (signed int)v6) >> 4, *(_DWORD *)(a1 + 12) / 512 / 16);
          v7 = (*(_DWORD *)(a1 + 8) + 4096) / 512;
          Delete_Tile(((BYTE4(v7) & 0xF) + (signed int)v7) >> 4, *(_DWORD *)(a1 + 12) / 512 / 16);
        }
        else
        {
          v4 = (*(_DWORD *)(a1 + 12) - 4096) / 512;
          Delete_Tile(*(_DWORD *)(a1 + 8) / 512 / 16, ((BYTE4(v4) & 0xF) + (signed int)v4) >> 4);
          v5 = (*(_DWORD *)(a1 + 12) + 4096) / 512;
          Delete_Tile(*(_DWORD *)(a1 + 8) / 512 / 16, ((BYTE4(v5) & 0xF) + (signed int)v5) >> 4);
        }
        *(_BYTE *)a1 |= 8u;
        break;
      default:
        break;
    }
    ++*(_DWORD *)(a1 + 120);
    v8 = a1 + 84;
    *(_DWORD *)v8 = v18;
    *(_DWORD *)(v8 + 4) = v19;
    result = v20;
    *(_DWORD *)(v8 + 8) = v20;
    *(_DWORD *)(v8 + 12) = v21;
  }
  return result;
}

//----- (00467C60) --------------------------------------------------------
int __cdecl NPC323(int a1)
{
  int *v1; // edx@31
  int result; // eax@31
  int v3; // [sp+8h] [bp-44h]@4
  int v4; // [sp+Ch] [bp-40h]@1
  int v5; // [sp+10h] [bp-3Ch]@1
  int v6; // [sp+14h] [bp-38h]@1
  int v7; // [sp+18h] [bp-34h]@1
  int v8; // [sp+1Ch] [bp-30h]@1
  int v9; // [sp+20h] [bp-2Ch]@1
  int v10; // [sp+24h] [bp-28h]@1
  int v11; // [sp+28h] [bp-24h]@1
  int v12; // [sp+2Ch] [bp-20h]@1
  int v13; // [sp+30h] [bp-1Ch]@1
  int v14; // [sp+34h] [bp-18h]@1
  int v15; // [sp+38h] [bp-14h]@1
  int v16; // [sp+3Ch] [bp-10h]@1
  int v17; // [sp+40h] [bp-Ch]@1
  int v18; // [sp+44h] [bp-8h]@1
  int v19; // [sp+48h] [bp-4h]@1

  v4 = 216;
  v5 = 32;
  v6 = 232;
  v7 = 56;
  v8 = 232;
  v9 = 32;
  v10 = 248;
  v11 = 56;
  v12 = 216;
  v13 = 56;
  v14 = 232;
  v15 = 80;
  v16 = 232;
  v17 = 56;
  v18 = 248;
  v19 = 80;
  if ( ++*(_DWORD *)(a1 + 100) > 3 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    if ( ++*(_DWORD *)(a1 + 104) > 3 )
      *(_DWORD *)(a1 + 104) = 0;
  }
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
      goto LABEL_29;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        *(_DWORD *)(a1 + 16) = -1536;
        break;
      case 2:
        *(_DWORD *)(a1 + 16) = 1536;
        break;
      case 1:
        *(_DWORD *)(a1 + 20) = -1536;
        break;
      case 3:
        *(_DWORD *)(a1 + 20) = 1536;
        break;
      default:
        break;
    }
  }
  if ( ++*(_DWORD *)(a1 + 120) == 16 )
    *(_WORD *)(a1 + 80) &= 0xFFF7u;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( *(_DWORD *)(a1 + 4) & 0xFF )
    *(_DWORD *)(a1 + 116) = 10;
  if ( *(_DWORD *)(a1 + 120) > 20 )
  {
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos + 0x4000 )
          *(_DWORD *)(a1 + 116) = 10;
        break;
      case 2:
        if ( *(_DWORD *)(a1 + 8) >= Quote.X_Pos - 0x4000 )
          *(_DWORD *)(a1 + 116) = 10;
        break;
      case 1:
        if ( *(_DWORD *)(a1 + 12) <= Quote.Y_Pos + 0x4000 )
          *(_DWORD *)(a1 + 116) = 10;
        break;
      case 3:
        if ( *(_DWORD *)(a1 + 12) >= Quote.Y_Pos - 0x4000 )
          *(_DWORD *)(a1 + 116) = 10;
        break;
      default:
        break;
    }
  }
LABEL_29:
  if ( *(_DWORD *)(a1 + 116) == 10 )
  {
    *(_DWORD *)(a1 + 40) = 309;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 116) = 11;
    *(_WORD *)(a1 + 80) |= 0x20u;
    *(_WORD *)(a1 + 80) &= 0xFFF7u;
    *(_DWORD *)(a1 + 164) = 5;
    *(_DWORD *)(a1 + 144) = 4096;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00467F40) --------------------------------------------------------
void __cdecl NPC324(int a1)
{
  int v1; // [sp+0h] [bp-4h]@1

  v1 = *(_DWORD *)(a1 + 116);
  if ( v1 == 10 )
  {
    *(_DWORD *)(a1 + 116) = 11;
    *(_DWORD *)(a1 + 120) = 0;
  }
  else if ( v1 != 11 )
  {
    return;
  }
  if ( ++*(_DWORD *)(a1 + 120) % 50 == 1 )
    NPC_Create((NPC_Names)323, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, *(Directions *)(a1 + 76), NULL, 256);
  if ( *(_DWORD *)(a1 + 120) > 351 )
    *(_DWORD *)(a1 + 116) = 0;
}

//----- (00467FE0) --------------------------------------------------------
int __cdecl NPC325(int a1)
{
  int result; // eax@16
  int *v2; // eax@17
  int v3; // ecx@17
  int v4; // [sp+0h] [bp-74h]@1
  int v5; // [sp+4h] [bp-70h]@1
  int v6; // [sp+8h] [bp-6Ch]@1
  int v7; // [sp+Ch] [bp-68h]@1
  int v8; // [sp+10h] [bp-64h]@1
  int v9; // [sp+14h] [bp-60h]@1
  int v10; // [sp+18h] [bp-5Ch]@1
  int v11; // [sp+1Ch] [bp-58h]@1
  int v12; // [sp+20h] [bp-54h]@1
  int v13; // [sp+24h] [bp-50h]@1
  int v14; // [sp+28h] [bp-4Ch]@1
  int v15; // [sp+2Ch] [bp-48h]@1
  int v16; // [sp+30h] [bp-44h]@1
  int v17; // [sp+34h] [bp-40h]@1
  int v18; // [sp+38h] [bp-3Ch]@1
  int v19; // [sp+3Ch] [bp-38h]@1
  int v20; // [sp+40h] [bp-34h]@1
  int v21; // [sp+44h] [bp-30h]@1
  int v22; // [sp+48h] [bp-2Ch]@1
  int v23; // [sp+4Ch] [bp-28h]@1
  int v24; // [sp+50h] [bp-24h]@1
  int v25; // [sp+54h] [bp-20h]@1
  int v26; // [sp+58h] [bp-1Ch]@1
  int v27; // [sp+5Ch] [bp-18h]@1
  int v28; // [sp+60h] [bp-14h]@1
  int v29; // [sp+64h] [bp-10h]@1
  int v30; // [sp+68h] [bp-Ch]@1
  int v31; // [sp+6Ch] [bp-8h]@1
  int v32; // [sp+70h] [bp-4h]@1

  v5 = 240;
  v6 = 96;
  v7 = 272;
  v8 = 128;
  v9 = 272;
  v10 = 96;
  v11 = 304;
  v12 = 128;
  v13 = 240;
  v14 = 128;
  v15 = 272;
  v16 = 160;
  v17 = 240;
  v18 = 0;
  v19 = 256;
  v20 = 96;
  v21 = 256;
  v22 = 0;
  v23 = 272;
  v24 = 96;
  v25 = 272;
  v26 = 0;
  v27 = 288;
  v28 = 96;
  v29 = 288;
  v30 = 0;
  v31 = 304;
  v32 = 96;
  v4 = *(_DWORD *)(a1 + 116);
  if ( !v4 )
  {
    *(_DWORD *)(a1 + 116) = 1;
    Play_Sound_Effect(Sfx_Teleport, 1);
    goto LABEL_6;
  }
  if ( v4 == 1 )
  {
LABEL_6:
    if ( ++*(_DWORD *)(a1 + 100) > 0 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
    if ( ++*(_DWORD *)(a1 + 120) > 50 )
    {
      *(_DWORD *)(a1 + 116) = 10;
      *(_DWORD *)(a1 + 100) = 0;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 164) = 10;
      *(_DWORD *)(a1 + 140) = 4096;
      *(_DWORD *)(a1 + 144) = 6144;
      Play_Sound_Effect(Sfx_Lightning, 1);
      Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + 43008, 0, 3);
    }
    goto LABEL_17;
  }
  if ( v4 == 10 )
  {
    if ( ++*(_DWORD *)(a1 + 100) > 2 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 6 )
    {
      result = a1;
      *(_BYTE *)a1 = 0;
      return result;
    }
  }
LABEL_17:
  v2 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v3 = a1 + 84;
  *(_DWORD *)v3 = *v2;
  *(_DWORD *)(v3 + 4) = v2[1];
  *(_DWORD *)(v3 + 8) = v2[2];
  result = v2[3];
  *(_DWORD *)(v3 + 12) = result;
  return result;
}

//----- (00468230) --------------------------------------------------------
LONG *__cdecl NPC326(NPC_vars *a1)
{
  int *v1; // edx@47
  LONG *result; // eax@47
  int *v3; // edx@48
  int v4; // [sp+4h] [bp-100h]@46
  int v5; // [sp+8h] [bp-FCh]@46
  int v6; // [sp+Ch] [bp-F8h]@46
  int v7; // [sp+10h] [bp-F4h]@46
  int v8; // [sp+14h] [bp-F0h]@46
  int v9; // [sp+18h] [bp-ECh]@46
  int v10; // [sp+1Ch] [bp-E8h]@46
  int v11; // [sp+20h] [bp-E4h]@46
  int v12; // [sp+24h] [bp-E0h]@46
  int v13; // [sp+28h] [bp-DCh]@46
  int v14; // [sp+2Ch] [bp-D8h]@46
  int v15; // [sp+30h] [bp-D4h]@46
  int v16; // [sp+34h] [bp-D0h]@46
  int v17; // [sp+38h] [bp-CCh]@46
  int v18; // [sp+3Ch] [bp-C8h]@46
  int v19; // [sp+40h] [bp-C4h]@46
  int v20; // [sp+44h] [bp-C0h]@46
  int v21; // [sp+48h] [bp-BCh]@46
  int v22; // [sp+4Ch] [bp-B8h]@46
  int v23; // [sp+50h] [bp-B4h]@46
  int v24; // [sp+54h] [bp-B0h]@46
  int v25; // [sp+58h] [bp-ACh]@46
  int v26; // [sp+5Ch] [bp-A8h]@46
  int v27; // [sp+60h] [bp-A4h]@46
  int v28; // [sp+64h] [bp-A0h]@46
  int v29; // [sp+68h] [bp-9Ch]@46
  int v30; // [sp+6Ch] [bp-98h]@46
  int v31; // [sp+70h] [bp-94h]@46
  int v32; // [sp+74h] [bp-90h]@46
  int v33; // [sp+78h] [bp-8Ch]@46
  int v34; // [sp+7Ch] [bp-88h]@46
  int v35; // [sp+80h] [bp-84h]@46
  int v36; // [sp+84h] [bp-80h]@46
  int v37; // [sp+88h] [bp-7Ch]@46
  int v38; // [sp+8Ch] [bp-78h]@46
  int v39; // [sp+90h] [bp-74h]@46
  int v40; // [sp+94h] [bp-70h]@46
  int v41; // [sp+98h] [bp-6Ch]@46
  int v42; // [sp+9Ch] [bp-68h]@46
  int v43; // [sp+A0h] [bp-64h]@46
  int v44; // [sp+A4h] [bp-60h]@46
  int v45; // [sp+A8h] [bp-5Ch]@46
  int v46; // [sp+ACh] [bp-58h]@46
  int v47; // [sp+B0h] [bp-54h]@46
  int v48; // [sp+B4h] [bp-50h]@46
  int v49; // [sp+B8h] [bp-4Ch]@46
  int v50; // [sp+BCh] [bp-48h]@46
  int v51; // [sp+C0h] [bp-44h]@46
  int v52; // [sp+C4h] [bp-40h]@46
  int v53; // [sp+C8h] [bp-3Ch]@46
  int v54; // [sp+CCh] [bp-38h]@46
  int v55; // [sp+D0h] [bp-34h]@46
  int v56; // [sp+D4h] [bp-30h]@46
  int v57; // [sp+D8h] [bp-2Ch]@46
  int v58; // [sp+DCh] [bp-28h]@46
  int v59; // [sp+E0h] [bp-24h]@46
  int v60; // [sp+E4h] [bp-20h]@46
  int v61; // [sp+E8h] [bp-1Ch]@46
  int v62; // [sp+ECh] [bp-18h]@46
  int v63; // [sp+F0h] [bp-14h]@46
  int v64; // [sp+F4h] [bp-10h]@46
  int v65; // [sp+F8h] [bp-Ch]@46
  int v66; // [sp+FCh] [bp-8h]@46
  int v67; // [sp+100h] [bp-4h]@46

  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 1;
      a1->Y_pos -= 4096;
      a1->X_pos += 0x2000;
      a1->Ani_Num = 0;
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( ++a1->Wait_Timer <= 80 )
      {
        if ( a1->Direction )
        {
          if ( a1->Wait_Timer == 50 )
            a1->Ani_Num = 1;
          if ( a1->Wait_Timer == 60 )
            a1->Ani_Num = 0;
        }
        else
        {
          if ( a1->Wait_Timer == 30 )
            a1->Ani_Num = 1;
          if ( a1->Wait_Timer == 40 )
            a1->Ani_Num = 0;
        }
      }
      else
      {
        a1->Current_State = 10;
        a1->Wait_Timer = 0;
      }
      break;
    case 0xA:
      if ( ++a1->Wait_Timer <= 50 )
      {
        if ( a1->Wait_Timer / 2 % 2 )
          a1->Ani_Num = 2;
        else
          a1->Ani_Num = 3;
      }
      else
      {
        a1->Current_State = 15;
        a1->Ani_Num = 4;
        if ( a1->Direction )
          a1->Wait_Timer = -20;
        else
          a1->Wait_Timer = 0;
      }
      break;
    case 0xF:
      if ( ++a1->Wait_Timer > 40 )
      {
        a1->Wait_Timer = 0;
        a1->Current_State = 20;
      }
      break;
    case 0x14:
      a1->Y_vel += 64;
      if ( a1->Y_vel > 1535 )
        a1->Y_vel = 1535;
      a1->Y_pos += a1->Y_vel;
      if ( ++a1->Wait_Timer > 50 )
      {
        a1->Current_State = 30;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 6;
        if ( a1->Direction )
          NPC_Create(Enemy_Basil|0x140, a1->X_pos, a1->Y_pos - 4096, 0, 0, 0, a1, 256);
        else
          NPC_Create(Enemy_Basil|0x140, a1->X_pos, a1->Y_pos - 0x2000, 0, 0, 0, a1, 256);
      }
      break;
    case 0x1E:
      if ( ++a1->Wait_Timer == 30 )
        a1->Ani_Num = 7;
      if ( a1->Wait_Timer == 40 )
        a1->Current_State = 40;
      break;
    case 0x28:
      a1->Current_State = 41;
      a1->Wait_Timer = 0;
      a1->Ani_Num = 0;
      goto LABEL_42;
    case 0x29:
LABEL_42:
      if ( ++a1->Wait_Timer == 30 )
        a1->Ani_Num = 1;
      if ( a1->Wait_Timer == 40 )
        a1->Ani_Num = 0;
      break;
    default:
      break;
  }
  v36 = 0;
  v37 = 128;
  v38 = 16;
  v39 = 152;
  v40 = 16;
  v41 = 128;
  v42 = 32;
  v43 = 152;
  v44 = 32;
  v45 = 128;
  v46 = 48;
  v47 = 152;
  v48 = 48;
  v49 = 128;
  v50 = 64;
  v51 = 152;
  v52 = 64;
  v53 = 128;
  v54 = 80;
  v55 = 152;
  v56 = 80;
  v57 = 128;
  v58 = 96;
  v59 = 152;
  v60 = 96;
  v61 = 128;
  v62 = 112;
  v63 = 152;
  v64 = 112;
  v65 = 128;
  v66 = 128;
  v67 = 152;
  v4 = 128;
  v5 = 128;
  v6 = 144;
  v7 = 152;
  v8 = 144;
  v9 = 128;
  v10 = 160;
  v11 = 152;
  v12 = 160;
  v13 = 128;
  v14 = 176;
  v15 = 152;
  v16 = 176;
  v17 = 128;
  v18 = 192;
  v19 = 152;
  v20 = 192;
  v21 = 128;
  v22 = 208;
  v23 = 152;
  v24 = 208;
  v25 = 128;
  v26 = 224;
  v27 = 152;
  v28 = 224;
  v29 = 128;
  v30 = 240;
  v31 = 152;
  v32 = 32;
  v33 = 152;
  v34 = 48;
  v35 = 176;
  if ( a1->Direction )
  {
    v3 = &v4 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v3;
    result[1] = v3[1];
    result[2] = v3[2];
    result[3] = v3[3];
  }
  else
  {
    v1 = &v36 + 4 * a1->Ani_Num;
    result = &a1->Rect.left;
    *result = *v1;
    result[1] = v1[1];
    result[2] = v1[2];
    result[3] = v1[3];
  }
  return result;
}

//----- (00468830) --------------------------------------------------------
int __cdecl NPC327(int a1)
{
  int *v1; // eax@14
  int v2; // ecx@14
  int result; // eax@14
  int v4; // [sp+0h] [bp-24h]@1
  int v5; // [sp+4h] [bp-20h]@1
  int v6; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+Ch] [bp-18h]@1
  int v8; // [sp+10h] [bp-14h]@1
  int v9; // [sp+14h] [bp-10h]@1
  int v10; // [sp+18h] [bp-Ch]@1
  int v11; // [sp+1Ch] [bp-8h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v5 = 240;
  v6 = 80;
  v7 = 256;
  v8 = 96;
  v9 = 256;
  v10 = 80;
  v11 = 272;
  v12 = 96;
  ++*(_DWORD *)(a1 + 120);
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 == 1 )
    {
      if ( *(_DWORD *)(a1 + 120) >= 48 )
      {
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32);
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36);
      }
      else
      {
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 32) + (Random(-1, 1) << 9);
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 36) + (Random(-1, 1) << 9);
      }
    }
  }
  else
  {
    if ( *(_DWORD *)(a1 + 120) < 4 )
      *(_DWORD *)(a1 + 12) -= 1024;
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 104) == 7 )
    {
      *(_DWORD *)(a1 + 104) = 1;
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
    }
  }
  if ( *(_DWORD *)(a1 + 120) > 70 )
    *(_BYTE *)a1 = 0;
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00468990) --------------------------------------------------------
int __cdecl NPC328(int a1)
{
  int result; // eax@1

  result = a1 + 84;
  *(_DWORD *)result = 96;
  *(_DWORD *)(result + 4) = 0;
  *(_DWORD *)(result + 8) = 128;
  *(_DWORD *)(result + 12) = 48;
  return result;
}

//----- (004689E0) --------------------------------------------------------
signed int __cdecl NPC329(int a1)
{
  int v1; // ecx@2
  signed int result; // eax@2
  int v3; // ecx@3

  if ( ++*(_DWORD *)(a1 + 100) / 2 % 2 )
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 48;
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 64;
    result = 16;
    *(_DWORD *)(v1 + 12) = 16;
  }
  else
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 64;
    *(_DWORD *)(v3 + 4) = 0;
    *(_DWORD *)(v3 + 8) = 80;
    result = 16;
    *(_DWORD *)(v3 + 12) = 16;
  }
  return result;
}

//----- (00468A90) --------------------------------------------------------
int __cdecl NPC330(int a1)
{
  int *v1; // edx@29
  int result; // eax@29
  int v3; // [sp+4h] [bp-30h]@1
  int v4; // [sp+8h] [bp-2Ch]@1
  int v5; // [sp+Ch] [bp-28h]@1
  int v6; // [sp+10h] [bp-24h]@1
  int v7; // [sp+14h] [bp-20h]@1
  int v8; // [sp+18h] [bp-1Ch]@1
  int v9; // [sp+1Ch] [bp-18h]@1
  int v10; // [sp+20h] [bp-14h]@1
  int v11; // [sp+24h] [bp-10h]@1
  int v12; // [sp+28h] [bp-Ch]@1
  int v13; // [sp+2Ch] [bp-8h]@1
  int v14; // [sp+30h] [bp-4h]@1

  v3 = 144;
  v4 = 136;
  v5 = 160;
  v6 = 152;
  v7 = 160;
  v8 = 136;
  v9 = 176;
  v10 = 152;
  v11 = 176;
  v12 = 136;
  v13 = 192;
  v14 = 152;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      Change_Map_Parts(*(_DWORD *)(a1 + 8) / 512 / 16, *(_DWORD *)(a1 + 12) / 512 / 16, 0);
      if ( *(_DWORD *)(a1 + 76) )
        *(_DWORD *)(a1 + 116) = 30;
      else
        *(_DWORD *)(a1 + 116) = 10;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 16) -= 64;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 4) & 1 )
        *(_DWORD *)(a1 + 116) = 20;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) -= 64;
      if ( *(_DWORD *)(a1 + 4) & 2 )
        *(_DWORD *)(a1 + 116) = 30;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 16) += 64;
      *(_DWORD *)(a1 + 20) = 0;
      if ( *(_DWORD *)(a1 + 4) & 4 )
        *(_DWORD *)(a1 + 116) = 40;
      break;
    case 0x28:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) += 64;
      if ( *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 116) = 10;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 16) < -1024 )
    *(_DWORD *)(a1 + 16) = -1024;
  if ( *(_DWORD *)(a1 + 16) > 1024 )
    *(_DWORD *)(a1 + 16) = 1024;
  if ( *(_DWORD *)(a1 + 20) < -1024 )
    *(_DWORD *)(a1 + 20) = -1024;
  if ( *(_DWORD *)(a1 + 20) > 1024 )
    *(_DWORD *)(a1 + 20) = 1024;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00468D70) --------------------------------------------------------
int __cdecl NPC331(int a1)
{
  int *v1; // ecx@21
  int v2; // edx@21
  int result; // eax@21
  int v4; // [sp+0h] [bp-44h]@1
  int v5; // [sp+4h] [bp-40h]@1
  int v6; // [sp+8h] [bp-3Ch]@1
  int v7; // [sp+Ch] [bp-38h]@1
  int v8; // [sp+10h] [bp-34h]@1
  int v9; // [sp+14h] [bp-30h]@1
  int v10; // [sp+18h] [bp-2Ch]@1
  int v11; // [sp+1Ch] [bp-28h]@1
  int v12; // [sp+20h] [bp-24h]@1
  int v13; // [sp+24h] [bp-20h]@1
  int v14; // [sp+28h] [bp-1Ch]@1
  int v15; // [sp+2Ch] [bp-18h]@1
  int v16; // [sp+30h] [bp-14h]@1
  int v17; // [sp+34h] [bp-10h]@1
  int v18; // [sp+38h] [bp-Ch]@1
  int v19; // [sp+3Ch] [bp-8h]@1
  int v20; // [sp+40h] [bp-4h]@1

  v5 = 288;
  v6 = 80;
  v7 = 304;
  v8 = 96;
  v9 = 304;
  v10 = 80;
  v11 = 320;
  v12 = 96;
  v13 = 288;
  v14 = 96;
  v15 = 304;
  v16 = 112;
  v17 = 304;
  v18 = 96;
  v19 = 320;
  v20 = 112;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 10 && *(_DWORD *)(a1 + 4) & 8 )
      {
        *(_BYTE *)a1 = 0;
        Create_Effect(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 2, 0);
      }
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( *(_DWORD *)(a1 + 4) & 8 )
  {
    *(_DWORD *)(a1 + 0x14) = -512;
    *(_DWORD *)(a1 + 116) = 10;
  }
LABEL_11:
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( ++*(_DWORD *)(a1 + 100) > 3 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    if ( *(_DWORD *)(a1 + 76) )
      --*(_DWORD *)(a1 + 104);
    else
      ++*(_DWORD *)(a1 + 104);
    if ( *(_DWORD *)(a1 + 104) < 0 )
      *(_DWORD *)(a1 + 104) += 4;
    if ( *(_DWORD *)(a1 + 104) > 3 )
      *(_DWORD *)(a1 + 104) -= 4;
  }
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00468F50) --------------------------------------------------------
int __cdecl NPC332(int a1)
{
  int X_Vel; // ST24_4@12
  int v2; // ST24_4@13
  int *v3; // edx@19
  int result; // eax@19
  int v5; // [sp+0h] [bp-38h]@1
  int v6; // [sp+8h] [bp-30h]@1
  int v7; // [sp+Ch] [bp-2Ch]@1
  int v8; // [sp+10h] [bp-28h]@1
  int v9; // [sp+14h] [bp-24h]@1
  int v10; // [sp+18h] [bp-20h]@1
  int v11; // [sp+1Ch] [bp-1Ch]@1
  int v12; // [sp+20h] [bp-18h]@1
  int v13; // [sp+24h] [bp-14h]@1
  int v14; // [sp+28h] [bp-10h]@1
  int v15; // [sp+2Ch] [bp-Ch]@1
  int v16; // [sp+30h] [bp-8h]@1
  int v17; // [sp+34h] [bp-4h]@1

  v6 = 144;
  v7 = 96;
  v8 = 168;
  v9 = 120;
  v10 = 168;
  v11 = 96;
  v12 = 192;
  v13 = 120;
  v14 = 192;
  v15 = 96;
  v16 = 216;
  v17 = 120;
  v5 = *(_DWORD *)(a1 + 116);
  if ( v5 )
  {
    if ( v5 != 1 )
      goto LABEL_15;
  }
  else
  {
    Play_Sound_Effect(Sfx_Missile_Impact, 1);
    *(_DWORD *)(a1 + 116) = 1;
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 0x10) = 1024;
    else
      *(_DWORD *)(a1 + 0x10) = -1024;
  }
  if ( ++*(_DWORD *)(a1 + 100) > 1 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    if ( ++*(_DWORD *)(a1 + 104) > 2 )
      *(_DWORD *)(a1 + 104) = 0;
  }
  if ( ++*(_DWORD *)(a1 + 120) % 6 == 1 )
  {
    if ( *(_DWORD *)(a1 + 76) )
    {
      v2 = (Random(4, 16) << 9) / 8;
      NPC_Create(
        Projectile_Balrog_Energy_Bounce|0x140,
        *(_DWORD *)(a1 + 8),
        *(_DWORD *)(a1 + 12),
        v2,
        -1024,
        0,
        NULL,
        256);
    }
    else
    {
      X_Vel = (Random(-16, -4) << 9) / 8;
      NPC_Create(
        Projectile_Balrog_Energy_Bounce|0x140,
        *(_DWORD *)(a1 + 8),
        *(_DWORD *)(a1 + 12),
        X_Vel,
        -1024,
        0,
        NULL,
        256);
    }
    Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
  }
LABEL_15:
  if ( *(_DWORD *)(a1 + 4) & 1 )
    *(_BYTE *)a1 = 0;
  if ( *(_DWORD *)(a1 + 4) & 4 )
    *(_BYTE *)a1 = 0;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v3 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v3;
  *(_DWORD *)(result + 4) = v3[1];
  *(_DWORD *)(result + 8) = v3[2];
  *(_DWORD *)(result + 12) = v3[3];
  return result;
}

//----- (00469140) --------------------------------------------------------
int __cdecl NPC333(int a1)
{
  int *v1; // eax@13
  int v2; // ecx@13
  int result; // eax@13
  int v4; // [sp+0h] [bp-24h]@1
  int v5; // [sp+4h] [bp-20h]@1
  int v6; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+Ch] [bp-18h]@1
  int v8; // [sp+10h] [bp-14h]@1
  int v9; // [sp+14h] [bp-10h]@1
  int v10; // [sp+18h] [bp-Ch]@1
  int v11; // [sp+1Ch] [bp-8h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v5 = 80;
  v6 = 120;
  v7 = 104;
  v8 = 144;
  v9 = 104;
  v10 = 120;
  v11 = 128;
  v12 = 144;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_13;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12);
    Play_Sound_Effect(Sfx_Ballos_Ball_etc_Charge_Curly_charging_her_gun, 1);
    *(_DWORD *)(a1 + 12) = Quote.Y_Pos;
  }
  if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
    *(_DWORD *)(a1 + 104) = 0;
  else
    *(_DWORD *)(a1 + 104) = 1;
  if ( !*(_DWORD *)(a1 + 76) && *(_DWORD *)(a1 + 120) == 20 )
    NPC_Create((NPC_Names)146, *(_DWORD *)(a1 + 32), *(_DWORD *)(a1 + 36), 0, 0, 0, NULL, 256);
  if ( *(_DWORD *)(a1 + 120) > 40 )
    *(_BYTE *)a1 = 0;
LABEL_13:
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00469290) --------------------------------------------------------
int __cdecl NPC334(int a1)
{
  int *v1; // ecx@13
  int v2; // edx@13
  int result; // eax@13
  int *v4; // ecx@14
  int v5; // edx@14
  int v6; // [sp+0h] [bp-44h]@1
  int v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+8h] [bp-3Ch]@1
  int v9; // [sp+Ch] [bp-38h]@1
  int v10; // [sp+10h] [bp-34h]@1
  int v11; // [sp+14h] [bp-30h]@1
  int v12; // [sp+18h] [bp-2Ch]@1
  int v13; // [sp+1Ch] [bp-28h]@1
  int v14; // [sp+20h] [bp-24h]@1
  int v15; // [sp+24h] [bp-20h]@1
  int v16; // [sp+28h] [bp-1Ch]@1
  int v17; // [sp+2Ch] [bp-18h]@1
  int v18; // [sp+30h] [bp-14h]@1
  int v19; // [sp+34h] [bp-10h]@1
  int v20; // [sp+38h] [bp-Ch]@1
  int v21; // [sp+3Ch] [bp-8h]@1
  int v22; // [sp+40h] [bp-4h]@1

  v15 = 160;
  v16 = 184;
  v17 = 168;
  v18 = 200;
  v19 = 168;
  v20 = 184;
  v21 = 176;
  v22 = 200;
  v7 = 176;
  v8 = 184;
  v9 = 184;
  v10 = 200;
  v11 = 184;
  v12 = 184;
  v13 = 192;
  v14 = 200;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 )
  {
    if ( v6 != 10 )
      goto LABEL_12;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 10;
    if ( *(_DWORD *)(a1 + 76) )
    {
      *(_DWORD *)(a1 + 8) = Quote.X_Pos - 5120;
      *(_DWORD *)(a1 + 12) = Quote.Y_Pos - 1024;
    }
    else
    {
      *(_DWORD *)(a1 + 8) += 5120;
      *(_DWORD *)(a1 + 12) -= 9216;
    }
  }
  if ( ++*(_DWORD *)(a1 + 120) / 8 % 2 )
    *(_DWORD *)(a1 + 104) = 0;
  else
    *(_DWORD *)(a1 + 104) = 1;
  if ( *(_DWORD *)(a1 + 120) >= 64 )
    *(_BYTE *)a1 = 0;
LABEL_12:
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  else
  {
    v1 = &v15 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  return result;
}

//----- (00469430) --------------------------------------------------------
int __cdecl NPC335(int a1)
{
  int *v1; // ecx@11
  int v2; // edx@11
  int result; // eax@11
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 0;
  v5 = 16;
  v6 = 16;
  v7 = 32;
  v8 = 16;
  v9 = 16;
  v10 = 32;
  v11 = 32;
  v12 = 32;
  v13 = 16;
  v14 = 48;
  v15 = 32;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 120) = Random(3, 20);
      goto LABEL_3;
    case 1:
LABEL_3:
      if ( --*(_DWORD *)(a1 + 120) <= 0 )
      {
        *(_DWORD *)(a1 + 116) = 2;
        *(_DWORD *)(a1 + 120) = Random(10, 50);
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 16) = 1536;
      }
      break;
    case 2:
      if ( --*(_DWORD *)(a1 + 120) <= 0 )
      {
        *(_DWORD *)(a1 + 116) = 3;
        *(_DWORD *)(a1 + 120) = Random(40, 50);
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 20) = Random(-256, 256);
      }
      break;
    case 3:
      if ( --*(_DWORD *)(a1 + 120) <= 0 )
      {
        *(_DWORD *)(a1 + 116) = 1;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 0;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 16) -= 16;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00469610) --------------------------------------------------------
void __cdecl NPC336(int a1)
{
  int v1; // eax@8
  int v2; // [sp+0h] [bp-8h]@1

  v2 = *(_DWORD *)(a1 + 116);
  if ( v2 )
  {
    if ( v2 == 10 && ++*(_DWORD *)(a1 + 120) % 4 == 1 )
    {
      v1 = Random(0, 13);
      NPC_Create(Treasure_Chest_Closed|0x140, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v1 << 13), 0, 0, 0, NULL, 0);
    }
  }
  else if ( Quote.Invincibility_Timer )
  {
    *(_BYTE *)a1 = 0;
  }
}

//----- (004696B0) --------------------------------------------------------
int __cdecl NPC337(int a1)
{
  int *v1; // ecx@13
  int v2; // edx@13
  int result; // eax@13
  int v4; // [sp+0h] [bp-24h]@1
  int v5; // [sp+4h] [bp-20h]@1
  int v6; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+Ch] [bp-18h]@1
  int v8; // [sp+10h] [bp-14h]@1
  int v9; // [sp+14h] [bp-10h]@1
  int v10; // [sp+18h] [bp-Ch]@1
  int v11; // [sp+1Ch] [bp-8h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v5 = 256;
  v6 = 112;
  v7 = 288;
  v8 = 152;
  v9 = 288;
  v10 = 112;
  v11 = 320;
  v12 = 152;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 != 2 )
        goto LABEL_11;
      goto LABEL_7;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 12) -= 4096;
  }
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 116) = 2;
  *(_DWORD *)(a1 + 104) = 0;
LABEL_7:
  if ( ++*(_DWORD *)(a1 + 100) > 50 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 1 )
    *(_DWORD *)(a1 + 104) = 0;
LABEL_11:
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 20) > 1535 )
    *(_DWORD *)(a1 + 20) = 1535;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  return result;
}

//----- (00469800) --------------------------------------------------------
void __cdecl NPC338(void *a1)
{
  int *v1; // edx@25
  char *v2; // eax@25
  int *v3; // edx@26
  char *v4; // eax@26
  int v5; // [sp+0h] [bp-44h]@1
  int v6; // [sp+4h] [bp-40h]@1
  int v7; // [sp+8h] [bp-3Ch]@1
  int v8; // [sp+Ch] [bp-38h]@1
  int v9; // [sp+10h] [bp-34h]@1
  int v10; // [sp+14h] [bp-30h]@1
  int v11; // [sp+18h] [bp-2Ch]@1
  int v12; // [sp+1Ch] [bp-28h]@1
  int v13; // [sp+20h] [bp-24h]@1
  int v14; // [sp+24h] [bp-20h]@1
  int v15; // [sp+28h] [bp-1Ch]@1
  int v16; // [sp+2Ch] [bp-18h]@1
  int v17; // [sp+30h] [bp-14h]@1
  int v18; // [sp+34h] [bp-10h]@1
  int v19; // [sp+38h] [bp-Ch]@1
  int v20; // [sp+3Ch] [bp-8h]@1
  int v21; // [sp+40h] [bp-4h]@1

  v14 = 288;
  v15 = 0;
  v16 = 304;
  v17 = 16;
  v18 = 304;
  v19 = 0;
  v20 = 320;
  v21 = 16;
  v6 = 288;
  v7 = 16;
  v8 = 304;
  v9 = 32;
  v10 = 304;
  v11 = 16;
  v12 = 320;
  v13 = 32;
  v5 = *((_DWORD *)a1 + 29);
  if ( v5 )
  {
    if ( v5 != 1 )
      goto LABEL_24;
  }
  else
  {
    *((_DWORD *)a1 + 29) = 1;
    *((_DWORD *)a1 + 36) = 4096;
    *((_DWORD *)a1 + 38) = 4096;
    *((_DWORD *)a1 + 41) = 3;
    *((_WORD *)a1 + 40) |= 0x20u;
    *((_DWORD *)a1 + 9) = *((_DWORD *)a1 + 3);
    *((_DWORD *)a1 + 5) = (Random(-10, 10) << 9) / 2;
  }
  if ( ++*((_DWORD *)a1 + 25) > 2 )
  {
    *((_DWORD *)a1 + 25) = 0;
    ++*((_DWORD *)a1 + 26);
  }
  if ( *((_DWORD *)a1 + 26) > 1 )
    *((_DWORD *)a1 + 26) = 0;
  if ( *((_DWORD *)a1 + 3) >= *((_DWORD *)a1 + 9) )
    *((_DWORD *)a1 + 5) -= 128;
  else
    *((_DWORD *)a1 + 5) += 128;
  if ( *((_DWORD *)a1 + 19) )
    *((_DWORD *)a1 + 4) += 32;
  else
    *((_DWORD *)a1 + 4) -= 32;
  if ( *((_DWORD *)a1 + 4) > 1024 )
    *((_DWORD *)a1 + 4) = 1024;
  if ( *((_DWORD *)a1 + 4) < -1024 )
    *((_DWORD *)a1 + 4) = -1024;
  if ( *((_DWORD *)a1 + 2) < 0
    || *((_DWORD *)a1 + 3) < 0
    || *((_DWORD *)a1 + 2) > Current_Map.Width << 13
    || *((_DWORD *)a1 + 3) > Current_Map.Length << 13 )
  {
    Vanish_NPC((NPC_vars *)a1);
    return;
  }
LABEL_24:
  *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
  *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
  if ( *((_DWORD *)a1 + 19) )
  {
    v3 = &v6 + 4 * *((_DWORD *)a1 + 26);
    v4 = (char *)a1 + 84;
    *(_DWORD *)v4 = *v3;
    *((_DWORD *)v4 + 1) = v3[1];
    *((_DWORD *)v4 + 2) = v3[2];
    *((_DWORD *)v4 + 3) = v3[3];
  }
  else
  {
    v1 = &v14 + 4 * *((_DWORD *)a1 + 26);
    v2 = (char *)a1 + 84;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    *((_DWORD *)v2 + 2) = v1[2];
    *((_DWORD *)v2 + 3) = v1[3];
  }
}

//----- (00469AA0) --------------------------------------------------------
void __cdecl NPC339(int a1)
{
  Directions v1; // ST14_4@7
  int v2; // eax@7
  int v3; // [sp+0h] [bp-4h]@1

  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
  {
    if ( v3 != 1 )
      return;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
    *(_DWORD *)(a1 + 120) = Random(0, 40);
  }
  if ( *(_DWORD *)(a1 + 120) )
  {
    --*(_DWORD *)(a1 + 120);
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 0;
    v1 = *(_DWORD *)(a1 + 76);
    v2 = Random(-16, 16);
    NPC_Create((NPC_Names)338, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12) + (v2 << 9), 0, 0, v1, NULL, 256);
  }
}

//----- (00469B40) --------------------------------------------------------
int __cdecl NPC340(NPC_vars *a1)
{
  int *v1; // ecx@203
  char *v2; // edx@203
  int result; // eax@203
  int *v4; // ecx@204
  char *v5; // edx@204
  int v6; // [sp+0h] [bp-170h]@29
  int v7; // [sp+4h] [bp-16Ch]@1
  int v8; // [sp+8h] [bp-168h]@202
  int v9; // [sp+Ch] [bp-164h]@202
  int v10; // [sp+10h] [bp-160h]@202
  int v11; // [sp+14h] [bp-15Ch]@202
  int v12; // [sp+18h] [bp-158h]@202
  int v13; // [sp+1Ch] [bp-154h]@202
  int v14; // [sp+20h] [bp-150h]@202
  int v15; // [sp+24h] [bp-14Ch]@202
  int v16; // [sp+28h] [bp-148h]@202
  int v17; // [sp+2Ch] [bp-144h]@202
  int v18; // [sp+30h] [bp-140h]@202
  int v19; // [sp+34h] [bp-13Ch]@202
  int v20; // [sp+38h] [bp-138h]@202
  int v21; // [sp+3Ch] [bp-134h]@202
  int v22; // [sp+40h] [bp-130h]@202
  int v23; // [sp+44h] [bp-12Ch]@202
  int v24; // [sp+48h] [bp-128h]@202
  int v25; // [sp+4Ch] [bp-124h]@202
  int v26; // [sp+50h] [bp-120h]@202
  int v27; // [sp+54h] [bp-11Ch]@202
  int v28; // [sp+58h] [bp-118h]@202
  int v29; // [sp+5Ch] [bp-114h]@202
  int v30; // [sp+60h] [bp-110h]@202
  int v31; // [sp+64h] [bp-10Ch]@202
  int v32; // [sp+68h] [bp-108h]@202
  int v33; // [sp+6Ch] [bp-104h]@202
  int v34; // [sp+70h] [bp-100h]@202
  int v35; // [sp+74h] [bp-FCh]@202
  int v36; // [sp+78h] [bp-F8h]@202
  int v37; // [sp+7Ch] [bp-F4h]@202
  int v38; // [sp+80h] [bp-F0h]@202
  int v39; // [sp+84h] [bp-ECh]@202
  int v40; // [sp+88h] [bp-E8h]@202
  int v41; // [sp+8Ch] [bp-E4h]@202
  int v42; // [sp+90h] [bp-E0h]@202
  int v43; // [sp+94h] [bp-DCh]@202
  int v44; // [sp+98h] [bp-D8h]@202
  int v45; // [sp+9Ch] [bp-D4h]@202
  int v46; // [sp+A0h] [bp-D0h]@202
  int v47; // [sp+A4h] [bp-CCh]@202
  int v48; // [sp+A8h] [bp-C8h]@202
  int v49; // [sp+ACh] [bp-C4h]@202
  int v50; // [sp+B0h] [bp-C0h]@202
  int v51; // [sp+B4h] [bp-BCh]@202
  int i; // [sp+B8h] [bp-B8h]@87
  int X_Pos; // [sp+BCh] [bp-B4h]@89
  int v54; // [sp+C0h] [bp-B0h]@202
  int v55; // [sp+C4h] [bp-ACh]@202
  int v56; // [sp+C8h] [bp-A8h]@202
  int v57; // [sp+CCh] [bp-A4h]@202
  int v58; // [sp+D0h] [bp-A0h]@202
  int v59; // [sp+D4h] [bp-9Ch]@202
  int v60; // [sp+D8h] [bp-98h]@202
  int v61; // [sp+DCh] [bp-94h]@202
  int v62; // [sp+E0h] [bp-90h]@202
  int v63; // [sp+E4h] [bp-8Ch]@202
  int v64; // [sp+E8h] [bp-88h]@202
  int v65; // [sp+ECh] [bp-84h]@202
  int v66; // [sp+F0h] [bp-80h]@202
  int v67; // [sp+F4h] [bp-7Ch]@202
  int v68; // [sp+F8h] [bp-78h]@202
  int v69; // [sp+FCh] [bp-74h]@202
  int v70; // [sp+100h] [bp-70h]@202
  int v71; // [sp+104h] [bp-6Ch]@202
  int v72; // [sp+108h] [bp-68h]@202
  int v73; // [sp+10Ch] [bp-64h]@202
  int v74; // [sp+110h] [bp-60h]@202
  int v75; // [sp+114h] [bp-5Ch]@202
  int v76; // [sp+118h] [bp-58h]@202
  int v77; // [sp+11Ch] [bp-54h]@202
  int v78; // [sp+120h] [bp-50h]@202
  int v79; // [sp+124h] [bp-4Ch]@202
  int v80; // [sp+128h] [bp-48h]@202
  int v81; // [sp+12Ch] [bp-44h]@202
  int v82; // [sp+130h] [bp-40h]@202
  int v83; // [sp+134h] [bp-3Ch]@202
  int v84; // [sp+138h] [bp-38h]@202
  int v85; // [sp+13Ch] [bp-34h]@202
  int v86; // [sp+140h] [bp-30h]@202
  int v87; // [sp+144h] [bp-2Ch]@202
  int v88; // [sp+148h] [bp-28h]@202
  int v89; // [sp+14Ch] [bp-24h]@202
  int v90; // [sp+150h] [bp-20h]@202
  int v91; // [sp+154h] [bp-1Ch]@202
  int v92; // [sp+158h] [bp-18h]@202
  int v93; // [sp+15Ch] [bp-14h]@202
  int v94; // [sp+160h] [bp-10h]@202
  int v95; // [sp+164h] [bp-Ch]@202
  int v96; // [sp+168h] [bp-8h]@202
  int v97; // [sp+16Ch] [bp-4h]@202

  v7 = a1->Current_State;
  if ( v7 > 222 )
  {
    if ( v7 > 310 )
    {
      if ( v7 > 1002 )
      {
        if ( v7 == 1003 )
        {
          if ( ++a1->Wait_Timer > 30 )
          {
            a1->Wait_Timer = 0;
            a1->Current_State = 1004;
            a1->Ani_Num = 3;
            a1->Y_vel -= 2560;
            a1->Direction = 0;
            a1->Entity_Flags |= 8u;
          }
        }
        else if ( v7 == 1004 )
        {
          if ( a1->Y_pos < 0 )
          {
            a1->X_vel = 0;
            a1->Y_vel = 0;
            a1->Current_State = 1005;
            a1->Wait_Timer = 0;
            Start_Flash(0, 0, 2);
            Play_Sound_Effect(Sfx_Teleport, 1);
          }
          if ( ++a1->Wait_Timer / 2 % 2 )
            a1->Ani_Num = 8;
          else
            a1->Ani_Num = 9;
        }
      }
      else if ( v7 == 1002 )
      {
        if ( ++a1->Wait_Timer > 150 )
        {
          a1->Wait_Timer = 0;
          a1->Current_State = 1003;
          a1->Ani_Num = 3;
        }
        if ( a1->Wait_Timer / 2 % 2 )
          a1->X_pos = a1->Curly_Target_X + 512;
        else
          a1->X_pos = a1->Curly_Target_X - 512;
      }
      else if ( v7 == 320 )
      {
        a1->X_vel = 0;
        a1->Y_vel = 0;
        a1->Direction = 2;
        if ( ++a1->Wait_Timer == 40 )
          Start_Flash(0, 0, 2);
        if ( a1->Wait_Timer > 50 && a1->Wait_Timer % 10 == 1 )
        {
          X_Pos = ((4 * a1->Wait_Timer - 200) / 10 + 2) << 13;
          NPC_Create(Forcefield|0x140, X_Pos, 155648, 0, 0, 0, NULL, 256);
        }
        if ( a1->Wait_Timer > 140 )
          a1->Current_State = 240;
        if ( ++a1->ani_wait / 2 % 2 )
          a1->Ani_Num = 4;
        else
          a1->Ani_Num = 5;
      }
      else
      {
        if ( v7 == 1000 )
        {
          a1->Current_State = 1001;
          a1->Wait_Timer = 0;
          a1->Ani_Num = 10;
          a1->Curly_Target_X = a1->X_pos;
          a1->X_vel = 0;
          a1->Entity_Flags &= 0xFFDFu;
          Create_Dust_Clouds(a1->X_pos, a1->Y_pos, 16, 16);
          Play_Sound_Effect(Sfx_Explosion, 1);
        }
        else if ( v7 != 1001 )
        {
          goto LABEL_202;
        }
        a1->Y_vel += 32;
        if ( a1->Y_vel > 1535 )
          a1->Y_vel = 1535;
        if ( ++a1->Wait_Timer / 2 % 2 )
          a1->X_pos = a1->Curly_Target_X + 512;
        else
          a1->X_pos = a1->Curly_Target_X - 512;
        if ( a1->Collision_flags & 8 )
        {
          a1->Current_State = 1002;
          a1->Wait_Timer = 0;
        }
      }
    }
    else if ( v7 == 310 )
    {
LABEL_141:
      ++a1->ani_wait;
      if ( ++a1->Wait_Timer <= 200 || a1->ani_wait >= 20 )
        a1->Direction = 0;
      else
        a1->Direction = 2;
      if ( a1->ani_wait / 2 % 2 )
        a1->Ani_Num = 4;
      else
        a1->Ani_Num = 5;
      if ( a1->X_pos >= a1->Curly_Target_X )
        a1->X_vel -= 64;
      else
        a1->X_vel += 64;
      if ( a1->Y_pos >= a1->Curly_Target_Y )
        a1->Y_vel -= 64;
      else
        a1->Y_vel += 64;
      if ( a1->X_vel > 1024 )
        a1->X_vel = 1024;
      if ( a1->X_vel < -1024 )
        a1->X_vel = -1024;
      if ( a1->Y_vel > 1024 )
        a1->Y_vel = 1024;
      if ( a1->Y_vel < -1024 )
        a1->Y_vel = -1024;
      if ( a1->Wait_Timer > 200 && a1->Wait_Timer % 40 == 1 )
      {
        a1->ani_wait = 0;
        NPC_Create(Forcefield|0x140, Quote.X_Pos, 155648, 0, 0, 0, NULL, 256);
      }
      if ( a1->Wait_Timer > 480 )
      {
        a1->Current_State = 320;
        a1->Wait_Timer = 0;
      }
    }
    else
    {
      switch ( v7 )
      {
        case 230:
          a1->Current_State = 231;
          a1->Wait_Timer = 0;
          a1->Ani_Num = 8;
          a1->ani_wait = 0;
          a1->X_vel = 0;
          a1->Damage = 10;
          a1->Direction = 2;
          Play_Sound_Effect(Sfx_Silly_Explosion, 1);
          goto LABEL_102;
        case 231:
LABEL_102:
          a1->Y_vel = 2048;
          if ( ++a1->Wait_Timer / 2 % 2 )
            a1->Ani_Num = 8;
          else
            a1->Ani_Num = 9;
          if ( a1->Collision_flags & 8 )
          {
            a1->Current_State = 232;
            a1->Wait_Timer = 0;
            a1->Damage = 3;
            if ( Quote.X_Pos >= a1->X_pos )
              a1->Direction = 2;
            else
              a1->Direction = 0;
            for ( i = 0; i < 8; ++i )
            {
              X_Pos = a1->X_pos + (Random(-16, 16) << 9);
              NPC_Create(Smoke, X_Pos, a1->Y_pos + 5120, 0, 0, 0, NULL, 256);
            }
            NPC_Create((NPC_Names)332, a1->X_pos - 6144, a1->Y_pos + 6144, 0, 0, 0, NULL, 256);
            NPC_Create((NPC_Names)332, a1->X_pos + 6144, a1->Y_pos + 6144, 0, 0, Right, NULL, 256);
            Set_Hard_Quake_Duration(10);
            Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
          }
          if ( a1->count1 < 4 && Quote.Y_Pos > a1->Y_pos - 0x2000 && Quote.Y_Pos < a1->Y_pos + 0x2000 )
            a1->Current_State = 201;
          break;
        case 232:
          ++a1->Wait_Timer;
          a1->X_vel = 0;
          a1->Ani_Num = 3;
          if ( a1->Wait_Timer > 30 )
          {
            if ( a1->count1 <= 3 )
              a1->Current_State = 201;
            else
              a1->Current_State = 242;
          }
          break;
        case 240:
          a1->Current_State = 241;
          a1->Direction = 0;
          goto LABEL_124;
        case 241:
LABEL_124:
          a1->Y_vel += 128;
          if ( a1->Y_vel > 1535 )
            a1->Y_vel = 1535;
          if ( ++a1->ani_wait / 2 % 2 )
            a1->Ani_Num = 4;
          else
            a1->Ani_Num = 5;
          if ( a1->Collision_flags & 8 )
          {
            a1->Current_State = 242;
            a1->Wait_Timer = 0;
            a1->Ani_Num = 3;
            if ( Quote.X_Pos >= a1->X_pos )
              a1->Direction = 2;
            else
              a1->Direction = 0;
          }
          break;
        case 242:
          a1->X_vel = 3 * a1->X_vel / 4;
          a1->Ani_Num = 3;
          if ( ++a1->Wait_Timer > 10 )
            a1->Current_State = 110;
          break;
        case 300:
          a1->Current_State = 310;
          a1->Wait_Timer = 0;
          a1->Y_vel = -1536;
          if ( a1->X_pos <= 163840 )
          {
            a1->Direction = 0;
            a1->Curly_Target_X = Quote.X_Pos;
            a1->Curly_Target_Y = 90112;
          }
          else
          {
            a1->Direction = 2;
            a1->Curly_Target_X = Quote.X_Pos;
            a1->Curly_Target_Y = 90112;
          }
          a1->ani_wait = 0;
          goto LABEL_141;
        default:
          break;
      }
    }
  }
  else if ( v7 == 222 )
  {
    ++a1->Wait_Timer;
    a1->X_vel = 0;
    a1->Ani_Num = 8;
    if ( a1->Wait_Timer > 30 )
    {
      if ( a1->count1 <= 3 )
        a1->Current_State = 201;
      else
        a1->Current_State = 240;
    }
  }
  else
  {
    switch ( v7 )
    {
      case 0:
        a1->Current_State = 1;
        a1->Is_Alive = -128;
        a1->EXP_Amount = 1;
        a1->Direction = 0;
        a1->Y_pos -= 3072;
        a1->Damage = 0;
        NPC_Create((NPC_Names)341, a1->X_pos, a1->Y_pos - 0x2000, 0, 0, 0, a1, 256);
        break;
      case 10:
        a1->Current_State = 11;
        a1->Wait_Timer = 0;
        goto LABEL_18;
      case 11:
LABEL_18:
        if ( ++a1->Wait_Timer > 100 )
          a1->Current_State = 100;
        break;
      case 100:
        a1->Current_State = 110;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 1;
        a1->ani_wait = 0;
        a1->Damage = 4;
        a1->Entity_Flags |= 0x20u;
        goto LABEL_22;
      case 110:
LABEL_22:
        a1->Current_State = 111;
        a1->Damage = 3;
        a1->Curly_Target_X = a1->Life;
        goto LABEL_23;
      case 111:
LABEL_23:
        if ( ++a1->ani_wait > 10 )
        {
          a1->ani_wait = 0;
          ++a1->Ani_Num;
        }
        if ( a1->Ani_Num > 2 )
          a1->Ani_Num = 1;
        ++a1->Wait_Timer;
        if ( a1->Life < a1->Curly_Target_X - 50 || a1->Wait_Timer > 150 )
        {
          v6 = a1->count2 % 5;
          if ( v6 >= 0 )
          {
            if ( v6 <= 3 )
            {
              a1->Current_State = 200;
            }
            else if ( v6 == 4 )
            {
              a1->Current_State = 300;
            }
          }
          ++a1->count2;
        }
        if ( Quote.X_Pos >= a1->X_pos )
          a1->Direction = 2;
        else
          a1->Direction = 0;
        break;
      case 200:
        a1->Current_State = 201;
        a1->count1 = 0;
        goto LABEL_41;
      case 201:
LABEL_41:
        if ( a1->X_vel )
          a1->Current_State = 203;
        else
          a1->Current_State = 202;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 3;
        a1->Damage = 3;
        ++a1->count1;
        goto LABEL_45;
      case 202:
LABEL_45:
        if ( Quote.X_Pos >= a1->X_pos )
          a1->Direction = 2;
        else
          a1->Direction = 0;
        a1->X_vel = 8 * a1->X_vel / 9;
        a1->Y_vel = 8 * a1->Y_vel / 9;
        if ( ++a1->Wait_Timer > 20 )
          a1->Current_State = 210;
        break;
      case 203:
        a1->X_vel = 8 * a1->X_vel / 9;
        a1->Y_vel = 8 * a1->Y_vel / 9;
        if ( ++a1->Wait_Timer > 20 )
        {
          if ( Quote.Y_Pos >= a1->Y_pos + 6144 )
            a1->Current_State = 230;
          else
            a1->Current_State = 220;
        }
        break;
      case 210:
        a1->Current_State = 211;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 6;
        a1->ani_wait = 0;
        a1->Y_vel = 0;
        a1->Damage = 10;
        if ( Quote.X_Pos >= a1->X_pos )
          a1->Direction = 2;
        else
          a1->Direction = 0;
        Play_Sound_Effect(Sfx_Silly_Explosion, 1);
        goto LABEL_60;
      case 211:
LABEL_60:
        if ( a1->Direction )
          a1->X_vel = 2048;
        else
          a1->X_vel = -2048;
        if ( ++a1->Wait_Timer / 2 % 2 )
          a1->Ani_Num = 6;
        else
          a1->Ani_Num = 7;
        if ( !a1->Direction && a1->Collision_flags & 1 )
        {
          a1->Current_State = 212;
          a1->Wait_Timer = 0;
          a1->Damage = 3;
          Set_Hard_Quake_Duration(10);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        if ( a1->Direction == 2 && a1->Collision_flags & 4 )
        {
          a1->Current_State = 212;
          a1->Wait_Timer = 0;
          a1->Damage = 3;
          Set_Hard_Quake_Duration(10);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        if ( a1->count1 < 4 && Quote.X_Pos > a1->X_pos - 0x2000 && Quote.X_Pos < a1->X_pos + 0x2000 )
          a1->Current_State = 201;
        break;
      case 212:
        ++a1->Wait_Timer;
        a1->X_vel = 0;
        a1->Ani_Num = 6;
        if ( a1->Wait_Timer > 30 )
        {
          if ( a1->count1 <= 3 )
            a1->Current_State = 201;
          else
            a1->Current_State = 240;
        }
        break;
      case 220:
        a1->Current_State = 221;
        a1->Wait_Timer = 0;
        a1->Ani_Num = 8;
        a1->ani_wait = 0;
        a1->X_vel = 0;
        a1->Damage = 10;
        a1->Direction = 0;
        Play_Sound_Effect(Sfx_Silly_Explosion, 1);
        goto LABEL_83;
      case 221:
LABEL_83:
        a1->Y_vel = -2048;
        if ( ++a1->Wait_Timer / 2 % 2 )
          a1->Ani_Num = 8;
        else
          a1->Ani_Num = 9;
        if ( a1->Y_pos < 24576 )
        {
          a1->Y_pos = 24576;
          a1->Y_vel = 0;
          a1->Current_State = 222;
          a1->Wait_Timer = 0;
          a1->Damage = 3;
          for ( i = 0; i < 8; ++i )
          {
            X_Pos = a1->X_pos + (Random(-16, 16) << 9);
            NPC_Create(Smoke, X_Pos, a1->Y_pos - 5120, 0, 0, 0, NULL, 256);
          }
          NPC_Create((NPC_Names)332, a1->X_pos - 6144, a1->Y_pos - 6144, 0, 0, 0, NULL, 256);
          NPC_Create((NPC_Names)332, a1->X_pos + 6144, a1->Y_pos - 6144, 0, 0, Right, NULL, 256);
          Set_Hard_Quake_Duration(10);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        if ( a1->count1 < 4 && Quote.Y_Pos > a1->Y_pos - 0x2000 && Quote.Y_Pos < a1->Y_pos + 0x2000 )
          a1->Current_State = 201;
        break;
      default:
        break;
    }
  }
LABEL_202:
  a1->X_pos += a1->X_vel;
  a1->Y_pos += a1->Y_vel;
  v54 = 0;
  v55 = 0;
  v56 = 48;
  v57 = 40;
  v58 = 48;
  v59 = 0;
  v60 = 96;
  v61 = 40;
  v62 = 96;
  v63 = 0;
  v64 = 144;
  v65 = 40;
  v66 = 144;
  v67 = 0;
  v68 = 192;
  v69 = 40;
  v70 = 192;
  v71 = 0;
  v72 = 240;
  v73 = 40;
  v74 = 240;
  v75 = 0;
  v76 = 288;
  v77 = 40;
  v78 = 0;
  v79 = 80;
  v80 = 48;
  v81 = 120;
  v82 = 48;
  v83 = 80;
  v84 = 96;
  v85 = 120;
  v86 = 96;
  v87 = 80;
  v88 = 144;
  v89 = 120;
  v90 = 144;
  v91 = 80;
  v92 = 192;
  v93 = 120;
  v94 = 192;
  v95 = 80;
  v96 = 240;
  v97 = 120;
  v8 = 0;
  v9 = 40;
  v10 = 48;
  v11 = 80;
  v12 = 48;
  v13 = 40;
  v14 = 96;
  v15 = 80;
  v16 = 96;
  v17 = 40;
  v18 = 144;
  v19 = 80;
  v20 = 144;
  v21 = 40;
  v22 = 192;
  v23 = 80;
  v24 = 192;
  v25 = 40;
  v26 = 240;
  v27 = 80;
  v28 = 240;
  v29 = 40;
  v30 = 288;
  v31 = 80;
  v32 = 0;
  v33 = 120;
  v34 = 48;
  v35 = 160;
  v36 = 48;
  v37 = 120;
  v38 = 96;
  v39 = 160;
  v40 = 96;
  v41 = 120;
  v42 = 144;
  v43 = 160;
  v44 = 144;
  v45 = 120;
  v46 = 192;
  v47 = 160;
  v48 = 192;
  v49 = 120;
  v50 = 240;
  v51 = 160;
  if ( a1->Direction )
  {
    v4 = &v8 + 4 * a1->Ani_Num;
    v5 = (char *)&a1->Rect;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    result = v4[2];
    *((_DWORD *)v5 + 2) = result;
    *((_DWORD *)v5 + 3) = v4[3];
  }
  else
  {
    v1 = &v54 + 4 * a1->Ani_Num;
    v2 = (char *)&a1->Rect;
    *(_DWORD *)v2 = *v1;
    *((_DWORD *)v2 + 1) = v1[1];
    result = v1[2];
    *((_DWORD *)v2 + 2) = result;
    *((_DWORD *)v2 + 3) = v1[3];
  }
  return result;
}

//----- (0046B240) --------------------------------------------------------
void __cdecl NPC341(NPC_vars *npc)
{
  int *v1; // eax@9
  char *v2; // ecx@9
  int v3; // [sp+0h] [bp-30h]@1
  int v4; // [sp+4h] [bp-2Ch]@1
  int v5; // [sp+8h] [bp-28h]@1
  int v6; // [sp+Ch] [bp-24h]@1
  int v7; // [sp+10h] [bp-20h]@1
  int v8; // [sp+14h] [bp-1Ch]@1
  int v9; // [sp+18h] [bp-18h]@1
  int v10; // [sp+1Ch] [bp-14h]@1
  int v11; // [sp+20h] [bp-10h]@1
  int v12; // [sp+24h] [bp-Ch]@1
  int v13; // [sp+28h] [bp-8h]@1
  int v14; // [sp+2Ch] [bp-4h]@1

  v3 = 288;
  v4 = 32;
  v5 = 320;
  v6 = 48;
  v7 = 288;
  v8 = 48;
  v9 = 320;
  v10 = 64;
  v11 = 288;
  v12 = 64;
  v13 = 320;
  v14 = 80;
  if ( npc->Parent_NPC->Current_State == 11 && npc->Parent_NPC->Wait_Timer > 50 )
    ++npc->ani_wait;
  if ( npc->ani_wait > 4 )
  {
    npc->ani_wait = 0;
    if ( npc->Ani_Num < 2 )
      ++npc->Ani_Num;
  }
  if ( npc->Parent_NPC->Ani_Num )
    npc->Is_Alive = 0;
  v1 = &v3 + 4 * npc->Ani_Num;
  v2 = (char *)&npc->Rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
}

//----- (0046B340) --------------------------------------------------------
void __cdecl NPC342(void *a1)
{
  int v1; // esi@105
  int v2; // esi@105
  int *v3; // eax@106
  char *v4; // ecx@106
  signed int v5; // [sp+4h] [bp-38h]@4
  int v6; // [sp+8h] [bp-34h]@1
  int v7; // [sp+Ch] [bp-30h]@1
  int v8; // [sp+10h] [bp-2Ch]@1
  int v9; // [sp+14h] [bp-28h]@1
  int v10; // [sp+18h] [bp-24h]@1
  int v11; // [sp+1Ch] [bp-20h]@1
  int v12; // [sp+20h] [bp-1Ch]@1
  int v13; // [sp+24h] [bp-18h]@1
  int v14; // [sp+28h] [bp-14h]@1
  int v15; // [sp+2Ch] [bp-10h]@1
  int v16; // [sp+30h] [bp-Ch]@1
  int v17; // [sp+34h] [bp-8h]@1
  unsigned __int8 v18; // [sp+3Bh] [bp-1h]@105

  v6 = 240;
  v7 = 48;
  v8 = 280;
  v9 = 88;
  v10 = 240;
  v11 = 88;
  v12 = 280;
  v13 = 128;
  v14 = 280;
  v15 = 48;
  v16 = 320;
  v17 = 88;
  if ( *((_DWORD *)a1 + 29) < 1000 && *(_DWORD *)(*((_DWORD *)a1 + 42) + 116) >= 1000 )
    *((_DWORD *)a1 + 29) = 1000;
  v5 = *((_DWORD *)a1 + 29);
  if ( v5 <= 23 )
  {
    if ( v5 == 23 )
    {
      *((_DWORD *)a1 + 26) = 2;
      *((_DWORD *)a1 + 27) -= 4;
      if ( *((_DWORD *)a1 + 27) < 0 )
        *((_DWORD *)a1 + 27) += 512;
      if ( *(_DWORD *)(*((_DWORD *)a1 + 42) + 116) == 420 )
        *((_DWORD *)a1 + 29) = 30;
    }
    else
    {
      switch ( v5 )
      {
        case 0:
          *((_DWORD *)a1 + 29) = 10;
          *((_DWORD *)a1 + 27) = 2 * (*((_DWORD *)a1 + 19) & 0xFF);
          *((_DWORD *)a1 + 19) >>= 8;
          *((_DWORD *)a1 + 28) = 192;
          *((_DWORD *)a1 + 41) = 14;
          goto LABEL_17;
        case 10:
LABEL_17:
          if ( *((_DWORD *)a1 + 28) >= 320 )
            *((_DWORD *)a1 + 29) = 11;
          else
            *((_DWORD *)a1 + 28) += 8;
          goto LABEL_90;
        case 11:
          if ( *((_DWORD *)a1 + 28) <= 304 )
            *((_DWORD *)a1 + 29) = 12;
          else
            *((_DWORD *)a1 + 28) -= 4;
          goto LABEL_90;
        case 12:
          if ( *(_DWORD *)(*((_DWORD *)a1 + 42) + 116) == 311 )
            *((_DWORD *)a1 + 29) = 20;
          goto LABEL_90;
        case 20:
          *((_DWORD *)a1 + 29) = 21;
          *((_WORD *)a1 + 40) |= 0x20u;
          *((_DWORD *)a1 + 16) = 1000;
          goto LABEL_29;
        case 21:
LABEL_29:
          *((_DWORD *)a1 + 27) -= 2;
          if ( *((_DWORD *)a1 + 27) < 0 )
            *((_DWORD *)a1 + 27) += 512;
          if ( *((_BYTE *)a1 + 156) )
          {
            if ( ++dword_4A6218 / 2 % 2 )
              *((_DWORD *)a1 + 26) = 1;
            else
              *((_DWORD *)a1 + 26) = 0;
          }
          else
          {
            *((_DWORD *)a1 + 26) = 0;
          }
          if ( *((_DWORD *)a1 + 16) < 900 )
          {
            *((_DWORD *)a1 + 29) = 22;
            *((_WORD *)a1 + 40) &= 0xFFDFu;
            Create_Dust_Clouds(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 0x2000, 32);
            Play_Sound_Effect(Sfx_Quote_Smash_Into_Ground, 1);
          }
          *(_DWORD *)(*((_DWORD *)a1 + 42) + 108) = 4;
          if ( *(_DWORD *)(*((_DWORD *)a1 + 42) + 116) == 401 )
            *((_DWORD *)a1 + 29) = 23;
          break;
        case 22:
          *((_DWORD *)a1 + 26) = 2;
          *((_DWORD *)a1 + 27) -= 2;
          if ( *((_DWORD *)a1 + 27) < 0 )
            *((_DWORD *)a1 + 27) += 512;
          if ( *(_DWORD *)(*((_DWORD *)a1 + 42) + 116) == 401 )
            *((_DWORD *)a1 + 29) = 23;
          break;
        default:
          goto LABEL_90;
      }
    }
    goto LABEL_90;
  }
  if ( v5 <= 41 )
  {
    if ( v5 == 41 )
      goto LABEL_70;
    if ( v5 == 30 )
    {
      *((_DWORD *)a1 + 29) = 31;
      *((_DWORD *)a1 + 16) = 1000;
      *((_DWORD *)a1 + 41) = 10;
      if ( !*((_DWORD *)a1 + 19) )
        *((_WORD *)a1 + 40) |= 0x20u;
      *((_DWORD *)a1 + 5) = 0;
    }
    else if ( v5 != 31 )
    {
      if ( v5 != 40 )
        goto LABEL_90;
      *((_DWORD *)a1 + 29) = 41;
      *((_DWORD *)a1 + 4) = 0;
      *((_DWORD *)a1 + 5) = 0;
      *((_DWORD *)a1 + 26) = 2;
      *((_DWORD *)a1 + 41) = 5;
      *((_WORD *)a1 + 40) &= 0xFFD7u;
      Create_Dust_Clouds(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 0x2000, 32);
      Play_Sound_Effect(Sfx_Quote_Smash_Into_Ground, 1);
LABEL_70:
      if ( *((_DWORD *)a1 + 1) & 1 )
        *((_DWORD *)a1 + 4) = 256;
      if ( *((_DWORD *)a1 + 1) & 4 )
        *((_DWORD *)a1 + 4) = -256;
      if ( *((_DWORD *)a1 + 1) & 8 )
      {
        if ( !*((_DWORD *)a1 + 4) )
        {
          if ( Quote.X_Pos >= *((_DWORD *)a1 + 2) )
            *((_DWORD *)a1 + 4) = -256;
          else
            *((_DWORD *)a1 + 4) = 256;
        }
        *((_DWORD *)a1 + 5) = -2048;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      }
      *((_DWORD *)a1 + 5) += 32;
      if ( *((_DWORD *)a1 + 5) > 1535 )
        *((_DWORD *)a1 + 5) = 1535;
      goto LABEL_90;
    }
    ++*((_DWORD *)a1 + 27);
    *((_DWORD *)a1 + 27) %= 512;
    if ( *((_DWORD *)a1 + 28) > 256 )
      --*((_DWORD *)a1 + 28);
    if ( *((_WORD *)a1 + 40) & 0x20 )
    {
      if ( *((_BYTE *)a1 + 156) )
      {
        if ( ++dword_4A6218 / 2 % 2 )
          *((_DWORD *)a1 + 26) = 1;
        else
          *((_DWORD *)a1 + 26) = 0;
      }
      else
      {
        *((_DWORD *)a1 + 26) = 0;
      }
    }
    else
    {
      *((_DWORD *)a1 + 26) = 2;
    }
    if ( *((_DWORD *)a1 + 16) < 900 )
      *((_DWORD *)a1 + 29) = 40;
    goto LABEL_90;
  }
  if ( v5 == 1000 )
  {
    *((_DWORD *)a1 + 29) = 1001;
    *((_DWORD *)a1 + 4) = 0;
    *((_DWORD *)a1 + 5) = 0;
    *((_DWORD *)a1 + 26) = 2;
    *((_WORD *)a1 + 40) &= 0xFFD7u;
    *((_DWORD *)a1 + 41) = 0;
    *((_DWORD *)a1 + 27) /= 4;
    *((_DWORD *)a1 + 17) = 0;
  }
  else if ( v5 != 1001 )
  {
    goto LABEL_90;
  }
  if ( *((_DWORD *)a1 + 27) <= 0 )
  {
    Create_Dust_Clouds(*((_DWORD *)a1 + 2), *((_DWORD *)a1 + 3), 0x2000, 32);
    Play_Sound_Effect(Sfx_Quote_Smash_Into_Ground, 1);
    Vanish_NPC((NPC_vars *)a1);
    return;
  }
  if ( --*((_DWORD *)a1 + 27) / 2 % 2 )
    *((_DWORD *)a1 + 26) = 1;
  else
    *((_DWORD *)a1 + 26) = 0;
LABEL_90:
  if ( *((_DWORD *)a1 + 29) == 21 || *((_DWORD *)a1 + 29) == 22 )
  {
    switch ( *(_DWORD *)(*((_DWORD *)a1 + 42) + 76) )
    {
      case 0:
        if ( *((_DWORD *)a1 + 27) == 140 )
        {
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) + 4096, *((_DWORD *)a1 + 3) + 6144, 0, 0, 0, NULL, 256);
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) - 4096, *((_DWORD *)a1 + 3) + 6144, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        break;
      case 1:
        if ( *((_DWORD *)a1 + 27) == 268 )
        {
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) - 6144, *((_DWORD *)a1 + 3) + 4096, 0, 0, 0, NULL, 256);
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) - 6144, *((_DWORD *)a1 + 3) - 4096, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        break;
      case 2:
        if ( *((_DWORD *)a1 + 27) == 396 )
        {
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) + 4096, *((_DWORD *)a1 + 3) - 6144, 0, 0, 0, NULL, 256);
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) - 4096, *((_DWORD *)a1 + 3) - 6144, 0, 0, 0, NULL, 256);
          NPC_Create((NPC_Names)345, *((_DWORD *)a1 + 2) - 4096, *((_DWORD *)a1 + 3) - 6144, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        break;
      case 3:
        if ( *((_DWORD *)a1 + 27) == 12 )
        {
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) + 6144, *((_DWORD *)a1 + 3) + 4096, 0, 0, 0, NULL, 256);
          NPC_Create(Smoke, *((_DWORD *)a1 + 2) + 6144, *((_DWORD *)a1 + 3) - 4096, 0, 0, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        }
        break;
      default:
        break;
    }
  }
  if ( *((_DWORD *)a1 + 29) < 40 )
  {
    v18 = *((_DWORD *)a1 + 27) / 2;
    v1 = *((_DWORD *)a1 + 42);
    *((_DWORD *)a1 + 8) = *(_DWORD *)(v1 + 8) + *((_DWORD *)a1 + 28) * GetCos(v18) / 4;
    v2 = *((_DWORD *)a1 + 42);
    *((_DWORD *)a1 + 9) = *(_DWORD *)(v2 + 12) + *((_DWORD *)a1 + 28) * GetSin(v18) / 4;
    *((_DWORD *)a1 + 4) = *((_DWORD *)a1 + 8) - *((_DWORD *)a1 + 2);
    *((_DWORD *)a1 + 5) = *((_DWORD *)a1 + 9) - *((_DWORD *)a1 + 3);
  }
  *((_DWORD *)a1 + 2) += *((_DWORD *)a1 + 4);
  *((_DWORD *)a1 + 3) += *((_DWORD *)a1 + 5);
  v3 = &v6 + 4 * *((_DWORD *)a1 + 26);
  v4 = (char *)a1 + 84;
  *(_DWORD *)v4 = *v3;
  *((_DWORD *)v4 + 1) = v3[1];
  *((_DWORD *)v4 + 2) = v3[2];
  *((_DWORD *)v4 + 3) = v3[3];
}
// 4A6218: using guessed type int dword_4A6218;

//----- (0046BD80) --------------------------------------------------------
int __cdecl NPC343(int a1)
{
  int v1; // eax@1
  int result; // eax@3

  v1 = a1 + 84;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 0;
  *(_DWORD *)(v1 + 8) = 120;
  *(_DWORD *)(v1 + 12) = 120;
  if ( ++*(_DWORD *)(a1 + 120) > 100 )
    *(_BYTE *)a1 = 0;
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
  result = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
  *(_DWORD *)(a1 + 12) = result;
  return result;
}

//----- (0046BE10) --------------------------------------------------------
int __cdecl NPC344(int a1)
{
  int v1; // ecx@2
  int v2; // edx@3
  int result; // eax@6

  if ( *(_DWORD *)(a1 + 76) )
  {
    v2 = a1 + 84;
    *(_DWORD *)v2 = 296;
    *(_DWORD *)(v2 + 4) = 0;
    *(_DWORD *)(v2 + 8) = 320;
    *(_DWORD *)(v2 + 12) = 16;
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 12288;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 272;
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 296;
    *(_DWORD *)(v1 + 12) = 16;
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 12288;
  }
  if ( ++*(_DWORD *)(a1 + 120) > 100 )
    *(_BYTE *)a1 = 0;
  result = *(_DWORD *)(a1 + 168);
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(result + 12) - 18432;
  return result;
}

//----- (0046BF00) --------------------------------------------------------
int __cdecl NPC345(int a1)
{
  int v1; // eax@10
  int v2; // ST10_4@15
  int v3; // ST0C_4@15
  int v4; // ST08_4@15
  int v5; // eax@15
  int result; // eax@17
  int *v7; // eax@23
  int v8; // ecx@23
  int v9; // [sp+0h] [bp-48h]@1
  signed int i; // [sp+4h] [bp-44h]@13
  int v11; // [sp+8h] [bp-40h]@1
  int v12; // [sp+Ch] [bp-3Ch]@1
  int v13; // [sp+10h] [bp-38h]@1
  int v14; // [sp+14h] [bp-34h]@1
  int v15; // [sp+18h] [bp-30h]@1
  int v16; // [sp+1Ch] [bp-2Ch]@1
  int v17; // [sp+20h] [bp-28h]@1
  int v18; // [sp+24h] [bp-24h]@1
  int v19; // [sp+28h] [bp-20h]@1
  int v20; // [sp+2Ch] [bp-1Ch]@1
  int v21; // [sp+30h] [bp-18h]@1
  int v22; // [sp+34h] [bp-14h]@1
  int v23; // [sp+38h] [bp-10h]@1
  int v24; // [sp+3Ch] [bp-Ch]@1
  int v25; // [sp+40h] [bp-8h]@1
  int v26; // [sp+44h] [bp-4h]@1

  v11 = 128;
  v12 = 176;
  v13 = 144;
  v14 = 192;
  v15 = 144;
  v16 = 176;
  v17 = 160;
  v18 = 192;
  v19 = 160;
  v20 = 176;
  v21 = 176;
  v22 = 192;
  v23 = 176;
  v24 = 176;
  v25 = 192;
  v26 = 192;
  v9 = *(_DWORD *)(a1 + 116);
  if ( !v9 )
  {
    *(_DWORD *)(a1 + 116) = 100;
    *(_DWORD *)(a1 + 104) = Random(0, 16) % 4;
    goto LABEL_6;
  }
  if ( v9 == 100 )
  {
LABEL_6:
    *(_DWORD *)(a1 + 20) += 64;
    if ( *(_DWORD *)(a1 + 20) > 1792 )
      *(_DWORD *)(a1 + 20) = 1792;
    if ( *(_DWORD *)(a1 + 12) > 0x10000 )
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
    v1 = (*(_DWORD *)(a1 + 120))++ / 2 % 2;
    if ( v1 )
      NPC_Create(Smoke, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 256);
    if ( *(_DWORD *)(a1 + 4) & 8 )
    {
      *(_DWORD *)(a1 + 0x14) = -512;
      *(_DWORD *)(a1 + 116) = 110;
      *(_WORD *)(a1 + 80) |= 8u;
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      Set_Quake(10);
      for ( i = 0; i < 4; ++i )
      {
        v2 = Random(-1536, 0);
        v3 = Random(-341, 341);
        v4 = *(_DWORD *)(a1 + 12) + 0x2000;
        v5 = Random(-12, 12);
        NPC_Create(Smoke, *(_DWORD *)(a1 + 8) + (v5 << 9), v4, v3, v2, 0, NULL, 256);
      }
    }
    goto LABEL_19;
  }
  if ( v9 == 110 )
  {
    *(_DWORD *)(a1 + 20) += 64;
    result = a1;
    if ( *(_DWORD *)(a1 + 12) > (Current_Map.Length << 13) + 0x4000 )
    {
      *(_BYTE *)a1 = 0;
      return result;
    }
  }
LABEL_19:
  if ( ++*(_DWORD *)(a1 + 100) > 8 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 3 )
    *(_DWORD *)(a1 + 104) = 0;
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  v7 = &v11 + 4 * *(_DWORD *)(a1 + 104);
  v8 = a1 + 84;
  *(_DWORD *)v8 = *v7;
  *(_DWORD *)(v8 + 4) = v7[1];
  *(_DWORD *)(v8 + 8) = v7[2];
  result = v7[3];
  *(_DWORD *)(v8 + 12) = result;
  return result;
}

//----- (0046C1D0) --------------------------------------------------------
int __cdecl NPC346(int a1)
{
  unsigned __int8 v1; // ST1F_1@55
  int v2; // esi@55
  int v3; // esi@55
  __int64 v4; // rax@58
  __int64 v5; // rax@63
  int result; // eax@67
  signed int v7; // [sp+0h] [bp-18h]@4

  if ( *(_DWORD *)(a1 + 116) < 1000 && *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) >= 1000 )
    *(_DWORD *)(a1 + 116) = 1000;
  v7 = *(_DWORD *)(a1 + 116);
  if ( v7 <= 40 )
  {
    if ( v7 == 40 )
    {
      *(_DWORD *)(a1 + 108) -= 2;
      if ( *(_DWORD *)(a1 + 108) < 0 )
        *(_DWORD *)(a1 + 108) += 1024;
      if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 422 )
        *(_DWORD *)(a1 + 116) = 20;
    }
    else
    {
      switch ( v7 )
      {
        case 0:
          *(_DWORD *)(a1 + 116) = 10;
          *(_DWORD *)(a1 + 108) = 4 * *(_DWORD *)(a1 + 76);
          *(_DWORD *)(a1 + 112) = 192;
          *(_DWORD *)(a1 + 104) = 0;
          goto LABEL_15;
        case 10:
LABEL_15:
          if ( *(_DWORD *)(a1 + 112) >= 448 )
            *(_DWORD *)(a1 + 116) = 11;
          else
            *(_DWORD *)(a1 + 112) += 8;
          break;
        case 11:
          if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 411 )
            *(_DWORD *)(a1 + 116) = 20;
          break;
        case 20:
          if ( --*(_DWORD *)(a1 + 108) < 0 )
            *(_DWORD *)(a1 + 108) += 1024;
          if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 421 )
            *(_DWORD *)(a1 + 116) = 40;
          if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 423 )
            *(_DWORD *)(a1 + 116) = 100;
          break;
        case 30:
          ++*(_DWORD *)(a1 + 108);
          *(_DWORD *)(a1 + 108) %= 1024;
          if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 425 )
            *(_DWORD *)(a1 + 116) = 50;
          if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 427 )
            *(_DWORD *)(a1 + 116) = 100;
          break;
        default:
          goto LABEL_50;
      }
    }
    goto LABEL_50;
  }
  if ( v7 > 1000 )
  {
    if ( v7 != 1001 )
      goto LABEL_50;
  }
  else
  {
    if ( v7 != 1000 )
    {
      if ( v7 == 50 )
      {
        *(_DWORD *)(a1 + 108) += 2;
        *(_DWORD *)(a1 + 108) %= 1024;
        if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 426 )
          *(_DWORD *)(a1 + 116) = 30;
      }
      else if ( v7 == 100 )
      {
        *(_DWORD *)(a1 + 104) = 0;
        if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 424 )
          *(_DWORD *)(a1 + 116) = 30;
        if ( *(_DWORD *)(*(_DWORD *)(a1 + 168) + 116) == 428 )
          *(_DWORD *)(a1 + 116) = 20;
      }
      goto LABEL_50;
    }
    *(_DWORD *)(a1 + 116) = 1001;
    *(_DWORD *)(a1 + 16) = 0;
    *(_DWORD *)(a1 + 20) = 0;
    *(_WORD *)(a1 + 80) &= 0xFFBFu;
  }
  *(_DWORD *)(a1 + 20) += 64;
  if ( *(_DWORD *)(a1 + 12) > Current_Map.Length << 13 )
    *(_BYTE *)a1 = 0;
LABEL_50:
  if ( *(_DWORD *)(a1 + 116) < 1000 )
  {
    if ( Quote.Y_Pos <= *(_DWORD *)(a1 + 12) - 4096 || Quote.Y_Vel >= 0 )
      *(_WORD *)(a1 + 80) |= 0x40u;
    else
      *(_WORD *)(a1 + 80) &= 0xFFBFu;
    v1 = *(_DWORD *)(a1 + 108) / 4;
    v2 = *(_DWORD *)(a1 + 168);
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(v2 + 8) + *(_DWORD *)(a1 + 112) * GetCos(v1) / 4;
    v3 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12);
    *(_DWORD *)(a1 + 36) = v3 + *(_DWORD *)(a1 + 112) * GetSin(v1) / 4 + 0x2000;
    *(_DWORD *)(a1 + 16) = *(_DWORD *)(a1 + 32) - *(_DWORD *)(a1 + 8);
    if ( *(_DWORD *)(a1 + 116) != 20 && *(_DWORD *)(a1 + 116) != 30 )
    {
      if ( *(_DWORD *)(a1 + 116) != 40 && *(_DWORD *)(a1 + 116) != 50 )
      {
        *(_DWORD *)(a1 + 104) = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
      }
      else if ( !(*(_DWORD *)(a1 + 108) / 2 % 2) )
      {
        v5 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
        *(_DWORD *)(a1 + 104) = ((signed int)v5 - HIDWORD(v5)) >> 1;
      }
    }
    else if ( !(*(_DWORD *)(a1 + 108) % 4) )
    {
      v4 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 104) = ((BYTE4(v4) & 3) + (signed int)v4) >> 2;
    }
    *(_DWORD *)(a1 + 20) = *(_DWORD *)(a1 + 104);
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
  result = a1 + 84;
  *(_DWORD *)result = 240;
  *(_DWORD *)(result + 4) = 0;
  *(_DWORD *)(result + 8) = 272;
  *(_DWORD *)(result + 12) = 16;
  return result;
}

//----- (0046C710) --------------------------------------------------------
int __cdecl NPC347(int a1)
{
  int *v1; // eax@26
  int v2; // ecx@26
  int result; // eax@26
  int v4; // [sp+4h] [bp-40h]@26
  int v5; // [sp+8h] [bp-3Ch]@26
  int v6; // [sp+Ch] [bp-38h]@26
  int v7; // [sp+10h] [bp-34h]@26
  int v8; // [sp+14h] [bp-30h]@26
  int v9; // [sp+18h] [bp-2Ch]@26
  int v10; // [sp+1Ch] [bp-28h]@26
  int v11; // [sp+20h] [bp-24h]@26
  int v12; // [sp+24h] [bp-20h]@26
  int v13; // [sp+28h] [bp-1Ch]@26
  int v14; // [sp+2Ch] [bp-18h]@26
  int v15; // [sp+30h] [bp-14h]@26
  int v16; // [sp+34h] [bp-10h]@26
  int v17; // [sp+38h] [bp-Ch]@26
  int v18; // [sp+3Ch] [bp-8h]@26
  int v19; // [sp+40h] [bp-4h]@26

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      goto LABEL_3;
    case 1:
LABEL_3:
      *(_DWORD *)(a1 + 104) = 0;
      if ( Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 0x10000 && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 0x10000 )
      {
        *(_DWORD *)(a1 + 116) = 10;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 1;
      }
      break;
    case 0xA:
      if ( ++*(_DWORD *)(a1 + 120) == 4 )
        *(_DWORD *)(a1 + 104) = 2;
      if ( *(_DWORD *)(a1 + 120) > 12 )
      {
        *(_DWORD *)(a1 + 116) = 12;
        *(_DWORD *)(a1 + 16) = 1792;
        Play_Sound_Effect(Sfx_High_Pitch_Critter_Hop, 1);
        *(_DWORD *)(a1 + 104) = 3;
      }
      break;
    case 0xC:
      if ( Quote.Y_Pos >= *(_DWORD *)(a1 + 12) )
        *(_DWORD *)(a1 + 20) = 170;
      else
        *(_DWORD *)(a1 + 20) = -170;
      if ( *(_DWORD *)(a1 + 4) & 1 )
      {
        *(_DWORD *)(a1 + 116) = 13;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 20) = 0;
      }
      else
      {
        *(_DWORD *)(a1 + 16) -= 42;
        if ( *(_DWORD *)(a1 + 16) < -1535 )
          *(_DWORD *)(a1 + 16) = -1535;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      }
      break;
    case 0xD:
      if ( ++*(_DWORD *)(a1 + 120) == 2 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( *(_DWORD *)(a1 + 120) == 6 )
        *(_DWORD *)(a1 + 104) = 0;
      if ( *(_DWORD *)(a1 + 120) > 16 )
        *(_DWORD *)(a1 + 116) = 1;
      break;
    default:
      break;
  }
  v4 = 256;
  v5 = 48;
  v6 = 272;
  v7 = 64;
  v8 = 272;
  v9 = 48;
  v10 = 288;
  v11 = 64;
  v12 = 288;
  v13 = 48;
  v14 = 304;
  v15 = 64;
  v16 = 304;
  v17 = 48;
  v18 = 320;
  v19 = 64;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0046C9B0) --------------------------------------------------------
int __cdecl NPC348(int a1)
{
  int *v1; // eax@11
  int v2; // ecx@11
  int result; // eax@11
  int v4; // [sp+0h] [bp-24h]@1
  int v5; // [sp+4h] [bp-20h]@1
  int v6; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+Ch] [bp-18h]@1
  int v8; // [sp+10h] [bp-14h]@1
  int v9; // [sp+14h] [bp-10h]@1
  int v10; // [sp+18h] [bp-Ch]@1
  int v11; // [sp+1Ch] [bp-8h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v5 = 128;
  v6 = 152;
  v7 = 160;
  v8 = 176;
  v9 = 160;
  v10 = 152;
  v11 = 192;
  v12 = 176;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_11;
  }
  else
  {
    *(_DWORD *)(a1 + 116) = 1;
  }
  if ( ++*(_DWORD *)(a1 + 120) >= 128 )
  {
    *(_DWORD *)(a1 + 116) = 10;
    *(_DWORD *)(a1 + 104) = 0;
    *(_DWORD *)(a1 + 164) = 2;
  }
  else
  {
    *(_DWORD *)(a1 + 12) -= 128;
    if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
      *(_DWORD *)(a1 + 104) = 1;
    else
      *(_DWORD *)(a1 + 104) = 0;
  }
LABEL_11:
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0046CAC0) --------------------------------------------------------
signed int __cdecl NPC349(int a1)
{
  int v1; // ecx@6
  signed int result; // eax@6

  if ( !*(_DWORD *)(a1 + 116) )
  {
    *(_DWORD *)(a1 + 116) = 1;
    if ( !*(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 8) += 4096;
    if ( *(_DWORD *)(a1 + 76) == 2 )
      *(_DWORD *)(a1 + 12) += 0x2000;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 0;
  *(_DWORD *)(v1 + 8) = 16;
  result = 16;
  *(_DWORD *)(v1 + 12) = 16;
  return result;
}

//----- (0046CB50) --------------------------------------------------------
void __cdecl NPC350(void *npc)
{
  int *v1; // ecx@71
  char *v2; // edx@71
  int *v3; // ecx@72
  char *v4; // edx@72
  int v5; // [sp+4h] [bp-E0h]@1
  int v6; // [sp+8h] [bp-DCh]@1
  int v7; // [sp+Ch] [bp-D8h]@1
  int v8; // [sp+10h] [bp-D4h]@1
  int v9; // [sp+14h] [bp-D0h]@1
  int v10; // [sp+18h] [bp-CCh]@1
  int v11; // [sp+1Ch] [bp-C8h]@1
  int v12; // [sp+20h] [bp-C4h]@1
  int v13; // [sp+24h] [bp-C0h]@1
  int v14; // [sp+28h] [bp-BCh]@1
  int v15; // [sp+2Ch] [bp-B8h]@1
  int v16; // [sp+30h] [bp-B4h]@1
  int v17; // [sp+34h] [bp-B0h]@1
  int v18; // [sp+38h] [bp-ACh]@1
  int v19; // [sp+3Ch] [bp-A8h]@1
  int v20; // [sp+40h] [bp-A4h]@1
  int v21; // [sp+44h] [bp-A0h]@1
  int v22; // [sp+48h] [bp-9Ch]@1
  int v23; // [sp+4Ch] [bp-98h]@1
  int v24; // [sp+50h] [bp-94h]@1
  int v25; // [sp+54h] [bp-90h]@1
  int v26; // [sp+58h] [bp-8Ch]@1
  int v27; // [sp+5Ch] [bp-88h]@1
  int v28; // [sp+60h] [bp-84h]@1
  int v29; // [sp+64h] [bp-80h]@1
  int v30; // [sp+68h] [bp-7Ch]@1
  int v31; // [sp+6Ch] [bp-78h]@1
  int v32; // [sp+70h] [bp-74h]@1
  int v33; // [sp+74h] [bp-70h]@1
  int v34; // [sp+78h] [bp-6Ch]@1
  int v35; // [sp+7Ch] [bp-68h]@1
  int v36; // [sp+80h] [bp-64h]@1
  int v37; // [sp+84h] [bp-60h]@1
  int v38; // [sp+88h] [bp-5Ch]@1
  int v39; // [sp+8Ch] [bp-58h]@1
  int v40; // [sp+90h] [bp-54h]@1
  int v41; // [sp+94h] [bp-50h]@1
  int v42; // [sp+98h] [bp-4Ch]@1
  int v43; // [sp+9Ch] [bp-48h]@1
  int v44; // [sp+A0h] [bp-44h]@1
  int v45; // [sp+A4h] [bp-40h]@1
  int v46; // [sp+A8h] [bp-3Ch]@1
  int v47; // [sp+ACh] [bp-38h]@1
  int v48; // [sp+B0h] [bp-34h]@1
  int v49; // [sp+B4h] [bp-30h]@1
  int v50; // [sp+B8h] [bp-2Ch]@1
  int v51; // [sp+BCh] [bp-28h]@1
  int v52; // [sp+C0h] [bp-24h]@1
  int v53; // [sp+C4h] [bp-20h]@1
  int v54; // [sp+C8h] [bp-1Ch]@1
  int v55; // [sp+CCh] [bp-18h]@1
  int v56; // [sp+D0h] [bp-14h]@1
  int v57; // [sp+D4h] [bp-10h]@1
  int v58; // [sp+D8h] [bp-Ch]@1
  int v59; // [sp+DCh] [bp-8h]@1
  int v60; // [sp+E0h] [bp-4h]@1

  v33 = 0;
  v34 = 160;
  v35 = 24;
  v36 = 184;
  v37 = 24;
  v38 = 160;
  v39 = 48;
  v40 = 184;
  v41 = 48;
  v42 = 160;
  v43 = 72;
  v44 = 184;
  v45 = 72;
  v46 = 160;
  v47 = 96;
  v48 = 184;
  v49 = 96;
  v50 = 160;
  v51 = 120;
  v52 = 184;
  v53 = 120;
  v54 = 160;
  v55 = 144;
  v56 = 184;
  v57 = 144;
  v58 = 160;
  v59 = 168;
  v60 = 184;
  v5 = 0;
  v6 = 184;
  v7 = 24;
  v8 = 208;
  v9 = 24;
  v10 = 184;
  v11 = 48;
  v12 = 208;
  v13 = 48;
  v14 = 184;
  v15 = 72;
  v16 = 208;
  v17 = 72;
  v18 = 184;
  v19 = 96;
  v20 = 208;
  v21 = 96;
  v22 = 184;
  v23 = 120;
  v24 = 208;
  v25 = 120;
  v26 = 184;
  v27 = 144;
  v28 = 208;
  v29 = 144;
  v30 = 184;
  v31 = 168;
  v32 = 208;
  switch ( *((_DWORD *)npc + 29) )
  {
    case 0:
      *((_DWORD *)npc + 29) = 1;
      if ( *((_DWORD *)npc + 19) )
        *((_DWORD *)npc + 8) = *((_DWORD *)npc + 2) + 0x10000;
      else
        *((_DWORD *)npc + 8) = *((_DWORD *)npc + 2) - 0x10000;
      *((_DWORD *)npc + 9) = *((_DWORD *)npc + 3);
      *((_DWORD *)npc + 5) = 2 * Random(-512, 512);
      *((_DWORD *)npc + 4) = 2 * Random(-512, 512);
      goto LABEL_6;
    case 1:
LABEL_6:
      if ( ++*((_DWORD *)npc + 25) > 1 )
      {
        *((_DWORD *)npc + 25) = 0;
        if ( ++*((_DWORD *)npc + 26) > 1 )
          *((_DWORD *)npc + 26) = 0;
      }
      if ( *((_DWORD *)npc + 19) )
      {
        if ( *((_DWORD *)npc + 2) > *((_DWORD *)npc + 8) )
          *((_DWORD *)npc + 29) = 20;
      }
      else if ( *((_DWORD *)npc + 2) < *((_DWORD *)npc + 8) )
      {
        *((_DWORD *)npc + 29) = 20;
      }
      goto LABEL_53;
    case 0x14:
      *((_DWORD *)npc + 29) = 21;
      *((_DWORD *)npc + 30) = Random(0, 150);
      *((_DWORD *)npc + 26) = 2;
      *((_DWORD *)npc + 25) = 0;
      goto LABEL_17;
    case 0x15:
LABEL_17:
      if ( ++*((_DWORD *)npc + 25) > 2 )
      {
        *((_DWORD *)npc + 25) = 0;
        if ( ++*((_DWORD *)npc + 26) > 3 )
          *((_DWORD *)npc + 26) = 2;
      }
      if ( ++*((_DWORD *)npc + 30) > 300 )
        *((_DWORD *)npc + 29) = 30;
      if ( Quote.X_Pos < *((_DWORD *)npc + 2) + 57344
        && Quote.X_Pos > *((_DWORD *)npc + 2) - 57344
        && Quote.Y_Pos < *((_DWORD *)npc + 3) + 0x2000
        && Quote.Y_Pos > *((_DWORD *)npc + 3) - 0x2000 )
      {
        *((_DWORD *)npc + 29) = 30;
      }
      goto LABEL_53;
    case 0x1E:
      *((_DWORD *)npc + 29) = 31;
      *((_DWORD *)npc + 30) = 0;
      *((_DWORD *)npc + 25) = 0;
      goto LABEL_29;
    case 0x1F:
LABEL_29:
      if ( ++*((_DWORD *)npc + 25) / 2 % 2 )
        *((_DWORD *)npc + 26) = 3;
      else
        *((_DWORD *)npc + 26) = 4;
      if ( ++*((_DWORD *)npc + 30) > 30 )
      {
        *((_DWORD *)npc + 29) = 40;
        *((_DWORD *)npc + 26) = 5;
        if ( *((_DWORD *)npc + 19) )
          NPC_Create((NPC_Names)312, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), 2048, 0, Right, NULL, 409);
        else
          NPC_Create((NPC_Names)312, *((_DWORD *)npc + 2), *((_DWORD *)npc + 3), -2048, 0, 0, NULL, 409);
      }
      goto LABEL_53;
    case 0x28:
      *((_DWORD *)npc + 29) = 41;
      *((_DWORD *)npc + 30) = 0;
      *((_DWORD *)npc + 25) = 0;
      goto LABEL_38;
    case 0x29:
LABEL_38:
      if ( ++*((_DWORD *)npc + 25) > 2 )
      {
        *((_DWORD *)npc + 25) = 0;
        if ( ++*((_DWORD *)npc + 26) > 6 )
          *((_DWORD *)npc + 26) = 5;
      }
      if ( ++*((_DWORD *)npc + 30) > 40 )
      {
        *((_DWORD *)npc + 29) = 50;
        *((_DWORD *)npc + 26) = 0;
        *((_DWORD *)npc + 4) = 0;
        *((_DWORD *)npc + 5) = 0;
      }
      goto LABEL_53;
    case 0x32:
      if ( ++*((_DWORD *)npc + 25) > 1 )
      {
        *((_DWORD *)npc + 25) = 0;
        if ( ++*((_DWORD *)npc + 26) > 1 )
          *((_DWORD *)npc + 26) = 0;
      }
      if ( *((_DWORD *)npc + 19) )
        *((_DWORD *)npc + 4) += 32;
      else
        *((_DWORD *)npc + 4) -= 32;
      if ( *((_DWORD *)npc + 2) >= 0 && *((_DWORD *)npc + 2) <= Current_Map.Width << 13 )
        goto LABEL_53;
      Vanish_NPC((NPC_vars *)npc);
      break;
    default:
LABEL_53:
      if ( *((_DWORD *)npc + 29) < 50 )
      {
        if ( *((_DWORD *)npc + 2) < *((_DWORD *)npc + 8) )
          *((_DWORD *)npc + 4) += 42;
        if ( *((_DWORD *)npc + 2) > *((_DWORD *)npc + 8) )
          *((_DWORD *)npc + 4) -= 42;
        if ( *((_DWORD *)npc + 3) < *((_DWORD *)npc + 9) )
          *((_DWORD *)npc + 5) += 42;
        if ( *((_DWORD *)npc + 3) > *((_DWORD *)npc + 9) )
          *((_DWORD *)npc + 5) -= 42;
        if ( *((_DWORD *)npc + 4) > 1024 )
          *((_DWORD *)npc + 4) = 1024;
        if ( *((_DWORD *)npc + 4) < -1024 )
          *((_DWORD *)npc + 4) = -1024;
        if ( *((_DWORD *)npc + 5) > 1024 )
          *((_DWORD *)npc + 5) = 1024;
        if ( *((_DWORD *)npc + 5) < -1024 )
          *((_DWORD *)npc + 5) = -1024;
      }
      *((_DWORD *)npc + 2) += *((_DWORD *)npc + 4);
      *((_DWORD *)npc + 3) += *((_DWORD *)npc + 5);
      if ( *((_DWORD *)npc + 19) )
      {
        v3 = &v5 + 4 * *((_DWORD *)npc + 26);
        v4 = (char *)npc + 84;
        *(_DWORD *)v4 = *v3;
        *((_DWORD *)v4 + 1) = v3[1];
        *((_DWORD *)v4 + 2) = v3[2];
        *((_DWORD *)v4 + 3) = v3[3];
      }
      else
      {
        v1 = &v33 + 4 * *((_DWORD *)npc + 26);
        v2 = (char *)npc + 84;
        *(_DWORD *)v2 = *v1;
        *((_DWORD *)v2 + 1) = v1[1];
        *((_DWORD *)v2 + 2) = v1[2];
        *((_DWORD *)v2 + 3) = v1[3];
      }
      break;
  }
}

//----- (0046D340) --------------------------------------------------------
int __cdecl NPC351(int a1)
{
  int *v1; // edx@10
  int result; // eax@10
  int v3; // [sp+4h] [bp-90h]@1
  int v4; // [sp+8h] [bp-8Ch]@1
  int v5; // [sp+Ch] [bp-88h]@1
  int v6; // [sp+10h] [bp-84h]@1
  int v7; // [sp+14h] [bp-80h]@1
  int v8; // [sp+18h] [bp-7Ch]@1
  int v9; // [sp+1Ch] [bp-78h]@1
  int v10; // [sp+20h] [bp-74h]@1
  int v11; // [sp+24h] [bp-70h]@1
  int v12; // [sp+28h] [bp-6Ch]@1
  int v13; // [sp+2Ch] [bp-68h]@1
  int v14; // [sp+30h] [bp-64h]@1
  int v15; // [sp+34h] [bp-60h]@1
  int v16; // [sp+38h] [bp-5Ch]@1
  int v17; // [sp+3Ch] [bp-58h]@1
  int v18; // [sp+40h] [bp-54h]@1
  int v19; // [sp+44h] [bp-50h]@1
  int v20; // [sp+48h] [bp-4Ch]@1
  int v21; // [sp+4Ch] [bp-48h]@1
  int v22; // [sp+50h] [bp-44h]@1
  int v23; // [sp+54h] [bp-40h]@1
  int v24; // [sp+58h] [bp-3Ch]@1
  int v25; // [sp+5Ch] [bp-38h]@1
  int v26; // [sp+60h] [bp-34h]@1
  int v27; // [sp+64h] [bp-30h]@1
  int v28; // [sp+68h] [bp-2Ch]@1
  int v29; // [sp+6Ch] [bp-28h]@1
  int v30; // [sp+70h] [bp-24h]@1
  int v31; // [sp+74h] [bp-20h]@1
  int v32; // [sp+78h] [bp-1Ch]@1
  int v33; // [sp+7Ch] [bp-18h]@1
  int v34; // [sp+80h] [bp-14h]@1
  int v35; // [sp+84h] [bp-10h]@1
  int v36; // [sp+88h] [bp-Ch]@1
  int v37; // [sp+8Ch] [bp-8h]@1
  int v38; // [sp+90h] [bp-4h]@1

  v3 = 0;
  v4 = 96;
  v5 = 32;
  v6 = 136;
  v7 = 32;
  v8 = 96;
  v9 = 64;
  v10 = 136;
  v11 = 64;
  v12 = 96;
  v13 = 96;
  v14 = 136;
  v15 = 96;
  v16 = 96;
  v17 = 128;
  v18 = 136;
  v19 = 128;
  v20 = 96;
  v21 = 160;
  v22 = 136;
  v23 = 0;
  v24 = 176;
  v25 = 32;
  v26 = 216;
  v27 = 32;
  v28 = 176;
  v29 = 64;
  v30 = 216;
  v31 = 64;
  v32 = 176;
  v33 = 96;
  v34 = 216;
  v35 = 96;
  v36 = 176;
  v37 = 128;
  v38 = 216;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      *(_DWORD *)(a1 + 104) = *(_DWORD *)(a1 + 76) / 10;
      *(_DWORD *)(a1 + 8) += 4096;
      *(_DWORD *)(a1 + 12) += 6144;
      break;
    case 0xA:
      if ( Get_NPC_Flag(*(_DWORD *)(a1 + 44)) )
      {
        *(_DWORD *)(a1 + 116) = 20;
      }
      else
      {
        *(_DWORD *)(a1 + 116) = 11;
        *(_WORD *)(a1 + 80) |= 0x20u;
      }
      goto LABEL_6;
    case 0xB:
LABEL_6:
      if ( *(_DWORD *)(a1 + 64) <= 900 )
      {
        NPC_Create(
          Treasure_Chest_Closed|0x150,
          *(_DWORD *)(a1 + 8) - 4096,
          *(_DWORD *)(a1 + 12) - 6144,
          0,
          0,
          (Directions)(10 * (*(_DWORD *)(a1 + 104) + 4)),
          NULL,
          0);
        *(_BYTE *)a1 |= 8u;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 104) += 4;
      *(_DWORD *)(a1 + 116) = 1;
      break;
    default:
      break;
  }
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0046D5D0) --------------------------------------------------------
int __cdecl NPC352(NPC_vars *a1)
{
  int *v1; // ecx@17
  char *v2; // edx@17
  int result; // eax@17
  int v4; // [sp+8h] [bp-1C4h]@1
  int v5; // [sp+Ch] [bp-1C0h]@17
  int v6; // [sp+10h] [bp-1BCh]@17
  int v7; // [sp+14h] [bp-1B8h]@17
  int v8; // [sp+18h] [bp-1B4h]@17
  int v9; // [sp+1Ch] [bp-1B0h]@17
  int v10; // [sp+20h] [bp-1ACh]@17
  int v11; // [sp+24h] [bp-1A8h]@17
  int v12; // [sp+28h] [bp-1A4h]@17
  int v13; // [sp+2Ch] [bp-1A0h]@17
  int v14; // [sp+30h] [bp-19Ch]@17
  int v15; // [sp+34h] [bp-198h]@17
  int v16; // [sp+38h] [bp-194h]@17
  int v17; // [sp+3Ch] [bp-190h]@17
  int v18; // [sp+40h] [bp-18Ch]@17
  int v19; // [sp+44h] [bp-188h]@17
  int v20; // [sp+48h] [bp-184h]@17
  int v21; // [sp+4Ch] [bp-180h]@17
  int v22; // [sp+50h] [bp-17Ch]@17
  int v23; // [sp+54h] [bp-178h]@17
  int v24; // [sp+58h] [bp-174h]@17
  int v25; // [sp+5Ch] [bp-170h]@17
  int v26; // [sp+60h] [bp-16Ch]@17
  int v27; // [sp+64h] [bp-168h]@17
  int v28; // [sp+68h] [bp-164h]@17
  int v29; // [sp+6Ch] [bp-160h]@17
  int v30; // [sp+70h] [bp-15Ch]@17
  int v31; // [sp+74h] [bp-158h]@17
  int v32; // [sp+78h] [bp-154h]@17
  int v33; // [sp+7Ch] [bp-150h]@17
  int v34; // [sp+80h] [bp-14Ch]@17
  int v35; // [sp+84h] [bp-148h]@17
  int v36; // [sp+88h] [bp-144h]@17
  int v37; // [sp+8Ch] [bp-140h]@17
  int v38; // [sp+90h] [bp-13Ch]@17
  int v39; // [sp+94h] [bp-138h]@17
  int v40; // [sp+98h] [bp-134h]@17
  int v41; // [sp+9Ch] [bp-130h]@17
  int v42; // [sp+A0h] [bp-12Ch]@17
  int v43; // [sp+A4h] [bp-128h]@17
  int v44; // [sp+A8h] [bp-124h]@17
  int v45; // [sp+ACh] [bp-120h]@17
  int v46; // [sp+B0h] [bp-11Ch]@17
  int v47; // [sp+B4h] [bp-118h]@17
  int v48; // [sp+B8h] [bp-114h]@17
  int v49; // [sp+BCh] [bp-110h]@17
  int v50; // [sp+C0h] [bp-10Ch]@17
  int v51; // [sp+C4h] [bp-108h]@17
  int v52; // [sp+C8h] [bp-104h]@17
  int v53; // [sp+CCh] [bp-100h]@17
  int v54; // [sp+D0h] [bp-FCh]@17
  int v55; // [sp+D4h] [bp-F8h]@17
  int v56; // [sp+D8h] [bp-F4h]@17
  int v57; // [sp+DCh] [bp-F0h]@17
  int v58; // [sp+E0h] [bp-ECh]@17
  int v59; // [sp+E4h] [bp-E8h]@17
  int v60; // [sp+E8h] [bp-E4h]@17
  int v61; // [sp+ECh] [bp-E0h]@17
  int v62; // [sp+F0h] [bp-DCh]@17
  int v63; // [sp+F4h] [bp-D8h]@17
  int v64; // [sp+F8h] [bp-D4h]@17
  int v65; // [sp+FCh] [bp-D0h]@17
  int v66; // [sp+100h] [bp-CCh]@17
  int v67; // [sp+104h] [bp-C8h]@17
  int v68; // [sp+108h] [bp-C4h]@17
  int v69; // [sp+10Ch] [bp-C0h]@17
  int v70; // [sp+110h] [bp-BCh]@17
  int v71; // [sp+114h] [bp-B8h]@17
  int v72; // [sp+118h] [bp-B4h]@17
  int v73; // [sp+11Ch] [bp-B0h]@17
  int v74; // [sp+120h] [bp-ACh]@17
  int v75; // [sp+124h] [bp-A8h]@17
  int v76; // [sp+128h] [bp-A4h]@17
  int v77; // [sp+12Ch] [bp-A0h]@17
  int v78; // [sp+130h] [bp-9Ch]@17
  int v79; // [sp+134h] [bp-98h]@17
  int v80; // [sp+138h] [bp-94h]@17
  int v81; // [sp+13Ch] [bp-90h]@17
  int v82; // [sp+140h] [bp-8Ch]@17
  int v83; // [sp+144h] [bp-88h]@17
  int v84; // [sp+148h] [bp-84h]@17
  int v85; // [sp+14Ch] [bp-80h]@17
  int v86; // [sp+150h] [bp-7Ch]@17
  int v87; // [sp+154h] [bp-78h]@17
  int v88; // [sp+158h] [bp-74h]@17
  int v89; // [sp+15Ch] [bp-70h]@17
  int v90; // [sp+160h] [bp-6Ch]@17
  int v91; // [sp+164h] [bp-68h]@17
  int v92; // [sp+168h] [bp-64h]@17
  int v93; // [sp+16Ch] [bp-60h]@17
  int v94; // [sp+170h] [bp-5Ch]@17
  int v95; // [sp+174h] [bp-58h]@17
  int v96; // [sp+178h] [bp-54h]@17
  int v97; // [sp+17Ch] [bp-50h]@17
  int v98; // [sp+180h] [bp-4Ch]@17
  int v99; // [sp+184h] [bp-48h]@17
  int v100; // [sp+188h] [bp-44h]@17
  int v101; // [sp+18Ch] [bp-40h]@17
  int v102; // [sp+190h] [bp-3Ch]@17
  int v103; // [sp+194h] [bp-38h]@17
  int v104; // [sp+198h] [bp-34h]@17
  int v105; // [sp+19Ch] [bp-30h]@17
  int v106; // [sp+1A0h] [bp-2Ch]@17
  int v107; // [sp+1A4h] [bp-28h]@17
  int v108; // [sp+1A8h] [bp-24h]@17
  int v109; // [sp+1ACh] [bp-20h]@17
  int v110; // [sp+1B0h] [bp-1Ch]@17
  int v111; // [sp+1B4h] [bp-18h]@17
  int v112; // [sp+1B8h] [bp-14h]@17
  int v113; // [sp+1BCh] [bp-10h]@17
  int v114; // [sp+1C0h] [bp-Ch]@17
  int v115; // [sp+1C4h] [bp-8h]@17
  int v116; // [sp+1C8h] [bp-4h]@17

  v4 = a1->Current_State;
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_17;
  }
  else
  {
    a1->Current_State = 1;
    a1->Ani_Num = 0;
    a1->count1 = a1->Direction / 100;
    a1->Direction %= 100;
    switch ( a1->count1 )
    {
      case 7:
      case 8:
      case 9:
      case 0xC:
      case 0xD:
        a1->Entity_Spritesheet = 21;
        break;
      default:
        break;
    }
    switch ( a1->count1 )
    {
      case 2:
      case 4:
      case 9:
      case 0xC:
        a1->view.top = 0x2000;
        break;
      default:
        break;
    }
    if ( a1->count1 == 9 )
    {
      a1->view.back = 10240;
      a1->view.front = 10240;
      a1->X_pos -= 512;
    }
    if ( !a1->count1 )
      NPC_Create((NPC_Names)145, 0, 0, 0, 0, Right, a1, 256);
  }
  a1->Y_vel += 64;
  if ( a1->Y_vel > 1535 )
    a1->Y_vel = 1535;
  if ( a1->Collision_flags & 8 )
  {
    a1->Y_vel = 0;
    a1->Current_State = 2;
    a1->Ani_Num = 1;
  }
  a1->Y_pos += a1->Y_vel;
LABEL_17:
  v5 = 304;
  v6 = 48;
  v7 = 320;
  v8 = 64;
  v9 = 224;
  v10 = 48;
  v11 = 240;
  v12 = 64;
  v13 = 32;
  v14 = 80;
  v15 = 48;
  v16 = 96;
  v17 = 0;
  v18 = 80;
  v19 = 16;
  v20 = 96;
  v21 = 224;
  v22 = 216;
  v23 = 240;
  v24 = 240;
  v25 = 192;
  v26 = 216;
  v27 = 208;
  v28 = 240;
  v29 = 48;
  v30 = 16;
  v31 = 64;
  v32 = 32;
  v33 = 0;
  v34 = 16;
  v35 = 16;
  v36 = 32;
  v37 = 112;
  v38 = 192;
  v39 = 128;
  v40 = 216;
  v41 = 80;
  v42 = 192;
  v43 = 96;
  v44 = 216;
  v45 = 304;
  v46 = 0;
  v47 = 320;
  v48 = 16;
  v49 = 224;
  v50 = 0;
  v51 = 240;
  v52 = 16;
  v53 = 176;
  v54 = 32;
  v55 = 192;
  v56 = 48;
  v57 = 176;
  v58 = 32;
  v59 = 192;
  v60 = 48;
  v61 = 240;
  v62 = 16;
  v63 = 256;
  v64 = 32;
  v65 = 224;
  v66 = 16;
  v67 = 240;
  v68 = 32;
  v69 = 208;
  v70 = 16;
  v71 = 224;
  v72 = 32;
  v73 = 192;
  v74 = 16;
  v75 = 208;
  v76 = 32;
  v77 = 280;
  v78 = 128;
  v79 = 320;
  v80 = 152;
  v81 = 280;
  v82 = 152;
  v83 = 320;
  v84 = 176;
  v85 = 32;
  v86 = 112;
  v87 = 48;
  v88 = 128;
  v89 = 0;
  v90 = 112;
  v91 = 16;
  v92 = 128;
  v93 = 80;
  v94 = 0;
  v95 = 96;
  v96 = 16;
  v97 = 112;
  v98 = 0;
  v99 = 128;
  v100 = 16;
  v101 = 16;
  v102 = 152;
  v103 = 32;
  v104 = 176;
  v105 = 0;
  v106 = 152;
  v107 = 16;
  v108 = 176;
  v109 = 48;
  v110 = 16;
  v111 = 64;
  v112 = 32;
  v113 = 48;
  v114 = 0;
  v115 = 64;
  v116 = 16;
  v1 = &v5 + 4 * (a1->Ani_Num + 2 * a1->count1);
  v2 = (char *)&a1->Rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  return result;
}

//----- (0046DBE0) --------------------------------------------------------
int __cdecl NPC353(int a1)
{
  int result; // eax@1
  int *v2; // edx@14
  int *v3; // ecx@54
  int v4; // edx@54
  int *v5; // ecx@55
  int v6; // edx@55
  int v7; // [sp+8h] [bp-80h]@1
  int v8; // [sp+Ch] [bp-7Ch]@1
  int v9; // [sp+10h] [bp-78h]@1
  int v10; // [sp+14h] [bp-74h]@1
  int v11; // [sp+18h] [bp-70h]@1
  int v12; // [sp+1Ch] [bp-6Ch]@1
  int v13; // [sp+20h] [bp-68h]@1
  int v14; // [sp+24h] [bp-64h]@1
  int v15; // [sp+28h] [bp-60h]@1
  int v16; // [sp+2Ch] [bp-5Ch]@1
  int v17; // [sp+30h] [bp-58h]@1
  int v18; // [sp+34h] [bp-54h]@1
  int v19; // [sp+38h] [bp-50h]@1
  int v20; // [sp+3Ch] [bp-4Ch]@1
  int v21; // [sp+40h] [bp-48h]@1
  int v22; // [sp+44h] [bp-44h]@1
  int v23; // [sp+48h] [bp-40h]@1
  int v24; // [sp+4Ch] [bp-3Ch]@1
  int v25; // [sp+50h] [bp-38h]@1
  int v26; // [sp+54h] [bp-34h]@1
  int v27; // [sp+58h] [bp-30h]@1
  int v28; // [sp+5Ch] [bp-2Ch]@1
  int v29; // [sp+60h] [bp-28h]@1
  int v30; // [sp+64h] [bp-24h]@1
  int v31; // [sp+68h] [bp-20h]@1
  int v32; // [sp+6Ch] [bp-1Ch]@1
  int v33; // [sp+70h] [bp-18h]@1
  int v34; // [sp+74h] [bp-14h]@1
  int v35; // [sp+78h] [bp-10h]@1
  int v36; // [sp+7Ch] [bp-Ch]@1
  int v37; // [sp+80h] [bp-8h]@1
  int v38; // [sp+84h] [bp-4h]@1

  v15 = 168;
  v16 = 160;
  v17 = 184;
  v18 = 184;
  v19 = 184;
  v20 = 160;
  v21 = 200;
  v22 = 184;
  v23 = 168;
  v24 = 184;
  v25 = 184;
  v26 = 208;
  v27 = 184;
  v28 = 184;
  v29 = 200;
  v30 = 208;
  v31 = 200;
  v32 = 160;
  v33 = 216;
  v34 = 176;
  v35 = 216;
  v36 = 160;
  v37 = 232;
  v38 = 176;
  v7 = 200;
  v8 = 176;
  v9 = 216;
  v10 = 192;
  v11 = 216;
  v12 = 176;
  v13 = 232;
  v14 = 192;
  result = a1;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 116) = 1;
      switch ( *(_DWORD *)(a1 + 76) )
      {
        case 0:
          *(_DWORD *)(a1 + 16) = -1536;
          break;
        case 2:
          *(_DWORD *)(a1 + 16) = 1536;
          break;
        case 1:
          *(_DWORD *)(a1 + 20) = -1536;
          break;
        case 3:
          *(_DWORD *)(a1 + 20) = 1536;
          break;
        default:
          goto LABEL_7;
      }
      goto LABEL_7;
    case 1:
LABEL_7:
      if ( ++*(_DWORD *)(a1 + 120) == 8 )
        *(_WORD *)(a1 + 80) &= 0xFFF7u;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 20);
      if ( *(_DWORD *)(a1 + 120) == 16 )
        *(_DWORD *)(a1 + 116) = 10;
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        if ( ++*(_DWORD *)(a1 + 104) > 3 )
          *(_DWORD *)(a1 + 104) = 0;
      }
      v2 = &v15 + 4 * *(_DWORD *)(a1 + 104);
      result = a1 + 84;
      *(_DWORD *)result = *v2;
      *(_DWORD *)(result + 4) = v2[1];
      *(_DWORD *)(result + 8) = v2[2];
      *(_DWORD *)(result + 12) = v2[3];
      return result;
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_WORD *)(a1 + 80) |= 0x20u;
      *(_WORD *)(a1 + 80) &= 0xFFF7u;
      *(_DWORD *)(a1 + 164) = 5;
      *(_DWORD *)(a1 + 144) = 4096;
      goto LABEL_16;
    case 0xB:
LABEL_16:
      if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
        *(_DWORD *)(a1 + 76) = 2;
      else
        *(_DWORD *)(a1 + 76) = 0;
      if ( Quote.Y_Pos - 12288 <= *(_DWORD *)(a1 + 12) )
      {
        if ( *(_DWORD *)(a1 + 76) )
          *(_DWORD *)(a1 + 24) += 16;
        else
          *(_DWORD *)(a1 + 24) -= 16;
      }
      else if ( *(_DWORD *)(a1 + 76) )
      {
        *(_DWORD *)(a1 + 24) -= 16;
      }
      else
      {
        *(_DWORD *)(a1 + 24) += 16;
      }
      if ( *(_DWORD *)(a1 + 12) <= Quote.Y_Pos )
        *(_DWORD *)(a1 + 28) += 16;
      else
        *(_DWORD *)(a1 + 28) -= 16;
      if ( *(_DWORD *)(a1 + 24) < 0 && *(_DWORD *)(a1 + 4) & 1 )
        *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
      if ( *(_DWORD *)(a1 + 24) > 0 && *(_DWORD *)(a1 + 4) & 4 )
        *(_DWORD *)(a1 + 24) = -*(_DWORD *)(a1 + 24);
      if ( *(_DWORD *)(a1 + 28) < 0 && *(_DWORD *)(a1 + 4) & 2 )
        *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
      if ( *(_DWORD *)(a1 + 28) > 0 && *(_DWORD *)(a1 + 4) & 8 )
        *(_DWORD *)(a1 + 28) = -*(_DWORD *)(a1 + 28);
      if ( *(_DWORD *)(a1 + 24) < -1535 )
        *(_DWORD *)(a1 + 24) = -1535;
      if ( *(_DWORD *)(a1 + 24) > 1535 )
        *(_DWORD *)(a1 + 24) = 1535;
      if ( *(_DWORD *)(a1 + 28) < -1535 )
        *(_DWORD *)(a1 + 28) = -1535;
      if ( *(_DWORD *)(a1 + 28) > 1535 )
        *(_DWORD *)(a1 + 28) = 1535;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(a1 + 28);
      if ( ++*(_DWORD *)(a1 + 100) > 1 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        if ( ++*(_DWORD *)(a1 + 104) > 1 )
          *(_DWORD *)(a1 + 104) = 0;
      }
      if ( *(_DWORD *)(a1 + 76) )
      {
        v5 = &v7 + 4 * *(_DWORD *)(a1 + 104);
        v6 = a1 + 84;
        *(_DWORD *)v6 = *v5;
        *(_DWORD *)(v6 + 4) = v5[1];
        result = v5[2];
        *(_DWORD *)(v6 + 8) = result;
        *(_DWORD *)(v6 + 12) = v5[3];
      }
      else
      {
        v3 = &v31 + 4 * *(_DWORD *)(a1 + 104);
        v4 = a1 + 84;
        *(_DWORD *)v4 = *v3;
        *(_DWORD *)(v4 + 4) = v3[1];
        result = v3[2];
        *(_DWORD *)(v4 + 8) = result;
        *(_DWORD *)(v4 + 12) = v3[3];
      }
      break;
    default:
      return result;
  }
  return result;
}

//----- (0046E110) --------------------------------------------------------
int __cdecl NPC354(int a1)
{
  int result; // eax@1
  int v2; // [sp+0h] [bp-10h]@1
  signed int i; // [sp+4h] [bp-Ch]@13

  result = a1;
  v2 = *(_DWORD *)(a1 + 116);
  if ( !v2 )
  {
    *(_DWORD *)(a1 + 136) = 143360;
    return result;
  }
  if ( v2 == 10 )
  {
    *(_DWORD *)(a1 + 116) = 11;
    *(_DWORD *)(a1 + 120) = 0;
    if ( *(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 8) -= 0x2000;
    else
      *(_DWORD *)(a1 + 8) += 0x2000;
  }
  else if ( v2 != 11 )
  {
    return result;
  }
  ++*(_DWORD *)(a1 + 120);
  result = a1;
  if ( *(_DWORD *)(a1 + 120) > 100 )
  {
    *(_DWORD *)(a1 + 120) = 0;
    Set_Quake(20);
    Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
    Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
    if ( *(_DWORD *)(a1 + 76) )
    {
      result = a1;
      *(_DWORD *)(a1 + 8) += 0x2000;
    }
    else
    {
      result = a1;
      *(_DWORD *)(a1 + 8) -= 0x2000;
    }
    for ( i = 0; i < 20; ++i )
    {
      Change_Map_Parts(*(_DWORD *)(a1 + 8) / 512 / 16, i + *(_DWORD *)(a1 + 12) / 512 / 16, 0x6Du);
      result = i + 1;
    }
  }
  return result;
}

//----- (0046E280) --------------------------------------------------------
int __cdecl NPC355(int a1)
{
  int *v1; // edx@7
  int result; // eax@7
  int v3; // [sp+8h] [bp-40h]@1
  int v4; // [sp+Ch] [bp-3Ch]@1
  int v5; // [sp+10h] [bp-38h]@1
  int v6; // [sp+14h] [bp-34h]@1
  int v7; // [sp+18h] [bp-30h]@1
  int v8; // [sp+1Ch] [bp-2Ch]@1
  int v9; // [sp+20h] [bp-28h]@1
  int v10; // [sp+24h] [bp-24h]@1
  int v11; // [sp+28h] [bp-20h]@1
  int v12; // [sp+2Ch] [bp-1Ch]@1
  int v13; // [sp+30h] [bp-18h]@1
  int v14; // [sp+34h] [bp-14h]@1
  int v15; // [sp+38h] [bp-10h]@1
  int v16; // [sp+3Ch] [bp-Ch]@1
  int v17; // [sp+40h] [bp-8h]@1
  int v18; // [sp+44h] [bp-4h]@1

  v3 = 80;
  v4 = 16;
  v5 = 96;
  v6 = 32;
  v7 = 80;
  v8 = 96;
  v9 = 96;
  v10 = 112;
  v11 = 128;
  v12 = 16;
  v13 = 144;
  v14 = 32;
  v15 = 208;
  v16 = 96;
  v17 = 224;
  v18 = 112;
  if ( !*(_DWORD *)(a1 + 116) )
  {
    switch ( *(_DWORD *)(a1 + 76) )
    {
      case 0:
        *(_DWORD *)(a1 + 52) = 16;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 7168;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) + 5120;
        break;
      case 1:
        *(_DWORD *)(a1 + 52) = 23;
        *(_DWORD *)(a1 + 104) = 1;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 7168;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) + 5120;
        break;
      case 2:
        *(_DWORD *)(a1 + 52) = 16;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 3584;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 9728;
        break;
      case 3:
        *(_DWORD *)(a1 + 52) = 23;
        *(_DWORD *)(a1 + 104) = 3;
        *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 2048;
        *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 9728;
        break;
      default:
        break;
    }
  }
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (0046E480) --------------------------------------------------------
LONG *__cdecl NPC356(NPC_vars *a1)
{
  int *v1; // edx@19
  LONG *result; // eax@19
  int v3; // [sp+4h] [bp-20h]@1
  int v4; // [sp+8h] [bp-1Ch]@1
  int v5; // [sp+Ch] [bp-18h]@1
  int v6; // [sp+10h] [bp-14h]@1
  int v7; // [sp+14h] [bp-10h]@1
  int v8; // [sp+18h] [bp-Ch]@1
  int v9; // [sp+1Ch] [bp-8h]@1
  int v10; // [sp+20h] [bp-4h]@1

  v3 = 240;
  v4 = 128;
  v5 = 280;
  v6 = 152;
  v7 = 240;
  v8 = 152;
  v9 = 280;
  v10 = 176;
  switch ( a1->Current_State )
  {
    case 0:
      a1->Current_State = 11;
      a1->ani_wait = 0;
      a1->Curly_Target_Y = a1->Y_pos - 0x2000;
      a1->Curly_Target_X = a1->X_pos - 3072;
      a1->Y_vel = 0;
      NPC_Create((NPC_Names)355, 0, 0, 0, 0, Down, a1, 170);
      NPC_Create((NPC_Names)355, 0, 0, 0, 0, Right, a1, 170);
      goto LABEL_3;
    case 0xB:
LABEL_3:
      if ( a1->X_pos >= a1->Curly_Target_X )
        a1->X_vel -= 8;
      else
        a1->X_vel += 8;
      if ( a1->Y_pos >= a1->Curly_Target_Y )
        a1->Y_vel -= 8;
      else
        a1->Y_vel += 8;
      a1->X_pos += a1->X_vel;
      a1->Y_pos += a1->Y_vel;
      break;
    case 0x14:
      a1->Current_State = 21;
      a1->X_vel = -1024;
      a1->Y_vel = 512;
      goto LABEL_11;
    case 0x15:
LABEL_11:
      ++a1->ani_wait;
      a1->X_vel += 16;
      a1->Y_vel -= 8;
      a1->X_pos += a1->X_vel;
      a1->Y_pos += a1->Y_vel;
      if ( a1->X_pos > 491520 )
        a1->Current_State = 22;
      break;
    case 0x16:
      a1->X_vel = 0;
      a1->Y_vel = 0;
      break;
    default:
      break;
  }
  if ( ++a1->ani_wait > 4 )
  {
    a1->ani_wait = 0;
    ++a1->Ani_Num;
  }
  if ( a1->Ani_Num > 1 )
    a1->Ani_Num = 0;
  v1 = &v3 + 4 * a1->Ani_Num;
  result = &a1->Rect.left;
  *result = *v1;
  result[1] = v1[1];
  result[2] = v1[2];
  result[3] = v1[3];
  return result;
}

//----- (0046E730) --------------------------------------------------------
void __cdecl NPC357(int a1)
{
  int v1; // edx@5
  int v2; // ecx@7
  int v3; // ST08_4@12
  int v4; // eax@12
  int v5; // [sp+0h] [bp-14h]@1

  v5 = *(_DWORD *)(a1 + 116);
  if ( !v5 )
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 224;
    *(_DWORD *)(v1 + 4) = 136;
    *(_DWORD *)(v1 + 8) = 240;
    *(_DWORD *)(v1 + 12) = 152;
    ++*(_DWORD *)(a1 + 120);
    goto LABEL_11;
  }
  if ( v5 == 10 )
  {
    *(_DWORD *)(a1 + 120) = 0;
    *(_DWORD *)(a1 + 116) = 11;
    Play_Sound_Effect(Sfx_Teleport, 1);
  }
  else if ( v5 != 11 )
  {
    goto LABEL_11;
  }
  ++*(_DWORD *)(a1 + 120);
  v2 = a1 + 84;
  *(_DWORD *)v2 = 224;
  *(_DWORD *)(v2 + 4) = 136;
  *(_DWORD *)(v2 + 8) = 240;
  *(_DWORD *)(v2 + 12) = 152;
  if ( *(_DWORD *)(a1 + 120) / 2 % 2 )
    *(_DWORD *)(a1 + 92) = *(_DWORD *)(a1 + 84);
  if ( *(_DWORD *)(a1 + 120) > 50 )
    *(_BYTE *)a1 = 0;
LABEL_11:
  if ( *(_DWORD *)(a1 + 120) % 8 == 1 )
  {
    v3 = *(_DWORD *)(a1 + 12) + 4096;
    v4 = Random(-8, 8);
    Create_Effect(*(_DWORD *)(a1 + 8) + (v4 << 9), v3, 13, 1);
  }
}

//----- (0046E870) --------------------------------------------------------
int __cdecl NPC358(int a1)
{
  int *v1; // eax@13
  int v2; // ecx@13
  int result; // eax@13
  int v4; // [sp+0h] [bp-54h]@1
  int v5; // [sp+4h] [bp-50h]@1
  int v6; // [sp+8h] [bp-4Ch]@1
  int v7; // [sp+Ch] [bp-48h]@1
  int v8; // [sp+10h] [bp-44h]@1
  int v9; // [sp+14h] [bp-40h]@1
  int v10; // [sp+18h] [bp-3Ch]@1
  int v11; // [sp+1Ch] [bp-38h]@1
  int v12; // [sp+20h] [bp-34h]@1
  int v13; // [sp+24h] [bp-30h]@1
  int v14; // [sp+28h] [bp-2Ch]@1
  int v15; // [sp+2Ch] [bp-28h]@1
  int v16; // [sp+30h] [bp-24h]@1
  int v17; // [sp+34h] [bp-20h]@1
  int v18; // [sp+38h] [bp-1Ch]@1
  int v19; // [sp+3Ch] [bp-18h]@1
  int v20; // [sp+40h] [bp-14h]@1
  int v21; // [sp+44h] [bp-10h]@1
  int v22; // [sp+48h] [bp-Ch]@1
  int v23; // [sp+4Ch] [bp-8h]@1
  int v24; // [sp+50h] [bp-4h]@1

  v5 = 208;
  v6 = 8;
  v7 = 224;
  v8 = 32;
  v9 = 224;
  v10 = 8;
  v11 = 240;
  v12 = 32;
  v13 = 240;
  v14 = 8;
  v15 = 256;
  v16 = 32;
  v17 = 256;
  v18 = 8;
  v19 = 272;
  v20 = 32;
  v21 = 272;
  v22 = 8;
  v23 = 288;
  v24 = 32;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 )
  {
    if ( v4 == 10 )
    {
      if ( ++*(_DWORD *)(a1 + 100) > 6 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 4 )
        *(_DWORD *)(a1 + 104) = 3;
    }
  }
  else
  {
    if ( ++*(_DWORD *)(a1 + 100) > 6 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 1 )
      *(_DWORD *)(a1 + 104) = 0;
  }
  v1 = &v5 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (0046E9E0) --------------------------------------------------------
void __cdecl NPC359(int a1)
{
  int v1; // eax@6

  if ( Quote.X_Pos < *(_DWORD *)(a1 + 8) + 163840
    && Quote.X_Pos > *(_DWORD *)(a1 + 8) - 163840
    && Quote.Y_Pos < *(_DWORD *)(a1 + 12) + 163840
    && Quote.Y_Pos > *(_DWORD *)(a1 + 12) - 81920
    && Random(0, 100) == 2 )
  {
    v1 = Random(-6, 6);
    NPC_Create(Balrog_Drop_In|0x40, *(_DWORD *)(a1 + 8) + (v1 << 9), *(_DWORD *)(a1 + 12) - 3584, 0, 0, 0, NULL, 0);
  }
}

//----- (0046EA90) --------------------------------------------------------
// NPC 360 : Thank you!
// The thank you screen.
signed int __cdecl NPC360_Thank_You(int a1)
{
  int v1; // ecx@3
  signed int result; // eax@3

  if ( !*(_DWORD *)(a1 + 116) )
  {
    ++*(_DWORD *)(a1 + 116);
    *(_DWORD *)(a1 + 8) -= 4096;
    *(_DWORD *)(a1 + 12) -= 4096;
  }
  v1 = a1 + 84;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 176;
  *(_DWORD *)(v1 + 8) = 48;
  result = 184;
  *(_DWORD *)(v1 + 12) = 184;
  if ( Quote.Equipped_Items & 0x80 )
    result = 48;
  return result;
}

//----- (0046EB30) --------------------------------------------------------
void __cdecl Init_NPCs()
{
  memset(NPC_Objects, 0, 0x15800u);
}

//----- (0046EB50) --------------------------------------------------------
// Processes PXE file
signed int __cdecl Load_Event(char *path_event)
{
  signed int result; // eax@2
  char path[260]; // [sp+0h] [bp-130h]@1
  Map_Data2 Event; // [sp+110h] [bp-20h]@7
  __int16 v4; // [sp+114h] [bp-1Ch]@7
  __int16 v5; // [sp+116h] [bp-1Ah]@7
  __int16 v6; // [sp+118h] [bp-18h]@7
  unsigned __int16 v7; // [sp+11Ah] [bp-16h]@7
  int code; // [sp+11Ch] [bp-14h]@3
  FILE *stream; // [sp+120h] [bp-10h]@1
  int i; // [sp+124h] [bp-Ch]@5
  int n; // [sp+128h] [bp-8h]@5
  int buffer; // [sp+12Ch] [bp-4h]@5

  sprintf(path, "%s\\%s", dataPath, path_event);
  stream = fopen(path, "rb");
  if ( !stream )
  {
    result = 0;
  }
  else
  {
    fread(&code, 1u, 4u, stream);
    // Do not invert
    if ( !memcmp(&code, PassPixEve, 3u) )
    {
      fread(&buffer, 4u, 1u, stream);
      memset(NPC_Objects, 0, 0x15800u);
      n = 170;
      for ( i = 0; i < buffer; ++i )
      {
        fread(&Event, 0xCu, 1u, stream);
        NPC_Objects[n].Direction = (v7 & 0x1000) != 0 ? 2 : 0;
        NPC_Objects[n].Entity_Type = v6;
        NPC_Objects[n].Entity_Eve_Num = v5;
        NPC_Objects[n].code_flag = v4;
        NPC_Objects[n].X_pos = *(signed __int16 *)&Event.path[0] << 13;
        NPC_Objects[n].Y_pos = *(signed __int16 *)&Event.path[2] << 13;
        NPC_Objects[n].Entity_Flags = v7;
        NPC_Objects[n].Entity_Flags |= NPC_Table[NPC_Objects[n].Entity_Type].bits;
        NPC_Objects[n].EXP_Amount = NPC_Table[NPC_Objects[n].Entity_Type].exp;
        Set_Unique_Parameter(&NPC_Objects[n]);
        if ( NPC_Objects[n].Entity_Flags & 0x800 )
        {
          if ( Get_NPC_Flag(NPC_Objects[n].code_flag) == 1 )
            NPC_Objects[n].Is_Alive |= 0x80u;
        }
        else if ( NPC_Objects[n].Entity_Flags & 0x4000 )
        {
          if ( !Get_NPC_Flag(NPC_Objects[n].code_flag) )
            NPC_Objects[n].Is_Alive |= 0x80u;
        }
        else
        {
          NPC_Objects[n].Is_Alive = -0x80u;
        }
        ++n;
      }
      fclose(stream);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (0046EE50) --------------------------------------------------------
void __cdecl Set_Unique_Parameter(NPC_vars *npc)
{
  int NPC_Num; // ST00_4@1

  NPC_Num = npc->Entity_Type;
  npc->Entity_Spritesheet = NPC_Table[NPC_Num].surf;
  npc->Sound_Hit = NPC_Table[NPC_Num].hit_voice;
  npc->Sound_Death = NPC_Table[NPC_Num].destroy_voice;
  npc->Damage = NPC_Table[NPC_Num].damage;
  npc->Explosion_Size = NPC_Table[NPC_Num].size;
  npc->Life = NPC_Table[NPC_Num].life;
  npc->Hitbox.front = NPC_Table[NPC_Num].hit.front << 9;
  npc->Hitbox.back = NPC_Table[NPC_Num].hit.back << 9;
  npc->Hitbox.top = NPC_Table[NPC_Num].hit.top << 9;
  npc->Hitbox.bottom = NPC_Table[NPC_Num].hit.bottom << 9;
  npc->view.front = NPC_Table[NPC_Num].view.front << 9;
  npc->view.back = NPC_Table[NPC_Num].view.back << 9;
  npc->view.top = NPC_Table[NPC_Num].view.top << 9;
  npc->view.bottom = NPC_Table[NPC_Num].view.bottom << 9;
}

//----- (0046EFD0) --------------------------------------------------------
void __cdecl NPC_Create(NPC_Names NPC_Num, int X_Pos, int Y_Pos, int X_Vel, int Y_Vel, Directions Direction, NPC_vars *Parent_NPC, int Start_Index)
{
  int n; // [sp+0h] [bp-4h]@1

  for ( n = Start_Index; n < 512 && NPC_Objects[n].Is_Alive; ++n )
    ;                                           // Search for a valid NPC
  if ( n != 512 )
  {
    memset(&NPC_Objects[n], 0, 0xACu);          // Clear residual NPC RAM
    NPC_Objects[n].Is_Alive |= 0x80u;           // Set NPC's vars according to args
    NPC_Objects[n].Direction = Direction;
    NPC_Objects[n].Entity_Type = NPC_Num;
    NPC_Objects[n].X_pos = X_Pos;
    NPC_Objects[n].Y_pos = Y_Pos;
    NPC_Objects[n].X_vel = X_Vel;
    NPC_Objects[n].Y_vel = Y_Vel;
    NPC_Objects[n].Parent_NPC = Parent_NPC;
    NPC_Objects[n].Entity_Flags = NPC_Table[NPC_Objects[n].Entity_Type].bits;
    NPC_Objects[n].EXP_Amount = NPC_Table[NPC_Objects[n].Entity_Type].exp;
    Set_Unique_Parameter(&NPC_Objects[n]);
  }
}

//----- (0046F150) --------------------------------------------------------
void __cdecl Create_Dust_Clouds(int X_Pos, int Y_Pos, signed int Range, int Num)
{
  int offset_X; // ST24_4@3
  int offset_Y; // ST20_4@3
  int i; // [sp+8h] [bp-4h]@1
  int Range_By_512; // [sp+1Ch] [bp+10h]@1

  Range_By_512 = Range / 512;
  for ( i = 0; i < Num; ++i )
  {
    offset_X = Random(-Range_By_512, Range_By_512) << 9;
    offset_Y = Random(-Range_By_512, Range_By_512) << 9;
    NPC_Create(Smoke, offset_X + X_Pos, offset_Y + Y_Pos, 0, 0, Left, NULL, 256);
  }
  Create_Effect(X_Pos, Y_Pos, 12, 0);
}

//----- (0046F200) --------------------------------------------------------
void __cdecl Create_Dust_Clouds_Up(int X_Pos, int Y_Pos, signed int Range, int Num)
{
  int offset_X; // ST24_4@3
  int offset_Y; // ST20_4@3
  int i; // [sp+8h] [bp-4h]@1
  int Range_By_512; // [sp+1Ch] [bp+10h]@1

  Range_By_512 = Range / 512;
  for ( i = 0; i < Num; ++i )
  {
    offset_X = Random(-Range_By_512, Range_By_512) << 9;
    offset_Y = Random(-Range_By_512, Range_By_512) << 9;
    NPC_Create(Smoke, offset_X + X_Pos, offset_Y + Y_Pos, 0, 0, Up, NULL, 256);
  }
  Create_Effect(X_Pos, Y_Pos, 12, 0);
}

//----- (0046F2B0) --------------------------------------------------------
void __cdecl Spawn_Exp(int X_Position, int Y_Position, signed int EXP_Amount)
{
  int Actual_Exp_Amount; // [sp+0h] [bp-8h]@0
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 256; EXP_Amount; Set_Unique_Parameter(&NPC_Objects[i]) )
  {
    while ( i < 512 && NPC_Objects[i].Is_Alive )
      ++i;
    if ( i == 512 )
      break;
    memset(&NPC_Objects[i], 0, 0xACu);
    if ( EXP_Amount < 20 )
    {
      if ( EXP_Amount < 5 )
      {
        if ( EXP_Amount >= 1 )
        {
          --EXP_Amount;
          Actual_Exp_Amount = 1;
        }
      }
      else
      {
        EXP_Amount -= 5;
        Actual_Exp_Amount = 5;
      }
    }
    else
    {
      EXP_Amount -= 20;
      Actual_Exp_Amount = 20;
    }
    NPC_Objects[i].Is_Alive |= In_Use;
    NPC_Objects[i].Direction = Left;
    NPC_Objects[i].Entity_Type = 1;
    NPC_Objects[i].X_pos = X_Position;
    NPC_Objects[i].Y_pos = Y_Position;
    NPC_Objects[i].Entity_Flags = NPC_Table[NPC_Objects[i].Entity_Type].bits;
    NPC_Objects[i].EXP_Amount = Actual_Exp_Amount;
  }
}

//----- (0046F430) --------------------------------------------------------
signed int __cdecl Spawn_Missiles(int a1, int a2, int a3)
{
  signed int result; // eax@10
  int v4; // [sp+0h] [bp-38h]@3
  signed int v5; // [sp+4h] [bp-34h]@1
  int ptr[10]; // [sp+8h] [bp-30h]@1
  int v7; // [sp+30h] [bp-8h]@11
  int i; // [sp+34h] [bp-4h]@1

  v5 = 0;
  memset(ptr, 0, 0x28u);
  for ( i = 0; i < 8; ++i )
  {
    v4 = Weapons[i].ID;
    if ( v4 == 5 )
    {
      ptr[v5++] = 0;
    }
    else if ( v4 == 10 )
    {
      ptr[v5++] = 1;
    }
    else
    {
      ptr[v5] = 0;
    }
  }
  if ( v5 )
  {
    i = Random(1, 10 * v5);
    v7 = ptr[i % v5];
    for ( i = 256; i < 512 && NPC_Objects[i].Is_Alive; ++i )
      ;
    if ( i == 512 )
    {
      result = 0;
    }
    else
    {
      memset(&NPC_Objects[i], 0, 0xACu);
      NPC_Objects[i].Is_Alive |= 0x80u;
      NPC_Objects[i].Direction = 0;
      NPC_Objects[i].Entity_Eve_Num = v7;
      NPC_Objects[i].Entity_Type = 86;
      NPC_Objects[i].X_pos = a1;
      NPC_Objects[i].Y_pos = a2;
      NPC_Objects[i].Entity_Flags = NPC_Table[NPC_Objects[i].Entity_Type].bits;
      NPC_Objects[i].EXP_Amount = a3;
      Set_Unique_Parameter(&NPC_Objects[i]);
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 46F430: using guessed type int ptr[10];

//----- (0046F630) --------------------------------------------------------
signed int __cdecl Spawn_HP(int a1, int a2, int a3)
{
  signed int result; // eax@6
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 256; i < 512 && NPC_Objects[i].Is_Alive; ++i )
    ;
  if ( i == 512 )
  {
    result = 0;
  }
  else
  {
    memset(&NPC_Objects[i], 0, 0xACu);
    NPC_Objects[i].Is_Alive |= 0x80u;
    NPC_Objects[i].Direction = 0;
    NPC_Objects[i].Entity_Type = 87;
    NPC_Objects[i].X_pos = a1;
    NPC_Objects[i].Y_pos = a2;
    NPC_Objects[i].Entity_Flags = NPC_Table[NPC_Objects[i].Entity_Type].bits;
    NPC_Objects[i].EXP_Amount = a3;
    Set_Unique_Parameter(&NPC_Objects[i]);
    result = 1;
  }
  return result;
}

//----- (0046F760) --------------------------------------------------------
// Make the NPC disappear
void __cdecl Vanish_NPC(NPC_vars *npc)
{
  int npc_X_Pos; // ST0C_4@1
  int npc_Y_Pos; // ST10_4@1

  npc_X_Pos = npc->X_pos;
  npc_Y_Pos = npc->Y_pos;
  memset(npc, 0, 0xACu);
  npc->count1 = 0;
  npc->X_pos = npc_X_Pos;
  npc->Y_pos = npc_Y_Pos;
  npc->Is_Alive |= 0x80u;
  npc->Direction = 0;
  npc->Entity_Type = 3;
  npc->Entity_Flags = NPC_Table[npc->Entity_Type].bits;
  npc->EXP_Amount = NPC_Table[npc->Entity_Type].exp;
  Set_Unique_Parameter(npc);
}
// 4BBA30: using guessed type int Super_Y_Pos;

//----- (0046F810) --------------------------------------------------------
void __cdecl Draw_NPCs(signed int Camera_X, signed int Camera_Y)
{
  __int64 temp1; // rax@12 MAPDST
  int temp2; // ST08_4@12
  int side; // [sp+0h] [bp-Ch]@10
  signed int i; // [sp+4h] [bp-8h]@1
  char a; // [sp+Bh] [bp-1h]@5

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 )
    {
      if ( NPC_Objects[i].Is_Being_Hit )
      {
        a = 2 * (((signed int)NPC_Objects[i].Is_Being_Hit >> 1) % 2) - 1;
      }
      else
      {
        a = 0;
        if ( NPC_Objects[i].Entity_Flags & 0x8000 && NPC_Objects[i].damage_view )
        {
          Set_Value_View((__int32)&NPC_Objects[i].X_pos, (__int32)&NPC_Objects[i].Y_pos, NPC_Objects[i].damage_view);
          NPC_Objects[i].damage_view = 0;
        }
      }
      if ( NPC_Objects[i].Direction )
        side = NPC_Objects[i].view.back;
      else
        side = NPC_Objects[i].view.front;
      temp1 = NPC_Objects[i].Y_pos - NPC_Objects[i].view.top;
      temp2 = (((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9) - Camera_Y / 512;
      temp1 = NPC_Objects[i].X_pos - side;
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        a + (((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9) - Camera_X / 512,
        temp2,
        &NPC_Objects[i].Rect,
        NPC_Objects[i].Entity_Spritesheet);
    }
  }
}

//----- (0046FA00) --------------------------------------------------------
void __cdecl Update_NPCs()
{
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 )       // Only run entity's AI if it's alive
    {
      NPC_Function_Table[NPC_Objects[i].Entity_Type](&NPC_Objects[i]);
      if ( NPC_Objects[i].Is_Being_Hit )
        --NPC_Objects[i].Is_Being_Hit;
    }
  }
}

//----- (0046FAB0) --------------------------------------------------------
void __cdecl Spawn_NPC(int Entity_Eve_Num, int Entity_Type, int Direction)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 && NPC_Objects[i].Entity_Eve_Num == Entity_Eve_Num )
    {
      NPC_Objects[i].Entity_Flags &= 0x7F00u;
      NPC_Objects[i].Entity_Type = Entity_Type;
      NPC_Objects[i].Entity_Flags |= NPC_Table[NPC_Objects[i].Entity_Type].bits;
      NPC_Objects[i].EXP_Amount = NPC_Table[NPC_Objects[i].Entity_Type].exp;
      Set_Unique_Parameter(&NPC_Objects[i]);
      NPC_Objects[i].Is_Alive |= 0x80u;
      NPC_Objects[i].Current_State = 0;
      NPC_Objects[i].Wait_Timer = 0;
      NPC_Objects[i].count1 = 0;
      NPC_Objects[i].count2 = 0;
      NPC_Objects[i].Ani_Num = 0;
      NPC_Objects[i].ani_wait = 0;
      NPC_Objects[i].X_vel = 0;
      NPC_Objects[i].Y_vel = 0;
      if ( Direction != 5 )
      {
        if ( Direction == 4 )
        {
          if ( NPC_Objects[i].X_pos >= Quote.X_Pos )
            NPC_Objects[i].Direction = 0;
          else
            NPC_Objects[i].Direction = 2;
        }
        else
        {
          NPC_Objects[i].Direction = Direction;
        }
      }
      NPC_Function_Table[Entity_Type](&NPC_Objects[i]);
    }
  }
}

//----- (0046FD10) --------------------------------------------------------
void __cdecl Change_Checkable_NPC_By_Event(int Entity_Eve_Num, int Entity_Type, char Direction)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 && NPC_Objects[i].Entity_Eve_Num == Entity_Eve_Num )
    {
      NPC_Objects[i].Entity_Flags &= 0x7F00u;
      NPC_Objects[i].Entity_Flags |= 0x2000u;
      NPC_Objects[i].Entity_Type = Entity_Type;
      NPC_Objects[i].Entity_Flags |= NPC_Table[NPC_Objects[i].Entity_Type].bits;
      NPC_Objects[i].EXP_Amount = NPC_Table[NPC_Objects[i].Entity_Type].exp;
      Set_Unique_Parameter(&NPC_Objects[i]);
      NPC_Objects[i].Is_Alive |= 0x80u;
      NPC_Objects[i].Current_State = 0;
      NPC_Objects[i].Wait_Timer = 0;
      NPC_Objects[i].count1 = 0;
      NPC_Objects[i].count2 = 0;
      NPC_Objects[i].Ani_Num = 0;
      NPC_Objects[i].ani_wait = 0;
      NPC_Objects[i].X_vel = 0;
      NPC_Objects[i].Y_vel = 0;
      if ( Direction != 5 )
      {
        if ( Direction == 4 )
        {
          if ( NPC_Objects[i].X_pos >= Quote.X_Pos )
            NPC_Objects[i].Direction = 0;
          else
            NPC_Objects[i].Direction = 2;
        }
        else
        {
          NPC_Objects[i].Direction = Direction;
        }
      }
      NPC_Function_Table[Entity_Type](&NPC_Objects[i]);
    }
  }
}

//----- (0046FF90) --------------------------------------------------------
void __cdecl Set_NPC_State(int Entity_Eve_Num, int NPC_State, int Direction)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512 && (!(NPC_Objects[i].Is_Alive & 0x80) || NPC_Objects[i].Entity_Eve_Num != Entity_Eve_Num); ++i )
    ;
  if ( i != 512 )
  {
    NPC_Objects[i].Current_State = NPC_State;
    if ( Direction != 5 )
    {
      if ( Direction == 4 )
      {
        if ( NPC_Objects[i].X_pos >= Quote.X_Pos )
          NPC_Objects[i].Direction = 0;
        else
          NPC_Objects[i].Direction = 2;
      }
      else
      {
        NPC_Objects[i].Direction = Direction;
      }
    }
  }
}

//----- (00470060) --------------------------------------------------------
void __cdecl Move_NPC(int Entity_Eve_Num, int X_Pos, int Y_Pos, char Direction)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512 && (!(NPC_Objects[i].Is_Alive & 0x80) || NPC_Objects[i].Entity_Eve_Num != Entity_Eve_Num); ++i )
    ;
  if ( i != 512 )
  {
    NPC_Objects[i].X_pos = X_Pos;
    NPC_Objects[i].Y_pos = Y_Pos;
    if ( Direction != 5 )
    {
      if ( Direction == 4 )
      {
        if ( NPC_Objects[i].X_pos >= Quote.X_Pos )
          NPC_Objects[i].Direction = 0;
        else
          NPC_Objects[i].Direction = 2;
      }
      else
      {
        NPC_Objects[i].Direction = Direction;
      }
    }
  }
}

//----- (00470150) --------------------------------------------------------
void __cdecl Back_Step_Player(int Entity_Eve_Num)
{
  signed int n; // [sp+0h] [bp-4h]@1

  n = 0;
  Quote.Flags &= 0xFEu;
  Quote.Y_Vel = -512;
  if ( Entity_Eve_Num )
  {
    if ( Entity_Eve_Num == 2 )
    {
      Quote.Direction = 2;
      Quote.X_Vel = -512;
    }
    else
    {
      while ( n < 512 && (!(NPC_Objects[n].Is_Alive & 0x80) || NPC_Objects[n].Entity_Eve_Num != Entity_Eve_Num) )
        ++n;
      if ( n != 512 )
      {
        if ( NPC_Objects[n].X_pos >= Quote.X_Pos )
        {
          Quote.Direction = 2;
          Quote.X_Vel = -512;
        }
        else
        {
          Quote.Direction = 0;
          Quote.X_Vel = 512;
        }
      }
    }
  }
  else
  {
    Quote.Direction = 0;
    Quote.X_Vel = 512;
  }
}

//----- (00470250) --------------------------------------------------------
void __cdecl Delete_NPC_Event(int Entity_Eve_Num)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 )
    {
      if ( NPC_Objects[i].Entity_Eve_Num == Entity_Eve_Num )
      {
        NPC_Objects[i].Is_Alive = 0;
        Set_NPC_Flag(NPC_Objects[i].code_flag);
      }
    }
  }
}

//----- (004702D0) --------------------------------------------------------
void __cdecl Kill_NPC(int Number, int bSmoke)
{
  int NPC_Explosion_Size; // [sp+0h] [bp-8h]@6
  signed int i; // [sp+4h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 )
    {
      if ( NPC_Objects[i].Entity_Type == Number )
      {
        NPC_Objects[i].Is_Alive = 0;
        Set_NPC_Flag(NPC_Objects[i].code_flag);
        if ( bSmoke )
        {
          Play_Sound_Effect((Sound_Effects_enum)NPC_Objects[i].Sound_Death, 1);
          NPC_Explosion_Size = NPC_Objects[i].Explosion_Size;
          switch ( NPC_Explosion_Size )
          {
            case 1:
              Create_Dust_Clouds(NPC_Objects[i].X_pos, NPC_Objects[i].Y_pos, NPC_Objects[i].view.back, 4);
              break;
            case 2:
              Create_Dust_Clouds(NPC_Objects[i].X_pos, NPC_Objects[i].Y_pos, NPC_Objects[i].view.back, 8);
              break;
            case 3:
              Create_Dust_Clouds(NPC_Objects[i].X_pos, NPC_Objects[i].Y_pos, NPC_Objects[i].view.back, 16);
              break;
          }
        }
      }
    }
  }
}

//----- (00470460) --------------------------------------------------------
// Unused
void __cdecl Get_NPC_Position(int *X_Pos_Dest, int *Y_Pos_Dest, int NPC_object_num)
{
  *X_Pos_Dest = NPC_Objects[NPC_object_num].X_pos;
  *Y_Pos_Dest = NPC_Objects[NPC_object_num].Y_pos;
}

//----- (00470490) --------------------------------------------------------
signed int __cdecl Is_NPC_code(int code)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 && NPC_Objects[i].Entity_Type == code )
      return 1;
  }
  return 0;
}

//----- (004704F0) --------------------------------------------------------
bool __cdecl Check_NPC_alive(int code_event)
{
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512 && (!(NPC_Objects[i].Is_Alive & 0x80) || NPC_Objects[i].Entity_Eve_Num != code_event); ++i )
    ;
  return i < 512;
}

//----- (00470560) --------------------------------------------------------
int Count_Live_NPCs()
{
  signed int i; // [sp+0h] [bp-8h]@1
  int Live_NPCs_Counter; // [sp+4h] [bp-4h]@1

  Live_NPCs_Counter = 0;
  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 )
      ++Live_NPCs_Counter;
  }
  return Live_NPCs_Counter;
}

//----- (004705C0) --------------------------------------------------------
void __cdecl NPC_Collision_Block(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 5) << 9
    && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 5) << 9
    && npc->X_pos - npc->Hitbox.back < (16 * X_Pos + 8) << 9
    && npc->X_pos - npc->Hitbox.back > X_Pos << 13 )
  {
    npc->X_pos = npc->Hitbox.back + ((16 * X_Pos + 8) << 9);
    hit = 1;
  }
  if ( npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 5) << 9
    && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 5) << 9
    && npc->Hitbox.back + npc->X_pos > (16 * X_Pos - 8) << 9
    && npc->Hitbox.back + npc->X_pos < X_Pos << 13 )
  {
    npc->X_pos = ((16 * X_Pos - 8) << 9) - npc->Hitbox.back;
    hit |= 4u;
  }
  if ( npc->X_pos - npc->Hitbox.back < (16 * X_Pos + 5) << 9
    && npc->Hitbox.back + npc->X_pos > (16 * X_Pos - 5) << 9
    && npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 8) << 9
    && npc->Y_pos - npc->Hitbox.top > Y_Pos << 13 )
  {
    npc->Y_pos = npc->Hitbox.top + ((16 * Y_Pos + 8) << 9);
    npc->Y_vel = 0;
    hit |= 2u;
  }
  if ( npc->X_pos - npc->Hitbox.back < (16 * X_Pos + 5) << 9
    && npc->Hitbox.back + npc->X_pos > (16 * X_Pos - 5) << 9
    && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 8) << 9
    && npc->Hitbox.bottom + npc->Y_pos < Y_Pos << 13 )
  {
    npc->Y_pos = ((16 * Y_Pos - 8) << 9) - npc->Hitbox.bottom;
    npc->Y_vel = 0;
    hit |= 8u;
  }
  npc->Collision_flags |= hit;
}

//----- (00470870) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_A(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@5 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Y_pos - npc->Hitbox.top < (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) + 2048
      && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) + npc->Hitbox.top + 2048;
      if ( npc->Y_vel < 0 )
        npc->Y_vel = 0;
      hit = 2;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470970) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_B(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@5 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Y_pos - npc->Hitbox.top < (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) - 2048
      && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) + npc->Hitbox.top - 2048;
      if ( npc->Y_vel < 0 )
        npc->Y_vel = 0;
      hit = 2;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470A70) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_C(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@5 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Y_pos - npc->Hitbox.top < (Y_Pos << 13) + (((signed int)temp1 - HIDWORD(temp1)) >> 1) - 2048
      && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (((signed int)temp1 - HIDWORD(temp1)) >> 1) + (Y_Pos << 13) + npc->Hitbox.top - 2048;
      if ( npc->Y_vel < 0 )
        npc->Y_vel = 0;
      hit = 2;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470B70) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_D(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@3 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Y_pos - npc->Hitbox.top < (Y_Pos << 13) + (((signed int)temp1 - HIDWORD(temp1)) >> 1) + 2048
      && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (((signed int)temp1 - HIDWORD(temp1)) >> 1) + (Y_Pos << 13) + npc->Hitbox.top + 2048;
      if ( npc->Y_vel < 0 )
        npc->Y_vel = 0;
      hit = 2;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470C70) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_E(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@3 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x10000;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Hitbox.bottom + npc->Y_pos > (Y_Pos << 13) + (((signed int)temp1 - HIDWORD(temp1)) >> 1) - 2048
      && npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (Y_Pos << 13) + (((signed int)temp1 - HIDWORD(temp1)) >> 1) - 2048 - npc->Hitbox.bottom;
      if ( npc->Y_vel > 0 )
        npc->Y_vel = 0;
      hit = 0x10028;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470D80) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_F(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@5 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x20000;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos >= (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Hitbox.bottom + npc->Y_pos > (Y_Pos << 13) + (((signed int)temp1 - HIDWORD(temp1)) >> 1) + 2048
      && npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (Y_Pos << 13) + (((signed int)temp1 - HIDWORD(temp1)) >> 1) + 2048 - npc->Hitbox.bottom;
      if ( npc->Y_vel > 0 )
        npc->Y_vel = 0;
      hit = 0x20028;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470E90) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_G(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@5 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x40000;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Hitbox.bottom + npc->Y_pos > (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) + 2048
      && npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) + 2048 - npc->Hitbox.bottom;
      if ( npc->Y_vel > 0 )
        npc->Y_vel = 0;
      hit = 262168;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (00470FA0) --------------------------------------------------------
void __cdecl NPC_Collision_Triangle_H(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  __int64 temp1; // rax@5 MAPDST
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0x80000;
  if ( npc->X_pos < (16 * X_Pos + 8) << 9 && npc->X_pos > (16 * X_Pos - 8) << 9 )
  {
    temp1 = npc->X_pos - (X_Pos << 13);
    if ( npc->Hitbox.bottom + npc->Y_pos > (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) - 2048
      && npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 8) << 9 )
    {
      temp1 = npc->X_pos - (X_Pos << 13);
      npc->Y_pos = (Y_Pos << 13) - (((signed int)temp1 - HIDWORD(temp1)) >> 1) - 2048 - npc->Hitbox.bottom;
      if ( npc->Y_vel > 0 )
        npc->Y_vel = 0;
      hit = 524312;
    }
  }
  npc->Collision_flags |= hit;
}

//----- (004710B0) --------------------------------------------------------
void __cdecl NPC_Collision_Water(NPC_vars *npc, int X_Pos, int Y_Pos)
{
  signed int hit; // [sp+0h] [bp-4h]@1

  hit = 0;
  if ( npc->X_pos - npc->Hitbox.back < (16 * X_Pos + 6) << 9
    && npc->Hitbox.back + npc->X_pos > (16 * X_Pos - 6) << 9
    && npc->Y_pos - npc->Hitbox.top < (16 * Y_Pos + 6) << 9
    && npc->Hitbox.bottom + npc->Y_pos > (16 * Y_Pos - 6) << 9 )
  {
    hit = 256;
  }
  npc->Collision_flags |= hit;
}

//----- (00471160) --------------------------------------------------------
void Do_Collision_Check_NPCs_Map()
{
  __int64 temp_X; // rax@7 MAPDST
  __int64 temp_Y; // rax@7 MAPDST
  signed int judg; // [sp+4h] [bp-5Ch]@7
  int Off_X[9]; // [sp+8h] [bp-58h]@1
  int j; // [sp+2Ch] [bp-34h]@9
  int Off_Y[9]; // [sp+30h] [bp-30h]@1
  int i; // [sp+54h] [bp-Ch]@1
  int X_Pos_Blocks; // [sp+58h] [bp-8h]@7
  int Y_Pos_Blocks; // [sp+5Ch] [bp-4h]@7

  Off_X[0] = 0;
  Off_X[1] = 1;
  Off_X[2] = 0;
  Off_X[3] = 1;
  Off_X[4] = 2;
  Off_X[5] = 2;
  Off_X[6] = 2;
  Off_X[7] = 0;
  Off_X[8] = 1;
  Off_Y[0] = 0;
  Off_Y[1] = 0;
  Off_Y[2] = 1;
  Off_Y[3] = 1;
  Off_Y[4] = 0;
  Off_Y[5] = 1;
  Off_Y[6] = 2;
  Off_Y[7] = 2;
  Off_Y[8] = 2;
  for ( i = 0; i < 512; ++i )
  {
    if ( NPC_Objects[i].Is_Alive & 0x80 && !(NPC_Objects[i].Entity_Flags & 8) )
    {
      if ( NPC_Objects[i].Explosion_Size < 3 )
      {
        judg = 4;
        temp_X = NPC_Objects[i].X_pos / 16;
        X_Pos_Blocks = ((WORD2(temp_X) & 0x1FF) + (signed int)temp_X) >> 9;
        temp_Y = NPC_Objects[i].Y_pos / 16;
        Y_Pos_Blocks = ((WORD2(temp_Y) & 0x1FF) + (signed int)temp_Y) >> 9;
      }
      else
      {
        judg = 9;
        temp_X = NPC_Objects[i].X_pos - 4096;
        X_Pos_Blocks = (((BYTE4(temp_X) & 0xF) + (signed int)temp_X) >> 4) / 512;
        temp_Y = NPC_Objects[i].Y_pos - 4096;
        Y_Pos_Blocks = (((BYTE4(temp_Y) & 0xF) + (signed int)temp_Y) >> 4) / 512;
      }
      NPC_Objects[i].Collision_flags = 0;
      for ( j = 0; j < judg; ++j )
      {
        switch ( Get_Tile_Attributes(Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks) )
        {
          case 68u:
            if ( !(NPC_Objects[i].Entity_Flags & 2) )
              goto case_67;
            break;
          case 3u:
          case 5u:
          case 65u:
          case 67u:
case_67:
            NPC_Collision_Block(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 80u:
            NPC_Collision_Triangle_A(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 81u:
            NPC_Collision_Triangle_B(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 82u:
            NPC_Collision_Triangle_C(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 83u:
            NPC_Collision_Triangle_D(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 84u:
            NPC_Collision_Triangle_E(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 85u:
            NPC_Collision_Triangle_F(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 86u:
            NPC_Collision_Triangle_G(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 87u:
            NPC_Collision_Triangle_H(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 2u:
          case 96u:
          case 98u:
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 4u:
          case 97u:
          case 100u:
            NPC_Collision_Block(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 112u:
            NPC_Collision_Triangle_A(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 113u:
            NPC_Collision_Triangle_B(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 114u:
            NPC_Collision_Triangle_C(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 115u:
            NPC_Collision_Triangle_D(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 116u:
            NPC_Collision_Triangle_E(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 117u:
            NPC_Collision_Triangle_F(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 118u:
            NPC_Collision_Triangle_G(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 119u:
            NPC_Collision_Triangle_H(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&NPC_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 160u:
            NPC_Objects[i].Collision_flags |= 0x100u;
            goto case_128;
          case 128u:
case_128:
            NPC_Objects[i].Collision_flags |= 0x1000u;
            break;
          case 161u:
            NPC_Objects[i].Collision_flags |= 0x100u;
            goto case_129;
          case 129u:
case_129:
            NPC_Objects[i].Collision_flags |= 0x2000u;
            break;
          case 162u:
            NPC_Objects[i].Collision_flags |= 0x100u;
            goto case_130;
          case 130u:
case_130:
            NPC_Objects[i].Collision_flags |= 0x4000u;
            break;
          case 163u:
            NPC_Objects[i].Collision_flags |= 0x100u;
            goto case_131;
          case 131u:
case_131:
            NPC_Objects[i].Collision_flags |= 0x8000u;
            break;
          default:
            break;
        }
        if ( NPC_Objects[i].Y_pos > GlobalWaterDepth + 2048 )
          NPC_Objects[i].Collision_flags |= 0x100u;
      }
    }
  }
}
// 499C90: using guessed type int GlobalWaterDepth;

//----- (00471B80) --------------------------------------------------------
void __cdecl NPC_Death_Maybe(void *Is_NPC_Alive, int a2)
{
  signed int v2; // eax@17
  int v3; // [sp+0h] [bp-Ch]@9
  int v4; // [sp+4h] [bp-8h]@1

  Play_Sound_Effect(*((Sound_Effects_enum *)Is_NPC_Alive + 15), 1);
  v4 = *((_DWORD *)Is_NPC_Alive + 18);
  switch ( v4 )
  {
    case 1:
      Create_Dust_Clouds(
        *((_DWORD *)Is_NPC_Alive + 2),
        *((_DWORD *)Is_NPC_Alive + 3),
        *((_DWORD *)Is_NPC_Alive + 37),
        3);
      break;
    case 2:
      Create_Dust_Clouds(
        *((_DWORD *)Is_NPC_Alive + 2),
        *((_DWORD *)Is_NPC_Alive + 3),
        *((_DWORD *)Is_NPC_Alive + 37),
        7);
      break;
    case 3:
      Create_Dust_Clouds(
        *((_DWORD *)Is_NPC_Alive + 2),
        *((_DWORD *)Is_NPC_Alive + 3),
        *((_DWORD *)Is_NPC_Alive + 37),
        12);
      break;
  }
  if ( *((_DWORD *)Is_NPC_Alive + 17) )
  {
    v3 = Random(1, 5);
    if ( v3 == 1 )
    {
      if ( *((_DWORD *)Is_NPC_Alive + 17) <= 6 )
        Spawn_HP(*((_DWORD *)Is_NPC_Alive + 2), *((_DWORD *)Is_NPC_Alive + 3), 2);
      else
        Spawn_HP(*((_DWORD *)Is_NPC_Alive + 2), *((_DWORD *)Is_NPC_Alive + 3), 6);
    }
    else if ( v3 != 2
           || (*((_DWORD *)Is_NPC_Alive + 17) <= 6 ? (v2 = Spawn_Missiles(
                                                             *((_DWORD *)Is_NPC_Alive + 2),
                                                             *((_DWORD *)Is_NPC_Alive + 3),
                                                             1)) : (v2 = Spawn_Missiles(
                                                                           *((_DWORD *)Is_NPC_Alive + 2),
                                                                           *((_DWORD *)Is_NPC_Alive + 3),
                                                                           3)),
               !v2) )
    {
      Spawn_Exp(*((_DWORD *)Is_NPC_Alive + 2), *((_DWORD *)Is_NPC_Alive + 3), *((_DWORD *)Is_NPC_Alive + 17));
    }
  }
  Set_NPC_Flag(*((_DWORD *)Is_NPC_Alive + 11));
  if ( *((_WORD *)Is_NPC_Alive + 40) & 0x8000 )
  {
    if ( *((_WORD *)Is_NPC_Alive + 40) & 0x8000 && *((_DWORD *)Is_NPC_Alive + 40) )
      Set_Value_View((__int32)Is_NPC_Alive + 8, (__int32)Is_NPC_Alive + 12, *((_DWORD *)Is_NPC_Alive + 40));
    if ( a2 )
      Vanish_NPC((NPC_vars *)Is_NPC_Alive);
  }
  else
  {
    *(_BYTE *)Is_NPC_Alive = 0;
  }
}

//----- (00471D50) --------------------------------------------------------
int Entity_Bullet_Collision()
{
  int result; // eax@2
  __int64 v1; // rax@35
  int v2; // ST04_4@35
  __int64 v3; // rax@35
  __int64 v4; // rax@35
  int v5; // ST04_4@35
  __int64 v6; // rax@35
  __int64 v7; // rax@35
  int v8; // ST04_4@35
  __int64 v9; // rax@35
  __int64 v10; // rax@47
  int v11; // ST04_4@47
  __int64 v12; // rax@47
  signed int j; // [sp+0h] [bp-Ch]@7
  signed int v14; // [sp+4h] [bp-8h]@12
  signed int i; // [sp+8h] [bp-4h]@1

  for ( i = 0; i < 512; ++i )
  {
    if ( !(NPC_Objects[i].Is_Alive & 0x80) || NPC_Objects[i].Entity_Flags & 0x20 && NPC_Objects[i].Entity_Flags & 0x2000 )
      goto LABEL_2;
    for ( j = 0; j < 64; ++j )
    {
      if ( Bullet_Objects[j].isAlive & 0x80 && Bullet_Objects[j].damage != -1 )
      {
        v14 = 0;
        if ( NPC_Objects[i].Entity_Flags & 0x20
          && NPC_Objects[i].X_pos - NPC_Objects[i].Hitbox.back < Bullet_Objects[j].enemyXL + Bullet_Objects[j].XPos
          && NPC_Objects[i].Hitbox.back + NPC_Objects[i].X_pos > Bullet_Objects[j].XPos - Bullet_Objects[j].enemyXL
          && NPC_Objects[i].Y_pos - NPC_Objects[i].Hitbox.top < Bullet_Objects[j].enemyYL + Bullet_Objects[j].YPos
          && NPC_Objects[i].Hitbox.bottom + NPC_Objects[i].Y_pos > Bullet_Objects[j].YPos - Bullet_Objects[j].enemyYL )
        {
          v14 = 1;
        }
        else if ( NPC_Objects[i].Entity_Flags & 4
               && NPC_Objects[i].X_pos - NPC_Objects[i].Hitbox.back < Bullet_Objects[j].blockXL + Bullet_Objects[j].XPos
               && NPC_Objects[i].Hitbox.back + NPC_Objects[i].X_pos > Bullet_Objects[j].XPos - Bullet_Objects[j].blockXL
               && NPC_Objects[i].Y_pos - NPC_Objects[i].Hitbox.top < Bullet_Objects[j].blockYL + Bullet_Objects[j].YPos
               && NPC_Objects[i].Hitbox.bottom + NPC_Objects[i].Y_pos > Bullet_Objects[j].YPos
                                                                      - Bullet_Objects[j].blockYL )
        {
          v14 = 1;
        }
        if ( v14 )
        {
          if ( NPC_Objects[i].Entity_Flags & 0x20 )
          {
            NPC_Objects[i].Life -= Bullet_Objects[j].damage;
            if ( NPC_Objects[i].Life >= 1 )
            {
              if ( (signed int)NPC_Objects[i].Is_Being_Hit < 14 )
              {
                v1 = NPC_Objects[i].Y_pos + Bullet_Objects[j].YPos;
                v2 = ((signed int)v1 - HIDWORD(v1)) >> 1;
                v3 = NPC_Objects[i].X_pos + Bullet_Objects[j].XPos;
                Create_Effect(((signed int)v3 - HIDWORD(v3)) >> 1, v2, 11, 0);
                v4 = NPC_Objects[i].Y_pos + Bullet_Objects[j].YPos;
                v5 = ((signed int)v4 - HIDWORD(v4)) >> 1;
                v6 = NPC_Objects[i].X_pos + Bullet_Objects[j].XPos;
                Create_Effect(((signed int)v6 - HIDWORD(v6)) >> 1, v5, 11, 0);
                v7 = NPC_Objects[i].Y_pos + Bullet_Objects[j].YPos;
                v8 = ((signed int)v7 - HIDWORD(v7)) >> 1;
                v9 = NPC_Objects[i].X_pos + Bullet_Objects[j].XPos;
                Create_Effect(((signed int)v9 - HIDWORD(v9)) >> 1, v8, 11, 0);
                Play_Sound_Effect((Sound_Effects_enum)NPC_Objects[i].Sound_Hit, 1);
                NPC_Objects[i].Is_Being_Hit = 16;
              }
              if ( NPC_Objects[i].Entity_Flags & 0x8000 )
                NPC_Objects[i].damage_view -= Bullet_Objects[j].damage;
            }
            else
            {
              NPC_Objects[i].Life = 0;
              if ( NPC_Objects[i].Entity_Flags & 0x8000 )
                NPC_Objects[i].damage_view -= Bullet_Objects[j].damage;
              if ( Quote.Flags & 0x80 && NPC_Objects[i].Entity_Flags & 0x200 )
                Start_TSC_Event(NPC_Objects[i].Entity_Eve_Num);
              else
                NPC_Objects[i].Is_Alive |= 8u;
            }
          }
          else if ( Bullet_Objects[j].code_bullet != 13
                 && Bullet_Objects[j].code_bullet != 14
                 && Bullet_Objects[j].code_bullet != 15
                 && Bullet_Objects[j].code_bullet != 28
                 && Bullet_Objects[j].code_bullet != 29
                 && Bullet_Objects[j].code_bullet != 30
                 && !(Bullet_Objects[j].flags & 0x10) )
          {
            v10 = NPC_Objects[i].Y_pos + Bullet_Objects[j].YPos;
            v11 = ((signed int)v10 - HIDWORD(v10)) >> 1;
            v12 = NPC_Objects[i].X_pos + Bullet_Objects[j].XPos;
            Create_Effect(((signed int)v12 - HIDWORD(v12)) >> 1, v11, 2, 2);
            Play_Sound_Effect(Sfx_Shot_Hit_Invulnerable_Entity, 1);
            Bullet_Objects[j].life = 0;
            continue;
          }
          --Bullet_Objects[j].life;
        }
      }
    }
    if ( NPC_Objects[i].Is_Alive & 8 )
      NPC_Death_Maybe(&NPC_Objects[i], 1);
LABEL_2:
    result = i + 1;
  }
  return result;
}

//----- (00472400) --------------------------------------------------------
int __cdecl LoadNPCTable(char *path)
{
  int result; // eax@2
  unsigned int size; // [sp+0h] [bp-10h]@1
  FILE *stream; // [sp+4h] [bp-Ch]@5
  signed int num; // [sp+8h] [bp-8h]@3
  signed int i; // [sp+Ch] [bp-4h]@7
  signed int j; // [sp+Ch] [bp-4h]@10
  signed int k; // [sp+Ch] [bp-4h]@13
  signed int l; // [sp+Ch] [bp-4h]@16
  signed int m; // [sp+Ch] [bp-4h]@19
  signed int n; // [sp+Ch] [bp-4h]@22
  signed int ii; // [sp+Ch] [bp-4h]@25
  signed int jj; // [sp+Ch] [bp-4h]@28
  signed int kk; // [sp+Ch] [bp-4h]@31
  signed int ll; // [sp+Ch] [bp-4h]@34

  size = getFileSize(path);
  if ( size == -1 )
  {
    result = 0;
  }
  else
  {
    num = size / 0x18;
    NPC_Table = (NPC_Info *)malloc(24 * (size / 0x18));
    if ( NPC_Table )
    {
      stream = fopen(path, "rb");
      if ( stream )
      {
        for ( i = 0; i < num; ++i )
          fread(&NPC_Table[i], 2u, 1u, stream);
        for ( j = 0; j < num; ++j )
          fread(&NPC_Table[j].life, 2u, 1u, stream);
        for ( k = 0; k < num; ++k )
          fread(&NPC_Table[k].surf, 1u, 1u, stream);
        for ( l = 0; l < num; ++l )
          fread(&NPC_Table[l].destroy_voice, 1u, 1u, stream);
        for ( m = 0; m < num; ++m )
          fread(&NPC_Table[m].hit_voice, 1u, 1u, stream);
        for ( n = 0; n < num; ++n )
          fread(&NPC_Table[n].size, 1u, 1u, stream);
        for ( ii = 0; ii < num; ++ii )
          fread(&NPC_Table[ii].exp, 4u, 1u, stream);
        for ( jj = 0; jj < num; ++jj )
          fread(&NPC_Table[jj].damage, 4u, 1u, stream);
        for ( kk = 0; kk < num; ++kk )
          fread(&NPC_Table[kk].hit, 4u, 1u, stream);
        for ( ll = 0; ll < num; ++ll )
          fread(&NPC_Table[ll].view, 4u, 1u, stream);
        fclose(stream);
        result = 1;
      }
      else
      {
        free(NPC_Table);
        NPC_Table = NULL;
        result = 0;
      }
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (00472710) --------------------------------------------------------
void Free_NPC_Table()
{
  if ( NPC_Table )
  {
    free(NPC_Table);
    NPC_Table = NULL;
  }
}

//----- (00472740) --------------------------------------------------------
void __cdecl Init_Room_Boss(int Boss_Num)
{
  memset(Boss_Objects, 0, 0xD70u);
  Boss_Objects[0].Is_Alive = -128;
  Boss_Objects[0].Entity_Type = Boss_Num;
}

//----- (00472770) --------------------------------------------------------
void __cdecl Draw_Boss(signed int Camera_X, signed int Camera_Y)
{
  __int64 temp3; // rax@12
  int temp1; // ST08_4@12
  __int64 temp2; // rax@12
  int side; // [sp+0h] [bp-Ch]@10
  signed int i; // [sp+4h] [bp-8h]@1
  char a; // [sp+Bh] [bp-1h]@5

  for ( i = 19; i >= 0; --i )
  {
    if ( Boss_Objects[i].Is_Alive & 0x80 )
    {
      if ( Boss_Objects[i].Is_Being_Hit )
      {
        a = 2 * (((signed int)Boss_Objects[i].Is_Being_Hit >> 1) % 2) - 1;
      }
      else
      {
        a = 0;
        if ( Boss_Objects[i].Entity_Flags & 0x8000 && Boss_Objects[i].damage_view )
        {
          Set_Value_View((__int32)&Boss_Objects[i].X_pos, (__int32)&Boss_Objects[i].Y_pos, Boss_Objects[i].damage_view);
          Boss_Objects[i].damage_view = 0;
        }
      }
      if ( Boss_Objects[i].Direction )
        side = Boss_Objects[i].view.back;
      else
        side = Boss_Objects[i].view.front;
      temp3 = Boss_Objects[i].Y_pos - Boss_Objects[i].view.top;
      temp1 = (((WORD2(temp3) & 0x1FF) + (signed int)temp3) >> 9) - Camera_Y / 512;
      temp2 = Boss_Objects[i].X_pos - side;
      Draw_Bitmap_With_Transparency(
        &Rect_Game,
        a + (((WORD2(temp2) & 0x1FF) + (signed int)temp2) >> 9) - Camera_X / 512,
        temp1,
        &Boss_Objects[i].Rect,
        22);
    }
  }
}

//----- (00472940) --------------------------------------------------------
// Can be optimised to
// mov eax, [ebp+arg_0]
// mov dword_4BBACC, eax
// retn
// (offset 472940
// 8B 45 08 A3 CC BA 4B 00 C3 90 90)
int __cdecl Set_Boss_Script_State(int a1)
{
  int result; // eax@1

  result = a1;
  Boss_Objects[0].Current_State = a1;
  return result;
}

//----- (00472950) --------------------------------------------------------
void __cdecl Do_Collision_Check_Bosses_Bullets()
{
  int Boss_Explosion_Size; // [sp+0h] [bp-14h]@31
  signed int Bullet; // [sp+4h] [bp-10h]@5
  signed int Boss; // [sp+8h] [bp-Ch]@1
  signed int bHit; // [sp+Ch] [bp-8h]@10
  int Boss_; // [sp+10h] [bp-4h]@25

  for ( Boss = 0; Boss < 20; ++Boss )
  {
    if ( Boss_Objects[Boss].Is_Alive & 0x80 )
    {
      for ( Bullet = 0; Bullet < 64; ++Bullet )
      {
        if ( Bullet_Objects[Bullet].isAlive & 0x80 && Bullet_Objects[Bullet].damage != -1 )
        {
          bHit = 0;
          if ( Boss_Objects[Boss].Entity_Flags & 0x20
            && Boss_Objects[Boss].X_pos - Boss_Objects[Boss].Hitbox.back < Bullet_Objects[Bullet].enemyXL
                                                                         + Bullet_Objects[Bullet].XPos
            && Boss_Objects[Boss].Hitbox.back + Boss_Objects[Boss].X_pos > Bullet_Objects[Bullet].XPos
                                                                         - Bullet_Objects[Bullet].enemyXL
            && Boss_Objects[Boss].Y_pos - Boss_Objects[Boss].Hitbox.top < Bullet_Objects[Bullet].enemyYL
                                                                        + Bullet_Objects[Bullet].YPos
            && Boss_Objects[Boss].Hitbox.bottom + Boss_Objects[Boss].Y_pos > Bullet_Objects[Bullet].YPos
                                                                           - Bullet_Objects[Bullet].enemyYL )
          {
            bHit = 1;
          }
          else if ( Boss_Objects[Boss].Entity_Flags & 4
                 && Boss_Objects[Boss].X_pos - Boss_Objects[Boss].Hitbox.back < Bullet_Objects[Bullet].blockXL
                                                                              + Bullet_Objects[Bullet].XPos
                 && Boss_Objects[Boss].Hitbox.back + Boss_Objects[Boss].X_pos > Bullet_Objects[Bullet].XPos
                                                                              - Bullet_Objects[Bullet].blockXL
                 && Boss_Objects[Boss].Y_pos - Boss_Objects[Boss].Hitbox.top < Bullet_Objects[Bullet].blockYL
                                                                             + Bullet_Objects[Bullet].YPos
                 && Boss_Objects[Boss].Hitbox.bottom + Boss_Objects[Boss].Y_pos > Bullet_Objects[Bullet].YPos
                                                                                - Bullet_Objects[Bullet].blockYL )
          {
            bHit = 1;
          }
          if ( bHit )
          {
            if ( Boss_Objects[Boss].Entity_Flags & 0x20 )
            {
              if ( Boss_Objects[Boss].Is_Alive & 0x10 )
                Boss_ = 0;
              else
                Boss_ = Boss;
              Boss_Objects[Boss_].Life -= Bullet_Objects[Bullet].damage;
              if ( Boss_Objects[Boss_].Life >= 1 )
              {
                if ( (signed int)Boss_Objects[Boss].Is_Being_Hit < 14 )
                {
                  Create_Effect(Bullet_Objects[Bullet].XPos, Bullet_Objects[Bullet].YPos, 11, 0);
                  Create_Effect(Bullet_Objects[Bullet].XPos, Bullet_Objects[Bullet].YPos, 11, 0);
                  Create_Effect(Bullet_Objects[Bullet].XPos, Bullet_Objects[Bullet].YPos, 11, 0);
                  Play_Sound_Effect((Sound_Effects_enum)Boss_Objects[Boss_].Sound_Hit, 1);
                }
                Boss_Objects[Boss].Is_Being_Hit = 8;
                Boss_Objects[Boss_].Is_Being_Hit = 8;
                Boss_Objects[Boss_].damage_view -= Bullet_Objects[Bullet].damage;
              }
              else
              {
                Boss_Objects[Boss_].Life = Boss_;
                if ( Quote.Flags & 0x80 && Boss_Objects[Boss_].Entity_Flags & 0x200 )
                {
                  Start_TSC_Event(Boss_Objects[Boss_].Entity_Eve_Num);
                }
                else
                {
                  Play_Sound_Effect((Sound_Effects_enum)Boss_Objects[Boss_].Sound_Death, 1);
                  Boss_Explosion_Size = Boss_Objects[Boss_].Explosion_Size;
                  switch ( Boss_Explosion_Size )
                  {
                    case 1:
                      Create_Dust_Clouds(
                        Boss_Objects[Boss_].X_pos,
                        Boss_Objects[Boss_].Y_pos,
                        Boss_Objects[Boss_].view.back,
                        4);
                      break;
                    case 2:
                      Create_Dust_Clouds(
                        Boss_Objects[Boss_].X_pos,
                        Boss_Objects[Boss_].Y_pos,
                        Boss_Objects[Boss_].view.back,
                        8);
                      break;
                    case 3:
                      Create_Dust_Clouds(
                        Boss_Objects[Boss_].X_pos,
                        Boss_Objects[Boss_].Y_pos,
                        Boss_Objects[Boss_].view.back,
                        16);
                      break;
                  }
                  Boss_Objects[Boss_].Is_Alive = 0;
                }
              }
              if ( --Bullet_Objects[Bullet].life < 1 )
                Bullet_Objects[Bullet].isAlive = 0;
            }
            else if ( Bullet_Objects[Bullet].code_bullet != 13
                   && Bullet_Objects[Bullet].code_bullet != 14
                   && Bullet_Objects[Bullet].code_bullet != 15
                   && Bullet_Objects[Bullet].code_bullet != 28
                   && Bullet_Objects[Bullet].code_bullet != 29
                   && Bullet_Objects[Bullet].code_bullet != 30 )
            {
              if ( !(Bullet_Objects[Bullet].flags & 0x10) )
              {
                Create_Effect(Bullet_Objects[Bullet].XPos, Bullet_Objects[Bullet].YPos, 2, 2);
                Play_Sound_Effect(Sfx_Shot_Hit_Invulnerable_Entity, 1);
                Bullet_Objects[Bullet].isAlive = 0;
              }
            }
            else
            {
              --Bullet_Objects[Bullet].life;
            }
          }
        }
      }
    }
  }
}

//----- (00473000) --------------------------------------------------------
void __cdecl Update_Boss()
{
  signed int i; // [sp+4h] [bp-4h]@2

  if ( Boss_Objects[0].Is_Alive & 0x80 )
  {
    Boss_Function_Table[Boss_Objects[0].Entity_Type](Boss_Objects[0].Entity_Type);
    for ( i = 0; i < 20; ++i )
    {
      if ( Boss_Objects[i].Is_Being_Hit )
        --Boss_Objects[i].Is_Being_Hit;
    }
  }
}
// 472FF0: using guessed type int __cdecl Boss0_NoSpecialBoss(_DWORD);

//----- (00473080) --------------------------------------------------------
void __cdecl Do_Collision_Check_Bosses_Map()
{
  __int64 temp1; // rax@8 MAPDST
  signed int judg; // [sp+4h] [bp-ACh]@7
  int Off_X[16]; // [sp+8h] [bp-A8h]@1
  int j; // [sp+4Ch] [bp-64h]@9
  char Attributes[16]; // [sp+50h] [bp-60h]@12
  int i; // [sp+64h] [bp-4Ch]@1
  int Off_Y[16]; // [sp+68h] [bp-48h]@1
  int X_Pos_Blocks; // [sp+A8h] [bp-8h]@7
  int Y_Pos_Blocks; // [sp+ACh] [bp-4h]@7

  Off_X[0] = 0;
  Off_X[1] = 1;
  Off_X[2] = 0;
  Off_X[3] = 1;
  Off_X[4] = 2;
  Off_X[5] = 2;
  Off_X[6] = 2;
  Off_X[7] = 0;
  Off_X[8] = 1;
  Off_X[9] = -1;
  Off_X[10] = -1;
  Off_X[11] = -1;
  Off_X[12] = -1;
  Off_X[13] = 0;
  Off_X[14] = 1;
  Off_X[15] = 2;
  Off_Y[0] = 0;
  Off_Y[1] = 0;
  Off_Y[2] = 1;
  Off_Y[3] = 1;
  Off_Y[4] = 0;
  Off_Y[5] = 1;
  Off_Y[6] = 2;
  Off_Y[7] = 2;
  Off_Y[8] = 2;
  Off_Y[9] = -1;
  Off_Y[10] = 0;
  Off_Y[11] = 1;
  Off_Y[12] = 2;
  Off_Y[13] = -1;
  Off_Y[14] = -1;
  Off_Y[15] = -1;
  for ( i = 0; i < 20; ++i )
  {
    if ( Boss_Objects[i].Is_Alive & 0x80 && !(Boss_Objects[i].Entity_Flags & 8) )
    {
      if ( Boss_Objects[i].Explosion_Size < 3 )
      {
        judg = 4;
        temp1 = Boss_Objects[i].X_pos / 16;
        X_Pos_Blocks = ((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9;
        temp1 = Boss_Objects[i].Y_pos / 16;
        Y_Pos_Blocks = ((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9;
      }
      else
      {
        judg = 16;
        temp1 = Boss_Objects[i].X_pos / 16;
        X_Pos_Blocks = ((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9;
        temp1 = Boss_Objects[i].Y_pos / 16;
        Y_Pos_Blocks = ((WORD2(temp1) & 0x1FF) + (signed int)temp1) >> 9;
      }
      Boss_Objects[i].Collision_flags = 0;
      for ( j = 0; j < judg; ++j )
      {
        Attributes[j] = Get_Tile_Attributes(Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
        switch ( Attributes[j] )
        {
          case 68:
            if ( !(Boss_Objects[i].Entity_Flags & 2) )
              goto case_67;
            break;
          case 5:
          case 65:
          case 67:
case_67:
            NPC_Collision_Block(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 80:
            NPC_Collision_Triangle_A(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 81:
            NPC_Collision_Triangle_B(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 82:
            NPC_Collision_Triangle_C(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 83:
            NPC_Collision_Triangle_D(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 84:
            NPC_Collision_Triangle_E(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 85:
            NPC_Collision_Triangle_F(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 86:
            NPC_Collision_Triangle_G(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 87:
            NPC_Collision_Triangle_H(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 2:
          case 96:
          case 97:
          case 100:
            NPC_Collision_Block(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 112:
            NPC_Collision_Triangle_A(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 113:
            NPC_Collision_Triangle_B(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 114:
            NPC_Collision_Triangle_C(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 115:
            NPC_Collision_Triangle_D(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 116:
            NPC_Collision_Triangle_E(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 117:
            NPC_Collision_Triangle_F(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 118:
            NPC_Collision_Triangle_G(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          case 119:
            NPC_Collision_Triangle_H(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            NPC_Collision_Water(&Boss_Objects[i], Off_X[j] + X_Pos_Blocks, Off_Y[j] + Y_Pos_Blocks);
            break;
          default:
            continue;
        }
      }
    }
  }
}
// 473080: using guessed type char Attributes[16];

//----- (004739B0) --------------------------------------------------------
int __cdecl Core_Sub_NPC_Face(int a1)
{
  int *v1; // edx@9
  int v2; // eax@9
  int result; // eax@9
  int v4; // [sp+4h] [bp-40h]@1
  int v5; // [sp+8h] [bp-3Ch]@1
  int v6; // [sp+Ch] [bp-38h]@1
  int v7; // [sp+10h] [bp-34h]@1
  int v8; // [sp+14h] [bp-30h]@1
  int v9; // [sp+18h] [bp-2Ch]@1
  int v10; // [sp+1Ch] [bp-28h]@1
  int v11; // [sp+20h] [bp-24h]@1
  int v12; // [sp+24h] [bp-20h]@1
  int v13; // [sp+28h] [bp-1Ch]@1
  int v14; // [sp+2Ch] [bp-18h]@1
  int v15; // [sp+30h] [bp-14h]@1
  int v16; // [sp+34h] [bp-10h]@1
  int v17; // [sp+38h] [bp-Ch]@1
  int v18; // [sp+3Ch] [bp-8h]@1
  int v19; // [sp+40h] [bp-4h]@1

  v4 = 0;
  v5 = 0;
  v6 = 72;
  v7 = 112;
  v8 = 0;
  v9 = 112;
  v10 = 72;
  v11 = 224;
  v12 = 160;
  v13 = 0;
  v14 = 232;
  v15 = 112;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 2;
      *(_WORD *)(a1 + 80) = 8;
      *(_DWORD *)(a1 + 140) = 18432;
      *(_DWORD *)(a1 + 144) = 28672;
      goto LABEL_3;
    case 0xB:
LABEL_3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 18432;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 112;
      goto LABEL_5;
    case 0x33:
LABEL_5:
      if ( !--*(_DWORD *)(a1 + 120) )
      {
        *(_DWORD *)(a1 + 116) = 100;
        *(_DWORD *)(a1 + 104) = 3;
      }
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 18432;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 0x64:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  result = a1;
  if ( *(_DWORD *)(a1 + 116) == 51 )
  {
    result = a1;
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 120) + *(_DWORD *)(a1 + 88);
  }
  return result;
}

//----- (00473BD0) --------------------------------------------------------
int __cdecl Core_Sub_NPC_Tail(int a1)
{
  int *v1; // edx@9
  int v2; // eax@9
  int result; // eax@9
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 72;
  v5 = 0;
  v6 = 160;
  v7 = 112;
  v8 = 72;
  v9 = 112;
  v10 = 160;
  v11 = 224;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_WORD *)(a1 + 80) = 8;
      *(_DWORD *)(a1 + 140) = 22528;
      *(_DWORD *)(a1 + 144) = 28672;
      goto LABEL_3;
    case 0xB:
LABEL_3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 22528;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 112;
      goto LABEL_5;
    case 0x33:
LABEL_5:
      if ( !--*(_DWORD *)(a1 + 120) )
      {
        *(_DWORD *)(a1 + 116) = 100;
        *(_DWORD *)(a1 + 104) = 2;
      }
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 22528;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 0x64:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  result = a1;
  if ( *(_DWORD *)(a1 + 116) == 51 )
  {
    result = a1;
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 120) + *(_DWORD *)(a1 + 88);
  }
  return result;
}

//----- (00473DE0) --------------------------------------------------------
int __cdecl Core_Sub_NPC_Mini(int a1)
{
  __int64 v1; // rax@4
  __int64 v2; // rax@4
  __int64 v3; // rax@15
  __int64 v4; // rax@15
  int Y_Vel; // ST24_4@19
  int X_Vel; // ST28_4@19
  __int64 v7; // rax@21
  __int64 v8; // rax@21
  int *v9; // edx@27
  int result; // eax@27
  int v11; // [sp+Ch] [bp-34h]@1
  int v12; // [sp+10h] [bp-30h]@1
  int v13; // [sp+14h] [bp-2Ch]@1
  int v14; // [sp+18h] [bp-28h]@1
  int v15; // [sp+1Ch] [bp-24h]@1
  int v16; // [sp+20h] [bp-20h]@1
  int v17; // [sp+24h] [bp-1Ch]@1
  int v18; // [sp+28h] [bp-18h]@1
  int v19; // [sp+2Ch] [bp-14h]@1
  int v20; // [sp+30h] [bp-10h]@1
  int v21; // [sp+34h] [bp-Ch]@1
  int v22; // [sp+38h] [bp-8h]@1
  unsigned __int8 v23; // [sp+3Fh] [bp-1h]@19

  v11 = 256;
  v12 = 0;
  v13 = 320;
  v14 = 40;
  v15 = 256;
  v16 = 40;
  v17 = 320;
  v18 = 80;
  v19 = 256;
  v20 = 80;
  v21 = 320;
  v22 = 120;
  *(_DWORD *)(a1 + 64) = 1000;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 104) = 2;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      break;
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 32) = Boss_Objects[0].X_pos + (Random(-128, 32) << 9);
      *(_DWORD *)(a1 + 36) = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
      *(_WORD *)(a1 + 80) |= 0x20u;
      goto LABEL_4;
    case 0x65:
LABEL_4:
      v1 = *(_DWORD *)(a1 + 32) - *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 8) += ((BYTE4(v1) & 0xF) + (signed int)v1) >> 4;
      v2 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 12) += ((BYTE4(v2) & 0xF) + (signed int)v2) >> 4;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0x78:
      *(_DWORD *)(a1 + 116) = 121;
      *(_DWORD *)(a1 + 120) = 0;
      goto LABEL_8;
    case 0x79:
LABEL_8:
      if ( ++*(_DWORD *)(a1 + 120) / 2 % 2 )
        *(_DWORD *)(a1 + 104) = 0;
      else
        *(_DWORD *)(a1 + 104) = 1;
      if ( *(_DWORD *)(a1 + 120) > 20 )
        *(_DWORD *)(a1 + 116) = 130;
      break;
    case 0x82:
      *(_DWORD *)(a1 + 116) = 131;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 8) + (Random(24, 48) << 9);
      *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 12) + (Random(-4, 4) << 9);
      goto LABEL_15;
    case 0x83:
LABEL_15:
      v3 = *(_DWORD *)(a1 + 32) - *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 8) += ((BYTE4(v3) & 0xF) + (signed int)v3) >> 4;
      v4 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 12) += ((BYTE4(v4) & 0xF) + (signed int)v4) >> 4;
      if ( ++*(_DWORD *)(a1 + 120) > 50 )
      {
        *(_DWORD *)(a1 + 116) = 140;
        *(_DWORD *)(a1 + 104) = 0;
      }
      if ( *(_DWORD *)(a1 + 120) == 1 || *(_DWORD *)(a1 + 120) == 3 )
      {
        v23 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
        v23 += Random(-2, 2);
        Y_Vel = 2 * GetSin(v23);
        X_Vel = 2 * GetCos(v23);
        NPC_Create((NPC_Names)178, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      break;
    case 0x8C:
      v7 = *(_DWORD *)(a1 + 32) - *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 8) += ((BYTE4(v7) & 0xF) + (signed int)v7) >> 4;
      v8 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 12) += ((BYTE4(v8) & 0xF) + (signed int)v8) >> 4;
      break;
    case 0xC8:
      *(_DWORD *)(a1 + 116) = 201;
      *(_DWORD *)(a1 + 104) = 2;
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      goto LABEL_23;
    case 0xC9:
LABEL_23:
      *(_DWORD *)(a1 + 16) += 32;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      if ( *(_DWORD *)(a1 + 8) > (Current_Map.Width << 13) + 0x4000 )
        *(_BYTE *)a1 = 0;
      break;
    default:
      break;
  }
  if ( *(_BYTE *)(a1 + 156) )
    *(_DWORD *)(a1 + 32) += 1024;
  v9 = &v11 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v9;
  *(_DWORD *)(result + 4) = v9[1];
  *(_DWORD *)(result + 8) = v9[2];
  *(_DWORD *)(result + 12) = v9[3];
  return result;
}

//----- (00474340) --------------------------------------------------------
int __cdecl Core_Sub_NPC_Hit(int a1)
{
  int result; // eax@1

  result = a1;
  switch ( *(_DWORD *)(a1 + 108) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos;
      result = a1;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos - 0x4000;
      break;
    case 1:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 14336;
      result = a1;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 2:
      result = a1;
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 2048;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 0x4000;
      break;
    case 3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 14336;
      result = a1;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 2048;
      break;
    default:
      return result;
  }
  return result;
}

//----- (00474400) --------------------------------------------------------
int Boss_4_Core()
{
  int v0; // ST08_4@30
  int v1; // eax@30
  int v2; // ST08_4@36
  int v3; // eax@36
  unsigned __int8 v4; // ST47_1@45
  int Y_Vel; // ST38_4@45
  int X_Vel; // ST3C_4@45
  int v7; // ST10_4@51
  int v8; // ST0C_4@51
  int v9; // ST08_4@51
  int v10; // eax@51
  int v11; // ST10_4@56
  int v12; // ST0C_4@56
  int v13; // ST08_4@56
  int v14; // eax@56
  int v15; // ST10_4@74
  int v16; // ST0C_4@74
  int v17; // ST08_4@74
  int v18; // eax@74
  int v20; // [sp+4h] [bp-1Ch]@1
  signed int v21; // [sp+8h] [bp-18h]@1
  signed int i; // [sp+18h] [bp-8h]@49
  signed int ia; // [sp+18h] [bp-8h]@52
  signed int ib; // [sp+18h] [bp-8h]@72

  v21 = 0;
  v20 = Boss_Objects[0].Current_State;
  if ( v20 <= 220 )
  {
    if ( v20 != 220 )
    {
      switch ( v20 )
      {
        case 0:
          Boss_Objects[0].Current_State = 10;
          Boss_Objects[0].EXP_Amount = 1;
          Boss_Objects[0].Is_Alive = -128;
          Boss_Objects[0].Entity_Flags = -32756;
          Boss_Objects[0].Life = 650;
          Boss_Objects[0].Sound_Hit = 114;
          Boss_Objects[0].X_pos = 630784;
          Boss_Objects[0].Y_pos = 114688;
          Boss_Objects[0].X_vel = 0;
          Boss_Objects[0].Y_vel = 0;
          Boss_Objects[0].Entity_Eve_Num = 1000;
          Boss_Objects[0].Entity_Flags |= 0x200u;
          Boss_Objects[4].Is_Alive = -128;
          Boss_Objects[4].Current_State = 10;
          Boss_Objects[5].Is_Alive = -128;
          Boss_Objects[5].Current_State = 10;
          Boss_Objects[8].Is_Alive = -128;
          Boss_Objects[8].Entity_Flags = 12;
          Boss_Objects[8].view.front = 0;
          Boss_Objects[8].view.top = 0;
          Boss_Objects[8].Hitbox.back = 20480;
          Boss_Objects[8].Hitbox.top = 0x2000;
          Boss_Objects[8].Hitbox.bottom = 0x2000;
          Boss_Objects[8].count1 = 0;
          qmemcpy(&Boss_Objects[9], &Boss_Objects[8], sizeof(Boss_Objects[9]));
          Boss_Objects[9].Hitbox.back = 18432;
          Boss_Objects[9].Hitbox.top = 12288;
          Boss_Objects[9].Hitbox.bottom = 12288;
          Boss_Objects[9].count1 = 1;
          qmemcpy(&Boss_Objects[10], &Boss_Objects[8], sizeof(Boss_Objects[10]));
          Boss_Objects[10].Hitbox.back = 22528;
          Boss_Objects[10].Hitbox.top = 4096;
          Boss_Objects[10].Hitbox.bottom = 4096;
          Boss_Objects[10].count1 = 2;
          qmemcpy(&Boss_Objects[11], &Boss_Objects[8], sizeof(Boss_Objects[11]));
          Boss_Objects[11].Is_Alive |= 0x10u;
          Boss_Objects[11].Hitbox.back = 10240;
          Boss_Objects[11].Hitbox.top = 10240;
          Boss_Objects[11].Hitbox.bottom = 10240;
          Boss_Objects[11].count1 = 3;
          Boss_Objects[1].Is_Alive = -128;
          Boss_Objects[1].Current_State = 10;
          Boss_Objects[1].Entity_Flags = 44;
          Boss_Objects[1].Life = 1000;
          Boss_Objects[1].Sound_Hit = 54;
          Boss_Objects[1].Hitbox.back = 12288;
          Boss_Objects[1].Hitbox.top = 0x2000;
          Boss_Objects[1].Hitbox.bottom = 0x2000;
          Boss_Objects[1].view.front = 0x4000;
          Boss_Objects[1].view.top = 10240;
          Boss_Objects[1].X_pos = Boss_Objects[0].X_pos - 4096;
          Boss_Objects[1].Y_pos = Boss_Objects[0].Y_pos - 0x8000;
          qmemcpy(&Boss_Objects[2], &Boss_Objects[1], sizeof(Boss_Objects[2]));
          Boss_Objects[2].X_pos = Boss_Objects[0].X_pos + 0x2000;
          Boss_Objects[2].Y_pos = Boss_Objects[0].Y_pos;
          qmemcpy(&Boss_Objects[3], &Boss_Objects[1], sizeof(Boss_Objects[3]));
          Boss_Objects[3].X_pos = Boss_Objects[0].X_pos - 4096;
          Boss_Objects[3].Y_pos = Boss_Objects[0].Y_pos + 0x8000;
          qmemcpy(&Boss_Objects[6], &Boss_Objects[1], sizeof(Boss_Objects[6]));
          Boss_Objects[6].X_pos = Boss_Objects[0].X_pos - 24576;
          Boss_Objects[6].Y_pos = Boss_Objects[0].Y_pos - 0x4000;
          qmemcpy(&Boss_Objects[7], &Boss_Objects[1], sizeof(Boss_Objects[7]));
          Boss_Objects[7].X_pos = Boss_Objects[0].X_pos - 24576;
          Boss_Objects[7].Y_pos = Boss_Objects[0].Y_pos + 0x4000;
          goto LABEL_71;
        case 200:
          Boss_Objects[0].Current_State = 201;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[11].Entity_Flags &= 0xFFDFu;
          Curly_Shoot_Y = 0;
          Cut_Noise();
          goto LABEL_14;
        case 201:
LABEL_14:
          Boss_Objects[0].Curly_Target_X = Quote.X_Pos;
          Boss_Objects[0].Curly_Target_Y = Quote.Y_Pos;
          if ( ++Boss_Objects[0].Wait_Timer > 400 )
          {
            ++Boss_Objects[0].count1;
            Play_Sound_Effect(Sfx_Core_Thrust, 1);
            if ( Boss_Objects[0].count1 <= 3 )
            {
              Boss_Objects[0].Current_State = 210;
              Boss_Objects[4].Ani_Num = 0;
              Boss_Objects[5].Ani_Num = 0;
              v21 = 1;
            }
            else
            {
              Boss_Objects[0].count1 = 0;
              Boss_Objects[0].Current_State = 220;
              Boss_Objects[4].Ani_Num = 0;
              Boss_Objects[5].Ani_Num = 0;
              v21 = 1;
            }
          }
          goto LABEL_71;
        case 210:
          Boss_Objects[0].Current_State = 211;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].count2 = Boss_Objects[0].Life;
          Boss_Objects[11].Entity_Flags |= 0x20u;
          goto LABEL_20;
        case 211:
LABEL_20:
          Boss_Objects[0].Curly_Target_X = Quote.X_Pos;
          Boss_Objects[0].Curly_Target_Y = Quote.Y_Pos;
          if ( Boss_Objects[0].Is_Being_Hit )
          {
            ++NPCStruct_Tileset;
            if ( ((signed int)NPCStruct_Tileset >> 1) % 2 )
            {
              Boss_Objects[4].Ani_Num = 0;
              Boss_Objects[5].Ani_Num = 0;
            }
            else
            {
              Boss_Objects[4].Ani_Num = 1;
              Boss_Objects[5].Ani_Num = 1;
            }
          }
          else
          {
            Boss_Objects[4].Ani_Num = 0;
            Boss_Objects[5].Ani_Num = 0;
          }
          if ( ++Boss_Objects[0].Wait_Timer % 100 == 1 )
          {
            Super_X_Pos = Random(80, 100);
            Curly_Shoot_Wait = Boss_Objects[11].X_pos;
            Curly_Shoot_X = Boss_Objects[11].Y_pos;
          }
          if ( Boss_Objects[0].Wait_Timer < 200 && Boss_Objects[0].Wait_Timer % 20 == 1 )
          {
            v0 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
            v1 = Random(-48, -16);
            NPC_Create((NPC_Names)179, Boss_Objects[0].X_pos + (v1 << 9), v0, 0, 0, 0, NULL, 256);
          }
          if ( Boss_Objects[0].Wait_Timer > 400 || Boss_Objects[0].Life < Boss_Objects[0].count2 - 200 )
          {
            Boss_Objects[0].Current_State = 200;
            Boss_Objects[4].Ani_Num = 2;
            Boss_Objects[5].Ani_Num = 0;
            v21 = 1;
          }
          break;
        default:
          goto LABEL_71;
      }
      goto LABEL_71;
    }
    Boss_Objects[0].Current_State = 221;
    Boss_Objects[0].Wait_Timer = 0;
    Curly_Shoot_Y = 1;
    Boss_Objects[11].Entity_Flags |= 0x20u;
    Set_Quake(100);
    Set_Noise(1, 1000);
    goto LABEL_36;
  }
  if ( v20 > 501 )
  {
    if ( v20 == 600 )
    {
      Boss_Objects[0].Current_State = 601;
      Boss_Objects[4].Current_State = 50;
      Boss_Objects[5].Current_State = 50;
      Boss_Objects[8].Entity_Flags &= 0xFFFBu;
      Boss_Objects[9].Entity_Flags &= 0xFFFBu;
      Boss_Objects[10].Entity_Flags &= 0xFFFBu;
      Boss_Objects[11].Entity_Flags &= 0xFFFBu;
    }
    else if ( v20 != 601 )
    {
      goto LABEL_71;
    }
    if ( ++Boss_Objects[0].Wait_Timer / 2 % 2 )
      Boss_Objects[0].X_pos -= 2048;
    else
      Boss_Objects[0].X_pos += 2048;
  }
  else
  {
    if ( v20 != 501 )
    {
      if ( v20 == 221 )
      {
LABEL_36:
        ++Boss_Objects[0].Wait_Timer;
        v2 = Quote.Y_Pos + (Random(-160, 160) << 9);
        v3 = Random(-50, 150);
        NPC_Create(Enemy_Basil|0xC0, Quote.X_Pos + (v3 << 10), v2, 0, 0, 0, NULL, 256);
        Quote.X_Vel -= 32;
        Quote.Flags |= 0x20u;
        if ( Boss_Objects[0].Is_Being_Hit )
        {
          ++NPCStruct_Tileset;
          if ( ((signed int)NPCStruct_Tileset >> 1) % 2 )
          {
            Boss_Objects[4].Ani_Num = 0;
            Boss_Objects[5].Ani_Num = 0;
          }
          else
          {
            Boss_Objects[4].Ani_Num = 1;
            Boss_Objects[5].Ani_Num = 1;
          }
        }
        else
        {
          Boss_Objects[4].Ani_Num = 0;
          Boss_Objects[5].Ani_Num = 0;
        }
        if ( Boss_Objects[0].Wait_Timer == 300 || Boss_Objects[0].Wait_Timer == 350 || Boss_Objects[0].Wait_Timer == 400 )
        {
          v4 = GetArcTan(Boss_Objects[0].X_pos - Quote.X_Pos, Boss_Objects[0].Y_pos - Quote.Y_Pos);
          Y_Vel = 3 * GetSin(v4);
          X_Vel = 3 * GetCos(v4);
          NPC_Create((NPC_Names)218, Boss_Objects[0].X_pos - 20480, Boss_Objects[0].Y_pos, X_Vel, Y_Vel, 0, NULL, 256);
          Play_Sound_Effect(Sfx_Lightning, 1);
        }
        if ( Boss_Objects[0].Wait_Timer > 400 )
        {
          Boss_Objects[0].Current_State = 200;
          Boss_Objects[4].Ani_Num = 2;
          Boss_Objects[5].Ani_Num = 0;
          v21 = 1;
        }
        goto LABEL_71;
      }
      if ( v20 != 500 )
        goto LABEL_71;
      Cut_Noise();
      Boss_Objects[0].Current_State = 501;
      Boss_Objects[0].Wait_Timer = 0;
      Boss_Objects[0].X_vel = 0;
      Boss_Objects[0].Y_vel = 0;
      Boss_Objects[4].Ani_Num = 2;
      Boss_Objects[5].Ani_Num = 0;
      Boss_Objects[1].Current_State = 200;
      Boss_Objects[2].Current_State = 200;
      Boss_Objects[3].Current_State = 200;
      Boss_Objects[6].Current_State = 200;
      Boss_Objects[7].Current_State = 200;
      Set_Quake(20);
      for ( i = 0; i < 32; ++i )
      {
        v7 = Random(-128, 128) << 9;
        v8 = Random(-128, 128) << 9;
        v9 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
        v10 = Random(-128, 128);
        NPC_Create(Smoke, Boss_Objects[0].X_pos + (v10 << 9), v9, v8, v7, 0, NULL, 256);
      }
      for ( ia = 0; ia < 12; ++ia )
        Boss_Objects[ia].Entity_Flags &= 0xFFDBu;
    }
    if ( ++Boss_Objects[0].Wait_Timer % 16 )
    {
      v11 = Random(-128, 128) << 9;
      v12 = Random(-128, 128) << 9;
      v13 = Boss_Objects[0].Y_pos + (Random(-32, 32) << 9);
      v14 = Random(-64, 64);
      NPC_Create(Smoke, Boss_Objects[0].X_pos + (v14 << 9), v13, v12, v11, 0, NULL, 256);
    }
    if ( Boss_Objects[0].Wait_Timer / 2 % 2 )
      Boss_Objects[0].X_pos -= 512;
    else
      Boss_Objects[0].X_pos += 512;
    if ( Boss_Objects[0].X_pos >= 516096 )
      Boss_Objects[0].X_pos -= 128;
    else
      Boss_Objects[0].X_pos += 128;
    if ( Boss_Objects[0].Y_pos >= 90112 )
      Boss_Objects[0].Y_pos -= 128;
    else
      Boss_Objects[0].Y_pos += 128;
  }
LABEL_71:
  if ( v21 )
  {
    Set_Quake(20);
    Boss_Objects[1].Current_State = 100;
    Boss_Objects[2].Current_State = 100;
    Boss_Objects[3].Current_State = 100;
    Boss_Objects[6].Current_State = 100;
    Boss_Objects[7].Current_State = 100;
    Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
    for ( ib = 0; ib < 8; ++ib )
    {
      v15 = Random(-256, 256);
      v16 = Random(-512, 512);
      v17 = Boss_Objects[4].Y_pos;
      v18 = Random(-32, 16);
      NPC_Create(Smoke, Boss_Objects[4].X_pos + (v18 << 9), v17, v16, v15, 0, NULL, 256);
    }
  }
  if ( Boss_Objects[0].Current_State >= 200 && Boss_Objects[0].Current_State < 300 )
  {
    switch ( Boss_Objects[0].Wait_Timer )
    {
      case 0x50:
        Boss_Objects[1].Current_State = 120;
        break;
      case 0x6E:
        Boss_Objects[2].Current_State = 120;
        break;
      case 0x8C:
        Boss_Objects[3].Current_State = 120;
        break;
      case 0xAA:
        Boss_Objects[6].Current_State = 120;
        break;
      case 0xC8:
        Boss_Objects[7].Current_State = 120;
        break;
      default:
        break;
    }
    if ( Boss_Objects[0].X_pos < Boss_Objects[0].Curly_Target_X + 81920 )
      Boss_Objects[0].X_vel += 4;
    if ( Boss_Objects[0].X_pos > Boss_Objects[0].Curly_Target_X + 81920 )
      Boss_Objects[0].X_vel -= 4;
    if ( Boss_Objects[0].Y_pos < Boss_Objects[0].Curly_Target_Y )
      Boss_Objects[0].Y_vel += 4;
    if ( Boss_Objects[0].Y_pos > Boss_Objects[0].Curly_Target_Y )
      Boss_Objects[0].Y_vel -= 4;
  }
  if ( Boss_Objects[0].X_vel > 128 )
    Boss_Objects[0].X_vel = 128;
  if ( Boss_Objects[0].X_vel < -128 )
    Boss_Objects[0].X_vel = -128;
  if ( Boss_Objects[0].Y_vel > 128 )
    Boss_Objects[0].Y_vel = 128;
  if ( Boss_Objects[0].Y_vel < -128 )
    Boss_Objects[0].Y_vel = -128;
  Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
  Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
  Core_Sub_NPC_Face((int)&Boss_Objects[4]);
  Core_Sub_NPC_Tail((int)&Boss_Objects[5]);
  Core_Sub_NPC_Mini((int)&Boss_Objects[1]);
  Core_Sub_NPC_Mini((int)&Boss_Objects[2]);
  Core_Sub_NPC_Mini((int)&Boss_Objects[3]);
  Core_Sub_NPC_Mini((int)&Boss_Objects[6]);
  Core_Sub_NPC_Mini((int)&Boss_Objects[7]);
  Core_Sub_NPC_Hit((int)&Boss_Objects[8]);
  Core_Sub_NPC_Hit((int)&Boss_Objects[9]);
  Core_Sub_NPC_Hit((int)&Boss_Objects[10]);
  return Core_Sub_NPC_Hit((int)&Boss_Objects[11]);
}
// 4BBA20: using guessed type int Curly_Shoot_Wait;
// 4BBA24: using guessed type int Curly_Shoot_X;
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (004753D0) --------------------------------------------------------
int Boss_7_Undead_Core()
{
  int v0; // ST10_4@75
  int v1; // ST0C_4@75
  int v2; // ST08_4@75
  int v3; // eax@75
  int v4; // ST10_4@80
  int v5; // ST0C_4@80
  int v6; // ST08_4@80
  int v7; // eax@80
  int v8; // ST14_4@86
  int v9; // eax@86
  int v10; // ST10_4@103
  int v11; // ST0C_4@103
  int v12; // ST08_4@103
  int v13; // eax@103
  int v14; // eax@115
  int v15; // eax@117
  int v17; // [sp+8h] [bp-18h]@1
  signed int v18; // [sp+Ch] [bp-14h]@1
  signed int i; // [sp+14h] [bp-Ch]@73
  signed int ia; // [sp+14h] [bp-Ch]@76
  signed int ib; // [sp+14h] [bp-Ch]@90
  signed int ic; // [sp+14h] [bp-Ch]@101
  int v23; // [sp+18h] [bp-8h]@0
  int Y_Pos; // [sp+1Ch] [bp-4h]@0

  v18 = 0;
  v17 = Boss_Objects[0].Current_State;
  if ( v17 <= 220 )
  {
    if ( v17 != 220 )
    {
      switch ( v17 )
      {
        case 1:
          Boss_Objects[0].Current_State = 10;
          Boss_Objects[0].EXP_Amount = 1;
          Boss_Objects[0].Is_Alive = -128;
          Boss_Objects[0].Entity_Flags = -32756;
          Boss_Objects[0].Life = 700;
          Boss_Objects[0].Sound_Hit = 114;
          Boss_Objects[0].X_pos = 303104;
          Boss_Objects[0].Y_pos = 61440;
          Boss_Objects[0].X_vel = 0;
          Boss_Objects[0].Y_vel = 0;
          Boss_Objects[0].Entity_Eve_Num = 1000;
          Boss_Objects[0].Entity_Flags |= 0x200u;
          Boss_Objects[3].Is_Alive = -128;
          Boss_Objects[3].Current_State = 0;
          Boss_Objects[4].Is_Alive = -128;
          Boss_Objects[4].Current_State = 10;
          Boss_Objects[5].Is_Alive = -128;
          Boss_Objects[5].Current_State = 10;
          Boss_Objects[8].Is_Alive = -128;
          Boss_Objects[8].Entity_Flags = 8;
          Boss_Objects[8].view.front = 0;
          Boss_Objects[8].view.top = 0;
          Boss_Objects[8].Hitbox.back = 20480;
          Boss_Objects[8].Hitbox.top = 0x2000;
          Boss_Objects[8].Hitbox.bottom = 0x2000;
          Boss_Objects[8].count1 = 0;
          qmemcpy(&Boss_Objects[9], &Boss_Objects[8], sizeof(Boss_Objects[9]));
          Boss_Objects[9].Hitbox.back = 18432;
          Boss_Objects[9].Hitbox.top = 12288;
          Boss_Objects[9].Hitbox.bottom = 12288;
          Boss_Objects[9].count1 = 1;
          qmemcpy(&Boss_Objects[10], &Boss_Objects[8], sizeof(Boss_Objects[10]));
          Boss_Objects[10].Hitbox.back = 22528;
          Boss_Objects[10].Hitbox.top = 4096;
          Boss_Objects[10].Hitbox.bottom = 4096;
          Boss_Objects[10].count1 = 2;
          qmemcpy(&Boss_Objects[11], &Boss_Objects[8], sizeof(Boss_Objects[11]));
          Boss_Objects[11].Is_Alive |= 0x10u;
          Boss_Objects[11].Hitbox.back = 10240;
          Boss_Objects[11].Hitbox.top = 10240;
          Boss_Objects[11].Hitbox.bottom = 10240;
          Boss_Objects[11].count1 = 3;
          Boss_Objects[1].Is_Alive = -128;
          Boss_Objects[1].Current_State = 0;
          Boss_Objects[1].Entity_Flags = 40;
          Boss_Objects[1].Life = 1000;
          Boss_Objects[1].Sound_Hit = 54;
          Boss_Objects[1].Hitbox.back = 12288;
          Boss_Objects[1].Hitbox.top = 0x2000;
          Boss_Objects[1].Hitbox.bottom = 0x2000;
          Boss_Objects[1].view.front = 0x4000;
          Boss_Objects[1].view.top = 10240;
          Boss_Objects[1].Parent_NPC = Boss_Objects;
          qmemcpy(&Boss_Objects[2], &Boss_Objects[1], sizeof(Boss_Objects[2]));
          Boss_Objects[2].count2 = 128;
          qmemcpy(&Boss_Objects[6], &Boss_Objects[1], sizeof(Boss_Objects[6]));
          Boss_Objects[6].count1 = 1;
          qmemcpy(&Boss_Objects[7], &Boss_Objects[1], sizeof(Boss_Objects[7]));
          Boss_Objects[7].count1 = 1;
          Boss_Objects[7].count2 = 128;
          NPCStruct_Exp = Boss_Objects[0].Life;
          goto LABEL_94;
        case 15:
          Boss_Objects[0].Current_State = 16;
          v18 = 1;
          Boss_Objects[0].Direction = 0;
          Boss_Objects[3].Current_State = 10;
          Boss_Objects[4].Ani_Num = 0;
          goto LABEL_94;
        case 20:
          Boss_Objects[0].Current_State = 210;
          v18 = 1;
          Boss_Objects[0].Direction = 0;
          Boss_Objects[1].Current_State = 5;
          Boss_Objects[2].Current_State = 5;
          Boss_Objects[6].Current_State = 5;
          Boss_Objects[7].Current_State = 5;
          goto LABEL_94;
        case 200:
          Boss_Objects[0].Current_State = 201;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[3].Current_State = 0;
          Boss_Objects[4].Ani_Num = 2;
          Boss_Objects[5].Ani_Num = 0;
          Boss_Objects[8].Entity_Flags &= 0xFFFBu;
          Boss_Objects[9].Entity_Flags &= 0xFFFBu;
          Boss_Objects[10].Entity_Flags &= 0xFFFBu;
          Boss_Objects[11].Entity_Flags &= 0xFFDFu;
          Curly_Shoot_Y = 0;
          Cut_Noise();
          v18 = 1;
          goto LABEL_18;
        case 201:
LABEL_18:
          ++Boss_Objects[0].Wait_Timer;
          if ( (Boss_Objects[0].Direction == 2 || Boss_Objects[0].Ani_Num > 0 || Boss_Objects[0].Life < 200)
            && Boss_Objects[0].Wait_Timer > 200 )
          {
            ++Boss_Objects[0].count1;
            Play_Sound_Effect(Sfx_Core_Thrust, 1);
            if ( Boss_Objects[0].Life >= 200 )
            {
              if ( Boss_Objects[0].count1 <= 2 )
                Boss_Objects[0].Current_State = 210;
              else
                Boss_Objects[0].Current_State = 220;
            }
            else
            {
              Boss_Objects[0].Current_State = 230;
            }
          }
          goto LABEL_94;
        case 210:
          Boss_Objects[0].Current_State = 211;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[3].Current_State = 10;
          Boss_Objects[8].Entity_Flags |= 4u;
          Boss_Objects[9].Entity_Flags |= 4u;
          Boss_Objects[10].Entity_Flags |= 4u;
          Boss_Objects[11].Entity_Flags |= 0x20u;
          NPCStruct_Exp = Boss_Objects[0].Life;
          v18 = 1;
          goto LABEL_29;
        case 211:
LABEL_29:
          ++NPCStruct_DeathSnd;
          if ( Boss_Objects[0].Is_Being_Hit && ((signed int)NPCStruct_DeathSnd >> 1) % 2 )
          {
            Boss_Objects[4].Ani_Num = 1;
            Boss_Objects[5].Ani_Num = 1;
          }
          else
          {
            Boss_Objects[4].Ani_Num = 0;
            Boss_Objects[5].Ani_Num = 0;
          }
          if ( ++Boss_Objects[0].Wait_Timer % 100 == 1 )
          {
            Super_X_Pos = Random(80, 100);
            Curly_Shoot_Wait = Boss_Objects[11].X_pos;
            Curly_Shoot_X = Boss_Objects[11].Y_pos;
          }
          if ( Boss_Objects[0].Wait_Timer < 300 )
          {
            if ( Boss_Objects[0].Wait_Timer % 120 == 1 )
              NPC_Create(
                (NPC_Names)288,
                Boss_Objects[0].X_pos - 0x4000,
                Boss_Objects[0].Y_pos - 0x2000,
                0,
                0,
                Up,
                NULL,
                32);
            if ( Boss_Objects[0].Wait_Timer % 120 == 61 )
              NPC_Create(
                (NPC_Names)288,
                Boss_Objects[0].X_pos - 0x4000,
                Boss_Objects[0].Y_pos + 0x2000,
                0,
                0,
                Down,
                NULL,
                32);
          }
          if ( Boss_Objects[0].Life < NPCStruct_Exp - 50 || Boss_Objects[0].Wait_Timer > 400 )
            Boss_Objects[0].Current_State = 200;
          break;
        default:
          goto LABEL_94;
      }
      goto LABEL_94;
    }
    Boss_Objects[0].Current_State = 221;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[0].count1 = 0;
    Curly_Shoot_Y = 1;
    Boss_Objects[3].Current_State = 20;
    Boss_Objects[8].Entity_Flags |= 4u;
    Boss_Objects[9].Entity_Flags |= 4u;
    Boss_Objects[10].Entity_Flags |= 4u;
    Boss_Objects[11].Entity_Flags |= 0x20u;
    Set_Quake(100);
    NPCStruct_Exp = Boss_Objects[0].Life;
    v18 = 1;
    goto LABEL_45;
  }
  if ( v17 > 500 )
  {
    if ( v17 != 501 )
    {
      if ( v17 == 1000 )
      {
        Set_Quake(100);
        if ( !(++Boss_Objects[0].Wait_Timer % 8) )
          Play_Sound_Effect(Sfx_Missile_Impact, 1);
        v8 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
        v9 = Random(-72, 72);
        Create_Dust_Clouds(Boss_Objects[0].X_pos + (v9 << 9), v8, 1, 1);
        if ( Boss_Objects[0].Wait_Timer > 100 )
        {
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].Current_State = 1001;
          Start_Flash(Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 1);
          Play_Sound_Effect(Sfx_large_Explosion, 1);
        }
      }
      else if ( v17 == 1001 )
      {
        Set_Quake(40);
        if ( ++Boss_Objects[0].Wait_Timer > 50 )
        {
          for ( ib = 0; ib < 20; ++ib )
            Boss_Objects[ib].Is_Alive = 0;
          Kill_NPC(158, 1);
          Kill_NPC(301, 1);
        }
      }
      goto LABEL_94;
    }
LABEL_79:
    if ( ++Boss_Objects[0].Wait_Timer % 16 )
    {
      v4 = Random(-128, 128) << 9;
      v5 = Random(-128, 128) << 9;
      v6 = Boss_Objects[0].Y_pos + (Random(-32, 32) << 9);
      v7 = Random(-64, 64);
      NPC_Create(Smoke, Boss_Objects[0].X_pos + (v7 << 9), v6, v5, v4, 0, NULL, 256);
    }
    Boss_Objects[0].X_pos += 64;
    Boss_Objects[0].Y_pos += 128;
    if ( Boss_Objects[0].Wait_Timer > 200 )
    {
      Boss_Objects[0].Wait_Timer = 0;
      Boss_Objects[0].Current_State = 1000;
    }
    goto LABEL_94;
  }
  if ( v17 == 500 )
  {
    Cut_Noise();
    Boss_Objects[0].Current_State = 501;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[0].X_vel = 0;
    Boss_Objects[0].Y_vel = 0;
    Boss_Objects[3].Current_State = 0;
    Boss_Objects[4].Ani_Num = 2;
    Boss_Objects[5].Ani_Num = 0;
    Boss_Objects[1].Current_State = 5;
    Boss_Objects[2].Current_State = 5;
    Boss_Objects[6].Current_State = 5;
    Boss_Objects[7].Current_State = 5;
    Set_Quake(20);
    for ( i = 0; i < 100; ++i )
    {
      v0 = Random(-128, 128) << 9;
      v1 = Random(-128, 128) << 9;
      v2 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
      v3 = Random(-128, 128);
      NPC_Create(Smoke, Boss_Objects[0].X_pos + (v3 << 9), v2, v1, v0, 0, NULL, 0);
    }
    Kill_NPC(282, 1);
    Boss_Objects[11].Entity_Flags &= 0xFFDFu;
    for ( ia = 0; ia < 12; ++ia )
      Boss_Objects[ia].Entity_Flags &= 0xFFFBu;
    goto LABEL_79;
  }
  if ( v17 == 221 )
  {
LABEL_45:
    if ( ++Boss_Objects[0].Wait_Timer % 40 == 1 )
    {
      switch ( Random(0, 3) )
      {
        case 0:
          v23 = Boss_Objects[1].X_pos;
          Y_Pos = Boss_Objects[1].Y_pos;
          break;
        case 1:
          v23 = Boss_Objects[2].X_pos;
          Y_Pos = Boss_Objects[2].Y_pos;
          break;
        case 2:
          v23 = Boss_Objects[6].X_pos;
          Y_Pos = Boss_Objects[6].Y_pos;
          break;
        case 3:
          v23 = Boss_Objects[7].X_pos;
          Y_Pos = Boss_Objects[7].Y_pos;
          break;
        default:
          break;
      }
      Play_Sound_Effect(Sfx_Silly_Explosion, 1);
      NPC_Create(Forcefield|0x110, v23 - 0x2000, Y_Pos, 0, 0, 0, NULL, 256);
      NPC_Create(Forcefield|0x110, v23 - 0x2000, Y_Pos, 0, 0, (Directions)1024, NULL, 256);
    }
    ++NPCStruct_DeathSnd;
    if ( Boss_Objects[0].Is_Being_Hit && ((signed int)NPCStruct_DeathSnd >> 1) % 2 )
    {
      Boss_Objects[4].Ani_Num = 1;
      Boss_Objects[5].Ani_Num = 1;
    }
    else
    {
      Boss_Objects[4].Ani_Num = 0;
      Boss_Objects[5].Ani_Num = 0;
    }
    if ( Boss_Objects[0].Life < NPCStruct_Exp - 150 || Boss_Objects[0].Wait_Timer > 400 || Boss_Objects[0].Life < 200 )
      Boss_Objects[0].Current_State = 200;
    goto LABEL_94;
  }
  if ( v17 == 230 )
  {
    Boss_Objects[0].Current_State = 231;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[3].Current_State = 30;
    Boss_Objects[8].Entity_Flags |= 4u;
    Boss_Objects[9].Entity_Flags |= 4u;
    Boss_Objects[10].Entity_Flags |= 4u;
    Boss_Objects[11].Entity_Flags |= 0x20u;
    Play_Sound_Effect(Sfx_Silly_Explosion, 1);
    NPC_Create(Forcefield|0x110, Boss_Objects[3].X_pos - 0x2000, Boss_Objects[3].Y_pos, 0, 0, 0, NULL, 256);
    NPC_Create(
      Forcefield|0x110,
      Boss_Objects[3].X_pos - 0x2000,
      Boss_Objects[3].Y_pos,
      0,
      0,
      (Directions)1024,
      NULL,
      256);
    NPC_Create(Forcefield|0x110, Boss_Objects[3].X_pos, Boss_Objects[3].Y_pos - 0x2000, 0, 0, 0, NULL, 256);
    NPC_Create(
      Forcefield|0x110,
      Boss_Objects[3].X_pos,
      Boss_Objects[3].Y_pos - 0x2000,
      0,
      0,
      (Directions)1024,
      NULL,
      256);
    NPC_Create(Forcefield|0x110, Boss_Objects[3].X_pos, Boss_Objects[3].Y_pos + 0x2000, 0, 0, 0, NULL, 256);
    NPC_Create(
      Forcefield|0x110,
      Boss_Objects[3].X_pos,
      Boss_Objects[3].Y_pos + 0x2000,
      0,
      0,
      (Directions)1024,
      NULL,
      256);
    NPCStruct_Exp = Boss_Objects[0].Life;
    v18 = 1;
  }
  else if ( v17 != 231 )
  {
    goto LABEL_94;
  }
  ++NPCStruct_DeathSnd;
  if ( Boss_Objects[0].Is_Being_Hit && ((signed int)NPCStruct_DeathSnd >> 1) % 2 )
  {
    Boss_Objects[4].Ani_Num = 1;
    Boss_Objects[5].Ani_Num = 1;
  }
  else
  {
    Boss_Objects[4].Ani_Num = 0;
    Boss_Objects[5].Ani_Num = 0;
  }
  if ( ++Boss_Objects[0].Wait_Timer % 100 == 1 )
  {
    Super_X_Pos = Random(80, 100);
    Curly_Shoot_Wait = Boss_Objects[11].X_pos;
    Curly_Shoot_X = Boss_Objects[11].Y_pos;
  }
  if ( Boss_Objects[0].Wait_Timer % 120 == 1 )
    NPC_Create((NPC_Names)288, Boss_Objects[0].X_pos - 0x4000, Boss_Objects[0].Y_pos - 0x2000, 0, 0, Up, NULL, 32);
  if ( Boss_Objects[0].Wait_Timer % 120 == 61 )
    NPC_Create((NPC_Names)288, Boss_Objects[0].X_pos - 0x4000, Boss_Objects[0].Y_pos + 0x2000, 0, 0, Down, NULL, 32);
LABEL_94:
  if ( v18 )
  {
    Set_Quake(20);
    if ( Boss_Objects[0].Current_State == 201 )
    {
      Boss_Objects[7].Current_State = 10;
      Boss_Objects[6].Current_State = 10;
      Boss_Objects[2].Current_State = 10;
      Boss_Objects[1].Current_State = 10;
    }
    if ( Boss_Objects[0].Current_State == 221 )
    {
      Boss_Objects[7].Current_State = 20;
      Boss_Objects[6].Current_State = 20;
      Boss_Objects[2].Current_State = 20;
      Boss_Objects[1].Current_State = 20;
    }
    if ( Boss_Objects[0].Current_State == 231 )
    {
      Boss_Objects[7].Current_State = 30;
      Boss_Objects[6].Current_State = 30;
      Boss_Objects[2].Current_State = 30;
      Boss_Objects[1].Current_State = 30;
    }
    Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
    for ( ic = 0; ic < 8; ++ic )
    {
      v10 = Random(-256, 256);
      v11 = Random(-512, 512);
      v12 = Boss_Objects[4].Y_pos;
      v13 = Random(-32, 16);
      NPC_Create(Smoke, Boss_Objects[4].X_pos + (v13 << 9), v12, v11, v10, 0, NULL, 256);
    }
  }
  if ( Boss_Objects[0].Current_State >= 200 && Boss_Objects[0].Current_State < 300 )
  {
    if ( Boss_Objects[0].X_pos < 98304 )
      Boss_Objects[0].Direction = 2;
    if ( Boss_Objects[0].X_pos > (Current_Map.Width - 4) << 13 )
      Boss_Objects[0].Direction = 0;
    if ( Boss_Objects[0].Direction )
      Boss_Objects[0].X_vel += 4;
    else
      Boss_Objects[0].X_vel -= 4;
  }
  switch ( Boss_Objects[0].Current_State )
  {
    case 0xC9:
    case 0xD3:
    case 0xDD:
    case 0xE7:
      if ( ++Boss_Objects[0].count2 == 150 )
      {
        Boss_Objects[0].count2 = 0;
        v14 = Random(-1, 3);
        NPC_Create((NPC_Names)282, (Current_Map.Width << 13) + 64, (v14 + 10) << 13, 0, 0, 0, NULL, 48);
      }
      else if ( Boss_Objects[0].count2 == 75 )
      {
        v15 = Random(-3, 0);
        NPC_Create((NPC_Names)282, (Current_Map.Width << 13) + 64, (v15 + 3) << 13, 0, 0, 0, NULL, 48);
      }
      break;
    default:
      break;
  }
  if ( Boss_Objects[0].X_vel > 128 )
    Boss_Objects[0].X_vel = 128;
  if ( Boss_Objects[0].X_vel < -128 )
    Boss_Objects[0].X_vel = -128;
  if ( Boss_Objects[0].Y_vel > 128 )
    Boss_Objects[0].Y_vel = 128;
  if ( Boss_Objects[0].Y_vel < -128 )
    Boss_Objects[0].Y_vel = -128;
  Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
  Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
  Undead_Sub_NPC_Face((int)&Boss_Objects[3]);
  Undead_Sub_NPC_Head((int)&Boss_Objects[4]);
  Undead_Sub_NPC_Tail((int)&Boss_Objects[5]);
  Undead_Sub_NPC_Mini((int)&Boss_Objects[1]);
  Undead_Sub_NPC_Mini((int)&Boss_Objects[2]);
  Undead_Sub_NPC_Mini((int)&Boss_Objects[6]);
  Undead_Sub_NPC_Mini((int)&Boss_Objects[7]);
  Undead_Sub_NPC_Hit((int)&Boss_Objects[8]);
  Undead_Sub_NPC_Hit((int)&Boss_Objects[9]);
  Undead_Sub_NPC_Hit((int)&Boss_Objects[10]);
  return Undead_Sub_NPC_Hit((int)&Boss_Objects[11]);
}
// 4BBA20: using guessed type int Curly_Shoot_Wait;
// 4BBA24: using guessed type int Curly_Shoot_X;
// 4BBA28: using guessed type int Curly_Shoot_Y;
// 4BBA2C: using guessed type int Super_X_Pos;

//----- (00476790) --------------------------------------------------------
int __cdecl Undead_Sub_NPC_Head(int a1)
{
  int *v1; // ecx@9
  int v2; // edx@9
  int result; // eax@9
  int v4; // [sp+4h] [bp-40h]@1
  int v5; // [sp+8h] [bp-3Ch]@1
  int v6; // [sp+Ch] [bp-38h]@1
  int v7; // [sp+10h] [bp-34h]@1
  int v8; // [sp+14h] [bp-30h]@1
  int v9; // [sp+18h] [bp-2Ch]@1
  int v10; // [sp+1Ch] [bp-28h]@1
  int v11; // [sp+20h] [bp-24h]@1
  int v12; // [sp+24h] [bp-20h]@1
  int v13; // [sp+28h] [bp-1Ch]@1
  int v14; // [sp+2Ch] [bp-18h]@1
  int v15; // [sp+30h] [bp-14h]@1
  int v16; // [sp+34h] [bp-10h]@1
  int v17; // [sp+38h] [bp-Ch]@1
  int v18; // [sp+3Ch] [bp-8h]@1
  int v19; // [sp+40h] [bp-4h]@1

  v4 = 0;
  v5 = 0;
  v6 = 72;
  v7 = 112;
  v8 = 0;
  v9 = 112;
  v10 = 72;
  v11 = 224;
  v12 = 160;
  v13 = 0;
  v14 = 232;
  v15 = 112;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 2;
      *(_WORD *)(a1 + 80) = 8;
      *(_DWORD *)(a1 + 140) = 18432;
      *(_DWORD *)(a1 + 144) = 28672;
      goto LABEL_3;
    case 0xB:
LABEL_3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 18432;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 112;
      goto LABEL_5;
    case 0x33:
LABEL_5:
      if ( !--*(_DWORD *)(a1 + 120) )
      {
        *(_DWORD *)(a1 + 116) = 100;
        *(_DWORD *)(a1 + 104) = 3;
      }
      break;
    case 0x64:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( *(_DWORD *)(a1 + 116) == 51 )
  {
    result = a1;
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 120) + *(_DWORD *)(a1 + 88);
  }
  return result;
}

//----- (004769A0) --------------------------------------------------------
int __cdecl Undead_Sub_NPC_Tail(int a1)
{
  int *v1; // ecx@9
  int v2; // edx@9
  int result; // eax@9
  int v4; // [sp+4h] [bp-30h]@1
  int v5; // [sp+8h] [bp-2Ch]@1
  int v6; // [sp+Ch] [bp-28h]@1
  int v7; // [sp+10h] [bp-24h]@1
  int v8; // [sp+14h] [bp-20h]@1
  int v9; // [sp+18h] [bp-1Ch]@1
  int v10; // [sp+1Ch] [bp-18h]@1
  int v11; // [sp+20h] [bp-14h]@1
  int v12; // [sp+24h] [bp-10h]@1
  int v13; // [sp+28h] [bp-Ch]@1
  int v14; // [sp+2Ch] [bp-8h]@1
  int v15; // [sp+30h] [bp-4h]@1

  v4 = 72;
  v5 = 0;
  v6 = 160;
  v7 = 112;
  v8 = 72;
  v9 = 112;
  v10 = 160;
  v11 = 224;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 116) = 11;
      *(_DWORD *)(a1 + 104) = 0;
      *(_WORD *)(a1 + 80) = 8;
      *(_DWORD *)(a1 + 140) = 22528;
      *(_DWORD *)(a1 + 144) = 28672;
      goto LABEL_3;
    case 0xB:
LABEL_3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 22528;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 0x32:
      *(_DWORD *)(a1 + 116) = 51;
      *(_DWORD *)(a1 + 120) = 112;
      goto LABEL_5;
    case 0x33:
LABEL_5:
      if ( !--*(_DWORD *)(a1 + 120) )
      {
        *(_DWORD *)(a1 + 116) = 100;
        *(_DWORD *)(a1 + 104) = 2;
      }
      break;
    case 0x64:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    default:
      break;
  }
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  result = v1[2];
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( *(_DWORD *)(a1 + 116) == 51 )
  {
    result = a1;
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a1 + 120) + *(_DWORD *)(a1 + 88);
  }
  return result;
}

//----- (00476B90) --------------------------------------------------------
int __cdecl Undead_Sub_NPC_Face(int a1)
{
  int *v1; // edx@20
  int result; // eax@20
  int v3; // [sp+4h] [bp-50h]@1
  int v4; // [sp+8h] [bp-4Ch]@1
  int v5; // [sp+Ch] [bp-48h]@1
  int v6; // [sp+10h] [bp-44h]@1
  int v7; // [sp+14h] [bp-40h]@1
  int v8; // [sp+18h] [bp-3Ch]@1
  int v9; // [sp+1Ch] [bp-38h]@1
  int v10; // [sp+20h] [bp-34h]@1
  int v11; // [sp+24h] [bp-30h]@1
  int v12; // [sp+28h] [bp-2Ch]@1
  int v13; // [sp+2Ch] [bp-28h]@1
  int v14; // [sp+30h] [bp-24h]@1
  int v15; // [sp+34h] [bp-20h]@1
  int v16; // [sp+38h] [bp-1Ch]@1
  int v17; // [sp+3Ch] [bp-18h]@1
  int v18; // [sp+40h] [bp-14h]@1
  int v19; // [sp+44h] [bp-10h]@1
  int v20; // [sp+48h] [bp-Ch]@1
  int v21; // [sp+4Ch] [bp-8h]@1
  int v22; // [sp+50h] [bp-4h]@1

  v3 = 0;
  v4 = 0;
  v5 = 0;
  v6 = 0;
  v7 = 160;
  v8 = 112;
  v9 = 232;
  v10 = 152;
  v11 = 160;
  v12 = 152;
  v13 = 232;
  v14 = 192;
  v15 = 160;
  v16 = 192;
  v17 = 232;
  v18 = 232;
  v19 = 248;
  v20 = 160;
  v21 = 320;
  v22 = 200;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0:
      *(_DWORD *)(a1 + 104) = 0;
      break;
    case 0xA:
      *(_DWORD *)(a1 + 104) = 1;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 104) = 2;
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 116) = 31;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 120) = 100;
      goto LABEL_6;
    case 0x1F:
LABEL_6:
      if ( ++*(_DWORD *)(a1 + 120) > 300 )
        *(_DWORD *)(a1 + 120) = 0;
      if ( *(_DWORD *)(a1 + 120) > 250 && *(_DWORD *)(a1 + 120) % 16 == 1 )
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      if ( *(_DWORD *)(a1 + 120) > 250 && *(_DWORD *)(a1 + 120) % 16 == 7 )
      {
        NPC_Create((NPC_Names)293, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), 0, 0, 0, NULL, 128);
        Play_Sound_Effect(Sfx_Lightning, 1);
      }
      if ( *(_DWORD *)(a1 + 120) == 200 )
        Play_Sound_Effect(Sfx_Core_Charge, 1);
      if ( *(_DWORD *)(a1 + 120) > 200 && *(_DWORD *)(a1 + 120) % 2 )
        *(_DWORD *)(a1 + 104) = 4;
      else
        *(_DWORD *)(a1 + 104) = 3;
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 148) = 18432;
  *(_DWORD *)(a1 + 140) = 18432;
  *(_DWORD *)(a1 + 144) = 10240;
  *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 18432;
  *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 2048;
  *(_WORD *)(a1 + 80) = 8;
  v1 = &v3 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_DWORD *)result = *v1;
  *(_DWORD *)(result + 4) = v1[1];
  *(_DWORD *)(result + 8) = v1[2];
  *(_DWORD *)(result + 12) = v1[3];
  return result;
}

//----- (00476E50) --------------------------------------------------------
int __cdecl Undead_Sub_NPC_Mini(int a1)
{
  int result; // eax@1
  int v2; // esi@15
  int v3; // esi@15
  int *v4; // ecx@16
  int v5; // edx@16
  int v6; // [sp+4h] [bp-34h]@1
  int v7; // [sp+8h] [bp-30h]@1
  int v8; // [sp+Ch] [bp-2Ch]@1
  int v9; // [sp+10h] [bp-28h]@1
  int v10; // [sp+14h] [bp-24h]@1
  int v11; // [sp+18h] [bp-20h]@1
  int v12; // [sp+1Ch] [bp-1Ch]@1
  int v13; // [sp+20h] [bp-18h]@1
  int v14; // [sp+24h] [bp-14h]@1
  int v15; // [sp+28h] [bp-10h]@1
  int v16; // [sp+2Ch] [bp-Ch]@1
  int v17; // [sp+30h] [bp-8h]@1
  int v18; // [sp+34h] [bp-4h]@13

  v6 = 256;
  v7 = 0;
  v8 = 320;
  v9 = 40;
  v10 = 256;
  v11 = 40;
  v12 = 320;
  v13 = 80;
  v14 = 256;
  v15 = 80;
  v16 = 320;
  v17 = 120;
  result = a1;
  if ( *(_BYTE *)a1 )
  {
    *(_DWORD *)(a1 + 64) = 1000;
    switch ( *(_DWORD *)(a1 + 116) )
    {
      case 0:
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        break;
      case 5:
        *(_DWORD *)(a1 + 104) = 0;
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        ++*(_DWORD *)(a1 + 112);
        *(_DWORD *)(a1 + 112) %= 256;
        break;
      case 0xA:
        *(_DWORD *)(a1 + 104) = 0;
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        *(_DWORD *)(a1 + 112) += 2;
        *(_DWORD *)(a1 + 112) %= 256;
        break;
      case 0x14:
        *(_DWORD *)(a1 + 104) = 1;
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        *(_DWORD *)(a1 + 112) += 2;
        *(_DWORD *)(a1 + 112) %= 256;
        break;
      case 0x1E:
        *(_DWORD *)(a1 + 104) = 0;
        *(_WORD *)(a1 + 80) &= 0xFFDFu;
        *(_DWORD *)(a1 + 112) += 4;
        *(_DWORD *)(a1 + 112) %= 256;
        break;
      case 0xC8:
        *(_DWORD *)(a1 + 116) = 201;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 16) = 0;
        *(_DWORD *)(a1 + 20) = 0;
        goto LABEL_9;
      case 0xC9:
LABEL_9:
        *(_DWORD *)(a1 + 16) += 32;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        if ( *(_DWORD *)(a1 + 8) > (Current_Map.Width << 13) + 0x4000 )
          *(_BYTE *)a1 = 0;
        break;
      default:
        break;
    }
    if ( *(_DWORD *)(a1 + 116) < 50 )
    {
      if ( *(_DWORD *)(a1 + 108) )
        v18 = *(_DWORD *)(a1 + 112) + 128;
      else
        v18 = *(_DWORD *)(a1 + 112) + 384;
      v2 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8);
      *(_DWORD *)(a1 + 8) = v2 + 48 * GetCos(v18 / 2) - 4096;
      v3 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(v3 + 12) + 80 * GetSin(v18 / 2);
    }
    v4 = &v6 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  return result;
}

//----- (00477230) --------------------------------------------------------
int __cdecl Undead_Sub_NPC_Hit(int a1)
{
  int result; // eax@1

  result = a1;
  switch ( *(_DWORD *)(a1 + 108) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos;
      result = a1;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos - 0x4000;
      break;
    case 1:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 14336;
      result = a1;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
      break;
    case 2:
      result = a1;
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 2048;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 0x4000;
      break;
    case 3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 14336;
      result = a1;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 2048;
      break;
    default:
      return result;
  }
  return result;
}

//----- (004772F0) --------------------------------------------------------
int Boss_9_Ballos_Ball()
{
  int v0; // eax@34
  int v1; // eax@63
  int v2; // eax@71
  int X_Pos; // ST34_4@119
  int v4; // eax@119
  int v5; // ST14_4@147
  int v6; // eax@147
  int v7; // ST34_4@158
  int Y_Pos; // ST38_4@158
  int v9; // ST34_4@162
  int v10; // ST38_4@162
  int v11; // ST34_4@171
  int v12; // eax@171
  int v13; // ST34_4@174
  int v14; // eax@174
  int v16; // [sp+0h] [bp-14h]@1
  int i; // [sp+8h] [bp-Ch]@32
  int ia; // [sp+8h] [bp-Ch]@61
  int ib; // [sp+8h] [bp-Ch]@69
  int ic; // [sp+8h] [bp-Ch]@75
  int id; // [sp+8h] [bp-Ch]@102
  int ie; // [sp+8h] [bp-Ch]@117
  int if; // [sp+8h] [bp-Ch]@156
  int ig; // [sp+8h] [bp-Ch]@160
  int ih; // [sp+8h] [bp-Ch]@166

  v16 = Boss_Objects[0].Current_State;
  if ( v16 <= 314 )
  {
    if ( v16 == 314 )
    {
      Boss_Objects[0].Direction = 3;
      Boss_Objects[0].Y_vel = 938;
      Boss_Objects[0].X_vel = 0;
      Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
      if ( Boss_Objects[0].Y_pos > 115200 )
      {
        Boss_Objects[0].Y_pos = 115200;
        Boss_Objects[0].Current_State = 311;
      }
    }
    else if ( v16 > 204 )
    {
      switch ( v16 )
      {
        case 220:
          Boss_Objects[0].Current_State = 221;
          Boss_Objects[0].Life = 1200;
          Boss_Objects[1].Current_State = 200;
          Boss_Objects[2].Current_State = 200;
          Boss_Objects[0].X_vel = 0;
          Boss_Objects[0].Ani_Num = 0;
          Boss_Objects[0].Is_Being_Hit = 0;
          NPCStruct_Damage = 0;
          goto LABEL_66;
        case 221:
LABEL_66:
          Boss_Objects[0].Y_vel += 64;
          if ( Boss_Objects[0].Y_vel > 3072 )
            Boss_Objects[0].Y_vel = 3072;
          Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
          if ( Boss_Objects[0].Y_pos > 155648 - Boss_Objects[0].Hitbox.bottom )
          {
            Boss_Objects[0].Y_pos = 155648 - Boss_Objects[0].Hitbox.bottom;
            Boss_Objects[0].Y_vel = 0;
            Boss_Objects[0].Current_State = 222;
            Boss_Objects[0].Wait_Timer = 0;
            Set_Hard_Quake_Duration(30);
            Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
            for ( ib = 0; ib < 16; ++ib )
            {
              v2 = Random(-40, 40);
              NPC_Create(Smoke, Boss_Objects[0].X_pos + (v2 << 9), Boss_Objects[0].Y_pos + 20480, 0, 0, 0, NULL, 256);
            }
            if ( Quote.Collision_Flags & 8 )
              Quote.Y_Vel = -512;
          }
          goto LABEL_152;
        case 300:
          Boss_Objects[0].Current_State = 301;
          Boss_Objects[0].Wait_Timer = 0;
          for ( ic = 0; ic < 256; ic += 64 )
          {
            NPC_Create(
              (NPC_Names)342,
              Boss_Objects[0].X_pos,
              Boss_Objects[0].Y_pos,
              0,
              0,
              (Directions)ic,
              Boss_Objects,
              90);
            NPC_Create(
              (NPC_Names)342,
              Boss_Objects[0].X_pos,
              Boss_Objects[0].Y_pos,
              0,
              0,
              (Directions)(ic + 544),
              Boss_Objects,
              90);
          }
          NPC_Create((NPC_Names)343, Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 0, 0, 0, Boss_Objects, 24);
          NPC_Create(
            (NPC_Names)344,
            Boss_Objects[0].X_pos - 12288,
            Boss_Objects[0].Y_pos - 18432,
            0,
            0,
            0,
            Boss_Objects,
            32);
          NPC_Create(
            (NPC_Names)344,
            Boss_Objects[0].X_pos + 12288,
            Boss_Objects[0].Y_pos - 18432,
            0,
            0,
            Right,
            Boss_Objects,
            32);
          goto LABEL_79;
        case 301:
LABEL_79:
          Boss_Objects[0].Y_pos += (115200 - Boss_Objects[0].Y_pos) / 8;
          if ( ++Boss_Objects[0].Wait_Timer > 50 )
          {
            Boss_Objects[0].Current_State = 310;
            Boss_Objects[0].Wait_Timer = 0;
          }
          break;
        case 311:
          Boss_Objects[0].Direction = 0;
          Boss_Objects[0].X_vel = -938;
          Boss_Objects[0].Y_vel = 0;
          Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
          if ( Boss_Objects[0].X_pos < 56832 )
          {
            Boss_Objects[0].X_pos = 56832;
            Boss_Objects[0].Current_State = 312;
          }
          break;
        case 312:
          Boss_Objects[0].Direction = 1;
          Boss_Objects[0].Y_vel = -938;
          Boss_Objects[0].X_vel = 0;
          Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
          if ( Boss_Objects[0].Y_pos < 56832 )
          {
            Boss_Objects[0].Y_pos = 56832;
            Boss_Objects[0].Current_State = 313;
          }
          break;
        case 313:
          Boss_Objects[0].Direction = 2;
          Boss_Objects[0].X_vel = 938;
          Boss_Objects[0].Y_vel = 0;
          Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
          if ( Boss_Objects[0].X_pos > 262656 )
          {
            Boss_Objects[0].X_pos = 262656;
            Boss_Objects[0].Current_State = 314;
          }
          if ( Boss_Objects[0].count1 )
            --Boss_Objects[0].count1;
          if ( !Boss_Objects[0].count1 && Boss_Objects[0].X_pos > 155648 && Boss_Objects[0].X_pos < 172032 )
            Boss_Objects[0].Current_State = 400;
          break;
        default:
          goto LABEL_152;
      }
    }
    else if ( v16 == 204 )
    {
      if ( Boss_Objects[0].X_pos < 40960 )
        Boss_Objects[0].X_vel = 512;
      if ( Boss_Objects[0].X_pos > 278528 )
        Boss_Objects[0].X_vel = -512;
      Boss_Objects[0].Y_vel += 85;
      if ( Boss_Objects[0].Y_vel > 3072 )
        Boss_Objects[0].Y_vel = 3072;
      Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
      Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
      if ( Boss_Objects[0].Y_pos > 155648 - Boss_Objects[0].Hitbox.bottom )
      {
        Boss_Objects[0].Y_pos = 155648 - Boss_Objects[0].Hitbox.bottom;
        Boss_Objects[0].Y_vel = 0;
        Boss_Objects[0].Current_State = 201;
        Boss_Objects[0].Wait_Timer = 0;
        if ( Quote.Y_Pos > Boss_Objects[0].Y_pos + 28672 )
          Damage_Player(16);
        if ( Quote.Collision_Flags & 8 )
          Quote.Y_Vel = -512;
        Set_Hard_Quake_Duration(30);
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        NPC_Create((NPC_Names)332, Boss_Objects[0].X_pos - 6144, Boss_Objects[0].Y_pos + 26624, 0, 0, 0, NULL, 256);
        NPC_Create((NPC_Names)332, Boss_Objects[0].X_pos + 6144, Boss_Objects[0].Y_pos + 26624, 0, 0, Right, NULL, 256);
        Play_Sound_Effect(Sfx_Missile_Impact, 1);
        for ( ia = 0; ia < 16; ++ia )
        {
          v1 = Random(-40, 40);
          NPC_Create(Smoke, Boss_Objects[0].X_pos + (v1 << 9), Boss_Objects[0].Y_pos + 20480, 0, 0, 0, NULL, 256);
        }
      }
    }
    else
    {
      switch ( v16 )
      {
        case 0:
          Boss_Objects[0].Current_State = 1;
          Boss_Objects[0].Is_Alive = -128;
          Boss_Objects[0].EXP_Amount = 1;
          Boss_Objects[0].Direction = 0;
          Boss_Objects[0].X_pos = 163840;
          Boss_Objects[0].Y_pos = -32768;
          Boss_Objects[0].Sound_Hit = 54;
          Boss_Objects[0].Hitbox.front = 0x4000;
          Boss_Objects[0].Hitbox.top = 24576;
          Boss_Objects[0].Hitbox.back = 0x4000;
          Boss_Objects[0].Hitbox.bottom = 24576;
          Boss_Objects[0].Entity_Flags = -32184;
          Boss_Objects[0].Explosion_Size = 3;
          Boss_Objects[0].Damage = 0;
          Boss_Objects[0].Entity_Eve_Num = 1000;
          Boss_Objects[0].Life = 800;
          Boss_Objects[1].Is_Alive = -112;
          Boss_Objects[1].Direction = 0;
          Boss_Objects[1].Entity_Flags = 8;
          Boss_Objects[1].Life = 10000;
          Boss_Objects[1].view.front = 6144;
          Boss_Objects[1].view.top = 0;
          Boss_Objects[1].view.back = 6144;
          Boss_Objects[1].view.bottom = 0x2000;
          Boss_Objects[1].Hitbox.front = 6144;
          Boss_Objects[1].Hitbox.top = 0;
          Boss_Objects[1].Hitbox.back = 6144;
          Boss_Objects[1].Hitbox.bottom = 0x2000;
          qmemcpy(&Boss_Objects[2], &Boss_Objects[1], sizeof(Boss_Objects[2]));
          Boss_Objects[2].Direction = 2;
          Boss_Objects[3].Is_Alive = -112;
          Boss_Objects[3].Entity_Flags = 13;
          Boss_Objects[3].view.front = 30720;
          Boss_Objects[3].view.top = 30720;
          Boss_Objects[3].view.back = 30720;
          Boss_Objects[3].view.bottom = 30720;
          Boss_Objects[3].Hitbox.front = 24576;
          Boss_Objects[3].Hitbox.top = 12288;
          Boss_Objects[3].Hitbox.back = 24576;
          Boss_Objects[3].Hitbox.bottom = 0x4000;
          Boss_Objects[4].Is_Alive = -112;
          Boss_Objects[4].Entity_Flags = 13;
          Boss_Objects[4].Hitbox.front = 0x4000;
          Boss_Objects[4].Hitbox.top = 4096;
          Boss_Objects[4].Hitbox.back = 0x4000;
          Boss_Objects[4].Hitbox.bottom = 4096;
          Boss_Objects[5].Is_Alive = -112;
          Boss_Objects[5].Entity_Flags = 76;
          Boss_Objects[5].Hitbox.front = 0x4000;
          Boss_Objects[5].Hitbox.top = 0;
          Boss_Objects[5].Hitbox.back = 0x4000;
          Boss_Objects[5].Hitbox.bottom = 24576;
          goto LABEL_152;
        case 100:
          Boss_Objects[0].Current_State = 101;
          Boss_Objects[0].Ani_Num = 0;
          Boss_Objects[0].X_pos = Quote.X_Pos;
          NPC_Create(Forcefield|0x140, Quote.X_Pos, 155648, 0, 0, Right, NULL, 256);
          Boss_Objects[0].Wait_Timer = 0;
          goto LABEL_22;
        case 101:
LABEL_22:
          if ( ++Boss_Objects[0].Wait_Timer > 30 )
            Boss_Objects[0].Current_State = 102;
          goto LABEL_152;
        case 102:
          Boss_Objects[0].Y_vel += 64;
          if ( Boss_Objects[0].Y_vel > 3072 )
            Boss_Objects[0].Y_vel = 3072;
          Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
          if ( Boss_Objects[0].Y_pos > 155648 - Boss_Objects[0].Hitbox.bottom )
          {
            Boss_Objects[0].Y_pos = 155648 - Boss_Objects[0].Hitbox.bottom;
            Boss_Objects[0].Y_vel = 0;
            Boss_Objects[0].Current_State = 103;
            Boss_Objects[0].Wait_Timer = 0;
            Set_Hard_Quake_Duration(30);
            Play_Sound_Effect(Sfx_Missile_Impact, 1);
            if ( Quote.Y_Pos > Boss_Objects[0].Y_pos + 24576
              && Quote.X_Pos < Boss_Objects[0].X_pos + 12288
              && Quote.X_Pos > Boss_Objects[0].X_pos - 12288 )
            {
              Damage_Player(16);
            }
            for ( i = 0; i < 16; ++i )
            {
              v0 = Random(-40, 40);
              NPC_Create(Smoke, Boss_Objects[0].X_pos + (v0 << 9), Boss_Objects[0].Y_pos + 20480, 0, 0, 0, NULL, 256);
            }
            if ( Quote.Collision_Flags & 8 )
              Quote.Y_Vel = -512;
          }
          goto LABEL_152;
        case 103:
          if ( ++Boss_Objects[0].Wait_Timer == 50 )
          {
            Boss_Objects[0].Current_State = 104;
            Boss_Objects[1].Current_State = 100;
            Boss_Objects[2].Current_State = 100;
          }
          goto LABEL_152;
        case 200:
          Boss_Objects[0].Current_State = 201;
          Boss_Objects[0].count1 = 0;
          goto LABEL_42;
        case 201:
LABEL_42:
          Boss_Objects[0].Current_State = 203;
          Boss_Objects[0].X_vel = 0;
          ++Boss_Objects[0].count1;
          Boss_Objects[0].Hitbox.bottom = 24576;
          Boss_Objects[0].Damage = 0;
          if ( Boss_Objects[0].count1 % 3 )
            Boss_Objects[0].Wait_Timer = 50;
          else
            Boss_Objects[0].Wait_Timer = 150;
          goto LABEL_45;
        case 203:
LABEL_45:
          if ( --Boss_Objects[0].Wait_Timer <= 0 )
          {
            Boss_Objects[0].Current_State = 204;
            Boss_Objects[0].Y_vel = -3072;
            if ( Boss_Objects[0].X_pos >= Quote.X_Pos )
              Boss_Objects[0].X_vel = -512;
            else
              Boss_Objects[0].X_vel = 512;
          }
          break;
        default:
          goto LABEL_152;
      }
    }
    goto LABEL_152;
  }
  if ( v16 <= 424 )
  {
    if ( v16 == 424 )
    {
      if ( ++Boss_Objects[0].ani_wait > 200 )
      {
        Boss_Objects[0].ani_wait = 0;
        Boss_Objects[0].Current_State = 425;
      }
    }
    else
    {
      switch ( v16 )
      {
        case 400:
          Boss_Objects[0].Current_State = 401;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].X_vel = 0;
          Boss_Objects[0].Y_vel = 0;
          Kill_NPC(339, 0);
          goto LABEL_101;
        case 401:
LABEL_101:
          Boss_Objects[0].Y_pos += (81408 - Boss_Objects[0].Y_pos) / 8;
          if ( ++Boss_Objects[0].Wait_Timer > 50 )
          {
            Boss_Objects[0].Wait_Timer = 0;
            Boss_Objects[0].Current_State = 410;
            for ( id = 0; id < 256; id += 32 )
              NPC_Create(
                (NPC_Names)346,
                Boss_Objects[0].X_pos,
                Boss_Objects[0].Y_pos,
                0,
                0,
                (Directions)id,
                Boss_Objects,
                80);
            NPC_Create((NPC_Names)343, Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 0, 0, 0, Boss_Objects, 24);
            NPC_Create(
              (NPC_Names)344,
              Boss_Objects[0].X_pos - 12288,
              Boss_Objects[0].Y_pos - 18432,
              0,
              0,
              0,
              Boss_Objects,
              32);
            NPC_Create(
              (NPC_Names)344,
              Boss_Objects[0].X_pos + 12288,
              Boss_Objects[0].Y_pos - 18432,
              0,
              0,
              Right,
              Boss_Objects,
              32);
          }
          goto LABEL_152;
        case 410:
          if ( ++Boss_Objects[0].Wait_Timer > 50 )
          {
            Boss_Objects[0].Wait_Timer = 0;
            Boss_Objects[0].Current_State = 411;
          }
          goto LABEL_152;
        case 411:
          if ( ++Boss_Objects[0].Wait_Timer % 30 == 1 )
            NPC_Create((NPC_Names)348, (2 * (Boss_Objects[0].Wait_Timer / 30) + 2) << 13, 172032, 0, 0, 0, NULL, 384);
          if ( Boss_Objects[0].Wait_Timer / 3 % 2 )
            Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
          if ( Boss_Objects[0].Wait_Timer > 540 )
            Boss_Objects[0].Current_State = 420;
          goto LABEL_152;
        case 420:
          Boss_Objects[0].Current_State = 421;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].ani_wait = 0;
          Set_Hard_Quake_Duration(30);
          Play_Sound_Effect(Sfx_large_Explosion, 1);
          Boss_Objects[1].Current_State = 102;
          Boss_Objects[2].Current_State = 102;
          for ( ie = 0; ie < 256; ++ie )
          {
            X_Pos = Boss_Objects[0].X_pos + (Random(-60, 60) << 9);
            v4 = Random(-60, 60);
            NPC_Create(Smoke, X_Pos, Boss_Objects[0].Y_pos + (v4 << 9), 0, 0, 0, NULL, 0);
          }
          goto LABEL_120;
        case 421:
LABEL_120:
          if ( ++Boss_Objects[0].ani_wait > 500 )
          {
            Boss_Objects[0].ani_wait = 0;
            Boss_Objects[0].Current_State = 422;
          }
          break;
        case 422:
          if ( ++Boss_Objects[0].ani_wait > 200 )
          {
            Boss_Objects[0].ani_wait = 0;
            Boss_Objects[0].Current_State = 423;
          }
          break;
        case 423:
          if ( ++Boss_Objects[0].ani_wait > 20 )
          {
            Boss_Objects[0].ani_wait = 0;
            Boss_Objects[0].Current_State = 424;
          }
          break;
        default:
          goto LABEL_152;
      }
    }
    goto LABEL_152;
  }
  if ( v16 <= 428 )
  {
    switch ( v16 )
    {
      case 428:
        if ( ++Boss_Objects[0].ani_wait > 200 )
        {
          Boss_Objects[0].ani_wait = 0;
          Boss_Objects[0].Current_State = 421;
        }
        break;
      case 425:
        if ( ++Boss_Objects[0].ani_wait > 500 )
        {
          Boss_Objects[0].ani_wait = 0;
          Boss_Objects[0].Current_State = 426;
        }
        break;
      case 426:
        if ( ++Boss_Objects[0].ani_wait > 200 )
        {
          Boss_Objects[0].ani_wait = 0;
          Boss_Objects[0].Current_State = 427;
        }
        break;
      default:
        if ( v16 == 427 && ++Boss_Objects[0].ani_wait > 20 )
        {
          Boss_Objects[0].ani_wait = 0;
          Boss_Objects[0].Current_State = 428;
        }
        break;
    }
    goto LABEL_152;
  }
  if ( v16 == 1000 )
  {
    Boss_Objects[0].Current_State = 1001;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[1].Current_State = 300;
    Boss_Objects[2].Current_State = 300;
    Boss_Objects[0].Entity_Flags &= 0xFFBEu;
    Boss_Objects[3].Entity_Flags &= 0xFFBEu;
    Boss_Objects[4].Entity_Flags &= 0xFFBEu;
    Boss_Objects[5].Entity_Flags &= 0xFFBEu;
  }
  else if ( v16 != 1001 )
  {
    if ( v16 == 1002 )
    {
      Set_Hard_Quake_Duration(40);
      if ( ++Boss_Objects[0].Wait_Timer == 50 )
      {
        Boss_Objects[0].Is_Alive = 0;
        Boss_Objects[1].Is_Alive = 0;
        Boss_Objects[2].Is_Alive = 0;
        Boss_Objects[3].Is_Alive = 0;
        Boss_Objects[4].Is_Alive = 0;
        Boss_Objects[5].Is_Alive = 0;
        Kill_NPC(350, 1);
        Kill_NPC(348, 1);
      }
    }
    goto LABEL_152;
  }
  if ( !(++Boss_Objects[0].Wait_Timer % 12) )
    Play_Sound_Effect(Sfx_Missile_Impact, 1);
  v5 = Boss_Objects[0].Y_pos + (Random(-60, 60) << 9);
  v6 = Random(-60, 60);
  Create_Dust_Clouds(Boss_Objects[0].X_pos + (v6 << 9), v5, 1, 1);
  if ( Boss_Objects[0].Wait_Timer > 150 )
  {
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[0].Current_State = 1002;
    Start_Flash(Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 1);
    Play_Sound_Effect(Sfx_large_Explosion, 1);
  }
LABEL_152:
  if ( Boss_Objects[0].Current_State > 420 && Boss_Objects[0].Current_State < 500 )
  {
    Boss_Objects[3].Entity_Flags |= 0x20u;
    Boss_Objects[4].Entity_Flags |= 0x20u;
    Boss_Objects[5].Entity_Flags |= 0x20u;
    if ( ++Boss_Objects[0].Wait_Timer > 300 )
    {
      Boss_Objects[0].Wait_Timer = 0;
      if ( Quote.X_Pos <= Boss_Objects[0].X_pos )
      {
        for ( ig = 0; ig < 8; ++ig )
        {
          v9 = (Random(-4, 4) << 13) / 4;
          v10 = (Random(8, 68) << 13) / 4;
          NPC_Create((NPC_Names)350, v9, v10, 0, 0, Right, NULL, 256);
        }
      }
      else
      {
        for ( if = 0; if < 8; ++if )
        {
          v7 = ((Random(-4, 4) + 156) << 13) / 4;
          Y_Pos = (Random(8, 68) << 13) / 4;
          NPC_Create((NPC_Names)350, v7, Y_Pos, 0, 0, 0, NULL, 256);
        }
      }
    }
    if ( Boss_Objects[0].Wait_Timer == 270 || Boss_Objects[0].Wait_Timer == 280 || Boss_Objects[0].Wait_Timer == 290 )
    {
      NPC_Create((NPC_Names)353, Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos - 26624, 0, 0, Up, NULL, 256);
      Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      for ( ih = 0; ih < 4; ++ih )
        NPC_Create(Smoke, Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos - 26624, 0, 0, 0, NULL, 256);
    }
    if ( Boss_Objects[0].Life <= 500 )
    {
      if ( Random(0, 4) == 2 )
      {
        v13 = Boss_Objects[0].X_pos + (Random(-40, 40) << 9);
        v14 = Random(0, 40);
        NPC_Create(Santas_Key|0x100, v13, Boss_Objects[0].Y_pos + (v14 << 9), 0, 0, Down, NULL, 0);
      }
    }
    else if ( Random(0, 10) == 2 )
    {
      v11 = Boss_Objects[0].X_pos + (Random(-40, 40) << 9);
      v12 = Random(0, 40);
      NPC_Create(Santas_Key|0x100, v11, Boss_Objects[0].Y_pos + (v12 << 9), 0, 0, Down, NULL, 0);
    }
  }
  if ( Boss_Objects[0].Is_Being_Hit )
  {
    ++NPCStruct_Damage;
    Boss_Objects[3].Ani_Num = ((signed int)NPCStruct_Damage >> 1) % 2 != 0;
  }
  else
  {
    Boss_Objects[3].Ani_Num = 0;
  }
  if ( Boss_Objects[0].Current_State > 420 )
    Boss_Objects[3].Ani_Num += 2;
  Ballos_Sub_NPC_Eye((int)&Boss_Objects[1]);
  Ballos_Sub_NPC_Eye((int)&Boss_Objects[2]);
  Ballos_Sub_NPC_Body((int)&Boss_Objects[3]);
  Ballos_Sub_NPC_HITAI((int)&Boss_Objects[4]);
  return Ballos_Sub_NPC_HARA((int)&Boss_Objects[5]);
}

//----- (00478AA0) --------------------------------------------------------
int __cdecl Ballos_Sub_NPC_Eye(int a1)
{
  int *v1; // edx@27
  int result; // eax@27
  int *v3; // edx@28
  int v4; // [sp+4h] [bp-A0h]@1
  int v5; // [sp+8h] [bp-9Ch]@1
  int v6; // [sp+Ch] [bp-98h]@1
  int v7; // [sp+10h] [bp-94h]@1
  int v8; // [sp+14h] [bp-90h]@1
  int v9; // [sp+18h] [bp-8Ch]@1
  int v10; // [sp+1Ch] [bp-88h]@1
  int v11; // [sp+20h] [bp-84h]@1
  int v12; // [sp+24h] [bp-80h]@1
  int v13; // [sp+28h] [bp-7Ch]@1
  int v14; // [sp+2Ch] [bp-78h]@1
  int v15; // [sp+30h] [bp-74h]@1
  int v16; // [sp+34h] [bp-70h]@1
  int v17; // [sp+38h] [bp-6Ch]@1
  int v18; // [sp+3Ch] [bp-68h]@1
  int v19; // [sp+40h] [bp-64h]@1
  int v20; // [sp+44h] [bp-60h]@1
  int v21; // [sp+48h] [bp-5Ch]@1
  int v22; // [sp+4Ch] [bp-58h]@1
  int v23; // [sp+50h] [bp-54h]@1
  int v24; // [sp+54h] [bp-50h]@1
  int v25; // [sp+58h] [bp-4Ch]@1
  int v26; // [sp+5Ch] [bp-48h]@1
  int v27; // [sp+60h] [bp-44h]@1
  int v28; // [sp+64h] [bp-40h]@1
  int v29; // [sp+68h] [bp-3Ch]@1
  int v30; // [sp+6Ch] [bp-38h]@1
  int v31; // [sp+70h] [bp-34h]@1
  int v32; // [sp+74h] [bp-30h]@1
  int v33; // [sp+78h] [bp-2Ch]@1
  int v34; // [sp+7Ch] [bp-28h]@1
  int v35; // [sp+80h] [bp-24h]@1
  int v36; // [sp+84h] [bp-20h]@1
  int v37; // [sp+88h] [bp-1Ch]@1
  int v38; // [sp+8Ch] [bp-18h]@1
  int v39; // [sp+90h] [bp-14h]@1
  int v40; // [sp+94h] [bp-10h]@1
  int v41; // [sp+98h] [bp-Ch]@1
  int v42; // [sp+9Ch] [bp-8h]@1
  int v43; // [sp+A0h] [bp-4h]@1

  v24 = 272;
  v25 = 0;
  v26 = 296;
  v27 = 16;
  v28 = 272;
  v29 = 16;
  v30 = 296;
  v31 = 32;
  v32 = 272;
  v33 = 32;
  v34 = 296;
  v35 = 48;
  v36 = 0;
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v40 = 240;
  v41 = 16;
  v42 = 264;
  v43 = 32;
  v4 = 296;
  v5 = 0;
  v6 = 320;
  v7 = 16;
  v8 = 296;
  v9 = 16;
  v10 = 320;
  v11 = 32;
  v12 = 296;
  v13 = 32;
  v14 = 320;
  v15 = 48;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 240;
  v21 = 32;
  v22 = 264;
  v23 = 48;
  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0x64:
      *(_DWORD *)(a1 + 116) = 101;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_3;
    case 0x65:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        ++*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) > 2 )
        *(_DWORD *)(a1 + 116) = 102;
      break;
    case 0x66:
      *(_DWORD *)(a1 + 104) = 3;
      break;
    case 0xC8:
      *(_DWORD *)(a1 + 116) = 201;
      *(_DWORD *)(a1 + 104) = 3;
      *(_DWORD *)(a1 + 100) = 0;
      goto LABEL_10;
    case 0xC9:
LABEL_10:
      if ( ++*(_DWORD *)(a1 + 100) > 2 )
      {
        *(_DWORD *)(a1 + 100) = 0;
        --*(_DWORD *)(a1 + 104);
      }
      if ( *(_DWORD *)(a1 + 104) <= 0 )
        *(_DWORD *)(a1 + 116) = 202;
      break;
    case 0x12C:
      *(_DWORD *)(a1 + 116) = 301;
      *(_DWORD *)(a1 + 104) = 4;
      if ( *(_DWORD *)(a1 + 76) )
        Create_Dust_Clouds(*(_DWORD *)(a1 + 8) + 2048, *(_DWORD *)(a1 + 12), 2048, 10);
      else
        Create_Dust_Clouds(*(_DWORD *)(a1 + 8) - 2048, *(_DWORD *)(a1 + 12), 2048, 10);
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
    *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 12288;
  else
    *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 12288;
  *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos - 18432;
  if ( *(_DWORD *)(a1 + 116) >= 0 && *(_DWORD *)(a1 + 116) < 300 )
  {
    if ( *(_DWORD *)(a1 + 104) == 3 )
      *(_WORD *)(a1 + 80) |= 0x20u;
    else
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v4 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v24 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (00478F20) --------------------------------------------------------
int __cdecl Ballos_Sub_NPC_Body(int a1)
{
  int *v1; // eax@1
  int v2; // ecx@1
  int result; // eax@1
  int v4; // [sp+0h] [bp-40h]@1
  int v5; // [sp+4h] [bp-3Ch]@1
  int v6; // [sp+8h] [bp-38h]@1
  int v7; // [sp+Ch] [bp-34h]@1
  int v8; // [sp+10h] [bp-30h]@1
  int v9; // [sp+14h] [bp-2Ch]@1
  int v10; // [sp+18h] [bp-28h]@1
  int v11; // [sp+1Ch] [bp-24h]@1
  int v12; // [sp+20h] [bp-20h]@1
  int v13; // [sp+24h] [bp-1Ch]@1
  int v14; // [sp+28h] [bp-18h]@1
  int v15; // [sp+2Ch] [bp-14h]@1
  int v16; // [sp+30h] [bp-10h]@1
  int v17; // [sp+34h] [bp-Ch]@1
  int v18; // [sp+38h] [bp-8h]@1
  int v19; // [sp+3Ch] [bp-4h]@1

  v4 = 0;
  v5 = 0;
  v6 = 120;
  v7 = 120;
  v8 = 120;
  v9 = 0;
  v10 = 240;
  v11 = 120;
  v12 = 0;
  v13 = 120;
  v14 = 120;
  v15 = 240;
  v16 = 120;
  v17 = 120;
  v18 = 240;
  v19 = 240;
  *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos;
  *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 104);
  v2 = a1 + 84;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  result = v1[3];
  *(_DWORD *)(v2 + 12) = result;
  return result;
}

//----- (00478FE0) --------------------------------------------------------
int __cdecl Ballos_Sub_NPC_HITAI(int a1)
{
  int result; // eax@1

  *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos;
  result = a1;
  *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos - 22528;
  return result;
}

//----- (00479010) --------------------------------------------------------
int __cdecl Ballos_Sub_NPC_HARA(int a1)
{
  int result; // eax@1

  *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos;
  result = Boss_Objects[0].Y_pos;
  *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
  return result;
}

//----- (00479030) --------------------------------------------------------
void Boss_2_Balfrog()
{
  int v0; // edx@3
  int v1; // ST10_4@5
  int v2; // ST0C_4@5
  int v3; // ST08_4@5
  int v4; // eax@5
  int v5; // ST08_4@38
  int v6; // eax@38
  int v7; // ST10_4@40
  int v8; // ST0C_4@40
  int v9; // ST08_4@40
  int v10; // eax@40
  int v11; // eax@50
  int v12; // ST08_4@85
  int v13; // eax@85
  int v14; // ST08_4@88
  int v15; // eax@88
  int v16; // ST10_4@91
  int v17; // ST0C_4@91
  int v18; // ST08_4@91
  int v19; // eax@91
  int v20; // ST10_4@101
  int v21; // ST0C_4@101
  int v22; // ST08_4@101
  int v23; // eax@101
  int v24; // ST10_4@104
  int v25; // ST0C_4@104
  int v26; // ST08_4@104
  int v27; // eax@104
  int v28; // ST10_4@115
  int v29; // ST0C_4@115
  int v30; // ST08_4@115
  int v31; // eax@115
  int *v32; // ecx@131
  int v33; // edx@131
  int *v34; // ecx@132
  int v35; // edx@132
  int Y_Vel; // [sp+4h] [bp-13Ch]@59
  int v37; // [sp+8h] [bp-138h]@1
  int v38; // [sp+Ch] [bp-134h]@1
  int v39; // [sp+10h] [bp-130h]@1
  int v40; // [sp+14h] [bp-12Ch]@1
  int v41; // [sp+18h] [bp-128h]@1
  int v42; // [sp+1Ch] [bp-124h]@1
  int v43; // [sp+20h] [bp-120h]@1
  int v44; // [sp+24h] [bp-11Ch]@1
  int v45; // [sp+28h] [bp-118h]@1
  int v46; // [sp+2Ch] [bp-114h]@1
  int v47; // [sp+30h] [bp-110h]@1
  int v48; // [sp+34h] [bp-10Ch]@1
  int v49; // [sp+38h] [bp-108h]@1
  int v50; // [sp+3Ch] [bp-104h]@1
  int v51; // [sp+40h] [bp-100h]@1
  int v52; // [sp+44h] [bp-FCh]@1
  int v53; // [sp+48h] [bp-F8h]@1
  int v54; // [sp+4Ch] [bp-F4h]@1
  int v55; // [sp+50h] [bp-F0h]@1
  int v56; // [sp+54h] [bp-ECh]@1
  int v57; // [sp+58h] [bp-E8h]@1
  int v58; // [sp+5Ch] [bp-E4h]@1
  int v59; // [sp+60h] [bp-E0h]@1
  int v60; // [sp+64h] [bp-DCh]@1
  int v61; // [sp+68h] [bp-D8h]@1
  int v62; // [sp+6Ch] [bp-D4h]@1
  int v63; // [sp+70h] [bp-D0h]@1
  int v64; // [sp+74h] [bp-CCh]@1
  int v65; // [sp+78h] [bp-C8h]@1
  int v66; // [sp+7Ch] [bp-C4h]@1
  int v67; // [sp+80h] [bp-C0h]@1
  int v68; // [sp+84h] [bp-BCh]@1
  int v69; // [sp+88h] [bp-B8h]@1
  int v70; // [sp+8Ch] [bp-B4h]@1
  int v71; // [sp+90h] [bp-B0h]@1
  int v72; // [sp+94h] [bp-ACh]@1
  int X_Vel; // [sp+9Ch] [bp-A4h]@59
  int i; // [sp+A0h] [bp-A0h]@3
  NPC_vars *v75; // [sp+A4h] [bp-9Ch]@1
  int v76; // [sp+A8h] [bp-98h]@1
  int v77; // [sp+ACh] [bp-94h]@1
  int v78; // [sp+B0h] [bp-90h]@1
  int v79; // [sp+B4h] [bp-8Ch]@1
  int v80; // [sp+B8h] [bp-88h]@1
  int v81; // [sp+BCh] [bp-84h]@1
  int v82; // [sp+C0h] [bp-80h]@1
  int v83; // [sp+C4h] [bp-7Ch]@1
  int v84; // [sp+C8h] [bp-78h]@1
  int v85; // [sp+CCh] [bp-74h]@1
  int v86; // [sp+D0h] [bp-70h]@1
  int v87; // [sp+D4h] [bp-6Ch]@1
  int v88; // [sp+D8h] [bp-68h]@1
  int v89; // [sp+DCh] [bp-64h]@1
  int v90; // [sp+E0h] [bp-60h]@1
  int v91; // [sp+E4h] [bp-5Ch]@1
  int v92; // [sp+E8h] [bp-58h]@1
  int v93; // [sp+ECh] [bp-54h]@1
  int v94; // [sp+F0h] [bp-50h]@1
  int v95; // [sp+F4h] [bp-4Ch]@1
  int v96; // [sp+F8h] [bp-48h]@1
  int v97; // [sp+FCh] [bp-44h]@1
  int v98; // [sp+100h] [bp-40h]@1
  int v99; // [sp+104h] [bp-3Ch]@1
  int v100; // [sp+108h] [bp-38h]@1
  int v101; // [sp+10Ch] [bp-34h]@1
  int v102; // [sp+110h] [bp-30h]@1
  int v103; // [sp+114h] [bp-2Ch]@1
  int v104; // [sp+118h] [bp-28h]@1
  int v105; // [sp+11Ch] [bp-24h]@1
  int v106; // [sp+120h] [bp-20h]@1
  int v107; // [sp+124h] [bp-1Ch]@1
  int v108; // [sp+128h] [bp-18h]@1
  int v109; // [sp+12Ch] [bp-14h]@1
  int v110; // [sp+130h] [bp-10h]@1
  int v111; // [sp+134h] [bp-Ch]@1
  unsigned __int8 v112; // [sp+13Fh] [bp-1h]@57

  v76 = 0;
  v77 = 0;
  v78 = 0;
  v79 = 0;
  v80 = 0;
  v81 = 48;
  v82 = 80;
  v83 = 112;
  v84 = 0;
  v85 = 112;
  v86 = 80;
  v87 = 176;
  v88 = 0;
  v89 = 176;
  v90 = 80;
  v91 = 240;
  v92 = 160;
  v93 = 48;
  v94 = 240;
  v95 = 112;
  v96 = 160;
  v97 = 112;
  v98 = 240;
  v99 = 200;
  v100 = 200;
  v101 = 0;
  v102 = 240;
  v103 = 24;
  v104 = 80;
  v105 = 0;
  v106 = 120;
  v107 = 24;
  v108 = 120;
  v109 = 0;
  v110 = 160;
  v111 = 24;
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 80;
  v42 = 48;
  v43 = 160;
  v44 = 112;
  v45 = 80;
  v46 = 112;
  v47 = 160;
  v48 = 176;
  v49 = 80;
  v50 = 176;
  v51 = 160;
  v52 = 240;
  v53 = 240;
  v54 = 48;
  v55 = 320;
  v56 = 112;
  v57 = 240;
  v58 = 112;
  v59 = 320;
  v60 = 200;
  v61 = 200;
  v62 = 24;
  v63 = 240;
  v64 = 48;
  v65 = 80;
  v66 = 24;
  v67 = 120;
  v68 = 48;
  v69 = 120;
  v70 = 24;
  v71 = 160;
  v72 = 48;
  v75 = Boss_Objects;
  switch ( Boss_Objects[0].Current_State )
  {
    case 0:
      v75->X_pos = 49152;
      v75->Y_pos = 102400;
      v75->Direction = 2;
      v75->view.front = 24576;
      v75->view.top = 24576;
      v75->view.back = 0x4000;
      v75->view.bottom = 0x2000;
      v75->Sound_Hit = 52;
      v75->Hitbox.front = 12288;
      v75->Hitbox.top = 0x2000;
      v75->Hitbox.back = 12288;
      v75->Hitbox.bottom = 0x2000;
      v75->Explosion_Size = 3;
      v75->EXP_Amount = 1;
      v75->Entity_Eve_Num = 1000;
      v75->Entity_Flags |= 0x8200u;
      v75->Life = 300;
      break;
    case 0xA:
      v75->Current_State = 11;
      v75->Ani_Num = 3;
      v75->Is_Alive = -128;
      v0 = (int)&v75->Rect.left;
      *(_DWORD *)v0 = v37;
      *(_DWORD *)(v0 + 4) = v38;
      *(_DWORD *)(v0 + 8) = v39;
      *(_DWORD *)(v0 + 12) = v40;
      Boss_Objects[1].Is_Alive = -112;
      Boss_Objects[1].Entity_Eve_Num = 1000;
      Boss_Objects[2].Is_Alive = -128;
      Boss_Objects[1].Damage = 5;
      Boss_Objects[2].Damage = 5;
      for ( i = 0; i < 8; ++i )
      {
        v1 = Random(-1536, 0);
        v2 = Random(-341, 341);
        v3 = v75->Y_pos + (Random(-12, 12) << 9);
        v4 = Random(-12, 12);
        NPC_Create(Smoke, v75->X_pos + (v4 << 9), v3, v2, v1, 0, NULL, 256);
      }
      break;
    case 0x14:
      v75->Current_State = 21;
      v75->Wait_Timer = 0;
      goto LABEL_8;
    case 0x15:
LABEL_8:
      if ( ++v75->Wait_Timer / 2 % 2 )
        v75->Ani_Num = 3;
      else
        v75->Ani_Num = 0;
      break;
    case 0x64:
      v75->Current_State = 101;
      v75->Wait_Timer = 0;
      v75->Ani_Num = 1;
      v75->X_vel = 0;
      goto LABEL_13;
    case 0x65:
LABEL_13:
      if ( ++v75->Wait_Timer > 50 )
      {
        v75->Current_State = 102;
        v75->ani_wait = 0;
        v75->Ani_Num = 2;
      }
      break;
    case 0x66:
      if ( ++v75->ani_wait > 10 )
      {
        v75->Current_State = 103;
        v75->ani_wait = 0;
        v75->Ani_Num = 1;
      }
      break;
    case 0x67:
      if ( ++v75->ani_wait > 4 )
      {
        v75->Current_State = 104;
        v75->Ani_Num = 5;
        v75->Y_vel = -1024;
        Play_Sound_Effect(Sfx_Silly_Explosion, 1);
        if ( v75->Direction )
          v75->X_vel = 512;
        else
          v75->X_vel = -512;
        v75->view.top = 0x8000;
        v75->view.bottom = 12288;
      }
      break;
    case 0x68:
      if ( !v75->Direction && v75->Collision_flags & 1 )
      {
        v75->Direction = 2;
        v75->X_vel = 512;
      }
      if ( v75->Direction == 2 && v75->Collision_flags & 4 )
      {
        v75->Direction = 0;
        v75->X_vel = -512;
      }
      if ( v75->Collision_flags & 8 )
      {
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
        v75->Current_State = 100;
        v75->Ani_Num = 1;
        v75->view.top = 24576;
        v75->view.bottom = 0x2000;
        if ( !v75->Direction && v75->X_pos < Quote.X_Pos )
        {
          v75->Direction = 2;
          v75->Current_State = 110;
        }
        if ( v75->Direction == 2 && v75->X_pos > Quote.X_Pos )
        {
          v75->Direction = 0;
          v75->Current_State = 110;
        }
        v5 = Random(0, 4) << 13;
        v6 = Random(4, 16);
        NPC_Create(Santas_Key|0x60, v6 << 13, v5, 0, 0, (Directions)4, NULL, 128);
        for ( i = 0; i < 4; ++i )
        {
          v7 = Random(-1536, 0);
          v8 = Random(-341, 341);
          v9 = v75->Hitbox.bottom + v75->Y_pos;
          v10 = Random(-12, 12);
          NPC_Create(Smoke, v75->X_pos + (v10 << 9), v9, v8, v7, 0, NULL, 256);
        }
      }
      break;
    case 0x6E:
      v75->Ani_Num = 1;
      v75->Wait_Timer = 0;
      v75->Current_State = 111;
      goto LABEL_43;
    case 0x6F:
LABEL_43:
      ++v75->Wait_Timer;
      v75->X_vel = 8 * v75->X_vel / 9;
      if ( v75->Wait_Timer > 50 )
      {
        v75->Ani_Num = 2;
        v75->ani_wait = 0;
        v75->Current_State = 112;
      }
      break;
    case 0x70:
      if ( ++v75->ani_wait > 4 )
      {
        v75->Current_State = 113;
        v75->Wait_Timer = 0;
        v75->Ani_Num = 3;
        v75->count1 = 16;
        Boss_Objects[1].Entity_Flags |= 0x20u;
        v75->Curly_Target_X = v75->Life;
      }
      break;
    case 0x71:
      if ( v75->Is_Being_Hit )
      {
        v11 = v75->count2++ / 2 % 2;
        if ( v11 )
          v75->Ani_Num = 4;
        else
          v75->Ani_Num = 3;
      }
      else
      {
        v75->count2 = 0;
        v75->Ani_Num = 3;
      }
      v75->X_vel = 10 * v75->X_vel / 11;
      if ( ++v75->Wait_Timer > 16 )
      {
        v75->Wait_Timer = 0;
        --v75->count1;
        v112 = v75->Direction ? GetArcTan(v75->X_pos + 0x4000 - Quote.X_Pos, v75->Y_pos - 4096 - Quote.Y_Pos) : GetArcTan(v75->X_pos - 0x4000 - Quote.X_Pos, v75->Y_pos - 4096 - Quote.Y_Pos);
        v112 += Random(-16, 16);
        Y_Vel = GetSin(v112);
        X_Vel = GetCos(v112);
        if ( v75->Direction )
          NPC_Create((NPC_Names)108, v75->X_pos + 0x4000, v75->Y_pos - 4096, X_Vel, Y_Vel, 0, NULL, 256);
        else
          NPC_Create((NPC_Names)108, v75->X_pos - 0x4000, v75->Y_pos - 4096, X_Vel, Y_Vel, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
        if ( !v75->count1 || v75->Life < v75->Curly_Target_X - 90 )
        {
          v75->Current_State = 114;
          v75->Wait_Timer = 0;
          v75->Ani_Num = 2;
          v75->ani_wait = 0;
          Boss_Objects[1].Entity_Flags &= 0xFFDFu;
        }
      }
      break;
    case 0x72:
      if ( ++v75->ani_wait > 10 )
      {
        if ( ++Boss_Objects[1].count1 <= 2 )
        {
          v75->Current_State = 100;
        }
        else
        {
          Boss_Objects[1].count1 = 0;
          v75->Current_State = 120;
        }
        v75->ani_wait = 0;
        v75->Ani_Num = 1;
      }
      break;
    case 0x78:
      v75->Current_State = 121;
      v75->Wait_Timer = 0;
      v75->Ani_Num = 1;
      v75->X_vel = 0;
      goto LABEL_73;
    case 0x79:
LABEL_73:
      if ( ++v75->Wait_Timer > 50 )
      {
        v75->Current_State = 122;
        v75->ani_wait = 0;
        v75->Ani_Num = 2;
      }
      break;
    case 0x7A:
      if ( ++v75->ani_wait > 20 )
      {
        v75->Current_State = 123;
        v75->ani_wait = 0;
        v75->Ani_Num = 1;
      }
      break;
    case 0x7B:
      if ( ++v75->ani_wait > 4 )
      {
        v75->Current_State = 124;
        v75->Ani_Num = 5;
        v75->Y_vel = -2560;
        v75->view.top = 0x8000;
        v75->view.bottom = 12288;
        Play_Sound_Effect(Sfx_Silly_Explosion, 1);
      }
      break;
    case 0x7C:
      if ( v75->Collision_flags & 8 )
      {
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(60);
        v75->Current_State = 100;
        v75->Ani_Num = 1;
        v75->view.top = 24576;
        v75->view.bottom = 0x2000;
        for ( i = 0; i < 2; ++i )
        {
          v12 = Random(0, 4) << 13;
          v13 = Random(4, 16);
          NPC_Create((NPC_Names)104, v13 << 13, v12, 0, 0, (Directions)4, NULL, 128);
        }
        for ( i = 0; i < 6; ++i )
        {
          v14 = Random(0, 4) << 13;
          v15 = Random(4, 16);
          NPC_Create(Santas_Key|0x60, v15 << 13, v14, 0, 0, (Directions)4, NULL, 128);
        }
        for ( i = 0; i < 8; ++i )
        {
          v16 = Random(-1536, 0);
          v17 = Random(-341, 341);
          v18 = v75->Hitbox.bottom + v75->Y_pos;
          v19 = Random(-12, 12);
          NPC_Create(Smoke, v75->X_pos + (v19 << 9), v18, v17, v16, 0, NULL, 256);
        }
        if ( !v75->Direction && v75->X_pos < Quote.X_Pos )
        {
          v75->Direction = 2;
          v75->Current_State = 110;
        }
        if ( v75->Direction == 2 && v75->X_pos > Quote.X_Pos )
        {
          v75->Direction = 0;
          v75->Current_State = 110;
        }
      }
      break;
    case 0x82:
      v75->Current_State = 131;
      v75->Ani_Num = 3;
      v75->Wait_Timer = 0;
      v75->X_vel = 0;
      Play_Sound_Effect(Sfx_Explosion, 1);
      for ( i = 0; i < 8; ++i )
      {
        v20 = Random(-1536, 0);
        v21 = Random(-341, 341);
        v22 = v75->Y_pos + (Random(-12, 12) << 9);
        v23 = Random(-12, 12);
        NPC_Create(Smoke, v75->X_pos + (v23 << 9), v22, v21, v20, 0, NULL, 256);
      }
      Boss_Objects[1].Is_Alive = 0;
      Boss_Objects[2].Is_Alive = 0;
      goto LABEL_103;
    case 0x83:
LABEL_103:
      if ( !(++v75->Wait_Timer % 5) )
      {
        v24 = Random(-1536, 0);
        v25 = Random(-341, 341);
        v26 = v75->Y_pos + (Random(-12, 12) << 9);
        v27 = Random(-12, 12);
        NPC_Create(Smoke, v75->X_pos + (v27 << 9), v26, v25, v24, 0, NULL, 256);
      }
      if ( v75->Wait_Timer / 2 % 2 )
        v75->X_pos -= 512;
      else
        v75->X_pos += 512;
      if ( v75->Wait_Timer > 100 )
      {
        v75->Wait_Timer = 0;
        v75->Current_State = 132;
      }
      break;
    case 0x84:
      if ( ++v75->Wait_Timer / 2 % 2 )
      {
        v75->view.front = 10240;
        v75->view.top = 6144;
        v75->view.back = 10240;
        v75->view.bottom = 6144;
        v75->Ani_Num = 6;
      }
      else
      {
        v75->view.front = 24576;
        v75->view.top = 24576;
        v75->view.back = 0x4000;
        v75->view.bottom = 0x2000;
        v75->Ani_Num = 3;
      }
      if ( !(v75->Wait_Timer % 9) )
      {
        v28 = Random(-1536, 0);
        v29 = Random(-341, 341);
        v30 = v75->Y_pos + (Random(-12, 12) << 9);
        v31 = Random(-12, 12);
        NPC_Create(Smoke, v75->X_pos + (v31 << 9), v30, v29, v28, 0, NULL, 256);
      }
      if ( v75->Wait_Timer > 150 )
      {
        v75->Current_State = 140;
        v75->Hitbox.bottom = 6144;
      }
      break;
    case 0x8C:
      v75->Current_State = 141;
      goto LABEL_120;
    case 0x8D:
LABEL_120:
      if ( v75->Collision_flags & 8 )
      {
        v75->Current_State = 142;
        v75->Wait_Timer = 0;
        v75->Ani_Num = 7;
      }
      break;
    case 0x8E:
      if ( ++v75->Wait_Timer > 30 )
      {
        v75->Ani_Num = 8;
        v75->Y_vel = -2560;
        v75->Entity_Flags |= 8u;
        v75->Current_State = 143;
      }
      break;
    case 0x8F:
      v75->Y_vel = -2560;
      if ( v75->Y_pos < 0 )
      {
        v75->Is_Alive = 0;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Set_Quake(30);
      }
      break;
    default:
      break;
  }
  v75->Y_vel += 64;
  if ( v75->Y_vel > 1535 )
    v75->Y_vel = 1535;
  v75->X_pos += v75->X_vel;
  v75->Y_pos += v75->Y_vel;
  if ( v75->Direction )
  {
    v34 = &v37 + 4 * v75->Ani_Num;
    v35 = (int)&v75->Rect.left;
    *(_DWORD *)v35 = *v34;
    *(_DWORD *)(v35 + 4) = v34[1];
    *(_DWORD *)(v35 + 8) = v34[2];
    *(_DWORD *)(v35 + 12) = v34[3];
  }
  else
  {
    v32 = &v76 + 4 * v75->Ani_Num;
    v33 = (int)&v75->Rect.left;
    *(_DWORD *)v33 = *v32;
    *(_DWORD *)(v33 + 4) = v32[1];
    *(_DWORD *)(v33 + 8) = v32[2];
    *(_DWORD *)(v33 + 12) = v32[3];
  }
  Balfrog_Sub_NPC_1();
  Balfrog_Sub_NPC_2();
}

//----- (0047A6A0) --------------------------------------------------------
void __cdecl Balfrog_Sub_NPC_1()
{
  signed int Dir; // [sp+8h] [bp-4h]@2

  if ( Boss_Objects[0].Direction )
    Dir = -1;
  else
    Dir = 1;
  switch ( Boss_Objects[0].Ani_Num )
  {
    case 0:
      Boss_Objects[1].Sound_Hit = 52;
      Boss_Objects[1].Hitbox.front = 0x2000;
      Boss_Objects[1].Hitbox.top = 0x2000;
      Boss_Objects[1].Hitbox.back = 0x2000;
      Boss_Objects[1].Hitbox.bottom = 0x2000;
      Boss_Objects[1].Explosion_Size = 3;
      Boss_Objects[1].Entity_Flags = 4;
      break;
    case 1:
      Boss_Objects[1].X_pos = Boss_Objects[0].X_pos + -12288 * Dir;
      Boss_Objects[1].Y_pos = Boss_Objects[0].Y_pos - 12288;
      break;
    case 2:
      Boss_Objects[1].X_pos = Boss_Objects[0].X_pos + -12288 * Dir;
      Boss_Objects[1].Y_pos = Boss_Objects[0].Y_pos - 10240;
      break;
    case 3:
    case 4:
      Boss_Objects[1].X_pos = Boss_Objects[0].X_pos + -12288 * Dir;
      Boss_Objects[1].Y_pos = Boss_Objects[0].Y_pos - 0x2000;
      break;
    case 5:
      Boss_Objects[1].X_pos = Boss_Objects[0].X_pos + -12288 * Dir;
      Boss_Objects[1].Y_pos = Boss_Objects[0].Y_pos - 22016;
      break;
    default:
      return;
  }
}

//----- (0047A800) --------------------------------------------------------
void __cdecl Balfrog_Sub_NPC_2()
{
  if ( Boss_Objects[0].Ani_Num )
  {
    if ( Boss_Objects[0].Ani_Num > 0 && Boss_Objects[0].Ani_Num <= 5 )
    {
      Boss_Objects[2].X_pos = Boss_Objects[0].X_pos;
      Boss_Objects[2].Y_pos = Boss_Objects[0].Y_pos;
    }
  }
  else
  {
    Boss_Objects[2].Sound_Hit = 52;
    Boss_Objects[2].Hitbox.front = 12288;
    Boss_Objects[2].Hitbox.top = 0x2000;
    Boss_Objects[2].Hitbox.back = 12288;
    Boss_Objects[2].Hitbox.bottom = 0x2000;
    Boss_Objects[2].Explosion_Size = 3;
    Boss_Objects[2].Entity_Flags = 4;
  }
}

//----- (0047A8A0) --------------------------------------------------------
RECT *Boss_5_Ironhead()
{
  int v0; // ST08_4@16
  int v1; // eax@16
  int v2; // ST10_4@47
  int v3; // eax@47
  int v4; // ST10_4@55
  int v5; // ST0C_4@55
  int v6; // ST08_4@55
  int v7; // eax@55
  int v8; // ST10_4@58
  int v9; // ST0C_4@58
  int v10; // ST08_4@58
  int v11; // eax@58
  int *v12; // edx@61
  RECT *result; // eax@61
  int *v14; // edx@62
  int *v15; // edx@64
  int v16; // [sp+0h] [bp-12Ch]@1
  signed int i; // [sp+8h] [bp-124h]@53
  int v18; // [sp+Ch] [bp-120h]@59
  int v19; // [sp+10h] [bp-11Ch]@59
  int v20; // [sp+14h] [bp-118h]@59
  int v21; // [sp+18h] [bp-114h]@59
  int v22; // [sp+1Ch] [bp-110h]@59
  int v23; // [sp+20h] [bp-10Ch]@59
  int v24; // [sp+24h] [bp-108h]@59
  int v25; // [sp+28h] [bp-104h]@59
  int v26; // [sp+2Ch] [bp-100h]@59
  int v27; // [sp+30h] [bp-FCh]@59
  int v28; // [sp+34h] [bp-F8h]@59
  int v29; // [sp+38h] [bp-F4h]@59
  int v30; // [sp+3Ch] [bp-F0h]@59
  int v31; // [sp+40h] [bp-ECh]@59
  int v32; // [sp+44h] [bp-E8h]@59
  int v33; // [sp+48h] [bp-E4h]@59
  int v34; // [sp+4Ch] [bp-E0h]@59
  int v35; // [sp+50h] [bp-DCh]@59
  int v36; // [sp+54h] [bp-D8h]@59
  int v37; // [sp+58h] [bp-D4h]@59
  int v38; // [sp+5Ch] [bp-D0h]@59
  int v39; // [sp+60h] [bp-CCh]@59
  int v40; // [sp+64h] [bp-C8h]@59
  int v41; // [sp+68h] [bp-C4h]@59
  int v42; // [sp+6Ch] [bp-C0h]@59
  int v43; // [sp+70h] [bp-BCh]@59
  int v44; // [sp+74h] [bp-B8h]@59
  int v45; // [sp+78h] [bp-B4h]@59
  int v46; // [sp+7Ch] [bp-B0h]@59
  int v47; // [sp+80h] [bp-ACh]@59
  int v48; // [sp+84h] [bp-A8h]@59
  int v49; // [sp+88h] [bp-A4h]@59
  int v50; // [sp+8Ch] [bp-A0h]@59
  int v51; // [sp+90h] [bp-9Ch]@59
  int v52; // [sp+94h] [bp-98h]@59
  int v53; // [sp+98h] [bp-94h]@59
  int v54; // [sp+9Ch] [bp-90h]@59
  int v55; // [sp+A0h] [bp-8Ch]@59
  int v56; // [sp+A4h] [bp-88h]@59
  int v57; // [sp+A8h] [bp-84h]@59
  int v58; // [sp+ACh] [bp-80h]@59
  int v59; // [sp+B0h] [bp-7Ch]@59
  int v60; // [sp+B4h] [bp-78h]@59
  int v61; // [sp+B8h] [bp-74h]@59
  int v62; // [sp+BCh] [bp-70h]@59
  int v63; // [sp+C0h] [bp-6Ch]@59
  int v64; // [sp+C4h] [bp-68h]@59
  int v65; // [sp+C8h] [bp-64h]@59
  int v66; // [sp+CCh] [bp-60h]@59
  int v67; // [sp+D0h] [bp-5Ch]@59
  int v68; // [sp+D4h] [bp-58h]@59
  int v69; // [sp+D8h] [bp-54h]@59
  int v70; // [sp+DCh] [bp-50h]@59
  int v71; // [sp+E0h] [bp-4Ch]@59
  int v72; // [sp+E4h] [bp-48h]@59
  int v73; // [sp+E8h] [bp-44h]@59
  int v74; // [sp+ECh] [bp-40h]@59
  int v75; // [sp+F0h] [bp-3Ch]@59
  int v76; // [sp+F4h] [bp-38h]@59
  int v77; // [sp+F8h] [bp-34h]@59
  int v78; // [sp+FCh] [bp-30h]@59
  int v79; // [sp+100h] [bp-2Ch]@59
  int v80; // [sp+104h] [bp-28h]@59
  int v81; // [sp+108h] [bp-24h]@59
  int v82; // [sp+10Ch] [bp-20h]@59
  int v83; // [sp+110h] [bp-1Ch]@59
  int v84; // [sp+114h] [bp-18h]@59
  int v85; // [sp+118h] [bp-14h]@59
  int v86; // [sp+11Ch] [bp-10h]@59
  int v87; // [sp+120h] [bp-Ch]@59
  int v88; // [sp+124h] [bp-8h]@59
  int v89; // [sp+128h] [bp-4h]@59

  v16 = Boss_Objects[0].Current_State;
  if ( v16 <= 250 )
  {
    if ( v16 != 250 )
    {
      if ( !v16 )
      {
        Boss_Objects[0].Is_Alive = -128;
        Boss_Objects[0].EXP_Amount = 1;
        Boss_Objects[0].Direction = 2;
        Boss_Objects[0].Current_State = 100;
        Boss_Objects[0].X_pos = 81920;
        Boss_Objects[0].Y_pos = 0x10000;
        Boss_Objects[0].view.front = 20480;
        Boss_Objects[0].view.top = 6144;
        Boss_Objects[0].view.back = 12288;
        Boss_Objects[0].view.bottom = 6144;
        Boss_Objects[0].Sound_Hit = 54;
        Boss_Objects[0].Hitbox.front = 0x2000;
        Boss_Objects[0].Hitbox.top = 5120;
        Boss_Objects[0].Hitbox.back = 0x2000;
        Boss_Objects[0].Hitbox.bottom = 5120;
        Boss_Objects[0].Entity_Flags = -32216;
        Boss_Objects[0].Explosion_Size = 3;
        Boss_Objects[0].Damage = 10;
        Boss_Objects[0].Entity_Eve_Num = 1000;
        Boss_Objects[0].Life = 400;
        goto LABEL_59;
      }
      if ( v16 == 100 )
      {
        Boss_Objects[0].Current_State = 101;
        Boss_Objects[0].Entity_Flags &= 0xFFDFu;
        Boss_Objects[0].Wait_Timer = 0;
      }
      else if ( v16 != 101 )
      {
        goto LABEL_59;
      }
      if ( ++Boss_Objects[0].Wait_Timer > 50 )
      {
        Boss_Objects[0].Current_State = 250;
        Boss_Objects[0].Wait_Timer = 0;
      }
      if ( !(Boss_Objects[0].Wait_Timer % 4) )
      {
        v0 = Random(2, 13) << 13;
        v1 = Random(15, 18);
        NPC_Create((NPC_Names)197, v1 << 13, v0, 0, 0, 0, NULL, 256);
      }
      goto LABEL_59;
    }
    Boss_Objects[0].Current_State = 251;
    if ( Boss_Objects[0].Direction == 2 )
    {
      Boss_Objects[0].X_pos = 122880;
      Boss_Objects[0].Y_pos = Quote.Y_Pos;
    }
    else
    {
      Boss_Objects[0].X_pos = 368640;
      Boss_Objects[0].Y_pos = Random(2, 13) << 13;
    }
    Boss_Objects[0].Curly_Target_X = Boss_Objects[0].X_pos;
    Boss_Objects[0].Curly_Target_Y = Boss_Objects[0].Y_pos;
    Boss_Objects[0].Y_vel = Random(-512, 512);
    Boss_Objects[0].X_vel = Random(-512, 512);
    Boss_Objects[0].Entity_Flags |= 0x20u;
LABEL_22:
    if ( Boss_Objects[0].Direction == 2 )
    {
      Boss_Objects[0].Curly_Target_X += 1024;
    }
    else
    {
      Boss_Objects[0].Curly_Target_X -= 512;
      if ( Boss_Objects[0].Curly_Target_Y >= Quote.Y_Pos )
        Boss_Objects[0].Curly_Target_Y -= 512;
      else
        Boss_Objects[0].Curly_Target_Y += 512;
    }
    if ( Boss_Objects[0].X_pos >= Boss_Objects[0].Curly_Target_X )
      Boss_Objects[0].X_vel -= 8;
    else
      Boss_Objects[0].X_vel += 8;
    if ( Boss_Objects[0].Y_pos >= Boss_Objects[0].Curly_Target_Y )
      Boss_Objects[0].Y_vel -= 8;
    else
      Boss_Objects[0].Y_vel += 8;
    if ( Boss_Objects[0].Y_vel > 512 )
      Boss_Objects[0].Y_vel = 512;
    if ( Boss_Objects[0].Y_vel < -512 )
      Boss_Objects[0].Y_vel = -512;
    Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
    Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
    if ( Boss_Objects[0].Direction == 2 )
    {
      if ( Boss_Objects[0].X_pos > 368640 )
      {
        Boss_Objects[0].Direction = 0;
        Boss_Objects[0].Current_State = 100;
      }
    }
    else if ( Boss_Objects[0].X_pos < 139264 )
    {
      Boss_Objects[0].Direction = 2;
      Boss_Objects[0].Current_State = 100;
    }
    if ( !Boss_Objects[0].Direction
      && (++Boss_Objects[0].Wait_Timer == 300 || Boss_Objects[0].Wait_Timer == 310 || Boss_Objects[0].Wait_Timer == 320) )
    {
      Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      v2 = Random(-3, 3) << 9;
      v3 = Random(-3, 0);
      NPC_Create(
        (NPC_Names)198,
        Boss_Objects[0].X_pos + 5120,
        Boss_Objects[0].Y_pos + 512,
        v3 << 9,
        v2,
        Right,
        NULL,
        256);
    }
    if ( ++Boss_Objects[0].ani_wait > 2 )
    {
      Boss_Objects[0].ani_wait = 0;
      ++Boss_Objects[0].Ani_Num;
    }
    if ( Boss_Objects[0].Ani_Num > 7 )
      Boss_Objects[0].Ani_Num = 0;
    goto LABEL_59;
  }
  if ( v16 == 251 )
    goto LABEL_22;
  if ( v16 == 1000 )
  {
    Boss_Objects[0].Entity_Flags &= 0xFFDFu;
    Boss_Objects[0].Ani_Num = 8;
    Boss_Objects[0].Damage = 0;
    Boss_Objects[0].Current_State = 1001;
    Boss_Objects[0].Curly_Target_X = Boss_Objects[0].X_pos;
    Boss_Objects[0].Curly_Target_Y = Boss_Objects[0].Y_pos;
    Set_Quake(20);
    for ( i = 0; i < 32; ++i )
    {
      v4 = Random(-128, 128) << 9;
      v5 = Random(-128, 128) << 9;
      v6 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
      v7 = Random(-128, 128);
      NPC_Create(Smoke, Boss_Objects[0].X_pos + (v7 << 9), v6, v5, v4, 0, NULL, 256);
    }
    Kill_NPC(197, 1);
    Kill_NPC(271, 1);
    Kill_NPC(272, 1);
  }
  else if ( v16 != 1001 )
  {
    goto LABEL_59;
  }
  Boss_Objects[0].Curly_Target_X -= 512;
  Boss_Objects[0].X_pos = Boss_Objects[0].Curly_Target_X + (Random(-1, 1) << 9);
  Boss_Objects[0].Y_pos = Boss_Objects[0].Curly_Target_Y + (Random(-1, 1) << 9);
  if ( !(++Boss_Objects[0].Wait_Timer % 4) )
  {
    v8 = Random(-128, 128) << 9;
    v9 = Random(-128, 128) << 9;
    v10 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
    v11 = Random(-128, 128);
    NPC_Create(Smoke, Boss_Objects[0].X_pos + (v11 << 9), v10, v9, v8, 0, NULL, 256);
  }
LABEL_59:
  v18 = 0;
  v19 = 0;
  v20 = 64;
  v21 = 24;
  v22 = 64;
  v23 = 0;
  v24 = 128;
  v25 = 24;
  v26 = 128;
  v27 = 0;
  v28 = 192;
  v29 = 24;
  v30 = 64;
  v31 = 0;
  v32 = 128;
  v33 = 24;
  v34 = 0;
  v35 = 0;
  v36 = 64;
  v37 = 24;
  v38 = 192;
  v39 = 0;
  v40 = 256;
  v41 = 24;
  v42 = 256;
  v43 = 0;
  v44 = 320;
  v45 = 24;
  v46 = 192;
  v47 = 0;
  v48 = 256;
  v49 = 24;
  v50 = 256;
  v51 = 48;
  v52 = 320;
  v53 = 72;
  v54 = 0;
  v55 = 24;
  v56 = 64;
  v57 = 48;
  v58 = 64;
  v59 = 24;
  v60 = 128;
  v61 = 48;
  v62 = 128;
  v63 = 24;
  v64 = 192;
  v65 = 48;
  v66 = 64;
  v67 = 24;
  v68 = 128;
  v69 = 48;
  v70 = 0;
  v71 = 24;
  v72 = 64;
  v73 = 48;
  v74 = 192;
  v75 = 24;
  v76 = 256;
  v77 = 48;
  v78 = 256;
  v79 = 24;
  v80 = 320;
  v81 = 48;
  v82 = 192;
  v83 = 24;
  v84 = 256;
  v85 = 48;
  v86 = 256;
  v87 = 48;
  v88 = 320;
  v89 = 72;
  if ( Boss_Objects[0].Is_Being_Hit )
  {
    ++byte_4BBA41[0];
    if ( ((signed int)byte_4BBA41[0] >> 1) % 2 )
    {
      v12 = &v18 + 4 * Boss_Objects[0].Ani_Num;
      result = &Boss_Objects[0].Rect;
      result->left = *v12;
      result->top = v12[1];
      result->right = v12[2];
      result->bottom = v12[3];
    }
    else
    {
      v14 = &v54 + 4 * Boss_Objects[0].Ani_Num;
      result = &Boss_Objects[0].Rect;
      result->left = *v14;
      result->top = v14[1];
      result->right = v14[2];
      result->bottom = v14[3];
    }
  }
  else
  {
    v15 = &v18 + 4 * Boss_Objects[0].Ani_Num;
    result = &Boss_Objects[0].Rect;
    result->left = *v15;
    result->top = v15[1];
    result->right = v15[2];
    result->bottom = v15[3];
  }
  return result;
}

//----- (0047B460) --------------------------------------------------------
signed int __cdecl Start_Boss_Life(int Entity_Eve_Num)
{
  signed int result; // eax@6
  signed int i; // [sp+0h] [bp-4h]@1

  for ( i = 0; i < 512 && NPC_Objects[i].Entity_Eve_Num != Entity_Eve_Num; ++i )
    ;
  if ( i == 512 )
  {
    result = 0;
  }
  else
  {
    Boss_Thing.flag = 1;
    Boss_Thing.max = NPC_Objects[i].Life;
    Boss_Thing.br = NPC_Objects[i].Life;
    Boss_Thing.pLife = &NPC_Objects[i].Life;
    result = 1;
  }
  return result;
}

//----- (0047B500) --------------------------------------------------------
signed int Start_Boss_Life_2()
{
  Boss_Thing.flag = 1;
  Boss_Thing.max = Boss_Objects[0].Life;
  Boss_Thing.br = Boss_Objects[0].Life;
  Boss_Thing.pLife = &Boss_Objects[0].Life;
  return 1;
}

//----- (0047B540) --------------------------------------------------------
void Draw_Boss_Health()
{
  RECT rect; // [sp+0h] [bp-50h]@1
  RECT v1; // [sp+10h] [bp-40h]@1
  RECT v2; // [sp+20h] [bp-30h]@1
  RECT v3; // [sp+30h] [bp-20h]@1
  RECT v4; // [sp+40h] [bp-10h]@1

  v2.left = 0;
  v2.top = 48;
  v2.right = 32;
  v2.bottom = 56;
  rect.left = 0;
  rect.top = 0;
  rect.right = 244;
  rect.bottom = 8;
  v3.left = 0;
  v3.top = 16;
  v3.right = 244;
  v3.bottom = 24;
  v4.left = 0;
  v4.top = 24;
  v4.right = 0;
  v4.bottom = 32;
  v1.left = 0;
  v1.top = 32;
  v1.right = 232;
  v1.bottom = 40;
  if ( Boss_Thing.flag )
  {
    if ( *Boss_Thing.pLife >= 1 )
    {
      v4.right = 198 * *Boss_Thing.pLife / Boss_Thing.max;
      if ( Boss_Thing.br <= *Boss_Thing.pLife )
      {
        Boss_Thing.count = 0;
      }
      else if ( ++Boss_Thing.count > 30 )
      {
        --Boss_Thing.br;
      }
      v1.right = 198 * Boss_Thing.br / Boss_Thing.max;
      Draw_Bitmap_With_Transparency(&Rect_Game, 32, 220, &rect, 26);
      Draw_Bitmap_With_Transparency(&Rect_Game, 32, 228, &v3, 26);
      Draw_Bitmap_With_Transparency(&Rect_Game, 72, 224, &v1, 26);
      Draw_Bitmap_With_Transparency(&Rect_Game, 72, 224, &v4, 26);
      Draw_Bitmap_With_Transparency(&Rect_Game, 40, 224, &v2, 26);
    }
    else
    {
      Boss_Thing.flag = 0;
    }
  }
}

//----- (0047B6F0) --------------------------------------------------------
// Boss 1 : Omega
// Omega's AI.
void Boss_1_Omega()
{
  int Child_X_Vel; // eax@23 MAPDST
  int Dust_Y_Pos; // ST14_4@81
  int Dust_X_Pos; // eax@81
  RECT *Chosen_Rect; // eax@86
  RECT Rects[4]; // [sp+4h] [bp-40h]@86

  switch ( Boss_Objects[0].Current_State )
  {
    case 0:
      Boss_Objects[0].X_pos = 0x1B6000;
      Boss_Objects[0].Y_pos = 0x20000;
      Boss_Objects[0].view.front = 0x5000;
      Boss_Objects[0].view.top = 0x5000;
      Boss_Objects[0].view.back = 0x5000;
      Boss_Objects[0].view.bottom = 0x2000;
      Boss_Objects[0].Curly_Target_X = 0x1B6000;
      Boss_Objects[0].Curly_Target_Y = 0x20000;
      Boss_Objects[0].Sound_Hit = 52;
      Boss_Objects[0].Hitbox.front = 0x1000;
      Boss_Objects[0].Hitbox.top = 0x3000;
      Boss_Objects[0].Hitbox.back = 0x1000;
      Boss_Objects[0].Hitbox.bottom = 0x2000;
      Boss_Objects[0].Entity_Flags = -32248;
      Boss_Objects[0].Explosion_Size = 3;
      Boss_Objects[0].EXP_Amount = 1;
      Boss_Objects[0].Entity_Eve_Num = 210;
      Boss_Objects[0].Life = 400;
      Boss_Objects[1].Is_Alive = 0x80u;
      Boss_Objects[1].view.front = 0x1800;
      Boss_Objects[1].view.top = 0x1000;
      Boss_Objects[1].view.back = 0x1800;
      Boss_Objects[1].view.bottom = 0x1000;
      Boss_Objects[1].Entity_Flags = 8;
      qmemcpy(&Boss_Objects[2], &Boss_Objects[1], sizeof(Boss_Objects[2]));
      Boss_Objects[1].Direction = 0;
      Boss_Objects[2].Direction = 2;
      Boss_Objects[3].Is_Alive = 0x80u;
      Boss_Objects[3].view.front = 0x3000;
      Boss_Objects[3].view.top = 0x2000;
      Boss_Objects[3].view.back = 0x2000;
      Boss_Objects[3].view.bottom = 0x2000;
      Boss_Objects[3].Sound_Hit = 52;
      Boss_Objects[3].Hitbox.front = 0x1000;
      Boss_Objects[3].Hitbox.top = 0x1000;
      Boss_Objects[3].Hitbox.back = 0x1000;
      Boss_Objects[3].Hitbox.bottom = 0x1000;
      Boss_Objects[3].Entity_Flags = 8;
      Boss_Objects[3].X_pos = 0x1B4000;
      Boss_Objects[3].Y_pos = 0x20000;
      Boss_Objects[3].Direction = 0;
      qmemcpy(&Boss_Objects[4], &Boss_Objects[3], sizeof(Boss_Objects[4]));
      Boss_Objects[4].Direction = 2;
      Boss_Objects[3].X_pos = 0x1B8000;
      Boss_Objects[5].Is_Alive = 0x80u;
      break;
    case 20:
      Boss_Objects[0].Current_State = 30;
      Boss_Objects[0].Wait_Timer = 0;
      Boss_Objects[0].Ani_Num = 0;
      goto case_30;
    case 30:
case_30:
      Set_Quake(2);
      Boss_Objects[0].Y_pos -= 512;
      if ( !(++Boss_Objects[0].Wait_Timer % 4) )
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      if ( Boss_Objects[0].Wait_Timer == 48 )
      {
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 40;
        if ( Boss_Objects[0].Life <= 280 )
        {
          Boss_Objects[0].Current_State = 110;
          Boss_Objects[0].Entity_Flags |= 0x20u;
          Boss_Objects[0].Entity_Flags &= 0xFFF7u;
          Boss_Objects[3].Entity_Flags &= 0xFFF7u;
          Boss_Objects[4].Entity_Flags &= 0xFFF7u;
          Boss_Objects[3].Current_State = 3;
          Boss_Objects[4].Current_State = 3;
          Boss_Objects[5].Hitbox.top = 0x2000;
        }
      }
      break;
    case 40:
      if ( ++Boss_Objects[0].Wait_Timer == 48 )
      {
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 50;
        Boss_Objects[0].ani_wait = 0;
        Boss_Objects[5].Hitbox.top = 0x2000;
        Play_Sound_Effect(Sfx_Sand_Croc, 1);
      }
      break;
    case 50:
      if ( ++Boss_Objects[0].ani_wait > 2 )
      {
        Boss_Objects[0].ani_wait = 0;
        ++Boss_Objects[0].Ani_Num;
      }
      if ( Boss_Objects[0].Ani_Num == 3 )
      {
        Boss_Objects[0].Current_State = 60;
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Entity_Flags |= 0x20u;
        Boss_Objects[0].Hitbox.front = 0x2000;
        Boss_Objects[0].Hitbox.back = 0x2000;
      }
      break;
    case 60:
      if ( ++Boss_Objects[0].Wait_Timer > 20 && Boss_Objects[0].Wait_Timer < 80 && !(Boss_Objects[0].Wait_Timer % 3) )
      {
        if ( Random(0, 9) >= 8 )
        {
          Child_X_Vel = Random(-256, 256);
          NPC_Create(
            (NPC_Names)48,
            Boss_Objects[0].X_pos,
            Boss_Objects[0].Y_pos - 0x2000,
            Child_X_Vel,
            -819,
            Right,
            NULL,
            256);
        }
        else
        {
          Child_X_Vel = Random(-256, 256);
          NPC_Create(
            (NPC_Names)48,
            Boss_Objects[0].X_pos,
            Boss_Objects[0].Y_pos - 0x2000,
            Child_X_Vel,
            -819,
            0,
            NULL,
            256);
        }
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      if ( Boss_Objects[0].Wait_Timer == 200 || Count_Weapon_Bullets(6) )
      {
        Boss_Objects[0].ani_wait = 0;
        Boss_Objects[0].Current_State = 70;
        Play_Sound_Effect(Sfx_Sand_Croc, 1);
      }
      break;
    case 70:
      if ( ++Boss_Objects[0].ani_wait > 2 )
      {
        Boss_Objects[0].ani_wait = 0;
        --Boss_Objects[0].Ani_Num;
      }
      if ( Boss_Objects[0].Ani_Num == 1 )
        Boss_Objects[0].Damage = 20;
      if ( !Boss_Objects[0].Ani_Num )
      {
        Play_Sound_Effect(Sfx_Sand_Croc, 0);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        Boss_Objects[0].Current_State = 80;
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Entity_Flags &= 0xFFDFu;
        Boss_Objects[0].Hitbox.front = 12288;
        Boss_Objects[0].Hitbox.back = 12288;
        Boss_Objects[5].Hitbox.top = 18432;
        Boss_Objects[0].Damage = 0;
      }
      break;
    case 80:
      if ( ++Boss_Objects[0].Wait_Timer == 48 )
      {
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 90;
      }
      break;
    case 90:
      Set_Quake(2);
      Boss_Objects[0].Y_pos += 512;
      if ( !(++Boss_Objects[0].Wait_Timer % 4) )
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
      if ( Boss_Objects[0].Wait_Timer == 48 )
      {
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 100;
      }
      break;
    case 100:
      if ( ++Boss_Objects[0].Wait_Timer == 120 )
      {
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 30;
        Boss_Objects[0].X_pos = Boss_Objects[0].Curly_Target_X + (Random(-64, 64) << 9);
        Boss_Objects[0].Y_pos = Boss_Objects[0].Curly_Target_Y;
      }
      break;
    case 110:
      if ( ++Boss_Objects[0].ani_wait > 2 )
      {
        Boss_Objects[0].ani_wait = 0;
        ++Boss_Objects[0].Ani_Num;
      }
      if ( Boss_Objects[0].Ani_Num == 3 )
      {
        Boss_Objects[0].Current_State = 120;
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Hitbox.front = 0x2000;
        Boss_Objects[0].Hitbox.back = 0x2000;
      }
      break;
    case 120:
      if ( ++Boss_Objects[0].Wait_Timer == 50 || Count_Weapon_Bullets(6) )
      {
        Boss_Objects[0].Current_State = 130;
        Play_Sound_Effect(Sfx_Sand_Croc, 1);
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].ani_wait = 0;
      }
      if ( Boss_Objects[0].Wait_Timer < 30 && !(Boss_Objects[0].Wait_Timer % 5) )
      {
        Child_X_Vel = Random(-341, 341);
        NPC_Create(
          (NPC_Names)48,
          Boss_Objects[0].X_pos,
          Boss_Objects[0].Y_pos - 0x2000,
          Child_X_Vel,
          -819,
          0,
          NULL,
          256);
        Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
      }
      break;
    case 130:
      if ( ++Boss_Objects[0].ani_wait > 2 )
      {
        Boss_Objects[0].ani_wait = 0;
        --Boss_Objects[0].Ani_Num;
      }
      if ( Boss_Objects[0].Ani_Num == 1 )
        Boss_Objects[0].Damage = 20;
      if ( !Boss_Objects[0].Ani_Num )
      {
        Boss_Objects[0].Current_State = 140;
        Boss_Objects[0].Entity_Flags |= 0x20u;
        Boss_Objects[0].Hitbox.front = 0x2000;
        Boss_Objects[0].Hitbox.back = 0x2000;
        Boss_Objects[0].Y_vel = -1535;
        Play_Sound_Effect(Sfx_Sand_Croc, 0);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        Play_Sound_Effect(Sfx_Silly_Explosion, 1);
        if ( Boss_Objects[0].X_pos < Quote.X_Pos )
          Boss_Objects[0].X_vel = 256;
        if ( Boss_Objects[0].X_pos > Quote.X_Pos )
          Boss_Objects[0].X_vel = -256;
        Boss_Objects[0].Damage = 0;
        Boss_Objects[5].Hitbox.top = 18432;
      }
      break;
    case 140:
      if ( Quote.Collision_Flags & 8 && Boss_Objects[0].Y_vel > 0 )
        Boss_Objects[5].Damage = 20;
      else
        Boss_Objects[5].Damage = 0;
      Boss_Objects[0].Y_vel += 36;
      if ( Boss_Objects[0].Y_vel > 1535 )
        Boss_Objects[0].Y_vel = 1535;
      Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
      Boss_Objects[0].X_pos += Boss_Objects[0].X_vel;
      if ( Boss_Objects[0].Collision_flags & 8 )
      {
        Boss_Objects[0].Current_State = 110;
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].ani_wait = 0;
        Boss_Objects[5].Hitbox.top = 0x2000;
        Boss_Objects[5].Damage = 0;
        Play_Sound_Effect(Sfx_Large_Object_Hit_Ground, 1);
        Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
        Set_Quake(30);
      }
      break;
    case 150:
      Set_Quake(2);
      if ( !(++Boss_Objects[0].Wait_Timer % 12) )
        Play_Sound_Effect(Sfx_Behemoth_Large_Hurt, 1);
      Dust_Y_Pos = Boss_Objects[0].Y_pos + (Random(-48, 24) << 9);
      Dust_X_Pos = Random(-48, 48);
      Create_Dust_Clouds(Boss_Objects[0].X_pos + (Dust_X_Pos << 9), Dust_Y_Pos, 1, 1);
      if ( Boss_Objects[0].Wait_Timer > 100 )
      {
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 160;
        Start_Flash(Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 1);
        Play_Sound_Effect(Sfx_large_Explosion, 1);
      }
      break;
    case 160:
      Set_Quake(40);
      if ( ++Boss_Objects[0].Wait_Timer > 50 )
      {
        Boss_Objects[0].Is_Alive = 0;
        Boss_Objects[1].Is_Alive = 0;
        Boss_Objects[2].Is_Alive = 0;
        Boss_Objects[3].Is_Alive = 0;
        Boss_Objects[4].Is_Alive = 0;
        Boss_Objects[5].Is_Alive = 0;
      }
      break;
    default:
      break;
  }
  Rects[0].left = 0;
  Rects[0].top = 0;
  Rects[0].right = 80;
  Rects[0].bottom = 56;
  Rects[1].left = 80;
  Rects[1].top = 0;
  Rects[1].right = 160;
  Rects[1].bottom = 56;
  Rects[2].left = 160;
  Rects[2].top = 0;
  Rects[2].right = 240;
  Rects[2].bottom = 56;
  Rects[3].left = 80;
  Rects[3].top = 0;
  Rects[3].right = 160;
  Rects[3].bottom = 56;
  Chosen_Rect = &Rects[Boss_Objects[0].Ani_Num];
  Boss_Objects[0].Rect.left = Chosen_Rect->left;
  Boss_Objects[0].Rect.top = Chosen_Rect->top;
  Boss_Objects[0].Rect.right = Chosen_Rect->right;
  Boss_Objects[0].Rect.bottom = Chosen_Rect->bottom;
  Boss_Objects[1].Is_Being_Hit = Boss_Objects[0].Is_Being_Hit;
  Boss_Objects[2].Is_Being_Hit = Boss_Objects[0].Is_Being_Hit;
  Boss_Objects[3].Is_Being_Hit = Boss_Objects[0].Is_Being_Hit;
  Boss_Objects[4].Is_Being_Hit = Boss_Objects[0].Is_Being_Hit;
  Omega_Sub_NPC_1();
  Omega_Sub_NPC_2();
  Omega_Sub_NPC_3();
  if ( !Boss_Objects[0].Life && Boss_Objects[0].Current_State < 150 )// If boss ded
  {
    Boss_Objects[0].Current_State = 150;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[0].Damage = 0;
    Boss_Objects[5].Damage = 0;
    Kill_NPC(48, 1);
  }
}

//----- (0047C380) --------------------------------------------------------
void __cdecl Omega_Sub_NPC_2()
{
  __int64 temp_Y_Pos; // rax@3
  RECT Rect_Right[1]; // [sp+0h] [bp-24h]@1
  int i; // [sp+10h] [bp-14h]@1
  RECT Rect_Left[1]; // [sp+14h] [bp-10h]@1

  Rect_Left[0].left = 80;
  Rect_Left[0].top = 56;
  Rect_Left[0].right = 104;
  Rect_Left[0].bottom = 72;
  Rect_Right[0].left = 104;
  Rect_Right[0].top = 56;
  Rect_Right[0].right = 128;
  Rect_Right[0].bottom = 72;
  for ( i = 1; i < 3; ++i )
  {
    temp_Y_Pos = Boss_Objects[0].Y_pos + Boss_Objects[i + 2].Y_pos - 4096;
    Boss_Objects[i].Y_pos = ((signed int)temp_Y_Pos - HIDWORD(temp_Y_Pos)) >> 1;
    if ( !Boss_Objects[i].Direction )
    {
      Boss_Objects[i].X_pos = Boss_Objects[0].X_pos - 0x2000;
      Boss_Objects[i].Rect = Rect_Left[Boss_Objects[i].Ani_Num];
    }
    else
    {
      Boss_Objects[i].Rect = Rect_Right[Boss_Objects[i].Ani_Num];
      Boss_Objects[i].X_pos = Boss_Objects[0].X_pos + 0x2000;
    }
  }
}

//----- (0047C4E0) --------------------------------------------------------
void __cdecl Omega_Sub_NPC_1()
{
  __int64 v0; // rax@17
  int Boss_Objects_Current_State; // [sp+0h] [bp-48h]@3
  RECT Rects_Right[2]; // [sp+4h] [bp-44h]@1
  int i; // [sp+24h] [bp-24h]@1
  RECT Rects_Left[2]; // [sp+28h] [bp-20h]@1

  Rects_Left[0].left = 0;
  Rects_Left[0].top = 56;
  Rects_Left[0].right = 40;
  Rects_Left[0].bottom = 88;
  Rects_Left[1].left = 40;
  Rects_Left[1].top = 56;
  Rects_Left[1].right = 80;
  Rects_Left[1].bottom = 88;
  Rects_Right[0].left = 0;
  Rects_Right[0].top = 88;
  Rects_Right[0].right = 40;
  Rects_Right[0].bottom = 120;
  Rects_Right[1].left = 40;
  Rects_Right[1].top = 88;
  Rects_Right[1].right = 80;
  Rects_Right[1].bottom = 120;
  for ( i = 3; i < 5; ++i )
  {
    Boss_Objects_Current_State = Boss_Objects[i].Current_State;
    if ( !Boss_Objects_Current_State )
    {
      Boss_Objects[i].Current_State = 1;
    }
    else if ( Boss_Objects_Current_State != 1 )
    {
      if ( Boss_Objects_Current_State == 3 )
      {
        Boss_Objects[i].Curly_Target_Y = Boss_Objects[0].Y_pos + 12288;
        if ( i == 3 )
          Boss_Objects[3].X_pos = Boss_Objects[0].X_pos - 0x2000;
        if ( i == 4 )
          Boss_Objects[4].X_pos = Boss_Objects[0].X_pos + 0x2000;
        v0 = Boss_Objects[i].Curly_Target_Y - Boss_Objects[i].Y_pos;
        Boss_Objects[i].Y_pos += ((signed int)v0 - HIDWORD(v0)) >> 1;
      }
      goto LABEL_18;
    }
    // Boss_Objects_Current_State == 1
    Boss_Objects[i].Y_pos = Boss_Objects[0].Y_pos;
    if ( i == 3 )
      Boss_Objects[3].X_pos = Boss_Objects[0].X_pos - 0x2000;
    if ( i == 4 )
      Boss_Objects[4].X_pos = Boss_Objects[0].X_pos + 0x2000;
LABEL_18:
    Boss_Objects[i].Ani_Num = !(Boss_Objects[i].Collision_flags & 8)
                           && Boss_Objects[i].Y_pos > Boss_Objects[i].Curly_Target_Y;
    if ( !Boss_Objects[i].Direction )
      Boss_Objects[i].Rect = Rects_Left[Boss_Objects[i].Ani_Num];
    else
      Boss_Objects[i].Rect = Rects_Right[Boss_Objects[i].Ani_Num];
  }
}

//----- (0047C7A0) --------------------------------------------------------
void __cdecl Omega_Sub_NPC_3()
{
  if ( !Boss_Objects[5].Current_State )
  {
    Boss_Objects[5].Entity_Flags |= 9u;
    Boss_Objects[5].Hitbox.front = 10240;
    Boss_Objects[5].Hitbox.top = 18432;
    Boss_Objects[5].Hitbox.back = 10240;
    Boss_Objects[5].Hitbox.bottom = 0x2000;
    Boss_Objects[5].Current_State = 1;
    goto Current_State_1;
  }
  if ( Boss_Objects[5].Current_State == 1 )
  {
Current_State_1:
    Boss_Objects[5].X_pos = Boss_Objects[0].X_pos;
    Boss_Objects[5].Y_pos = Boss_Objects[0].Y_pos;
  }
}

//----- (0047C820) --------------------------------------------------------
RECT *Boss_8_Heavy_Press()
{
  int v0; // ST14_4@17
  int v1; // eax@17
  int v2; // eax@23
  int v3; // ST14_4@42
  int v4; // eax@42
  int *v5; // edx@59
  RECT *result; // eax@59
  int *v7; // edx@60
  int *v8; // edx@62
  int v9; // [sp+0h] [bp-70h]@1
  signed int i; // [sp+8h] [bp-68h]@21
  signed int k; // [sp+8h] [bp-68h]@28
  signed int j; // [sp+8h] [bp-68h]@52
  int v13; // [sp+10h] [bp-60h]@57
  int v14; // [sp+14h] [bp-5Ch]@57
  int v15; // [sp+18h] [bp-58h]@57
  int v16; // [sp+1Ch] [bp-54h]@57
  int v17; // [sp+20h] [bp-50h]@57
  int v18; // [sp+24h] [bp-4Ch]@57
  int v19; // [sp+28h] [bp-48h]@57
  int v20; // [sp+2Ch] [bp-44h]@57
  int v21; // [sp+30h] [bp-40h]@57
  int v22; // [sp+34h] [bp-3Ch]@57
  int v23; // [sp+38h] [bp-38h]@57
  int v24; // [sp+3Ch] [bp-34h]@57
  int v25; // [sp+40h] [bp-30h]@57
  int v26; // [sp+44h] [bp-2Ch]@57
  int v27; // [sp+48h] [bp-28h]@57
  int v28; // [sp+4Ch] [bp-24h]@57
  int v29; // [sp+50h] [bp-20h]@57
  int v30; // [sp+54h] [bp-1Ch]@57
  int v31; // [sp+58h] [bp-18h]@57
  int v32; // [sp+5Ch] [bp-14h]@57
  int v33; // [sp+60h] [bp-10h]@57
  int v34; // [sp+64h] [bp-Ch]@57
  int v35; // [sp+68h] [bp-8h]@57
  int v36; // [sp+6Ch] [bp-4h]@57

  v9 = Boss_Objects[0].Current_State;
  if ( v9 <= 31 )
  {
    if ( v9 == 31 )
    {
LABEL_20:
      Boss_Objects[0].Y_pos += 2048;
      if ( Boss_Objects[0].Y_pos >= 211456 )
      {
        Boss_Objects[0].Y_pos = 211456;
        Boss_Objects[0].Ani_Num = 0;
        Boss_Objects[0].Current_State = 20;
        Play_Sound_Effect(Sfx_Missile_Impact, 1);
        for ( i = 0; i < 5; ++i )
        {
          v2 = Random(-40, 40);
          NPC_Create(Smoke, Boss_Objects[0].X_pos + (v2 << 9), Boss_Objects[0].Y_pos + 30720, 0, 0, 0, NULL, 256);
        }
      }
    }
    else
    {
      switch ( v9 )
      {
        case 0:
          Boss_Objects[0].Current_State = 10;
          Boss_Objects[0].Is_Alive = -128;
          Boss_Objects[0].EXP_Amount = 1;
          Boss_Objects[0].Direction = 2;
          Boss_Objects[0].X_pos = 0;
          Boss_Objects[0].Y_pos = 0;
          Boss_Objects[0].view.front = 20480;
          Boss_Objects[0].view.top = 30720;
          Boss_Objects[0].view.back = 20480;
          Boss_Objects[0].view.bottom = 30720;
          Boss_Objects[0].Sound_Hit = 54;
          Boss_Objects[0].Hitbox.front = 25088;
          Boss_Objects[0].Hitbox.top = 30720;
          Boss_Objects[0].Hitbox.back = 20480;
          Boss_Objects[0].Hitbox.bottom = 24576;
          Boss_Objects[0].Entity_Flags = -32184;
          Boss_Objects[0].Explosion_Size = 3;
          Boss_Objects[0].Damage = 10;
          Boss_Objects[0].Entity_Eve_Num = 1000;
          Boss_Objects[0].Life = 700;
          goto LABEL_57;
        case 5:
          Boss_Objects[0].Current_State = 6;
          Boss_Objects[0].X_pos = 0;
          Boss_Objects[0].Y_pos = 0;
          Boss_Objects[1].Is_Alive = 0;
          Boss_Objects[2].Is_Alive = 0;
          goto LABEL_57;
        case 10:
          Boss_Objects[0].Current_State = 11;
          Boss_Objects[0].X_pos = 81920;
          Boss_Objects[0].Y_pos = 37888;
          goto LABEL_57;
        case 20:
          Boss_Objects[0].Damage = 0;
          Boss_Objects[0].Current_State = 21;
          Boss_Objects[0].X_pos = 81920;
          Boss_Objects[0].Y_pos = 211456;
          Boss_Objects[0].Entity_Flags &= 0xFFBFu;
          Boss_Objects[1].Is_Alive = 0;
          Boss_Objects[2].Is_Alive = 0;
          goto LABEL_16;
        case 21:
LABEL_16:
          if ( !(++Boss_Objects[0].Wait_Timer % 16) )
          {
            v0 = Boss_Objects[0].Y_pos + (Random(-60, 60) << 9);
            v1 = Random(-40, 40);
            Create_Dust_Clouds(Boss_Objects[0].X_pos + (v1 << 9), v0, 1, 1);
          }
          break;
        case 30:
          Boss_Objects[0].Current_State = 31;
          Boss_Objects[0].Ani_Num = 2;
          Boss_Objects[0].X_pos = 81920;
          Boss_Objects[0].Y_pos = 0x8000;
          goto LABEL_20;
        default:
          goto LABEL_57;
      }
    }
    goto LABEL_57;
  }
  if ( v9 > 500 )
  {
    if ( v9 != 501 )
    {
      if ( v9 == 510 )
      {
        Boss_Objects[0].Y_vel += 64;
        Boss_Objects[0].Damage = 127;
        Boss_Objects[0].Y_pos += Boss_Objects[0].Y_vel;
        if ( !Boss_Objects[0].count1 && Boss_Objects[0].Y_pos > 81920 )
        {
          Boss_Objects[0].count1 = 1;
          Boss_Objects[0].Y_vel = -512;
          Boss_Objects[0].Damage = 0;
          for ( j = 0; j < 7; ++j )
          {
            Change_Map_Parts(j + 7, 14, 0);
            Create_Dust_Clouds((j + 7) << 13, 114688, 0, 0);
            Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
          }
        }
        if ( Boss_Objects[0].Y_pos > 245760 )
          Boss_Objects[0].Current_State = 520;
      }
      goto LABEL_57;
    }
LABEL_41:
    if ( !(++Boss_Objects[0].Wait_Timer % 16) )
    {
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
      v3 = Boss_Objects[0].Y_pos + (Random(-60, 60) << 9);
      v4 = Random(-40, 40);
      Create_Dust_Clouds(Boss_Objects[0].X_pos + (v4 << 9), v3, 1, 1);
    }
    if ( Boss_Objects[0].Wait_Timer == 95 )
      Boss_Objects[0].Ani_Num = 1;
    if ( Boss_Objects[0].Wait_Timer == 98 )
      Boss_Objects[0].Ani_Num = 2;
    if ( Boss_Objects[0].Wait_Timer > 100 )
      Boss_Objects[0].Current_State = 510;
    goto LABEL_57;
  }
  if ( v9 == 500 )
  {
    Boss_Objects[3].Entity_Flags &= 0xFFDFu;
    Boss_Objects[0].Current_State = 501;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[0].count1 = 0;
    Kill_NPC(325, 1);
    Kill_NPC(330, 1);
    goto LABEL_41;
  }
  if ( v9 == 100 )
  {
    Boss_Objects[0].Current_State = 101;
    Boss_Objects[0].count2 = 9;
    Boss_Objects[0].Wait_Timer = -100;
    Boss_Objects[1].Is_Alive = -128;
    Boss_Objects[1].Hitbox.front = 7168;
    Boss_Objects[1].Hitbox.back = 7168;
    Boss_Objects[1].Hitbox.top = 4096;
    Boss_Objects[1].Hitbox.bottom = 4096;
    Boss_Objects[1].Entity_Flags = 12;
    qmemcpy(&Boss_Objects[2], &Boss_Objects[1], sizeof(Boss_Objects[2]));
    Boss_Objects[3].Is_Alive = -112;
    Boss_Objects[3].Entity_Flags |= 0x20u;
    Boss_Objects[3].Hitbox.front = 3072;
    Boss_Objects[3].Hitbox.back = 3072;
    Boss_Objects[3].Hitbox.top = 4096;
    Boss_Objects[3].Hitbox.bottom = 4096;
    NPC_Create((NPC_Names)325, Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos + 30720, 0, 0, 0, NULL, 256);
  }
  else if ( v9 != 101 )
  {
    goto LABEL_57;
  }
  if ( Boss_Objects[0].count2 > 1 && Boss_Objects[0].Life < 70 * Boss_Objects[0].count2 )
  {
    --Boss_Objects[0].count2;
    for ( k = 0; k < 5; ++k )
    {
      Change_Map_Parts(k + 8, Boss_Objects[0].count2, 0);
      Create_Dust_Clouds((k + 8) << 13, Boss_Objects[0].count2 << 13, 0, 4);
      Play_Sound_Effect(Sfx_Destroy_Breakable_Block, 1);
    }
  }
  if ( ++Boss_Objects[0].Wait_Timer == 81 || Boss_Objects[0].Wait_Timer == 241 )
    NPC_Create((NPC_Names)323, 24576, 122880, 0, 0, Up, NULL, 256);
  if ( Boss_Objects[0].Wait_Timer == 1 || Boss_Objects[0].Wait_Timer == 161 )
    NPC_Create((NPC_Names)323, 139264, 122880, 0, 0, Up, NULL, 256);
  if ( Boss_Objects[0].Wait_Timer >= 300 )
  {
    Boss_Objects[0].Wait_Timer = 0;
    NPC_Create((NPC_Names)325, Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos + 30720, 0, 0, 0, NULL, 256);
  }
LABEL_57:
  Boss_Objects[1].X_pos = Boss_Objects[0].X_pos - 12288;
  Boss_Objects[1].Y_pos = Boss_Objects[0].Y_pos + 26624;
  Boss_Objects[2].X_pos = Boss_Objects[0].X_pos + 12288;
  Boss_Objects[2].Y_pos = Boss_Objects[0].Y_pos + 26624;
  Boss_Objects[3].X_pos = Boss_Objects[0].X_pos;
  Boss_Objects[3].Y_pos = Boss_Objects[0].Y_pos + 20480;
  v13 = 0;
  v14 = 0;
  v15 = 80;
  v16 = 120;
  v17 = 80;
  v18 = 0;
  v19 = 160;
  v20 = 120;
  v21 = 160;
  v22 = 0;
  v23 = 240;
  v24 = 120;
  v25 = 0;
  v26 = 120;
  v27 = 80;
  v28 = 240;
  v29 = 80;
  v30 = 120;
  v31 = 160;
  v32 = 240;
  v33 = 160;
  v34 = 120;
  v35 = 240;
  v36 = 240;
  if ( Boss_Objects[0].Is_Being_Hit )
  {
    if ( ((signed int)(unsigned __int8)++byte_4BC7C8 >> 1) % 2 )
    {
      v5 = &v13 + 4 * Boss_Objects[0].Ani_Num;
      result = &Boss_Objects[0].Rect;
      result->left = *v5;
      result->top = v5[1];
      result->right = v5[2];
      result->bottom = v5[3];
    }
    else
    {
      v7 = &v25 + 4 * Boss_Objects[0].Ani_Num;
      result = &Boss_Objects[0].Rect;
      result->left = *v7;
      result->top = v7[1];
      result->right = v7[2];
      result->bottom = v7[3];
    }
  }
  else
  {
    v8 = &v13 + 4 * Boss_Objects[0].Ani_Num;
    result = &Boss_Objects[0].Rect;
    result->left = *v8;
    result->top = v8[1];
    result->right = v8[2];
    result->bottom = v8[3];
  }
  return result;
}
// 4BC7C8: using guessed type char byte_4BC7C8;

//----- (0047D170) --------------------------------------------------------
int Boss_6_Dragon_Sisters()
{
  int v0; // ST08_4@67
  int v1; // eax@67
  char *v2; // edx@83
  int result; // eax@83
  int v4; // [sp+0h] [bp-18h]@1

  v4 = Boss_Objects[0].Current_State;
  if ( v4 > 401 )
  {
    switch ( v4 )
    {
      case 1000:
        Boss_Objects[0].Current_State = 1001;
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[2].Current_State = 1000;
        Boss_Objects[3].Current_State = 1000;
        Boss_Objects[4].Current_State = 1000;
        Boss_Objects[5].Current_State = 1000;
        Create_Dust_Clouds(Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, Boss_Objects[0].view.back, 40);
        goto LABEL_65;
      case 1001:
LABEL_65:
        if ( ++Boss_Objects[0].Wait_Timer > 100 )
          Boss_Objects[0].Current_State = 1010;
        v0 = Boss_Objects[0].Y_pos + (Random(-70, 70) << 9);
        v1 = Random(-128, 128);
        NPC_Create(Smoke, Boss_Objects[0].X_pos + (v1 << 9), v0, 0, 0, 0, NULL, 256);
        break;
      case 1010:
        Boss_Objects[0].count1 += 4;
        if ( Boss_Objects[0].count1 > 1023 )
          Boss_Objects[0].count1 -= 1024;
        if ( Boss_Objects[0].Curly_Target_X > 8 )
          --Boss_Objects[0].Curly_Target_X;
        if ( Boss_Objects[0].Curly_Target_Y > 0 )
          --Boss_Objects[0].Curly_Target_Y;
        if ( Boss_Objects[0].Curly_Target_X < -8 )
          ++Boss_Objects[0].Curly_Target_X;
        if ( Boss_Objects[0].Curly_Target_Y < 0 )
          ++Boss_Objects[0].Curly_Target_Y;
        if ( !Boss_Objects[0].Curly_Target_Y )
        {
          Boss_Objects[0].Current_State = 1020;
          Boss_Objects[0].Wait_Timer = 0;
          Start_Flash(Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 1);
          Play_Sound_Effect(Sfx_large_Explosion, 1);
        }
        break;
      case 1020:
        if ( ++Boss_Objects[0].Wait_Timer > 50 )
        {
          Kill_NPC(211, 1);
          Boss_Objects[0].Is_Alive = 0;
          Boss_Objects[1].Is_Alive = 0;
          Boss_Objects[2].Is_Alive = 0;
          Boss_Objects[3].Is_Alive = 0;
          Boss_Objects[4].Is_Alive = 0;
          Boss_Objects[5].Is_Alive = 0;
          Boss_Objects[0].Current_State = 0;
        }
        break;
      default:
        break;
    }
  }
  else if ( v4 == 401 )
  {
    if ( ++Boss_Objects[0].Wait_Timer >= 100 )
    {
      if ( Boss_Objects[0].Wait_Timer >= 120 )
      {
        if ( Boss_Objects[0].Wait_Timer >= 500 )
        {
          if ( Boss_Objects[0].Wait_Timer >= 540 )
          {
            if ( Boss_Objects[0].Wait_Timer >= 560 )
            {
              Boss_Objects[0].Current_State = 100;
              Boss_Objects[0].Wait_Timer = 0;
              Boss_Objects[2].Current_State = 100;
              Boss_Objects[4].Current_State = 100;
              goto Return;
            }
            ++Boss_Objects[0].count1;
          }
          else
          {
            Boss_Objects[0].count1 += 2;
          }
        }
        else
        {
          Boss_Objects[0].count1 += 4;
        }
      }
      else
      {
        Boss_Objects[0].count1 += 2;
      }
    }
    else
    {
      ++Boss_Objects[0].count1;
    }
    if ( Boss_Objects[0].count1 > 1023 )
      Boss_Objects[0].count1 -= 1024;
  }
  else if ( v4 > 100 )
  {
    if ( v4 == 110 )
    {
      if ( ++Boss_Objects[0].Wait_Timer >= 20 )
      {
        if ( Boss_Objects[0].Wait_Timer >= 60 )
        {
          if ( Boss_Objects[0].Wait_Timer >= Boss_Objects[0].count2 )
          {
            if ( Boss_Objects[0].Wait_Timer >= Boss_Objects[0].count2 + 40 )
            {
              if ( Boss_Objects[0].Wait_Timer >= Boss_Objects[0].count2 + 60 )
              {
                if ( Boss_Objects[0].Life >= 300 )
                {
                  Boss_Objects[0].Wait_Timer = 0;
                  Boss_Objects[0].Current_State = 100;
                  Boss_Objects[0].count2 = Random(400, 700);
                }
                else
                {
                  Boss_Objects[0].Wait_Timer = 0;
                  Boss_Objects[0].Current_State = 400;
                  Boss_Objects[2].Current_State = 400;
                  Boss_Objects[4].Current_State = 400;
                }
                goto Return;
              }
              --Boss_Objects[0].count1;
            }
            else
            {
              Boss_Objects[0].count1 -= 2;
            }
          }
          else
          {
            Boss_Objects[0].count1 -= 4;
          }
        }
        else
        {
          Boss_Objects[0].count1 -= 2;
        }
      }
      else
      {
        --Boss_Objects[0].count1;
      }
      if ( Boss_Objects[0].count1 <= 0 )
        Boss_Objects[0].count1 += 1024;
    }
    else if ( v4 == 400 && ++Boss_Objects[0].Wait_Timer > 100 )
    {
      Boss_Objects[0].Wait_Timer = 0;
      Boss_Objects[0].Current_State = 401;
    }
  }
  else if ( v4 == 100 )
  {
    if ( ++Boss_Objects[0].Wait_Timer >= 100 )
    {
      if ( Boss_Objects[0].Wait_Timer >= 120 )
      {
        if ( Boss_Objects[0].Wait_Timer >= Boss_Objects[0].count2 )
        {
          if ( Boss_Objects[0].Wait_Timer >= Boss_Objects[0].count2 + 40 )
          {
            if ( Boss_Objects[0].Wait_Timer >= Boss_Objects[0].count2 + 60 )
            {
              Boss_Objects[0].Wait_Timer = 0;
              Boss_Objects[0].Current_State = 110;
              Boss_Objects[0].count2 = Random(400, 700);
              goto Return;
            }
            ++Boss_Objects[0].count1;
          }
          else
          {
            Boss_Objects[0].count1 += 2;
          }
        }
        else
        {
          Boss_Objects[0].count1 += 4;
        }
      }
      else
      {
        Boss_Objects[0].count1 += 2;
      }
    }
    else
    {
      ++Boss_Objects[0].count1;
    }
    if ( Boss_Objects[0].count1 > 1023 )
      Boss_Objects[0].count1 -= 1024;
  }
  else if ( v4 )
  {
    if ( v4 == 20 && --Boss_Objects[0].Curly_Target_X <= 112 )
    {
      Boss_Objects[0].Current_State = 100;
      Boss_Objects[0].Wait_Timer = 0;
      Boss_Objects[2].Current_State = 100;
      Boss_Objects[4].Current_State = 100;
      Boss_Objects[3].Current_State = 100;
      Boss_Objects[5].Current_State = 100;
    }
  }
  else
  {
    Boss_Objects[0].Is_Alive = -128;
    Boss_Objects[0].Direction = 0;
    Boss_Objects[0].Current_State = 10;
    Boss_Objects[0].EXP_Amount = 0;
    Boss_Objects[0].X_pos = 81920;
    Boss_Objects[0].Y_pos = 0x10000;
    Boss_Objects[0].view.front = 4096;
    Boss_Objects[0].view.top = 4096;
    Boss_Objects[0].view.back = 0x10000;
    Boss_Objects[0].view.bottom = 4096;
    Boss_Objects[0].Sound_Hit = 54;
    Boss_Objects[0].Hitbox.front = 4096;
    Boss_Objects[0].Hitbox.top = 4096;
    Boss_Objects[0].Hitbox.back = 4096;
    Boss_Objects[0].Hitbox.bottom = 4096;
    Boss_Objects[0].Entity_Flags = 8;
    Boss_Objects[0].Entity_Flags |= 0x200u;
    Boss_Objects[0].Explosion_Size = 3;
    Boss_Objects[0].Damage = 0;
    Boss_Objects[0].Entity_Eve_Num = 1000;
    Boss_Objects[0].Life = 500;
    Boss_Objects[0].count2 = Random(700, 1200);
    Boss_Objects[0].Curly_Target_X = 180;
    Boss_Objects[0].Curly_Target_Y = 61;
    Boss_Objects[2].view.back = 10240;
    Boss_Objects[2].view.front = 10240;
    Boss_Objects[2].view.top = 0x2000;
    Boss_Objects[2].view.bottom = 0x2000;
    Boss_Objects[2].Hitbox.back = 6144;
    Boss_Objects[2].Hitbox.front = 6144;
    Boss_Objects[2].Hitbox.top = 5120;
    Boss_Objects[2].Hitbox.bottom = 5120;
    Boss_Objects[2].Entity_Flags = 12;
    Boss_Objects[2].Parent_NPC = &Boss_Objects[3];
    Boss_Objects[2].Is_Alive = -112;
    Boss_Objects[2].Damage = 10;
    Boss_Objects[3].Is_Alive = -128;
    Boss_Objects[3].view.back = 10240;
    Boss_Objects[3].view.front = 10240;
    Boss_Objects[3].view.top = 10240;
    Boss_Objects[3].view.bottom = 10240;
    Boss_Objects[3].Hitbox.back = 6144;
    Boss_Objects[3].Hitbox.front = 6144;
    Boss_Objects[3].Hitbox.top = 1024;
    Boss_Objects[3].Hitbox.bottom = 0x2000;
    Boss_Objects[3].Entity_Flags = 8;
    Boss_Objects[3].Parent_NPC = Boss_Objects;
    Boss_Objects[3].Damage = 10;
    qmemcpy(&Boss_Objects[4], &Boss_Objects[2], sizeof(Boss_Objects[4]));
    Boss_Objects[4].Parent_NPC = &Boss_Objects[5];
    qmemcpy(&Boss_Objects[5], &Boss_Objects[3], sizeof(Boss_Objects[5]));
    Boss_Objects[5].count1 = 128;
  }
Return:
  Sisters_Sub_NPC_Dragon_Head((int)&Boss_Objects[2]);
  Sisters_Sub_NPC_Dragon_Body((int)&Boss_Objects[3]);
  Sisters_Sub_NPC_Dragon_Head((int)&Boss_Objects[4]);
  Sisters_Sub_NPC_Dragon_Body((int)&Boss_Objects[5]);
  v2 = (char *)&Boss_Objects[0].Rect;
  *(_DWORD *)v2 = 0;
  *((_DWORD *)v2 + 1) = 0;
  result = 0;
  *((_DWORD *)v2 + 2) = 0;
  *((_DWORD *)v2 + 3) = 0;
  return result;
}

//----- (0047DAA0) --------------------------------------------------------
int __cdecl Sisters_Sub_NPC_Dragon_Body(int a1)
{
  __int64 v1; // rax@9
  int v2; // esi@9
  int v3; // esi@9
  __int64 v4; // rax@14
  int v5; // esi@14
  int v6; // esi@14
  __int64 v7; // rax@14
  __int64 v8; // rax@14
  __int64 v9; // rax@19
  int v10; // esi@19
  int v11; // esi@19
  __int64 v12; // rax@19
  __int64 v13; // rax@19
  int *v14; // eax@27
  int v15; // ecx@27
  int result; // eax@27
  int *v17; // eax@28
  int v18; // ecx@28
  signed int v19; // [sp+0h] [bp-68h]@1
  int v20; // [sp+4h] [bp-64h]@1
  int v21; // [sp+8h] [bp-60h]@1
  int v22; // [sp+Ch] [bp-5Ch]@1
  int v23; // [sp+10h] [bp-58h]@1
  int v24; // [sp+14h] [bp-54h]@1
  int v25; // [sp+18h] [bp-50h]@1
  int v26; // [sp+1Ch] [bp-4Ch]@1
  int v27; // [sp+20h] [bp-48h]@1
  int v28; // [sp+24h] [bp-44h]@1
  int v29; // [sp+28h] [bp-40h]@1
  int v30; // [sp+2Ch] [bp-3Ch]@1
  int v31; // [sp+30h] [bp-38h]@1
  int v32; // [sp+34h] [bp-34h]@1
  int v33; // [sp+38h] [bp-30h]@1
  int v34; // [sp+3Ch] [bp-2Ch]@1
  int v35; // [sp+40h] [bp-28h]@1
  int v36; // [sp+44h] [bp-24h]@1
  int v37; // [sp+48h] [bp-20h]@1
  int v38; // [sp+4Ch] [bp-1Ch]@1
  int v39; // [sp+50h] [bp-18h]@1
  int v40; // [sp+54h] [bp-14h]@1
  int v41; // [sp+58h] [bp-10h]@1
  int v42; // [sp+5Ch] [bp-Ch]@1
  int v43; // [sp+60h] [bp-8h]@1
  unsigned __int8 v44; // [sp+67h] [bp-1h]@9

  v32 = 0;
  v33 = 0;
  v34 = 40;
  v35 = 40;
  v36 = 40;
  v37 = 0;
  v38 = 80;
  v39 = 40;
  v40 = 80;
  v41 = 0;
  v42 = 120;
  v43 = 40;
  v20 = 0;
  v21 = 40;
  v22 = 40;
  v23 = 80;
  v24 = 40;
  v25 = 40;
  v26 = 80;
  v27 = 80;
  v28 = 80;
  v29 = 40;
  v30 = 120;
  v31 = 80;
  v19 = *(_DWORD *)(a1 + 116);
  if ( v19 > 100 )
  {
    if ( v19 == 1000 )
    {
      *(_DWORD *)(a1 + 116) = 1001;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
    }
    else if ( v19 != 1001 )
    {
      goto LABEL_22;
    }
    v9 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 108);
    v44 = *(_BYTE *)(a1 + 108) + (((BYTE4(v9) & 3) + (signed int)v9) >> 2);
    v10 = *(_DWORD *)(a1 + 168);
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(v10 + 8) + *(_DWORD *)(*(_DWORD *)(a1 + 168) + 32) * GetCos(v44);
    v11 = *(_DWORD *)(a1 + 168);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(v11 + 12) + *(_DWORD *)(*(_DWORD *)(a1 + 168) + 36) * GetSin(v44);
    v12 = *(_DWORD *)(a1 + 32) - *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 8) += ((BYTE4(v12) & 7) + (signed int)v12) >> 3;
    v13 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 12) += ((BYTE4(v13) & 7) + (signed int)v13) >> 3;
    if ( *(_DWORD *)(a1 + 8) <= *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
  else if ( v19 == 100 )
  {
    v4 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 108);
    v44 = *(_BYTE *)(a1 + 108) + (((BYTE4(v4) & 3) + (signed int)v4) >> 2);
    v5 = *(_DWORD *)(a1 + 168);
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(v5 + 8) + *(_DWORD *)(*(_DWORD *)(a1 + 168) + 32) * GetCos(v44);
    v6 = *(_DWORD *)(a1 + 168);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(v6 + 12) + *(_DWORD *)(*(_DWORD *)(a1 + 168) + 36) * GetSin(v44);
    v7 = *(_DWORD *)(a1 + 32) - *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 8) += ((BYTE4(v7) & 7) + (signed int)v7) >> 3;
    v8 = *(_DWORD *)(a1 + 36) - *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 12) += ((BYTE4(v8) & 7) + (signed int)v8) >> 3;
    if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
  else
  {
    if ( v19 )
    {
      if ( v19 != 10 )
        goto LABEL_22;
    }
    else
    {
      v1 = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 108);
      v44 = *(_BYTE *)(a1 + 108) + (((BYTE4(v1) & 3) + (signed int)v1) >> 2);
      *(_DWORD *)(a1 + 116) = 10;
      v2 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(*(_DWORD *)(a1 + 168) + 32) * GetCos(v44) + *(_DWORD *)(v2 + 8);
      v3 = *(_DWORD *)(a1 + 168);
      *(_DWORD *)(a1 + 12) += *(_DWORD *)(*(_DWORD *)(a1 + 168) + 36) * GetSin(v44) + *(_DWORD *)(v3 + 12);
    }
    if ( *(_DWORD *)(a1 + 8) <= Quote.X_Pos )
      *(_DWORD *)(a1 + 76) = 2;
    else
      *(_DWORD *)(a1 + 76) = 0;
  }
LABEL_22:
  if ( ++*(_DWORD *)(a1 + 100) > 2 )
  {
    *(_DWORD *)(a1 + 100) = 0;
    ++*(_DWORD *)(a1 + 104);
  }
  if ( *(_DWORD *)(a1 + 104) > 2 )
    *(_DWORD *)(a1 + 104) = 0;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v17 = &v20 + 4 * *(_DWORD *)(a1 + 104);
    v18 = a1 + 84;
    *(_DWORD *)v18 = *v17;
    *(_DWORD *)(v18 + 4) = v17[1];
    *(_DWORD *)(v18 + 8) = v17[2];
    result = v17[3];
    *(_DWORD *)(v18 + 12) = result;
  }
  else
  {
    v14 = &v32 + 4 * *(_DWORD *)(a1 + 104);
    v15 = a1 + 84;
    *(_DWORD *)v15 = *v14;
    *(_DWORD *)(v15 + 4) = v14[1];
    *(_DWORD *)(v15 + 8) = v14[2];
    result = v14[3];
    *(_DWORD *)(v15 + 12) = result;
  }
  return result;
}

//----- (0047DF10) --------------------------------------------------------
int __cdecl Sisters_Sub_NPC_Dragon_Head(int a1)
{
  int *v1; // edx@57
  int result; // eax@57
  int *v3; // edx@58
  signed int v4; // [sp+0h] [bp-98h]@1
  int Y_Vel; // [sp+4h] [bp-94h]@30
  int Y_Vela; // [sp+4h] [bp-94h]@47
  int v7; // [sp+8h] [bp-90h]@1
  int v8; // [sp+Ch] [bp-8Ch]@1
  int v9; // [sp+10h] [bp-88h]@1
  int v10; // [sp+14h] [bp-84h]@1
  int v11; // [sp+18h] [bp-80h]@1
  int v12; // [sp+1Ch] [bp-7Ch]@1
  int v13; // [sp+20h] [bp-78h]@1
  int v14; // [sp+24h] [bp-74h]@1
  int v15; // [sp+28h] [bp-70h]@1
  int v16; // [sp+2Ch] [bp-6Ch]@1
  int v17; // [sp+30h] [bp-68h]@1
  int v18; // [sp+34h] [bp-64h]@1
  int v19; // [sp+38h] [bp-60h]@1
  int v20; // [sp+3Ch] [bp-5Ch]@1
  int v21; // [sp+40h] [bp-58h]@1
  int v22; // [sp+44h] [bp-54h]@1
  int X_Vel; // [sp+4Ch] [bp-4Ch]@30
  int v24; // [sp+50h] [bp-48h]@1
  int v25; // [sp+54h] [bp-44h]@1
  int v26; // [sp+58h] [bp-40h]@1
  int v27; // [sp+5Ch] [bp-3Ch]@1
  int v28; // [sp+60h] [bp-38h]@1
  int v29; // [sp+64h] [bp-34h]@1
  int v30; // [sp+68h] [bp-30h]@1
  int v31; // [sp+6Ch] [bp-2Ch]@1
  int v32; // [sp+70h] [bp-28h]@1
  int v33; // [sp+74h] [bp-24h]@1
  int v34; // [sp+78h] [bp-20h]@1
  int v35; // [sp+7Ch] [bp-1Ch]@1
  int v36; // [sp+80h] [bp-18h]@1
  int v37; // [sp+84h] [bp-14h]@1
  int v38; // [sp+88h] [bp-10h]@1
  int v39; // [sp+8Ch] [bp-Ch]@1
  unsigned __int8 v40; // [sp+97h] [bp-1h]@30

  v24 = 0;
  v25 = 80;
  v26 = 40;
  v27 = 112;
  v28 = 40;
  v29 = 80;
  v30 = 80;
  v31 = 112;
  v32 = 80;
  v33 = 80;
  v34 = 120;
  v35 = 112;
  v36 = 120;
  v37 = 80;
  v38 = 160;
  v39 = 112;
  v7 = 0;
  v8 = 112;
  v9 = 40;
  v10 = 144;
  v11 = 40;
  v12 = 112;
  v13 = 80;
  v14 = 144;
  v15 = 80;
  v16 = 112;
  v17 = 120;
  v18 = 144;
  v19 = 120;
  v20 = 112;
  v21 = 160;
  v22 = 144;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 <= 220 )
  {
    if ( v4 == 220 )
    {
      if ( ++*(_DWORD *)(a1 + 120) % 8 == 1 )
      {
        v40 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
        v40 += Random(-6, 6);
        Y_Vel = GetSin(v40);
        X_Vel = GetCos(v40);
        if ( *(_DWORD *)(a1 + 76) )
          NPC_Create((NPC_Names)202, *(_DWORD *)(a1 + 8) + 4096, *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
        else
          NPC_Create((NPC_Names)202, *(_DWORD *)(a1 + 8) - 4096, *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Fireball_Shoot, 1);
      }
      if ( *(_DWORD *)(a1 + 120) > 50 )
        *(_DWORD *)(a1 + 116) = 200;
    }
    else
    {
      switch ( v4 )
      {
        case 0:
          *(_DWORD *)(a1 + 116) = 1;
          goto LABEL_53;
        case 100:
          *(_DWORD *)(a1 + 116) = 200;
          goto LABEL_13;
        case 200:
LABEL_13:
          *(_WORD *)(a1 + 80) &= 0xFFDFu;
          *(_DWORD *)(a1 + 104) = 0;
          *(_DWORD *)(a1 + 124) = 0x2000;
          *(_DWORD *)(a1 + 116) = 201;
          *(_DWORD *)(a1 + 108) = Random(100, 200);
          goto LABEL_14;
        case 201:
LABEL_14:
          if ( *(_DWORD *)(a1 + 108) )
          {
            --*(_DWORD *)(a1 + 108);
          }
          else
          {
            *(_DWORD *)(a1 + 116) = 210;
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 112) = 0;
          }
          break;
        case 210:
          if ( ++*(_DWORD *)(a1 + 120) == 3 )
            *(_DWORD *)(a1 + 104) = 1;
          if ( *(_DWORD *)(a1 + 120) == 6 )
          {
            *(_DWORD *)(a1 + 104) = 2;
            *(_DWORD *)(a1 + 124) = 4096;
            *(_WORD *)(a1 + 80) |= 0x20u;
            *(_DWORD *)(a1 + 112) = 0;
          }
          if ( *(_DWORD *)(a1 + 120) > 150 )
          {
            *(_DWORD *)(a1 + 116) = 220;
            *(_DWORD *)(a1 + 120) = 0;
          }
          if ( *(_BYTE *)(a1 + 156) )
            ++*(_DWORD *)(a1 + 112);
          if ( *(_DWORD *)(a1 + 112) > 10 )
          {
            Play_Sound_Effect(Sfx_Critter_Small_Hurt, 1);
            Create_Dust_Clouds(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 148), 4);
            *(_DWORD *)(a1 + 116) = 300;
            *(_DWORD *)(a1 + 120) = 0;
            *(_DWORD *)(a1 + 104) = 3;
            *(_DWORD *)(a1 + 124) = 0x2000;
          }
          break;
        default:
          goto LABEL_53;
      }
    }
    goto LABEL_53;
  }
  if ( v4 > 401 )
  {
    if ( v4 == 1000 )
    {
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      *(_DWORD *)(a1 + 104) = 3;
    }
  }
  else
  {
    if ( v4 == 401 )
    {
LABEL_41:
      if ( ++*(_DWORD *)(a1 + 120) == 3 )
        *(_DWORD *)(a1 + 104) = 1;
      if ( *(_DWORD *)(a1 + 120) == 6 )
      {
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 124) = 4096;
        *(_WORD *)(a1 + 80) |= 0x20u;
        *(_DWORD *)(a1 + 112) = 0;
      }
      if ( *(_DWORD *)(a1 + 120) > 20 && *(_DWORD *)(a1 + 120) % 32 == 1 )
      {
        v40 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
        v40 += Random(-6, 6);
        Y_Vela = GetSin(v40);
        X_Vel = GetCos(v40);
        if ( *(_DWORD *)(a1 + 76) )
          NPC_Create((NPC_Names)202, *(_DWORD *)(a1 + 8) + 4096, *(_DWORD *)(a1 + 12), X_Vel, Y_Vela, 0, NULL, 256);
        else
          NPC_Create((NPC_Names)202, *(_DWORD *)(a1 + 8) - 4096, *(_DWORD *)(a1 + 12), X_Vel, Y_Vela, 0, NULL, 256);
        Play_Sound_Effect(Sfx_Fireball_Shoot, 1);
      }
      goto LABEL_53;
    }
    if ( v4 != 300 )
    {
      if ( v4 != 400 )
        goto LABEL_53;
      *(_DWORD *)(a1 + 116) = 401;
      *(_DWORD *)(a1 + 120) = 0;
      *(_DWORD *)(a1 + 104) = 0;
      *(_DWORD *)(a1 + 124) = 0x2000;
      *(_WORD *)(a1 + 80) &= 0xFFDFu;
      goto LABEL_41;
    }
    if ( ++*(_DWORD *)(a1 + 120) > 100 )
      *(_DWORD *)(a1 + 116) = 200;
  }
LABEL_53:
  *(_DWORD *)(a1 + 76) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 76);
  if ( *(_DWORD *)(a1 + 76) )
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) + 2048;
  else
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 8) - 2048;
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(*(_DWORD *)(a1 + 168) + 12) - 4096;
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v3;
    *(_DWORD *)(result + 4) = v3[1];
    *(_DWORD *)(result + 8) = v3[2];
    *(_DWORD *)(result + 12) = v3[3];
  }
  else
  {
    v1 = &v24 + 4 * *(_DWORD *)(a1 + 104);
    result = a1 + 84;
    *(_DWORD *)result = *v1;
    *(_DWORD *)(result + 4) = v1[1];
    *(_DWORD *)(result + 8) = v1[2];
    *(_DWORD *)(result + 12) = v1[3];
  }
  return result;
}

//----- (0047E6F0) --------------------------------------------------------
// Boss 3: Monster X
// Monster X's AI.
NPC_vars *Boss_3_Monster_X()
{
  int v0; // ST14_4@119
  int v1; // eax@119
  __int64 v2; // rax@127
  NPC_vars *result; // eax@135
  int v4; // [sp+0h] [bp-Ch]@1
  signed int i; // [sp+8h] [bp-4h]@123

  v4 = Boss_Objects[0].Current_State;
  if ( v4 > 401 )
  {
    if ( v4 > 601 )
    {
      if ( v4 > 1000 )
      {
        if ( v4 == 1001 )
        {
          Set_Quake(40);
          if ( ++Boss_Objects[0].Wait_Timer > 50 )
          {
            for ( i = 0; i < 20; ++i )
              Boss_Objects[i].Is_Alive = 0;
            Kill_NPC(158, 1);
            NPC_Create(
              Treasure_Chest_Closed|0x90,
              Boss_Objects[0].X_pos,
              Boss_Objects[0].Y_pos - 12288,
              0,
              0,
              0,
              NULL,
              0);
          }
        }
      }
      else if ( v4 == 1000 )
      {
        Set_Quake(2);
        if ( !(++Boss_Objects[0].Wait_Timer % 8) )
          Play_Sound_Effect(Sfx_Behemoth_Large_Hurt, 1);
        v0 = Boss_Objects[0].Y_pos + (Random(-64, 64) << 9);
        v1 = Random(-72, 72);
        Create_Dust_Clouds(Boss_Objects[0].X_pos + (v1 << 9), v0, 1, 1);
        if ( Boss_Objects[0].Wait_Timer > 100 )
        {
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].Current_State = 1001;
          Start_Flash(Boss_Objects[0].X_pos, Boss_Objects[0].Y_pos, 1);
          Play_Sound_Effect(Sfx_large_Explosion, 1);
        }
      }
      else
      {
        if ( v4 == 602 )
        {
          Boss_Objects[0].Current_State = 603;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].count1 = 0;
          Boss_Objects[1].Current_State = 40;
          Boss_Objects[2].Current_State = 40;
        }
        else if ( v4 != 603 )
        {
          goto LABEL_127;
        }
        if ( ++Boss_Objects[0].Wait_Timer > 50 )
        {
          if ( Boss_Objects[0].X_pos <= Quote.X_Pos )
            Boss_Objects[0].Current_State = 200;
          else
            Boss_Objects[0].Current_State = 100;
        }
      }
    }
    else if ( v4 == 601 )
    {
LABEL_107:
      ++Boss_Objects[0].Wait_Timer;
      if ( Boss_Objects[0].Life < Boss_Objects[0].count2 - 200 || Boss_Objects[0].Wait_Timer > 300 )
      {
        Boss_Objects[0].Current_State = 602;
        Boss_Objects[0].Wait_Timer = 0;
      }
    }
    else
    {
      switch ( v4 )
      {
        case 500:
          Boss_Objects[0].Current_State = 501;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[1].Current_State = 10;
          Boss_Objects[2].Current_State = 10;
          goto LABEL_92;
        case 501:
LABEL_92:
          if ( ++Boss_Objects[0].Wait_Timer > 300 )
          {
            Boss_Objects[0].Current_State = 502;
            Boss_Objects[0].Wait_Timer = 0;
          }
          if ( !Boss_Objects[3].Is_Alive
            && !Boss_Objects[4].Is_Alive
            && !Boss_Objects[5].Is_Alive
            && !Boss_Objects[6].Is_Alive )
          {
            Boss_Objects[0].Current_State = 502;
            Boss_Objects[0].Wait_Timer = 0;
          }
          break;
        case 502:
          Boss_Objects[0].Current_State = 503;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].count1 = 0;
          Boss_Objects[1].Current_State = 20;
          Boss_Objects[2].Current_State = 20;
          goto LABEL_101;
        case 503:
LABEL_101:
          if ( ++Boss_Objects[0].Wait_Timer > 50 )
          {
            if ( Boss_Objects[0].X_pos <= Quote.X_Pos )
              Boss_Objects[0].Current_State = 200;
            else
              Boss_Objects[0].Current_State = 100;
          }
          break;
        case 600:
          Boss_Objects[0].Current_State = 601;
          Boss_Objects[0].Wait_Timer = 0;
          Boss_Objects[0].count2 = Boss_Objects[0].Life;
          Boss_Objects[1].Current_State = 30;
          Boss_Objects[2].Current_State = 30;
          goto LABEL_107;
        default:
          break;
      }
    }
  }
  else if ( v4 == 401 )
  {
LABEL_75:
    if ( ++Boss_Objects[0].Wait_Timer == 4 )
      Boss_Objects[9].Current_State = 400;
    if ( Boss_Objects[0].Wait_Timer == 8 )
      Boss_Objects[10].Current_State = 400;
    if ( Boss_Objects[0].Wait_Timer == 10 )
      Boss_Objects[11].Current_State = 400;
    if ( Boss_Objects[0].Wait_Timer == 12 )
      Boss_Objects[12].Current_State = 400;
    if ( Boss_Objects[0].Wait_Timer > 50 )
    {
      if ( Boss_Objects[3].Is_Alive || Boss_Objects[4].Is_Alive || Boss_Objects[5].Is_Alive || Boss_Objects[6].Is_Alive )
        Boss_Objects[0].Current_State = 500;
      else
        Boss_Objects[0].Current_State = 600;
    }
  }
  else if ( v4 > 101 )
  {
    switch ( v4 )
    {
      case 200:
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 201;
        ++Boss_Objects[0].count1;
        goto LABEL_42;
      case 201:
LABEL_42:
        if ( ++Boss_Objects[0].Wait_Timer == 4 )
          Boss_Objects[9].Current_State = 200;
        if ( Boss_Objects[0].Wait_Timer == 8 )
          Boss_Objects[10].Current_State = 200;
        if ( Boss_Objects[0].Wait_Timer == 10 )
          Boss_Objects[11].Current_State = 200;
        if ( Boss_Objects[0].Wait_Timer == 12 )
          Boss_Objects[12].Current_State = 200;
        if ( Boss_Objects[0].Wait_Timer > 120 && Boss_Objects[0].count1 > 2 )
          Boss_Objects[0].Current_State = 400;
        if ( Boss_Objects[0].Wait_Timer > 121 && Quote.X_Pos < Boss_Objects[0].X_pos )
          Boss_Objects[0].Current_State = 100;
        break;
      case 300:
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 301;
        goto LABEL_58;
      case 301:
LABEL_58:
        if ( ++Boss_Objects[0].Wait_Timer == 4 )
          Boss_Objects[9].Current_State = 300;
        if ( Boss_Objects[0].Wait_Timer == 8 )
          Boss_Objects[10].Current_State = 300;
        if ( Boss_Objects[0].Wait_Timer == 10 )
          Boss_Objects[11].Current_State = 300;
        if ( Boss_Objects[0].Wait_Timer == 12 )
          Boss_Objects[12].Current_State = 300;
        if ( Boss_Objects[0].Wait_Timer > 50 )
        {
          if ( Boss_Objects[3].Is_Alive
            || Boss_Objects[4].Is_Alive
            || Boss_Objects[5].Is_Alive
            || Boss_Objects[6].Is_Alive )
          {
            Boss_Objects[0].Current_State = 500;
          }
          else
          {
            Boss_Objects[0].Current_State = 600;
          }
        }
        break;
      case 400:
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 401;
        goto LABEL_75;
      default:
        break;
    }
  }
  else if ( v4 == 101 )
  {
LABEL_26:
    if ( ++Boss_Objects[0].Wait_Timer == 4 )
      Boss_Objects[9].Current_State = 100;
    if ( Boss_Objects[0].Wait_Timer == 8 )
      Boss_Objects[10].Current_State = 100;
    if ( Boss_Objects[0].Wait_Timer == 10 )
      Boss_Objects[11].Current_State = 100;
    if ( Boss_Objects[0].Wait_Timer == 12 )
      Boss_Objects[12].Current_State = 100;
    if ( Boss_Objects[0].Wait_Timer > 120 && Boss_Objects[0].count1 > 2 )
      Boss_Objects[0].Current_State = 300;
    if ( Boss_Objects[0].Wait_Timer > 121 && Quote.X_Pos > Boss_Objects[0].X_pos )
      Boss_Objects[0].Current_State = 200;
  }
  else
  {
    switch ( v4 )
    {
      case 0:
        Boss_Objects[0].Life = 1;
        Boss_Objects[0].X_pos = -163840;
        break;
      case 1:
        Boss_Objects[0].Life = 700;
        Boss_Objects[0].EXP_Amount = 1;
        Boss_Objects[0].Current_State = 1;
        Boss_Objects[0].X_pos = 0x100000;
        Boss_Objects[0].Y_pos = 102400;
        Boss_Objects[0].Sound_Hit = 54;
        Boss_Objects[0].Hitbox.front = 12288;
        Boss_Objects[0].Hitbox.top = 12288;
        Boss_Objects[0].Hitbox.back = 12288;
        Boss_Objects[0].Hitbox.bottom = 12288;
        Boss_Objects[0].Entity_Flags = -32248;
        Boss_Objects[0].Explosion_Size = 3;
        Boss_Objects[0].Entity_Eve_Num = 1000;
        Boss_Objects[0].Ani_Num = 0;
        Boss_Objects[1].Is_Alive = -128;
        Boss_Objects[1].Explosion_Size = 3;
        Boss_Objects[1].Direction = 0;
        Boss_Objects[1].view.front = 12288;
        Boss_Objects[1].view.top = 12288;
        Boss_Objects[1].view.back = 12288;
        Boss_Objects[1].view.bottom = 12288;
        Boss_Objects[1].Entity_Flags = 8;
        qmemcpy(&Boss_Objects[2], &Boss_Objects[1], sizeof(Boss_Objects[2]));
        Boss_Objects[2].Direction = 2;
        Boss_Objects[3].Is_Alive = -128;
        Boss_Objects[3].Life = 60;
        Boss_Objects[3].Sound_Hit = 54;
        Boss_Objects[3].Sound_Death = 71;
        Boss_Objects[3].Explosion_Size = 2;
        Boss_Objects[3].view.front = 4096;
        Boss_Objects[3].view.top = 4096;
        Boss_Objects[3].view.back = 4096;
        Boss_Objects[3].view.bottom = 4096;
        Boss_Objects[3].Hitbox.front = 2560;
        Boss_Objects[3].Hitbox.back = 2560;
        Boss_Objects[3].Hitbox.top = 2560;
        Boss_Objects[3].Hitbox.bottom = 2560;
        Boss_Objects[3].Entity_Flags = 8;
        Boss_Objects[3].Curly_Target_X = 0;
        qmemcpy(&Boss_Objects[4], &Boss_Objects[3], sizeof(Boss_Objects[4]));
        Boss_Objects[4].Curly_Target_X = 1;
        qmemcpy(&Boss_Objects[5], &Boss_Objects[3], sizeof(Boss_Objects[5]));
        Boss_Objects[5].Curly_Target_X = 2;
        Boss_Objects[5].Life = 100;
        qmemcpy(&Boss_Objects[6], &Boss_Objects[3], sizeof(Boss_Objects[6]));
        Boss_Objects[6].Curly_Target_X = 3;
        Boss_Objects[6].Life = 100;
        Boss_Objects[7].Is_Alive = -128;
        Boss_Objects[7].X_pos = 0x100000;
        Boss_Objects[7].Y_pos = 102400;
        Boss_Objects[7].view.front = 26624;
        Boss_Objects[7].view.top = 12288;
        Boss_Objects[7].view.back = 26624;
        Boss_Objects[7].view.bottom = 12288;
        Boss_Objects[7].Sound_Hit = 52;
        Boss_Objects[7].Hitbox.front = 4096;
        Boss_Objects[7].Hitbox.top = 12288;
        Boss_Objects[7].Hitbox.back = 4096;
        Boss_Objects[7].Hitbox.bottom = 0x2000;
        Boss_Objects[7].Entity_Flags = 8;
        Boss_Objects[7].Explosion_Size = 3;
        Boss_Objects[7].Ani_Num = 0;
        Boss_Objects[9].Is_Alive = -128;
        Boss_Objects[9].Current_State = 0;
        Boss_Objects[9].Direction = 1;
        Boss_Objects[9].X_pos = 1015808;
        Boss_Objects[9].Y_pos = 73728;
        Boss_Objects[9].view.front = 18432;
        Boss_Objects[9].view.top = 4096;
        Boss_Objects[9].view.back = 18432;
        Boss_Objects[9].view.bottom = 12288;
        Boss_Objects[9].Sound_Hit = 52;
        Boss_Objects[9].Hitbox.front = 14336;
        Boss_Objects[9].Hitbox.top = 4096;
        Boss_Objects[9].Hitbox.back = 14336;
        Boss_Objects[9].Hitbox.bottom = 0x2000;
        Boss_Objects[9].Entity_Flags = 141;
        Boss_Objects[9].Explosion_Size = 3;
        qmemcpy(&Boss_Objects[10], &Boss_Objects[9], sizeof(Boss_Objects[10]));
        Boss_Objects[10].X_pos = 1081344;
        qmemcpy(&Boss_Objects[11], &Boss_Objects[9], sizeof(Boss_Objects[11]));
        Boss_Objects[11].Direction = 3;
        Boss_Objects[11].X_pos = 1015808;
        Boss_Objects[11].Y_pos = 0x20000;
        Boss_Objects[11].view.top = 12288;
        Boss_Objects[11].view.bottom = 4096;
        Boss_Objects[11].Hitbox.top = 0x2000;
        Boss_Objects[11].Hitbox.bottom = 4096;
        qmemcpy(&Boss_Objects[12], &Boss_Objects[11], sizeof(Boss_Objects[12]));
        Boss_Objects[12].X_pos = 1081344;
        qmemcpy(&Boss_Objects[13], &Boss_Objects[9], sizeof(Boss_Objects[13]));
        Boss_Objects[13].Is_Alive = -128;
        Boss_Objects[13].view.top = 0x2000;
        Boss_Objects[13].view.bottom = 0x2000;
        Boss_Objects[13].view.front = 15360;
        Boss_Objects[13].view.back = 21504;
        Boss_Objects[13].count1 = 9;
        Boss_Objects[13].Ani_Num = 0;
        Boss_Objects[13].Entity_Flags = 8;
        qmemcpy(&Boss_Objects[14], &Boss_Objects[13], sizeof(Boss_Objects[14]));
        Boss_Objects[14].view.front = 21504;
        Boss_Objects[14].view.back = 15360;
        Boss_Objects[14].count1 = 10;
        Boss_Objects[14].Ani_Num = 1;
        Boss_Objects[14].Entity_Flags = 8;
        qmemcpy(&Boss_Objects[15], &Boss_Objects[13], sizeof(Boss_Objects[15]));
        Boss_Objects[15].view.top = 0x2000;
        Boss_Objects[15].view.bottom = 0x2000;
        Boss_Objects[15].count1 = 11;
        Boss_Objects[15].Ani_Num = 2;
        Boss_Objects[15].Entity_Flags = 8;
        qmemcpy(&Boss_Objects[16], &Boss_Objects[15], sizeof(Boss_Objects[16]));
        Boss_Objects[16].view.front = 21504;
        Boss_Objects[16].view.back = 15360;
        Boss_Objects[16].count1 = 12;
        Boss_Objects[16].Ani_Num = 3;
        Boss_Objects[16].Entity_Flags = 8;
        Boss_Objects[0].Current_State = 2;
        break;
      case 10:
        Boss_Objects[0].Current_State = 11;
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].count1 = 0;
        goto LABEL_20;
      case 11:
LABEL_20:
        if ( ++Boss_Objects[0].Wait_Timer > 100 )
        {
          Boss_Objects[0].Wait_Timer = 0;
          if ( Boss_Objects[0].X_pos <= Quote.X_Pos )
            Boss_Objects[0].Current_State = 200;
          else
            Boss_Objects[0].Current_State = 100;
        }
        break;
      case 100:
        Boss_Objects[0].Wait_Timer = 0;
        Boss_Objects[0].Current_State = 101;
        ++Boss_Objects[0].count1;
        goto LABEL_26;
      default:
        break;
    }
  }
LABEL_127:
  Monster_X_Sub_NPC_1((int)&Boss_Objects[9]);
  Monster_X_Sub_NPC_1((int)&Boss_Objects[10]);
  Monster_X_Sub_NPC_1((int)&Boss_Objects[11]);
  Monster_X_Sub_NPC_1((int)&Boss_Objects[12]);
  v2 = (Boss_Objects[12].X_pos + Boss_Objects[11].X_pos + Boss_Objects[10].X_pos + Boss_Objects[9].X_pos) / 4
     - Boss_Objects[0].X_pos;
  Boss_Objects[0].X_pos += ((BYTE4(v2) & 0xF) + (signed int)v2) >> 4;
  Monster_X_Sub_NPC_Head((int)&Boss_Objects[7]);
  Monster_X_Sub_NPC_Fish_Missiles((int)&Boss_Objects[13]);
  Monster_X_Sub_NPC_Fish_Missiles((int)&Boss_Objects[14]);
  Monster_X_Sub_NPC_Fish_Missiles((int)&Boss_Objects[15]);
  Monster_X_Sub_NPC_Fish_Missiles((int)&Boss_Objects[16]);
  Monster_X_Sub_NPC_3((int)&Boss_Objects[1]);
  Monster_X_Sub_NPC_3((int)&Boss_Objects[2]);
  if ( Boss_Objects[3].Is_Alive )
    Monster_X_Sub_NPC_4((int)&Boss_Objects[3]);
  if ( Boss_Objects[4].Is_Alive )
    Monster_X_Sub_NPC_4((int)&Boss_Objects[4]);
  if ( Boss_Objects[5].Is_Alive )
    Monster_X_Sub_NPC_4((int)&Boss_Objects[5]);
  if ( Boss_Objects[6].Is_Alive )
    Monster_X_Sub_NPC_4((int)&Boss_Objects[6]);
  result = Boss_Objects;
  if ( !Boss_Objects[0].Life && Boss_Objects[0].Current_State < 1000 )
  {
    Boss_Objects[0].Current_State = 1000;
    result = Boss_Objects;
    Boss_Objects[0].Wait_Timer = 0;
    Boss_Objects[0].Is_Being_Hit = -106;
    Boss_Objects[9].Current_State = 300;
    Boss_Objects[10].Current_State = 300;
    Boss_Objects[11].Current_State = 300;
    Boss_Objects[12].Current_State = 300;
  }
  return result;
}

//----- (0047F710) --------------------------------------------------------
int __cdecl Monster_X_Sub_NPC_1(int a1)
{
  int *v1; // ecx@69
  int v2; // edx@69
  int result; // eax@69
  int *v4; // ecx@70
  int v5; // edx@70
  signed int v6; // [sp+0h] [bp-C4h]@1
  int v7; // [sp+4h] [bp-C0h]@1
  int v8; // [sp+8h] [bp-BCh]@1
  int v9; // [sp+Ch] [bp-B8h]@1
  int v10; // [sp+10h] [bp-B4h]@1
  int v11; // [sp+14h] [bp-B0h]@1
  int v12; // [sp+18h] [bp-ACh]@1
  int v13; // [sp+1Ch] [bp-A8h]@1
  int v14; // [sp+20h] [bp-A4h]@1
  int v15; // [sp+24h] [bp-A0h]@1
  int v16; // [sp+28h] [bp-9Ch]@1
  int v17; // [sp+2Ch] [bp-98h]@1
  int v18; // [sp+30h] [bp-94h]@1
  int v19; // [sp+34h] [bp-90h]@1
  int v20; // [sp+38h] [bp-8Ch]@1
  int v21; // [sp+3Ch] [bp-88h]@1
  int v22; // [sp+40h] [bp-84h]@1
  int v23; // [sp+44h] [bp-80h]@1
  int v24; // [sp+48h] [bp-7Ch]@1
  int v25; // [sp+4Ch] [bp-78h]@1
  int v26; // [sp+50h] [bp-74h]@1
  int v27; // [sp+54h] [bp-70h]@1
  int v28; // [sp+58h] [bp-6Ch]@1
  int v29; // [sp+5Ch] [bp-68h]@1
  int v30; // [sp+60h] [bp-64h]@1
  int v31; // [sp+64h] [bp-60h]@1
  int v32; // [sp+68h] [bp-5Ch]@1
  int v33; // [sp+6Ch] [bp-58h]@1
  int v34; // [sp+70h] [bp-54h]@1
  int v35; // [sp+74h] [bp-50h]@1
  int v36; // [sp+78h] [bp-4Ch]@1
  int v37; // [sp+7Ch] [bp-48h]@1
  int v38; // [sp+80h] [bp-44h]@1
  int v39; // [sp+84h] [bp-40h]@1
  int v40; // [sp+88h] [bp-3Ch]@1
  int v41; // [sp+8Ch] [bp-38h]@1
  int v42; // [sp+90h] [bp-34h]@1
  int v43; // [sp+94h] [bp-30h]@1
  int v44; // [sp+98h] [bp-2Ch]@1
  int v45; // [sp+9Ch] [bp-28h]@1
  int v46; // [sp+A0h] [bp-24h]@1
  int v47; // [sp+A4h] [bp-20h]@1
  int v48; // [sp+A8h] [bp-1Ch]@1
  int v49; // [sp+ACh] [bp-18h]@1
  int v50; // [sp+B0h] [bp-14h]@1
  int v51; // [sp+B4h] [bp-10h]@1
  int v52; // [sp+B8h] [bp-Ch]@1
  int v53; // [sp+BCh] [bp-8h]@1
  int v54; // [sp+C0h] [bp-4h]@1

  v31 = 0;
  v32 = 0;
  v33 = 72;
  v34 = 32;
  v35 = 0;
  v36 = 32;
  v37 = 72;
  v38 = 64;
  v39 = 72;
  v40 = 0;
  v41 = 144;
  v42 = 32;
  v43 = 144;
  v44 = 0;
  v45 = 216;
  v46 = 32;
  v47 = 72;
  v48 = 32;
  v49 = 144;
  v50 = 64;
  v51 = 144;
  v52 = 32;
  v53 = 216;
  v54 = 64;
  v7 = 0;
  v8 = 64;
  v9 = 72;
  v10 = 96;
  v11 = 0;
  v12 = 96;
  v13 = 72;
  v14 = 128;
  v15 = 72;
  v16 = 64;
  v17 = 144;
  v18 = 96;
  v19 = 144;
  v20 = 64;
  v21 = 216;
  v22 = 96;
  v23 = 72;
  v24 = 96;
  v25 = 144;
  v26 = 128;
  v27 = 144;
  v28 = 96;
  v29 = 216;
  v30 = 128;
  v6 = *(_DWORD *)(a1 + 116);
  if ( v6 > 201 )
  {
    switch ( v6 )
    {
      case 202:
        *(_WORD *)(a1 + 80) &= 0xFFEFu;
        *(_DWORD *)(a1 + 116) = 203;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        goto LABEL_29;
      case 203:
LABEL_29:
        ++*(_DWORD *)(a1 + 120);
        if ( ++*(_DWORD *)(a1 + 100) > 1 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 1 )
          *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 16) += 32;
        break;
      case 300:
        *(_DWORD *)(a1 + 116) = 301;
        *(_DWORD *)(a1 + 104) = 4;
        *(_DWORD *)(a1 + 100) = 0;
        *(_WORD *)(a1 + 80) |= 0x10u;
        goto LABEL_35;
      case 301:
LABEL_35:
        if ( ++*(_DWORD *)(a1 + 100) > 0 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 5 )
          *(_DWORD *)(a1 + 104) = 4;
        *(_DWORD *)(a1 + 16) += 32;
        if ( *(_DWORD *)(a1 + 16) > 0 )
        {
          *(_DWORD *)(a1 + 16) = 0;
          *(_DWORD *)(a1 + 116) = 10;
        }
        break;
      case 400:
        *(_DWORD *)(a1 + 116) = 401;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 100) = 0;
        *(_WORD *)(a1 + 80) |= 0x10u;
        goto LABEL_43;
      case 401:
LABEL_43:
        if ( ++*(_DWORD *)(a1 + 100) > 0 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 3 )
          *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 16) -= 32;
        if ( *(_DWORD *)(a1 + 16) < 0 )
        {
          *(_DWORD *)(a1 + 16) = 0;
          *(_DWORD *)(a1 + 116) = 10;
        }
        break;
      default:
        break;
    }
  }
  else if ( v6 == 201 )
  {
LABEL_21:
    if ( ++*(_DWORD *)(a1 + 120) > 30 )
      *(_DWORD *)(a1 + 116) = 202;
    if ( ++*(_DWORD *)(a1 + 100) > 0 )
    {
      *(_DWORD *)(a1 + 100) = 0;
      ++*(_DWORD *)(a1 + 104);
    }
    if ( *(_DWORD *)(a1 + 104) > 5 )
      *(_DWORD *)(a1 + 104) = 4;
    *(_DWORD *)(a1 + 16) += 32;
  }
  else
  {
    switch ( v6 )
    {
      case 10:
        *(_DWORD *)(a1 + 104) = 0;
        *(_WORD *)(a1 + 80) &= 0xFFEFu;
        break;
      case 100:
        *(_WORD *)(a1 + 80) |= 0x10u;
        *(_DWORD *)(a1 + 116) = 101;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 100) = 0;
        goto LABEL_7;
      case 101:
LABEL_7:
        if ( ++*(_DWORD *)(a1 + 120) > 30 )
          *(_DWORD *)(a1 + 116) = 102;
        if ( ++*(_DWORD *)(a1 + 100) > 0 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 3 )
          *(_DWORD *)(a1 + 104) = 2;
        *(_DWORD *)(a1 + 16) -= 32;
        break;
      case 102:
        *(_WORD *)(a1 + 80) &= 0xFFEFu;
        *(_DWORD *)(a1 + 116) = 103;
        *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 100) = 0;
        goto LABEL_15;
      case 103:
LABEL_15:
        ++*(_DWORD *)(a1 + 120);
        if ( ++*(_DWORD *)(a1 + 100) > 1 )
        {
          *(_DWORD *)(a1 + 100) = 0;
          ++*(_DWORD *)(a1 + 104);
        }
        if ( *(_DWORD *)(a1 + 104) > 1 )
          *(_DWORD *)(a1 + 104) = 0;
        *(_DWORD *)(a1 + 16) -= 32;
        break;
      case 200:
        *(_WORD *)(a1 + 80) |= 0x10u;
        *(_WORD *)(a1 + 80) |= 0x80u;
        *(_DWORD *)(a1 + 116) = 201;
        *(_DWORD *)(a1 + 120) = 0;
        *(_DWORD *)(a1 + 104) = 4;
        *(_DWORD *)(a1 + 100) = 0;
        goto LABEL_21;
      default:
        break;
    }
  }
  if ( (*(_DWORD *)(a1 + 116) == 101
     || *(_DWORD *)(a1 + 116) == 201
     || *(_DWORD *)(a1 + 116) == 301
     || *(_DWORD *)(a1 + 116) == 401)
    && *(_DWORD *)(a1 + 120) % 2 == 1 )
  {
    Play_Sound_Effect(Sfx_Large_Thud, 1);
  }
  if ( (*(_DWORD *)(a1 + 116) == 103 || *(_DWORD *)(a1 + 116) == 203) && *(_DWORD *)(a1 + 120) % 4 == 1 )
    Play_Sound_Effect(Sfx_Thud, 1);
  if ( *(_DWORD *)(a1 + 116) < 100
    || Quote.Y_Pos >= *(_DWORD *)(a1 + 12) + 2048
    || Quote.Y_Pos <= *(_DWORD *)(a1 + 12) - 2048 )
  {
    *(_DWORD *)(a1 + 164) = 0;
    *(_WORD *)(a1 + 80) &= 0xFF7Fu;
  }
  else
  {
    *(_DWORD *)(a1 + 164) = 10;
    *(_WORD *)(a1 + 80) |= 0x80u;
  }
  if ( *(_DWORD *)(a1 + 16) > 1024 )
    *(_DWORD *)(a1 + 16) = 1024;
  if ( *(_DWORD *)(a1 + 16) < -1024 )
    *(_DWORD *)(a1 + 16) = -1024;
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 76) == 1 )
  {
    v1 = &v31 + 4 * *(_DWORD *)(a1 + 104);
    v2 = a1 + 84;
    *(_DWORD *)v2 = *v1;
    *(_DWORD *)(v2 + 4) = v1[1];
    result = v1[2];
    *(_DWORD *)(v2 + 8) = result;
    *(_DWORD *)(v2 + 12) = v1[3];
  }
  else
  {
    v4 = &v7 + 4 * *(_DWORD *)(a1 + 104);
    v5 = a1 + 84;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    result = v4[2];
    *(_DWORD *)(v5 + 8) = result;
    *(_DWORD *)(v5 + 12) = v4[3];
  }
  return result;
}

//----- (00480090) --------------------------------------------------------
int __cdecl Monster_X_Sub_NPC_Fish_Missiles(int a1)
{
  __int64 v1; // rax@14
  __int64 v2; // rax@14
  int result; // eax@14
  int v4; // [sp+4h] [bp-50h]@1
  int Direction; // [sp+8h] [bp-4Ch]@0
  int v6; // [sp+Ch] [bp-48h]@1
  int v7; // [sp+10h] [bp-44h]@1
  int v8; // [sp+14h] [bp-40h]@1
  int v9; // [sp+18h] [bp-3Ch]@1
  int v10; // [sp+1Ch] [bp-38h]@1
  int v11; // [sp+20h] [bp-34h]@1
  int v12; // [sp+24h] [bp-30h]@1
  int v13; // [sp+28h] [bp-2Ch]@1
  int v14; // [sp+2Ch] [bp-28h]@1
  int v15; // [sp+30h] [bp-24h]@1
  int v16; // [sp+34h] [bp-20h]@1
  int v17; // [sp+38h] [bp-1Ch]@1
  int v18; // [sp+3Ch] [bp-18h]@1
  int v19; // [sp+40h] [bp-14h]@1
  int v20; // [sp+44h] [bp-10h]@1
  int v21; // [sp+48h] [bp-Ch]@1
  int v22; // [sp+4Ch] [bp-8h]@8
  int v23; // [sp+50h] [bp-4h]@8

  v6 = 0;
  v7 = 128;
  v8 = 72;
  v9 = 160;
  v10 = 72;
  v11 = 128;
  v12 = 144;
  v13 = 160;
  v14 = 0;
  v15 = 160;
  v16 = 72;
  v17 = 192;
  v18 = 72;
  v19 = 160;
  v20 = 144;
  v21 = 192;
  v4 = *(_DWORD *)(a1 + 116);
  if ( v4 == 10 )
  {
    *(_DWORD *)(a1 + 116) = 11;
    *(_DWORD *)(a1 + 120) = 30 * *(_DWORD *)(a1 + 104) + 30;
  }
  else if ( v4 != 11 )
  {
    goto LABEL_14;
  }
  if ( *(_DWORD *)(a1 + 120) )
  {
    --*(_DWORD *)(a1 + 120);
  }
  else
  {
    switch ( *(_DWORD *)(a1 + 104) )
    {
      case 0:
        v22 = -15360;
        v23 = 3072;
        NPC_Create(Santas_Key|0x90, *(_DWORD *)(a1 + 8) - 15360, *(_DWORD *)(a1 + 12) + 3072, 0, 0, Down, NULL, 256);
        break;
      case 1:
        v22 = 15360;
        v23 = 3072;
        NPC_Create(Santas_Key|0x90, *(_DWORD *)(a1 + 8) + 15360, *(_DWORD *)(a1 + 12) + 3072, 0, 0, Right, NULL, 256);
        break;
      case 2:
        v22 = -15360;
        v23 = -3072;
        NPC_Create(Santas_Key|0x90, *(_DWORD *)(a1 + 8) - 15360, *(_DWORD *)(a1 + 12) - 3072, 0, 0, 0, NULL, 256);
        break;
      case 3:
        Direction = 1;
        v22 = 15360;
        v23 = -3072;
        goto LABEL_12;
      default:
LABEL_12:
        NPC_Create(
          Santas_Key|0x90,
          v22 + *(_DWORD *)(a1 + 8),
          v23 + *(_DWORD *)(a1 + 12),
          0,
          0,
          (Directions)Direction,
          NULL,
          256);
        break;
    }
    Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
    *(_DWORD *)(a1 + 120) = 120;
  }
LABEL_14:
  v1 = Boss_Objects[*(_DWORD *)(a1 + 108)].X_pos + Boss_Objects[0].X_pos;
  *(_DWORD *)(a1 + 8) = ((signed int)v1 - HIDWORD(v1)) >> 1;
  v2 = Boss_Objects[*(_DWORD *)(a1 + 108)].Y_pos + Boss_Objects[0].Y_pos;
  *(_DWORD *)(a1 + 12) = ((signed int)v2 - HIDWORD(v2)) >> 1;
  HIDWORD(v2) = &v6 + 4 * *(_DWORD *)(a1 + 104);
  result = a1 + 84;
  *(_QWORD *)result = *(_QWORD *)HIDWORD(v2);
  *(_QWORD *)(result + 8) = *(_QWORD *)(HIDWORD(v2) + 8);
  return result;
}

//----- (004802A0) --------------------------------------------------------
int __cdecl Monster_X_Sub_NPC_3(int a1)
{
  int v1; // eax@14
  int result; // eax@14
  int v3; // edx@15

  switch ( *(_DWORD *)(a1 + 116) )
  {
    case 0xA:
      *(_DWORD *)(a1 + 32) += 512;
      if ( *(_DWORD *)(a1 + 32) > 0x4000 )
      {
        *(_DWORD *)(a1 + 32) = 0x4000;
        *(_DWORD *)(a1 + 116) = 0;
        Boss_Objects[3].Current_State = 10;
        Boss_Objects[4].Current_State = 10;
        Boss_Objects[5].Current_State = 10;
        Boss_Objects[6].Current_State = 10;
      }
      break;
    case 0x14:
      *(_DWORD *)(a1 + 32) -= 512;
      if ( *(_DWORD *)(a1 + 32) < 0 )
      {
        *(_DWORD *)(a1 + 32) = 0;
        *(_DWORD *)(a1 + 116) = 0;
        Boss_Objects[3].Current_State = 0;
        Boss_Objects[4].Current_State = 0;
        Boss_Objects[5].Current_State = 0;
        Boss_Objects[6].Current_State = 0;
      }
      break;
    case 0x1E:
      *(_DWORD *)(a1 + 32) += 512;
      if ( *(_DWORD *)(a1 + 32) > 10240 )
      {
        *(_DWORD *)(a1 + 32) = 10240;
        *(_DWORD *)(a1 + 116) = 0;
        Boss_Objects[7].Current_State = 10;
        Boss_Objects[13].Current_State = 10;
        Boss_Objects[14].Current_State = 10;
        Boss_Objects[15].Current_State = 10;
        Boss_Objects[16].Current_State = 10;
      }
      break;
    case 0x28:
      *(_DWORD *)(a1 + 32) -= 512;
      if ( *(_DWORD *)(a1 + 32) < 0 )
      {
        *(_DWORD *)(a1 + 32) = 0;
        *(_DWORD *)(a1 + 116) = 0;
        Boss_Objects[7].Current_State = 0;
        Boss_Objects[13].Current_State = 0;
        Boss_Objects[14].Current_State = 0;
        Boss_Objects[15].Current_State = 0;
        Boss_Objects[16].Current_State = 0;
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v3 = a1 + 84;
    *(_DWORD *)v3 = 264;
    *(_DWORD *)(v3 + 4) = 96;
    *(_DWORD *)(v3 + 8) = 312;
    *(_DWORD *)(v3 + 12) = 144;
    result = a1;
    *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + *(_DWORD *)(a1 + 32) + 12288;
    *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
  }
  else
  {
    v1 = a1 + 84;
    *(_DWORD *)v1 = 216;
    *(_DWORD *)(v1 + 4) = 96;
    *(_DWORD *)(v1 + 8) = 264;
    *(_DWORD *)(v1 + 12) = 144;
    *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 12288 - *(_DWORD *)(a1 + 32);
    result = a1;
    *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos;
  }
  return result;
}

//----- (00480550) --------------------------------------------------------
int __cdecl Monster_X_Sub_NPC_4(int a1)
{
  int Y_Vel; // ST28_4@13
  int X_Vel; // ST2C_4@13
  int *v3; // eax@19
  int v4; // ecx@19
  int result; // eax@19
  int v6; // [sp+4h] [bp-94h]@1
  int v7; // [sp+10h] [bp-88h]@1
  int v8; // [sp+14h] [bp-84h]@1
  int v9; // [sp+18h] [bp-80h]@1
  int v10; // [sp+1Ch] [bp-7Ch]@1
  int v11; // [sp+20h] [bp-78h]@1
  int v12; // [sp+24h] [bp-74h]@1
  int v13; // [sp+28h] [bp-70h]@1
  int v14; // [sp+2Ch] [bp-6Ch]@1
  int v15; // [sp+30h] [bp-68h]@1
  int v16; // [sp+34h] [bp-64h]@1
  int v17; // [sp+38h] [bp-60h]@1
  int v18; // [sp+3Ch] [bp-5Ch]@1
  int v19; // [sp+40h] [bp-58h]@1
  int v20; // [sp+44h] [bp-54h]@1
  int v21; // [sp+48h] [bp-50h]@1
  int v22; // [sp+4Ch] [bp-4Ch]@1
  int v23; // [sp+50h] [bp-48h]@1
  int v24; // [sp+54h] [bp-44h]@1
  int v25; // [sp+58h] [bp-40h]@1
  int v26; // [sp+5Ch] [bp-3Ch]@1
  int v27; // [sp+60h] [bp-38h]@1
  int v28; // [sp+64h] [bp-34h]@1
  int v29; // [sp+68h] [bp-30h]@1
  int v30; // [sp+6Ch] [bp-2Ch]@1
  int v31; // [sp+70h] [bp-28h]@1
  int v32; // [sp+74h] [bp-24h]@1
  int v33; // [sp+78h] [bp-20h]@1
  int v34; // [sp+7Ch] [bp-1Ch]@1
  int v35; // [sp+80h] [bp-18h]@1
  int v36; // [sp+84h] [bp-14h]@1
  int v37; // [sp+88h] [bp-10h]@1
  int v38; // [sp+8Ch] [bp-Ch]@1
  unsigned __int8 v39; // [sp+97h] [bp-1h]@13

  v7 = 0;
  v8 = 192;
  v9 = 16;
  v10 = 208;
  v11 = 16;
  v12 = 192;
  v13 = 32;
  v14 = 208;
  v15 = 32;
  v16 = 192;
  v17 = 48;
  v18 = 208;
  v19 = 48;
  v20 = 192;
  v21 = 64;
  v22 = 208;
  v23 = 0;
  v24 = 208;
  v25 = 16;
  v26 = 224;
  v27 = 16;
  v28 = 208;
  v29 = 32;
  v30 = 224;
  v31 = 32;
  v32 = 208;
  v33 = 48;
  v34 = 224;
  v35 = 48;
  v36 = 208;
  v37 = 64;
  v38 = 224;
  v6 = *(_DWORD *)(a1 + 116);
  if ( !v6 )
  {
    *(_WORD *)(a1 + 80) &= 0xFFDFu;
    *(_DWORD *)(a1 + 104) = 0;
    goto LABEL_14;
  }
  if ( v6 == 10 )
  {
    *(_DWORD *)(a1 + 116) = 11;
    *(_DWORD *)(a1 + 120) = 10 * *(_DWORD *)(a1 + 32) + 40;
    *(_WORD *)(a1 + 80) |= 0x20u;
  }
  else if ( v6 != 11 )
  {
    goto LABEL_14;
  }
  *(_DWORD *)(a1 + 104) = *(_DWORD *)(a1 + 120) < 16 && *(_DWORD *)(a1 + 120) / 2 % 2;
  if ( *(_DWORD *)(a1 + 120) )
  {
    --*(_DWORD *)(a1 + 120);
  }
  else
  {
    v39 = GetArcTan(*(_DWORD *)(a1 + 8) - Quote.X_Pos, *(_DWORD *)(a1 + 12) - Quote.Y_Pos);
    v39 += Random(-2, 2);
    Y_Vel = 3 * GetSin(v39);
    X_Vel = 3 * GetCos(v39);
    NPC_Create((NPC_Names)156, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), X_Vel, Y_Vel, 0, NULL, 256);
    Play_Sound_Effect(Sfx_Enemy_Shoot_Projectile, 1);
    *(_DWORD *)(a1 + 120) = 40;
  }
LABEL_14:
  switch ( *(_DWORD *)(a1 + 32) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 11264;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos - 0x2000;
      break;
    case 1:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 14336;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos - 0x2000;
      break;
    case 2:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos - 7680;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 7168;
      break;
    case 3:
      *(_DWORD *)(a1 + 8) = Boss_Objects[0].X_pos + 8704;
      *(_DWORD *)(a1 + 12) = Boss_Objects[0].Y_pos + 7168;
      break;
    default:
      break;
  }
  v3 = &v7 + 4 * (*(_DWORD *)(a1 + 32) + 4 * *(_DWORD *)(a1 + 104));
  v4 = a1 + 84;
  *(_DWORD *)v4 = *v3;
  *(_DWORD *)(v4 + 4) = v3[1];
  *(_DWORD *)(v4 + 8) = v3[2];
  result = v3[3];
  *(_DWORD *)(v4 + 12) = result;
  return result;
}

//----- (004808C0) --------------------------------------------------------
int __cdecl Monster_X_Sub_NPC_Head(int a1)
{
  int v1; // eax@8
  int *v2; // ecx@15
  int v3; // edx@15
  int result; // eax@15
  int v5; // [sp+0h] [bp-34h]@1
  int v6; // [sp+4h] [bp-30h]@1
  int v7; // [sp+8h] [bp-2Ch]@1
  int v8; // [sp+Ch] [bp-28h]@1
  int v9; // [sp+10h] [bp-24h]@1
  int v10; // [sp+14h] [bp-20h]@1
  int v11; // [sp+18h] [bp-1Ch]@1
  int v12; // [sp+1Ch] [bp-18h]@1
  int v13; // [sp+20h] [bp-14h]@1
  int v14; // [sp+24h] [bp-10h]@1
  int v15; // [sp+28h] [bp-Ch]@1
  int v16; // [sp+2Ch] [bp-8h]@1
  int v17; // [sp+30h] [bp-4h]@1

  v6 = 216;
  v7 = 0;
  v8 = 320;
  v9 = 48;
  v10 = 216;
  v11 = 48;
  v12 = 320;
  v13 = 96;
  v14 = 216;
  v15 = 144;
  v16 = 320;
  v17 = 192;
  v5 = *(_DWORD *)(a1 + 116);
  if ( !v5 )
  {
    Boss_Objects[0].Entity_Flags &= 0xFFDFu;
    *(_DWORD *)(a1 + 104) = 0;
    goto LABEL_13;
  }
  if ( v5 == 10 )
  {
    *(_DWORD *)(a1 + 116) = 11;
    *(_DWORD *)(a1 + 120) = 10 * *(_DWORD *)(a1 + 32) + 40;
    Boss_Objects[0].Entity_Flags |= 0x20u;
  }
  else if ( v5 != 11 )
  {
    goto LABEL_13;
  }
  if ( Boss_Objects[0].Is_Being_Hit )
  {
    v1 = ((signed int)(unsigned __int8)byte_4BC7C9++ >> 1) % 2;
    if ( v1 )
      *(_DWORD *)(a1 + 104) = 1;
    else
      *(_DWORD *)(a1 + 104) = 0;
  }
  else
  {
    *(_DWORD *)(a1 + 104) = 0;
  }
LABEL_13:
  Boss_Objects[7].X_pos = Boss_Objects[0].X_pos;
  Boss_Objects[7].Y_pos = Boss_Objects[0].Y_pos;
  if ( Boss_Objects[0].Current_State <= 10 )
    *(_DWORD *)(a1 + 104) = 2;
  v2 = &v6 + 4 * *(_DWORD *)(a1 + 104);
  v3 = a1 + 84;
  *(_DWORD *)v3 = *v2;
  *(_DWORD *)(v3 + 4) = v2[1];
  result = v2[2];
  *(_DWORD *)(v3 + 8) = result;
  *(_DWORD *)(v3 + 12) = v2[3];
  return result;
}
// 4BC7C9: using guessed type char byte_4BC7C9;

//----- (00480DAD) --------------------------------------------------------
// return 1
signed int report_failure_Return_1()
{
  return 1;
}

//----- (00480F55) --------------------------------------------------------
size_t __cdecl fread(void *buffer, size_t elementSize, size_t count, FILE *stream)
{
  size_t ret_nolock; // ST0C_4@1

  VALIDATE_RETURN((int)&stru_48CA78, 12);
  lock_str(stream);
  ret_nolock = fread_nolock(buffer, elementSize, count, stream);
  _unlock_file(stream);
  return ret_nolock;
}
// 48CA78: using guessed type _SCOPETABLE_ENTRY stru_48CA78;

//----- (00481981) --------------------------------------------------------
// Write 'count' items of size 'size' to the specified stream from the specified buffer. 
size_t __cdecl fwrite(const void *buffer, size_t size, size_t count, FILE *stream)
{
  size_t v4; // ST0C_4@1

  // just checking for stream != NULL here
  // rest of the validation is in _fwrite_nolock()
  VALIDATE_RETURN((int)&stru_48CAC8, 12);
  lock_str(stream);                             // lock stream
  // do the read
  v4 = fwrite_nolock(buffer, size, count, stream);
  _unlock_file(stream);                         // unlock stream
  return v4;
}
// 48CAC8: using guessed type _SCOPETABLE_ENTRY stru_48CAC8;

//----- (00481F9A) --------------------------------------------------------
// return 1
signed int __security_error_handler_return_1()
{
  return 1;
}

//----- (00481F9E) --------------------------------------------------------
#error "481F9E: positive sp value has been found (funcsize=0)"

//----- (00482475) --------------------------------------------------------
// Unused
int __usercall flsall_sub_482475@<eax>(int a1@<esi>)
{
  return _unlock_file2(a1, *(_DWORD *)(dword_4BD034 + 4 * a1));
}
// 4825F1: using guessed type _DWORD __cdecl _unlock_file2(_DWORD, _DWORD);
// 4BD034: using guessed type int dword_4BD034;

//----- (004824A1) --------------------------------------------------------
// Unused
void flsall_sub_4824A1()
{
  _unlock(1);
}

//----- (004824AA) --------------------------------------------------------
// Flushes all the output buffers to the file, clears all input buffers.
// Unused.
int __cdecl flushall()
{
  return flsall(FLUSHALL);
}

//----- (0048451C) --------------------------------------------------------
int __usercall freefls@<eax>(int a1@<ebp>)
{
  int v1; // esi@1

  v1 = *(_DWORD *)(a1 + 8);
  return freefls();
}
// 484521: using guessed type int freefls(void);

//----- (00486CC0) --------------------------------------------------------
void CrtSetCheckCount()
{
  const char *i; // [sp+Ch] [bp-1Ch]@1
  int savedregs; // [sp+28h] [bp+0h]@0

  for ( i = ""; i < ""; i += 4 )
  {
    if ( *(_DWORD *)i )
      (*(void (__stdcall **)(_DWORD, int))i)(0, savedregs);
  }
}

//----- (00486D04) --------------------------------------------------------
// Executes on exit
void On_Exit_Function(void)
{
  const char *i; // [sp+Ch] [bp-1Ch]@1
  int savedregs; // [sp+28h] [bp+0h]@0

  for ( i = ""; i < ""; i += 4 )
  {
    if ( *(_DWORD *)i )
      (*(void (__stdcall **)(_DWORD, int))i)(0, savedregs);
  }
}

//----- (0048759C) --------------------------------------------------------
// Unused
int __usercall Very_Strange_Shit@<eax>(int a1@<ebp>)
{
  int v1; // edi@1
  int v2; // esi@1

  v1 = *(_DWORD *)(a1 - 36);
  v2 = *(_DWORD *)(a1 - 32);
  return _alloc_osfhnd_sub_4875A2();
}
// 4875A2: using guessed type int _alloc_osfhnd_sub_4875A2(void);

//----- (0048763C) --------------------------------------------------------
void _alloc_osfhnd_sub_48763C()
{
  _unlock(11);
}

//----- (004876E5) --------------------------------------------------------
// Unused
void commit_call___unlock_fhandle()
{
  signed int v0; // [sp+0h] [bp-4h]@0

  unlock_fh(v0);
}

//----- (0048784E) --------------------------------------------------------
// Unused
void _fcloseall_sub_48784E()
{
  _unlock(1);
}

//----- (00488F49) --------------------------------------------------------
int __cdecl _ld12cvt_wrapper(int ld12cut_arg_1, int ld12cut_arg_2)
{
  return _ld12cvt(ld12cut_arg_1, ld12cut_arg_2, &dword_4994F0);
}
// 488DF1: using guessed type _DWORD __cdecl _ld12cvt(_DWORD, _DWORD, _DWORD);
// 4994F0: using guessed type int dword_4994F0;

//----- (00488F5F) --------------------------------------------------------
int __cdecl _fassign_sub_sub_488F5F(int a1, int a2)
{
  return _ld12cvt(a1, a2, &unk_499508);
}
// 488DF1: using guessed type _DWORD __cdecl _ld12cvt(_DWORD, _DWORD, _DWORD);

//----- (00488F75) --------------------------------------------------------
int __cdecl _fassign_sub_488F75(int ld12cut_arg_2, int a2)
{
  int v3; // [sp+0h] [bp-14h]@1
  int ld12cut_arg_1; // [sp+4h] [bp-10h]@1

  __strgtold12(&ld12cut_arg_1, &v3, a2, 0, 0, 0, 0);
  return _ld12cvt_wrapper((int)&ld12cut_arg_1, ld12cut_arg_2);
}
// 48A1AB: using guessed type _DWORD __cdecl __strgtold12(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00488FB2) --------------------------------------------------------
int __cdecl _fassign_sub_488FB2(int a1, int a2)
{
  int v3; // [sp+0h] [bp-14h]@1
  int v4; // [sp+4h] [bp-10h]@1

  __strgtold12(&v4, &v3, a2, 0, 0, 0, 0);
  return _fassign_sub_sub_488F5F((int)&v4, a1);
}
// 48A1AB: using guessed type _DWORD __cdecl __strgtold12(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0048AD5E) --------------------------------------------------------
// Unused
int Return_0()
{
  return 0;
}

//----- (0048AF52) --------------------------------------------------------
int __usercall realloc_sub_48AF52@<eax>(int a1@<ebp>)
{
  int v1; // esi@1
  int v2; // edi@1

  v1 = *(_DWORD *)(a1 + 12);
  v2 = *(_DWORD *)(a1 + 8);
  return realloc_sub_48AF5A();
}
// 48AF5A: using guessed type int realloc_sub_48AF5A(void);

//----- (0048B8F0) --------------------------------------------------------
// Unused
OrgData *Init_OrgData()
{
  return OrgData::OrgData(&Music_Object);
}

#error "There were 1 decompilation failure(s) on 843 function(s)"
